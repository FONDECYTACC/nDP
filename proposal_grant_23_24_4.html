<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés González Santa Cruz">
<meta name="dcterms.date" content="2024-05-17">
<meta name="description" content="Analyze the association between polysubstance at admission and tr. compleiton longitudinally along treatments, accounting for irregular observations.">

<title>Polysubstance and tr. completion</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="proposal_grant_23_24_4_files/libs/clipboard/clipboard.min.js"></script>
<script src="proposal_grant_23_24_4_files/libs/quarto-html/quarto.js"></script>
<script src="proposal_grant_23_24_4_files/libs/quarto-html/popper.min.js"></script>
<script src="proposal_grant_23_24_4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="proposal_grant_23_24_4_files/libs/quarto-html/anchor.min.js"></script>
<link href="proposal_grant_23_24_4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="proposal_grant_23_24_4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="proposal_grant_23_24_4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="proposal_grant_23_24_4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="proposal_grant_23_24_4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Polysubstance and tr. completion</h1>
</div>

<div>
  <div class="description">
    <p>Analyze the association between polysubstance at admission and tr. compleiton longitudinally along treatments, accounting for irregular observations.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés González Santa Cruz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"

</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

$('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');

// onClick function for all plots (img's)

$('img:not(.zoomImg)').click(function() {
$('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
$('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
});

// onClick function for zoomImg

$('img.zoomImg').click(function() {
$('.zoomDiv').css({opacity: '0', width: '0%'});
});
});
</script>
</div>
<div class="cell">
<style type="text/css">
<script src="https://github.com/AGSCL/gine_brechas_pandemia/blob/main/hideOutput.js"></script>
</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

\$chunks = \$('.fold');

\$chunks.each(function () { // add button to source code chunks
if ( \$(this).hasClass('s') ) {
    \$('pre.r', this).prepend("\<div class=\\"showopt\\"\>Show Source\</div\>\<br style=\\"line-height:22px;\\"/\>");
    \$('pre.r', this).children('code').attr('class', 'folded');
    } // add button to output chunks

    if ( \$(this).hasClass('o') ) {
        \$('pre:not(.r)', this).has('code').prepend("\<div class=\\"showopt\\"\>Show Output\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre:not(.r)', this).children('code:not(r)').addClass('folded'); // add button to plots
        \$(this).find('img').wrap('\<pre class=\\"plot\\"\>\</pre\>');
        \$('pre.plot', this).prepend("\<div class=\\"showopt\\"\>Show Plot\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre.plot', this).children('img').addClass('folded');
        }
}); // hide all chunks when document is loaded

\$('.folded').css('display', 'none') // function to toggle the visibility
\$('.showopt').click(function() {
        var label = \$(this).html();
        if (label.indexOf("Show") \>= 0) {
            \$(this).html(label.replace("Show", "Hide"));
        } else {
        \$(this).html(label.replace("Hide", "Show"));
        }

\$(this).siblings('code, img').slideToggle('fast', 'swing');
});
});
</script>
</div>
<style type="text/css">

.showopt {

background-color: #004c93; color: #FFFFFF; width: 100px; height: 20px; text-align: center; vertical-align: middle !important; float: right; font-family: sans-serif; border-radius: 8px;

}

.showopt:hover {
background-color: #dfe4f2;
color: #004c93;

}

pre.plot {
background-color: white !important;
}

.tablelines table, .tablelines td, .tablelines th {
border: 1px solid black;
}

.centrado {
text-align: center;
}

.table.center {
margin-left:auto;
margin-right:auto;
}

/* https://vivekjaiskumar.medium.com/css-is-and-not-selector-17c942ec83f :is()*/

/* Applies to outputs that are not code other than R*/

pre {
overflow-x: auto !important;
}

pre code {
word-wrap: normal !important;
white-space: pre !important;
}

/*
pre:not(.sourceCode) {
white-space: nowrap !important;
}
*/
.sourceCode { /* Important gives precedence */
font-size: 10px !important;
line-height: 50% !important;
}
body{ /* Normal */
text-align: justify;
}
.superbigimage{
overflow-y:scroll;
height:350px;
white-space: nowrap;
overflow-x: auto;
width:100%;
}
.superbigimage img{
overflow-y: scroll;
overflow-x: hidden;
}
.message { color:#446C6E; font-family: monospace;font-size: 10px; line-height: 110%; font-weight: bold;}
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 5px; text-align: justify;}
div.red { background-color:#e6bab1; border-radius: 5px; padding: 5px; text-align: justify;}
.pandoc-table { /* Should add !important; but it seems no necessary */
margin-left:auto; /* To center */
margin-right:auto;
border-collapse: collapse;
table-layout: auto;
font-size: 11px;
overflow-y: auto;
max-height:450px !important;
white-space: nowrap;
overflow-x: auto;
width:450px;
}
.pandoc-table th {/* header */
text-align: center !important;
font-size: 10px;
padding: 0px;
}
.pandoc-table td {
text-align: left !important;
font-size: 9px;
padding: 0px;
}
.pandoc-table caption {
text-align: left !important;
font-size: 11px !important;
}

.center-table {
text-align: left !important;
font-size: 9px;
padding: 0px;
overflow-y:scroll;
height:400px;
overflow-x: scroll;
}

.controlly{
overflow-y:scroll;
height:350px;
overflow-x: scroll;

}
</style>
<!-- We gotta do each function to hide code and outputs per section, by every ID, we gotta create a different function -->

<script>
function myFunction1() {
var x = document.getElementById("myDIV");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>

<script>
function myFunction2() {
var x = document.getElementById("myDIV2");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"proposal_grant_23_24_files"</span>, <span class="at">recursive=</span>T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fuentes: </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rpubs.com/georgy_makarov/897844</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>path<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">'/env'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  "")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  Sys.which("python"))</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#reticulate::py_config()</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#use_python(paste0(path,"/Scripts/python.exe"))</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH =  paste0(path,"/Lib"))</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH_64 =  paste0(path,"/Lib"))</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#instalar paquetes de funcionalidades básicas para tener ubicaciones relativas y acceso a python (reticulate)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(reticulate)){<span class="fu">install.packages</span>(<span class="st">"reticulate"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: reticulate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'reticulate' was built under R version 4.1.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(rstudioapi)){<span class="fu">install.packages</span>(<span class="st">"rstudioapi"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rstudioapi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rstudioapi' was built under R version 4.1.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Create env"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/54043607/how-to-set-pyenv-python-for-reticulate</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Directory H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env is not a Python virtualenv</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#virtualenv_create(envname  = path, packages = c("pip", "statsmodels", "matplotlib", "numpy", "pandas", "scipy"))</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># "C:/Users/andre/anaconda3/python.exe" -m venv "H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/9_Computacion_Estadistica/env"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#FUENTES:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/articles/versions.html</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Virtual environment functions are not supported on Windows (the use of conda environments is recommended on Windows).</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Use environment"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#https://ugoproto.github.io/ugo_r_doc/pdf/reticulate.pdf</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># tx  &lt;- readLines(paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[1]] &lt;- paste0("home = ",gsub('/', '\\', paste0(path,"/Scripts/python.exe"), fixed=T))</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[3]] &lt;- "version = 3.8.0"</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#writeLines(tx, con=paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env/Scripts/python.exe"</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#use_virtualenv(path)</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#usar entorno virtual ya creado</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#información sobre entorno virtual</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#py_discover_config()</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#conda_python(envname =  "r-scrublet")</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># FUENTES</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#https://akrabat.com/creating-virtual-environments-with-pyenv/</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/reference/install_python.html</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/wiki#suggested-build-environment</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/56755156/reticulate-not-setting-python-path</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/rstudio/reticulate/issues/291#issuecomment-437143751</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv-win/pyenv-win#installation</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/52060867/how-to-use-pip-for-pyenv</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/issues/2417</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv install <span class="op">-</span>l <span class="op">|</span> findstr <span class="fl">3.8</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>upgrade pyenv<span class="op">-</span>win</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install <span class="fl">3.7.5</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv build</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># `r format(Sys.time(),'%B %d, %Y')`</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data import</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"an_grant_23_24_3.RData"</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># List all of the objects names in RData:</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(.GlobalEnv)</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(new_environment)</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(new_environment)</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<section id="packages" class="level1">
<h1>Packages</h1>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_unlock</span>(<span class="at">lib.loc =</span> <span class="fu">.libPaths</span>()) <span class="co">#para no tener problemas reinstalando paquetes</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">getRversion</span>() <span class="sc">!=</span> <span class="st">"4.1.2"</span>) { <span class="fu">stop</span>(<span class="st">"Requires R version 4.1.2. Actual: "</span>, <span class="fu">getRversion</span>()) }</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(geepack)){<span class="fu">install.packages</span>(<span class="st">"geepack"</span>);<span class="fu">library</span>(geepack)}</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(geeM)){<span class="fu">install.packages</span>(<span class="st">"geeM"</span>);<span class="fu">library</span>(geeM)}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)){<span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>);<span class="fu">library</span>(tidyverse)}</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(MASS)){<span class="fu">install.packages</span>(<span class="st">"MASS"</span>);<span class="fu">library</span>(MASS)}</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(geeasy)){<span class="fu">install.packages</span>(<span class="st">"geeasy"</span>);<span class="fu">library</span>(geeasy)}</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(MuMIn)){remotes<span class="sc">::</span><span class="fu">install_version</span>(<span class="st">"MuMIn"</span>, <span class="st">"1.46.0"</span>);<span class="fu">library</span>(MuMIn)}</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tableone)){<span class="fu">install.packages</span>(<span class="st">"tableone"</span>);<span class="fu">library</span>(tableone)}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(knitr)){<span class="fu">install.packages</span>(<span class="st">"knitr"</span>);<span class="fu">library</span>(knitr)}</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(emmeans)){<span class="fu">install.packages</span>(<span class="st">"emmeans"</span>);<span class="fu">library</span>(emmeans)}</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(biostat3)){<span class="fu">install.packages</span>(<span class="st">"biostat3"</span>);<span class="fu">library</span>(biostat3)}</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(rms)){<span class="fu">install.packages</span>(<span class="st">"rms"</span>);<span class="fu">library</span>(rms)}</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#https://gist.github.com/avallecam/56af06f46e5544c3af0f46344df20989 </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/49089476/any-updates-to-model-negative-binomial-distribution-data-with-gee-in-r</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.rdocumentation.org/packages/geepack/versions/1.3.4/topics/geese</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/13946540/negative-binomial-in-gee?rq=1</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>summary2.geem <span class="ot">&lt;-</span> <span class="cf">function</span>(object, <span class="at">exponentiate =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>, ...) {</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.list</span>(object) <span class="sc">||</span> <span class="sc">!</span><span class="st">"beta"</span> <span class="sc">%in%</span> <span class="fu">names</span>(object)) {</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Invalid object: Expected a model object with beta coefficients."</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize coefficients matrix</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  Coefs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(object<span class="sc">$</span>beta), <span class="at">ncol =</span> <span class="dv">8</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(Coefs) <span class="ot">&lt;-</span> object<span class="sc">$</span>coefnames</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(Coefs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Term"</span>, <span class="st">"Estimates"</span>, <span class="st">"Model SE"</span>, <span class="st">"Robust SE"</span>, <span class="st">"Wald"</span>, <span class="st">"CI.lower"</span>, <span class="st">"CI.upper"</span>, <span class="st">"p.value"</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="st">"Estimates"</span>] <span class="ot">&lt;-</span> object<span class="sc">$</span>beta</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Handling the variance calculations</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  naive <span class="ot">&lt;-</span> <span class="fu">is.null</span>(object<span class="sc">$</span>var) <span class="sc">||</span> <span class="fu">is.character</span>(object<span class="sc">$</span>var) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">diag</span>(object<span class="sc">$</span>var) <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (naive) {</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">"Robust variance estimate not available or invalid. Using model-based SE."</span>)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    Coefs[, <span class="st">"Robust SE"</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(object<span class="sc">$</span>naiv.var))</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    Coefs[, <span class="st">"Robust SE"</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(object<span class="sc">$</span>var))</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="st">"Model SE"</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(object<span class="sc">$</span>naiv.var))  <span class="co"># Model-based SE</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Wald statistics</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="st">"Wald"</span>] <span class="ot">&lt;-</span> Coefs[, <span class="st">"Estimates"</span>] <span class="sc">/</span> Coefs[, <span class="st">"Robust SE"</span>]</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% CI calculations</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>  z_value <span class="ot">&lt;-</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.95</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="st">"CI.lower"</span>] <span class="ot">&lt;-</span> Coefs[, <span class="st">"Estimates"</span>] <span class="sc">-</span> z_value <span class="sc">*</span> Coefs[, <span class="st">"Robust SE"</span>]</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="st">"CI.upper"</span>] <span class="ot">&lt;-</span> Coefs[, <span class="st">"Estimates"</span>] <span class="sc">+</span> z_value <span class="sc">*</span> Coefs[, <span class="st">"Robust SE"</span>]</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># P-value calculation</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="st">"p.value"</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(Coefs[, <span class="st">"Wald"</span>])), <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exponentiate estimates and CIs if specified</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (exponentiate) {</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    Coefs[, <span class="fu">c</span>(<span class="st">"Estimates"</span>, <span class="st">"CI.lower"</span>, <span class="st">"CI.upper"</span>)] <span class="ot">&lt;-</span> <span class="fu">exp</span>(Coefs[, <span class="fu">c</span>(<span class="st">"Estimates"</span>, <span class="st">"CI.lower"</span>, <span class="st">"CI.upper"</span>)])</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Round numerical output</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  decimal_format <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%%1.%df"</span>, digits)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="fu">c</span>(<span class="st">"Estimates"</span>, <span class="st">"Model SE"</span>, <span class="st">"Robust SE"</span>, <span class="st">"Wald"</span>, <span class="st">"CI.lower"</span>, <span class="st">"CI.upper"</span>)] <span class="ot">&lt;-</span> <span class="fu">round</span>(Coefs[, <span class="fu">c</span>(<span class="st">"Estimates"</span>, <span class="st">"Model SE"</span>, <span class="st">"Robust SE"</span>, <span class="st">"Wald"</span>, <span class="st">"CI.lower"</span>, <span class="st">"CI.upper"</span>)], <span class="at">digits =</span> digits)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>  Coefs[, <span class="fu">c</span>(<span class="st">"Estimates"</span>, <span class="st">"Model SE"</span>, <span class="st">"Robust SE"</span>, <span class="st">"Wald"</span>, <span class="st">"CI.lower"</span>, <span class="st">"CI.upper"</span>)] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Coefs[, <span class="fu">c</span>(<span class="st">"Estimates"</span>, <span class="st">"Model SE"</span>, <span class="st">"Robust SE"</span>, <span class="st">"Wald"</span>, <span class="st">"CI.lower"</span>, <span class="st">"CI.upper"</span>)], <span class="cf">function</span>(col) {</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>(<span class="fu">sprintf</span>(decimal_format, <span class="fu">as.numeric</span>(col)))</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert matrix to data frame and keep row names</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>  result_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Coefs)</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>  result_df[, <span class="st">"Term"</span>] <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Coefs)</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>(result_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result_df)</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>tidy_geese_model <span class="ot">&lt;-</span> <span class="cf">function</span>(geese_model, <span class="at">conf.level =</span> <span class="fl">0.95</span>) {</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract coefficients and their names</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> geese_model<span class="sc">$</span>beta</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>  coefficient_names <span class="ot">&lt;-</span> <span class="fu">names</span>(coefficients)</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract variance of beta coefficients and compute standard errors</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>  variance_beta <span class="ot">&lt;-</span> geese_model<span class="sc">$</span>vbeta</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>  std_errors <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(variance_beta))</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate z-values and p-values</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>  z_values <span class="ot">&lt;-</span> coefficients <span class="sc">/</span> std_errors</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(z_values), <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate confidence intervals</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> conf.level</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>  lower_ci <span class="ot">&lt;-</span> coefficients <span class="sc">-</span> z <span class="sc">*</span> std_errors</span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>  upper_ci <span class="ot">&lt;-</span> coefficients <span class="sc">+</span> z <span class="sc">*</span> std_errors</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Exponentiate coefficients and confidence intervals for odds ratios</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>  exp_coefficients <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefficients)</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>  exp_lower_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(lower_ci)</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>  exp_upper_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(upper_ci)</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a tidy data frame</span></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>  tidy_data <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> coefficient_names,</span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> exp_coefficients,</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">Std.Error =</span> std_errors,</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">z.value =</span> z_values,</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> p_values,</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI.Lower =</span> exp_lower_ci,</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI.Upper =</span> exp_upper_ci</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"Std.Error"</span>, <span class="st">"z.value"</span>, <span class="st">"CI.Lower"</span>,<span class="st">"CI.Upper"</span>),<span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>),<span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.))</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tidy_data)</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>)</span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>knit_hooks<span class="sc">$</span><span class="fu">set</span>(<span class="at">time_it =</span> <span class="fu">local</span>({</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>  now <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(before, options) {</span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (before) {</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>      <span class="co"># record the current time before each chunk</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>      now <span class="ot">&lt;&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>      <span class="co"># calculate the time difference after a chunk</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), now)<span class="sc">&gt;</span>(<span class="dv">60</span><span class="sc">^</span><span class="dv">2</span>),<span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), now)<span class="sc">/</span>(<span class="dv">60</span><span class="sc">^</span><span class="dv">2</span>),<span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), now)<span class="sc">/</span>(<span class="dv">60</span><span class="sc">^</span><span class="dv">1</span>))</span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>      <span class="co"># return a character string to show the time</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), now)<span class="sc">&gt;</span>(<span class="dv">60</span><span class="sc">^</span><span class="dv">2</span>),<span class="fu">paste</span>(<span class="st">"Time for this code chunk to run:"</span>, <span class="fu">round</span>(res,<span class="dv">1</span>), <span class="st">"hours"</span>),<span class="fu">paste</span>(<span class="st">"Time for this code chunk to run:"</span>, <span class="fu">round</span>(res,<span class="dv">1</span>), <span class="st">"minutes"</span>))</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">'&lt;div class="message"&gt;'</span>, <span class="fu">gsub</span>(<span class="st">'##'</span>, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>, x),<span class="st">'&lt;/div&gt;'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">time_it =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>format_cells <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rows ,cols, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">"italics"</span>, <span class="st">"bold"</span>, <span class="st">"strikethrough"</span>)){</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the correct markup</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>  <span class="co"># one * for italics, two ** for bold</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>  map <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"*"</span>, <span class="st">"**"</span>, <span class="st">"~~"</span>), <span class="fu">c</span>(<span class="st">"italics"</span>, <span class="st">"bold"</span>, <span class="st">"strikethrough"</span>))</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>  markup <span class="ot">&lt;-</span> map[value]  </span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (r <span class="cf">in</span> rows){</span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(c <span class="cf">in</span> cols){</span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Make sure values are not factors</span></span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>      df[[c]] <span class="ot">&lt;-</span> <span class="fu">as.character</span>( df[[c]])</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Update formatting</span></span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>      df[r, c] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(df[r, c])<span class="sc">==</span><span class="dv">0</span>,<span class="st">""</span>,<span class="fu">paste0</span>(markup, <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, df[r, c]), markup))</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a><span class="co">#To produce line breaks in messages and warnings</span></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>knit_hooks<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(x, options) {</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">'</span><span class="sc">\n\n</span><span class="st">&lt;div class="alert alert-danger"&gt;'</span>,</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>          <span class="fu">gsub</span>(<span class="st">'##'</span>, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>, <span class="fu">gsub</span>(<span class="st">'^##\ Error'</span>, <span class="st">'**Error**'</span>, x)),</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>          <span class="st">'&lt;/div&gt;'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cf">function</span>(x, options) {</span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">'</span><span class="sc">\n\n</span><span class="st">&lt;div class="alert alert-warning"&gt;'</span>,</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>          <span class="fu">gsub</span>(<span class="st">'##'</span>, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>, <span class="fu">gsub</span>(<span class="st">'^##\ Warning:'</span>, <span class="st">'**Warning**'</span>, x)),</span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>          <span class="st">'&lt;/div&gt;'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cf">function</span>(x, options) {</span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">'&lt;div class="message"&gt;'</span>,</span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>          <span class="fu">gsub</span>(<span class="st">'##'</span>, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>, x),</span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>          <span class="st">'&lt;/div&gt;'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Function to format CreateTableOne into a database"</span>)</span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>as.data.frame.TableOne <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {<span class="fu">capture.output</span>(<span class="fu">print</span>(x,</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="at">showAllLevels =</span> <span class="cn">TRUE</span>, <span class="at">varLabels =</span> T,...) <span class="ot">-&gt;</span> x)</span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>  y<span class="sc">$</span>characteristic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="fu">rownames</span>(x), <span class="st">""</span>)</span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span></span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fill</span>(characteristic, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(characteristic, <span class="fu">everything</span>())</span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(y) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>  y}</span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a><span class="co"># Austin, P. C. (2009). The Relative Ability of Different Propensity </span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Score Methods to Balance Measured Covariates Between </span></span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a><span class="co"># Treated and Untreated Subjects in Observational Studies. Medical </span></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision Making. https://doi.org/10.1177/0272989X09341755</span></span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>smd_bin <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sum</span>(z,t)</span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> k<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">-</span>y)<span class="sc">/</span><span class="fu">sqrt</span>(l))</span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>counting_process_output<span class="ot">&lt;-</span></span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(<span class="at">object=</span><span class="cn">NULL</span>){</span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>(object<span class="sc">$</span>m, <span class="at">exponentiate=</span>T, <span class="at">conf.int=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"robust.se"</span>,<span class="st">"statistic"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>),<span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))) <span class="sc">%&gt;%</span> </span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p.value=</span> <span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,p.value))</span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(.Platform<span class="sc">$</span>OS.type <span class="sc">==</span> <span class="st">"windows"</span>) <span class="fu">withAutoprint</span>({</span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">memory.size</span>()</span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">memory.size</span>(<span class="cn">TRUE</span>)</span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">memory.limit</span>()</span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; memory.size()
[1] 7438.79
&gt; memory.size(TRUE)
[1] 7439.44
&gt; memory.limit()
[1] 32563</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">memory.limit</span>(<span class="at">size=</span><span class="dv">56000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56000</code></pre>
</div>
</div>
</div>
<section id="a.-descriptives" class="level2">
<h2 class="anchored" data-anchor-id="a.-descriptives">0.a. Descriptives</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"To account for variability by treatment setting, we stratified the analysis by setting: basic ambulatory GP intensive ambulatory GP residential WO intensive ambulatory WO residential"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr, is_first_occurrence<span class="sc">==</span><span class="dv">1</span>, <span class="at">select=</span> <span class="st">"tipo_de_plan_2_mod"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
       basic ambulatory GP intensive ambulatory          GP residential 
                   4360                    4998                    2178 
WO intensive ambulatory          WO residential 
                    745                    1036 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">min</span>(fech_ing_num)) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13317</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#13317</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(data_mine_miss_restr_proc2 , is_first_occurrence<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13317</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#13317</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_baseline<span class="ot">&lt;-</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(data_mine_miss_restr_proc2 , is_first_occurrence<span class="sc">==</span><span class="dv">1</span>) </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>variables_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tr_outcome"</span>, <span class="st">"policonsumo2"</span>, <span class="st">"comp_bpsc_y3_severe"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"less_90d_tr1"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_oh"</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"psycom_dum_study"</span>, <span class="st">"psycom_dum_with"</span>, <span class="st">"freq_cons_dum_5day"</span>, </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_coc"</span>, </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>, <span class="st">"susprindum_oh"</span>)<span class="co">#,"lag_comp_bpsc_y3_severe", "lag_less_90d_tr1", "log_lag_dias_treat_imp_sin_na", "lag_policonsumo2", "lag_tr_outcome")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>tr_outcome,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Complete status of treatment (binary)"</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>tr_outcome,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Complete status of treatment (binary)"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>policonsumo2,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Polysubstance use"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>comp_bpsc_y3_severe,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Biopsychosocial compromise (Severe)"</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>less_90d_tr1,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Treatment duration (binary) (&lt;90 days)"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>log_dias_treat_imp_sin_na,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Treatment duration (log-scaled days)"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>edad_al_ing_1,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at admission to treatment"</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>ano_nac_corr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Birth year"</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susinidum_oh,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance (initial diagnosis): alcohol"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susinidum_coc,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance (initial diagnosis): cocaine hydrochloride"</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susinidum_pbc,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance (initial diagnosis): cocaine base paste"</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susinidum_mar,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance (initial diagnosis): marijuana"</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>psycom_dum_study,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Psychiatric comorbidity (ICD-10): In study"</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>psycom_dum_with,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Psychiatric comorbidity (ICD-10): Diagnosed"</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>freq_cons_dum_5day,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Daily frequence of primary substance use at admission"</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>cond_oc_dum_2inact,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Occupational Status: Inactive"</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>cond_oc_dum_3unemp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Occupational Status: Unemployed"</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susprindum_oh,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance at admission to treatment: alcohol"</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susprindum_coc,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance at admission to treatment: cocaine hydrochloride"</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susprindum_pbc,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance at admission to treatment: cocaine base paste"</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>susprindum_mar,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary substance at admission to treatment: marijuana"</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(data_mine_miss_restr_proc2_baseline<span class="sc">$</span>tipo_de_plan_2_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Treatment setting"</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Table for imputed dataset with selected covariates"</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tableone)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">c</span>(variables_vector,<span class="st">"tipo_de_plan_2_mod"</span>), <span class="st">"policonsumo2"</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>factorVars <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(variables_vector, <span class="fu">c</span>(<span class="st">"policonsumo2"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>, <span class="st">"ano_nac_corr"</span>))</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>tableOne <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars =</span> vars, <span class="at">data =</span> data_mine_miss_restr_proc2_baseline,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">factorVars =</span> factorVars, <span class="at">strata =</span> <span class="st">"policonsumo2"</span>, </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>                           <span class="at">addOverall =</span> <span class="cn">TRUE</span>,  <span class="co"># &lt;-- This is the key addition</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">includeNA =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">test =</span> <span class="cn">TRUE</span>) <span class="co"># Remove statistical tests for speed</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tableOne, <span class="at">smd =</span> <span class="cn">TRUE</span>) <span class="co"># Calculate SMD separately if needed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                       Stratified by policonsumo2
                                        Overall         0              
  n                                       13317            2383        
  tr_outcome = 1 (%)                      10448 (78.5)     1833 (76.9) 
  comp_bpsc_y3_severe = 1 (%)              5496 (41.3)      690 (29.0) 
  less_90d_tr1 = 1 (%)                     3269 (24.5)      567 (23.8) 
  log_dias_treat_imp_sin_na (mean (SD))    5.00 (1.07)     5.03 (0.93) 
  edad_al_ing_1 (mean (SD))               33.80 (9.46)    38.29 (11.32)
  ano_nac_corr (mean (SD))              1979.02 (9.54)  1975.34 (11.02)
  susinidum_oh = 1 (%)                     6924 (52.0)     1484 (62.3) 
  susinidum_coc = 1 (%)                     627 ( 4.7)      108 ( 4.5) 
  susinidum_pbc = 1 (%)                    1123 ( 8.4)      251 (10.5) 
  susinidum_mar = 1 (%)                    4348 (32.6)      483 (20.3) 
  psycom_dum_study = 1 (%)                 2653 (19.9)      420 (17.6) 
  psycom_dum_with = 1 (%)                  5836 (43.8)      986 (41.4) 
  freq_cons_dum_5day = 1 (%)               6242 (46.9)     1013 (42.5) 
  cond_oc_dum_2inact = 1 (%)               2410 (18.1)      468 (19.6) 
  cond_oc_dum_3unemp = 1 (%)               5271 (39.6)      764 (32.1) 
  susprindum_coc = 1 (%)                   2370 (17.8)      292 (12.3) 
  susprindum_pbc = 1 (%)                   6898 (51.8)      902 (37.9) 
  susprindum_mar = 1 (%)                    717 ( 5.4)       64 ( 2.7) 
  susprindum_oh = 1 (%)                    3144 (23.6)     1082 (45.4) 
  tipo_de_plan_2_mod (%)                                               
     basic ambulatory                      4360 (32.7)     1040 (43.6) 
     GP intensive ambulatory               4998 (37.5)      786 (33.0) 
     GP residential                        2178 (16.4)      272 (11.4) 
     WO intensive ambulatory                745 ( 5.6)      138 ( 5.8) 
     WO residential                        1036 ( 7.8)      147 ( 6.2) 
                                       Stratified by policonsumo2
                                        1               p      test SMD   
  n                                       10934                           
  tr_outcome = 1 (%)                       8615 (78.8)   0.047       0.045
  comp_bpsc_y3_severe = 1 (%)              4806 (44.0)  &lt;0.001       0.315
  less_90d_tr1 = 1 (%)                     2702 (24.7)   0.359       0.021
  log_dias_treat_imp_sin_na (mean (SD))    4.99 (1.10)   0.074       0.043
  edad_al_ing_1 (mean (SD))               32.82 (8.70)  &lt;0.001       0.542
  ano_nac_corr (mean (SD))              1979.83 (8.99)  &lt;0.001       0.446
  susinidum_oh = 1 (%)                     5440 (49.8)  &lt;0.001       0.254
  susinidum_coc = 1 (%)                     519 ( 4.7)   0.693       0.010
  susinidum_pbc = 1 (%)                     872 ( 8.0)  &lt;0.001       0.088
  susinidum_mar = 1 (%)                    3865 (35.3)  &lt;0.001       0.341
  psycom_dum_study = 1 (%)                 2233 (20.4)   0.002       0.071
  psycom_dum_with = 1 (%)                  4850 (44.4)   0.008       0.060
  freq_cons_dum_5day = 1 (%)               5229 (47.8)  &lt;0.001       0.107
  cond_oc_dum_2inact = 1 (%)               1942 (17.8)   0.033       0.048
  cond_oc_dum_3unemp = 1 (%)               4507 (41.2)  &lt;0.001       0.191
  susprindum_coc = 1 (%)                   2078 (19.0)  &lt;0.001       0.187
  susprindum_pbc = 1 (%)                   5996 (54.8)  &lt;0.001       0.346
  susprindum_mar = 1 (%)                    653 ( 6.0)  &lt;0.001       0.162
  susprindum_oh = 1 (%)                    2062 (18.9)  &lt;0.001       0.593
  tipo_de_plan_2_mod (%)                                &lt;0.001       0.298
     basic ambulatory                      3320 (30.4)                    
     GP intensive ambulatory               4212 (38.5)                    
     GP residential                        1906 (17.4)                    
     WO intensive ambulatory                607 ( 5.6)                    
     WO residential                         889 ( 8.1)                    </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tableOne, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,<span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">str_replace_all</span>(., <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">( "</span>, <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">str_trim</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(.,<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance(1) and no Polysubstance use (0)"</span>, <span class="at">escape=</span>T)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(.,<span class="fu">paste0</span>(folder_path,<span class="st">"baseline_psu_desc_subsamp_smd.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind.data.frame</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind.data.frame</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">type=</span> <span class="st">"PSU at admission and at least one dropout from the first admission"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    biostat3<span class="sc">::</span><span class="fu">survRate</span>(<span class="fu">Surv</span>(cens_time, sum_tr_outcomes<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">~</span> policonsumo2, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sum_tr_outcomes=</span><span class="fu">sum</span>(tr_outcome<span class="sc">==</span><span class="dv">1</span>,<span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">filter</span>(is_first_occurrence<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">ungroup</span>())  <span class="sc">%&gt;%</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"rate"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>),<span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.<span class="sc">*</span><span class="dv">1000</span>)))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind.data.frame</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">type=</span> <span class="st">"PSU at admission and first dropout"</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    biostat3<span class="sc">::</span><span class="fu">survRate</span>(<span class="fu">Surv</span>(cens_time, tr_outcome<span class="sc">==</span><span class="dv">1</span>) <span class="sc">~</span> policonsumo2, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sum_tr_outcomes=</span><span class="fu">sum</span>(tr_outcome<span class="sc">==</span><span class="dv">1</span>,<span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">filter</span>(is_first_occurrence<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">ungroup</span>())  <span class="sc">%&gt;%</span> </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"rate"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>),<span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.<span class="sc">*</span><span class="dv">1000</span>))) </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind.data.frame</span>(</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">type=</span> <span class="st">"At least one treatment reporting PSU and at least one dropout from the first admission"</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    biostat3<span class="sc">::</span><span class="fu">survRate</span>(<span class="fu">Surv</span>(cens_time, sum_tr_outcomes<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">~</span> policonsumo2, </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sum_tr_outcomes=</span><span class="fu">sum</span>(tr_outcome<span class="sc">==</span><span class="dv">1</span>,<span class="at">na.rm=</span>T),</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sum_policonsumo2=</span><span class="fu">sum</span>(policonsumo2<span class="sc">==</span><span class="dv">1</span>,<span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">filter</span>(is_first_occurrence<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">policonsumo2=</span><span class="fu">ifelse</span>(sum_policonsumo2<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)))  <span class="sc">%&gt;%</span> </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"rate"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>),<span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.<span class="sc">*</span><span class="dv">1000</span>))) </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind.data.frame</span>(</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">type=</span> <span class="st">"At least one treatment reporting PSU and first dropout"</span>,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    biostat3<span class="sc">::</span><span class="fu">survRate</span>(<span class="fu">Surv</span>(cens_time, tr_outcome<span class="sc">==</span><span class="dv">1</span>) <span class="sc">~</span> policonsumo2, </span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sum_tr_outcomes=</span><span class="fu">sum</span>(tr_outcome<span class="sc">==</span><span class="dv">1</span>,<span class="at">na.rm=</span>T),</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sum_policonsumo2=</span><span class="fu">sum</span>(policonsumo2<span class="sc">==</span><span class="dv">1</span>,<span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">filter</span>(is_first_occurrence<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">policonsumo2=</span><span class="fu">ifelse</span>(sum_policonsumo2<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)))  <span class="sc">%&gt;%</span> </span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"rate"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>),<span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.<span class="sc">*</span><span class="dv">1000</span>))) </span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    )    </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span>  </span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(.,<span class="fu">paste0</span>(folder_path,<span class="st">"person_time_irrs.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(.,<span class="st">"markdown"</span>, <span class="at">caption=</span> <span class="st">"Glimpse of the survival analysis, person-time"</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Glimpse of the survival analysis, person-time</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 57%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">policonsumo2</th>
<th style="text-align: right;">tstop</th>
<th style="text-align: right;">event</th>
<th style="text-align: left;">rate</th>
<th style="text-align: left;">lower</th>
<th style="text-align: left;">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">policonsumo2=0</td>
<td style="text-align: left;">PSU at admission and at least one dropout from the first admission</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">161852.30</td>
<td style="text-align: right;">2135</td>
<td style="text-align: left;">13.19</td>
<td style="text-align: left;">12.64</td>
<td style="text-align: left;">13.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">policonsumo2=1</td>
<td style="text-align: left;">PSU at admission and at least one dropout from the first admission</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">872863.25</td>
<td style="text-align: right;">10085</td>
<td style="text-align: left;">11.55</td>
<td style="text-align: left;">11.33</td>
<td style="text-align: left;">11.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">policonsumo2=01</td>
<td style="text-align: left;">PSU at admission and first dropout</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">161852.30</td>
<td style="text-align: right;">1833</td>
<td style="text-align: left;">11.33</td>
<td style="text-align: left;">10.81</td>
<td style="text-align: left;">11.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">policonsumo2=11</td>
<td style="text-align: left;">PSU at admission and first dropout</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">872863.25</td>
<td style="text-align: right;">8615</td>
<td style="text-align: left;">9.87</td>
<td style="text-align: left;">9.66</td>
<td style="text-align: left;">10.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">policonsumo2=02</td>
<td style="text-align: left;">At least one treatment reporting PSU and at least one dropout from the first admission</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">78926.85</td>
<td style="text-align: right;">1099</td>
<td style="text-align: left;">13.92</td>
<td style="text-align: left;">13.11</td>
<td style="text-align: left;">14.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">policonsumo2=12</td>
<td style="text-align: left;">At least one treatment reporting PSU and at least one dropout from the first admission</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">955788.69</td>
<td style="text-align: right;">11121</td>
<td style="text-align: left;">11.64</td>
<td style="text-align: left;">11.42</td>
<td style="text-align: left;">11.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">policonsumo2=03</td>
<td style="text-align: left;">At least one treatment reporting PSU and first dropout</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">78926.85</td>
<td style="text-align: right;">936</td>
<td style="text-align: left;">11.86</td>
<td style="text-align: left;">11.11</td>
<td style="text-align: left;">12.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">policonsumo2=13</td>
<td style="text-align: left;">At least one treatment reporting PSU and first dropout</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">955788.69</td>
<td style="text-align: right;">9512</td>
<td style="text-align: left;">9.95</td>
<td style="text-align: left;">9.75</td>
<td style="text-align: left;">10.15</td>
</tr>
</tbody>
</table>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="b.-iiws" class="level2">
<h2 class="anchored" data-anchor-id="b.-iiws">0.b. IIWs</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Primary (no corrections, lag=0)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st)))),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Alternative (no corrections, lag=1)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt_st)))),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Primary (after PH, lag=0)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph_st)))),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Alternative (after PH, lag=1)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph_st)))),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Primary (strata, lag=0)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata_st)))),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Alternative (strata, lag=1)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata_st))))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span>  <span class="co">#Min.    First quartile  Median  Mean    Third quartile  Max.</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(.,<span class="fu">paste0</span>(folder_path,<span class="st">"iiws_20240516.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(.,<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance(1) and no Polysubstance use (0)"</span>, <span class="at">escape=</span>T)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary descriptives, Polysubstance(1) and no Polysubstance use (0)</caption>
<colgroup>
<col style="width: 54%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;">3</th>
<th style="text-align: left;">4</th>
<th style="text-align: left;">5</th>
<th style="text-align: left;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Primary (no corrections, lag=0)</td>
<td style="text-align: left;">0.21</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.62</td>
<td style="text-align: left;">1.83</td>
<td style="text-align: left;">2.56</td>
<td style="text-align: left;">3.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alternative (no corrections, lag=1)</td>
<td style="text-align: left;">0.13</td>
<td style="text-align: left;">0.42</td>
<td style="text-align: left;">0.68</td>
<td style="text-align: left;">0.70</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary (after PH, lag=0)</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">0.67</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">1.33</td>
<td style="text-align: left;">1.90</td>
<td style="text-align: left;">3.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alternative (after PH, lag=1)</td>
<td style="text-align: left;">0.10</td>
<td style="text-align: left;">0.17</td>
<td style="text-align: left;">0.55</td>
<td style="text-align: left;">0.88</td>
<td style="text-align: left;">1.36</td>
<td style="text-align: left;">3.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary (strata, lag=0)</td>
<td style="text-align: left;">0.29</td>
<td style="text-align: left;">0.60</td>
<td style="text-align: left;">0.86</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">3.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alternative (strata, lag=1)</td>
<td style="text-align: left;">0.12</td>
<td style="text-align: left;">0.12</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.60</td>
<td style="text-align: left;">0.76</td>
<td style="text-align: left;">3.07</td>
</tr>
</tbody>
</table>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</section>
<section id="c.-intensity-model" class="level2">
<h2 class="anchored" data-anchor-id="c.-intensity-model">0.c. Intensity model</h2>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cox Counting process</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rdrr.io/github/gforge/Greg/src/R/tidy.rms.R</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"tidy_rms.R"</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>term_mapping <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">term =</span> <span class="fu">c</span>(<span class="st">"lag_tr_outcome"</span>, <span class="st">"lag_comp_bpsc_y3_severe"</span>, <span class="st">"lag_less_90d_tr1"</span>, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"log_lag_dias_treat_imp_sin_na"</span>, <span class="st">"lag_policonsumo2"</span>, <span class="st">"edad_al_ing_1"</span>, </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_pbc"</span>, </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"susinidum_mar"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"psycom_dum_with"</span>, <span class="st">"freq_cons_dum_5day"</span>, </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>, <span class="st">"lag_tr_outcome_rec"</span>, <span class="st">"lag_less_90d_tr1_rec"</span>, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">"lag_comp_bpsc_y3_severe_rec"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"psycom_dum_with_rec2"</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">term_label =</span> <span class="fu">c</span>(<span class="st">"Treatment outcome of the previous treatment"</span>, <span class="st">"Previous biopsychosocial compromise (severe)"</span>, </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Previous treatment duration (&lt;90 days)"</span>, <span class="st">"Previous treatment duration (in logarithmic scaled days)"</span>, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Polysubstance use status of the previous treatment"</span>, <span class="st">"Age at admission to treatment"</span>, <span class="st">"Birth year"</span>, </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Primary substance (initial diagnosis), alcohol"</span>, <span class="st">"Primary substance (initial diagnosis), cocaine"</span>, </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Primary substance (initial diagnosis), cocaine base paste"</span>, <span class="st">"Primary substance (initial diagnosis), marijuana"</span>, </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Psychiatric comorbidity (diagnosis unknown or under study)"</span>, <span class="st">"Psychiatric comorbidity (confirmed comorbidity)"</span>, </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Daily frequence of primary substance use at admission"</span>, <span class="st">"Occupational status (inactive)"</span>, <span class="st">"Occupational status (unemployed)"</span>, </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Primary substance at admission to treatment (alcohol)"</span>, <span class="st">"Primary substance at admission to treatment (cocaine hydrochloride)"</span>, </span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Primary substance at admission to treatment (cocaine base paste)"</span>, <span class="st">"Primary substance at admission to treatment (marijuana)"</span>, </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Treatment outcome of the previous treatment (recoded for interaction with time)"</span>, </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Previous biopsychosocial compromise (severe, recoded for interaction with time)"</span>, </span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Previous treatment duration (&lt;90 days, recoded for interaction with time)"</span>, </span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Primary substance (initial diagnosis), cocaine (recoded for interaction with time)"</span>, </span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Psychiatric comorbidity (confirmed comorbidity, recoded for interaction with time)"</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>cph_nocorr<span class="ot">&lt;-</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>        lag_tr_outcome<span class="sc">+</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>        lag_comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>        lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>        log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        ano_nac_corr <span class="sc">+</span> </span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>        susinidum_oh <span class="sc">+</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>        susinidum_coc <span class="sc">+</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>        susinidum_pbc <span class="sc">+</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>        susinidum_mar <span class="sc">+</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        psycom_dum_study <span class="sc">+</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>        psycom_dum_with <span class="sc">+</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>        freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>        cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>        cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>        susprindum_oh <span class="sc">+</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>        susprindum_coc <span class="sc">+</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>        susprindum_pbc <span class="sc">+</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>        susprindum_mar <span class="sc">+</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">strat</span>(tipo_de_plan_2_mod),</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>cph_after_ph<span class="ot">&lt;-</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span> </span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>                  lag_tr_outcome_rec <span class="sc">+</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>                  log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>                  lag_less_90d_tr1_rec<span class="sc">+</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>                  lag_comp_bpsc_y3_severe_rec <span class="sc">+</span> </span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>                  lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span> </span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>                  susprindum_oh <span class="sc">+</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar<span class="sc">+</span></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>data_mine_miss_restr_proc2, </span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>                <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Problemático"</span>)</span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a><span class="co"># broom::tidy(coxph(Surv(lag_time,time,event==1)~ </span></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a><span class="co">#         cluster(id)+ </span></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a><span class="co">#         lag_tr_outcome_rec +</span></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a><span class="co">#         log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a><span class="co">#         lag_less_90d_tr1_rec+</span></span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a><span class="co">#         lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a><span class="co">#         lag_policonsumo2 + </span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a><span class="co">#         edad_al_ing_1 + </span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a><span class="co">#         ano_nac_corr + </span></span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a><span class="co">#         susinidum_coc_rec2 +</span></span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a><span class="co">#         susinidum_oh +</span></span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a><span class="co">#         susinidum_pbc +</span></span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a><span class="co">#         susinidum_mar +</span></span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a><span class="co">#         psycom_dum_with_rec2 +</span></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a><span class="co">#         psycom_dum_study + </span></span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a><span class="co">#         freq_cons_dum_5day +</span></span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a><span class="co">#         cond_oc_dum_2inact +</span></span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a><span class="co">#         cond_oc_dum_3unemp +</span></span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a><span class="co">#         susprindum_oh +</span></span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a><span class="co">#         susprindum_coc +</span></span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a><span class="co">#         susprindum_pbc +</span></span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a><span class="co">#         susprindum_mar+</span></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a><span class="co">#         strata(tipo_de_plan_2_mod), </span></span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a><span class="co">#     data=data_mine_miss_restr_proc2), exponentiate=T, conf.int=T)</span></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a>models_hr_table2<span class="ot">&lt;-</span></span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"No correction"</span>, <span class="fu">tidy.rms</span>(cph_nocorr, <span class="at">conf.int=</span>T, <span class="at">exponentiate=</span>T)[, <span class="fu">c</span>(<span class="st">"term"</span>,<span class="st">"estimate"</span>, <span class="st">"conf.low"</span>, <span class="st">"conf.high"</span>)]<span class="sc">%&gt;%</span> </span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))),</span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"After PH"</span>, <span class="fu">tidy.rms</span>(cph_after_ph, <span class="at">conf.int=</span>T, <span class="at">exponentiate=</span>T)[, <span class="fu">c</span>(<span class="st">"term"</span>,<span class="st">"estimate"</span>, <span class="st">"conf.low"</span>, <span class="st">"conf.high"</span>)]<span class="sc">%&gt;%</span> </span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))),</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"Stratifying"</span>, <span class="fu">tidy.rms</span>(model_after_time_strat, <span class="at">conf.int=</span>T, <span class="at">exponentiate=</span>T)[, <span class="fu">c</span>(<span class="st">"term"</span>,<span class="st">"estimate"</span>, <span class="st">"conf.low"</span>, <span class="st">"conf.high"</span>)]<span class="sc">%&gt;%</span> </span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))),</span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"Stratifying, alt strata"</span>, <span class="fu">tidy.rms</span>(model_after_time_strat_alt, <span class="at">conf.int=</span>T, <span class="at">exponentiate=</span>T)[, <span class="fu">c</span>(<span class="st">"term"</span>,<span class="st">"estimate"</span>, <span class="st">"conf.low"</span>, <span class="st">"conf.high"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.)))</span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>models_hr_table2<span class="sc">$</span>term_label <span class="ot">&lt;-</span> term_mapping<span class="sc">$</span>term_label[<span class="fu">match</span>(models_hr_table2<span class="sc">$</span>term, term_mapping<span class="sc">$</span>term)]</span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>models_hr_table2<span class="sc">%&gt;%</span></span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(term_label, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a>    <span class="co">#copiar_nombres2(.)</span></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(.,<span class="fu">paste0</span>(folder_path,<span class="st">"coxph_intensity_model_prev.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(.,<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Intensity model"</span>, <span class="at">escape=</span>T)</span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Intensity model</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 14%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term_label</th>
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment outcome of the previous treatment</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">lag_tr_outcome</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">1.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous biopsychosocial compromise (severe)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">lag_comp_bpsc_y3_severe</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Previous treatment duration (&lt;90 days)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">lag_less_90d_tr1</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous treatment duration (in logarithmic scaled days)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">log_lag_dias_treat_imp_sin_na</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.96</td>
<td style="text-align: left;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Polysubstance use status of the previous treatment</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">lag_policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at admission to treatment</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">edad_al_ing_1</td>
<td style="text-align: left;">1.26</td>
<td style="text-align: left;">1.25</td>
<td style="text-align: left;">1.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Birth year</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">ano_nac_corr</td>
<td style="text-align: left;">1.27</td>
<td style="text-align: left;">1.26</td>
<td style="text-align: left;">1.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), alcohol</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susinidum_oh</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susinidum_coc</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine base paste</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susinidum_pbc</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), marijuana</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susinidum_mar</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">1.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric comorbidity (diagnosis unknown or under study)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">psycom_dum_study</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric comorbidity (confirmed comorbidity)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">psycom_dum_with</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Daily frequence of primary substance use at admission</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">freq_cons_dum_5day</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Occupational status (inactive)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">cond_oc_dum_2inact</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Occupational status (unemployed)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">cond_oc_dum_3unemp</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (alcohol)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susprindum_oh</td>
<td style="text-align: left;">0.90</td>
<td style="text-align: left;">0.80</td>
<td style="text-align: left;">1.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine hydrochloride)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susprindum_coc</td>
<td style="text-align: left;">0.90</td>
<td style="text-align: left;">0.79</td>
<td style="text-align: left;">1.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine base paste)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susprindum_pbc</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (marijuana)</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: left;">susprindum_mar</td>
<td style="text-align: left;">0.89</td>
<td style="text-align: left;">0.78</td>
<td style="text-align: left;">1.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment outcome of the previous treatment (recoded for interaction with time)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">lag_tr_outcome_rec</td>
<td style="text-align: left;">0.09</td>
<td style="text-align: left;">0.08</td>
<td style="text-align: left;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous treatment duration (in logarithmic scaled days)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">log_lag_dias_treat_imp_sin_na</td>
<td style="text-align: left;">0.90</td>
<td style="text-align: left;">0.87</td>
<td style="text-align: left;">0.92</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Previous biopsychosocial compromise (severe, recoded for interaction with time)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">lag_less_90d_tr1_rec</td>
<td style="text-align: left;">0.62</td>
<td style="text-align: left;">0.49</td>
<td style="text-align: left;">0.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous treatment duration (&lt;90 days, recoded for interaction with time)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">lag_comp_bpsc_y3_severe_rec</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Polysubstance use status of the previous treatment</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">lag_policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at admission to treatment</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">edad_al_ing_1</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">1.19</td>
<td style="text-align: left;">1.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Birth year</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">ano_nac_corr</td>
<td style="text-align: left;">1.21</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">1.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine (recoded for interaction with time)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susinidum_coc_rec2</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), alcohol</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susinidum_oh</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.93</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine base paste</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susinidum_pbc</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">1.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), marijuana</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susinidum_mar</td>
<td style="text-align: left;">1.16</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric comorbidity (confirmed comorbidity, recoded for interaction with time)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">psycom_dum_with_rec2</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric comorbidity (diagnosis unknown or under study)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">psycom_dum_study</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">1.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Daily frequence of primary substance use at admission</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">freq_cons_dum_5day</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Occupational status (inactive)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">cond_oc_dum_2inact</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Occupational status (unemployed)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">cond_oc_dum_3unemp</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (alcohol)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susprindum_oh</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.87</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine hydrochloride)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susprindum_coc</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.85</td>
<td style="text-align: left;">1.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine base paste)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susprindum_pbc</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (marijuana)</td>
<td style="text-align: left;">After PH</td>
<td style="text-align: left;">susprindum_mar</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">0.82</td>
<td style="text-align: left;">1.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment outcome of the previous treatment</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">lag_tr_outcome</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">1.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous biopsychosocial compromise (severe)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">lag_comp_bpsc_y3_severe</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Previous treatment duration (&lt;90 days)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">lag_less_90d_tr1</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous treatment duration (in logarithmic scaled days)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">log_lag_dias_treat_imp_sin_na</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.96</td>
<td style="text-align: left;">1.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Polysubstance use status of the previous treatment</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">lag_policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at admission to treatment</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">edad_al_ing_1</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">1.21</td>
<td style="text-align: left;">1.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Birth year</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">ano_nac_corr</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">1.21</td>
<td style="text-align: left;">1.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), alcohol</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susinidum_oh</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susinidum_coc</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine base paste</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susinidum_pbc</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), marijuana</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susinidum_mar</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">1.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric comorbidity (diagnosis unknown or under study)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">psycom_dum_study</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric comorbidity (confirmed comorbidity)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">psycom_dum_with</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Daily frequence of primary substance use at admission</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">freq_cons_dum_5day</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Occupational status (inactive)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">cond_oc_dum_2inact</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Occupational status (unemployed)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">cond_oc_dum_3unemp</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (alcohol)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susprindum_oh</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine hydrochloride)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susprindum_coc</td>
<td style="text-align: left;">0.93</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine base paste)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susprindum_pbc</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">0.83</td>
<td style="text-align: left;">1.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (marijuana)</td>
<td style="text-align: left;">Stratifying</td>
<td style="text-align: left;">susprindum_mar</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">0.80</td>
<td style="text-align: left;">1.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment outcome of the previous treatment</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">lag_tr_outcome</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous biopsychosocial compromise (severe)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">lag_comp_bpsc_y3_severe</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Previous treatment duration (&lt;90 days)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">lag_less_90d_tr1</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Previous treatment duration (in logarithmic scaled days)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">log_lag_dias_treat_imp_sin_na</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.96</td>
<td style="text-align: left;">0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Polysubstance use status of the previous treatment</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">lag_policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at admission to treatment</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">edad_al_ing_1</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Birth year</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">ano_nac_corr</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), alcohol</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susinidum_oh</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.88</td>
<td style="text-align: left;">1.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susinidum_coc</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance (initial diagnosis), cocaine base paste</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susinidum_pbc</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.89</td>
<td style="text-align: left;">1.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance (initial diagnosis), marijuana</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susinidum_mar</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.89</td>
<td style="text-align: left;">1.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric comorbidity (diagnosis unknown or under study)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">psycom_dum_study</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.96</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric comorbidity (confirmed comorbidity)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">psycom_dum_with</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Daily frequence of primary substance use at admission</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">freq_cons_dum_5day</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Occupational status (inactive)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">cond_oc_dum_2inact</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Occupational status (unemployed)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">cond_oc_dum_3unemp</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (alcohol)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susprindum_oh</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine hydrochloride)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susprindum_coc</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary substance at admission to treatment (cocaine base paste)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susprindum_pbc</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.93</td>
<td style="text-align: left;">1.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary substance at admission to treatment (marijuana)</td>
<td style="text-align: left;">Stratifying, alt strata</td>
<td style="text-align: left;">susprindum_mar</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.93</td>
<td style="text-align: left;">1.24</td>
</tr>
</tbody>
</table>
</div>
<div class="message">
<p>Time for this code chunk to run: 0.1 minutes</p>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="gee" class="level1">
<h1>GEE</h1>
<section id="no-correction" class="level2">
<h2 class="anchored" data-anchor-id="no-correction">1. No correction</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plan_names <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">table</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod),<span class="st">"dimnames"</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<section id="no-correciton-no-weight" class="level3">
<h3 class="anchored" data-anchor-id="no-correciton-no-weight">1.1. No correciton, no weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nocorr_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, <span class="co">#origen_ingreso_mod fis_comorbidity_icd_10 dg_trs_cons_sus_or</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  nocorr_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="no-correction-no-weight-geem-poisson" class="level4">
<h4 class="anchored" data-anchor-id="no-correction-no-weight-geem-poisson">1.1.1 No correction, no weight, GEEM Poisson</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>geem_nocorr_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  geem_nocorr_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19452.9
QIC for plan GP intensive ambulatory = 22259.1
QIC for plan GP residential = 9817.2
QIC for plan WO intensive ambulatory = 3420.7
QIC for plan WO residential = 4823.9</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="no-correction-no-weight-geem-negative-binomial" class="level4">
<h4 class="anchored" data-anchor-id="no-correction-no-weight-geem-negative-binomial">1.1.2 No correction, no weight, GEEM Negative binomial</h4>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.2</span>, <span class="dv">16</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>geem2_nocorr_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  geem2_nocorr_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 16.0: 19837.659226
Best QIC for plan GP intensive ambulatory with x = 16.0: 22683.953264
Best QIC for plan GP residential with x = 16.0: 9978.176797
Best QIC for plan WO intensive ambulatory with x = 16.0: 3484.239060
Best QIC for plan WO residential with x = 16.0: 4906.757273</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
<section id="no-correction-weight" class="level3">
<h3 class="anchored" data-anchor-id="no-correction-weight">1.2. No correction, weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>nocorr_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_nocorr_st,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  nocorr_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="no-correction-no-weight-geem-poisson-1" class="level4">
<h4 class="anchored" data-anchor-id="no-correction-no-weight-geem-poisson-1">1.2.1 No correction, no weight, GEEM Poisson</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>geem_nocorr_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_nocorr_st,</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  geem_nocorr_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19463.5
QIC for plan GP intensive ambulatory = 22272.1
QIC for plan GP residential = 9832.0
QIC for plan WO intensive ambulatory = 3431.1
QIC for plan WO residential = 4836.4</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="no-correction-no-weight-geem-negative-binomial-1" class="level4">
<h4 class="anchored" data-anchor-id="no-correction-no-weight-geem-negative-binomial-1">1.2.2 No correction, no weight, GEEM Negative binomial</h4>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>geem2_nocorr_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_nocorr_st,</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>  geem2_nocorr_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19463.524238
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22272.106976
Best QIC for plan GP residential with x = 1588300.0: 9832.041378
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3431.119178
Best QIC for plan WO residential with x = 1588300.0: 4836.385892</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_nocorr_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence", weights = current_data$iiw_nocorr_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
      -10.61      0.02189            -0.03804     -0.001731     0.005225
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
    -0.005585      -0.01344       0.09384       0.01666           0.1063
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.03234            0.03977           -0.05299           0.002616
 susprindum_coc susprindum_pbc susprindum_mar
        0.02127        0.04876        0.01099

 Scale Parameter:  0.4019 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 1588300

$best_qic
     QIC 
19463.52 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
<section id="no-correction-alt.-weight" class="level3">
<h3 class="anchored" data-anchor-id="no-correction-alt.-weight">1.3. No correction, alt. weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>nocorr_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_nocorr_alt_st,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  nocorr_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="no-correction-alt-weight-geem-poisson" class="level4">
<h4 class="anchored" data-anchor-id="no-correction-alt-weight-geem-poisson">1.3.1 No correction, alt weight, GEEM Poisson</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>geem_nocorr_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_nocorr_alt_st,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  geem_nocorr_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19457.6
QIC for plan GP intensive ambulatory = 22268.1
QIC for plan GP residential = 9826.1
QIC for plan WO intensive ambulatory = 3426.6
QIC for plan WO residential = 4831.9</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="no-correction-alt-weight-geem-negative-binomial" class="level4">
<h4 class="anchored" data-anchor-id="no-correction-alt-weight-geem-negative-binomial">1.3.2 No correction, alt weight, GEEM Negative binomial</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>geem2_nocorr_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_nocorr_alt_st,</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>  geem2_nocorr_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19457.646069
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22268.120241
Best QIC for plan GP residential with x = 1588300.0: 9826.117679
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3426.650151
Best QIC for plan WO residential with x = 1588300.0: 4831.902116</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_nocorr_alt_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence", weights = current_data$iiw_nocorr_alt_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
      -20.35       0.0239            -0.03676      0.004034      0.01008
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
       -0.047      -0.05472        0.0478      -0.02439           0.1475
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.04002            0.03536            -0.0441            0.01231
 susprindum_coc susprindum_pbc susprindum_mar
         0.0201        0.05564        0.01495

 Scale Parameter:  0.1465 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 1588300

$best_qic
     QIC 
19457.65 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="after-ph" class="level2">
<h2 class="anchored" data-anchor-id="after-ph">2. After PH</h2>
<section id="after-ph-no-weight" class="level3">
<h3 class="anchored" data-anchor-id="after-ph-no-weight">2.1. After PH, no weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>afterph_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#weight= current_data$iiw_nocorr_alt_st,</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>  afterph_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="after-ph-no-weight-geem-poisson" class="level5">
<h5 class="anchored" data-anchor-id="after-ph-no-weight-geem-poisson">2.1.1 After PH, no weight, GEEM Poisson</h5>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>geem_afterph_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  geem_afterph_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19452.9
QIC for plan GP intensive ambulatory = 22259.1
QIC for plan GP residential = 9817.2
QIC for plan WO intensive ambulatory = 3420.7
QIC for plan WO residential = 4823.9</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="after-ph-no-weight-geem-negative-binomial" class="level5">
<h5 class="anchored" data-anchor-id="after-ph-no-weight-geem-negative-binomial">2.1.2 After PH, no weight, GEEM Negative binomial</h5>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>geem2_afterph_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>  geem2_afterph_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19452.859311
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22259.103757
Best QIC for plan GP residential with x = 1588300.0: 9817.174703
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3420.678029
Best QIC for plan WO residential with x = 1588300.0: 4823.862856</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_nocorr_nowgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence")

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
       -13.6      0.02456            -0.03807     0.0002854      0.00671
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
     -0.02603      -0.03205       0.07191     -0.005039           0.1381
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.04258            0.03825           -0.04741           0.008813
 susprindum_coc susprindum_pbc susprindum_mar
        0.02286        0.05593        0.01603

 Scale Parameter:  0.2033 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 16

$best_qic
     QIC 
19837.66 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>As expected, QIC is equal, because the covariates and observations were the same</p>
</section>
<section id="after-ph-weight" class="level4">
<h4 class="anchored" data-anchor-id="after-ph-weight">2.2. After PH, weight</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>afterph_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_after_ph_st,</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>  afterph_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="after-ph-weight-geem-poisson" class="level5">
<h5 class="anchored" data-anchor-id="after-ph-weight-geem-poisson">2.2.1 After PH, weight, GEEM Poisson</h5>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>geem_afterph_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_after_ph_st,</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>  geem_afterph_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19477.3
QIC for plan GP intensive ambulatory = 22280.5
QIC for plan GP residential = 9828.8
QIC for plan WO intensive ambulatory = 3441.0
QIC for plan WO residential = 4837.1</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="after-ph-weight-geem-negative-binomial" class="level5">
<h5 class="anchored" data-anchor-id="after-ph-weight-geem-negative-binomial">2.2.2 After PH, weight, GEEM Negative binomial</h5>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>geem2_afterph_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_after_ph_st,</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a>  geem2_afterph_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19477.330613
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22280.505800
Best QIC for plan GP residential with x = 1588300.0: 9828.771323
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3441.006449
Best QIC for plan WO residential with x = 1588300.0: 4837.095539</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_afterph_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence", weights = current_data$iiw_after_ph_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
      -7.364      0.02673            -0.04224     -0.004199     0.003616
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
    -0.006053      -0.02596        0.1091       0.01588           0.1132
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.03647            0.04507           -0.05523         -0.0001896
 susprindum_coc susprindum_pbc susprindum_mar
        0.01954        0.04772        0.01295

 Scale Parameter:  0.2933 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 1588300

$best_qic
     QIC 
19477.33 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
<section id="after-ph-alt.-weight" class="level4">
<h4 class="anchored" data-anchor-id="after-ph-alt.-weight">2.3. After PH, alt. weight</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>afterph_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_after_ph_st,</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>  afterph_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="after-ph-alt-weight-geem-poisson" class="level5">
<h5 class="anchored" data-anchor-id="after-ph-alt-weight-geem-poisson">2.3.1 After PH, alt weight, GEEM Poisson</h5>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>geem_afterph_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_after_ph_st,</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>  geem_afterph_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19514.7
QIC for plan GP intensive ambulatory = 22318.8
QIC for plan GP residential = 9865.7
QIC for plan WO intensive ambulatory = 3463.6
QIC for plan WO residential = 4857.5</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="after-ph-alt-weight-geem-negative-binomial" class="level5">
<h5 class="anchored" data-anchor-id="after-ph-alt-weight-geem-negative-binomial">2.3.2 After PH, alt weight, GEEM Negative binomial</h5>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>geem2_afterph_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_after_ph_st,</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a>  geem2_afterph_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19514.731908
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22318.800489
Best QIC for plan GP residential with x = 1588300.0: 9865.659326
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3463.577861
Best QIC for plan WO residential with x = 1588300.0: 4857.472774</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_afterph_alt_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence", weights = current_data$iiw_after_ph_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
      -1.469      0.02693            -0.03716     -0.006975    0.0006665
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
    -0.002571      -0.05228        0.1382       0.02789          0.09835
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.03848            0.03841           -0.06761            0.00109
 susprindum_coc susprindum_pbc susprindum_mar
        0.04242        0.06639        0.04758

 Scale Parameter:  0.2291 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 1588300

$best_qic
     QIC 
19514.73 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="stratifying" class="level2">
<h2 class="anchored" data-anchor-id="stratifying">3. Stratifying</h2>
<section id="stratifying-no-weight" class="level3">
<h3 class="anchored" data-anchor-id="stratifying-no-weight">3.1. Stratifying, no weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>strata_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#weight= current_data$iiw_nocorr_alt_st,</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>  strata_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="stratifying-no-weight-geem-poisson" class="level4">
<h4 class="anchored" data-anchor-id="stratifying-no-weight-geem-poisson">3.1.1 Stratifying, no weight, GEEM Poisson</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>geem_strata_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>  geem_strata_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19452.9
QIC for plan GP intensive ambulatory = 22259.1
QIC for plan GP residential = 9817.2
QIC for plan WO intensive ambulatory = 3420.7
QIC for plan WO residential = 4823.9</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="stratifying-no-weight-geem-negative-binomial" class="level4">
<h4 class="anchored" data-anchor-id="stratifying-no-weight-geem-negative-binomial">3.1.2 Stratifying, no weight, GEEM Negative binomial</h4>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>geem2_strata_nowgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a>  geem2_strata_nowgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19452.859311
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22259.103757
Best QIC for plan GP residential with x = 1588300.0: 9817.174703
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3420.678029
Best QIC for plan WO residential with x = 1588300.0: 4823.862856</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_nocorr_nowgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence")

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
       -13.6      0.02456            -0.03807     0.0002854      0.00671
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
     -0.02603      -0.03205       0.07191     -0.005039           0.1381
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.04258            0.03825           -0.04741           0.008813
 susprindum_coc susprindum_pbc susprindum_mar
        0.02286        0.05593        0.01603

 Scale Parameter:  0.2033 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 16

$best_qic
     QIC 
19837.66 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
<section id="stratifying-weight" class="level3">
<h3 class="anchored" data-anchor-id="stratifying-weight">3.2. Stratifying, weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>strata_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>  strata_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<section id="stratifying-weight-geem-poisson" class="level4">
<h4 class="anchored" data-anchor-id="stratifying-weight-geem-poisson">3.2.1 Stratifying, weight, GEEM Poisson</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>geem_strata_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>  geem_strata_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19474.7
QIC for plan GP intensive ambulatory = 22278.5
QIC for plan GP residential = 9836.9
QIC for plan WO intensive ambulatory = 3448.0
QIC for plan WO residential = 4846.9</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="stratifying-weight-geem-negative-binomial" class="level4">
<h4 class="anchored" data-anchor-id="stratifying-weight-geem-negative-binomial">3.2.2 Stratifying, weight, GEEM Negative binomial</h4>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>geem2_strata_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>  geem2_strata_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19474.655577
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22278.508415
Best QIC for plan GP residential with x = 1588300.0: 9836.896101
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3447.966293
Best QIC for plan WO residential with x = 1588300.0: 4846.887954</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_strata_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence", weights = current_data$iiw_strata_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
      -16.29      0.01875            -0.05527     0.0007608     0.008063
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
     -0.02828      -0.02526       0.07169     -0.007385           0.1432
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.04889            0.05325           -0.05521            0.01004
 susprindum_coc susprindum_pbc susprindum_mar
       0.004831        0.05051        0.05006

 Scale Parameter:  0.3844 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 1588300

$best_qic
     QIC 
19474.66 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
<section id="stratifying-alt.-weight" class="level3">
<h3 class="anchored" data-anchor-id="stratifying-alt.-weight">3.3. Stratifying, alt. weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>strata_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>  strata_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0.1 minutes</p>
</div>
</div>
</div>
<section id="stratifying-alt-weight-geem-poisson" class="level4">
<h4 class="anchored" data-anchor-id="stratifying-alt-weight-geem-poisson">3.3.1 Stratifying, alt weight, GEEM Poisson</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>geem_strata_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>  geem_strata_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19465.3
QIC for plan GP intensive ambulatory = 22265.5
QIC for plan GP residential = 9836.6
QIC for plan WO intensive ambulatory = 3434.3
QIC for plan WO residential = 4839.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternative, better than main</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem_strata_alt_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = poisson("log"), corstr = "independence", 
    weights = current_data$iiw_strata_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
       -11.3      0.03747            -0.04022    -0.0003548     0.005561
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
     -0.05105      -0.07084       0.05422      -0.02786           0.1538
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.05553            0.03225           -0.04092            0.01214
 susprindum_coc susprindum_pbc susprindum_mar
        0.03123        0.05375         0.0231

 Scale Parameter:  0.1917 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
<section id="no-correction-alt-weight-geem-negative-binomial-1" class="level4">
<h4 class="anchored" data-anchor-id="no-correction-alt-weight-geem-negative-binomial-1">3.3.2 No correction, alt weight, GEEM Negative binomial</h4>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>geem2_strata_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb124-39"><a href="#cb124-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb124-40"><a href="#cb124-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb124-41"><a href="#cb124-41" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb124-42"><a href="#cb124-42" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb124-43"><a href="#cb124-43" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb124-44"><a href="#cb124-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb124-45"><a href="#cb124-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb124-46"><a href="#cb124-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb124-47"><a href="#cb124-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-48"><a href="#cb124-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb124-49"><a href="#cb124-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb124-50"><a href="#cb124-50" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb124-51"><a href="#cb124-51" aria-hidden="true" tabindex="-1"></a>  geem2_strata_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb124-52"><a href="#cb124-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-53"><a href="#cb124-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb124-54"><a href="#cb124-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb124-55"><a href="#cb124-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19465.272825
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22265.468428
Best QIC for plan GP residential with x = 1588300.0: 9836.569114
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3434.328777
Best QIC for plan WO residential with x = 1588300.0: 4839.328501</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_strata_alt_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence", weights = current_data$iiw_strata_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
       -11.3      0.03747            -0.04022    -0.0003548     0.005561
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
     -0.05105      -0.07084       0.05422      -0.02786           0.1538
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.05553            0.03225           -0.04092            0.01214
 susprindum_coc susprindum_pbc susprindum_mar
        0.03123        0.05375         0.0231

 Scale Parameter:  0.1917 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 1588300

$best_qic
     QIC 
19465.27 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
</section>
</section>
<section id="stratifying-2nd-alt.-weight" class="level3">
<h3 class="anchored" data-anchor-id="stratifying-2nd-alt.-weight">3.4. Stratifying, 2nd alt. weight</h3>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>strata_alt_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata_alt_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geese</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>                   comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>                   edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>                   ano_nac_corr <span class="sc">+</span> </span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>                   susinidum_oh <span class="sc">+</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>                   susinidum_coc <span class="sc">+</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>                   susinidum_pbc <span class="sc">+</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>                   susinidum_mar <span class="sc">+</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_study <span class="sc">+</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>                   psycom_dum_with <span class="sc">+</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>                   freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>                   cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>                   susprindum_coc <span class="sc">+</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>                   susprindum_pbc <span class="sc">+</span></span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>                   susprindum_mar, </span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> id, </span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> current_data,</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">corstr =</span> <span class="st">"independence"</span>, </span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">jack =</span> T)</span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a>  strata_alt_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0.1 minutes</p>
</div>
</div>
</div>
<section id="stratifying-alt-weight-geem-poisson-1" class="level4">
<h4 class="anchored" data-anchor-id="stratifying-alt-weight-geem-poisson-1">3.4.1 Stratifying, alt weight, GEEM Poisson</h4>
<p>Initialize a list to store models</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>geem_strata_alt_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit a model</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata_alt_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the GEE model for the current subset using geem</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>                  comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>                  edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                  ano_nac_corr <span class="sc">+</span> </span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>                  susinidum_oh <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>                  susinidum_coc <span class="sc">+</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>                  susinidum_pbc <span class="sc">+</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>                  susinidum_mar <span class="sc">+</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_study <span class="sc">+</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>                  psycom_dum_with <span class="sc">+</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>                  freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>                  cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>                  susprindum_coc <span class="sc">+</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>                  susprindum_pbc <span class="sc">+</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>                  susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> id, </span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> current_data,</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="st">"log"</span>), </span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign the model to the list with a name based on the plan name</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(model<span class="sc">$</span>converged<span class="sc">==</span><span class="cn">FALSE</span>){<span class="fu">stop</span>(<span class="st">"model did not coverge"</span>)}</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"QIC for plan %s = %.1f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], <span class="fu">as.numeric</span>(MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model))))</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>  geem_strata_alt_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> model</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>QIC for plan basic ambulatory = 19502.8
QIC for plan GP intensive ambulatory = 22276.1
QIC for plan GP residential = 9883.8
QIC for plan WO intensive ambulatory = 3465.0
QIC for plan WO residential = 4870.0</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Alternative, worst model of strata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</section>
<section id="stratifying-alt-weight-geem-negative-binomial" class="level4">
<h4 class="anchored" data-anchor-id="stratifying-alt-weight-geem-negative-binomial">3.4.2 Stratifying, alt weight, GEEM Negative binomial</h4>
<p>Define a sequence of x values</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">158e4</span>, <span class="fl">159e4</span>, <span class="at">by =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Initialize a list to store models and their QICs</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>geem2_strata_alt_alt_wgt_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<p>Loop over each unique plan name to fit models</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plan_names)) {</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  current_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_mine_miss_proc2_iiw_strata_alt_alt, tipo_de_plan_2_mod <span class="sc">==</span> plan_names[i])</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variable to store the best QIC and associated model</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  best_qic <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  best_x <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop through each x value to find the one with the lowest QIC</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (x <span class="cf">in</span> x_values) {</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the GEE model for the current subset using geem with negative binomial</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">geem</span>(tr_outcome <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>                    comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>                    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>                    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>                    susinidum_oh <span class="sc">+</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>                    susinidum_coc <span class="sc">+</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>                    susinidum_pbc <span class="sc">+</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>                    susinidum_mar <span class="sc">+</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_study <span class="sc">+</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>                    psycom_dum_with <span class="sc">+</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>                    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>                    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>                    susprindum_coc <span class="sc">+</span></span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>                    susprindum_pbc <span class="sc">+</span></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>                    susprindum_mar, <span class="co"># Include relevant predictors</span></span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> id, </span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> current_data,</span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weight=</span> current_data<span class="sc">$</span>iiw_strata_st,</span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> MASS<span class="sc">::</span><span class="fu">negative.binomial</span>(x),</span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">corstr =</span> <span class="st">"independence"</span>)</span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (model<span class="sc">$</span>converged) {</span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate QIC for the model</span></span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a>      model_qic <span class="ot">&lt;-</span> MuMIn<span class="sc">::</span><span class="fu">QIC</span>(model)</span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if this model has a better QIC</span></span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (model_qic <span class="sc">&lt;</span> best_qic) {</span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a>        best_qic <span class="ot">&lt;-</span> model_qic</span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a>        best_model <span class="ot">&lt;-</span> model</span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a>        best_x <span class="ot">&lt;-</span> x</span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb136-46"><a href="#cb136-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb136-47"><a href="#cb136-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-48"><a href="#cb136-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the best model and its details in the list</span></span>
<span id="cb136-49"><a href="#cb136-49" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, plan_names[i])</span>
<span id="cb136-50"><a href="#cb136-50" aria-hidden="true" tabindex="-1"></a>  model_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^[:alnum:]_]"</span>, <span class="st">""</span>, model_name)  <span class="co"># Clean up non-alphanumeric characters</span></span>
<span id="cb136-51"><a href="#cb136-51" aria-hidden="true" tabindex="-1"></a>  geem2_strata_alt_alt_wgt_list[[<span class="fu">paste</span>(<span class="st">"model"</span>, model_name, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">best_model =</span> best_model, <span class="at">best_x =</span> best_x, <span class="at">best_qic =</span> best_qic)</span>
<span id="cb136-52"><a href="#cb136-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-53"><a href="#cb136-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optional: Print out some information on progress</span></span>
<span id="cb136-54"><a href="#cb136-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Best QIC for plan %s with x = %.1f: %f</span><span class="sc">\n</span><span class="st">"</span>, plan_names[i], best_x, best_qic))</span>
<span id="cb136-55"><a href="#cb136-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best QIC for plan basic ambulatory with x = 1588300.0: 19502.791693
Best QIC for plan GP intensive ambulatory with x = 1588300.0: 22276.077226
Best QIC for plan GP residential with x = 1588300.0: 9883.785634
Best QIC for plan WO intensive ambulatory with x = 1588300.0: 3464.955833
Best QIC for plan WO residential with x = 1588300.0: 4869.985646</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p>Check the result for a particular plan</p>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geem2_strata_alt_alt_wgt_list[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$best_model
geem(formula = tr_outcome ~ policonsumo2 + comp_bpsc_y3_severe + 
    edad_al_ing_1 + ano_nac_corr + susinidum_oh + susinidum_coc + 
    susinidum_pbc + susinidum_mar + psycom_dum_study + psycom_dum_with + 
    freq_cons_dum_5day + cond_oc_dum_2inact + cond_oc_dum_3unemp + 
    susprindum_coc + susprindum_pbc + susprindum_mar, id = id, 
    data = current_data, family = MASS::negative.binomial(x), 
    corstr = "independence", weights = current_data$iiw_strata_st)

 Coefficients: 
 (Intercept) policonsumo2 comp_bpsc_y3_severe edad_al_ing_1 ano_nac_corr
      -14.96      0.02853            -0.05128      0.002697     0.007361
 susinidum_oh susinidum_coc susinidum_pbc susinidum_mar psycom_dum_study
     -0.05388        -0.107       0.04686      -0.04455           0.1789
 psycom_dum_with freq_cons_dum_5day cond_oc_dum_2inact cond_oc_dum_3unemp
         0.06483            0.01707           -0.04182            0.02534
 susprindum_coc susprindum_pbc susprindum_mar
        0.02499        0.06112         0.0184

 Scale Parameter:  0.1097 

 Correlation Model:  independence
 Estimated Correlation Parameter:  0 

 Number of clusters:  4360   Maximum cluster size:  10 
 Number of observations with nonzero weight:  9993 

$best_x
[1] 1588300

$best_qic
     QIC 
19502.79 </code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
</section>
</section>
<section id="model-output" class="level1">
<h1>Model output</h1>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>types_of_model<span class="ot">&lt;-</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"No correction"</span>,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No correction, main"</span>,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No correction, alternative"</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, no weight"</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, main"</span>,</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, alternative"</span>,</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratifying, no weight"</span>,</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratifying, main"</span>,</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratifying, alternative"</span>,</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratifying, 2nd alternative, main"</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>types_of_model2<span class="ot">&lt;-</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"No correction"</span>,</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No correction, NB"</span>,</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No correction, main"</span>,</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No correction, main, NB"</span>,</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No correction, alternative"</span>,</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No correction, alternative, NB"</span>,</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, no weight"</span>,</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, no weight, NB"</span>,</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, main"</span>,</span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, main, NB"</span>,</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, alternative"</span>,</span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Correction for PH, alternative, NB"</span>,</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, no weight"</span>,</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, no weight, NB"</span>,</span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, main"</span>,</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, main, NB"</span>,</span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, alternative"</span>,</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, alternative, NB"</span>,</span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, 2nd alternative"</span>,</span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stratified, 2nd alternative, NB"</span>    </span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>plan_names[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "basic ambulatory"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model,</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_nowgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_wgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_alt_wgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_nowgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_wgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_alt_wgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_nowgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_wgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_wgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_alt_wgt_list[[<span class="dv">1</span>]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>)))<span class="sc">%&gt;%</span> </span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"result_data_geese_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,plan_names[<span class="dv">1</span>])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model         Term Estimate Std.Error z.value
1                       No correction policonsumo2     1.02      0.01    1.78
2                 No correction, main policonsumo2     1.02      0.02    1.38
3          No correction, alternative policonsumo2     1.02      0.01    1.73
4        Correction for PH, no weight policonsumo2     1.02      0.01    1.78
5             Correction for PH, main policonsumo2     1.03      0.02    1.50
6      Correction for PH, alternative policonsumo2     1.03      0.02    1.22
7              Stratifying, no weight policonsumo2     1.02      0.01    1.78
8                   Stratifying, main policonsumo2     1.03      0.02    1.31
9            Stratifying, alternative policonsumo2     1.02      0.02    1.35
10 Stratifying, 2nd alternative, main policonsumo2     1.04      0.02    1.57
   p.value CI.Lower CI.Upper
1   0.0750     1.00     1.05
2   0.1665     0.99     1.05
3   0.0838     1.00     1.05
4   0.0750     1.00     1.05
5   0.1328     0.99     1.06
6   0.2209     0.98     1.07
7   0.0754     1.00     1.05
8   0.1904     0.99     1.06
9   0.1760     0.99     1.06
10  0.1168     0.99     1.09</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model2,</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">QIC=</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_nowgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_nocorr_nowgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_wgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_nocorr_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_alt_wgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_nocorr_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_nowgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_afterph_nowgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_wgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_afterph_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_alt_wgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_afterph_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_nowgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_strata_nowgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_wgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_strata_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_wgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_strata_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic),</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_alt_wgt_list[[<span class="dv">1</span>]])),</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(geem2_strata_alt_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_qic)                        </span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rbind.data.frame</span>(</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_nowgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_nowgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_wgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_alt_wgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_nowgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_nowgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_wgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_alt_wgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb144-38"><a href="#cb144-38" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_nowgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-39"><a href="#cb144-39" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_nowgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),                   </span>
<span id="cb144-40"><a href="#cb144-40" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_wgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-41"><a href="#cb144-41" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-42"><a href="#cb144-42" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_wgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-43"><a href="#cb144-43" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-44"><a href="#cb144-44" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_alt_wgt_list[[<span class="dv">1</span>]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb144-45"><a href="#cb144-45" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_alt_wgt_list[[<span class="dv">1</span>]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>)</span>
<span id="cb144-46"><a href="#cb144-46" aria-hidden="true" tabindex="-1"></a>       ))<span class="sc">%&gt;%</span> </span>
<span id="cb144-47"><a href="#cb144-47" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb144-48"><a href="#cb144-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb144-49"><a href="#cb144-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"result_data_geem_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,plan_names[<span class="dv">1</span>])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb144-50"><a href="#cb144-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb144-51"><a href="#cb144-51" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model      QIC         Term Estimates Model SE
1                       No correction 19452.86 policonsumo2      1.02     0.01
2                   No correction, NB 19837.66 policonsumo2      1.02     0.01
3                 No correction, main 19463.52 policonsumo2      1.02     0.01
4             No correction, main, NB 19463.52 policonsumo2      1.02     0.01
5          No correction, alternative 19457.64 policonsumo2      1.02     0.01
6      No correction, alternative, NB 19457.65 policonsumo2      1.02     0.01
7        Correction for PH, no weight 19452.86 policonsumo2      1.02     0.01
8    Correction for PH, no weight, NB 19452.86 policonsumo2      1.02     0.01
9             Correction for PH, main 19477.33 policonsumo2      1.03     0.01
10        Correction for PH, main, NB 19477.33 policonsumo2      1.03     0.01
11     Correction for PH, alternative 19514.73 policonsumo2      1.03     0.02
12 Correction for PH, alternative, NB 19514.73 policonsumo2      1.03     0.02
13              Stratified, no weight 19452.86 policonsumo2      1.02     0.01
14          Stratified, no weight, NB 19452.86 policonsumo2      1.02     0.01
15                   Stratified, main 19474.65 policonsumo2      1.02     0.01
16               Stratified, main, NB 19474.66 policonsumo2      1.02     0.01
17            Stratified, alternative 19465.27 policonsumo2      1.04     0.01
18        Stratified, alternative, NB 19465.27 policonsumo2      1.04     0.01
19        Stratified, 2nd alternative 19502.79 policonsumo2      1.03     0.01
20    Stratified, 2nd alternative, NB 19502.79 policonsumo2      1.03     0.01
   Robust SE Wald CI.lower CI.upper p.value
1       0.01 1.78     1.00     1.05   0.075
2       0.01 1.78     1.00     1.05  0.0759
3       0.02 1.38     0.99     1.05  0.1665
4       0.02 1.38     0.99     1.05  0.1665
5       0.01 1.73     1.00     1.05  0.0838
6       0.01 1.73     1.00     1.05  0.0838
7       0.01 1.78     1.00     1.05   0.075
8       0.01 1.78     1.00     1.05   0.075
9       0.02 1.50     0.99     1.06  0.1328
10      0.02 1.50     0.99     1.06  0.1328
11      0.02 1.22     0.98     1.07  0.2209
12      0.02 1.22     0.98     1.07  0.2209
13      0.01 1.78     1.00     1.05   0.075
14      0.01 1.78     1.00     1.05   0.075
15      0.02 1.06     0.98     1.05   0.287
16      0.02 1.06     0.98     1.05   0.287
17      0.02 2.32     1.01     1.07  0.0202
18      0.02 2.32     1.01     1.07  0.0202
19      0.02 1.40     0.99     1.07  0.1613
20      0.02 1.40     0.99     1.07  0.1613</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>plan_names[i]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "GP intensive ambulatory"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model,</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>)))<span class="sc">%&gt;%</span> </span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)  </span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model         Term Estimate Std.Error z.value
1                       No correction policonsumo2     1.04      0.01    2.61
2                 No correction, main policonsumo2     1.04      0.02    2.54
3          No correction, alternative policonsumo2     1.04      0.02    2.49
4        Correction for PH, no weight policonsumo2     1.04      0.01    2.61
5             Correction for PH, main policonsumo2     1.05      0.02    2.92
6      Correction for PH, alternative policonsumo2     1.05      0.02    1.99
7              Stratifying, no weight policonsumo2     1.04      0.01    2.61
8                   Stratifying, main policonsumo2     1.05      0.02    2.61
9            Stratifying, alternative policonsumo2     1.04      0.02    2.31
10 Stratifying, 2nd alternative, main policonsumo2     1.03      0.02    1.64
   p.value CI.Lower CI.Upper
1   0.0090     1.01     1.07
2   0.0112     1.01     1.08
3   0.0127     1.01     1.07
4   0.0090     1.01     1.07
5   0.0035     1.02     1.09
6   0.0463     1.00     1.09
7   0.0090     1.01     1.07
8   0.0089     1.01     1.09
9   0.0208     1.01     1.07
10  0.1013     0.99     1.07</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "GP intensive ambulatory". significativo</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model2,</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">QIC=</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_nowgt_list[[i]])),</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_wgt_list[[i]])),</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_alt_wgt_list[[i]])),</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_nowgt_list[[i]])),</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_wgt_list[[i]])),</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_alt_wgt_list[[i]])),</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_nowgt_list[[i]])),</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_wgt_list[[i]])),</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_wgt_list[[i]])),</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_alt_wgt_list[[i]])),</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.numeric</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_qic)                        </span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rbind.data.frame</span>(</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb150-39"><a href="#cb150-39" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-40"><a href="#cb150-40" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),                   </span>
<span id="cb150-41"><a href="#cb150-41" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-42"><a href="#cb150-42" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-43"><a href="#cb150-43" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-44"><a href="#cb150-44" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-45"><a href="#cb150-45" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb150-46"><a href="#cb150-46" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>)</span>
<span id="cb150-47"><a href="#cb150-47" aria-hidden="true" tabindex="-1"></a>         ))<span class="sc">%&gt;%</span> </span>
<span id="cb150-48"><a href="#cb150-48" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb150-49"><a href="#cb150-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb150-50"><a href="#cb150-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"result_data_geem_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,plan_names[i])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb150-51"><a href="#cb150-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb150-52"><a href="#cb150-52" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model      QIC         Term Estimates Model SE
1                       No correction 22259.10 policonsumo2      1.04     0.01
2                   No correction, NB 22683.95 policonsumo2      1.04     0.01
3                 No correction, main 22272.10 policonsumo2      1.04     0.01
4             No correction, main, NB 22272.11 policonsumo2      1.04     0.01
5          No correction, alternative 22268.12 policonsumo2      1.04     0.01
6      No correction, alternative, NB 22268.12 policonsumo2      1.04     0.01
7        Correction for PH, no weight 22259.10 policonsumo2      1.04     0.01
8    Correction for PH, no weight, NB 22259.10 policonsumo2      1.04     0.01
9             Correction for PH, main 22280.50 policonsumo2      1.05     0.01
10        Correction for PH, main, NB 22280.51 policonsumo2      1.05     0.01
11     Correction for PH, alternative 22318.80 policonsumo2      1.05     0.01
12 Correction for PH, alternative, NB 22318.80 policonsumo2      1.05     0.01
13              Stratified, no weight 22259.10 policonsumo2      1.04     0.01
14          Stratified, no weight, NB 22259.10 policonsumo2      1.04     0.01
15                   Stratified, main 22278.50 policonsumo2      1.04     0.01
16               Stratified, main, NB 22278.51 policonsumo2      1.04     0.01
17            Stratified, alternative 22265.46 policonsumo2      1.02     0.01
18        Stratified, alternative, NB 22265.47 policonsumo2      1.02     0.01
19        Stratified, 2nd alternative 22276.07 policonsumo2      1.01     0.01
20    Stratified, 2nd alternative, NB 22276.08 policonsumo2      1.01     0.01
   Robust SE Wald CI.lower CI.upper p.value
1       0.01 2.61     1.01     1.07   0.009
2       0.01 2.61     1.01     1.07  0.0089
3       0.02 2.54     1.01     1.08  0.0112
4       0.02 2.54     1.01     1.08  0.0112
5       0.02 2.49     1.01     1.07  0.0127
6       0.02 2.49     1.01     1.07  0.0127
7       0.01 2.61     1.01     1.07   0.009
8       0.01 2.61     1.01     1.07   0.009
9       0.02 2.92     1.02     1.09  0.0035
10      0.02 2.92     1.02     1.09  0.0035
11      0.02 1.99     1.00     1.09  0.0463
12      0.02 1.99     1.00     1.09  0.0463
13      0.01 2.61     1.01     1.07   0.009
14      0.01 2.61     1.01     1.07   0.009
15      0.02 2.35     1.01     1.08   0.019
16      0.02 2.35     1.01     1.08   0.019
17      0.02 1.42     0.99     1.05  0.1547
18      0.02 1.42     0.99     1.05  0.1547
19      0.02 0.80     0.98     1.05  0.4255
20      0.02 0.80     0.98     1.05  0.4255</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>plan_names[i]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "GP residential"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model,</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)  </span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model         Term Estimate Std.Error z.value
1                       No correction policonsumo2     0.97      0.03   -1.31
2                 No correction, main policonsumo2     0.97      0.03   -1.14
3          No correction, alternative policonsumo2     0.95      0.03   -1.65
4        Correction for PH, no weight policonsumo2     0.97      0.03   -1.31
5             Correction for PH, main policonsumo2     0.98      0.03   -0.77
6      Correction for PH, alternative policonsumo2     1.00      0.03   -0.05
7              Stratifying, no weight policonsumo2     0.97      0.03   -1.31
8                   Stratifying, main policonsumo2     0.97      0.03   -1.03
9            Stratifying, alternative policonsumo2     0.95      0.03   -1.50
10 Stratifying, 2nd alternative, main policonsumo2     0.96      0.04   -1.03
   p.value CI.Lower CI.Upper
1   0.1904     0.92     1.02
2   0.2528     0.92     1.02
3   0.0991     0.90     1.01
4   0.1904     0.92     1.02
5   0.4442     0.92     1.03
6   0.9636     0.93     1.07
7   0.1889     0.92     1.02
8   0.3034     0.91     1.03
9   0.1327     0.89     1.01
10  0.3039     0.89     1.04</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model2,</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">QIC=</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_nowgt_list[[i]])),</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_wgt_list[[i]])),</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_alt_wgt_list[[i]])),</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_nowgt_list[[i]])),</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_wgt_list[[i]])),</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_alt_wgt_list[[i]])),</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_nowgt_list[[i]])),</span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_wgt_list[[i]])),</span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_wgt_list[[i]])),</span>
<span id="cb156-20"><a href="#cb156-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb156-21"><a href="#cb156-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_alt_wgt_list[[i]])),</span>
<span id="cb156-22"><a href="#cb156-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_qic)                        </span>
<span id="cb156-23"><a href="#cb156-23" aria-hidden="true" tabindex="-1"></a>           ),</span>
<span id="cb156-24"><a href="#cb156-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rbind.data.frame</span>(</span>
<span id="cb156-25"><a href="#cb156-25" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-26"><a href="#cb156-26" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-27"><a href="#cb156-27" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-28"><a href="#cb156-28" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-29"><a href="#cb156-29" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-30"><a href="#cb156-30" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-31"><a href="#cb156-31" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-32"><a href="#cb156-32" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-33"><a href="#cb156-33" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-34"><a href="#cb156-34" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-35"><a href="#cb156-35" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-36"><a href="#cb156-36" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-37"><a href="#cb156-37" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb156-38"><a href="#cb156-38" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-39"><a href="#cb156-39" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),                   </span>
<span id="cb156-40"><a href="#cb156-40" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-41"><a href="#cb156-41" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-42"><a href="#cb156-42" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-43"><a href="#cb156-43" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-44"><a href="#cb156-44" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb156-45"><a href="#cb156-45" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>)</span>
<span id="cb156-46"><a href="#cb156-46" aria-hidden="true" tabindex="-1"></a>           ))<span class="sc">%&gt;%</span> </span>
<span id="cb156-47"><a href="#cb156-47" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb156-48"><a href="#cb156-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb156-49"><a href="#cb156-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"result_data_geem_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,plan_names[i])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb156-50"><a href="#cb156-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb156-51"><a href="#cb156-51" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model      QIC         Term Estimates Model SE
1                       No correction 9817.173 policonsumo2      0.97     0.03
2                   No correction, NB 9978.177 policonsumo2      0.97     0.03
3                 No correction, main 9832.040 policonsumo2      0.97     0.03
4             No correction, main, NB 9832.041 policonsumo2      0.97     0.03
5          No correction, alternative 9826.116 policonsumo2      0.95     0.03
6      No correction, alternative, NB 9826.118 policonsumo2      0.95     0.03
7        Correction for PH, no weight 9817.173 policonsumo2      0.97     0.03
8    Correction for PH, no weight, NB 9817.175 policonsumo2      0.97     0.03
9             Correction for PH, main 9828.770 policonsumo2      0.98     0.03
10        Correction for PH, main, NB 9828.771 policonsumo2      0.98     0.03
11     Correction for PH, alternative 9865.658 policonsumo2      1.00     0.02
12 Correction for PH, alternative, NB 9865.659 policonsumo2      1.00     0.02
13              Stratified, no weight 9817.173 policonsumo2      0.97     0.03
14          Stratified, no weight, NB 9817.175 policonsumo2      0.97     0.03
15                   Stratified, main 9836.894 policonsumo2      0.95     0.03
16               Stratified, main, NB 9836.896 policonsumo2      0.95     0.03
17            Stratified, alternative 9836.568 policonsumo2      0.97     0.03
18        Stratified, alternative, NB 9836.569 policonsumo2      0.97     0.03
19        Stratified, 2nd alternative 9883.784 policonsumo2      1.01     0.03
20    Stratified, 2nd alternative, NB 9883.786 policonsumo2      1.01     0.03
   Robust SE  Wald CI.lower CI.upper p.value
1       0.03 -1.31     0.92     1.02  0.1904
2       0.03 -1.31     0.91     1.02  0.1902
3       0.03 -1.14     0.92     1.02  0.2528
4       0.03 -1.14     0.92     1.02  0.2528
5       0.03 -1.65     0.90     1.01  0.0991
6       0.03 -1.65     0.90     1.01  0.0991
7       0.03 -1.31     0.92     1.02  0.1904
8       0.03 -1.31     0.92     1.02  0.1904
9       0.03 -0.77     0.92     1.03  0.4442
10      0.03 -0.77     0.92     1.03  0.4442
11      0.03 -0.05     0.93     1.07  0.9636
12      0.03 -0.05     0.93     1.07  0.9636
13      0.03 -1.31     0.92     1.02  0.1904
14      0.03 -1.31     0.92     1.02  0.1904
15      0.03 -1.60     0.89     1.01  0.1097
16      0.03 -1.60     0.89     1.01  0.1097
17      0.03 -0.82     0.91     1.04  0.4096
18      0.03 -0.82     0.91     1.04  0.4096
19      0.05  0.11     0.92     1.10  0.9098
20      0.05  0.11     0.92     1.10  0.9098</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>plan_names[i]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "WO intensive ambulatory"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model,</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)  </span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model         Term Estimate Std.Error z.value
1                       No correction policonsumo2     0.99      0.03   -0.38
2                 No correction, main policonsumo2     0.99      0.04   -0.17
3          No correction, alternative policonsumo2     0.99      0.04   -0.33
4        Correction for PH, no weight policonsumo2     0.99      0.03   -0.38
5             Correction for PH, main policonsumo2     1.01      0.05    0.22
6      Correction for PH, alternative policonsumo2     1.01      0.05    0.16
7              Stratifying, no weight policonsumo2     0.99      0.03   -0.37
8                   Stratifying, main policonsumo2     1.01      0.05    0.18
9            Stratifying, alternative policonsumo2     0.94      0.04   -1.52
10 Stratifying, 2nd alternative, main policonsumo2     0.94      0.05   -1.11
   p.value CI.Lower CI.Upper
1   0.7075     0.92     1.05
2   0.8688     0.92     1.07
3   0.7381     0.92     1.06
4   0.7075     0.92     1.05
5   0.8228     0.92     1.10
6   0.8719     0.91     1.12
7   0.7140     0.92     1.06
8   0.8605     0.91     1.12
9   0.1282     0.87     1.02
10  0.2672     0.85     1.04</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model2,</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">QIC=</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_nowgt_list[[i]])),</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_wgt_list[[i]])),</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_alt_wgt_list[[i]])),</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_nowgt_list[[i]])),</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_wgt_list[[i]])),</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_alt_wgt_list[[i]])),</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_nowgt_list[[i]])),</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_wgt_list[[i]])),</span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_wgt_list[[i]])),</span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_alt_wgt_list[[i]])),</span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_qic)                        </span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>           ),</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rbind.data.frame</span>(</span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),                   </span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-41"><a href="#cb162-41" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-42"><a href="#cb162-42" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-43"><a href="#cb162-43" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-44"><a href="#cb162-44" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb162-45"><a href="#cb162-45" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>)</span>
<span id="cb162-46"><a href="#cb162-46" aria-hidden="true" tabindex="-1"></a>           ))<span class="sc">%&gt;%</span> </span>
<span id="cb162-47"><a href="#cb162-47" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb162-48"><a href="#cb162-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb162-49"><a href="#cb162-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"result_data_geem_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,plan_names[i])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb162-50"><a href="#cb162-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb162-51"><a href="#cb162-51" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model      QIC         Term Estimates Model SE
1                       No correction 3420.677 policonsumo2      0.99     0.03
2                   No correction, NB 3484.239 policonsumo2      0.99     0.03
3                 No correction, main 3431.119 policonsumo2      0.99     0.04
4             No correction, main, NB 3431.119 policonsumo2      0.99     0.04
5          No correction, alternative 3426.650 policonsumo2      0.99     0.03
6      No correction, alternative, NB 3426.650 policonsumo2      0.99     0.03
7        Correction for PH, no weight 3420.677 policonsumo2      0.99     0.03
8    Correction for PH, no weight, NB 3420.678 policonsumo2      0.99     0.03
9             Correction for PH, main 3441.006 policonsumo2      1.01     0.04
10        Correction for PH, main, NB 3441.006 policonsumo2      1.01     0.04
11     Correction for PH, alternative 3463.577 policonsumo2      1.01     0.04
12 Correction for PH, alternative, NB 3463.578 policonsumo2      1.01     0.04
13              Stratified, no weight 3420.677 policonsumo2      0.99     0.03
14          Stratified, no weight, NB 3420.678 policonsumo2      0.99     0.03
15                   Stratified, main 3447.966 policonsumo2      0.98     0.04
16               Stratified, main, NB 3447.966 policonsumo2      0.98     0.04
17            Stratified, alternative 3434.328 policonsumo2      0.98     0.03
18        Stratified, alternative, NB 3434.329 policonsumo2      0.98     0.03
19        Stratified, 2nd alternative 3464.955 policonsumo2      0.94     0.03
20    Stratified, 2nd alternative, NB 3464.956 policonsumo2      0.94     0.03
   Robust SE  Wald CI.lower CI.upper p.value
1       0.03 -0.38     0.92     1.05  0.7075
2       0.03 -0.37     0.92     1.05  0.7101
3       0.04 -0.17     0.92     1.07  0.8688
4       0.04 -0.17     0.92     1.07  0.8688
5       0.04 -0.33     0.92     1.06  0.7381
6       0.04 -0.33     0.92     1.06  0.7381
7       0.03 -0.38     0.92     1.05  0.7075
8       0.03 -0.38     0.92     1.05  0.7075
9       0.05  0.22     0.92     1.10  0.8228
10      0.05  0.22     0.92     1.10  0.8228
11      0.05  0.16     0.91     1.12  0.8719
12      0.05  0.16     0.91     1.12  0.8719
13      0.03 -0.38     0.92     1.05  0.7075
14      0.03 -0.38     0.92     1.05  0.7075
15      0.04 -0.44     0.90     1.07  0.6603
16      0.04 -0.44     0.90     1.07  0.6603
17      0.04 -0.62     0.91     1.05  0.5343
18      0.04 -0.62     0.91     1.05  0.5343
19      0.04 -1.42     0.87     1.02  0.1571
20      0.04 -1.42     0.87     1.02  0.1571</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>plan_names[i]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "WO residential"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model,</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(nocorr_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(afterph_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_nowgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tidy_geese_model</span>(strata_alt_alt_wgt_list[[i]]), Term<span class="sc">==</span><span class="st">"policonsumo2"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">copiar_nombres2</span>(.)  </span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(.)</span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model         Term Estimate Std.Error z.value
1                       No correction policonsumo2     1.14      0.04    3.45
2                 No correction, main policonsumo2     1.15      0.04    3.31
3          No correction, alternative policonsumo2     1.13      0.04    3.00
4        Correction for PH, no weight policonsumo2     1.14      0.04    3.45
5             Correction for PH, main policonsumo2     1.11      0.04    2.50
6      Correction for PH, alternative policonsumo2     1.13      0.05    2.53
7              Stratifying, no weight policonsumo2     1.14      0.04    3.44
8                   Stratifying, main policonsumo2     1.14      0.05    2.60
9            Stratifying, alternative policonsumo2     1.10      0.05    2.05
10 Stratifying, 2nd alternative, main policonsumo2     1.13      0.06    1.99
   p.value CI.Lower CI.Upper
1   0.0006     1.06     1.23
2   0.0009     1.06     1.26
3   0.0027     1.04     1.22
4   0.0006     1.06     1.23
5   0.0125     1.02     1.21
6   0.0115     1.03     1.25
7   0.0006     1.06     1.23
8   0.0094     1.03     1.25
9   0.0405     1.00     1.21
10  0.0461     1.00     1.28</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> types_of_model2,</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">QIC=</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_nowgt_list[[i]])),</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_wgt_list[[i]])),</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_nocorr_alt_wgt_list[[i]])),</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_nowgt_list[[i]])),</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_wgt_list[[i]])),</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_afterph_alt_wgt_list[[i]])),</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_nowgt_list[[i]])),</span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_wgt_list[[i]])),</span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_wgt_list[[i]])),</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_qic),</span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">QIC</span>(geem_strata_alt_alt_wgt_list[[i]])),</span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_qic)                        </span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>           ),</span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rbind.data.frame</span>(</span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_nocorr_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_nocorr_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-34"><a href="#cb168-34" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-35"><a href="#cb168-35" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_afterph_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_afterph_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb168-38"><a href="#cb168-38" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_nowgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-39"><a href="#cb168-39" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_nowgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),                   </span>
<span id="cb168-40"><a href="#cb168-40" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-41"><a href="#cb168-41" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-42"><a href="#cb168-42" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-43"><a href="#cb168-43" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-44"><a href="#cb168-44" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem_strata_alt_alt_wgt_list[[i]],<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>),</span>
<span id="cb168-45"><a href="#cb168-45" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">summary2.geem</span>(geem2_strata_alt_alt_wgt_list[[i]]<span class="sc">$</span>best_model,<span class="at">exponentiate=</span>T, <span class="at">digits=</span><span class="dv">2</span>),Term<span class="sc">==</span><span class="st">"policonsumo2"</span>)</span>
<span id="cb168-46"><a href="#cb168-46" aria-hidden="true" tabindex="-1"></a>           ))<span class="sc">%&gt;%</span> </span>
<span id="cb168-47"><a href="#cb168-47" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb168-48"><a href="#cb168-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">copiar_nombres2</span>(.)</span>
<span id="cb168-49"><a href="#cb168-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"result_data_geem_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,plan_names[i])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb168-50"><a href="#cb168-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(.)</span>
<span id="cb168-51"><a href="#cb168-51" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                model      QIC         Term Estimates Model SE
1                       No correction 4823.862 policonsumo2      1.14     0.04
2                   No correction, NB 4906.757 policonsumo2      1.14     0.04
3                 No correction, main 4836.385 policonsumo2      1.15     0.03
4             No correction, main, NB 4836.386 policonsumo2      1.15     0.03
5          No correction, alternative 4831.901 policonsumo2      1.13     0.04
6      No correction, alternative, NB 4831.902 policonsumo2      1.13     0.04
7        Correction for PH, no weight 4823.862 policonsumo2      1.14     0.04
8    Correction for PH, no weight, NB 4823.863 policonsumo2      1.14     0.04
9             Correction for PH, main 4837.095 policonsumo2      1.11     0.03
10        Correction for PH, main, NB 4837.096 policonsumo2      1.11     0.03
11     Correction for PH, alternative 4857.472 policonsumo2      1.13     0.03
12 Correction for PH, alternative, NB 4857.473 policonsumo2      1.13     0.03
13              Stratified, no weight 4823.862 policonsumo2      1.14     0.04
14          Stratified, no weight, NB 4823.863 policonsumo2      1.14     0.04
15                   Stratified, main 4846.887 policonsumo2      1.12     0.04
16               Stratified, main, NB 4846.888 policonsumo2      1.12     0.04
17            Stratified, alternative 4839.328 policonsumo2      1.11     0.03
18        Stratified, alternative, NB 4839.329 policonsumo2      1.11     0.03
19        Stratified, 2nd alternative 4869.985 policonsumo2      1.09     0.04
20    Stratified, 2nd alternative, NB 4869.986 policonsumo2      1.09     0.04
   Robust SE Wald CI.lower CI.upper p.value
1       0.04 3.45     1.06     1.23   6e-04
2       0.04 3.45     1.06     1.23   6e-04
3       0.04 3.31     1.06     1.26   9e-04
4       0.04 3.31     1.06     1.26   9e-04
5       0.04 3.00     1.04     1.22  0.0027
6       0.04 3.00     1.04     1.22  0.0027
7       0.04 3.45     1.06     1.23   6e-04
8       0.04 3.45     1.06     1.23   6e-04
9       0.04 2.50     1.02     1.21  0.0125
10      0.04 2.50     1.02     1.21  0.0125
11      0.05 2.53     1.03     1.25  0.0115
12      0.05 2.53     1.03     1.25  0.0115
13      0.04 3.45     1.06     1.23   6e-04
14      0.04 3.45     1.06     1.23   6e-04
15      0.04 2.58     1.03     1.22  0.0098
16      0.04 2.58     1.03     1.22  0.0098
17      0.04 2.55     1.02     1.20  0.0108
18      0.04 2.55     1.02     1.20  0.0108
19      0.05 1.80     0.99     1.20  0.0718
20      0.05 1.80     0.99     1.20  0.0718</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">setting=</span>plan_names[<span class="dv">1</span>],result_data_geem_basic_ambulatory),</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">cbind.data.frame</span>(<span class="at">setting=</span>plan_names[<span class="dv">2</span>],result_data_geem_GP_intensive_ambulatory),</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">cbind.data.frame</span>(<span class="at">setting=</span>plan_names[<span class="dv">3</span>],result_data_geem_GP_residential),</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">cbind.data.frame</span>(<span class="at">setting=</span>plan_names[<span class="dv">4</span>],result_data_geem_WO_intensive_ambulatory),</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">cbind.data.frame</span>(<span class="at">setting=</span>plan_names[<span class="dv">5</span>],result_data_geem_WO_residential)</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">%&gt;%</span> </span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(setting) <span class="sc">%&gt;%</span> </span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">min_qic_setting=</span><span class="fu">ifelse</span>(QIC<span class="sc">==</span><span class="fu">min</span>(QIC),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#copiar_nombres2()</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(folder_path,<span class="st">"gee_240515.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models, Association between PSU and Treatment outcome"</span>) </span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models, Association between PSU and Treatment outcome</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 22%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">setting</th>
<th style="text-align: left;">model</th>
<th style="text-align: right;">QIC</th>
<th style="text-align: left;">Term</th>
<th style="text-align: left;">Estimates</th>
<th style="text-align: left;">Model SE</th>
<th style="text-align: left;">Robust SE</th>
<th style="text-align: left;">Wald</th>
<th style="text-align: left;">CI.lower</th>
<th style="text-align: left;">CI.upper</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: right;">min_qic_setting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: right;">19452.855</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.78</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">No correction, NB</td>
<td style="text-align: right;">19837.659</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.78</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.0759</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">No correction, main</td>
<td style="text-align: right;">19463.520</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.38</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.1665</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">No correction, main, NB</td>
<td style="text-align: right;">19463.524</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.38</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.1665</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">No correction, alternative</td>
<td style="text-align: right;">19457.642</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.73</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.0838</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">No correction, alternative, NB</td>
<td style="text-align: right;">19457.646</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.73</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.0838</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Correction for PH, no weight</td>
<td style="text-align: right;">19452.855</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.78</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Correction for PH, no weight, NB</td>
<td style="text-align: right;">19452.859</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.78</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Correction for PH, main</td>
<td style="text-align: right;">19477.327</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.50</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.1328</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Correction for PH, main, NB</td>
<td style="text-align: right;">19477.331</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.50</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.1328</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Correction for PH, alternative</td>
<td style="text-align: right;">19514.728</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.2209</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Correction for PH, alternative, NB</td>
<td style="text-align: right;">19514.732</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.2209</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, no weight</td>
<td style="text-align: right;">19452.855</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.78</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.075</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, no weight, NB</td>
<td style="text-align: right;">19452.859</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">1.78</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, main</td>
<td style="text-align: right;">19474.652</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.287</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, main, NB</td>
<td style="text-align: right;">19474.656</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.287</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, alternative</td>
<td style="text-align: right;">19465.269</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.32</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.0202</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, alternative, NB</td>
<td style="text-align: right;">19465.273</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.32</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.0202</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, 2nd alternative</td>
<td style="text-align: right;">19502.788</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.40</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.1613</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">basic ambulatory</td>
<td style="text-align: left;">Stratified, 2nd alternative, NB</td>
<td style="text-align: right;">19502.792</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.40</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.1613</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: right;">22259.099</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">2.61</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">No correction, NB</td>
<td style="text-align: right;">22683.953</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">2.61</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.0089</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">No correction, main</td>
<td style="text-align: right;">22272.103</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.54</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">0.0112</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">No correction, main, NB</td>
<td style="text-align: right;">22272.107</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.54</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">0.0112</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">No correction, alternative</td>
<td style="text-align: right;">22268.116</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.49</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.0127</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">No correction, alternative, NB</td>
<td style="text-align: right;">22268.120</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.49</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.0127</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, no weight</td>
<td style="text-align: right;">22259.099</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">2.61</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, no weight, NB</td>
<td style="text-align: right;">22259.104</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">2.61</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, main</td>
<td style="text-align: right;">22280.502</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">0.0035</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, main, NB</td>
<td style="text-align: right;">22280.506</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">0.0035</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, alternative</td>
<td style="text-align: right;">22318.796</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.99</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">0.0463</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, alternative, NB</td>
<td style="text-align: right;">22318.800</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.99</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">0.0463</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, no weight</td>
<td style="text-align: right;">22259.099</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">2.61</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, no weight, NB</td>
<td style="text-align: right;">22259.104</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">2.61</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, main</td>
<td style="text-align: right;">22278.504</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.35</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">0.019</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, main, NB</td>
<td style="text-align: right;">22278.508</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">2.35</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">0.019</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, alternative</td>
<td style="text-align: right;">22265.464</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.42</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.1547</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, alternative, NB</td>
<td style="text-align: right;">22265.468</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">1.42</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.1547</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, 2nd alternative</td>
<td style="text-align: right;">22276.073</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">0.80</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.4255</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP intensive ambulatory</td>
<td style="text-align: left;">Stratified, 2nd alternative, NB</td>
<td style="text-align: right;">22276.077</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">0.80</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.4255</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: right;">9817.173</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.31</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1904</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">No correction, NB</td>
<td style="text-align: right;">9978.177</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.31</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1902</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">No correction, main</td>
<td style="text-align: right;">9832.040</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.14</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.2528</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">No correction, main, NB</td>
<td style="text-align: right;">9832.041</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.14</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.2528</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">No correction, alternative</td>
<td style="text-align: right;">9826.116</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.65</td>
<td style="text-align: left;">0.90</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.0991</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">No correction, alternative, NB</td>
<td style="text-align: right;">9826.118</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.65</td>
<td style="text-align: left;">0.90</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.0991</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Correction for PH, no weight</td>
<td style="text-align: right;">9817.173</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.31</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1904</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Correction for PH, no weight, NB</td>
<td style="text-align: right;">9817.175</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.31</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1904</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Correction for PH, main</td>
<td style="text-align: right;">9828.770</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.77</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.4442</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Correction for PH, main, NB</td>
<td style="text-align: right;">9828.771</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.77</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.4442</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Correction for PH, alternative</td>
<td style="text-align: right;">9865.658</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.05</td>
<td style="text-align: left;">0.93</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.9636</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Correction for PH, alternative, NB</td>
<td style="text-align: right;">9865.659</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.02</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.05</td>
<td style="text-align: left;">0.93</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.9636</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, no weight</td>
<td style="text-align: right;">9817.173</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.31</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1904</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, no weight, NB</td>
<td style="text-align: right;">9817.175</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.31</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1904</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, main</td>
<td style="text-align: right;">9836.894</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.60</td>
<td style="text-align: left;">0.89</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.1097</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, main, NB</td>
<td style="text-align: right;">9836.896</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-1.60</td>
<td style="text-align: left;">0.89</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.1097</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, alternative</td>
<td style="text-align: right;">9836.568</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.82</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.4096</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, alternative, NB</td>
<td style="text-align: right;">9836.569</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.82</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.4096</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, 2nd alternative</td>
<td style="text-align: right;">9883.784</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.11</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.9098</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">GP residential</td>
<td style="text-align: left;">Stratified, 2nd alternative, NB</td>
<td style="text-align: right;">9883.786</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.11</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.9098</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: right;">3420.677</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.38</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.7075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">No correction, NB</td>
<td style="text-align: right;">3484.239</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.37</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.7101</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">No correction, main</td>
<td style="text-align: right;">3431.119</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.17</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.8688</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">No correction, main, NB</td>
<td style="text-align: right;">3431.119</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.17</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.8688</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">No correction, alternative</td>
<td style="text-align: right;">3426.650</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.33</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.7381</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">No correction, alternative, NB</td>
<td style="text-align: right;">3426.650</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.33</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.7381</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, no weight</td>
<td style="text-align: right;">3420.677</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.38</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.7075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, no weight, NB</td>
<td style="text-align: right;">3420.678</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.38</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.7075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, main</td>
<td style="text-align: right;">3441.006</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.22</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.8228</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, main, NB</td>
<td style="text-align: right;">3441.006</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.22</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.8228</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, alternative</td>
<td style="text-align: right;">3463.577</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">0.8719</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Correction for PH, alternative, NB</td>
<td style="text-align: right;">3463.578</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">0.8719</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, no weight</td>
<td style="text-align: right;">3420.677</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.38</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.7075</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, no weight, NB</td>
<td style="text-align: right;">3420.678</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.38</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.7075</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, main</td>
<td style="text-align: right;">3447.966</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.44</td>
<td style="text-align: left;">0.90</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.6603</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, main, NB</td>
<td style="text-align: right;">3447.966</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.44</td>
<td style="text-align: left;">0.90</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.6603</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, alternative</td>
<td style="text-align: right;">3434.328</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.62</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.5343</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, alternative, NB</td>
<td style="text-align: right;">3434.329</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-0.62</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">0.5343</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, 2nd alternative</td>
<td style="text-align: right;">3464.955</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-1.42</td>
<td style="text-align: left;">0.87</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1571</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO intensive ambulatory</td>
<td style="text-align: left;">Stratified, 2nd alternative, NB</td>
<td style="text-align: right;">3464.956</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">-1.42</td>
<td style="text-align: left;">0.87</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.1571</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">No correction</td>
<td style="text-align: right;">4823.862</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.14</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.45</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">6e-04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">No correction, NB</td>
<td style="text-align: right;">4906.757</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.14</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.45</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">6e-04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">No correction, main</td>
<td style="text-align: right;">4836.385</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.31</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.26</td>
<td style="text-align: left;">9e-04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">No correction, main, NB</td>
<td style="text-align: right;">4836.386</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.31</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.26</td>
<td style="text-align: left;">9e-04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">No correction, alternative</td>
<td style="text-align: right;">4831.901</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.00</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">0.0027</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">No correction, alternative, NB</td>
<td style="text-align: right;">4831.902</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.00</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">0.0027</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Correction for PH, no weight</td>
<td style="text-align: right;">4823.862</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.14</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.45</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">6e-04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Correction for PH, no weight, NB</td>
<td style="text-align: right;">4823.863</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.14</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.45</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">6e-04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Correction for PH, main</td>
<td style="text-align: right;">4837.095</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">2.50</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.21</td>
<td style="text-align: left;">0.0125</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Correction for PH, main, NB</td>
<td style="text-align: right;">4837.096</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">2.50</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.21</td>
<td style="text-align: left;">0.0125</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Correction for PH, alternative</td>
<td style="text-align: right;">4857.472</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">2.53</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.25</td>
<td style="text-align: left;">0.0115</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Correction for PH, alternative, NB</td>
<td style="text-align: right;">4857.473</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">2.53</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.25</td>
<td style="text-align: left;">0.0115</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, no weight</td>
<td style="text-align: right;">4823.862</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.14</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.45</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">6e-04</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, no weight, NB</td>
<td style="text-align: right;">4823.863</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.14</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">3.45</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">6e-04</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, main</td>
<td style="text-align: right;">4846.887</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">2.58</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">0.0098</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, main, NB</td>
<td style="text-align: right;">4846.888</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">2.58</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">0.0098</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, alternative</td>
<td style="text-align: right;">4839.328</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">2.55</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">0.0108</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, alternative, NB</td>
<td style="text-align: right;">4839.329</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">2.55</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">0.0108</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, 2nd alternative</td>
<td style="text-align: right;">4869.985</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">1.80</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">0.0718</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">WO residential</td>
<td style="text-align: left;">Stratified, 2nd alternative, NB</td>
<td style="text-align: right;">4869.986</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">1.80</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">0.0718</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="marginal-probabilities" class="level1">
<h1>Marginal probabilities</h1>
<p>Loop over each unique plan name to fit a model. We used an interaction of PSU and treatment setting to capture the heterogeneity of PSU by treatment setting.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>df_marginal_plots<span class="ot">&lt;-</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">wgt=</span> <span class="fu">c</span>(<span class="st">"wgt"</span>, <span class="st">"iiw_nocorr_st"</span>, <span class="st">"iiw_nocorr_alt_st"</span>, <span class="st">"wgt"</span>, <span class="st">"iiw_after_ph_st"</span>, <span class="st">"iiw_after_ph_st"</span>), </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">df=</span> <span class="fu">c</span>(<span class="st">"data_mine_miss_restr_proc2"</span>,<span class="st">"data_mine_miss_restr_proc2"</span>,<span class="st">"data_mine_miss_restr_proc2"</span>,<span class="st">"data_mine_miss_restr_proc2_iiw_after_ph"</span>,<span class="st">"data_mine_miss_restr_proc2_iiw_after_ph"</span>,<span class="st">"data_mine_miss_restr_proc2_iiw_after_ph_alt"</span>),</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">model=</span> <span class="fu">c</span>(<span class="st">"no corr no wgt"</span>,<span class="st">"no corr main"</span>,<span class="st">"no corr alt"</span>, <span class="st">"after ph no wgt"</span>, <span class="st">"after ph main"</span>, <span class="st">"after ph alt"</span>))</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each unique plan name to fit a model</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_marginal_plots<span class="sc">$</span>wgt)) {</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current plan type</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#current_data &lt;- subset(data_mine_miss_restr_proc2, tipo_de_plan_2_mod == plan_names[i])</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">*</span> tipo_de_plan_2_mod <span class="sc">+</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>                        edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>                        ano_nac_corr <span class="sc">+</span> </span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>                        susinidum_oh <span class="sc">+</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>                        susinidum_coc <span class="sc">+</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>                        susinidum_pbc <span class="sc">+</span></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>                        susinidum_mar <span class="sc">+</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>                        psycom_dum_study <span class="sc">+</span></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>                        psycom_dum_with <span class="sc">+</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>                        freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>                        cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>                        cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>                        susprindum_coc <span class="sc">+</span></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a>                        susprindum_pbc <span class="sc">+</span></span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>                        susprindum_mar,</span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">id=</span> id, </span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span> <span class="fu">get</span>(df_marginal_plots<span class="sc">$</span>df[i]) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wgt=</span><span class="dv">1</span>), </span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weight=</span> <span class="fu">get</span>(df_marginal_plots<span class="sc">$</span>df[i]) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wgt=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(df_marginal_plots<span class="sc">$</span>wgt[i]), </span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family=</span> poisson, </span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">corstr=</span> <span class="st">"independence"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"geeglm_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,df_marginal_plots<span class="sc">$</span>model[i])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Models: "</span>,<span class="fu">paste0</span>(<span class="st">"geeglm_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,df_marginal_plots<span class="sc">$</span>model[i])))))</span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a>  emmeans_response <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(<span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"geeglm_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,df_marginal_plots<span class="sc">$</span>model[i]))), <span class="sc">~</span>policonsumo2<span class="sc">+</span>tipo_de_plan_2_mod,  <span class="at">rg.limit=</span><span class="fl">2e5</span>, <span class="at">type =</span> <span class="st">"response"</span>)<span class="sc">%&gt;%</span> <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"emmeans_response_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,df_marginal_plots<span class="sc">$</span>model[i])), ., <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb171-33"><a href="#cb171-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Emmeans: "</span>,<span class="fu">paste0</span>(<span class="st">"emmeans_response_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>,<span class="st">"_"</span>,df_marginal_plots<span class="sc">$</span>model[i])))))</span>
<span id="cb171-34"><a href="#cb171-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL</code></pre>
</div>
<div class="message">
<p>Time for this code chunk to run: 0.4 minutes</p>
</div>
</div>
<div class="center-table">
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emmeans_response_no_corr_no_wgt)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"No corr, no weights"</span>)<span class="co">#+ geom_point(aes(x = percent, y = conc), data = pigs, pch = 2, color = "blue")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_4_files/figure-html/output-marginal-emmeans-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emmeans_response_no_corr_main)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"No corr, main weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_4_files/figure-html/output-marginal-emmeans-plot-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emmeans_response_no_corr_alt)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"No corr, alt weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_4_files/figure-html/output-marginal-emmeans-plot-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emmeans_response_after_ph_no_wgt)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"After PH, no weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_4_files/figure-html/output-marginal-emmeans-plot-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emmeans_response_after_ph_main)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"After PH, main weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_4_files/figure-html/output-marginal-emmeans-plot-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(emmeans_response_after_ph_alt)<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"After PH, alt weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_4_files/figure-html/output-marginal-emmeans-plot-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2100"></p>
</figure>
</div>
</div>
<div class="message">
<p>Time for this code chunk to run: 0.1 minutes</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"R library: "</span>, <span class="fu">Sys.getenv</span>(<span class="st">"R_LIBS_USER"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>R library: E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/renv/library/R-4.1/x86_64-w64-mingw32</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Date: "</span>,withr<span class="sc">::</span><span class="fu">with_locale</span>(<span class="at">new =</span> <span class="fu">c</span>(<span class="st">'LC_TIME'</span> <span class="ot">=</span> <span class="st">'C'</span>), <span class="at">code =</span><span class="fu">Sys.time</span>())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Date: 2024-05-17 23:56:56</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Editor context: "</span>, path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Editor context: C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/env</p>
</div>
<div class="message">
<p>Time for this code chunk to run: 0 minutes</p>
</div>
</div>
<div class="center-table">
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>sesion_info <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(sesion_info<span class="sc">$</span>packages),</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(package, loadedversion, source)</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"R packages"</span>, <span class="at">format =</span> <span class="st">"markdown"</span>,</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Row number"</span>, <span class="st">"Package"</span>, <span class="st">"Version"</span>),</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>R packages</caption>
<thead>
<tr class="header">
<th style="text-align: center;">Row number</th>
<th style="text-align: left;">Package</th>
<th style="text-align: right;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">assertthat</td>
<td style="text-align: left;">0.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">backports</td>
<td style="text-align: left;">1.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">base64enc</td>
<td style="text-align: left;">0.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">BiocManager</td>
<td style="text-align: left;">1.30.18</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">biostat3</td>
<td style="text-align: left;">0.1.8</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">boot</td>
<td style="text-align: left;">1.3-28.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">broom</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cachem</td>
<td style="text-align: left;">1.0.6</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">callr</td>
<td style="text-align: left;">3.7.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cellranger</td>
<td style="text-align: left;">1.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">checkmate</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">class</td>
<td style="text-align: left;">7.3-20</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cli</td>
<td style="text-align: left;">3.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">clipr</td>
<td style="text-align: left;">0.8.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cluster</td>
<td style="text-align: left;">2.1.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">coda</td>
<td style="text-align: left;">0.19-4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">codetools</td>
<td style="text-align: left;">0.2-19</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">colorspace</td>
<td style="text-align: left;">2.0-3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cowplot</td>
<td style="text-align: left;">1.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">crayon</td>
<td style="text-align: left;">1.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">data.table</td>
<td style="text-align: left;">1.14.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">data.tree</td>
<td style="text-align: left;">1.0.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DBI</td>
<td style="text-align: left;">1.1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">dbplyr</td>
<td style="text-align: left;">2.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">deldir</td>
<td style="text-align: left;">1.0-6</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">devtools</td>
<td style="text-align: left;">2.4.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">digest</td>
<td style="text-align: left;">0.6.29</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">dplyr</td>
<td style="text-align: left;">1.0.10</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">e1071</td>
<td style="text-align: left;">1.7-11</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">easyalluvial</td>
<td style="text-align: left;">0.3.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ellipsis</td>
<td style="text-align: left;">0.3.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">emmeans</td>
<td style="text-align: left;">1.8.1-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">estimability</td>
<td style="text-align: left;">1.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">evaluate</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fansi</td>
<td style="text-align: left;">1.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">farver</td>
<td style="text-align: left;">2.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fastmap</td>
<td style="text-align: left;">1.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">forcats</td>
<td style="text-align: left;">0.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">foreign</td>
<td style="text-align: left;">0.8-83</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Formula</td>
<td style="text-align: left;">1.2-4</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fs</td>
<td style="text-align: left;">1.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">future</td>
<td style="text-align: left;">1.28.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">future.apply</td>
<td style="text-align: left;">1.9.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">gargle</td>
<td style="text-align: left;">1.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">geeasy</td>
<td style="text-align: left;">0.1.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">geeM</td>
<td style="text-align: left;">0.10.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">geepack</td>
<td style="text-align: left;">1.3.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">generics</td>
<td style="text-align: left;">0.1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ggalluvial</td>
<td style="text-align: left;">0.12.5</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ggforce</td>
<td style="text-align: left;">0.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ggformula</td>
<td style="text-align: left;">0.10.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ggplot2</td>
<td style="text-align: left;">3.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ggridges</td>
<td style="text-align: left;">0.5.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ggstance</td>
<td style="text-align: left;">0.3.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">globals</td>
<td style="text-align: left;">0.16.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">glue</td>
<td style="text-align: left;">1.6.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">googledrive</td>
<td style="text-align: left;">2.0.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">googlesheets4</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gower</td>
<td style="text-align: left;">1.0.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">gridExtra</td>
<td style="text-align: left;">2.3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gtable</td>
<td style="text-align: left;">0.3.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">hardhat</td>
<td style="text-align: left;">1.2.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">haven</td>
<td style="text-align: left;">2.5.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">highr</td>
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Hmisc</td>
<td style="text-align: left;">4.7-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">hms</td>
<td style="text-align: left;">1.1.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">htmlTable</td>
<td style="text-align: left;">2.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">htmltools</td>
<td style="text-align: left;">0.5.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">htmlwidgets</td>
<td style="text-align: left;">1.5.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">httpuv</td>
<td style="text-align: left;">1.6.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">httr</td>
<td style="text-align: left;">1.4.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">interp</td>
<td style="text-align: left;">1.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ipred</td>
<td style="text-align: left;">0.9-13</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">jpeg</td>
<td style="text-align: left;">0.1-9</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">jsonlite</td>
<td style="text-align: left;">1.8.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">knitr</td>
<td style="text-align: left;">1.40</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">labeling</td>
<td style="text-align: left;">0.4.2</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">labelled</td>
<td style="text-align: left;">2.10.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">later</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">lattice</td>
<td style="text-align: left;">0.20-45</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">latticeExtra</td>
<td style="text-align: left;">0.6-30</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">lava</td>
<td style="text-align: left;">1.6.10</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lifecycle</td>
<td style="text-align: left;">1.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">listenv</td>
<td style="text-align: left;">0.8.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lme4</td>
<td style="text-align: left;">1.1-30</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">lubridate</td>
<td style="text-align: left;">1.8.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">magrittr</td>
<td style="text-align: left;">2.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">MASS</td>
<td style="text-align: left;">7.3-58.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Matrix</td>
<td style="text-align: left;">1.5-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">MatrixModels</td>
<td style="text-align: left;">0.5-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">memoise</td>
<td style="text-align: left;">2.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">MESS</td>
<td style="text-align: left;">0.5.12</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mime</td>
<td style="text-align: left;">0.12</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">miniUI</td>
<td style="text-align: left;">0.1.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">minqa</td>
<td style="text-align: left;">1.2.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">mitools</td>
<td style="text-align: left;">2.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">modelr</td>
<td style="text-align: left;">0.1.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">mosaicCore</td>
<td style="text-align: left;">0.9.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">muhaz</td>
<td style="text-align: left;">1.2.6.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">multcomp</td>
<td style="text-align: left;">1.4-20</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">MuMIn</td>
<td style="text-align: left;">1.46.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">munsell</td>
<td style="text-align: left;">0.5.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mvtnorm</td>
<td style="text-align: left;">1.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">nlme</td>
<td style="text-align: left;">3.1-159</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">nloptr</td>
<td style="text-align: left;">2.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">nnet</td>
<td style="text-align: left;">7.3-18</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pacman</td>
<td style="text-align: left;">0.5.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">parallelly</td>
<td style="text-align: left;">1.32.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pillar</td>
<td style="text-align: left;">1.8.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">pkgbuild</td>
<td style="text-align: left;">1.3.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pkgconfig</td>
<td style="text-align: left;">2.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">pkgload</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">png</td>
<td style="text-align: left;">0.1-7</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">polspline</td>
<td style="text-align: left;">1.1.20</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">polyclip</td>
<td style="text-align: left;">1.10-4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">prettyunits</td>
<td style="text-align: left;">1.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">processx</td>
<td style="text-align: left;">3.7.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">prodlim</td>
<td style="text-align: left;">2019.11.13</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">profvis</td>
<td style="text-align: left;">0.3.7</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">progressr</td>
<td style="text-align: left;">0.11.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">promises</td>
<td style="text-align: left;">1.2.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">proxy</td>
<td style="text-align: left;">0.4-27</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ps</td>
<td style="text-align: left;">1.7.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">purrr</td>
<td style="text-align: left;">0.3.5</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">quantreg</td>
<td style="text-align: left;">5.94</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">R6</td>
<td style="text-align: left;">2.5.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">RColorBrewer</td>
<td style="text-align: left;">1.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Rcpp</td>
<td style="text-align: left;">1.0.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">readr</td>
<td style="text-align: left;">2.1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">readxl</td>
<td style="text-align: left;">1.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">recipes</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">remotes</td>
<td style="text-align: left;">2.4.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">renv</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">reprex</td>
<td style="text-align: left;">2.0.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">reticulate</td>
<td style="text-align: left;">1.26</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">rlang</td>
<td style="text-align: left;">1.0.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rmarkdown</td>
<td style="text-align: left;">2.16</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">rms</td>
<td style="text-align: left;">6.3-0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rpart</td>
<td style="text-align: left;">4.1.16</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">rstudioapi</td>
<td style="text-align: left;">0.14</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rvest</td>
<td style="text-align: left;">1.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">sandwich</td>
<td style="text-align: left;">3.0-2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">scales</td>
<td style="text-align: left;">1.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">sessioninfo</td>
<td style="text-align: left;">1.2.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">shiny</td>
<td style="text-align: left;">1.7.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">SparseM</td>
<td style="text-align: left;">1.81</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">stringi</td>
<td style="text-align: left;">1.7.6</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">stringr</td>
<td style="text-align: left;">1.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">survey</td>
<td style="text-align: left;">4.1-1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">survival</td>
<td style="text-align: left;">3.4-0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tableone</td>
<td style="text-align: left;">0.13.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">TH.data</td>
<td style="text-align: left;">1.1-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tibble</td>
<td style="text-align: left;">3.1.8</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">tidyr</td>
<td style="text-align: left;">1.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tidyselect</td>
<td style="text-align: left;">1.2.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">tidyverse</td>
<td style="text-align: left;">1.3.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">timeDate</td>
<td style="text-align: left;">4021.106</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">tweenr</td>
<td style="text-align: left;">2.0.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tzdb</td>
<td style="text-align: left;">0.3.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">urlchecker</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">usethis</td>
<td style="text-align: left;">2.1.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">utf8</td>
<td style="text-align: left;">1.2.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">vctrs</td>
<td style="text-align: left;">0.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">withr</td>
<td style="text-align: left;">2.5.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xfun</td>
<td style="text-align: left;">0.33</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">xml2</td>
<td style="text-align: left;">1.3.3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xtable</td>
<td style="text-align: left;">1.8-4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">yaml</td>
<td style="text-align: left;">2.3.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">zoo</td>
<td style="text-align: left;">1.8-11</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
</tbody>
</table>
</div>
<div class="message">
<p>Time for this code chunk to run: 0.5 minutes</p>
</div>
</div>
</div>
<div class="center-table">
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>reticulate<span class="sc">::</span><span class="fu">py_list_packages</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Python packages"</span>, <span class="at">format =</span> <span class="st">"markdown"</span>,</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Package"</span>, <span class="st">"Version"</span>, <span class="st">"Requirement"</span>),</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Python packages</caption>
<colgroup>
<col style="width: 36%">
<col style="width: 18%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Package</th>
<th style="text-align: left;">Version</th>
<th style="text-align: right;">Requirement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
<td style="text-align: right;">asttokens==2.4.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">autograd</td>
<td style="text-align: left;">1.6.2</td>
<td style="text-align: right;">autograd==1.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">autograd-gamma</td>
<td style="text-align: left;">0.5.0</td>
<td style="text-align: right;">autograd-gamma==0.5.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">certifi</td>
<td style="text-align: left;">2023.11.17</td>
<td style="text-align: right;">certifi==2023.11.17</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cffi</td>
<td style="text-align: left;">1.16.0</td>
<td style="text-align: right;">cffi==1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
<td style="text-align: right;">charset-normalizer==3.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
<td style="text-align: right;">cloudpickle==3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">colorama</td>
<td style="text-align: left;">0.4.6</td>
<td style="text-align: right;">colorama==0.4.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">comm</td>
<td style="text-align: left;">0.2.1</td>
<td style="text-align: right;">comm==0.2.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">contourpy</td>
<td style="text-align: left;">1.2.0</td>
<td style="text-align: right;">contourpy==1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cycler</td>
<td style="text-align: left;">0.12.1</td>
<td style="text-align: right;">cycler==0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">debugpy</td>
<td style="text-align: left;">1.8.0</td>
<td style="text-align: right;">debugpy==1.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">decorator</td>
<td style="text-align: left;">5.1.1</td>
<td style="text-align: right;">decorator==5.1.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">delete-chrome-history-py</td>
<td style="text-align: left;">0.1.8</td>
<td style="text-align: right;">delete-chrome-history-py==0.1.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ecos</td>
<td style="text-align: left;">2.0.13</td>
<td style="text-align: right;">ecos==2.0.13</td>
</tr>
<tr class="even">
<td style="text-align: center;">executing</td>
<td style="text-align: left;">2.0.1</td>
<td style="text-align: right;">executing==2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ffmpeg</td>
<td style="text-align: left;">1.4</td>
<td style="text-align: right;">ffmpeg==1.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">ffmpeg-python</td>
<td style="text-align: left;">0.2.0</td>
<td style="text-align: right;">ffmpeg-python==0.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">filedir</td>
<td style="text-align: left;">0.0.3</td>
<td style="text-align: right;">filedir==0.0.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">filelock</td>
<td style="text-align: left;">3.13.1</td>
<td style="text-align: right;">filelock==3.13.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fonttools</td>
<td style="text-align: left;">4.47.2</td>
<td style="text-align: right;">fonttools==4.47.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">formulaic</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">formulaic==1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
<td style="text-align: right;">fsspec==2023.12.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">future</td>
<td style="text-align: left;">0.18.3</td>
<td style="text-align: right;">future==0.18.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">idna</td>
<td style="text-align: left;">3.6</td>
<td style="text-align: right;">idna==3.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">interface-meta</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">interface-meta==1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ipykernel</td>
<td style="text-align: left;">6.29.0</td>
<td style="text-align: right;">ipykernel==6.29.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">ipython</td>
<td style="text-align: left;">8.20.0</td>
<td style="text-align: right;">ipython==8.20.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">jedi</td>
<td style="text-align: left;">0.19.1</td>
<td style="text-align: right;">jedi==0.19.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Jinja2</td>
<td style="text-align: left;">3.1.3</td>
<td style="text-align: right;">Jinja2==3.1.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">joblib</td>
<td style="text-align: left;">1.4.0</td>
<td style="text-align: right;">joblib==1.4.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">jupyter_client</td>
<td style="text-align: left;">8.6.0</td>
<td style="text-align: right;">jupyter_client==8.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">jupyter_core</td>
<td style="text-align: left;">5.7.1</td>
<td style="text-align: right;">jupyter_core==5.7.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">kiwisolver</td>
<td style="text-align: left;">1.4.5</td>
<td style="text-align: right;">kiwisolver==1.4.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lifelines</td>
<td style="text-align: left;">0.28.0</td>
<td style="text-align: right;">lifelines==0.28.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">llvmlite</td>
<td style="text-align: left;">0.41.1</td>
<td style="text-align: right;">llvmlite==0.41.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">MarkupSafe</td>
<td style="text-align: left;">2.1.4</td>
<td style="text-align: right;">MarkupSafe==2.1.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">matplotlib</td>
<td style="text-align: left;">3.8.2</td>
<td style="text-align: right;">matplotlib==3.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">matplotlib-inline</td>
<td style="text-align: left;">0.1.6</td>
<td style="text-align: right;">matplotlib-inline==0.1.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">more-itertools</td>
<td style="text-align: left;">10.2.0</td>
<td style="text-align: right;">more-itertools==10.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mpmath</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">mpmath==1.3.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">multipledispatch</td>
<td style="text-align: left;">1.0.0</td>
<td style="text-align: right;">multipledispatch==1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">natsort</td>
<td style="text-align: left;">8.4.0</td>
<td style="text-align: right;">natsort==8.4.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">nest-asyncio</td>
<td style="text-align: left;">1.5.9</td>
<td style="text-align: right;">nest-asyncio==1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">networkx</td>
<td style="text-align: left;">3.2.1</td>
<td style="text-align: right;">networkx==3.2.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">numba</td>
<td style="text-align: left;">0.58.1</td>
<td style="text-align: right;">numba==0.58.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">numexpr</td>
<td style="text-align: left;">2.10.0</td>
<td style="text-align: right;">numexpr==2.10.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">numpy</td>
<td style="text-align: left;">1.26.3</td>
<td style="text-align: right;">numpy==1.26.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">openai-whisper</td>
<td style="text-align: left;">20231117</td>
<td style="text-align: right;">openai-whisper==20231117</td>
</tr>
<tr class="even">
<td style="text-align: center;">osqp</td>
<td style="text-align: left;">0.6.5</td>
<td style="text-align: right;">osqp==0.6.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">packaging</td>
<td style="text-align: left;">23.2</td>
<td style="text-align: right;">packaging==23.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">pandas</td>
<td style="text-align: left;">2.2.0</td>
<td style="text-align: right;">pandas==2.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pandas-flavor</td>
<td style="text-align: left;">0.6.0</td>
<td style="text-align: right;">pandas-flavor==0.6.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">parso</td>
<td style="text-align: left;">0.8.3</td>
<td style="text-align: right;">parso==0.8.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">patsy</td>
<td style="text-align: left;">0.5.6</td>
<td style="text-align: right;">patsy==0.5.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">pillow</td>
<td style="text-align: left;">10.2.0</td>
<td style="text-align: right;">pillow==10.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">platformdirs</td>
<td style="text-align: left;">4.1.0</td>
<td style="text-align: right;">platformdirs==4.1.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">prompt-toolkit</td>
<td style="text-align: left;">3.0.43</td>
<td style="text-align: right;">prompt-toolkit==3.0.43</td>
</tr>
<tr class="odd">
<td style="text-align: center;">psutil</td>
<td style="text-align: left;">5.9.8</td>
<td style="text-align: right;">psutil==5.9.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">pure-eval</td>
<td style="text-align: left;">0.2.2</td>
<td style="text-align: right;">pure-eval==0.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyarrow</td>
<td style="text-align: left;">15.0.0</td>
<td style="text-align: right;">pyarrow==15.0.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">pycparser</td>
<td style="text-align: left;">2.22</td>
<td style="text-align: right;">pycparser==2.22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pydub</td>
<td style="text-align: left;">0.25.1</td>
<td style="text-align: right;">pydub==0.25.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Pygments</td>
<td style="text-align: left;">2.17.2</td>
<td style="text-align: right;">Pygments==2.17.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyjanitor</td>
<td style="text-align: left;">0.26.0</td>
<td style="text-align: right;">pyjanitor==0.26.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">pyparsing</td>
<td style="text-align: left;">3.1.1</td>
<td style="text-align: right;">pyparsing==3.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyreadr</td>
<td style="text-align: left;">0.5.0</td>
<td style="text-align: right;">pyreadr==0.5.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">python-dateutil</td>
<td style="text-align: left;">2.8.2</td>
<td style="text-align: right;">python-dateutil==2.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pytz</td>
<td style="text-align: left;">2023.3.post1</td>
<td style="text-align: right;">pytz==2023.3.post1</td>
</tr>
<tr class="even">
<td style="text-align: center;">pywin32</td>
<td style="text-align: left;">306</td>
<td style="text-align: right;">pywin32==306</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyzmq</td>
<td style="text-align: left;">25.1.2</td>
<td style="text-align: right;">pyzmq==25.1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">qdldl</td>
<td style="text-align: left;">0.1.7.post1</td>
<td style="text-align: right;">qdldl==0.1.7.post1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">regex</td>
<td style="text-align: left;">2023.12.25</td>
<td style="text-align: right;">regex==2023.12.25</td>
</tr>
<tr class="even">
<td style="text-align: center;">requests</td>
<td style="text-align: left;">2.31.0</td>
<td style="text-align: right;">requests==2.31.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rpy2</td>
<td style="text-align: left;">3.5.16</td>
<td style="text-align: right;">rpy2==3.5.16</td>
</tr>
<tr class="even">
<td style="text-align: center;">scikit-learn</td>
<td style="text-align: left;">1.3.2</td>
<td style="text-align: right;">scikit-learn==1.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">scikit-survival</td>
<td style="text-align: left;">0.22.2</td>
<td style="text-align: right;">scikit-survival==0.22.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">scipy</td>
<td style="text-align: left;">1.11.4</td>
<td style="text-align: right;">scipy==1.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">semantic-version</td>
<td style="text-align: left;">2.10.0</td>
<td style="text-align: right;">semantic-version==2.10.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">setuptools-rust</td>
<td style="text-align: left;">1.8.1</td>
<td style="text-align: right;">setuptools-rust==1.8.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">six</td>
<td style="text-align: left;">1.16.0</td>
<td style="text-align: right;">six==1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">SpeechRecognition</td>
<td style="text-align: left;">3.10.1</td>
<td style="text-align: right;">SpeechRecognition==3.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">spyder-kernels</td>
<td style="text-align: left;">2.5.0</td>
<td style="text-align: right;">spyder-kernels==2.5.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">stack-data</td>
<td style="text-align: left;">0.6.3</td>
<td style="text-align: right;">stack-data==0.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">statsmodels</td>
<td style="text-align: left;">0.14.1</td>
<td style="text-align: right;">statsmodels==0.14.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">sympy</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: right;">sympy==1.12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">target</td>
<td style="text-align: left;">0.0.11</td>
<td style="text-align: right;">target==0.0.11</td>
</tr>
<tr class="even">
<td style="text-align: center;">threadpoolctl</td>
<td style="text-align: left;">3.4.0</td>
<td style="text-align: right;">threadpoolctl==3.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tiktoken</td>
<td style="text-align: left;">0.5.2</td>
<td style="text-align: right;">tiktoken==0.5.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">torch</td>
<td style="text-align: left;">2.1.2</td>
<td style="text-align: right;">torch==2.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tornado</td>
<td style="text-align: left;">6.4</td>
<td style="text-align: right;">tornado==6.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">tqdm</td>
<td style="text-align: left;">4.66.1</td>
<td style="text-align: right;">tqdm==4.66.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">traitlets</td>
<td style="text-align: left;">5.14.1</td>
<td style="text-align: right;">traitlets==5.14.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">typing_extensions</td>
<td style="text-align: left;">4.9.0</td>
<td style="text-align: right;">typing_extensions==4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tzdata</td>
<td style="text-align: left;">2023.4</td>
<td style="text-align: right;">tzdata==2023.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">tzlocal</td>
<td style="text-align: left;">5.2</td>
<td style="text-align: right;">tzlocal==5.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">urllib3</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: right;">urllib3==2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">watchdog</td>
<td style="text-align: left;">3.0.0</td>
<td style="text-align: right;">watchdog==3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
<td style="text-align: right;">wcwidth==0.2.13</td>
</tr>
<tr class="even">
<td style="text-align: center;">whisper</td>
<td style="text-align: left;">1.1.10</td>
<td style="text-align: right;">whisper==1.1.10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
<td style="text-align: right;">wrapt==1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">xarray</td>
<td style="text-align: left;">2024.1.1</td>
<td style="text-align: right;">xarray==2024.1.1</td>
</tr>
</tbody>
</table>
</div>
<div class="message">
<p>Time for this code chunk to run: 0.1 minutes</p>
</div>
</div>
</div>
</section>
<section id="output" class="level1">
<h1>Output</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"an_grant_23_24_4.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Time for this code chunk to run: 0.1 minutes</p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>