<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés González Santa Cruz">
<meta name="dcterms.date" content="2024-05-17">
<meta name="description" content="Analyze the association between polysubstance at admission and tr. compleiton longitudinally along treatments, accounting for irregular observations.">

<title>Polysubstance and tr. completion</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="proposal_grant_23_24_3_files/libs/clipboard/clipboard.min.js"></script>
<script src="proposal_grant_23_24_3_files/libs/quarto-html/quarto.js"></script>
<script src="proposal_grant_23_24_3_files/libs/quarto-html/popper.min.js"></script>
<script src="proposal_grant_23_24_3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="proposal_grant_23_24_3_files/libs/quarto-html/anchor.min.js"></script>
<link href="proposal_grant_23_24_3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="proposal_grant_23_24_3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="proposal_grant_23_24_3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="proposal_grant_23_24_3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="proposal_grant_23_24_3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="proposal_grant_23_24_3_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>

<script src="proposal_grant_23_24_3_files/libs/viz-1.8.2/viz.js"></script>

<link href="proposal_grant_23_24_3_files/libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">

<script src="proposal_grant_23_24_3_files/libs/grViz-binding-1.0.9/grViz.js"></script>



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Polysubstance and tr. completion</h1>
</div>

<div>
  <div class="description">
    <p>Analyze the association between polysubstance at admission and tr. compleiton longitudinally along treatments, accounting for irregular observations.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés González Santa Cruz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"

</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

$('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');

// onClick function for all plots (img's)

$('img:not(.zoomImg)').click(function() {
$('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
$('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
});

// onClick function for zoomImg

$('img.zoomImg').click(function() {
$('.zoomDiv').css({opacity: '0', width: '0%'});
});
});
</script>
</div>
<div class="cell">
<style type="text/css">
<script src="https://github.com/AGSCL/gine_brechas_pandemia/blob/main/hideOutput.js"></script>
</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

\$chunks = \$('.fold');

\$chunks.each(function () { // add button to source code chunks
if ( \$(this).hasClass('s') ) {
    \$('pre.r', this).prepend("\<div class=\\"showopt\\"\>Show Source\</div\>\<br style=\\"line-height:22px;\\"/\>");
    \$('pre.r', this).children('code').attr('class', 'folded');
    } // add button to output chunks

    if ( \$(this).hasClass('o') ) {
        \$('pre:not(.r)', this).has('code').prepend("\<div class=\\"showopt\\"\>Show Output\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre:not(.r)', this).children('code:not(r)').addClass('folded'); // add button to plots
        \$(this).find('img').wrap('\<pre class=\\"plot\\"\>\</pre\>');
        \$('pre.plot', this).prepend("\<div class=\\"showopt\\"\>Show Plot\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre.plot', this).children('img').addClass('folded');
        }
}); // hide all chunks when document is loaded

\$('.folded').css('display', 'none') // function to toggle the visibility
\$('.showopt').click(function() {
        var label = \$(this).html();
        if (label.indexOf("Show") \>= 0) {
            \$(this).html(label.replace("Show", "Hide"));
        } else {
        \$(this).html(label.replace("Hide", "Show"));
        }

\$(this).siblings('code, img').slideToggle('fast', 'swing');
});
});
</script>
</div>
<style type="text/css">

.showopt {

background-color: #004c93; color: #FFFFFF; width: 100px; height: 20px; text-align: center; vertical-align: middle !important; float: right; font-family: sans-serif; border-radius: 8px;

}

.showopt:hover {
background-color: #dfe4f2;
color: #004c93;

}

pre.plot {
background-color: white !important;
}

.tablelines table, .tablelines td, .tablelines th {
border: 1px solid black;
}

.centrado {
text-align: center;
}

.table.center {
margin-left:auto;
margin-right:auto;
}

/* https://vivekjaiskumar.medium.com/css-is-and-not-selector-17c942ec83f :is()*/

/* Applies to outputs that are not code other than R*/

pre {
overflow-x: auto !important;
}

pre code {
word-wrap: normal !important;
white-space: pre !important;
}

/*
pre:not(.sourceCode) {
white-space: nowrap !important;
}
*/
.sourceCode { /* Important gives precedence */
font-size: 10px !important;
line-height: 50% !important;
}
body{ /* Normal */
text-align: justify;
}
.superbigimage{
overflow-y:scroll;
height:350px;
white-space: nowrap;
overflow-x: auto;
width:100%;
}
.superbigimage img{
overflow-y: scroll;
overflow-x: hidden;
}
.message { color:#446C6E; font-family: monospace;font-size: 10px; line-height: 110%; font-weight: bold;}
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 5px; text-align: justify;}
div.red { background-color:#e6bab1; border-radius: 5px; padding: 5px; text-align: justify;}
.pandoc-table { /* Should add !important; but it seems no necessary */
margin-left:auto; /* To center */
margin-right:auto;
border-collapse: collapse;
table-layout: auto;
font-size: 11px;
overflow-y: auto;
max-height:450px !important;
white-space: nowrap;
overflow-x: auto;
width:450px;
}
.pandoc-table th {/* header */
text-align: center !important;
font-size: 10px;
padding: 0px;
}
.pandoc-table td {
text-align: left !important;
font-size: 9px;
padding: 0px;
}
.pandoc-table caption {
text-align: left !important;
font-size: 11px !important;
}

.center-table {
text-align: left !important;
font-size: 9px;
padding: 0px;
overflow-y:scroll;
height:400px;
overflow-x: scroll;
}

.controlly{
overflow-y:scroll;
height:350px;
overflow-x: scroll;

}
</style>
<!-- We gotta do each function to hide code and outputs per section, by every ID, we gotta create a different function -->

<script>
function myFunction1() {
var x = document.getElementById("myDIV");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>

<script>
function myFunction2() {
var x = document.getElementById("myDIV2");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"proposal_grant_23_24_files"</span>, <span class="at">recursive=</span>T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fuentes: </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rpubs.com/georgy_makarov/897844</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>path<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">'/env'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  "")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  Sys.which("python"))</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#reticulate::py_config()</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#use_python(paste0(path,"/Scripts/python.exe"))</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH =  paste0(path,"/Lib"))</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH_64 =  paste0(path,"/Lib"))</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#instalar paquetes de funcionalidades básicas para tener ubicaciones relativas y acceso a python (reticulate)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(reticulate)){<span class="fu">install.packages</span>(<span class="st">"reticulate"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: reticulate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'reticulate' was built under R version 4.1.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(rstudioapi)){<span class="fu">install.packages</span>(<span class="st">"rstudioapi"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rstudioapi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rstudioapi' was built under R version 4.1.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Create env"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/54043607/how-to-set-pyenv-python-for-reticulate</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Directory H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env is not a Python virtualenv</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#virtualenv_create(envname  = path, packages = c("pip", "statsmodels", "matplotlib", "numpy", "pandas", "scipy"))</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># "C:/Users/andre/anaconda3/python.exe" -m venv "H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/9_Computacion_Estadistica/env"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#FUENTES:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/articles/versions.html</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Virtual environment functions are not supported on Windows (the use of conda environments is recommended on Windows).</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Use environment"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#https://ugoproto.github.io/ugo_r_doc/pdf/reticulate.pdf</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># tx  &lt;- readLines(paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[1]] &lt;- paste0("home = ",gsub('/', '\\', paste0(path,"/Scripts/python.exe"), fixed=T))</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[3]] &lt;- "version = 3.8.0"</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#writeLines(tx, con=paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env/Scripts/python.exe"</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#use_virtualenv(path)</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#usar entorno virtual ya creado</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#información sobre entorno virtual</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#py_discover_config()</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#conda_python(envname =  "r-scrublet")</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># FUENTES</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#https://akrabat.com/creating-virtual-environments-with-pyenv/</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/reference/install_python.html</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/wiki#suggested-build-environment</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/56755156/reticulate-not-setting-python-path</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/rstudio/reticulate/issues/291#issuecomment-437143751</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv-win/pyenv-win#installation</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/52060867/how-to-use-pip-for-pyenv</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/issues/2417</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv install <span class="op">-</span>l <span class="op">|</span> findstr <span class="fl">3.8</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>upgrade pyenv<span class="op">-</span>win</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install <span class="fl">3.7.5</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv build</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># `r format(Sys.time(),'%B %d, %Y')`</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data import</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"an_grant_23_24.RData"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># List all of the objects names in RData:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(.GlobalEnv)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(new_environment)</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(new_environment)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<section id="packages" class="level1">
<h1>Packages</h1>
<p><br></p>
</section>
<section id="database-consolidation" class="level1">
<h1>Database consolidation</h1>
<p>We used <code>Base_fiscalia_v15f_grant_23_24</code> instead of v16, because we wanted to capture more treatments from each people.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Label variables"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-19</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Complete status of treatment (binary)"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>offense_after_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Committing an offense after admission (binary)"</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>age_at_censor_date,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at censorship"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>age_offending_imp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at offending"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>age_tr_comp_imp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at completing tr."</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#attr(Base_fiscalia_v15f_grant_23_24$tr_modality,"label") &lt;- "Treatment Modality"</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>time_to_off_from_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to offense from admission"</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>time_to_drop_from_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to dropout from admission"</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-31</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>age_at_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at death"</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>date_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to death from admission"</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>event_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Death from admission"</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>event_comp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Event: tr.completion"</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>event_offense,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Event: offense"</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>edad_al_ing_1,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age (admission to treatment)"</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>sex,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Sex"</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>edad_ini_cons,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age of Onset of Substance Use"</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>escolaridad_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Educational Attainment"</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>sus_principal_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary Substance (admission to treatment)"</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>freq_cons_sus_prin,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Frequency of Substance Use (Primary Substance)"</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Corrected Occupational Status (f)"</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>policonsumo,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Co-occurring Substance Use Disorders (Polysubstance use)"</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#20203-07-17</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>otras_sus1_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"First additional substance at admission"</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>otras_sus2_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Second additional substance at admission"</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>otras_sus3_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Third additional substance at admission"</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>num_hijos_mod_joel_bin,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Number of Children (dichotomized)"</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>tenencia_de_la_vivienda_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Housing Situation (Tenure Status)"</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>macrozona,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Macro Administrative Zone in Chile"</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_off_vio,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Violent Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_off_acq,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Acquisitive Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_off_sud,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Substance-Related Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_off_oth,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Other Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>dg_cie_10_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Psychiatric Comorbidity (ICD-10)"</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>dg_trs_cons_sus_or,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"SUD Severity (Dependence status)"</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>clas_r,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Urbanicity"</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>porc_pobr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Percentage of people in poverty"</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>sus_ini_mod_mvv,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary Substance (initial diagnosis)"</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>ano_nac_corr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Corrected birth year"</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>con_quien_vive_joel,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Cohabitation status (Recoded) (f)"</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>fis_comorbidity_icd_10,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Physical Comorbidity (ICD-10)"</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_post_off_vio,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Violent Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_post_off_acq,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Acquisitive Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_post_off_sud,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Substance-Related Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_post_off_oth,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Other Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>n_post_off,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Post-treatment Offenses"</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">#2024-01-27</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>compromiso_biopsicosocial,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Biopsychosocial compromise"</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>origen_ingreso_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Treatment Admission Motive"</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr24 <span class="ot">&lt;-</span> </span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">if_else</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr<span class="sc">==</span><span class="st">"Looking for a job for the first time"</span>,<span class="st">"Unemployed"</span>, Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr, <span class="at">missing=</span><span class="cn">NA_character_</span>)</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr24 <span class="ot">&lt;-</span> </span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">if_else</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr<span class="sc">==</span><span class="st">"No activity"</span>,<span class="st">"Inactive"</span>, Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr24, <span class="at">missing=</span><span class="cn">NA_character_</span>)</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr24 <span class="ot">&lt;-</span> </span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">if_else</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr<span class="sc">==</span><span class="st">"Not seeking for work"</span>,<span class="st">"Inactive"</span>, Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr24, <span class="at">missing=</span><span class="cn">NA_character_</span>)</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Si la persona No Trabajó, interesa saber si está Desocupada (“busca trabajo por primera vez” o “cesante”) o</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="co">#Inactiva (que corresponde al resto de la opciones, quehaceres del hogar, estudiando, jubilado, etc.)</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24 <span class="ot">&lt;-</span> Base_fiscalia_v15f_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">freq_cons_sus_prin_ord =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>    freq_cons_sus_prin <span class="sc">==</span> <span class="st">"Less than 1 day a week"</span> <span class="sc">~</span> <span class="st">"1. Less than 1 day a week"</span>,</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    freq_cons_sus_prin <span class="sc">==</span> <span class="st">"1 day a week or more"</span> <span class="sc">~</span> <span class="st">"2. 1 day a week or more"</span>,</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    freq_cons_sus_prin <span class="sc">==</span> <span class="st">"2 to 3 days a week"</span> <span class="sc">~</span> <span class="st">"3. 2 to 3 days a week"</span>,</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>    freq_cons_sus_prin <span class="sc">==</span> <span class="st">"4 to 6 days a week"</span> <span class="sc">~</span> <span class="st">"4. 4 to 6 days a week"</span>,</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    freq_cons_sus_prin <span class="sc">==</span> <span class="st">"Daily"</span> <span class="sc">~</span> <span class="st">"5. Daily"</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">clas_r=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(clas_r<span class="sc">==</span><span class="st">"Mixta"</span><span class="sc">~</span><span class="st">"Mixed"</span>, clas_r<span class="sc">==</span><span class="st">"Urbana"</span><span class="sc">~</span><span class="st">"Urban"</span>,clas_r<span class="sc">==</span><span class="st">"Rural"</span><span class="sc">~</span><span class="st">"Rural"</span>, T<span class="sc">~</span>clas_r)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tenencia_de_la_vivienda_mod  =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(clas_r<span class="sc">==</span><span class="st">"Illegal Settlement"</span><span class="sc">~</span><span class="st">"Others"</span>, T<span class="sc">~</span>tenencia_de_la_vivienda_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2024-04-30: Divide type of plan according to program</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tipo_de_plan_2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">as.character</span>(tipo_de_plan_2)<span class="sc">==</span><span class="st">"M-PR"</span><span class="sc">~</span><span class="st">"WO residential"</span>, tipo_de_plan_2<span class="sc">==</span><span class="st">"PG-PR"</span><span class="sc">~</span> <span class="st">"GP residential"</span>,tipo_de_plan_2<span class="sc">==</span><span class="st">"M-PAI"</span><span class="sc">~</span> <span class="st">"WO intensive ambulatory"</span>,tipo_de_plan_2<span class="sc">==</span><span class="st">"PG-PAI"</span><span class="sc">~</span> <span class="st">"GP intensive ambulatory"</span>,<span class="fu">grepl</span>(<span class="st">"PAB"</span>,tipo_de_plan_2)<span class="sc">~</span><span class="st">"basic ambulatory"</span>, T<span class="sc">~</span><span class="cn">NA_character_</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tipo_de_plan_2=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">grepl</span>(<span class="st">"PR"</span>,tipo_de_plan_2)<span class="sc">~</span><span class="st">"residential"</span>,<span class="fu">grepl</span>(<span class="st">"PAB"</span>,tipo_de_plan_2)<span class="sc">~</span><span class="st">"basic ambulatory"</span>,<span class="fu">grepl</span>(<span class="st">"PAI"</span>,tipo_de_plan_2)<span class="sc">~</span><span class="st">"intensive ambulatory"</span>, T<span class="sc">~</span><span class="cn">NA_character_</span>))</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>   <span class="co">#%&gt;% #janitor::tabyl(tipo_de_plan_2_mod)</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr24,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Corrected Occupational Status"</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>freq_cons_sus_prin_ord,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Frequency of Substance Use (Primary Substance)"</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the new variable</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>freq_cons_sus_prin_ord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
1. Less than 1 day a week   2. 1 day a week or more     3. 2 to 3 days a week 
                     4178                      5610                     23716 
    4. 4 to 6 days a week                  5. Daily 
                    13923                     37200 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vars_cov <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, <span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin_ord"</span>, <span class="st">"condicion_ocupacional_corr24"</span>, <span class="st">"policonsumo"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, <span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, <span class="st">"fis_comorbidity_icd_10"</span>,  <span class="st">"compromiso_biopsicosocial"</span>, <span class="st">"origen_ingreso_mod"</span>, <span class="st">"tipo_centro_pub"</span>,<span class="st">"tipo_de_plan_2"</span>, <span class="st">"tipo_de_plan_2_mod"</span>) </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Function to format CreateTableOne into a database"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>as.data.frame.TableOne <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {<span class="fu">capture.output</span>(<span class="fu">print</span>(x,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">showAllLevels =</span> <span class="cn">TRUE</span>, <span class="at">varLabels =</span> T,...) <span class="ot">-&gt;</span> x)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  y<span class="sc">$</span>characteristic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="fu">rownames</span>(x), <span class="st">""</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(characteristic, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(characteristic, <span class="fu">everything</span>())</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(y) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  y}</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>tbone_desc_merge_total_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span><span class="fu">c</span>(<span class="fu">setdiff</span>(vars_cov, <span class="st">"policonsumo"</span>), <span class="st">"offense_after_adm"</span>), <span class="at">data=</span>  Base_fiscalia_v15f_grant_23_24[,<span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin_ord"</span>, </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="st">"condicion_ocupacional_corr24"</span>, <span class="st">"policonsumo"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"compromiso_biopsicosocial"</span>, <span class="st">"origen_ingreso_mod"</span>,<span class="st">"tipo_centro_pub"</span>)], <span class="at">factorVars =</span> <span class="fu">setdiff</span>(vars_cov, <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"edad_al_ing_1"</span>, <span class="st">"edad_ini_cons"</span>,<span class="st">"ano_nac_corr"</span>, <span class="st">"porc_pobr"</span>)), <span class="at">smd=</span>T, <span class="at">strata=</span><span class="st">"policonsumo"</span>, <span class="at">addOverall =</span> T, <span class="at">includeNA=</span>T, <span class="at">test=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in ModuleReturnVarsExist(vars, data): The data frame does not have: tipo_de_plan_2 tipo_de_plan_2_mod offense_after_adm Dropped</p>
</div>
<div class="alert alert-warning">
<p>Warning in ModuleReturnVarsExist(factorVars, data): The data frame does not have: tipo_de_plan_2 tipo_de_plan_2_mod Dropped</p>
</div>
</div>
<p>We compared the characteristics of people who used multiple substances and those who did not in the total database between 2013 and 2019.</p>
<div class="center-table">
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge_total_grant_23_24, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,<span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_replace_all</span>(., <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">( "</span>, <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_trim</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance(1) and no Polysubstance use (0)"</span>, <span class="at">escape=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 56 values (71%) of ‘characteristic’ (56 fewer NA)</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary descriptives, Polysubstance(1) and no Polysubstance use (0)</caption>
<colgroup>
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">characteristic</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>n</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>85048</strong></td>
<td style="text-align: left;"><strong>22552</strong></td>
<td style="text-align: left;"><strong>62496</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment completion</td>
<td style="text-align: left;">19278 (22.7)</td>
<td style="text-align: left;">6404 (28.4)</td>
<td style="text-align: left;">12874 (20.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.183</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: left;">65761 (77.3)</td>
<td style="text-align: left;">16148 (71.6)</td>
<td style="text-align: left;">49613 (79.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">9 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;">9 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age (admission to treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.21 [27.41, 43.17]</td>
<td style="text-align: left;">41.71 [32.29, 51.21]</td>
<td style="text-align: left;">32.33 [26.45, 39.90]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.743</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Men</td>
<td style="text-align: left;">64028 (75.3)</td>
<td style="text-align: left;">16502 (73.2)</td>
<td style="text-align: left;">47526 (76.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Women</td>
<td style="text-align: left;">21020 (24.7)</td>
<td style="text-align: left;">6050 (26.8)</td>
<td style="text-align: left;">14970 (24.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Age of Onset of Substance Use (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">15.00 [14.00, 18.00]</td>
<td style="text-align: left;">17.00 [14.00, 20.00]</td>
<td style="text-align: left;">15.00 [13.00, 17.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.425</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">1-More than high school</td>
<td style="text-align: left;">14068 (16.5)</td>
<td style="text-align: left;">3215 (14.3)</td>
<td style="text-align: left;">10853 (17.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.230</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">2-Completed high school or less</td>
<td style="text-align: left;">46653 (54.9)</td>
<td style="text-align: left;">11143 (49.4)</td>
<td style="text-align: left;">35510 (56.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">3-Completed primary school or less</td>
<td style="text-align: left;">23943 (28.2)</td>
<td style="text-align: left;">8044 (35.7)</td>
<td style="text-align: left;">15899 (25.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">384 (0.5)</td>
<td style="text-align: left;">150 (0.7)</td>
<td style="text-align: left;">234 (0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">28859 (33.9)</td>
<td style="text-align: left;">14212 (63.0)</td>
<td style="text-align: left;">14647 (23.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.890</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">16151 (19.0)</td>
<td style="text-align: left;">2337 (10.4)</td>
<td style="text-align: left;">13814 (22.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">32681 (38.4)</td>
<td style="text-align: left;">4511 (20.0)</td>
<td style="text-align: left;">28170 (45.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">5771 (6.8)</td>
<td style="text-align: left;">972 (4.3)</td>
<td style="text-align: left;">4799 (7.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1585 (1.9)</td>
<td style="text-align: left;">519 (2.3)</td>
<td style="text-align: left;">1066 (1.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">1. Less than 1 day a week</td>
<td style="text-align: left;">4178 (4.9)</td>
<td style="text-align: left;">1530 (6.8)</td>
<td style="text-align: left;">2648 (4.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.186</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">2. 1 day a week or more</td>
<td style="text-align: left;">5610 (6.6)</td>
<td style="text-align: left;">1922 (8.5)</td>
<td style="text-align: left;">3688 (5.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">3. 2 to 3 days a week</td>
<td style="text-align: left;">23716 (27.9)</td>
<td style="text-align: left;">6641 (29.4)</td>
<td style="text-align: left;">17075 (27.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">4. 4 to 6 days a week</td>
<td style="text-align: left;">13923 (16.4)</td>
<td style="text-align: left;">3580 (15.9)</td>
<td style="text-align: left;">10343 (16.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">5. Daily</td>
<td style="text-align: left;">37200 (43.7)</td>
<td style="text-align: left;">8744 (38.8)</td>
<td style="text-align: left;">28456 (45.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">421 (0.5)</td>
<td style="text-align: left;">135 (0.6)</td>
<td style="text-align: left;">286 (0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">Employed</td>
<td style="text-align: left;">41407 (48.7)</td>
<td style="text-align: left;">12657 (56.1)</td>
<td style="text-align: left;">28750 (46.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.276</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">Inactive</td>
<td style="text-align: left;">14258 (16.8)</td>
<td style="text-align: left;">4206 (18.7)</td>
<td style="text-align: left;">10052 (16.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">Unemployed</td>
<td style="text-align: left;">29382 (34.5)</td>
<td style="text-align: left;">5688 (25.2)</td>
<td style="text-align: left;">23694 (37.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">20138 (23.7)</td>
<td style="text-align: left;">4161 (18.5)</td>
<td style="text-align: left;">15977 (25.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.172</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">64165 (75.4)</td>
<td style="text-align: left;">18191 (80.7)</td>
<td style="text-align: left;">45974 (73.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">745 (0.9)</td>
<td style="text-align: left;">200 (0.9)</td>
<td style="text-align: left;">545 (0.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Illegal Settlement</td>
<td style="text-align: left;">906 (1.1)</td>
<td style="text-align: left;">200 (0.9)</td>
<td style="text-align: left;">706 (1.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">2354 (2.8)</td>
<td style="text-align: left;">609 (2.7)</td>
<td style="text-align: left;">1745 (2.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Owner/Transferred dwellings/Pays Dividends</td>
<td style="text-align: left;">29934 (35.2)</td>
<td style="text-align: left;">9863 (43.7)</td>
<td style="text-align: left;">20071 (32.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Renting</td>
<td style="text-align: left;">14566 (17.1)</td>
<td style="text-align: left;">3835 (17.0)</td>
<td style="text-align: left;">10731 (17.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Stays temporarily with a relative</td>
<td style="text-align: left;">32609 (38.3)</td>
<td style="text-align: left;">6829 (30.3)</td>
<td style="text-align: left;">25780 (41.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">4679 (5.5)</td>
<td style="text-align: left;">1216 (5.4)</td>
<td style="text-align: left;">3463 (5.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">Center</td>
<td style="text-align: left;">64341 (75.7)</td>
<td style="text-align: left;">16681 (74.0)</td>
<td style="text-align: left;">47660 (76.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.293</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">North</td>
<td style="text-align: left;">12151 (14.3)</td>
<td style="text-align: left;">2243 (9.9)</td>
<td style="text-align: left;">9908 (15.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">8536 (10.0)</td>
<td style="text-align: left;">3625 (16.1)</td>
<td style="text-align: left;">4911 (7.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">20 (0.0)</td>
<td style="text-align: left;">3 (0.0)</td>
<td style="text-align: left;">17 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without psychiatric comorbidity</td>
<td style="text-align: left;">32337 (38.0)</td>
<td style="text-align: left;">10022 (44.4)</td>
<td style="text-align: left;">22315 (35.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">16099 (18.9)</td>
<td style="text-align: left;">3575 (15.9)</td>
<td style="text-align: left;">12524 (20.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">With psychiatric comorbidity</td>
<td style="text-align: left;">36612 (43.0)</td>
<td style="text-align: left;">8955 (39.7)</td>
<td style="text-align: left;">27657 (44.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Drug dependence</td>
<td style="text-align: left;">61836 (72.7)</td>
<td style="text-align: left;">13974 (62.0)</td>
<td style="text-align: left;">47862 (76.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.321</td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Hazardous consumption</td>
<td style="text-align: left;">23211 (27.3)</td>
<td style="text-align: left;">8577 (38.0)</td>
<td style="text-align: left;">14634 (23.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">Mixed</td>
<td style="text-align: left;">8205 (9.6)</td>
<td style="text-align: left;">2850 (12.6)</td>
<td style="text-align: left;">5355 (8.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.272</td>
</tr>
<tr class="odd">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">7148 (8.4)</td>
<td style="text-align: left;">2977 (13.2)</td>
<td style="text-align: left;">4171 (6.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">69693 (81.9)</td>
<td style="text-align: left;">16724 (74.2)</td>
<td style="text-align: left;">52969 (84.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">2 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Percentage of people in poverty (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.11 [0.07, 0.16]</td>
<td style="text-align: left;">0.11 [0.07, 0.15]</td>
<td style="text-align: left;">0.12 [0.08, 0.17]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.104</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">46623 (54.8)</td>
<td style="text-align: left;">15574 (69.1)</td>
<td style="text-align: left;">31049 (49.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.505</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">3162 (3.7)</td>
<td style="text-align: left;">957 (4.2)</td>
<td style="text-align: left;">2205 (3.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">3864 (4.5)</td>
<td style="text-align: left;">1321 (5.9)</td>
<td style="text-align: left;">2543 (4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">22991 (27.0)</td>
<td style="text-align: left;">3083 (13.7)</td>
<td style="text-align: left;">19908 (31.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1987 (2.3)</td>
<td style="text-align: left;">563 (2.5)</td>
<td style="text-align: left;">1424 (2.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">6421 (7.5)</td>
<td style="text-align: left;">1054 (4.7)</td>
<td style="text-align: left;">5367 (8.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected birth year (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1980.00 [1971.00, 1987.00]</td>
<td style="text-align: left;">1974.00 [1964.00, 1983.00]</td>
<td style="text-align: left;">1982.00 [1974.00, 1988.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.630</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Alone</td>
<td style="text-align: left;">8026 (9.4)</td>
<td style="text-align: left;">2765 (12.3)</td>
<td style="text-align: left;">5261 (8.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.342</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Family of origin</td>
<td style="text-align: left;">35576 (41.8)</td>
<td style="text-align: left;">6866 (30.4)</td>
<td style="text-align: left;">28710 (45.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">7291 (8.6)</td>
<td style="text-align: left;">1802 (8.0)</td>
<td style="text-align: left;">5489 (8.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">With couple/children</td>
<td style="text-align: left;">34154 (40.2)</td>
<td style="text-align: left;">11118 (49.3)</td>
<td style="text-align: left;">23036 (36.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without physical comorbidity</td>
<td style="text-align: left;">33609 (39.5)</td>
<td style="text-align: left;">8363 (37.1)</td>
<td style="text-align: left;">25246 (40.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.084</td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">45892 (54.0)</td>
<td style="text-align: left;">12457 (55.2)</td>
<td style="text-align: left;">33435 (53.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">One or more</td>
<td style="text-align: left;">5547 (6.5)</td>
<td style="text-align: left;">1732 (7.7)</td>
<td style="text-align: left;">3815 (6.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">1-Mild</td>
<td style="text-align: left;">7986 (9.4)</td>
<td style="text-align: left;">3801 (16.9)</td>
<td style="text-align: left;">4185 (6.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.420</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">2-Moderate</td>
<td style="text-align: left;">48355 (56.9)</td>
<td style="text-align: left;">13544 (60.1)</td>
<td style="text-align: left;">34811 (55.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">3-Severe</td>
<td style="text-align: left;">27150 (31.9)</td>
<td style="text-align: left;">4743 (21.0)</td>
<td style="text-align: left;">22407 (35.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1557 (1.8)</td>
<td style="text-align: left;">464 (2.1)</td>
<td style="text-align: left;">1093 (1.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Spontaneous</td>
<td style="text-align: left;">38028 (44.7)</td>
<td style="text-align: left;">10097 (44.8)</td>
<td style="text-align: left;">27931 (44.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.187</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Assisted Referral</td>
<td style="text-align: left;">7967 (9.4)</td>
<td style="text-align: left;">1455 (6.5)</td>
<td style="text-align: left;">6512 (10.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">4514 (5.3)</td>
<td style="text-align: left;">1184 (5.3)</td>
<td style="text-align: left;">3330 (5.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Justice Sector</td>
<td style="text-align: left;">7976 (9.4)</td>
<td style="text-align: left;">2787 (12.4)</td>
<td style="text-align: left;">5189 (8.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Health Sector</td>
<td style="text-align: left;">26563 (31.2)</td>
<td style="text-align: left;">7029 (31.2)</td>
<td style="text-align: left;">19534 (31.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tipo_centro_pub (%)</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">24070 (28.3)</td>
<td style="text-align: left;">3414 (15.1)</td>
<td style="text-align: left;">20656 (33.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.429</td>
</tr>
<tr class="even">
<td style="text-align: left;">tipo_centro_pub (%)</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">60958 (71.7)</td>
<td style="text-align: left;">19135 (84.8)</td>
<td style="text-align: left;">41823 (66.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tipo_centro_pub (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">20 (0.0)</td>
<td style="text-align: left;">3 (0.0)</td>
<td style="text-align: left;">17 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(size=10, format="html",caption= "Summary descriptives, by Baseline Treatment Status") %&gt;%     kableExtra::kable_classic()</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge_total_grant_23_24, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,<span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_replace_all</span>(., <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">( "</span>, <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_trim</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.table</span>(<span class="st">"_proposal_grant/2023/baseline_psu_desc_smd.csv"</span>, <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 56 values (71%) of ‘characteristic’ (56 fewer NA)</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2022 (github)\_proposal_grant/2023</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<section id="long-format" class="level2">
<h2 class="anchored" data-anchor-id="long-format">Long format</h2>
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>CONS_C1_df_dup_SEP_2020_mod<span class="ot">&lt;-</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>CONS_C1_df_dup_SEP_2020[,<span class="fu">c</span>(<span class="st">"hash_key"</span>,<span class="st">"rn_hash"</span>,<span class="st">"otras_sus1_mod"</span>,<span class="st">"otras_sus2_mod"</span>,<span class="st">"otras_sus3_mod"</span>,<span class="st">"sus_principal_mod"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"otras_sus"</span>), <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.character</span>(.) <span class="sc">==</span> <span class="st">"Cocaína"</span> <span class="sc">~</span> <span class="st">"Cocaine hydrochloride"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.character</span>(.) <span class="sc">==</span> <span class="st">"Marihuana"</span> <span class="sc">~</span> <span class="st">"Marijuana"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.character</span>(.) <span class="sc">==</span> <span class="st">"Otros"</span> <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.character</span>(.) <span class="sc">==</span> <span class="st">"Pasta Base"</span> <span class="sc">~</span> <span class="st">"Cocaine paste"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(.)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    ))) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sus_principal_mod=</span> <span class="fu">as.character</span>(sus_principal_mod)) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Empty substances were replaced with the previous</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus3_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(otras_sus2_mod)<span class="sc">~</span> otras_sus3_mod, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus2_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(otras_sus1_mod)<span class="sc">~</span> otras_sus2_mod, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sus_principal_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus1_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(sus_principal_mod)<span class="sc">~</span> otras_sus1_mod, <span class="cn">TRUE</span><span class="sc">~</span> sus_principal_mod)) <span class="sc">%&gt;%</span>  </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span>   </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="cn">TRUE</span><span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span>  </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, rn_hash, sus_principal_mod,otras_sus1_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">policonsumo2=</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus1_mod),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#  dplyr::mutate(adv=ifelse(otras_sus1_mod==sus_principal_mod,1,0)) %&gt;% </span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#    dplyr::filter(adv==1)</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vars_cov &lt;- c("motivodeegreso_mod_imp_rec", "edad_al_ing_1", "sex", "edad_ini_cons", "escolaridad_rec", "sus_principal_mod", "freq_cons_sus_prin", "condicion_ocupacional_corr", "policonsumo", "otras_sus1_mod", "otras_sus2_mod", "otras_sus3_mod", "num_hijos_mod_joel_bin", "tenencia_de_la_vivienda_mod", "macrozona", "n_off_vio", "n_off_acq", "n_off_sud", "n_off_oth", "dg_cie_10_rec", "dg_trs_cons_sus_or", "clas_r", "porc_pobr", "sus_ini_mod_mvv", "ano_nac_corr", "con_quien_vive_joel", "fis_comorbidity_icd_10", "time_to_off_from_adm", "time_to_drop_from_adm", "age_at_censor_date", "age_tr_comp_imp", "age_offending_imp", "age_at_death","event_death", "n_post_off_vio", "n_post_off_acq", "n_post_off_sud", "n_post_off_oth", "n_post_off","hurto", "robo", "venta_drogas", "rina", "total_vif", "otro", "tot_off_top", "edad_a_ap_top_num",   "edad_b_ap_top_num", "na_top_count", "n_top_records")</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#tipo_de_plan_2_1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#motivodeegreso_mod_imp_1</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dias_treat_imp_sin_na_1</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#fech_ing_num_1</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#fech_egres_num_1</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#edad_al_ing_1</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#edad_al_egres_1</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long<span class="ot">&lt;-</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"hash_key"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(<span class="st">"motivodeegreso_mod_imp_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(<span class="st">"dias_treat_imp_sin_na_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(<span class="st">"fech_ing_num_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(<span class="st">"fech_egres_num_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(<span class="st">"tipo_de_plan_2_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, <span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin_ord"</span>, <span class="st">"condicion_ocupacional_corr24"</span>, <span class="st">"policonsumo"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, <span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, <span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, <span class="st">"tipo_de_plan_2_mod"</span>, </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#2024-01-28: se agregan 3 variables</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"tipo_centro_pub"</span>, <span class="st">"origen_ingreso_mod"</span>, <span class="st">"compromiso_biopsicosocial"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#has 75 missing</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">paste0</span>(<span class="st">"tipo_de_plan_2_"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="sc">~</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">grepl</span>(<span class="st">"PR"</span>,.)<span class="sc">~</span><span class="st">"residential"</span>,<span class="fu">grepl</span>(<span class="st">"PAB"</span>,.)<span class="sc">~</span><span class="st">"basic ambulatory"</span>,<span class="fu">grepl</span>(<span class="st">"PAI"</span>,.)<span class="sc">~</span><span class="st">"intensive ambulatory"</span>, T<span class="sc">~</span><span class="cn">NA_character_</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot longer</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2024-01-27: por lo que entiendo, estas variables se excluyen de la transformación longitudinal. ES NECESARIO LONGITUDINALIZARLAS</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(hash_key, edad_al_ing_1, sex, edad_ini_cons, escolaridad_rec, sus_principal_mod, freq_cons_sus_prin_ord, condicion_ocupacional_corr24, policonsumo, num_hijos_mod_joel_bin, tenencia_de_la_vivienda_mod, macrozona, dg_cie_10_rec, dg_trs_cons_sus_or, clas_r, porc_pobr, sus_ini_mod_mvv, ano_nac_corr, con_quien_vive_joel, tipo_de_plan_2_mod,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>             <span class="co">#2024-01-28: se agregan 3 variables</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>                 tipo_centro_pub, origen_ingreso_mod, compromiso_biopsicosocial </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>              ),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"treatment"</span>),</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">"(.+)_(</span><span class="sc">\\</span><span class="st">d+)$"</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">treatment=</span><span class="fu">as.numeric</span>(treatment)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(fech_ing_num)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># create event variables</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(hash_key, treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">enter_time=</span><span class="fu">min</span>(fech_ing_num, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>fech_egres_num<span class="sc">-</span>enter_time) <span class="sc">%&gt;%</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cens_time=</span> <span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>))<span class="sc">-</span>enter_time) <span class="sc">%&gt;%</span> </span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define event: dropout</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">event=</span><span class="fu">ifelse</span>(motivodeegreso_mod_imp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Abandono Tardio"</span>, <span class="st">"Abandono Temprano"</span>, <span class="st">"Alta Administrativa"</span>),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#censorship time if event not present</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span> cens_time, <span class="cn">TRUE</span><span class="sc">~</span> time)) <span class="sc">%&gt;%</span>   <span class="co">#to months</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>time<span class="sc">/</span><span class="fl">30.5</span>, <span class="at">cens_time=</span> cens_time<span class="sc">/</span><span class="fl">30.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#id variable</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_first_occurrence =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">cumsum</span>(is_first_occurrence)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>is_first_occurrence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>pivot_longer: reorganized (motivodeegreso_mod_imp_1, motivodeegreso_mod_imp_2, motivodeegreso_mod_imp_3, motivodeegreso_mod_imp_4, motivodeegreso_mod_imp_5, …) into (treatment, motivodeegreso_mod_imp, dias_treat_imp_sin_na, fech_ing_num, fech_egres_num, …) [was 85048x77, now 1190672x29]</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  length(unique(Base_fiscalia_v15f_grant_23_24_long2$hash_key))</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 72404</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Added the time-varyinng polyuse</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2<span class="ot">&lt;-</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long <span class="sc">%&gt;%</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(CONS_C1_df_dup_SEP_2020_mod[,<span class="fu">c</span>(<span class="st">"hash_key"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#2024-01-28: agregué biopsychosocial_comp</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="st">"rn_hash"</span>,<span class="st">"policonsumo2"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="fu">c</span>(<span class="st">"hash_key"</span><span class="ot">=</span><span class="st">"hash_key"</span>,<span class="st">"treatment"</span><span class="ot">=</span><span class="st">"rn_hash"</span>))) <span class="sc">%&gt;%</span> <span class="co"># nrow() 109756</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(CONS_C1_df_dup_SEP_2020[,<span class="fu">c</span>(<span class="st">"hash_key"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#2024-01-28: agregué biopsychosocial_comp</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">"rn_hash"</span>,<span class="st">"compromiso_biopsicosocial"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="fu">c</span>(<span class="st">"hash_key"</span><span class="ot">=</span><span class="st">"hash_key"</span>,<span class="st">"treatment"</span><span class="ot">=</span><span class="st">"rn_hash"</span>))) <span class="sc">%&gt;%</span> <span class="co"># nrow() 109756</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"compromiso_biopsicosocial"</span><span class="ot">=</span><span class="st">"compromiso_biopsicosocial.x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#2024-01-29: filtered treatments without finish</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>motivodeegreso_mod_imp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"En curso"</span>, <span class="st">"Muerte"</span>, <span class="st">"Derivación"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::select(hash_key,fech_ing_num, fech_egres_num, time, enter_time, cens_time)</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2024-01-29: create event variables, again</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(hash_key, treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">treatment=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">max_treatment=</span> <span class="fu">max</span>( treatment,<span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">enter_time=</span><span class="fu">min</span>(fech_ing_num, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cens_time=</span> <span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>))<span class="sc">-</span>enter_time) <span class="sc">%&gt;%</span> </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2024-03-04: move out of the nested de discharge date</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span> fech_egres_num<span class="sc">-</span>enter_time) <span class="sc">%&gt;%</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>time<span class="sc">/</span><span class="fl">30.5</span>, <span class="at">cens_time=</span> cens_time<span class="sc">/</span><span class="fl">30.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span> <span class="fu">lag</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">6</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">7</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">8</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>                                 lag_time<span class="sc">==</span>time <span class="sc">&amp;</span> treatment<span class="sc">==</span><span class="dv">9</span><span class="sc">~</span>time<span class="fl">+.001</span>,</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span><span class="sc">~</span>time)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2024-01-29: censorship time if event not present</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2024-03-04: surv_time in other variable</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">surv_time=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span> cens_time, <span class="cn">TRUE</span><span class="sc">~</span> time))<span class="co">#to months</span></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#  </span><span class="al">TEST</span><span class="co"> OVERLAPPINGS IN TIMES OF COUNTING PROCESS #_#_#_#_#_#_#_</span></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>error_in_time_pre_followup<span class="ot">&lt;-</span></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2 <span class="sc">%&gt;%</span> </span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(time <span class="sc">&lt;=</span>lag_time <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(lag_time)<span class="sc">~</span>T,T<span class="sc">~</span>F)) </span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3,031 x 36</span></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2 <span class="sc">%&gt;%</span> </span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key <span class="sc">%in%</span> <span class="fu">unique</span>(error_in_time_pre_followup<span class="sc">$</span>hash_key)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, time, lag_time, motivodeegreso_mod_imp, dias_treat_imp_sin_na, enter_time, fech_ing_num, fech_egres_num, cens_time, treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 x 10
# ... with 10 variables: hash_key &lt;chr&gt;, time &lt;dbl&gt;, lag_time &lt;dbl&gt;,
#   motivodeegreso_mod_imp &lt;chr&gt;, dias_treat_imp_sin_na &lt;dbl&gt;,
#   enter_time &lt;dbl&gt;, fech_ing_num &lt;dbl&gt;, fech_egres_num &lt;dbl&gt;,
#   cens_time &lt;dbl&gt;, treatment &lt;int&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 7,706 x 8</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0039f0d864e402fc7c9b8d326b6a</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 354 808 1296</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tbone_desc_merge_total_grant_23_24_post<span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span><span class="fu">c</span>(<span class="fu">setdiff</span>(vars_cov, <span class="st">"policonsumo"</span>), <span class="st">"offense_after_adm"</span>), <span class="at">data=</span>  Base_fiscalia_v15f_grant_23_24[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin_ord"</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">"condicion_ocupacional_corr24"</span>, <span class="st">"policonsumo"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"compromiso_biopsicosocial"</span>, <span class="st">"origen_ingreso_mod"</span>,<span class="st">"tipo_centro_pub"</span>)] <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key <span class="sc">%in%</span> <span class="fu">unlist</span>(<span class="fu">unique</span>(Base_fiscalia_v15f_grant_23_24_long2<span class="sc">$</span>hash_key))), <span class="at">factorVars =</span> <span class="fu">setdiff</span>(vars_cov, <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"edad_al_ing_1"</span>, <span class="st">"edad_ini_cons"</span>,<span class="st">"ano_nac_corr"</span>, <span class="st">"porc_pobr"</span>)), <span class="at">smd=</span>T, <span class="at">strata=</span><span class="st">"policonsumo"</span>, <span class="at">addOverall =</span> T, <span class="at">includeNA=</span>T, <span class="at">test=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in ModuleReturnVarsExist(vars, data): The data frame does not have: tipo_de_plan_2 tipo_de_plan_2_mod offense_after_adm Dropped</p>
</div>
<div class="alert alert-warning">
<p>Warning in ModuleReturnVarsExist(factorVars, data): The data frame does not have: tipo_de_plan_2 tipo_de_plan_2_mod Dropped</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge_total_grant_23_24_post, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,<span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_replace_all</span>(., <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">( "</span>, <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_trim</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance(1) and no Polysubstance use (0) [exclude ongoing treatments and external referrals]"</span>, <span class="at">escape=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 56 values (71%) of ‘characteristic’ (56 fewer NA)</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary descriptives, Polysubstance(1) and no Polysubstance use (0) [exclude ongoing treatments and external referrals]</caption>
<colgroup>
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">characteristic</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>n</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>72404</strong></td>
<td style="text-align: left;"><strong>18707</strong></td>
<td style="text-align: left;"><strong>53697</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment completion</td>
<td style="text-align: left;">19278 (26.6)</td>
<td style="text-align: left;">6404 (34.2)</td>
<td style="text-align: left;">12874 (24.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.228</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: left;">53117 (73.4)</td>
<td style="text-align: left;">12303 (65.8)</td>
<td style="text-align: left;">40814 (76.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">9 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;">9 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age (admission to treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.04 [27.38, 42.84]</td>
<td style="text-align: left;">41.40 [32.14, 50.94]</td>
<td style="text-align: left;">32.27 [26.47, 39.76]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.736</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Men</td>
<td style="text-align: left;">55062 (76.0)</td>
<td style="text-align: left;">13914 (74.4)</td>
<td style="text-align: left;">41148 (76.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.052</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Women</td>
<td style="text-align: left;">17342 (24.0)</td>
<td style="text-align: left;">4793 (25.6)</td>
<td style="text-align: left;">12549 (23.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Age of Onset of Substance Use (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">15.00 [14.00, 18.00]</td>
<td style="text-align: left;">17.00 [14.00, 20.00]</td>
<td style="text-align: left;">15.00 [13.00, 17.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.419</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">1-More than high school</td>
<td style="text-align: left;">11489 (15.9)</td>
<td style="text-align: left;">2495 (13.3)</td>
<td style="text-align: left;">8994 (16.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.236</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">2-Completed high school or less</td>
<td style="text-align: left;">39904 (55.1)</td>
<td style="text-align: left;">9289 (49.7)</td>
<td style="text-align: left;">30615 (57.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">3-Completed primary school or less</td>
<td style="text-align: left;">20685 (28.6)</td>
<td style="text-align: left;">6797 (36.3)</td>
<td style="text-align: left;">13888 (25.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">326 (0.5)</td>
<td style="text-align: left;">126 (0.7)</td>
<td style="text-align: left;">200 (0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">24244 (33.5)</td>
<td style="text-align: left;">11695 (62.5)</td>
<td style="text-align: left;">12549 (23.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.877</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">13505 (18.7)</td>
<td style="text-align: left;">1906 (10.2)</td>
<td style="text-align: left;">11599 (21.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">28563 (39.4)</td>
<td style="text-align: left;">3922 (21.0)</td>
<td style="text-align: left;">24641 (45.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">4835 (6.7)</td>
<td style="text-align: left;">784 (4.2)</td>
<td style="text-align: left;">4051 (7.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1256 (1.7)</td>
<td style="text-align: left;">399 (2.1)</td>
<td style="text-align: left;">857 (1.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">1. Less than 1 day a week</td>
<td style="text-align: left;">3554 (4.9)</td>
<td style="text-align: left;">1276 (6.8)</td>
<td style="text-align: left;">2278 (4.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.189</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">2. 1 day a week or more</td>
<td style="text-align: left;">4852 (6.7)</td>
<td style="text-align: left;">1621 (8.7)</td>
<td style="text-align: left;">3231 (6.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">3. 2 to 3 days a week</td>
<td style="text-align: left;">20417 (28.2)</td>
<td style="text-align: left;">5578 (29.8)</td>
<td style="text-align: left;">14839 (27.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">4. 4 to 6 days a week</td>
<td style="text-align: left;">11855 (16.4)</td>
<td style="text-align: left;">2969 (15.9)</td>
<td style="text-align: left;">8886 (16.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">5. Daily</td>
<td style="text-align: left;">31363 (43.3)</td>
<td style="text-align: left;">7145 (38.2)</td>
<td style="text-align: left;">24218 (45.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">363 (0.5)</td>
<td style="text-align: left;">118 (0.6)</td>
<td style="text-align: left;">245 (0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">Employed</td>
<td style="text-align: left;">35924 (49.6)</td>
<td style="text-align: left;">10709 (57.2)</td>
<td style="text-align: left;">25215 (47.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.275</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">Inactive</td>
<td style="text-align: left;">11760 (16.2)</td>
<td style="text-align: left;">3350 (17.9)</td>
<td style="text-align: left;">8410 (15.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">Unemployed</td>
<td style="text-align: left;">24719 (34.1)</td>
<td style="text-align: left;">4647 (24.8)</td>
<td style="text-align: left;">20072 (37.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">16802 (23.2)</td>
<td style="text-align: left;">3356 (17.9)</td>
<td style="text-align: left;">13446 (25.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.174</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">54984 (75.9)</td>
<td style="text-align: left;">15188 (81.2)</td>
<td style="text-align: left;">39796 (74.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">618 (0.9)</td>
<td style="text-align: left;">163 (0.9)</td>
<td style="text-align: left;">455 (0.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Illegal Settlement</td>
<td style="text-align: left;">763 (1.1)</td>
<td style="text-align: left;">167 (0.9)</td>
<td style="text-align: left;">596 (1.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.269</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">2041 (2.8)</td>
<td style="text-align: left;">522 (2.8)</td>
<td style="text-align: left;">1519 (2.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Owner/Transferred dwellings/Pays Dividends</td>
<td style="text-align: left;">25339 (35.0)</td>
<td style="text-align: left;">8171 (43.7)</td>
<td style="text-align: left;">17168 (32.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Renting</td>
<td style="text-align: left;">12354 (17.1)</td>
<td style="text-align: left;">3145 (16.8)</td>
<td style="text-align: left;">9209 (17.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">Stays temporarily with a relative</td>
<td style="text-align: left;">27759 (38.3)</td>
<td style="text-align: left;">5637 (30.1)</td>
<td style="text-align: left;">22122 (41.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tenencia_de_la_vivienda_mod (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">4148 (5.7)</td>
<td style="text-align: left;">1065 (5.7)</td>
<td style="text-align: left;">3083 (5.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">Center</td>
<td style="text-align: left;">54864 (75.8)</td>
<td style="text-align: left;">13988 (74.8)</td>
<td style="text-align: left;">40876 (76.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.292</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">North</td>
<td style="text-align: left;">10690 (14.8)</td>
<td style="text-align: left;">1882 (10.1)</td>
<td style="text-align: left;">8808 (16.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">6833 (9.4)</td>
<td style="text-align: left;">2835 (15.2)</td>
<td style="text-align: left;">3998 (7.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">17 (0.0)</td>
<td style="text-align: left;">2 (0.0)</td>
<td style="text-align: left;">15 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without psychiatric comorbidity</td>
<td style="text-align: left;">28308 (39.1)</td>
<td style="text-align: left;">8542 (45.7)</td>
<td style="text-align: left;">19766 (36.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.187</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">13616 (18.8)</td>
<td style="text-align: left;">2918 (15.6)</td>
<td style="text-align: left;">10698 (19.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">With psychiatric comorbidity</td>
<td style="text-align: left;">30480 (42.1)</td>
<td style="text-align: left;">7247 (38.7)</td>
<td style="text-align: left;">23233 (43.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Drug dependence</td>
<td style="text-align: left;">52416 (72.4)</td>
<td style="text-align: left;">11498 (61.5)</td>
<td style="text-align: left;">40918 (76.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.322</td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Hazardous consumption</td>
<td style="text-align: left;">19987 (27.6)</td>
<td style="text-align: left;">7208 (38.5)</td>
<td style="text-align: left;">12779 (23.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">Mixed</td>
<td style="text-align: left;">6938 (9.6)</td>
<td style="text-align: left;">2359 (12.6)</td>
<td style="text-align: left;">4579 (8.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.267</td>
</tr>
<tr class="odd">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">5861 (8.1)</td>
<td style="text-align: left;">2382 (12.7)</td>
<td style="text-align: left;">3479 (6.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">59603 (82.3)</td>
<td style="text-align: left;">13965 (74.7)</td>
<td style="text-align: left;">45638 (85.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">clas_r (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">2 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Percentage of people in poverty (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.12 [0.07, 0.17]</td>
<td style="text-align: left;">0.11 [0.07, 0.16]</td>
<td style="text-align: left;">0.12 [0.08, 0.17]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.105</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">39227 (54.2)</td>
<td style="text-align: left;">12844 (68.7)</td>
<td style="text-align: left;">26383 (49.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.506</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">2681 (3.7)</td>
<td style="text-align: left;">769 (4.1)</td>
<td style="text-align: left;">1912 (3.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">3401 (4.7)</td>
<td style="text-align: left;">1149 (6.1)</td>
<td style="text-align: left;">2252 (4.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">19644 (27.1)</td>
<td style="text-align: left;">2589 (13.8)</td>
<td style="text-align: left;">17055 (31.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1648 (2.3)</td>
<td style="text-align: left;">457 (2.4)</td>
<td style="text-align: left;">1191 (2.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">5803 (8.0)</td>
<td style="text-align: left;">899 (4.8)</td>
<td style="text-align: left;">4904 (9.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected birth year (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1980.00 [1971.00, 1987.00]</td>
<td style="text-align: left;">1973.00 [1964.00, 1983.00]</td>
<td style="text-align: left;">1981.00 [1974.00, 1988.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.623</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Alone</td>
<td style="text-align: left;">6816 (9.4)</td>
<td style="text-align: left;">2276 (12.2)</td>
<td style="text-align: left;">4540 (8.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.337</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Family of origin</td>
<td style="text-align: left;">30074 (41.5)</td>
<td style="text-align: left;">5648 (30.2)</td>
<td style="text-align: left;">24426 (45.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">6224 (8.6)</td>
<td style="text-align: left;">1520 (8.1)</td>
<td style="text-align: left;">4704 (8.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">With couple/children</td>
<td style="text-align: left;">29289 (40.5)</td>
<td style="text-align: left;">9262 (49.5)</td>
<td style="text-align: left;">20027 (37.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">1 (0.0)</td>
<td style="text-align: left;">0 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without physical comorbidity</td>
<td style="text-align: left;">28661 (39.6)</td>
<td style="text-align: left;">6946 (37.1)</td>
<td style="text-align: left;">21715 (40.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.085</td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">39215 (54.2)</td>
<td style="text-align: left;">10372 (55.4)</td>
<td style="text-align: left;">28843 (53.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">One or more</td>
<td style="text-align: left;">4528 (6.3)</td>
<td style="text-align: left;">1389 (7.4)</td>
<td style="text-align: left;">3139 (5.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">1-Mild</td>
<td style="text-align: left;">6954 (9.6)</td>
<td style="text-align: left;">3231 (17.3)</td>
<td style="text-align: left;">3723 (6.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.418</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">2-Moderate</td>
<td style="text-align: left;">41015 (56.6)</td>
<td style="text-align: left;">11147 (59.6)</td>
<td style="text-align: left;">29868 (55.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">3-Severe</td>
<td style="text-align: left;">22998 (31.8)</td>
<td style="text-align: left;">3909 (20.9)</td>
<td style="text-align: left;">19089 (35.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Biopsychosocial compromise (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1437 (2.0)</td>
<td style="text-align: left;">420 (2.2)</td>
<td style="text-align: left;">1017 (1.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Spontaneous</td>
<td style="text-align: left;">32847 (45.4)</td>
<td style="text-align: left;">8462 (45.2)</td>
<td style="text-align: left;">24385 (45.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.191</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Assisted Referral</td>
<td style="text-align: left;">6753 (9.3)</td>
<td style="text-align: left;">1222 (6.5)</td>
<td style="text-align: left;">5531 (10.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">3935 (5.4)</td>
<td style="text-align: left;">984 (5.3)</td>
<td style="text-align: left;">2951 (5.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Justice Sector</td>
<td style="text-align: left;">6813 (9.4)</td>
<td style="text-align: left;">2380 (12.7)</td>
<td style="text-align: left;">4433 (8.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment Admission Motive (%)</td>
<td style="text-align: left;">Health Sector</td>
<td style="text-align: left;">22056 (30.5)</td>
<td style="text-align: left;">5659 (30.3)</td>
<td style="text-align: left;">16397 (30.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tipo_centro_pub (%)</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">20677 (28.6)</td>
<td style="text-align: left;">2806 (15.0)</td>
<td style="text-align: left;">17871 (33.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.438</td>
</tr>
<tr class="even">
<td style="text-align: left;">tipo_centro_pub (%)</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: left;">51710 (71.4)</td>
<td style="text-align: left;">15899 (85.0)</td>
<td style="text-align: left;">35811 (66.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tipo_centro_pub (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">17 (0.0)</td>
<td style="text-align: left;">2 (0.0)</td>
<td style="text-align: left;">15 (0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(size=10, format="html",caption= "Summary descriptives, by Baseline Treatment Status") %&gt;%     kableExtra::kable_classic()</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge_total_grant_23_24_post, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,<span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_replace_all</span>(., <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">( "</span>, <span class="at">replacement =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">str_trim</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.table</span>(<span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/baseline_psu_desc_smd_post.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 56 values (71%) of ‘characteristic’ (56 fewer NA)</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2022 (github)\_proposal_grant/2023</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21251</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>IrregLong<span class="sc">::</span><span class="fu">abacus.plot</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">25</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    Base_fiscalia_v15f_grant_23_24_long2<span class="sc">%&gt;%</span> <span class="co">#dplyr::filter(event==1)%&gt;% </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">is_first_occurrence =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">cumsum</span>(is_first_occurrence)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>is_first_occurrence) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">120</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab.abacus =</span> <span class="st">"Time (in months of follow-up)"</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab.abacus =</span> <span class="st">"Subject"</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch.abacus =</span> <span class="dv">16</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.abacus =</span> <span class="dv">1</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/abacus-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#abacus_plot_irrelong</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span> <span class="st">"_proposal_grant/2023/_figs/abacus.jpg"</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">width=</span><span class="dv">8</span>, <span class="at">height=</span><span class="dv">5</span>, <span class="at">res=</span><span class="dv">500</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21251</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>IrregLong<span class="sc">::</span><span class="fu">abacus.plot</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">25</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    Base_fiscalia_v15f_grant_23_24_long2<span class="sc">%&gt;%</span> <span class="co">#dplyr::filter(event==1)%&gt;% </span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">is_first_occurrence =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">cumsum</span>(is_first_occurrence)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>is_first_occurrence) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">120</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab.abacus =</span> <span class="st">"Time (in months of follow-up)"</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab.abacus =</span> <span class="st">"Subject"</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch.abacus =</span> <span class="dv">16</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.abacus =</span> <span class="dv">1</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">==</span><span class="dv">1</span>)<span class="sc">$</span>max_treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   1.000   1.244   1.000  10.000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prop. q tienen sólo uno</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Only one treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Only one treatment</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">table</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">==</span><span class="dv">1</span>)<span class="sc">$</span>max_treatment)[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">nrow</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">==</span><span class="dv">1</span>)), <span class="at">accuracy=</span>.<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      1 
"81.6%" </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scales::percent(59087  /72404, accuracy=.1 )</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Patients with 4 or more treatments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Patients with 4 or more treatments</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">percent</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">table</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">==</span><span class="dv">1</span>)<span class="sc">$</span>max_treatment)[<span class="dv">4</span><span class="sc">:</span><span class="dv">100</span>], <span class="at">na.rm=</span>T)<span class="sc">/</span><span class="fu">nrow</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1%"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "1%"</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin_ord"</span>, </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="st">"condicion_ocupacional_corr24"</span>, <span class="st">"policonsumo"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"compromiso_biopsicosocial"</span>, <span class="st">"origen_ingreso_mod"</span>,<span class="st">"tipo_centro_pub"</span>,<span class="st">"duplicates_filtered"</span>)] <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key <span class="sc">%in%</span> <span class="fu">unlist</span>(<span class="fu">unique</span>(Base_fiscalia_v15f_grant_23_24_long2<span class="sc">$</span>hash_key))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">duplicates_filtered=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">as.numeric</span>(duplicates_filtered)<span class="sc">&gt;</span><span class="dv">3</span><span class="sc">~</span><span class="dv">4</span>,<span class="cn">TRUE</span><span class="sc">~</span><span class="fu">as.numeric</span>(duplicates_filtered))) <span class="sc">%&gt;%</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(policonsumo,duplicates_filtered)<span class="sc">%&gt;%</span> </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in chisq.test(.): Chi-squared approximation may be incorrect</p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  .
X-squared = 692.64, df = 4, p-value &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#X-squared = 693, df = 4, p-value &lt;2e-16</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col1 =</span> <span class="fu">c</span>(<span class="dv">15527</span>, <span class="dv">39686</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col2 =</span> <span class="fu">c</span>(<span class="dv">2475</span>, <span class="dv">9902</span>),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col3 =</span> <span class="fu">c</span>(<span class="dv">530</span>, <span class="dv">2841</span>),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col4 =</span> <span class="fu">c</span>(<span class="dv">175</span>, <span class="dv">1268</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">%&gt;%</span>  </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> . <span class="sc">/</span> <span class="fu">sum</span>(.)) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), round, <span class="at">digits =</span> <span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   col1 col2  col3  col4
1 28.12   20 15.72 12.13
2 71.88   80 84.28 87.87</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#    col1 col2  col3  col4</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 28.12   20 15.72 12.13</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 71.88   80 84.28 87.87</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Patients with more treatments have more baseline PSU"</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">motivodeegreso_mod_imp_rec =</span> <span class="fu">c</span>(<span class="st">"Treatment completion"</span>, </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">"Treatment non-completion"</span>), </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">15782</span>, <span class="dv">39428</span>), <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2622</span>, <span class="dv">9750</span>), </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">654</span>, <span class="dv">2717</span>), <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">220</span>, <span class="dv">1222</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span> . <span class="sc">/</span> <span class="fu">sum</span>(.) <span class="sc">*</span> <span class="dv">100</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>mutate_if: changed 2 values (100%) of ‘1’ (0 new NA)</p>
</div>
<div class="message">
<pre><code>       changed 2 values (100%) of '2' (0 new NA)</code></pre>
</div>
<div class="message">
<pre><code>       changed 2 values (100%) of '3' (0 new NA)</code></pre>
</div>
<div class="message">
<pre><code>       changed 2 values (100%) of '4' (0 new NA)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  motivodeegreso_mod_imp_rec       1        2        3        4
1       Treatment completion 28.5854 21.19302 19.40077 15.25659
2   Treatment non-completion 71.4146 78.80698 80.59923 84.74341</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   motivodeegreso_mod_imp_rec     1     2    3     4</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1       Treatment completion 28.59 21.19 19.4 15.26</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2   Treatment non-completion 71.41 78.81 80.6 84.74  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As seen in the previous plot, a few observations had more than one treatment.</p>
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Patients with more than one value of PSU (changes in patterns): "</span>,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2<span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n_dis_psu=</span><span class="fu">n_distinct</span>(policonsumo2), <span class="at">n_dis_event=</span><span class="fu">n_distinct</span>(event), <span class="at">n_dis_event=</span><span class="fu">n_distinct</span>(dias_treat_imp_sin_na), <span class="at">max_tr=</span><span class="fu">max</span>(treatment)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n_dis_psu<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Patients with more than one value of PSU (changes in patterns): 3235"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "Patients with more than one value of PSU (changes in patterns): 3235"</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Patients with more than one value of event: "</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2<span class="sc">%&gt;%</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n_dis_psu=</span><span class="fu">n_distinct</span>(policonsumo2), <span class="at">n_dis_event=</span><span class="fu">n_distinct</span>(event), <span class="at">n_dis_dias_tr=</span><span class="fu">n_distinct</span>(dias_treat_imp_sin_na), <span class="at">max_tr=</span><span class="fu">max</span>(treatment)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n_dis_event<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Patients with more than one value of event: 4623"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "Patients with more than one value of event: 4623"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Patients with more than one value of days in treatment: "</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2<span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n_dis_psu=</span><span class="fu">n_distinct</span>(policonsumo2), <span class="at">n_dis_event=</span><span class="fu">n_distinct</span>(event), <span class="at">n_dis_dias_tr=</span><span class="fu">n_distinct</span>(dias_treat_imp_sin_na), <span class="at">max_tr=</span><span class="fu">max</span>(treatment)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n_dis_dias_tr<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Patients with more than one value of days in treatment: 13289"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "Patients with more than one value of days in treatment: 13289"</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Patients with more than one value in biopsychosocial compromise: "</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2<span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n_dis_psu=</span><span class="fu">n_distinct</span>(policonsumo2), <span class="at">n_dis_event=</span><span class="fu">n_distinct</span>(event), <span class="at">n_dis_dias_tr=</span><span class="fu">n_distinct</span>(dias_treat_imp_sin_na), <span class="at">n_dis_biopsicomp=</span> <span class="fu">n_distinct</span>(compromiso_biopsicosocial.y), <span class="at">max_tr=</span><span class="fu">max</span>(treatment)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n_dis_biopsicomp<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Patients with more than one value in biopsychosocial compromise: 6691"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "Patients with more than one value in biopsychosocial compromise: 6691"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easyalluvial)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parcats)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co">#tipo_de_plan2</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">#treatment, dias_treat_imp_sin_na, policonsumo2, event</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># basic ambulatory intensive ambulatory          residential </span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">==</span><span class="dv">1</span>)<span class="sc">$</span>max_treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     3     4     5     6     7     8    10 
59087 10121  2363   601   163    52    12     4     1 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"================================"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>================================</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"First 4 treatments, stratified by treatment plan, to see if polysubstance use changes by treatment"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># subset(Base_fiscalia_v15f_grant_23_24_long2, hash_key%in% (dplyr::filter(Base_fiscalia_v15f_grant_23_24_long2, tipo_de_plan_2=="residential" &amp; treatment==1) %&gt;% dplyr::pull("hash_key") %&gt;% unique()) &amp; treatment&lt;5,c("id","treatment","motivodeegreso_mod_imp","policonsumo2"))</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>p_alluvial<span class="ot">&lt;-</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">alluvial_long</span>(<span class="fu">data.frame</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">&lt;</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">policonsumo2=</span><span class="fu">if_else</span>(policonsumo2<span class="sc">==</span><span class="dv">1</span>,<span class="st">"PSU"</span>,<span class="st">"no PSU"</span>,<span class="cn">NA_character_</span>))), </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">key=</span> treatment,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">id=</span> id, </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">value=</span> policonsumo2, </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill_by=</span><span class="st">"first_variable"</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">NA_label =</span> <span class="st">"censored"</span>, </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">complete=</span>F,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">bin=</span><span class="dv">3</span>, </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">stratum_label_size=</span><span class="dv">2</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">stratum_width=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">bin_labels =</span> <span class="fu">c</span>(<span class="st">"no PSU"</span>, <span class="st">"PSU"</span>),</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">col_vector_flow=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"gray60"</span>),</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">col_vector_value=</span><span class="fu">c</span>(<span class="st">"#bf6f6f"</span>,<span class="st">"#eec1ad"</span>,<span class="st">"gray60"</span>) )<span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co">#1: In .f(.x[[i]], ...) : bins  (0.4544,0.4549] of policonsumo2 are empty</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>p_alluvial<span class="sc">$</span>data<span class="sc">$</span>x_numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(p_alluvial<span class="sc">$</span>data<span class="sc">$</span>x))  <span class="co"># Convert factor to numeric correctly</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: package ‘ggalluvial’ was built under R version 4.1.3</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>( <span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">match</span>(<span class="st">"compute"</span>,<span class="fu">ls</span>())) ){</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    p_alluvial<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dplyr::group_by(x)%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dplyr::mutate(Percentage = round(n / sum(n[value==]) * 100,1)) %&gt;% </span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dplyr::mutate(print=glue::glue("{format(n, big.mark=',')}; {Percentage}%"))%&gt;% </span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">axis1 =</span> x_numeric, <span class="at">axis2 =</span> x_numeric <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> n)) <span class="sc">+</span><span class="co">#, label = print</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fill)) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_stratum</span>() <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># Adjust size as needed</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="st">"Alluvial Plot with Custom Flow Labels"</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">"Stage"</span>) <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>df_alluvial<span class="ot">&lt;-</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>p_alluvial<span class="sc">$</span>data_key <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(alluvial_id) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc1=</span>scales<span class="sc">::</span><span class="fu">percent</span>(n<span class="sc">/</span><span class="fu">sum</span>(n), <span class="at">accuracy=</span>.<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span>,<span class="st">`</span><span class="at">2</span><span class="st">`</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc2=</span>scales<span class="sc">::</span><span class="fu">percent</span>(n<span class="sc">/</span><span class="fu">sum</span>(n), <span class="at">accuracy=</span>.<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>plot2<span class="ot">&lt;-</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span>df_alluvial,</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span>, <span class="at">axis2 =</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span>, <span class="at">axis3 =</span> <span class="st">`</span><span class="at">3</span><span class="st">`</span>, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_stratum</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">after_stat</span>(stratum),<span class="st">"; "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">after_stat</span>(prop), .<span class="dv">1</span>))), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_text(stat = "flow", nudge_x = 0.3, </span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#           aes(label = paste0(after_stat(flow)," ",round(after_stat(count)*after_stat(prop), 0)), </span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#               hjust = (after_stat(flow) == "to")), </span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#           size=3) +</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">"PSU"</span>,<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"no PSU"</span> <span class="ot">=</span> <span class="st">"darkred"</span>, <span class="st">"PSU"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>, <span class="st">"censored"</span> <span class="ot">=</span> <span class="st">"gray60"</span>)) <span class="sc">+</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Stage"</span>) <span class="sc">+</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot2, <span class="at">file=</span><span class="st">"_proposal_grant/2023/_figs/alluvial.png"</span>, <span class="at">width=</span><span class="fl">8.5</span>, <span class="at">height=</span><span class="fl">5.5</span>, <span class="at">dpi=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot2, <span class="at">file=</span><span class="st">"_proposal_grant/2023/_figs/alluvial.jpg"</span>, <span class="at">width=</span><span class="fl">8.5</span>, <span class="at">height=</span><span class="fl">5.5</span>, <span class="at">dpi=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">layer_data</span>(plot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
<div class="alert alert-warning">
<p>Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes.</p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"======================================"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>======================================</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Database to summarise trajectories"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.frame(subset(Base_fiscalia_v15f_grant_23_24_long2, hash_key%in% (dplyr::filter(Base_fiscalia_v15f_grant_23_24_long2, tipo_de_plan_2=="basic ambulatory" &amp; treatment==1) %&gt;% dplyr::pull("hash_key") %&gt;% unique()) &amp; treatment&lt;5,c("id","treatment","dias_treat_imp_sin_na","motivodeegreso_mod_imp","policonsumo2")) %&gt;% dplyr::mutate(policonsumo2= if_else(policonsumo2==1,"PSU","no PSU",NA_character_))) %&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre<span class="ot">&lt;-</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, hash_key <span class="sc">%in%</span> (dplyr<span class="sc">::</span><span class="fu">filter</span>(Base_fiscalia_v15f_grant_23_24_long2, treatment<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">pull</span>(<span class="st">"hash_key"</span>) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()) <span class="sc">&amp;</span> treatment<span class="sc">&lt;</span><span class="dv">5</span>,<span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"treatment"</span>,<span class="st">"dias_treat_imp_sin_na"</span>,<span class="st">"motivodeegreso_mod_imp"</span>,<span class="st">"policonsumo2"</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">policonsumo2=</span> <span class="fu">if_else</span>(policonsumo2<span class="sc">==</span><span class="dv">1</span>,<span class="st">"PSU"</span>,<span class="st">"no PSU"</span>,<span class="cn">NA_character_</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">motivodeegreso_mod_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(dias_treat_imp_sin_na<span class="sc">&lt;</span><span class="dv">90</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"Admin"</span>,motivodeegreso_mod_imp)<span class="sc">~</span> <span class="st">"Abandono Temprano"</span>, dias_treat_imp_sin_na<span class="sc">&gt;=</span><span class="dv">90</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"Admin"</span>,motivodeegreso_mod_imp)<span class="sc">~</span> <span class="st">"Abandono Tardio"</span>, T<span class="sc">~</span>  motivodeegreso_mod_imp)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>dias_treat_imp_sin_na) <span class="sc">%&gt;%</span> </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>motivodeegreso_mod_imp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>, <span class="st">"Muerte"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(motivodeegreso_mod_imp)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"======================================"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>======================================</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Database to summarise trajectories until 4th treatment"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>df_long_trajectories7<span class="ot">&lt;-</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats))  <span class="sc">%&gt;%</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2=</span> trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory2, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory2"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory2) <span class="sc">%&gt;%</span> </span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>df_long_trajectories6<span class="ot">&lt;-</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">sum</span>(count, <span class="at">na.rm=</span>T),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span> </span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2=</span> trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory2, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory2"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory2) <span class="sc">%&gt;%</span> </span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>df_long_trajectories5<span class="ot">&lt;-</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(treatment <span class="sc">&lt;</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2=</span> trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory2, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory2"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory2) <span class="sc">%&gt;%</span> </span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a>df_long_trajectories4<span class="ot">&lt;-</span></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(treatment <span class="sc">&lt;</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">sum</span>(count, <span class="at">na.rm=</span>T),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span> </span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2=</span> trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory2, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory2"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory2) <span class="sc">%&gt;%</span> </span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span></span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a>df_long_trajectories3<span class="ot">&lt;-</span></span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(treatment <span class="sc">&lt;</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2=</span> trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory2, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory2"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory2) <span class="sc">%&gt;%</span> </span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span></span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a>df_long_trajectories2<span class="ot">&lt;-</span></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(treatment <span class="sc">&lt;</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">sum</span>(count, <span class="at">na.rm=</span>T),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span> </span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2=</span> trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory2, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory2"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory2) <span class="sc">%&gt;%</span> </span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span></span>
<span id="cb69-122"><a href="#cb69-122" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-123"><a href="#cb69-123" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-124"><a href="#cb69-124" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-125"><a href="#cb69-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-126"><a href="#cb69-126" aria-hidden="true" tabindex="-1"></a>df_long_trajectories1<span class="ot">&lt;-</span></span>
<span id="cb69-127"><a href="#cb69-127" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-128"><a href="#cb69-128" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(treatment <span class="sc">&lt;</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-129"><a href="#cb69-129" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-130"><a href="#cb69-130" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-131"><a href="#cb69-131" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-132"><a href="#cb69-132" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-133"><a href="#cb69-133" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-134"><a href="#cb69-134" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-135"><a href="#cb69-135" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2=</span> trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-136"><a href="#cb69-136" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory2, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-137"><a href="#cb69-137" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory2"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-138"><a href="#cb69-138" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory2) <span class="sc">%&gt;%</span> </span>
<span id="cb69-139"><a href="#cb69-139" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span></span>
<span id="cb69-140"><a href="#cb69-140" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-141"><a href="#cb69-141" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-142"><a href="#cb69-142" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-143"><a href="#cb69-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-144"><a href="#cb69-144" aria-hidden="true" tabindex="-1"></a>df_long_trajectories0<span class="ot">&lt;-</span></span>
<span id="cb69-145"><a href="#cb69-145" aria-hidden="true" tabindex="-1"></a>df_long_trajectories_pre <span class="sc">%&gt;%</span> </span>
<span id="cb69-146"><a href="#cb69-146" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(treatment <span class="sc">&lt;</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-147"><a href="#cb69-147" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb69-148"><a href="#cb69-148" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">trajectory =</span> <span class="fu">paste</span>(policonsumo2, motivodeegreso_mod_imp, <span class="at">sep =</span> <span class="st">" -&gt; "</span>, <span class="at">collapse =</span> <span class="st">" -&gt; "</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-149"><a href="#cb69-149" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-150"><a href="#cb69-150" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">n</span>(),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-151"><a href="#cb69-151" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-152"><a href="#cb69-152" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(trajectory, <span class="at">sep=</span><span class="st">" -&gt; "</span>, <span class="at">into=</span><span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats)<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb69-153"><a href="#cb69-153" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="st">"trajectory"</span>,<span class="fu">paste0</span>(<span class="st">"traj"</span>,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(.<span class="sc">$</span>repeats))), <span class="at">sep=</span> <span class="st">" -&gt; "</span>, <span class="at">na.rm=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb69-154"><a href="#cb69-154" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trajectory) <span class="sc">%&gt;%</span> </span>
<span id="cb69-155"><a href="#cb69-155" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count=</span> <span class="fu">sum</span>(count, <span class="at">na.rm=</span>T),<span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-156"><a href="#cb69-156" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))<span class="sc">%&gt;%</span> </span>
<span id="cb69-157"><a href="#cb69-157" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">repeats =</span> <span class="fu">str_count</span>(trajectory, <span class="at">pattern =</span> <span class="st">"-&gt;"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-158"><a href="#cb69-158" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(repeats<span class="sc">==</span><span class="fu">max</span>(repeats)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-159"><a href="#cb69-159" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb69-160"><a href="#cb69-160" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-161"><a href="#cb69-161" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">print=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{format(count, big.mark=',')}; {Percentage}%"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-162"><a href="#cb69-162" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() </span>
<span id="cb69-163"><a href="#cb69-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-164"><a href="#cb69-164" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb69-165"><a href="#cb69-165" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb69-166"><a href="#cb69-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-167"><a href="#cb69-167" aria-hidden="true" tabindex="-1"></a>cbind.fill <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb69-168"><a href="#cb69-168" aria-hidden="true" tabindex="-1"></a>    transpoted <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">list</span>(...),t)</span>
<span id="cb69-169"><a href="#cb69-169" aria-hidden="true" tabindex="-1"></a>    transpoted_dataframe <span class="ot">&lt;-</span> <span class="fu">lapply</span>(transpoted, as.data.table, <span class="at">keep.rownames=</span>T)</span>
<span id="cb69-170"><a href="#cb69-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (<span class="fu">data.frame</span>(<span class="fu">t</span>(plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(transpoted_dataframe))))                                               </span>
<span id="cb69-171"><a href="#cb69-171" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb69-172"><a href="#cb69-172" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb69-173"><a href="#cb69-173" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb69-174"><a href="#cb69-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-175"><a href="#cb69-175" aria-hidden="true" tabindex="-1"></a>tree_str<span class="ot">&lt;-</span></span>
<span id="cb69-176"><a href="#cb69-176" aria-hidden="true" tabindex="-1"></a>    plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(<span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">1</span>,df_long_trajectories0),</span>
<span id="cb69-177"><a href="#cb69-177" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">2</span>,df_long_trajectories1),</span>
<span id="cb69-178"><a href="#cb69-178" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">3</span>,df_long_trajectories2),</span>
<span id="cb69-179"><a href="#cb69-179" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">4</span>,df_long_trajectories3),</span>
<span id="cb69-180"><a href="#cb69-180" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">5</span>,df_long_trajectories4),</span>
<span id="cb69-181"><a href="#cb69-181" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">6</span>,df_long_trajectories5),</span>
<span id="cb69-182"><a href="#cb69-182" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">7</span>,df_long_trajectories6),</span>
<span id="cb69-183"><a href="#cb69-183" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">cbind</span>(<span class="at">step=</span><span class="dv">8</span>,df_long_trajectories7)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-184"><a href="#cb69-184" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">trajectory2 =</span> <span class="fu">str_replace_all</span>(trajectory, <span class="fu">c</span>(</span>
<span id="cb69-185"><a href="#cb69-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">"no PSU"</span> <span class="ot">=</span> <span class="st">"0"</span>, <span class="co">#must be first because it is more specific</span></span>
<span id="cb69-186"><a href="#cb69-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PSU"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb69-187"><a href="#cb69-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abandono Temprano"</span> <span class="ot">=</span> <span class="st">"0"</span>,</span>
<span id="cb69-188"><a href="#cb69-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Abandono Tardio"</span> <span class="ot">=</span> <span class="st">"1"</span>,</span>
<span id="cb69-189"><a href="#cb69-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Alta Terapéutica"</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb69-190"><a href="#cb69-190" aria-hidden="true" tabindex="-1"></a>    <span class="st">" -&gt; "</span> <span class="ot">=</span> <span class="st">""</span>,</span>
<span id="cb69-191"><a href="#cb69-191" aria-hidden="true" tabindex="-1"></a>    <span class="st">" "</span> <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb69-192"><a href="#cb69-192" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb69-193"><a href="#cb69-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-194"><a href="#cb69-194" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/tree_str_pab.R"</span>))</span>
<span id="cb69-195"><a href="#cb69-195" aria-hidden="true" tabindex="-1"></a><span class="co">#tree_str_pab</span></span>
<span id="cb69-196"><a href="#cb69-196" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/tree_str_pai.R"</span>))</span>
<span id="cb69-197"><a href="#cb69-197" aria-hidden="true" tabindex="-1"></a><span class="co">#tree_str_pai</span></span>
<span id="cb69-198"><a href="#cb69-198" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/tree_str_pr.R"</span>))</span>
<span id="cb69-199"><a href="#cb69-199" aria-hidden="true" tabindex="-1"></a><span class="co">#tree_str_pr</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.tree)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>traveller <span class="ot">&lt;-</span> Node<span class="sc">$</span><span class="fu">new</span>(<span class="st">"Admission"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>route0 <span class="ot">&lt;-</span> traveller<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st tr., no PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>route1 <span class="ot">&lt;-</span> traveller<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st tr., PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">#step 1</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>route00 <span class="ot">&lt;-</span> route0<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st  tr., no PSU, Early drop:</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"00"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>route01 <span class="ot">&lt;-</span> route0<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st  tr., no PSU, Late drop:</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"01"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>route02 <span class="ot">&lt;-</span> route0<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st  tr., no PSU, Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"02"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>route10 <span class="ot">&lt;-</span> route1<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st  tr., PSU, Early drop:</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"10"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>route11 <span class="ot">&lt;-</span> route1<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st  tr., PSU, Late drop:</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"11"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>route12 <span class="ot">&lt;-</span> route1<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"1st  tr., PSU, Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"12"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a><span class="co">#step 2</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>route000 <span class="ot">&lt;-</span> route00<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., no PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"000"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>route001 <span class="ot">&lt;-</span> route00<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"001"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>route010 <span class="ot">&lt;-</span> route01<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., no PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"010"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>route011 <span class="ot">&lt;-</span> route01<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"011"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>route020 <span class="ot">&lt;-</span> route02<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., no PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"020"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>route021 <span class="ot">&lt;-</span> route02<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"021"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>route100 <span class="ot">&lt;-</span> route10<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., no PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"100"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>route101 <span class="ot">&lt;-</span> route10<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"101"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>route110 <span class="ot">&lt;-</span> route11<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., no PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"110"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>route111 <span class="ot">&lt;-</span> route11<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"111"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>route120 <span class="ot">&lt;-</span> route12<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., no PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"120"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>route121 <span class="ot">&lt;-</span> route12<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"2nd tr., PSU:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"121"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a><span class="co">#step 3</span></span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a>route0000 <span class="ot">&lt;-</span> route000<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0000"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a>route0010 <span class="ot">&lt;-</span> route001<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0010"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a>route0100 <span class="ot">&lt;-</span> route010<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0100"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a>route0110 <span class="ot">&lt;-</span> route011<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0110"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a>route0200 <span class="ot">&lt;-</span> route020<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0200"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a>route0210 <span class="ot">&lt;-</span> route021<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0210"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a>route1000 <span class="ot">&lt;-</span> route100<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1000"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>route1010 <span class="ot">&lt;-</span> route101<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1010"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a>route1100 <span class="ot">&lt;-</span> route110<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1100"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a>route1110 <span class="ot">&lt;-</span> route111<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1110"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a>route1200 <span class="ot">&lt;-</span> route120<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1200"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-78"><a href="#cb70-78" aria-hidden="true" tabindex="-1"></a>route1210 <span class="ot">&lt;-</span> route121<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Early drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1210"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-79"><a href="#cb70-79" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a>route0001 <span class="ot">&lt;-</span> route000<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0001"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-82"><a href="#cb70-82" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-83"><a href="#cb70-83" aria-hidden="true" tabindex="-1"></a>route0011 <span class="ot">&lt;-</span> route001<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0011"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-84"><a href="#cb70-84" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-85"><a href="#cb70-85" aria-hidden="true" tabindex="-1"></a>route0101 <span class="ot">&lt;-</span> route010<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0101"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-86"><a href="#cb70-86" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-87"><a href="#cb70-87" aria-hidden="true" tabindex="-1"></a>route0111 <span class="ot">&lt;-</span> route011<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0111"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-88"><a href="#cb70-88" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-89"><a href="#cb70-89" aria-hidden="true" tabindex="-1"></a>route0201 <span class="ot">&lt;-</span> route020<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0201"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-90"><a href="#cb70-90" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-91"><a href="#cb70-91" aria-hidden="true" tabindex="-1"></a>route0211 <span class="ot">&lt;-</span> route021<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0211"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-92"><a href="#cb70-92" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-93"><a href="#cb70-93" aria-hidden="true" tabindex="-1"></a>route1001 <span class="ot">&lt;-</span> route100<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1001"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-94"><a href="#cb70-94" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-95"><a href="#cb70-95" aria-hidden="true" tabindex="-1"></a>route1011 <span class="ot">&lt;-</span> route101<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1011"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-96"><a href="#cb70-96" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-97"><a href="#cb70-97" aria-hidden="true" tabindex="-1"></a>route1101 <span class="ot">&lt;-</span> route110<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1101"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-98"><a href="#cb70-98" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-99"><a href="#cb70-99" aria-hidden="true" tabindex="-1"></a>route1111 <span class="ot">&lt;-</span> route111<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1111"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-100"><a href="#cb70-100" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-101"><a href="#cb70-101" aria-hidden="true" tabindex="-1"></a>route1201 <span class="ot">&lt;-</span> route120<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1201"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-102"><a href="#cb70-102" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-103"><a href="#cb70-103" aria-hidden="true" tabindex="-1"></a>route1211 <span class="ot">&lt;-</span> route121<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Late drop:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1211"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-104"><a href="#cb70-104" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-105"><a href="#cb70-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-106"><a href="#cb70-106" aria-hidden="true" tabindex="-1"></a>route0002 <span class="ot">&lt;-</span> route000<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0002"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-107"><a href="#cb70-107" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-108"><a href="#cb70-108" aria-hidden="true" tabindex="-1"></a>route0012 <span class="ot">&lt;-</span> route001<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0012"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-109"><a href="#cb70-109" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-110"><a href="#cb70-110" aria-hidden="true" tabindex="-1"></a>route0102 <span class="ot">&lt;-</span> route010<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0102"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-111"><a href="#cb70-111" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-112"><a href="#cb70-112" aria-hidden="true" tabindex="-1"></a>route0112 <span class="ot">&lt;-</span> route011<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0112"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-113"><a href="#cb70-113" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-114"><a href="#cb70-114" aria-hidden="true" tabindex="-1"></a>route0202 <span class="ot">&lt;-</span> route020<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0202"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-115"><a href="#cb70-115" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-116"><a href="#cb70-116" aria-hidden="true" tabindex="-1"></a>route0212 <span class="ot">&lt;-</span> route021<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"0212"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-117"><a href="#cb70-117" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-118"><a href="#cb70-118" aria-hidden="true" tabindex="-1"></a>route1002 <span class="ot">&lt;-</span> route100<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1002"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-119"><a href="#cb70-119" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-120"><a href="#cb70-120" aria-hidden="true" tabindex="-1"></a>route1012 <span class="ot">&lt;-</span> route101<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1012"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-121"><a href="#cb70-121" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-122"><a href="#cb70-122" aria-hidden="true" tabindex="-1"></a>route1102 <span class="ot">&lt;-</span> route110<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1102"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-123"><a href="#cb70-123" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-124"><a href="#cb70-124" aria-hidden="true" tabindex="-1"></a>route1112 <span class="ot">&lt;-</span> route111<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1112"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-125"><a href="#cb70-125" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-126"><a href="#cb70-126" aria-hidden="true" tabindex="-1"></a>route1202 <span class="ot">&lt;-</span> route120<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1202"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-127"><a href="#cb70-127" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-128"><a href="#cb70-128" aria-hidden="true" tabindex="-1"></a>route1212 <span class="ot">&lt;-</span> route121<span class="sc">$</span><span class="fu">AddChild</span>(<span class="fu">paste0</span>(<span class="st">"3rd tr., Tr. comp:</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">as.character</span>(<span class="fu">subset</span>(tree_str, trajectory2<span class="sc">==</span><span class="st">"1212"</span>, <span class="st">"print"</span>))</span>
<span id="cb70-129"><a href="#cb70-129" aria-hidden="true" tabindex="-1"></a>                                    ))</span>
<span id="cb70-130"><a href="#cb70-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-131"><a href="#cb70-131" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb70-132"><a href="#cb70-132" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb70-133"><a href="#cb70-133" aria-hidden="true" tabindex="-1"></a><span class="fu">SetGraphStyle</span>(traveller, <span class="at">rankdir =</span> <span class="st">"LR"</span>)</span>
<span id="cb70-134"><a href="#cb70-134" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(traveller)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-b584baf230adf043b642" style="width:100%;height:464px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-b584baf230adf043b642">{"x":{"diagram":"digraph {\n\ngraph [rankdir = \"LR\"]\n\n\n\n  \"1\" [label = \"Admission\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"2\" [label = \"1st tr., no PSU:\n18,842; 26%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"3\" [label = \"1st  tr., no PSU, Early drop:\n3,458; 18.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"4\" [label = \"2nd tr., no PSU:\n274; 51%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"5\" [label = \"3rd tr., Early drop:\n112; 40.9%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"6\" [label = \"3rd tr., Late drop:\n 97; 35.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"7\" [label = \"3rd tr., Tr. comp:\n 65; 23.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"8\" [label = \"2nd tr., PSU:\n263; 49%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"9\" [label = \"3rd tr., Early drop:\n 95; 36.1%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"10\" [label = \"3rd tr., Late drop:\n122; 46.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"11\" [label = \"3rd tr., Tr. comp:\n 46; 17.5%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"12\" [label = \"1st  tr., no PSU, Late drop:\n8,827; 46.8%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"13\" [label = \"2nd tr., no PSU:\n727; 56.1%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"14\" [label = \"3rd tr., Early drop:\n144; 19.8%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"15\" [label = \"3rd tr., Late drop:\n360; 49.5%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"16\" [label = \"3rd tr., Tr. comp:\n223; 30.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"17\" [label = \"2nd tr., PSU:\n569; 43.9%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"18\" [label = \"3rd tr., Early drop:\n130; 22.8%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"19\" [label = \"3rd tr., Late drop:\n287; 50.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"20\" [label = \"3rd tr., Tr. comp:\n152; 26.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"21\" [label = \"1st  tr., no PSU, Tr. comp:\n6,557; 34.8%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"22\" [label = \"2nd tr., no PSU:\n352; 64.1%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"23\" [label = \"3rd tr., Early drop:\n 56; 15.9%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"24\" [label = \"3rd tr., Late drop:\n108; 30.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"25\" [label = \"3rd tr., Tr. comp:\n188; 53.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"26\" [label = \"2nd tr., PSU:\n197; 35.9%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"27\" [label = \"3rd tr., Early drop:\n30; 15.2%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"28\" [label = \"3rd tr., Late drop:\n83; 42.1%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"29\" [label = \"3rd tr., Tr. comp:\n84; 42.6%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"30\" [label = \"1st tr., PSU:\n53,552; 74%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"31\" [label = \"1st  tr., PSU, Early drop:\n12,679; 23.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"32\" [label = \"2nd tr., no PSU:\n  364; 14%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"33\" [label = \"3rd tr., Early drop:\n114; 31.3%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"34\" [label = \"3rd tr., Late drop:\n169; 46.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"35\" [label = \"3rd tr., Tr. comp:\n 81; 22.3%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"36\" [label = \"2nd tr., PSU:\n2,230; 86%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"37\" [label = \"3rd tr., Early drop:\n  781; 35%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"38\" [label = \"3rd tr., Late drop:\n1,060; 47.5%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"39\" [label = \"3rd tr., Tr. comp:\n  389; 17.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"40\" [label = \"1st  tr., PSU, Late drop:\n27,650; 51.6%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"41\" [label = \"2nd tr., no PSU:\n  912; 15.2%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"42\" [label = \"3rd tr., Early drop:\n219; 24%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"43\" [label = \"3rd tr., Late drop:\n466; 51.1%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"44\" [label = \"3rd tr., Tr. comp:\n227; 24.9%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"45\" [label = \"2nd tr., PSU:\n5,105; 84.8%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"46\" [label = \"3rd tr., Early drop:\n1,259; 24.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"47\" [label = \"3rd tr., Late drop:\n2,739; 53.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"48\" [label = \"3rd tr., Tr. comp:\n1,107; 21.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"49\" [label = \"1st  tr., PSU, Tr. comp:\n13,223; 24.7%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"50\" [label = \"2nd tr., no PSU:\n  427; 18.5%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"51\" [label = \"3rd tr., Early drop:\n 72; 16.9%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"52\" [label = \"3rd tr., Late drop:\n151; 35.4%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"53\" [label = \"3rd tr., Tr. comp:\n204; 47.8%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"54\" [label = \"2nd tr., PSU:\n1,887; 81.5%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"55\" [label = \"3rd tr., Early drop:\n392; 20.8%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"56\" [label = \"3rd tr., Late drop:\n758; 40.2%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"57\" [label = \"3rd tr., Tr. comp:\n737; 39.1%\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"1\"->\"2\" \n  \"1\"->\"30\" \n  \"2\"->\"3\" \n  \"2\"->\"12\" \n  \"2\"->\"21\" \n  \"30\"->\"31\" \n  \"30\"->\"40\" \n  \"30\"->\"49\" \n  \"3\"->\"4\" \n  \"3\"->\"8\" \n  \"12\"->\"13\" \n  \"12\"->\"17\" \n  \"21\"->\"22\" \n  \"21\"->\"26\" \n  \"31\"->\"32\" \n  \"31\"->\"36\" \n  \"40\"->\"41\" \n  \"40\"->\"45\" \n  \"49\"->\"50\" \n  \"49\"->\"54\" \n  \"4\"->\"5\" \n  \"4\"->\"6\" \n  \"4\"->\"7\" \n  \"8\"->\"9\" \n  \"8\"->\"10\" \n  \"8\"->\"11\" \n  \"13\"->\"14\" \n  \"13\"->\"15\" \n  \"13\"->\"16\" \n  \"17\"->\"18\" \n  \"17\"->\"19\" \n  \"17\"->\"20\" \n  \"22\"->\"23\" \n  \"22\"->\"24\" \n  \"22\"->\"25\" \n  \"26\"->\"27\" \n  \"26\"->\"28\" \n  \"26\"->\"29\" \n  \"32\"->\"33\" \n  \"32\"->\"34\" \n  \"32\"->\"35\" \n  \"36\"->\"37\" \n  \"36\"->\"38\" \n  \"36\"->\"39\" \n  \"41\"->\"42\" \n  \"41\"->\"43\" \n  \"41\"->\"44\" \n  \"45\"->\"46\" \n  \"45\"->\"47\" \n  \"45\"->\"48\" \n  \"50\"->\"51\" \n  \"50\"->\"52\" \n  \"50\"->\"53\" \n  \"54\"->\"55\" \n  \"54\"->\"56\" \n  \"54\"->\"57\" \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br></p>
</section>
<section id="missingness" class="level2">
<h2 class="anchored" data-anchor-id="missingness">Missingness</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Percentage of the total that has missing values: "</span>,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">percent</span>(Base_fiscalia_v15f_grant_23_24_long2[<span class="fu">which</span>(<span class="fu">complete.cases</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, <span class="at">select=</span> <span class="fu">c</span>(hash_key, tipo_de_plan_2, tipo_de_plan_2_mod, sex,  edad_al_ing_1, edad_ini_cons, escolaridad_rec, sus_principal_mod, freq_cons_sus_prin_ord, condicion_ocupacional_corr24, policonsumo, policonsumo2, num_hijos_mod_joel_bin, tenencia_de_la_vivienda_mod, macrozona, dg_cie_10_rec, dg_trs_cons_sus_or, clas_r, porc_pobr, sus_ini_mod_mvv, ano_nac_corr, con_quien_vive_joel, tipo_centro_pub, origen_ingreso_mod, compromiso_biopsicosocial,compromiso_biopsicosocial.y)))),] <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()<span class="sc">/</span><span class="fu">nrow</span>(Base_fiscalia_v15f_grant_23_24_long2), <span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>, <span class="st">"; total= "</span>, <span class="fu">format</span>(<span class="fu">nrow</span>(Base_fiscalia_v15f_grant_23_24_long2),<span class="at">big.mark=</span><span class="st">","</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Percentage of the total that has missing values: 84.4%; total= 90,075"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "Percentage of the total that has missing values: 84.4%; total= 90,075"</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 76029</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># length(unique(Base_fiscalia_v15f_grant_23_24_long2$hash_key))</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co">#patients: 72404</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>motivodeegreso_mod_imp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"En curso"</span>, <span class="st">"Muerte"</span>, <span class="st">"Derivación"</span>)) <span class="sc">%&gt;%</span>  <span class="fu">distinct</span>(hash_key) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72404</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] 72404</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>missing_pct <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">is.na</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24_long2, <span class="at">select=</span> <span class="fu">c</span>(hash_key, tipo_de_plan_2, tipo_de_plan_2_mod, sex,  edad_al_ing_1, edad_ini_cons, escolaridad_rec, sus_principal_mod, freq_cons_sus_prin_ord, condicion_ocupacional_corr24, policonsumo, policonsumo2, num_hijos_mod_joel_bin, tenencia_de_la_vivienda_mod, macrozona, dg_cie_10_rec, dg_trs_cons_sus_or, clas_r, porc_pobr, sus_ini_mod_mvv, ano_nac_corr, con_quien_vive_joel, tipo_centro_pub, origen_ingreso_mod, compromiso_biopsicosocial, compromiso_biopsicosocial.y</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>              ) ))) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(missing_pct,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    hash_key               tipo_de_plan_2 
                        0.00                         0.10 
          tipo_de_plan_2_mod                          sex 
                        0.12                         0.00 
               edad_al_ing_1                edad_ini_cons 
                        0.01                         6.84 
             escolaridad_rec            sus_principal_mod 
                        0.43                         0.00 
      freq_cons_sus_prin_ord condicion_ocupacional_corr24 
                        0.50                         0.00 
                 policonsumo                 policonsumo2 
                        0.00                         0.00 
      num_hijos_mod_joel_bin  tenencia_de_la_vivienda_mod 
                        0.81                         5.84 
                   macrozona                dg_cie_10_rec 
                        0.02                         0.00 
          dg_trs_cons_sus_or                       clas_r 
                        0.00                         0.00 
                   porc_pobr              sus_ini_mod_mvv 
                        0.00                         6.64 
                ano_nac_corr          con_quien_vive_joel 
                        0.01                         0.00 
             tipo_centro_pub           origen_ingreso_mod 
                        0.02                         0.00 
   compromiso_biopsicosocial  compromiso_biopsicosocial.y 
                        1.95                         1.94 </code></pre>
</div>
</div>
<div class="controlly">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss <span class="ot">&lt;-</span> Base_fiscalia_v15f_grant_23_24_long2 <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(hash_key, fech_ing_num) <span class="sc">%&gt;%</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>   missRanger<span class="sc">::</span><span class="fu">missRanger</span>(</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span>  sus_principal_mod <span class="sc">+</span> condicion_ocupacional_corr24 <span class="sc">+</span> dg_trs_cons_sus_or <span class="sc">+</span> con_quien_vive_joel <span class="sc">+</span> clas_r <span class="sc">+</span> porc_pobr <span class="sc">+</span> edad_al_ing_1 <span class="sc">+</span> ano_nac_corr <span class="sc">+</span>  macrozona <span class="sc">+</span> tipo_centro_pub <span class="sc">+</span> tipo_de_plan_2 <span class="sc">+</span> tipo_de_plan_2_mod <span class="sc">+</span> escolaridad_rec <span class="sc">+</span> freq_cons_sus_prin_ord <span class="sc">+</span> num_hijos_mod_joel_bin <span class="sc">+</span> compromiso_biopsicosocial.y <span class="sc">+</span> compromiso_biopsicosocial <span class="sc">+</span> tenencia_de_la_vivienda_mod <span class="sc">+</span> sus_ini_mod_mvv <span class="sc">+</span> edad_ini_cons <span class="sc">~</span> edad_al_ing_1 <span class="sc">+</span> sex <span class="sc">+</span> edad_ini_cons <span class="sc">+</span> escolaridad_rec <span class="sc">+</span> sus_principal_mod <span class="sc">+</span> freq_cons_sus_prin_ord <span class="sc">+</span> condicion_ocupacional_corr24 <span class="sc">+</span> policonsumo <span class="sc">+</span> num_hijos_mod_joel_bin <span class="sc">+</span> tenencia_de_la_vivienda_mod <span class="sc">+</span> macrozona <span class="sc">+</span> dg_cie_10_rec <span class="sc">+</span> dg_trs_cons_sus_or <span class="sc">+</span> clas_r <span class="sc">+</span> porc_pobr <span class="sc">+</span> sus_ini_mod_mvv <span class="sc">+</span> ano_nac_corr <span class="sc">+</span> con_quien_vive_joel <span class="sc">+</span> tipo_centro_pub <span class="sc">+</span> origen_ingreso_mod <span class="sc">+</span> compromiso_biopsicosocial <span class="sc">+</span> cens_time <span class="sc">+</span> policonsumo2 <span class="sc">+</span> compromiso_biopsicosocial.y <span class="sc">+</span> tipo_de_plan_2 <span class="sc">+</span> tipo_de_plan_2_mod, </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">num.trees =</span> <span class="dv">300</span>, </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">pmm.k =</span> <span class="dv">5</span>,                </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">returnOOB=</span>T,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">maxiter=</span> <span class="dv">50</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">verbose =</span> <span class="dv">2</span>, </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">2125</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Missing value imputation by random forests

  Variables to impute:      sus_principal_mod, condicion_ocupacional_corr24, dg_trs_cons_sus_or, con_quien_vive_joel, clas_r, porc_pobr, edad_al_ing_1, ano_nac_corr, macrozona, tipo_centro_pub, tipo_de_plan_2, tipo_de_plan_2_mod, escolaridad_rec, freq_cons_sus_prin_ord, num_hijos_mod_joel_bin, compromiso_biopsicosocial.y, compromiso_biopsicosocial, tenencia_de_la_vivienda_mod, sus_ini_mod_mvv, edad_ini_cons
  Variables used to impute: edad_al_ing_1, sex, edad_ini_cons, escolaridad_rec, sus_principal_mod, freq_cons_sus_prin_ord, condicion_ocupacional_corr24, policonsumo, num_hijos_mod_joel_bin, tenencia_de_la_vivienda_mod, macrozona, dg_cie_10_rec, dg_trs_cons_sus_or, clas_r, porc_pobr, sus_ini_mod_mvv, ano_nac_corr, con_quien_vive_joel, tipo_centro_pub, origen_ingreso_mod, compromiso_biopsicosocial, cens_time, policonsumo2, compromiso_biopsicosocial.y, tipo_de_plan_2, tipo_de_plan_2_mod
    ss_pr_  cn__24  dg____  cn_q__  clas_r  prc_pb  ed___1  an_nc_  macrzn  tp_cn_  tp___2  t___2_  esclr_  fr____  nm____  cmpr_.  cmprm_  tn____  ss_n__  edd_n_
iter 1: 0.4744  0.4529  0.2608  0.4665  0.1676  0.5058  0.6236  0.0106  0.1195  0.1534  0.3502  0.0965  0.3121  0.3646  0.6032  0.3099  0.0592  0.3085  0.2574  0.5780  
iter 2: 1e-04   0.0000  0.0000  0.0000  0.0000  0.0084  0.0013  0.0011  0.0000  0.0000  0.0000  0.0000  0.0000  1e-04   0.0012  0.0000  0.0000  4e-04   1e-04   0.0186  
iter 3: 1e-04   0.0000  0.0000  0.0000  0.0000  0.0083  0.0012  0.0012  0.0000  0.0000  0.0000  0.0000  0.0000  1e-04   0.0011  0.0000  0.0000  5e-04   1e-04   0.0188  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-25: ! Can't subset columns that don't exist; Column `vars_cov` doesn't exist. I corrected that by including explicitly the covariates"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>arrow<span class="sc">::</span><span class="fu">write_parquet</span>(Base_fiscalia_v15f_grant_23_24_long2_miss, </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"_proposal_grant/2023/Base_fiscalia_v15f_grant_23_24_long2_miss240425.gz.parquet"</span>, </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">compression =</span> <span class="st">"gzip"</span>, <span class="at">compression_level =</span> <span class="dv">5</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>column_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sus_principal_mod"</span>, <span class="st">"condicion_ocupacional_corr24"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, <span class="st">"con_quien_vive_joel"</span>,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"macrozona"</span>, <span class="st">"tipo_centro_pub"</span>,</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tipo_de_plan_2"</span>, <span class="st">"tipo_de_plan_2_mod"</span>, <span class="st">"escolaridad_rec"</span>, <span class="st">"freq_cons_sus_prin_ord"</span>,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"num_hijos_mod_joel_bin"</span>, <span class="st">"compromiso_biopsicosocial.y"</span>, <span class="st">"compromiso_biopsicosocial"</span>,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"edad_ini_cons"</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>rmses_reduction <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.4744</span>, <span class="fl">0.4529</span>, <span class="fl">0.2608</span>, <span class="fl">0.4665</span>, <span class="fl">0.1676</span>, <span class="fl">0.5058</span>, <span class="fl">0.6236</span>, <span class="fl">0.0106</span>, <span class="fl">0.1195</span>, <span class="fl">0.1534</span>, <span class="fl">0.3502</span>, <span class="fl">0.0965</span>, <span class="fl">0.3121</span>, <span class="fl">0.3646</span>, <span class="fl">0.6032</span>, <span class="fl">0.3099</span>, <span class="fl">0.0592</span>, <span class="fl">0.3085</span>, <span class="fl">0.2574</span>, <span class="fl">0.5780</span>, <span class="fl">1e-04</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0084</span>, <span class="fl">0.0013</span>, <span class="fl">0.0011</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">1e-04</span>, <span class="fl">0.0012</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">4e-04</span>, <span class="fl">1e-04</span>, <span class="fl">0.0186</span>, <span class="fl">1e-04</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0083</span>, <span class="fl">0.0012</span>, <span class="fl">0.0012</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">1e-04</span>, <span class="fl">0.0011</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">5e-04</span>, <span class="fl">1e-04</span>, <span class="fl">0.0188</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>rmses_reduction <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rmses_reduction)</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rmses_reduction) <span class="ot">&lt;-</span> column_names</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="co">#dput(round(attr(Base_fiscalia_v15f_grant_23_24_long2_miss,"oob"),3))</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Out of bag error:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Out of bag error:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">sus_principal_mod =</span> <span class="dv">0</span>, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">condicion_ocupacional_corr24 =</span> <span class="dv">0</span>, </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dg_trs_cons_sus_or =</span> <span class="dv">0</span>, </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">con_quien_vive_joel =</span> <span class="dv">0</span>, </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">clas_r =</span> <span class="dv">0</span>, </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">porc_pobr =</span> <span class="fl">0.008</span>, </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">edad_al_ing_1 =</span> <span class="fl">0.001</span>, </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ano_nac_corr =</span> <span class="fl">0.001</span>, </span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">macrozona =</span> <span class="dv">0</span>, </span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">tipo_centro_pub =</span> <span class="dv">0</span>, </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">tipo_de_plan_2 =</span> <span class="dv">0</span>, <span class="at">tipo_de_plan_2_mod =</span> <span class="dv">0</span>, </span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">escolaridad_rec =</span> <span class="dv">0</span>, </span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">freq_cons_sus_prin_ord =</span> <span class="dv">0</span>, </span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_hijos_mod_joel_bin =</span> <span class="fl">0.001</span>, </span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">compromiso_biopsicosocial.y =</span> <span class="dv">0</span>, </span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">compromiso_biopsicosocial =</span> <span class="dv">0</span>, </span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">tenencia_de_la_vivienda_mod =</span> <span class="dv">0</span>, </span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sus_ini_mod_mvv =</span> <span class="dv">0</span>, </span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">edad_ini_cons =</span> <span class="fl">0.019</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           sus_principal_mod condicion_ocupacional_corr24 
                       0.000                        0.000 
          dg_trs_cons_sus_or          con_quien_vive_joel 
                       0.000                        0.000 
                      clas_r                    porc_pobr 
                       0.000                        0.008 
               edad_al_ing_1                 ano_nac_corr 
                       0.001                        0.001 
                   macrozona              tipo_centro_pub 
                       0.000                        0.000 
              tipo_de_plan_2           tipo_de_plan_2_mod 
                       0.000                        0.000 
             escolaridad_rec       freq_cons_sus_prin_ord 
                       0.000                        0.000 
      num_hijos_mod_joel_bin  compromiso_biopsicosocial.y 
                       0.001                        0.000 
   compromiso_biopsicosocial  tenencia_de_la_vivienda_mod 
                       0.000                        0.000 
             sus_ini_mod_mvv                edad_ini_cons 
                       0.000                        0.019 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#OOB prediction error per iteration and variable (1 minus R-squared for regression)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co">#The default mtry in missRanger is sqrt(p), where p is the number of variables in the dataset.</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#OOB prediction errors are quantified as 1 - R^2 for numeric variables, and as classification error otherwise. If a variable has been imputed only univariately, the value is 1.</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rdrr.io/cran/missRanger/man/missRanger.html</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p><br></p>
</section>
<section id="irrelong" class="level2">
<h2 class="anchored" data-anchor-id="irrelong">IrreLong</h2>
<section id="irregularity" class="level3">
<h3 class="anchored" data-anchor-id="irregularity">Irregularity</h3>
<p>We first formatted the data according what is being needed by the method used here: <code>id</code> which represents hash_keys in a numeric factored format, and generated the variable <code>less90d_tr</code> which is a variable that groups days in treatment between 0-90 in 1, and 0 for anything else. Additionally, we renamed the variable of biopsychosocial compromise longitudinally measured ( <code>compromiso_biopsicosocial.y</code>) for <code>comp_bpsc_y</code> for ease of processing.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_proc<span class="ot">&lt;-</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2<span class="sc">%&gt;%</span> <span class="co">#dplyr::filter(event==1)%&gt;% </span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">is_first_occurrence =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co">#para hacer ID</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">cumsum</span>(is_first_occurrence)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>is_first_occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">less_90d_tr=</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(dias_treat_imp_sin_na<span class="sc">&lt;=</span><span class="dv">90</span> <span class="sc">&amp;</span> dias_treat_imp_sin_na<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="cn">NA_real_</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"comp_bpsc_y"</span><span class="ot">=</span><span class="st">"compromiso_biopsicosocial.y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss_proc<span class="ot">&lt;-</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss<span class="sc">%&gt;%</span> <span class="co">#dplyr::filter(event==1)%&gt;% </span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">is_first_occurrence =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="co">#para hacer ID</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">cumsum</span>(is_first_occurrence)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>is_first_occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">less_90d_tr=</span> <span class="fu">factor</span>(<span class="fu">if_else</span>(dias_treat_imp_sin_na<span class="sc">&lt;=</span><span class="dv">90</span> <span class="sc">&amp;</span> dias_treat_imp_sin_na<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="cn">NA_real_</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"comp_bpsc_y"</span><span class="ot">=</span><span class="st">"compromiso_biopsicosocial.y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"parece que había que especificar bien las palabras, no permite data.tables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we measured the extent of irregularity between observation times and gaps between observations. We replicated this analysis in the imputed and original databases, and using calendar time as a reference of time taken.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">" Measuring extent of irregularity"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">extent.of.irregularity</span>(Base_fiscalia_v15f_grant_23_24_long2_proc,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">time=</span><span class="st">"time"</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">id=</span><span class="st">"id"</span>,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">scheduledtimes=</span><span class="cn">NULL</span>, <span class="at">cutpoints=</span><span class="cn">NULL</span>,<span class="at">ncutpts=</span><span class="dv">50</span>, </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">maxfu=</span><span class="dv">16</span><span class="sc">*</span><span class="dv">24</span>, <span class="at">plot=</span>F, <span class="at">legendx=</span><span class="dv">30</span>, <span class="at">legendy=</span><span class="fl">0.8</span>,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula=</span><span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span><span class="dv">1</span>,<span class="at">tau=</span><span class="dv">12</span><span class="sc">*</span><span class="dv">12</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>counts_counts<span class="ot">&lt;-</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.81609</span>, <span class="fl">0.18391</span>, <span class="fl">0.4476</span>, <span class="fl">0.49165</span>, <span class="fl">0.06075</span>, <span class="fl">0.61607</span>, </span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fl">0.35612</span>, <span class="fl">0.02781</span>, <span class="fl">0.70566</span>, <span class="fl">0.27893</span>, <span class="fl">0.0154</span>, <span class="fl">0.76138</span>, <span class="fl">0.22912</span>, </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0095</span>, <span class="fl">0.7994</span>, <span class="fl">0.19428</span>, <span class="fl">0.00632</span>, <span class="fl">0.82702</span>, <span class="fl">0.16847</span>, <span class="fl">0.00451</span>, </span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="fl">0.84794</span>, <span class="fl">0.14878</span>, <span class="fl">0.00327</span>, <span class="fl">0.86434</span>, <span class="fl">0.1332</span>, <span class="fl">0.00245</span>, <span class="fl">0.87765</span>, </span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="fl">0.12038</span>, <span class="fl">0.00197</span>, <span class="fl">0.88848</span>, <span class="fl">0.11</span>, <span class="fl">0.00152</span>, <span class="fl">0.8976</span>, <span class="fl">0.10118</span>, <span class="fl">0.00122</span>, </span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fl">0.90537</span>, <span class="fl">0.09359</span>, <span class="fl">0.00103</span>, <span class="fl">0.91202</span>, <span class="fl">0.08712</span>, <span class="fl">0.00085</span>, <span class="fl">0.91781</span>, </span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08147</span>, <span class="fl">0.00072</span>, <span class="fl">0.92287</span>, <span class="fl">0.07653</span>, <span class="fl">6e-04</span>, <span class="fl">0.92734</span>, <span class="fl">0.07216</span>, </span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="fl">5e-04</span>, <span class="fl">0.93132</span>, <span class="fl">0.06826</span>, <span class="fl">0.00042</span>, <span class="fl">0.9349</span>, <span class="fl">0.06473</span>, <span class="fl">0.00037</span>, <span class="fl">0.93815</span>, </span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="fl">0.06151</span>, <span class="fl">0.00034</span>, <span class="fl">0.94107</span>, <span class="fl">0.05863</span>, <span class="fl">3e-04</span>, <span class="fl">0.94371</span>, <span class="fl">0.05603</span>, </span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00025</span>, <span class="fl">0.94615</span>, <span class="fl">0.05361</span>, <span class="fl">0.00023</span>, <span class="fl">0.94838</span>, <span class="fl">0.05141</span>, <span class="fl">0.00021</span>, </span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="fl">0.95043</span>, <span class="fl">0.04938</span>, <span class="fl">0.00019</span>, <span class="fl">0.95233</span>, <span class="fl">0.0475</span>, <span class="fl">0.00017</span>, <span class="fl">0.95408</span>, </span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="fl">0.04576</span>, <span class="fl">0.00015</span>, <span class="fl">0.95572</span>, <span class="fl">0.04413</span>, <span class="fl">0.00015</span>, <span class="fl">0.95724</span>, <span class="fl">0.04262</span>, </span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00014</span>, <span class="fl">0.95866</span>, <span class="fl">0.04122</span>, <span class="fl">0.00012</span>, <span class="fl">0.95999</span>, <span class="fl">0.03989</span>, <span class="fl">0.00012</span>, </span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="fl">0.96123</span>, <span class="fl">0.03867</span>, <span class="fl">1e-04</span>, <span class="fl">0.9624</span>, <span class="fl">0.0375</span>, <span class="fl">1e-04</span>, <span class="fl">0.9635</span>, <span class="fl">0.03642</span>, </span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a><span class="fl">8e-05</span>, <span class="fl">0.96454</span>, <span class="fl">0.03538</span>, <span class="fl">8e-05</span>, <span class="fl">0.96552</span>, <span class="fl">0.03441</span>, <span class="fl">7e-05</span>, <span class="fl">0.96645</span>, </span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a><span class="fl">0.03348</span>, <span class="fl">7e-05</span>, <span class="fl">0.96733</span>, <span class="fl">0.03261</span>, <span class="fl">7e-05</span>, <span class="fl">0.96817</span>, <span class="fl">0.03177</span>, <span class="fl">6e-05</span>, </span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="fl">0.96896</span>, <span class="fl">0.03099</span>, <span class="fl">6e-05</span>, <span class="fl">0.96971</span>, <span class="fl">0.03025</span>, <span class="fl">5e-05</span>, <span class="fl">0.97043</span>, <span class="fl">0.02952</span>, </span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a><span class="fl">5e-05</span>, <span class="fl">0.97112</span>, <span class="fl">0.02883</span>, <span class="fl">5e-05</span>, <span class="fl">0.97177</span>, <span class="fl">0.02818</span>, <span class="fl">4e-05</span>, <span class="fl">0.9724</span>, </span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02756</span>, <span class="fl">4e-05</span>, <span class="fl">0.973</span>, <span class="fl">0.02696</span>, <span class="fl">4e-05</span>, <span class="fl">0.97357</span>, <span class="fl">0.02639</span>, <span class="fl">4e-05</span>, </span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a><span class="fl">0.97412</span>, <span class="fl">0.02584</span>, <span class="fl">4e-05</span>, <span class="fl">0.97464</span>, <span class="fl">0.02533</span>, <span class="fl">3e-05</span>, <span class="fl">0.97515</span>, <span class="fl">0.02482</span>, </span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a><span class="fl">3e-05</span>), </span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a><span class="at">byrow=</span>T,</span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a> <span class="at">nrow =</span> <span class="dv">50</span>, <span class="at">ncol=</span> <span class="dv">3</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>)))</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06548913</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># $auc</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 0.06548913</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>transformed.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.25358</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># $transformed.auc</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 20.25358</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Is not that much, but is more than 0"</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>counts_miss <span class="ot">&lt;-</span> <span class="fu">extent.of.irregularity</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">time=</span><span class="st">"time"</span>,</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">id=</span><span class="st">"id"</span>,</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">scheduledtimes=</span><span class="cn">NULL</span>, <span class="at">cutpoints=</span><span class="cn">NULL</span>,<span class="at">ncutpts=</span><span class="dv">50</span>, </span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">maxfu=</span><span class="dv">16</span><span class="sc">*</span><span class="dv">24</span>, <span class="at">plot=</span>F, <span class="at">legendx=</span><span class="dv">30</span>, <span class="at">legendy=</span><span class="fl">0.8</span>,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula=</span><span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span><span class="dv">1</span>,<span class="at">tau=</span><span class="dv">12</span><span class="sc">*</span><span class="dv">12</span>)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>counts_miss_counts<span class="ot">&lt;-</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.81609</span>, <span class="fl">0.18391</span>, <span class="fl">0.4476</span>, <span class="fl">0.49165</span>, <span class="fl">0.06075</span>, <span class="fl">0.61607</span>, </span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="fl">0.35612</span>, <span class="fl">0.02781</span>, <span class="fl">0.70566</span>, <span class="fl">0.27893</span>, <span class="fl">0.0154</span>, <span class="fl">0.76138</span>, <span class="fl">0.22912</span>, </span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0095</span>, <span class="fl">0.7994</span>, <span class="fl">0.19428</span>, <span class="fl">0.00632</span>, <span class="fl">0.82702</span>, <span class="fl">0.16847</span>, <span class="fl">0.00451</span>, </span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="fl">0.84794</span>, <span class="fl">0.14878</span>, <span class="fl">0.00327</span>, <span class="fl">0.86434</span>, <span class="fl">0.1332</span>, <span class="fl">0.00245</span>, <span class="fl">0.87765</span>, </span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="fl">0.12038</span>, <span class="fl">0.00197</span>, <span class="fl">0.88848</span>, <span class="fl">0.11</span>, <span class="fl">0.00152</span>, <span class="fl">0.8976</span>, <span class="fl">0.10118</span>, <span class="fl">0.00122</span>, </span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="fl">0.90537</span>, <span class="fl">0.09359</span>, <span class="fl">0.00103</span>, <span class="fl">0.91202</span>, <span class="fl">0.08712</span>, <span class="fl">0.00085</span>, <span class="fl">0.91781</span>, </span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="fl">0.08147</span>, <span class="fl">0.00072</span>, <span class="fl">0.92287</span>, <span class="fl">0.07653</span>, <span class="fl">6e-04</span>, <span class="fl">0.92734</span>, <span class="fl">0.07216</span>, </span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="fl">5e-04</span>, <span class="fl">0.93132</span>, <span class="fl">0.06826</span>, <span class="fl">0.00042</span>, <span class="fl">0.9349</span>, <span class="fl">0.06473</span>, <span class="fl">0.00037</span>, <span class="fl">0.93815</span>, </span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="fl">0.06151</span>, <span class="fl">0.00034</span>, <span class="fl">0.94107</span>, <span class="fl">0.05863</span>, <span class="fl">3e-04</span>, <span class="fl">0.94371</span>, <span class="fl">0.05603</span>, </span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00025</span>, <span class="fl">0.94615</span>, <span class="fl">0.05361</span>, <span class="fl">0.00023</span>, <span class="fl">0.94838</span>, <span class="fl">0.05141</span>, <span class="fl">0.00021</span>, </span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a><span class="fl">0.95043</span>, <span class="fl">0.04938</span>, <span class="fl">0.00019</span>, <span class="fl">0.95233</span>, <span class="fl">0.0475</span>, <span class="fl">0.00017</span>, <span class="fl">0.95408</span>, </span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="fl">0.04576</span>, <span class="fl">0.00015</span>, <span class="fl">0.95572</span>, <span class="fl">0.04413</span>, <span class="fl">0.00015</span>, <span class="fl">0.95724</span>, <span class="fl">0.04262</span>, </span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00014</span>, <span class="fl">0.95866</span>, <span class="fl">0.04122</span>, <span class="fl">0.00012</span>, <span class="fl">0.95999</span>, <span class="fl">0.03989</span>, <span class="fl">0.00012</span>, </span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a><span class="fl">0.96123</span>, <span class="fl">0.03867</span>, <span class="fl">1e-04</span>, <span class="fl">0.9624</span>, <span class="fl">0.0375</span>, <span class="fl">1e-04</span>, <span class="fl">0.9635</span>, <span class="fl">0.03642</span>, </span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a><span class="fl">8e-05</span>, <span class="fl">0.96454</span>, <span class="fl">0.03538</span>, <span class="fl">8e-05</span>, <span class="fl">0.96552</span>, <span class="fl">0.03441</span>, <span class="fl">7e-05</span>, <span class="fl">0.96645</span>, </span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a><span class="fl">0.03348</span>, <span class="fl">7e-05</span>, <span class="fl">0.96733</span>, <span class="fl">0.03261</span>, <span class="fl">7e-05</span>, <span class="fl">0.96817</span>, <span class="fl">0.03177</span>, <span class="fl">6e-05</span>, </span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a><span class="fl">0.96896</span>, <span class="fl">0.03099</span>, <span class="fl">6e-05</span>, <span class="fl">0.96971</span>, <span class="fl">0.03025</span>, <span class="fl">5e-05</span>, <span class="fl">0.97043</span>, <span class="fl">0.02952</span>, </span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a><span class="fl">5e-05</span>, <span class="fl">0.97112</span>, <span class="fl">0.02883</span>, <span class="fl">5e-05</span>, <span class="fl">0.97177</span>, <span class="fl">0.02818</span>, <span class="fl">4e-05</span>, <span class="fl">0.9724</span>, </span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02756</span>, <span class="fl">4e-05</span>, <span class="fl">0.973</span>, <span class="fl">0.02696</span>, <span class="fl">4e-05</span>, <span class="fl">0.97357</span>, <span class="fl">0.02639</span>, <span class="fl">4e-05</span>, </span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a><span class="fl">0.97412</span>, <span class="fl">0.02584</span>, <span class="fl">4e-05</span>, <span class="fl">0.97464</span>, <span class="fl">0.02533</span>, <span class="fl">3e-05</span>, <span class="fl">0.97515</span>, <span class="fl">0.02482</span>, </span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a><span class="fl">3e-05</span>), </span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 2024-03-07:  i realized that i retrieved the information wrong so i need the byrow</span></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a><span class="at">byrow=</span>T,</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a> <span class="at">nrow =</span> <span class="dv">50</span>, <span class="at">ncol=</span> <span class="dv">3</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>)))</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>counts_miss<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06548913</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] 0.06548913</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>counts_miss<span class="sc">$</span>transformed.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.25358</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] 20.25358</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-27: restrict to people w/ &gt;1 treatment"</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr<span class="ot">&lt;-</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss_proc <span class="sc">%&gt;%</span> </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">is_first_occurrence =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">case_when</span>(n<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">~</span> T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">factor</span>(<span class="fu">cumsum</span>(is_first_occurrence))) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dplyr::filter(max_treatment&gt;1)</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"p= "</span>, <span class="fu">length</span>(<span class="fu">unique</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr<span class="sc">$</span>hash_key)),</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>       <span class="st">"; n= "</span>, <span class="fu">nrow</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p= 13317; n= 30988"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>counts_restricted <span class="ot">&lt;-</span> <span class="fu">extent.of.irregularity</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">time=</span><span class="st">"time"</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">id=</span><span class="st">"id"</span>,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">scheduledtimes=</span><span class="cn">NULL</span>, <span class="at">cutpoints=</span><span class="cn">NULL</span>,<span class="at">ncutpts=</span><span class="dv">50</span>, </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">maxfu=</span><span class="dv">16</span><span class="sc">*</span><span class="dv">24</span>, <span class="at">plot=</span>F, <span class="at">legendx=</span><span class="dv">30</span>, <span class="at">legendy=</span><span class="fl">0.8</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula=</span><span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span><span class="dv">1</span>,<span class="at">tau=</span><span class="dv">12</span><span class="sc">*</span><span class="dv">12</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co">#counts_restricted$counts %&gt;% round(.,5) %&gt;% dput()</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>counts_restricted_counts<span class="ot">&lt;-</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">8e-05</span>, <span class="fl">0.99992</span>, <span class="fl">0.21724</span>, <span class="fl">0.45048</span>, <span class="fl">0.33228</span>, <span class="fl">0.39361</span>, </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="fl">0.45328</span>, <span class="fl">0.15311</span>, <span class="fl">0.51048</span>, <span class="fl">0.40435</span>, <span class="fl">0.08517</span>, <span class="fl">0.59123</span>, <span class="fl">0.35607</span>, </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0527</span>, <span class="fl">0.64965</span>, <span class="fl">0.31514</span>, <span class="fl">0.03522</span>, <span class="fl">0.69401</span>, <span class="fl">0.28082</span>, <span class="fl">0.02517</span>, </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="fl">0.7286</span>, <span class="fl">0.25287</span>, <span class="fl">0.01853</span>, <span class="fl">0.75589</span>, <span class="fl">0.23032</span>, <span class="fl">0.01379</span>, <span class="fl">0.77875</span>, </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="fl">0.21026</span>, <span class="fl">0.01099</span>, <span class="fl">0.79751</span>, <span class="fl">0.19379</span>, <span class="fl">0.0087</span>, <span class="fl">0.81332</span>, <span class="fl">0.17973</span>, </span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00695</span>, <span class="fl">0.8271</span>, <span class="fl">0.16702</span>, <span class="fl">0.00588</span>, <span class="fl">0.83873</span>, <span class="fl">0.1565</span>, <span class="fl">0.00477</span>, </span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="fl">0.84907</span>, <span class="fl">0.14687</span>, <span class="fl">0.00405</span>, <span class="fl">0.85816</span>, <span class="fl">0.13838</span>, <span class="fl">0.00347</span>, <span class="fl">0.86615</span>, </span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="fl">0.13091</span>, <span class="fl">0.00294</span>, <span class="fl">0.87323</span>, <span class="fl">0.12434</span>, <span class="fl">0.00243</span>, <span class="fl">0.87973</span>, <span class="fl">0.11814</span>, </span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00213</span>, <span class="fl">0.88562</span>, <span class="fl">0.11247</span>, <span class="fl">0.00191</span>, <span class="fl">0.89094</span>, <span class="fl">0.10736</span>, <span class="fl">0.0017</span>, </span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a><span class="fl">0.89575</span>, <span class="fl">0.10278</span>, <span class="fl">0.00147</span>, <span class="fl">0.90021</span>, <span class="fl">0.09844</span>, <span class="fl">0.00135</span>, <span class="fl">0.90428</span>, </span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="fl">0.09453</span>, <span class="fl">0.0012</span>, <span class="fl">0.90803</span>, <span class="fl">0.09088</span>, <span class="fl">0.00109</span>, <span class="fl">0.91152</span>, <span class="fl">0.08749</span>, </span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00099</span>, <span class="fl">0.91473</span>, <span class="fl">0.08438</span>, <span class="fl">0.00089</span>, <span class="fl">0.91773</span>, <span class="fl">0.08145</span>, <span class="fl">0.00082</span>, </span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a><span class="fl">0.92056</span>, <span class="fl">0.07867</span>, <span class="fl">0.00077</span>, <span class="fl">0.92317</span>, <span class="fl">0.07612</span>, <span class="fl">0.00071</span>, <span class="fl">0.92562</span>, </span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a><span class="fl">0.07371</span>, <span class="fl">0.00067</span>, <span class="fl">0.92791</span>, <span class="fl">0.07148</span>, <span class="fl">0.00061</span>, <span class="fl">0.93006</span>, <span class="fl">0.06938</span>, </span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00056</span>, <span class="fl">0.93207</span>, <span class="fl">0.06743</span>, <span class="fl">5e-04</span>, <span class="fl">0.93399</span>, <span class="fl">0.06556</span>, <span class="fl">0.00046</span>, </span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a><span class="fl">0.93578</span>, <span class="fl">0.06382</span>, <span class="fl">4e-04</span>, <span class="fl">0.93752</span>, <span class="fl">0.06209</span>, <span class="fl">4e-04</span>, <span class="fl">0.93916</span>, <span class="fl">0.06046</span>, </span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00038</span>, <span class="fl">0.94071</span>, <span class="fl">0.05892</span>, <span class="fl">0.00037</span>, <span class="fl">0.94216</span>, <span class="fl">0.05751</span>, <span class="fl">0.00033</span>, </span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a><span class="fl">0.94356</span>, <span class="fl">0.05613</span>, <span class="fl">0.00031</span>, <span class="fl">0.94491</span>, <span class="fl">0.05478</span>, <span class="fl">0.00031</span>, <span class="fl">0.94617</span>, </span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a><span class="fl">0.05356</span>, <span class="fl">0.00028</span>, <span class="fl">0.94736</span>, <span class="fl">0.05239</span>, <span class="fl">0.00025</span>, <span class="fl">0.94853</span>, <span class="fl">0.05123</span>, </span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00024</span>, <span class="fl">0.94965</span>, <span class="fl">0.05012</span>, <span class="fl">0.00023</span>, <span class="fl">0.95072</span>, <span class="fl">0.04906</span>, <span class="fl">0.00022</span>, </span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a><span class="fl">0.95173</span>, <span class="fl">0.04806</span>, <span class="fl">2e-04</span>, <span class="fl">0.95271</span>, <span class="fl">0.04709</span>, <span class="fl">0.00019</span>, <span class="fl">0.95365</span>, </span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a><span class="fl">0.04617</span>, <span class="fl">0.00018</span>), </span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 2024-03-07:  i realized that i retrieved the information wrong so i need the byrow</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a><span class="at">byrow=</span>T,</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a> <span class="at">nrow =</span> <span class="dv">50</span>, <span class="at">ncol=</span> <span class="dv">3</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>)))</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>counts_restricted<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.212881</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] 0.213</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>counts_restricted<span class="sc">$</span>transformed.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80.02791</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#80 </span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Check if there were any errors in of lag times after time"</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>error_in_time_followup<span class="ot">&lt;-</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_proc <span class="sc">%&gt;%</span> </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span> <span class="fu">lag</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(time <span class="sc">&lt;=</span>lag_time <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(lag_time)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, time, lag_time, motivodeegreso_mod_imp, dias_treat_imp_sin_na, enter_time, fech_ing_num, fech_egres_num, cens_time)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 0 x 9</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_proc <span class="sc">%&gt;%</span> </span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span> <span class="fu">lag</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key <span class="sc">%in%</span> <span class="fu">unique</span>(error_in_time_followup<span class="sc">$</span>hash_key)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, time, motivodeegreso_mod_imp, dias_treat_imp_sin_na, enter_time, fech_ing_num, fech_egres_num, cens_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 x 8
# ... with 8 variables: hash_key &lt;chr&gt;, time &lt;dbl&gt;,
#   motivodeegreso_mod_imp &lt;chr&gt;, dias_treat_imp_sin_na &lt;dbl&gt;,
#   enter_time &lt;dbl&gt;, fech_ing_num &lt;dbl&gt;, fech_egres_num &lt;dbl&gt;, cens_time &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 0 x 8</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>error_in_time_followup_miss<span class="ot">&lt;-</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss_proc <span class="sc">%&gt;%</span> </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span> <span class="fu">lag</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(time <span class="sc">&lt;=</span>lag_time <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(lag_time)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, time, lag_time, motivodeegreso_mod_imp, dias_treat_imp_sin_na, enter_time, fech_ing_num, fech_egres_num, cens_time)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 0 x 9</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss_proc <span class="sc">%&gt;%</span> </span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span> <span class="fu">lag</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key <span class="sc">%in%</span> <span class="fu">unique</span>(error_in_time_followup_miss<span class="sc">$</span>hash_key)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, time, motivodeegreso_mod_imp, dias_treat_imp_sin_na, enter_time, fech_ing_num, fech_egres_num, cens_time) <span class="sc">%&gt;%</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(.) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">"There are ties or previous events that occured later than the actual events"</span>)</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Behavior when the condition isn't met (e.g., return an empty data frame)</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(.) </span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>    }  </span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] hash_key               time                   motivodeegreso_mod_imp
[4] dias_treat_imp_sin_na  enter_time             fech_ing_num          
[7] fech_egres_num         cens_time             
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] hash_key               time                   motivodeegreso_mod_imp dias_treat_imp_sin_na  enter_time            </span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [6] fech_ing_num           fech_egres_num         cens_time             </span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>( <span class="st">"There are no ties or previous events that occured later than the following events"</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now we do it with calendar date unaltered"</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>counts_corr <span class="ot">&lt;-</span> <span class="fu">extent.of.irregularity</span>(dplyr<span class="sc">::</span><span class="fu">mutate</span>(Base_fiscalia_v15f_grant_23_24_long2_proc, <span class="at">fech_egres_num=</span> fech_egres_num<span class="sc">/</span><span class="fl">30.5</span>),</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">time=</span><span class="st">"fech_egres_num"</span>,</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">id=</span><span class="st">"id"</span>,</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">scheduledtimes=</span><span class="cn">NULL</span>, <span class="at">cutpoints=</span><span class="cn">NULL</span>,<span class="at">ncutpts=</span><span class="dv">50</span>, </span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">maxfu=</span><span class="dv">18213</span><span class="sc">/</span><span class="fl">30.5</span>, <span class="at">plot=</span>F, <span class="at">legendx=</span><span class="dv">30</span>, <span class="at">legendy=</span><span class="fl">0.8</span>,</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula=</span><span class="fu">Surv</span>(fech_egres_num.lag,fech_egres_num,event)<span class="sc">~</span><span class="dv">1</span>,<span class="at">tau=</span><span class="dv">12</span><span class="sc">*</span><span class="dv">12</span>)</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>counts_corr_counts<span class="ot">&lt;-</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.00023</span>, <span class="fl">0.81592</span>, <span class="fl">0.18384</span>, <span class="fl">0.46307</span>, <span class="fl">0.46597</span>, <span class="fl">0.07096</span>, </span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="fl">0.62881</span>, <span class="fl">0.33313</span>, <span class="fl">0.03807</span>, <span class="fl">0.71395</span>, <span class="fl">0.26336</span>, <span class="fl">0.02269</span>, <span class="fl">0.76724</span>, </span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="fl">0.21789</span>, <span class="fl">0.01487</span>, <span class="fl">0.80367</span>, <span class="fl">0.18596</span>, <span class="fl">0.01037</span>, <span class="fl">0.8302</span>, <span class="fl">0.16231</span>, </span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00749</span>, <span class="fl">0.85036</span>, <span class="fl">0.14405</span>, <span class="fl">0.00559</span>, <span class="fl">0.86621</span>, <span class="fl">0.12954</span>, <span class="fl">0.00425</span>, </span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="fl">0.87903</span>, <span class="fl">0.11765</span>, <span class="fl">0.00332</span>, <span class="fl">0.88967</span>, <span class="fl">0.10767</span>, <span class="fl">0.00266</span>, <span class="fl">0.89855</span>, </span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="fl">0.09931</span>, <span class="fl">0.00214</span>, <span class="fl">0.90617</span>, <span class="fl">0.09204</span>, <span class="fl">0.00179</span>, <span class="fl">0.91267</span>, <span class="fl">0.08586</span>, </span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00147</span>, <span class="fl">0.91832</span>, <span class="fl">0.08047</span>, <span class="fl">0.00121</span>, <span class="fl">0.92335</span>, <span class="fl">0.07558</span>, <span class="fl">0.00107</span>, </span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="fl">0.92776</span>, <span class="fl">0.07134</span>, <span class="fl">9e-04</span>, <span class="fl">0.93165</span>, <span class="fl">0.06762</span>, <span class="fl">0.00073</span>, <span class="fl">0.93519</span>, </span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a><span class="fl">0.06417</span>, <span class="fl">0.00064</span>, <span class="fl">0.93839</span>, <span class="fl">0.06104</span>, <span class="fl">0.00057</span>, <span class="fl">0.94128</span>, <span class="fl">0.05822</span>, </span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a><span class="fl">5e-04</span>, <span class="fl">0.94391</span>, <span class="fl">0.05566</span>, <span class="fl">0.00043</span>, <span class="fl">0.94631</span>, <span class="fl">0.05332</span>, <span class="fl">0.00038</span>, </span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a><span class="fl">0.94852</span>, <span class="fl">0.05115</span>, <span class="fl">0.00034</span>, <span class="fl">0.95054</span>, <span class="fl">0.04917</span>, <span class="fl">0.00029</span>, <span class="fl">0.95245</span>, </span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a><span class="fl">0.04727</span>, <span class="fl">0.00028</span>, <span class="fl">0.95418</span>, <span class="fl">0.04558</span>, <span class="fl">0.00024</span>, <span class="fl">0.95581</span>, <span class="fl">0.04398</span>, </span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00022</span>, <span class="fl">0.9573</span>, <span class="fl">0.04251</span>, <span class="fl">0.00019</span>, <span class="fl">0.95873</span>, <span class="fl">0.04108</span>, <span class="fl">0.00019</span>, </span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a><span class="fl">0.96004</span>, <span class="fl">0.0398</span>, <span class="fl">0.00016</span>, <span class="fl">0.96129</span>, <span class="fl">0.03855</span>, <span class="fl">0.00016</span>, <span class="fl">0.96245</span>, </span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a><span class="fl">0.03741</span>, <span class="fl">0.00014</span>, <span class="fl">0.96355</span>, <span class="fl">0.03633</span>, <span class="fl">0.00013</span>, <span class="fl">0.96458</span>, <span class="fl">0.0353</span>, </span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00012</span>, <span class="fl">0.96555</span>, <span class="fl">0.03435</span>, <span class="fl">1e-04</span>, <span class="fl">0.96649</span>, <span class="fl">0.03342</span>, <span class="fl">1e-04</span>, <span class="fl">0.96737</span>, </span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a><span class="fl">0.03254</span>, <span class="fl">9e-05</span>, <span class="fl">0.96819</span>, <span class="fl">0.03172</span>, <span class="fl">8e-05</span>, <span class="fl">0.96898</span>, <span class="fl">0.03094</span>, <span class="fl">8e-05</span>, </span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="fl">0.96974</span>, <span class="fl">0.03019</span>, <span class="fl">7e-05</span>, <span class="fl">0.97046</span>, <span class="fl">0.02948</span>, <span class="fl">7e-05</span>, <span class="fl">0.97113</span>, <span class="fl">0.02881</span>, </span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a><span class="fl">5e-05</span>, <span class="fl">0.97179</span>, <span class="fl">0.02815</span>, <span class="fl">6e-05</span>, <span class="fl">0.97242</span>, <span class="fl">0.02753</span>, <span class="fl">5e-05</span>, <span class="fl">0.97301</span>, </span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a><span class="fl">0.02694</span>, <span class="fl">5e-05</span>, <span class="fl">0.97358</span>, <span class="fl">0.02638</span>, <span class="fl">4e-05</span>, <span class="fl">0.97413</span>, <span class="fl">0.02583</span>, <span class="fl">4e-05</span>, </span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a><span class="fl">0.97466</span>, <span class="fl">0.0253</span>, <span class="fl">4e-05</span>, <span class="fl">0.97516</span>, <span class="fl">0.0248</span>, <span class="fl">4e-05</span>), </span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a> <span class="at">nrow =</span> <span class="dv">50</span>, <span class="at">ncol=</span> <span class="dv">3</span>,</span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a><span class="co"># i realized that i needed the byrow=T because i used bad the reading of the dput</span></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a><span class="at">byrow=</span>T, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>)))</span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a>counts_corr<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07266227</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># $auc</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 0.07266227</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>counts_corr<span class="sc">$</span>transformed.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.65514</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># $transformed.auc</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 22.65514</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"omitted"</span>)){</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">"To check specific gap bin widths for the 3 options in a specific time after 'filter'==1 (e.g.)"</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"1. Modified"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_counts),<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"2. Modified</span><span class="sc">\n</span><span class="st">(imputation)"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_miss_counts), <span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"3. More 1</span><span class="sc">\n</span><span class="st">treatment"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_restricted_counts), <span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"4. Original</span><span class="sc">\n</span><span class="st">calendar"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_corr_counts)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(time<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>))</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"1. Modified"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_counts),<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"2. Modified</span><span class="sc">\n</span><span class="st">(imputation)"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_miss_counts), <span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"3. More 1</span><span class="sc">\n</span><span class="st">treatment"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_restricted_counts), <span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"4. Original</span><span class="sc">\n</span><span class="st">calendar"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_corr_counts)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(time<span class="sc">==</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>))</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co">#2024-05-13</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"5. Restricted</span><span class="sc">\n</span><span class="st">treatments"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_restricted_counts) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(time<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>))</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"5. Restricted</span><span class="sc">\n</span><span class="st">treatments"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_restricted_counts) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(time<span class="sc">==</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric,<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>))</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>plot_irregularity<span class="ot">&lt;-</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"1. Modified"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_counts),<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"2. Modified</span><span class="sc">\n</span><span class="st">(imputation)"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_miss_counts),<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"3. More 1</span><span class="sc">\n</span><span class="st">treatment"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_restricted_counts),<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"4. Original</span><span class="sc">\n</span><span class="st">calendar"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_corr_counts)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id=</span><span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"time"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Observations=</span> <span class="fu">factor</span>(variable, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0 obs per bin"</span>,<span class="st">"1 obs per bin"</span>, <span class="st">"2+ obs per bin"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>value, <span class="at">linetype=</span>Observations), <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)<span class="sc">+</span> <span class="co">#color=factor(type))</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Bin width (%)"</span>)<span class="sc">+</span></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean proportions of individuals"</span>)<span class="co">#+</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_linetype_manual(name="Observations")</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>plot_irregularity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-2-irregularity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>plot_irregularity_05_2024<span class="ot">&lt;-</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">type=</span><span class="fu">rep</span>(<span class="st">"3. More 1</span><span class="sc">\n</span><span class="st">treatment"</span>,), <span class="at">time=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, counts_restricted_counts)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id=</span><span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"time"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Observations=</span> <span class="fu">factor</span>(variable, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0 obs per bin"</span>,<span class="st">"1 obs per bin"</span>, <span class="st">"2+ obs per bin"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>value, <span class="at">linetype=</span>Observations), <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#facet_wrap(~type)+ #color=factor(type))</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Bin width (%)"</span>)<span class="sc">+</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Mean proportions of individuals"</span>)<span class="co">#+</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot_irregularity, <span class="at">file=</span><span class="st">"_proposal_grant/2023/_figs/irreg240427.jpg"</span>, <span class="at">width=</span><span class="fl">8.5</span>, <span class="at">height=</span><span class="fl">5.5</span>, <span class="at">dpi=</span><span class="dv">500</span>)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(plot_irregularity_05_2024, <span class="at">file=</span> <span class="fu">paste0</span>(folder_path,<span class="st">"_figs/irreg240513.jpg"</span>), <span class="at">width=</span><span class="fl">8.5</span>, <span class="at">height=</span><span class="fl">5.5</span>, <span class="at">dpi=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The AUCs that suggest that although low values, we can suspect a share of a counting process behind visits rather than a perfect repeated measures. Thus, it seems reasonable to conduct an analysis that consider irregularity in observations and an extent of informative assessment times, conditional on a bulk of covariates, including past observed outcomes, past assessment history, and baseline covariates. The graphic show the mean proportions of individuals with 0,1, and &gt;1 visits per bin as bin width varies from 1 to 50% of the gap between admissions. In the graphic, we can see that in the first 5 bins there were more than one observation in the same bin of time.</p>
<p><br></p>
</section>
<section id="iiw" class="level3">
<h3 class="anchored" data-anchor-id="iiw">IIW</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co">#load("C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/an_grant_23_24_04_15.RData")</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># formulaph: the formula for the proportional hazards model for the visit intensity that will be used to derive inverse-intensity weights. The formula should usually use the counting process format (i.e. Surv(start,stop,event)). If a frailty model is used, the cluster(id) term should appear before other covariates</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co"># formulanull: if stabilised weights are to be used, the formula for the null model used to stabilise the weights</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data: data frame containing the variables in the model</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co"># id: character string indicating which column of the data identifies subjects</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co"># time: character string indicating which column of the data contains the time at which the visit occurred</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="co"># event: character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="co"># lagvars: a vector of variable names corresponding to variables which need to be lagged by one visit to fit the visit intensity model. Typically time will be one of these variables. The function will internally add columns to the data containing the values of the lagged variables from the previous visit. Values of lagged variables for a subject's first visit will be set to NA. To access these variables in specifying the proportional hazards formulae, add ".lag" to the variable you wish to lag. For example, if time is the variable for time, time.lag is the time of the previous visit</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="co"># invariant: a vector of variable names corresponding to variables in data that are time-invariant. It is not necessary to list every such variable, just those that are invariant and also included in the proportional hazards model</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="co"># maxfu: the maximum follow-up time(s). If everyone is followed for the same length of time, this can be given as a single value. If individuals have different follow-up times, maxfu should have the same number of elements as there are rows of data</span></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a><span class="co"># lagfirst: A vector giving the value of each lagged variable for the first time within each subject. This is helpful if, for example, time is the variable to be lagged and you know that all subjects entered the study at time zero</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a><span class="co"># first: logical variable. If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred; in this case the baseline visit is observed with probability 1.</span></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-03-06: No es necesario correr el proceso longitudinal con ..."</span>)</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"fech_ing_num.lag,fech_ing_num, porque ya corregi time y no debiese tener ..."</span>)</span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"superposiciones con lag.time"</span>)</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Por lo visto si hay un problema, pq no recupero ninguno"</span>)</span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2014-03-08: Primero tenemos que ver si es plausible ver evidencia en contra de eventos aleatorios. "</span>)</span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse(Phenobarb)</span></span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-45"><a href="#cb109-45" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Correct id so it resemble Phenobarb"</span>)</span>
<span id="cb109-46"><a href="#cb109-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">class</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc<span class="sc">$</span>id)<span class="sc">!=</span><span class="st">"factor"</span>){</span>
<span id="cb109-47"><a href="#cb109-47" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss_proc<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">factor</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc<span class="sc">$</span>id)</span>
<span id="cb109-48"><a href="#cb109-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-49"><a href="#cb109-49" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Correct id so it resemble Phenobarb"</span>)</span>
<span id="cb109-50"><a href="#cb109-50" aria-hidden="true" tabindex="-1"></a>data_mine_miss <span class="ot">&lt;-</span> Base_fiscalia_v15f_grant_23_24_long2_miss_proc</span>
<span id="cb109-51"><a href="#cb109-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-52"><a href="#cb109-52" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Correct id so it resemble Phenobarb"</span>)</span>
<span id="cb109-53"><a href="#cb109-53" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">class</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr<span class="sc">$</span>id)<span class="sc">!=</span><span class="st">"factor"</span>){</span>
<span id="cb109-54"><a href="#cb109-54" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">factor</span>(Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr<span class="sc">$</span>id)</span>
<span id="cb109-55"><a href="#cb109-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-56"><a href="#cb109-56" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr <span class="ot">&lt;-</span> Base_fiscalia_v15f_grant_23_24_long2_miss_proc_multtr</span>
<span id="cb109-57"><a href="#cb109-57" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb109-58"><a href="#cb109-58" aria-hidden="true" tabindex="-1"></a> <span class="fu">invisible</span>(<span class="st">"2024-04-15: Need to take into account that this implies having only those who experiment the event, which might be bad. I have to have people that is observed. This should be the event"</span>)</span>
<span id="cb109-59"><a href="#cb109-59" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: data_mine_miss &lt;- data_mine_miss[data_mine_miss$event==1,]</span></span>
<span id="cb109-60"><a href="#cb109-60" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb109-61"><a href="#cb109-61" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-15: keep the tr. outcome"</span>)</span>
<span id="cb109-62"><a href="#cb109-62" aria-hidden="true" tabindex="-1"></a>data_mine_miss<span class="sc">$</span>tr_outcome <span class="ot">&lt;-</span> data_mine_miss<span class="sc">$</span>event</span>
<span id="cb109-63"><a href="#cb109-63" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr<span class="sc">$</span>tr_outcome <span class="ot">&lt;-</span> data_mine_miss_restr<span class="sc">$</span>event</span>
<span id="cb109-64"><a href="#cb109-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-65"><a href="#cb109-65" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-15: transform the event into 1 (being observed"</span>)</span>
<span id="cb109-66"><a href="#cb109-66" aria-hidden="true" tabindex="-1"></a>data_mine_miss<span class="sc">$</span>event<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb109-67"><a href="#cb109-67" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr<span class="sc">$</span>event<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb109-68"><a href="#cb109-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-69"><a href="#cb109-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-70"><a href="#cb109-70" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc <span class="ot">&lt;-</span>  </span>
<span id="cb109-71"><a href="#cb109-71" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(data_mine_miss,<span class="fu">model.matrix</span>(<span class="sc">~</span> comp_bpsc_y <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> less_90d_tr <span class="sc">-</span><span class="dv">1</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(data_mine_miss))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"comp_bpsc_y2_moderate"</span><span class="ot">=</span><span class="st">"comp_bpsc_y2-Moderate"</span>,<span class="st">"comp_bpsc_y3_severe"</span><span class="ot">=</span><span class="st">"comp_bpsc_y3-Severe"</span>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() </span>
<span id="cb109-72"><a href="#cb109-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-73"><a href="#cb109-73" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc <span class="ot">&lt;-</span>  </span>
<span id="cb109-74"><a href="#cb109-74" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(data_mine_miss_restr,<span class="fu">model.matrix</span>(<span class="sc">~</span> comp_bpsc_y <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> less_90d_tr <span class="sc">-</span><span class="dv">1</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(data_mine_miss_restr))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"comp_bpsc_y2_moderate"</span><span class="ot">=</span><span class="st">"comp_bpsc_y2-Moderate"</span>,<span class="st">"comp_bpsc_y3_severe"</span><span class="ot">=</span><span class="st">"comp_bpsc_y3-Severe"</span>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() </span>
<span id="cb109-75"><a href="#cb109-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-76"><a href="#cb109-76" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-18: eliminate Mild level"</span>)</span>
<span id="cb109-77"><a href="#cb109-77" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc<span class="sc">$</span>comp_bpsc_y1.Mild<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb109-78"><a href="#cb109-78" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc<span class="sc">$</span>comp_bpsc_y1.Mild<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb109-79"><a href="#cb109-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-80"><a href="#cb109-80" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-15: following the addcensoredrows function vignette [https://search.r-project.org/CRAN/refmans/IrregLong/html/addcensoredrows.html] we crated a database to compute"</span>)</span>
<span id="cb109-81"><a href="#cb109-81" aria-hidden="true" tabindex="-1"></a>maxfu_df<span class="ot">&lt;-</span></span>
<span id="cb109-82"><a href="#cb109-82" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_proc <span class="sc">%&gt;%</span> </span>
<span id="cb109-83"><a href="#cb109-83" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb109-84"><a href="#cb109-84" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">maxfu.time=</span> <span class="fu">max</span>(cens_time, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> <span class="co">#,0)</span></span>
<span id="cb109-85"><a href="#cb109-85" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"maxfu.id"</span><span class="ot">=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb109-86"><a href="#cb109-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb109-87"><a href="#cb109-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-88"><a href="#cb109-88" aria-hidden="true" tabindex="-1"></a>maxfu_restr_df<span class="ot">&lt;-</span></span>
<span id="cb109-89"><a href="#cb109-89" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc  <span class="sc">%&gt;%</span> </span>
<span id="cb109-90"><a href="#cb109-90" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb109-91"><a href="#cb109-91" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">maxfu.time=</span> <span class="fu">max</span>(cens_time, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> <span class="co">#,0)</span></span>
<span id="cb109-92"><a href="#cb109-92" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"maxfu.id"</span><span class="ot">=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb109-93"><a href="#cb109-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb109-94"><a href="#cb109-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-95"><a href="#cb109-95" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_ </span></span>
<span id="cb109-96"><a href="#cb109-96" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-15: Make a sample of 10% to test quicker"</span>)</span>
<span id="cb109-97"><a href="#cb109-97" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc_sample<span class="ot">&lt;-</span></span>
<span id="cb109-98"><a href="#cb109-98" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc <span class="sc">%&gt;%</span> </span>
<span id="cb109-99"><a href="#cb109-99" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(id <span class="sc">%in%</span></span>
<span id="cb109-100"><a href="#cb109-100" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(data_mine_miss_proc<span class="sc">$</span>id)),<span class="fl">5e3</span>)))</span>
<span id="cb109-101"><a href="#cb109-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-102"><a href="#cb109-102" aria-hidden="true" tabindex="-1"></a>maxfu_sample_df<span class="ot">&lt;-</span></span>
<span id="cb109-103"><a href="#cb109-103" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_proc_sample <span class="sc">%&gt;%</span> </span>
<span id="cb109-104"><a href="#cb109-104" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb109-105"><a href="#cb109-105" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">maxfu.time=</span> <span class="fu">round</span>(<span class="fu">max</span>(cens_time, <span class="at">na.rm=</span>T),<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-106"><a href="#cb109-106" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"maxfu.id"</span><span class="ot">=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb109-107"><a href="#cb109-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb109-108"><a href="#cb109-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-109"><a href="#cb109-109" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-110"><a href="#cb109-110" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb109-111"><a href="#cb109-111" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"i0: only events; missing values, only event.lag"</span>)</span>
<span id="cb109-112"><a href="#cb109-112" aria-hidden="true" tabindex="-1"></a>i0 <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb109-113"><a href="#cb109-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag <span class="sc">+</span> </span>
<span id="cb109-114"><a href="#cb109-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb109-115"><a href="#cb109-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb109-116"><a href="#cb109-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb109-117"><a href="#cb109-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#event: dropout; 2024-04-18 being reobserved (visit)</span></span>
<span id="cb109-118"><a href="#cb109-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb109-119"><a href="#cb109-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb109-120"><a href="#cb109-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>),<span class="co">#"less_90d_tr", "comp_bpsc_y"), #</span></span>
<span id="cb109-121"><a href="#cb109-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#12*12,# Base_fiscalia_v15f_grant_23_24_long2$cens_time, #12*12,</span></span>
<span id="cb109-122"><a href="#cb109-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb109-123"><a href="#cb109-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb109-124"><a href="#cb109-124" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb109-125"><a href="#cb109-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-126"><a href="#cb109-126" aria-hidden="true" tabindex="-1"></a>i0<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag, 
    data = datacox, cluster = id)

                    coef exp(coef)  se(coef) robust se      z      p
tr_outcome.lag -1.868626  0.154336  0.009581  0.009747 -191.7 &lt;2e-16

Likelihood ratio test=50186  on 1 df, p=&lt; 2.2e-16
n= 162323, number of events= 89925 
   (150 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i0<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 6
  term           estimate std.error robust.se statistic p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 tr_outcome.lag    -1.87   0.00958   0.00975     -192.       0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#broom::tidy(i0$m) %&gt;% dput()</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>i0_df_out<span class="ot">&lt;-</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="st">"tr_outcome.lag"</span>, <span class="at">estimate =</span> <span class="sc">-</span><span class="fl">1.86862564229299</span>, </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fl">0.00958080874903184</span>, <span class="at">robust.se =</span> <span class="fl">0.00974694287151046</span>, </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="sc">-</span><span class="fl">191.714024276765</span>, <span class="at">p.value =</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>i0<span class="sc">$</span>datacox <span class="sc">%&gt;%</span> </span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span> <span class="fu">lag</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(time <span class="sc">&lt;=</span>lag_time <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(lag_time)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, time, lag_time, motivodeegreso_mod_imp, dias_treat_imp_sin_na, enter_time, fech_ing_num, fech_egres_num, cens_time)<span class="sc">%&gt;%</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(.) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">"There are ties or previous events that occured later than the actual events"</span>)</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Behavior when the condition isn't met (e.g., return an empty data frame)</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(.) </span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>    }  </span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] hash_key               time                   lag_time              
[4] motivodeegreso_mod_imp dias_treat_imp_sin_na  enter_time            
[7] fech_ing_num           fech_egres_num         cens_time             
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"it seems that there are no errors"</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"i0b: only events; missing values, only event.lag; lag first 1s"</span>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>i0b <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag <span class="sc">+</span> <span class="co">#comp_bpsc_y.lag+ less_90d_tr.lag+ </span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#event: dropout</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>),<span class="co">#"less_90d_tr", "comp_bpsc_y"), #</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>i0b<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag, 
    data = datacox, cluster = id)

                  coef exp(coef) se(coef) robust se     z      p
tr_outcome.lag 1.06837   2.91063  0.01705   0.01690 63.21 &lt;2e-16

Likelihood ratio test=5298  on 1 df, p=&lt; 2.2e-16
n= 159556, number of events= 87158 
   (2917 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i0b<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 6
  term           estimate std.error robust.se statistic p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 tr_outcome.lag     1.07    0.0170    0.0169      63.2       0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>i0b_df_out<span class="ot">&lt;-</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="st">"tr_outcome.lag"</span>, <span class="at">estimate =</span> <span class="fl">1.06836854522169</span>, </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fl">0.0170488969088114</span>, <span class="at">robust.se =</span> <span class="fl">0.0169029487257102</span>, </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fl">63.2060454396721</span>, <span class="at">p.value =</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i0<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   1.000   1.846   1.000   6.479 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.000   1.000   1.000   1.846   1.000   6.479 </span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>ploti0<span class="ot">&lt;-</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i0<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i0$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>)<span class="sc">+</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Removed 13708 rows containing non-finite values (`stat_bin()`). </span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i0b<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3436  1.0000  1.0000  0.8986  1.0000  1.0000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.3436  1.0000  1.0000  0.8986  1.0000  1.0000</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>ploti0b<span class="ot">&lt;-</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i0b<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i0b$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Restrict to users with more than one treatment"</span>)</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc_multtr<span class="ot">&lt;-</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc <span class="sc">%&gt;%</span> </span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">case_when</span>(n<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">~</span> T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dplyr::filter(max_treatment&gt;1) </span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2014-04-15: make a follow-up for this subsample"</span>)</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>maxfu_multtr_df<span class="ot">&lt;-</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    data_mine_miss_proc_multtr <span class="sc">%&gt;%</span> </span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">maxfu.time=</span> <span class="fu">max</span>(cens_time, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> <span class="co">#,0)</span></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"maxfu.id"</span><span class="ot">=</span><span class="st">"id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Remember that his has only events (observations)"</span>)</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"The original database had "</span>,</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>       <span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(data_mine_miss_proc<span class="sc">$</span>hash_key)), <span class="at">big.mark=</span><span class="st">","</span>),</span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>       <span class="st">" patients and "</span>,</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>       <span class="fu">format</span>(<span class="fu">length</span>(data_mine_miss_proc<span class="sc">$</span>hash_key), <span class="at">big.mark=</span><span class="st">","</span>),</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a>       <span class="st">" observations with only events, but keeping patients with more than one treatment left only "</span>,</span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>       <span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(data_mine_miss_proc_multtr<span class="sc">$</span>hash_key)), <span class="at">big.mark=</span><span class="st">","</span>),</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>       <span class="st">" patients and "</span>,</span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>       <span class="fu">format</span>(<span class="fu">length</span>(data_mine_miss_proc_multtr<span class="sc">$</span>hash_key), <span class="at">big.mark=</span><span class="st">","</span>),</span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a>       <span class="st">" observations"</span></span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The original database had 72,404 patients and 90,075 observations with only events, but keeping patients with more than one treatment left only 13,317 patients and 30,988 observations"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] "The original database had 72,404 patients and 90,075 observations with only events, but keeping patients with more than one treatment left only 13,317 patients and 30,988 observations"</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"multiple treatments; only event.lag; lag first 0s"</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>i0c <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag <span class="sc">+</span> <span class="co">#comp_bpsc_y.lag+ less_90d_tr.lag+ </span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#event: dropout</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc_multtr,</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>),<span class="co">#"less_90d_tr", "comp_bpsc_y"), #</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_multtr_df, <span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="co"># In Surv(fech_ing_num.lag, fech_ing_num, event) :</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   Stop time must be &gt; start time, NA created</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>i0c<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag, 
    data = datacox, cluster = id)

                    coef exp(coef)  se(coef) robust se      z      p
tr_outcome.lag -0.747183  0.473699  0.012291  0.008773 -85.17 &lt;2e-16

Likelihood ratio test=3636  on 1 df, p=&lt; 2.2e-16
n= 44272, number of events= 30959 
   (29 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i0c<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 6
  term           estimate std.error robust.se statistic p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 tr_outcome.lag   -0.747    0.0123   0.00877     -85.2       0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>i0c_df_out<span class="ot">&lt;-</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="st">"tr_outcome.lag"</span>, <span class="at">estimate =</span> <span class="sc">-</span><span class="fl">0.747182521538917</span>, </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fl">0.0122906036735641</span>, <span class="at">robust.se =</span> <span class="fl">0.00877334474470237</span>, </span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="sc">-</span><span class="fl">85.1650702532908</span>, <span class="at">p.value =</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>i0d <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag <span class="sc">+</span> <span class="co">#comp_bpsc_y.lag+ less_90d_tr.lag+ </span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#event: observed</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc_multtr,</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>),<span class="co">#"less_90d_tr", "comp_bpsc_y"), #</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_multtr_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a><span class="co"># In Surv(fech_ing_num.lag, fech_ing_num, event) :</span></span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   Stop time must be &gt; start time, NA created</span></span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>i0d<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag, 
    data = datacox, cluster = id)

                  coef exp(coef) se(coef) robust se     z      p
tr_outcome.lag 0.27465   1.31607  0.01798   0.01291 21.27 &lt;2e-16

Likelihood ratio test=247.4  on 1 df, p=&lt; 2.2e-16
n= 43638, number of events= 30325 
   (663 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i0d<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 6
  term           estimate std.error robust.se statistic   p.value
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 tr_outcome.lag    0.275    0.0180    0.0129      21.3 2.28e-100</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>i0d_df_out<span class="ot">&lt;-</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="st">"tr_outcome.lag"</span>, <span class="at">estimate =</span> <span class="fl">0.274653363170145</span>, </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fl">0.0179832241105765</span>, <span class="at">robust.se =</span> <span class="fl">0.0129143329186389</span>, </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fl">21.2673287037339</span>, <span class="at">p.value =</span> <span class="fl">2.27894355540563e-100</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i0c<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   1.000   1.499   2.111   2.111 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.000   1.000   1.000   1.499   2.111   2.111 </span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>ploti0c<span class="ot">&lt;-</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i0c<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i0c$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i0d<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.7598  0.7598  0.7598  0.7890  0.7598  1.0000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.7598  0.7598  0.7598  0.7890  0.7598  1.0000 </span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>ploti0d<span class="ot">&lt;-</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i0d<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i0d$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now we use the 'data_mine_miss_proc' and try to dummify previous events"</span>)</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>i1 <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> <span class="co">#less_90d_tr.lag+ </span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">rep</span>(<span class="dv">0</span>),</span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"No longer  Error in as.character.factor(x) : malformed factor"</span>)</span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Además: Warning message:</span></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a><span class="co"># In Surv(time.lag, time, event) : Stop time must be &gt; start time, NA created</span></span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Glimpse"</span>)</span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc[,<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>)] <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 90,075
Columns: 6
$ id                    &lt;fct&gt; 1, 2, 3, 4, 5, 6, 7, 7, 8, 9, 10, 11, 12, 13, 14~
$ time                  &lt;dbl&gt; 9.8032787, 8.5901639, 8.8196721, 1.1475410, 7.01~
$ tr_outcome            &lt;dbl&gt; 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, ~
$ comp_bpsc_y2_moderate &lt;dbl&gt; 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, ~
$ comp_bpsc_y3_severe   &lt;dbl&gt; 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, ~
$ less_90d_tr1          &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, ~</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>i1b <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> <span class="co">#less_90d_tr.lag+ </span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>i1<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag, data = datacox, cluster = id)

                             coef exp(coef) se(coef) robust se      z        p
tr_outcome.lag            0.17918   1.19624  0.01920   0.01968  9.105  &lt; 2e-16
comp_bpsc_y2_moderate.lag 0.15399   1.16648  0.03195   0.03228  4.771 1.83e-06
comp_bpsc_y3_severe.lag   0.52003   1.68207  0.03238   0.03320 15.662  &lt; 2e-16
less_90d_tr1.lag          0.04020   1.04102  0.01800   0.01847  2.176   0.0295
policonsumo2.lag          0.20122   1.22289  0.01985   0.02087  9.640  &lt; 2e-16

Likelihood ratio test=990.1  on 5 df, p=&lt; 2.2e-16
n= 90069, number of events= 17671 
   (72404 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i1<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 6
  term                      estimate std.error robust.se statistic  p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 tr_outcome.lag              0.179     0.0192    0.0197      9.10 8.65e-20
2 comp_bpsc_y2_moderate.lag   0.154     0.0320    0.0323      4.77 1.83e- 6
3 comp_bpsc_y3_severe.lag     0.520     0.0324    0.0332     15.7  2.74e-55
4 less_90d_tr1.lag            0.0402    0.0180    0.0185      2.18 2.95e- 2
5 policonsumo2.lag            0.201     0.0199    0.0209      9.64 5.40e-22</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>i1_df_out<span class="ot">&lt;-</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.179303997546012</span>, <span class="fl">0.155159976117794</span>, <span class="fl">0.522643191348996</span>, </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0396946478038892</span>, <span class="fl">0.200990917537315</span>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0192034667885392</span>, </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0319537357893297</span>, <span class="fl">0.0323780221201328</span>, <span class="fl">0.0180015312824529</span>, <span class="fl">0.0198507378783121</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>), <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0196804675715693</span>, <span class="fl">0.0322870898718578</span>, <span class="fl">0.0332167392234256</span>, </span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0184789094834668</span>, <span class="fl">0.020873477226514</span>), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">9.11075902510759</span>, </span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="fl">4.80563521623034</span>, <span class="fl">15.7343316522896</span>, <span class="fl">2.14810553833841</span>, <span class="fl">9.62900983656</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">8.18076035588734e-20</span>, <span class="fl">1.54260938373677e-06</span>, <span class="fl">8.79807768652411e-56</span>, </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0317053723627336</span>, <span class="fl">6.03077841071276e-22</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It is not necessary to investigate violations of the counting process (progressive times)"</span>)</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Does really PSU in the previous treatment protects?. 2024-04-15: now it make sense, every coeff is HR&gt;1!"</span>)</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>i1b<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag, data = datacox, cluster = id)

                              coef exp(coef) se(coef) robust se       z      p
tr_outcome.lag            0.204432  1.226827 0.018508  0.020385  10.029 &lt;2e-16
comp_bpsc_y2_moderate.lag 0.002844  1.002849 0.031859  0.033560   0.085  0.932
comp_bpsc_y3_severe.lag   1.435238  4.200644 0.030608  0.031895  44.999 &lt;2e-16
less_90d_tr1.lag          1.279551  3.595026 0.011541  0.011892 107.597 &lt;2e-16
policonsumo2.lag          0.840131  2.316670 0.018508  0.021128  39.765 &lt;2e-16

Likelihood ratio test=61818  on 5 df, p=&lt; 2.2e-16
n= 159556, number of events= 87158 
   (2917 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i1b<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 6
  term                      estimate std.error robust.se statistic  p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 tr_outcome.lag             0.204      0.0185    0.0204   10.0    1.14e-23
2 comp_bpsc_y2_moderate.lag  0.00284    0.0319    0.0336    0.0848 9.32e- 1
3 comp_bpsc_y3_severe.lag    1.44       0.0306    0.0319   45.0    0       
4 less_90d_tr1.lag           1.28       0.0115    0.0119  108.     0       
5 policonsumo2.lag           0.840      0.0185    0.0211   39.8    0       </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>i1b_df_out<span class="ot">&lt;-</span><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.204663142678526</span>, <span class="fl">0.00379136822637489</span>, <span class="fl">1.43645954073343</span>, </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fl">1.27844124422329</span>, <span class="fl">0.840329282274339</span>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0185085344588536</span>, </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0318597956273076</span>, <span class="fl">0.0306100046937583</span>, <span class="fl">0.011541793220903</span>, <span class="fl">0.0185082077607319</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.020386616410505</span>, <span class="fl">0.0335664648273184</span>, <span class="fl">0.03190467043629</span>, </span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0118920257355396</span>, <span class="fl">0.0211189171816328</span>), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">10.039093224566</span>, </span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.112951073217852</span>, <span class="fl">45.0234878182453</span>, <span class="fl">107.504076484012</span>, <span class="fl">39.7903583335785</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">1.02613077760236e-23</span>, <span class="fl">0.910069344802066</span>, <span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i1<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3904  1.0000  1.0000  0.9119  1.0000  1.0000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.3896  1.0000  1.0000  0.9118  1.0000  1.0000 </span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>ploti1<span class="ot">&lt;-</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i1<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i1$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i1b<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0233  1.0000  1.0000  0.8543  1.0000  1.0000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co">#0.02329 1.00000 1.00000 0.85417 1.00000 1.00000</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>ploti1b<span class="ot">&lt;-</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i1b<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i1b$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>i1c <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> <span class="co">#less_90d_tr.lag+ </span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc_multtr,</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_multtr_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">formulanull=</span> <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>i1d <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> <span class="co">#less_90d_tr.lag+ </span></span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc_multtr,</span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_multtr_df,<span class="co">#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">formulanull=</span> <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a>i1c<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag, data = datacox, cluster = id)

                              coef exp(coef) se(coef) robust se       z
tr_outcome.lag            -0.30163   0.73961  0.01544   0.01298 -23.240
comp_bpsc_y2_moderate.lag -0.90364   0.40509  0.01902   0.01729 -52.268
comp_bpsc_y3_severe.lag   -0.81206   0.44394  0.01987   0.01813 -44.786
less_90d_tr1.lag          -0.11483   0.89152  0.01764   0.01581  -7.262
policonsumo2.lag          -0.30996   0.73347  0.01596   0.01333 -23.251
                                 p
tr_outcome.lag             &lt; 2e-16
comp_bpsc_y2_moderate.lag  &lt; 2e-16
comp_bpsc_y3_severe.lag    &lt; 2e-16
less_90d_tr1.lag          3.83e-13
policonsumo2.lag           &lt; 2e-16

Likelihood ratio test=7757  on 5 df, p=&lt; 2.2e-16
n= 44272, number of events= 30959 
   (29 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i1c<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 6
  term                      estimate std.error robust.se statistic   p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 tr_outcome.lag              -0.302    0.0154    0.0130    -23.2  1.80e-119
2 comp_bpsc_y2_moderate.lag   -0.904    0.0190    0.0173    -52.3  0        
3 comp_bpsc_y3_severe.lag     -0.812    0.0199    0.0181    -44.8  0        
4 less_90d_tr1.lag            -0.115    0.0176    0.0158     -7.26 3.83e- 13
5 policonsumo2.lag            -0.310    0.0160    0.0133    -23.3  1.40e-119</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>i1c_df_out<span class="ot">&lt;-</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.302245037062739</span>, <span class="sc">-</span><span class="fl">0.903956210807159</span>, <span class="sc">-</span><span class="fl">0.813321897718714</span>, </span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.114245961363377</span>, <span class="sc">-</span><span class="fl">0.308855961637097</span>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0154310846877583</span>, </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0190313654021939</span>, <span class="fl">0.0198660721579724</span>, <span class="fl">0.0176396124863469</span>, <span class="fl">0.015967581763868</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>), <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0129727086353161</span>, <span class="fl">0.0173025650006909</span>, <span class="fl">0.0181205187074852</span>, </span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0158153935544036</span>, <span class="fl">0.0133307124770294</span>), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">23.2985296717391</span>, </span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">52.2440580787336</span>, <span class="sc">-</span><span class="fl">44.8840295825939</span>, <span class="sc">-</span><span class="fl">7.22371915503593</span>, <span class="sc">-</span><span class="fl">23.1687512703688</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">4.58804176323613e-120</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">5.05846724994571e-13</span>, </span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="fl">9.40892053149018e-119</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>i1d<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag, data = datacox, cluster = id)

                              coef exp(coef) se(coef) robust se      z        p
tr_outcome.lag             0.09184   1.09619  0.01891   0.01472  6.240 4.36e-10
comp_bpsc_y2_moderate.lag -0.04619   0.95486  0.03189   0.02286 -2.021   0.0433
comp_bpsc_y3_severe.lag    0.39616   1.48611  0.03135   0.02234 17.736  &lt; 2e-16
less_90d_tr1.lag           0.44917   1.56700  0.01418   0.01230 36.508  &lt; 2e-16
policonsumo2.lag           0.23612   1.26632  0.01918   0.01518 15.553  &lt; 2e-16

Likelihood ratio test=3294  on 5 df, p=&lt; 2.2e-16
n= 43638, number of events= 30325 
   (663 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i1d<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 6
  term                      estimate std.error robust.se statistic   p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 tr_outcome.lag              0.0918    0.0189    0.0147      6.24 4.36e- 10
2 comp_bpsc_y2_moderate.lag  -0.0462    0.0319    0.0229     -2.02 4.33e-  2
3 comp_bpsc_y3_severe.lag     0.396     0.0313    0.0223     17.7  2.23e- 70
4 less_90d_tr1.lag            0.449     0.0142    0.0123     36.5  8.35e-292
5 policonsumo2.lag            0.236     0.0192    0.0152     15.6  1.52e- 54</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>i1d_df_out<span class="ot">&lt;-</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.0914594442348692</span>, <span class="sc">-</span><span class="fl">0.0479067360824922</span>, <span class="fl">0.395018880185181</span>, </span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.449421044097101</span>, <span class="fl">0.237239909387438</span>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0189119890640763</span>, </span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0318880405199674</span>, <span class="fl">0.0313463499911823</span>, <span class="fl">0.0141743240908896</span>, <span class="fl">0.0191755226262578</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>), <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0147135065696911</span>, <span class="fl">0.0228906898308705</span>, <span class="fl">0.0223775814909527</span>, </span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0123024239813926</span>, <span class="fl">0.0151689053922935</span>), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">6.21601953291473</span>, </span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">2.09284807214001</span>, <span class="fl">17.6524384614525</span>, <span class="fl">36.5310970242003</span>, <span class="fl">15.6398832514288</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">5.09924589471951e-10</span>, <span class="fl">0.0363627189586838</span>, <span class="fl">9.74559709383605e-70</span>, </span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="fl">3.55949649474628e-292</span>, <span class="fl">3.89441388490098e-55</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i1c<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   3.046   2.660   4.152   5.104 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1.000   1.000   3.051   2.660   4.155   5.100 </span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>ploti1c<span class="ot">&lt;-</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i1c<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i1c$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i1d<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3093  0.3093  0.3917  0.4846  0.6729  1.0473 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.3094  0.3094  0.3922  0.4848  0.6737  1.0491 </span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>ploti1d<span class="ot">&lt;-</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i1d<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i1d$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now we use the 'data_mine_miss_proc' and try to dummify previous events"</span>)</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>i2 <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> treatment<span class="sc">+</span><span class="co">#less_90d_tr.lag+ </span></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(hash_key),</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>, <span class="st">"treatment"</span>),</span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">formulanull=</span> <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb163-28"><a href="#cb163-28" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb163-29"><a href="#cb163-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-30"><a href="#cb163-30" aria-hidden="true" tabindex="-1"></a>i2<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + treatment, data = datacox, cluster = hash_key)

                              coef exp(coef) se(coef) robust se       z
tr_outcome.lag            -0.20589   0.81392  0.01573   0.01912 -10.771
comp_bpsc_y2_moderate.lag -0.79538   0.45141  0.01931   0.02541 -31.300
comp_bpsc_y3_severe.lag   -0.64342   0.52549  0.02049   0.02735 -23.522
less_90d_tr1.lag           0.16432   1.17859  0.01785   0.02055   7.997
policonsumo2.lag          -0.49413   0.61010  0.01610   0.01925 -25.668
treatment                 -0.26432   0.76772  0.01253   0.01588 -16.644
                                 p
tr_outcome.lag             &lt; 2e-16
comp_bpsc_y2_moderate.lag  &lt; 2e-16
comp_bpsc_y3_severe.lag    &lt; 2e-16
less_90d_tr1.lag          1.28e-15
policonsumo2.lag           &lt; 2e-16
treatment                  &lt; 2e-16

Likelihood ratio test=18907  on 6 df, p=&lt; 2.2e-16
n= 89925, number of events= 89925 
   (72548 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i2<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic   p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 tr_outcome.lag              -0.206    0.0157    0.0191    -10.8  4.73e- 27
2 comp_bpsc_y2_moderate.lag   -0.795    0.0193    0.0254    -31.3  4.67e-215
3 comp_bpsc_y3_severe.lag     -0.643    0.0205    0.0274    -23.5  2.43e-122
4 less_90d_tr1.lag             0.164    0.0179    0.0205      8.00 1.28e- 15
5 policonsumo2.lag            -0.494    0.0161    0.0193    -25.7  2.64e-145
6 treatment                   -0.264    0.0125    0.0159    -16.6  3.36e- 62</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>i2_df_out<span class="ot">&lt;-</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, </span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="st">"treatment"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.207821827365346</span>, <span class="sc">-</span><span class="fl">0.795634053728106</span>, </span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.645100128805644</span>, <span class="fl">0.165468256440595</span>, <span class="sc">-</span><span class="fl">0.492699340028085</span>, <span class="sc">-</span><span class="fl">0.263268962510958</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0157193638381784</span>, <span class="fl">0.0193245384394512</span>, <span class="fl">0.0204926882142567</span>, </span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0178456628682898</span>, <span class="fl">0.0161016116581923</span>, <span class="fl">0.0125485993898615</span>), </span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0190740908371374</span>, <span class="fl">0.0254091936208088</span>, <span class="fl">0.0272893127250465</span>, </span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0205418969887765</span>, <span class="fl">0.019247319556775</span>, <span class="fl">0.0157928620459193</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">10.8955037039414</span>, <span class="sc">-</span><span class="fl">31.3128415486796</span>, <span class="sc">-</span><span class="fl">23.6392955478708</span>, </span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">8.05515948848355</span>, <span class="sc">-</span><span class="fl">25.5983353201332</span>, <span class="sc">-</span><span class="fl">16.6701236131537</span>), </span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">1.21094635824601e-27</span>, <span class="fl">3.120318630146e-215</span>, <span class="fl">1.52095150935808e-123</span>, </span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">7.93752420512666e-16</span>, <span class="fl">1.5920600972545e-144</span>, <span class="fl">2.1614709120083e-62</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>    ))<span class="sc">%&gt;%</span> </span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Does really previous dropout protect dropout?"</span>) </span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"maybe because lagfirst was 0"</span>)</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Does really Severe previous biopsychosocial is a protective factor of dropout?"</span>)</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Does really 0-90 days in previous treatment is a protective factor of dropout?"</span>)</span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Does really PSU in previous treatment is a protective factor of dropout?"</span>)</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Does really more treatments protect dropout?"</span>)</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i2<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    1.00    1.00    1.72    1.00   44.92 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 1.00    1.00    1.00    1.72    1.00   44.54 </span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>ploti2<span class="ot">&lt;-</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i2<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i2$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Some extreme weights"</span>)</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>i3 <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> policonsumo2<span class="sc">+</span></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df, <span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>i3<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + policonsumo2, data = datacox, cluster = id)

                               coef exp(coef)  se(coef) robust se       z
tr_outcome.lag            -0.283314  0.753283  0.014943  0.018002 -15.738
comp_bpsc_y2_moderate.lag -0.916036  0.400102  0.017794  0.022331 -41.021
comp_bpsc_y3_severe.lag   -0.792492  0.452715  0.018677  0.023748 -33.370
less_90d_tr1.lag           0.116079  1.123085  0.017666  0.020221   5.741
policonsumo2.lag          -0.572257  0.564251  0.015723  0.018761 -30.502
policonsumo2               0.164367  1.178647  0.007740  0.007572  21.706
                                 p
tr_outcome.lag             &lt; 2e-16
comp_bpsc_y2_moderate.lag  &lt; 2e-16
comp_bpsc_y3_severe.lag    &lt; 2e-16
less_90d_tr1.lag          9.44e-09
policonsumo2.lag           &lt; 2e-16
policonsumo2               &lt; 2e-16

Likelihood ratio test=18879  on 6 df, p=&lt; 2.2e-16
n= 89925, number of events= 89925 
   (72548 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i3<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic   p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 tr_outcome.lag              -0.283   0.0149    0.0180     -15.7  8.36e- 56
2 comp_bpsc_y2_moderate.lag   -0.916   0.0178    0.0223     -41.0  0        
3 comp_bpsc_y3_severe.lag     -0.792   0.0187    0.0237     -33.4  3.68e-244
4 less_90d_tr1.lag             0.116   0.0177    0.0202       5.74 9.44e-  9
5 policonsumo2.lag            -0.572   0.0157    0.0188     -30.5  2.42e-204
6 policonsumo2                 0.164   0.00774   0.00757     21.7  1.80e-104</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>i3_df_out<span class="ot">&lt;-</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, <span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, <span class="st">"policonsumo2"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.285082046756843</span>, <span class="sc">-</span><span class="fl">0.916585948362177</span>, </span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.795077921451114</span>, <span class="fl">0.11763808302626</span>, <span class="sc">-</span><span class="fl">0.569791427138684</span>, <span class="fl">0.164345823420033</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.01492765131367</span>, <span class="fl">0.0178053744947168</span>, <span class="fl">0.0186611556090444</span>, </span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0176615698524595</span>, <span class="fl">0.0157351197601704</span>, <span class="fl">0.00773975706029995</span>), </span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0179877493992649</span>, <span class="fl">0.0223101496182252</span>, <span class="fl">0.0236349676291152</span>, </span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0202282450263194</span>, <span class="fl">0.0186724156095066</span>, <span class="fl">0.00757289335696934</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">15.8486779212352</span>, <span class="sc">-</span><span class="fl">41.0838100168282</span>, <span class="sc">-</span><span class="fl">33.639898895892</span>, </span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">5.81553579528025</span>, <span class="sc">-</span><span class="fl">30.5151427139716</span>, <span class="fl">21.7018536605676</span>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">1.43569566146437e-56</span>, </span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="fl">4.38118085650704e-248</span>, <span class="fl">6.04399775632908e-09</span>, <span class="fl">1.64100047755937e-204</span>, </span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.97056906465211e-104</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Previous dropout prevents actual dropout?"</span>)</span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"maybe because lagfirst was 0"</span>)</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Severe biopsychosocial compromise is a risk factor of actual dropout?"</span>)</span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous PSU prevents actual dropout?"</span>)</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i3<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.7554  1.0000  1.0000  1.5860  1.0000  5.8803 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.7543  1.0000  1.0000  1.5863  1.0000  5.8794 </span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>ploti3<span class="ot">&lt;-</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i3<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i3$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Reasonable weights"</span>)</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>i3b <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> policonsumo2<span class="sc">+</span></span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a>i3b<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + policonsumo2, data = datacox, cluster = id)

                              coef exp(coef) se(coef) robust se      z        p
tr_outcome.lag            0.171974  1.187647 0.018876  0.017987  9.561  &lt; 2e-16
comp_bpsc_y2_moderate.lag 0.008456  1.008491 0.031855  0.029226  0.289    0.772
comp_bpsc_y3_severe.lag   0.597821  1.818153 0.030962  0.028960 20.643  &lt; 2e-16
less_90d_tr1.lag          0.855059  2.351514 0.012903  0.014455 59.154  &lt; 2e-16
policonsumo2.lag          0.123359  1.131291 0.019003  0.020580  5.994 2.04e-09
policonsumo2              0.062995  1.065021 0.007827  0.007610  8.277  &lt; 2e-16

Likelihood ratio test=13404  on 6 df, p=&lt; 2.2e-16
n= 87158, number of events= 87158 
   (75315 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i3b<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic  p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 tr_outcome.lag             0.172     0.0189    0.0180      9.56  1.17e-21
2 comp_bpsc_y2_moderate.lag  0.00846   0.0319    0.0292      0.289 7.72e- 1
3 comp_bpsc_y3_severe.lag    0.598     0.0310    0.0290     20.6   1.13e-94
4 less_90d_tr1.lag           0.855     0.0129    0.0145     59.2   0       
5 policonsumo2.lag           0.123     0.0190    0.0206      5.99  2.04e- 9
6 policonsumo2               0.0630    0.00783   0.00761     8.28  1.26e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>i3b_df_out<span class="ot">&lt;-</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, <span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, <span class="st">"policonsumo2"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.171524496903936</span>, <span class="fl">0.00483620529764353</span>, <span class="fl">0.596008396206245</span>, <span class="fl">0.855542927694904</span>, <span class="fl">0.125702439454889</span>, <span class="fl">0.0627347379496959</span>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.018874296525738</span>, <span class="fl">0.0318585598048639</span>, <span class="fl">0.0309630894506515</span>, <span class="fl">0.0128979749956164</span>, <span class="fl">0.0189962053653323</span>, <span class="fl">0.00782722711322035</span>), <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0179913060388931</span>, <span class="fl">0.0292985300929012</span>, <span class="fl">0.0290119903127091</span>, <span class="fl">0.0144451828760062</span>, <span class="fl">0.020549409265887</span>, <span class="fl">0.00759613906581795</span>), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">9.53374349439331</span>, <span class="fl">0.165066482253842</span>, <span class="fl">20.543519757938</span>, <span class="fl">59.2268671873984</span>, <span class="fl">6.11708287223425</span>, <span class="fl">8.2587663819897</span>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">1.51711569984396e-21</span>, <span class="fl">0.868891654364147</span>, <span class="fl">8.79518334988573e-94</span>, <span class="dv">0</span>, <span class="fl">9.53038111046381e-10</span>, <span class="fl">1.47185680747056e-16</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous dropout transform to nothing; 2024-04-16: dropping out previously is a risk factor"</span>)</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous PSU still protects an actual dropout; 2024-04-16: previous PSU is a risk factor"</span>)</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous severe biopsuchosocial still is a risk factor; 2024-04-16: severe biopsychosocial, risk factor (80%+)"</span>)</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"now less than 90 days in treatment its a risk factor; 2024-04-16: less than 90 days tr. previously, risk factor of being observed posteriorly (readmission) (x2.3)"</span>)</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i3b<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1635  1.0000  1.0000  0.9053  1.0000  1.0000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1634  1.0000  1.0000  0.9055  1.0000  1.0000 </span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>ploti3b<span class="ot">&lt;-</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i3b<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i3b$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Many 0s or near 0s"</span>)</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>i3_nolag <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> policonsumo2<span class="sc">+</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df, <span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a>      <span class="co">#lagfirst= rep(1,6),</span></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-danger">
<p>Error in shift(.SD, fill = lagfirst[col]): entrada en evaluacion: recursivo por defecto o problemas anteriores?</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Here, i didnt specified lagfirst"</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Error in shift(.SD, fill = lagfirst[col]) : </span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   entrada en evaluacion: recursivo por defecto o problemas anteriores?</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It gives an error"</span>)</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"We format the data to include non-events; 2024-04-16: this is no longer useful because we are including every record (all event=1)"</span>)</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="co"># data_mine2_miss &lt;- Base_fiscalia_v15f_grant_23_24_long2_miss_proc</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="co"># data_mine2_miss_proc &lt;-  </span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a><span class="co"># data_mine2_miss %&gt;% </span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::mutate(comp_bpsc_y2_moderate= ifelse(as.character(comp_bpsc_y)=="2-Moderate",1,0),</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a><span class="co">#           comp_bpsc_y3_severe= ifelse(as.character(comp_bpsc_y)=="3-Severe",1,0),</span></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a><span class="co">#           less_90d_tr1= ifelse(less_90d_tr==1,1,0)) %&gt;% data.frame() </span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>i4 <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> treatment.lag<span class="sc">+</span></span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(hash_key),</span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>, <span class="st">"treatment"</span>),</span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>),</span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb182-33"><a href="#cb182-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-34"><a href="#cb182-34" aria-hidden="true" tabindex="-1"></a>i4<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + treatment.lag, data = datacox, cluster = hash_key)

                              coef exp(coef) se(coef) robust se       z
tr_outcome.lag            -0.20589   0.81392  0.01573   0.01912 -10.771
comp_bpsc_y2_moderate.lag -0.79538   0.45141  0.01931   0.02541 -31.300
comp_bpsc_y3_severe.lag   -0.64342   0.52549  0.02049   0.02735 -23.522
less_90d_tr1.lag           0.16432   1.17859  0.01785   0.02055   7.997
policonsumo2.lag          -0.49413   0.61010  0.01610   0.01925 -25.668
treatment.lag             -0.26432   0.76772  0.01253   0.01588 -16.644
                                 p
tr_outcome.lag             &lt; 2e-16
comp_bpsc_y2_moderate.lag  &lt; 2e-16
comp_bpsc_y3_severe.lag    &lt; 2e-16
less_90d_tr1.lag          1.28e-15
policonsumo2.lag           &lt; 2e-16
treatment.lag              &lt; 2e-16

Likelihood ratio test=18907  on 6 df, p=&lt; 2.2e-16
n= 89925, number of events= 89925 
   (72548 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i4<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic   p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 tr_outcome.lag              -0.206    0.0157    0.0191    -10.8  4.73e- 27
2 comp_bpsc_y2_moderate.lag   -0.795    0.0193    0.0254    -31.3  4.67e-215
3 comp_bpsc_y3_severe.lag     -0.643    0.0205    0.0274    -23.5  2.43e-122
4 less_90d_tr1.lag             0.164    0.0179    0.0205      8.00 1.28e- 15
5 policonsumo2.lag            -0.494    0.0161    0.0193    -25.7  2.64e-145
6 treatment.lag               -0.264    0.0125    0.0159    -16.6  3.36e- 62</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>i4_df_out<span class="ot">&lt;-</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, </span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="st">"treatment.lag"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.207821827365346</span>, <span class="sc">-</span><span class="fl">0.795634053728106</span>, </span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.645100128805644</span>, <span class="fl">0.165468256440595</span>, <span class="sc">-</span><span class="fl">0.492699340028085</span>, <span class="sc">-</span><span class="fl">0.263268962510958</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0157193638381784</span>, <span class="fl">0.0193245384394512</span>, <span class="fl">0.0204926882142567</span>, </span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0178456628682898</span>, <span class="fl">0.0161016116581923</span>, <span class="fl">0.0125485993898615</span>), </span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0190740908371374</span>, <span class="fl">0.0254091936208087</span>, <span class="fl">0.0272893127250465</span>, </span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0205418969887765</span>, <span class="fl">0.019247319556775</span>, <span class="fl">0.0157928620459193</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">10.8955037039414</span>, <span class="sc">-</span><span class="fl">31.3128415486796</span>, <span class="sc">-</span><span class="fl">23.6392955478708</span>, </span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">8.05515948848355</span>, <span class="sc">-</span><span class="fl">25.5983353201332</span>, <span class="sc">-</span><span class="fl">16.6701236131537</span>), </span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">1.21094635824605e-27</span>, <span class="fl">3.12031863014138e-215</span>, </span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.52095150935808e-123</span>, <span class="fl">7.93752420512701e-16</span>, <span class="fl">1.59206009725477e-144</span>, </span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>    <span class="fl">2.16147091200972e-62</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Previous dropout protects posterior dropout, but 95% CI does not replicate that; prev. dropouts protects posterior obs."</span>)</span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Moderate previous biopsychosocial status protects actual dropout; both severe and moderate pro"</span>)</span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Severe previous biopsychosocial status protects actual dropout"</span>)</span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"0-90 days in previous tr. predicts actual dropout"</span>)</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous PSU protects actual dropout"</span>)</span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i4<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    1.00    1.00    1.72    1.00   44.92 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.00    1.00    1.00    1.72    1.00   44.54  #2024-04-16: muy bizarro que haya un caso con probabilidades muy altas</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>ploti4<span class="ot">&lt;-</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i4<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i4$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Reasonable, some positive outliers but very big"</span>)</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>i4b <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> treatment.lag<span class="sc">+</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>, <span class="st">"treatment"</span>),</span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a>i4b<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + treatment.lag, data = datacox, cluster = id)

                               coef exp(coef)  se(coef) robust se       z
tr_outcome.lag             0.203911  1.226189  0.018495  0.020208  10.091
comp_bpsc_y2_moderate.lag -0.001234  0.998767  0.031861  0.033417  -0.037
comp_bpsc_y3_severe.lag    1.426373  4.163571  0.030614  0.031776  44.888
less_90d_tr1.lag           1.273223  3.572347  0.011538  0.011872 107.246
policonsumo2.lag           0.846049  2.330422  0.018511  0.020888  40.503
treatment.lag              0.145624  1.156762  0.011528  0.015317   9.507
                               p
tr_outcome.lag            &lt;2e-16
comp_bpsc_y2_moderate.lag  0.971
comp_bpsc_y3_severe.lag   &lt;2e-16
less_90d_tr1.lag          &lt;2e-16
policonsumo2.lag          &lt;2e-16
treatment.lag             &lt;2e-16

Likelihood ratio test=61967  on 6 df, p=&lt; 2.2e-16
n= 159556, number of events= 87158 
   (2917 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i4b<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic  p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 tr_outcome.lag             0.204      0.0185    0.0202   10.1    6.07e-24
2 comp_bpsc_y2_moderate.lag -0.00123    0.0319    0.0334   -0.0369 9.71e- 1
3 comp_bpsc_y3_severe.lag    1.43       0.0306    0.0318   44.9    0       
4 less_90d_tr1.lag           1.27       0.0115    0.0119  107.     0       
5 policonsumo2.lag           0.846      0.0185    0.0209   40.5    0       
6 treatment.lag              0.146      0.0115    0.0153    9.51   1.96e-21</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>i4b_df_out<span class="ot">&lt;-</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, </span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="st">"treatment.lag"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.204102531211081</span>, <span class="sc">-</span><span class="fl">0.000387761814109535</span>, </span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fl">1.42748577725764</span>, <span class="fl">1.27218207100866</span>, <span class="fl">0.846223498441861</span>, <span class="fl">0.145344423972201</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0184955717163036</span>, <span class="fl">0.0318615324506995</span>, <span class="fl">0.0306160739199961</span>, </span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.011538166117299</span>, <span class="fl">0.0185111088069143</span>, <span class="fl">0.0115312169046261</span>), <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0202100857453012</span>, </span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0334267319824861</span>, <span class="fl">0.0317905279138096</span>, <span class="fl">0.0118704233236429</span>, <span class="fl">0.0208804874610975</span>, </span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0153330805627965</span>), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">10.0990433085389</span>, <span class="sc">-</span><span class="fl">0.0116003507107037</span>, </span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="fl">44.9028648133129</span>, <span class="fl">107.172426485818</span>, <span class="fl">40.5269991909175</span>, <span class="fl">9.47914043606206</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">5.5783718456834e-24</span>, <span class="fl">0.990744466851805</span>, <span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>, <span class="fl">2.56386267293478e-21</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Previous dropout now predicts actual dropout"</span>)</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Moderate previous biopsychosocial status does not [2024-04-16] predict actual dropout"</span>)</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Severe previous biopsychosocial status predict actual dropout"</span>)</span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"0-90 days in previous tr. predicts actual dropout"</span>)</span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous PSU predicts posterior dropout"</span>)</span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"more treatments can be a protective factor for subsequent treatments [2024-04-16]"</span>)</span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i4b<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.008675 1.000000 1.000000 0.853592 1.000000 1.023063 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">#     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.008687 1.000000 1.000000 0.853483 1.000000 1.022155 </span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>ploti4b<span class="ot">&lt;-</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i4b<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i4b$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Reasonable"</span>)</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a><span class="co">#2024-04-16: no longer useful</span></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="co"># data_mine2_miss_proc_multtr&lt;-</span></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     data_mine2_miss_proc %&gt;% </span></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::group_by(hash_key) %&gt;% dplyr::mutate(n=n()) %&gt;% dplyr::ungroup() %&gt;% dplyr::filter(case_when(n&gt;1~ T,T~F)) %&gt;% data.frame()</span></span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a><span class="co"># paste0("The original database had ",</span></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a><span class="co">#        format(length(unique(data_mine2_miss_proc$hash_key)), big.mark=","),</span></span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a><span class="co">#        " patients and ",</span></span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a><span class="co">#        format(length(data_mine2_miss_proc$hash_key), big.mark=","),</span></span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a><span class="co">#        " observations with only events, but keeping patients with more than one treatment left only ",</span></span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a><span class="co">#        format(length(unique(data_mine2_miss_proc_multtr$hash_key)), big.mark=","),</span></span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a><span class="co">#        " patients and ",</span></span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a><span class="co">#        format(length(data_mine2_miss_proc_multtr$hash_key), big.mark=","),</span></span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a><span class="co">#        " observations"</span></span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a><span class="co">#        )</span></span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>i4c <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> treatment.lag<span class="sc">+</span></span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc_multtr,</span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>, <span class="st">"treatment"</span>),</span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_multtr_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>),<span class="co"># c(1,1,0,1,1,1,1),</span></span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a>      <span class="co">#formulanull= Surv(time.lag,time,event)~ 1,</span></span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-52"><a href="#cb194-52" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"FORMULANULL entrega ponderaciones y coeficientes iguales a sin formulanull"</span>)</span>
<span id="cb194-53"><a href="#cb194-53" aria-hidden="true" tabindex="-1"></a>i4c<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + treatment.lag, data = datacox, cluster = id)

                              coef exp(coef) se(coef) robust se       z
tr_outcome.lag             0.02895   1.02937  0.01743   0.01596   1.814
comp_bpsc_y2_moderate.lag -0.28716   0.75039  0.02330   0.02407 -11.928
comp_bpsc_y3_severe.lag   -0.12854   0.87938  0.02427   0.02515  -5.112
less_90d_tr1.lag           0.12332   1.13125  0.01801   0.01722   7.162
policonsumo2.lag          -0.18087   0.83454  0.01788   0.01620 -11.167
treatment.lag             -1.33538   0.26306  0.01551   0.02788 -47.895
                                 p
tr_outcome.lag              0.0697
comp_bpsc_y2_moderate.lag  &lt; 2e-16
comp_bpsc_y3_severe.lag   3.19e-07
less_90d_tr1.lag          7.94e-13
policonsumo2.lag           &lt; 2e-16
treatment.lag              &lt; 2e-16

Likelihood ratio test=16880  on 6 df, p=&lt; 2.2e-16
n= 44272, number of events= 30959 
   (29 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i4c<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic  p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 tr_outcome.lag              0.0290    0.0174    0.0160      1.81 6.97e- 2
2 comp_bpsc_y2_moderate.lag  -0.287     0.0233    0.0241    -11.9  8.48e-33
3 comp_bpsc_y3_severe.lag    -0.129     0.0243    0.0251     -5.11 3.19e- 7
4 less_90d_tr1.lag            0.123     0.0180    0.0172      7.16 7.94e-13
5 policonsumo2.lag           -0.181     0.0179    0.0162    -11.2  5.91e-29
6 treatment.lag              -1.34      0.0155    0.0279    -47.9  0       </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>i4c_df_out<span class="ot">&lt;-</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, </span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="st">"treatment.lag"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.0283175141261873</span>, <span class="sc">-</span><span class="fl">0.286052899938312</span>, </span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.12762290937749</span>, <span class="fl">0.123676646115759</span>, <span class="sc">-</span><span class="fl">0.18046907845805</span>, <span class="sc">-</span><span class="fl">1.33577820010306</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0174225204858456</span>, <span class="fl">0.0232998089273985</span>, <span class="fl">0.0242539101271994</span>, </span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0180040024564168</span>, <span class="fl">0.0178722433414989</span>, <span class="fl">0.0155176207475381</span>), </span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0159600395125907</span>, <span class="fl">0.0240699432379503</span>, <span class="fl">0.0251576808692291</span>, </span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0172158438569811</span>, <span class="fl">0.016189953421006</span>, <span class="fl">0.0278980099478121</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">1.77427594109952</span>, <span class="sc">-</span><span class="fl">11.884236581302</span>, <span class="sc">-</span><span class="fl">5.07292027595389</span>, </span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">7.18388521313221</span>, <span class="sc">-</span><span class="fl">11.1469794733255</span>, <span class="sc">-</span><span class="fl">47.8807700836676</span>), </span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">0.0760175181238697</span>, <span class="fl">1.42935024171782e-32</span>, <span class="fl">3.91756657551751e-07</span>, </span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">6.77577589606902e-13</span>, <span class="fl">7.40784798532889e-29</span>, <span class="dv">0</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Risk factors: previous dropout, &lt;90 days previous treatment; protective: previous PSU!!!!, previous treatments"</span>)</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>i4d <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> treatment.lag<span class="sc">+</span></span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc_multtr,</span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>, <span class="st">"treatment"</span>),</span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_multtr_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="co"># </span></span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>      <span class="co">#formulanull= Surv(time.lag,time,event)~ 1,</span></span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb198-35"><a href="#cb198-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-36"><a href="#cb198-36" aria-hidden="true" tabindex="-1"></a>i4d<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + treatment.lag, data = datacox, cluster = id)

                               coef exp(coef)  se(coef) robust se       z
tr_outcome.lag             0.132783  1.142003  0.019040  0.016285   8.154
comp_bpsc_y2_moderate.lag  0.003703  1.003710  0.031880  0.025639   0.144
comp_bpsc_y3_severe.lag    0.479705  1.615598  0.031391  0.025947  18.488
less_90d_tr1.lag           0.589226  1.802592  0.014530  0.014917  39.500
policonsumo2.lag           0.103722  1.109292  0.019252  0.018027   5.754
treatment.lag             -1.346903  0.260044  0.016631  0.032231 -41.789
                                 p
tr_outcome.lag            3.52e-16
comp_bpsc_y2_moderate.lag    0.885
comp_bpsc_y3_severe.lag    &lt; 2e-16
less_90d_tr1.lag           &lt; 2e-16
policonsumo2.lag          8.72e-09
treatment.lag              &lt; 2e-16

Likelihood ratio test=11563  on 6 df, p=&lt; 2.2e-16
n= 43638, number of events= 30325 
   (663 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i4d<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic  p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 tr_outcome.lag             0.133      0.0190    0.0163     8.15  3.52e-16
2 comp_bpsc_y2_moderate.lag  0.00370    0.0319    0.0256     0.144 8.85e- 1
3 comp_bpsc_y3_severe.lag    0.480      0.0314    0.0259    18.5   2.58e-76
4 less_90d_tr1.lag           0.589      0.0145    0.0149    39.5   0       
5 policonsumo2.lag           0.104      0.0193    0.0180     5.75  8.72e- 9
6 treatment.lag             -1.35       0.0166    0.0322   -41.8   0       </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>i4d_df_out<span class="ot">&lt;-</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, </span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="st">"treatment.lag"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.132485185827427</span>, <span class="fl">0.00411115497188839</span>, </span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.481109354943001</span>, <span class="fl">0.58947698342646</span>, <span class="fl">0.105500181664414</span>, <span class="sc">-</span><span class="fl">1.34747522983601</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0190393190327229</span>, <span class="fl">0.0318822421857093</span>, <span class="fl">0.0313896070698578</span>, </span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0145276202543287</span>, <span class="fl">0.0192443206789934</span>, <span class="fl">0.0166349222671111</span>), </span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0162768310200937</span>, <span class="fl">0.0256183384356621</span>, <span class="fl">0.0259237137593143</span>, </span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0149119908677786</span>, <span class="fl">0.0180095159064235</span>, <span class="fl">0.0322392535580045</span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">8.13949506902635</span>, <span class="fl">0.160477034145409</span>, <span class="fl">18.5586586632535</span>, </span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">39.5304013161775</span>, <span class="fl">5.85802429185703</span>, <span class="sc">-</span><span class="fl">41.7961050931792</span>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">3.96929765929241e-16</span>, </span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.87250531125718</span>, <span class="fl">6.94162601178333e-77</span>, <span class="dv">0</span>, <span class="fl">4.68406148676732e-09</span>, </span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-19"><a href="#cb202-19" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Razonable: abandono previo, compromiso severo previo, menos de 90 días y policonsumo previo son predictores de readmisiones; no así el recuento de tratamientos (esto con lag 1's)"</span>)</span>
<span id="cb202-20"><a href="#cb202-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-21"><a href="#cb202-21" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb202-22"><a href="#cb202-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-23"><a href="#cb202-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-24"><a href="#cb202-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i4c<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
    0.19     0.19     0.86     4.91     1.14 49523.91 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.19     0.19     0.86     4.91     1.13 49631.97 </span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>ploti4c<span class="ot">&lt;-</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i4c<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i4c$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"highly extreme values"</span>)</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i4d<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
    0.131     0.131     0.210     1.515     0.379 18136.282 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.130     0.130     0.210     1.516     0.378 18179.444 </span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>ploti4d<span class="ot">&lt;-</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i4d<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i4d$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">" highly extreme values"</span>)</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>i5 <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> policonsumo2<span class="sc">+</span></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co">#12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb206-25"><a href="#cb206-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb206-26"><a href="#cb206-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb206-27"><a href="#cb206-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-28"><a href="#cb206-28" aria-hidden="true" tabindex="-1"></a>i5<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + policonsumo2, data = datacox, cluster = id)

                               coef exp(coef)  se(coef) robust se       z
tr_outcome.lag            -0.283314  0.753283  0.014943  0.018002 -15.738
comp_bpsc_y2_moderate.lag -0.916036  0.400102  0.017794  0.022331 -41.021
comp_bpsc_y3_severe.lag   -0.792492  0.452715  0.018677  0.023748 -33.370
less_90d_tr1.lag           0.116079  1.123085  0.017666  0.020221   5.741
policonsumo2.lag          -0.572257  0.564251  0.015723  0.018761 -30.502
policonsumo2               0.164367  1.178647  0.007740  0.007572  21.706
                                 p
tr_outcome.lag             &lt; 2e-16
comp_bpsc_y2_moderate.lag  &lt; 2e-16
comp_bpsc_y3_severe.lag    &lt; 2e-16
less_90d_tr1.lag          9.44e-09
policonsumo2.lag           &lt; 2e-16
policonsumo2               &lt; 2e-16

Likelihood ratio test=18879  on 6 df, p=&lt; 2.2e-16
n= 89925, number of events= 89925 
   (72548 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i5<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic   p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 tr_outcome.lag              -0.283   0.0149    0.0180     -15.7  8.36e- 56
2 comp_bpsc_y2_moderate.lag   -0.916   0.0178    0.0223     -41.0  0        
3 comp_bpsc_y3_severe.lag     -0.792   0.0187    0.0237     -33.4  3.68e-244
4 less_90d_tr1.lag             0.116   0.0177    0.0202       5.74 9.44e-  9
5 policonsumo2.lag            -0.572   0.0157    0.0188     -30.5  2.42e-204
6 policonsumo2                 0.164   0.00774   0.00757     21.7  1.80e-104</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>i5_df_out<span class="ot">&lt;-</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, </span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="st">"policonsumo2"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.285082046756843</span>, <span class="sc">-</span><span class="fl">0.916585948362177</span>, </span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.795077921451114</span>, <span class="fl">0.11763808302626</span>, <span class="sc">-</span><span class="fl">0.569791427138684</span>, <span class="fl">0.164345823420033</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.01492765131367</span>, <span class="fl">0.0178053744947168</span>, <span class="fl">0.0186611556090444</span>, </span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0176615698524595</span>, <span class="fl">0.0157351197601704</span>, <span class="fl">0.00773975706029995</span>), </span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0179877493992649</span>, <span class="fl">0.0223101496182252</span>, <span class="fl">0.0236349676291152</span>, </span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0202282450263194</span>, <span class="fl">0.0186724156095066</span>, <span class="fl">0.00757289335696934</span></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">15.8486779212352</span>, <span class="sc">-</span><span class="fl">41.0838100168282</span>, <span class="sc">-</span><span class="fl">33.639898895892</span>, </span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">5.81553579528025</span>, <span class="sc">-</span><span class="fl">30.5151427139716</span>, <span class="fl">21.7018536605676</span>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">1.43569566146437e-56</span>, </span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="fl">4.38118085650704e-248</span>, <span class="fl">6.04399775632908e-09</span>, <span class="fl">1.64100047755937e-204</span>, </span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.97056906465211e-104</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Previous dropout protects posterior dropout, but 95% CI does not replicate that; 2024-04-16= protects from being observed and 95% cis too"</span>)</span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Moderate previous biopsychosocial status protects actual dropout"</span>)</span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Severe previous biopsychosocial status protects actual dropout"</span>)</span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"0-90 days in previous tr. predicts actual dropout"</span>)</span>
<span id="cb210-23"><a href="#cb210-23" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous PSU protects actual dropout"</span>)</span>
<span id="cb210-24"><a href="#cb210-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-25"><a href="#cb210-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb210-26"><a href="#cb210-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb210-27"><a href="#cb210-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-28"><a href="#cb210-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i5<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.7554  1.0000  1.0000  1.5860  1.0000  5.8803 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.7543  1.0000  1.0000  1.5863  1.0000  5.8794 </span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>ploti5<span class="ot">&lt;-</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i5<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i5$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Reasonable, but still there are some bit extreme values"</span>)</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>i5b <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y2_moderate.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> policonsumo2<span class="sc">+</span></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cluster</span>(id),</span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc,</span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="st">"id"</span>,</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y2_moderate"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df,<span class="co"># 12*12,#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>i5b<span class="sc">$</span>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    comp_bpsc_y2_moderate.lag + comp_bpsc_y3_severe.lag + less_90d_tr1.lag + 
    policonsumo2.lag + policonsumo2, data = datacox, cluster = id)

                              coef exp(coef) se(coef) robust se      z        p
tr_outcome.lag            0.171974  1.187647 0.018876  0.017987  9.561  &lt; 2e-16
comp_bpsc_y2_moderate.lag 0.008456  1.008491 0.031855  0.029226  0.289    0.772
comp_bpsc_y3_severe.lag   0.597821  1.818153 0.030962  0.028960 20.643  &lt; 2e-16
less_90d_tr1.lag          0.855059  2.351514 0.012903  0.014455 59.154  &lt; 2e-16
policonsumo2.lag          0.123359  1.131291 0.019003  0.020580  5.994 2.04e-09
policonsumo2              0.062995  1.065021 0.007827  0.007610  8.277  &lt; 2e-16

Likelihood ratio test=13404  on 6 df, p=&lt; 2.2e-16
n= 87158, number of events= 87158 
   (75315 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(i5b<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  term                      estimate std.error robust.se statistic  p.value
  &lt;chr&gt;                        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 tr_outcome.lag             0.172     0.0189    0.0180      9.56  1.17e-21
2 comp_bpsc_y2_moderate.lag  0.00846   0.0319    0.0292      0.289 7.72e- 1
3 comp_bpsc_y3_severe.lag    0.598     0.0310    0.0290     20.6   1.13e-94
4 less_90d_tr1.lag           0.855     0.0129    0.0145     59.2   0       
5 policonsumo2.lag           0.123     0.0190    0.0206      5.99  2.04e- 9
6 policonsumo2               0.0630    0.00783   0.00761     8.28  1.26e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>i5b_df_out<span class="ot">&lt;-</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y2_moderate.lag"</span>, </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, </span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="st">"policonsumo2"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">0.171524496903936</span>, <span class="fl">0.00483620529764353</span>, </span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="fl">0.596008396206245</span>, <span class="fl">0.855542927694904</span>, <span class="fl">0.125702439454889</span>, <span class="fl">0.0627347379496959</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.018874296525738</span>, <span class="fl">0.0318585598048639</span>, <span class="fl">0.0309630894506515</span>, </span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0128979749956164</span>, <span class="fl">0.0189962053653323</span>, <span class="fl">0.00782722711322035</span>), </span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0179913060388931</span>, <span class="fl">0.0292985300929012</span>, <span class="fl">0.0290119903127091</span>, </span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0144451828760062</span>, <span class="fl">0.020549409265887</span>, <span class="fl">0.00759613906581795</span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">9.53374349439331</span>, <span class="fl">0.165066482253842</span>, <span class="fl">20.543519757938</span>, </span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>    <span class="fl">59.2268671873984</span>, <span class="fl">6.11708287223425</span>, <span class="fl">8.2587663819897</span>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">1.51711569984396e-21</span>, </span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.868891654364147</span>, <span class="fl">8.79518334988573e-94</span>, <span class="dv">0</span>, <span class="fl">9.53038111046381e-10</span>, </span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.47185680747056e-16</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lo_95ci=</span> estimate<span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">up_95ci=</span> estimate<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> robust.se) <span class="sc">%&gt;%</span> </span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HR=</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>,<span class="st">"lo_95ci"</span>,<span class="st">"up_95ci"</span>),<span class="sc">~</span><span class="fu">exp</span>(.))</span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Previous dropout now predicts actual dropout"</span>)</span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Moderate previous biopsychosocial status predict actual dropout"</span>)</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Severe previous biopsychosocial status predict actual dropout"</span>)</span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"0-90 days in previous tr. predicts actual dropout"</span>)</span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"previous PSU protects actual dropout"</span>)</span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(i5b<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1635  1.0000  1.0000  0.9053  1.0000  1.0000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1634  1.0000  1.0000  0.9055  1.0000  1.0000 </span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Many low values"</span>)</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>ploti5b<span class="ot">&lt;-</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span> <span class="fu">as.data.frame</span>(i5b<span class="sc">$</span>iiw.weight),<span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">i5b$iiw.weight</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">60</span>)<span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Reasonable, but still there are some bit extreme values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>iiw_coefs_df<span class="ot">&lt;-</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0"</span>, i0_df_out),</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0b"</span>, i0b_df_out),</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0c"</span>, i0c_df_out),</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0d"</span>, i0d_df_out),</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1"</span>, i1_df_out),</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1b"</span>, i1b_df_out),</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1c"</span>, i1c_df_out),</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1d"</span>, i1d_df_out),</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i2"</span>, i2_df_out),</span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i3"</span>, i3_df_out),</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i3b"</span>, i3b_df_out),</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4"</span>, i4_df_out),</span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4b"</span>, i4b_df_out),</span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4c"</span>, i4c_df_out),</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4d"</span>, i4d_df_out),</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i5"</span>, i5_df_out),</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i5b"</span>, i5b_df_out)</span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(w, term, HR, lo_95ci, up_95ci, p.value)</span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a>iiw_coefs_df <span class="sc">%&gt;%</span> </span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"HR"</span>, <span class="st">"lo_95ci"</span>, <span class="st">"up_95ci"</span>), <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.)) <span class="sc">%&gt;%</span> </span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span> <span class="fu">ifelse</span>(.<span class="sc">&lt;</span>.<span class="dv">001</span>,<span class="st">"&lt;0.001"</span>,<span class="fu">sprintf</span>(<span class="st">"%1.3f"</span>,.))) <span class="sc">%&gt;%</span> </span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file=</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/iiws_coefs_24_04_18.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Different weights, coefficients"</span>, <span class="at">escape=</span>T)</span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Different weights, coefficients</caption>
<thead>
<tr class="header">
<th style="text-align: left;">w</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">HR</th>
<th style="text-align: left;">lo_95ci</th>
<th style="text-align: left;">up_95ci</th>
<th style="text-align: left;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i0</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">0.15</td>
<td style="text-align: left;">0.15</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i0b</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">2.91</td>
<td style="text-align: left;">2.82</td>
<td style="text-align: left;">3.01</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i0c</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">0.48</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i0d</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.32</td>
<td style="text-align: left;">1.28</td>
<td style="text-align: left;">1.35</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">1.24</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">1.24</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">1.69</td>
<td style="text-align: left;">1.58</td>
<td style="text-align: left;">1.80</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">0.032</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">1.22</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.27</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1b</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">1.28</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1b</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.910</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1b</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">4.21</td>
<td style="text-align: left;">3.95</td>
<td style="text-align: left;">4.48</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1b</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">3.59</td>
<td style="text-align: left;">3.51</td>
<td style="text-align: left;">3.68</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1b</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">2.32</td>
<td style="text-align: left;">2.22</td>
<td style="text-align: left;">2.42</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1c</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">0.74</td>
<td style="text-align: left;">0.72</td>
<td style="text-align: left;">0.76</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1c</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">0.40</td>
<td style="text-align: left;">0.39</td>
<td style="text-align: left;">0.42</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1c</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: left;">0.46</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1c</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">0.89</td>
<td style="text-align: left;">0.86</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1c</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">0.73</td>
<td style="text-align: left;">0.72</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1d</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1d</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.036</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1d</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">1.48</td>
<td style="text-align: left;">1.42</td>
<td style="text-align: left;">1.55</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i1d</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.57</td>
<td style="text-align: left;">1.53</td>
<td style="text-align: left;">1.61</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i1d</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">1.27</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">1.31</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i2</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">0.78</td>
<td style="text-align: left;">0.84</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">0.45</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i2</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">0.52</td>
<td style="text-align: left;">0.50</td>
<td style="text-align: left;">0.55</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i2</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">0.61</td>
<td style="text-align: left;">0.59</td>
<td style="text-align: left;">0.63</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i2</td>
<td style="text-align: left;">treatment</td>
<td style="text-align: left;">0.77</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.79</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.73</td>
<td style="text-align: left;">0.78</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i3</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">0.40</td>
<td style="text-align: left;">0.38</td>
<td style="text-align: left;">0.42</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">0.45</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i3</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">0.57</td>
<td style="text-align: left;">0.55</td>
<td style="text-align: left;">0.59</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i3</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">1.16</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3b</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.19</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i3b</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.869</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3b</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">1.81</td>
<td style="text-align: left;">1.71</td>
<td style="text-align: left;">1.92</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i3b</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">2.35</td>
<td style="text-align: left;">2.29</td>
<td style="text-align: left;">2.42</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i3b</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i3b</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">0.78</td>
<td style="text-align: left;">0.84</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">0.45</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">0.52</td>
<td style="text-align: left;">0.50</td>
<td style="text-align: left;">0.55</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">0.61</td>
<td style="text-align: left;">0.59</td>
<td style="text-align: left;">0.63</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4</td>
<td style="text-align: left;">treatment.lag</td>
<td style="text-align: left;">0.77</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.79</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4b</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">1.28</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4b</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.991</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4b</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">4.17</td>
<td style="text-align: left;">3.92</td>
<td style="text-align: left;">4.44</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4b</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">3.57</td>
<td style="text-align: left;">3.49</td>
<td style="text-align: left;">3.65</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4b</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">2.33</td>
<td style="text-align: left;">2.24</td>
<td style="text-align: left;">2.43</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4b</td>
<td style="text-align: left;">treatment.lag</td>
<td style="text-align: left;">1.16</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">1.19</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4c</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4c</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.72</td>
<td style="text-align: left;">0.79</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4c</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">0.88</td>
<td style="text-align: left;">0.84</td>
<td style="text-align: left;">0.92</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4c</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4c</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">0.83</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">0.86</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4c</td>
<td style="text-align: left;">treatment.lag</td>
<td style="text-align: left;">0.26</td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.28</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4d</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.14</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4d</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.873</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4d</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">1.62</td>
<td style="text-align: left;">1.54</td>
<td style="text-align: left;">1.70</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4d</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.80</td>
<td style="text-align: left;">1.75</td>
<td style="text-align: left;">1.86</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i4d</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i4d</td>
<td style="text-align: left;">treatment.lag</td>
<td style="text-align: left;">0.26</td>
<td style="text-align: left;">0.24</td>
<td style="text-align: left;">0.28</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i5</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.73</td>
<td style="text-align: left;">0.78</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i5</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">0.40</td>
<td style="text-align: left;">0.38</td>
<td style="text-align: left;">0.42</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i5</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">0.45</td>
<td style="text-align: left;">0.43</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i5</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i5</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">0.57</td>
<td style="text-align: left;">0.55</td>
<td style="text-align: left;">0.59</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i5</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">1.16</td>
<td style="text-align: left;">1.20</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i5b</td>
<td style="text-align: left;">tr_outcome.lag</td>
<td style="text-align: left;">1.19</td>
<td style="text-align: left;">1.15</td>
<td style="text-align: left;">1.23</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i5b</td>
<td style="text-align: left;">comp_bpsc_y2_moderate.lag</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.869</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i5b</td>
<td style="text-align: left;">comp_bpsc_y3_severe.lag</td>
<td style="text-align: left;">1.81</td>
<td style="text-align: left;">1.71</td>
<td style="text-align: left;">1.92</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i5b</td>
<td style="text-align: left;">less_90d_tr1.lag</td>
<td style="text-align: left;">2.35</td>
<td style="text-align: left;">2.29</td>
<td style="text-align: left;">2.42</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i5b</td>
<td style="text-align: left;">policonsumo2.lag</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">1.18</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">i5b</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>iiw_df<span class="ot">&lt;-</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0"</span>, <span class="at">iiw=</span>i0<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0b"</span>, <span class="at">iiw=</span>i0b<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0c"</span>, <span class="at">iiw=</span>i0c<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i0d"</span>, <span class="at">iiw=</span>i0d<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1"</span>, <span class="at">iiw=</span>i1<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1b"</span>, <span class="at">iiw=</span>i1b<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1c"</span>, <span class="at">iiw=</span>i1c<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i1d"</span>, <span class="at">iiw=</span>i1d<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i2"</span>, <span class="at">iiw=</span>i2<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i3"</span>, <span class="at">iiw=</span>i3<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i3b"</span>, <span class="at">iiw=</span>i3b<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4"</span>, <span class="at">iiw=</span>i4<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4b"</span>, <span class="at">iiw=</span>i4b<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4c"</span>, <span class="at">iiw=</span>i4c<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i4d"</span>, <span class="at">iiw=</span>i4d<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i5"</span>, <span class="at">iiw=</span>i5<span class="sc">$</span>iiw.weight),</span>
<span id="cb220-22"><a href="#cb220-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">w=</span> <span class="st">"i5b"</span>, <span class="at">iiw=</span>i5b<span class="sc">$</span>iiw.weight)</span>
<span id="cb220-23"><a href="#cb220-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb220-24"><a href="#cb220-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-25"><a href="#cb220-25" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describeBy</span>(iiw<span class="sc">~</span>w, <span class="at">data=</span>iiw_df, <span class="at">mat=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb220-26"><a href="#cb220-26" aria-hidden="true" tabindex="-1"></a>   { </span>
<span id="cb220-27"><a href="#cb220-27" aria-hidden="true" tabindex="-1"></a>     <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/iiws_24_04_18.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb220-28"><a href="#cb220-28" aria-hidden="true" tabindex="-1"></a>     knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Different weights, summary descriptives"</span>, <span class="at">escape=</span>T)</span>
<span id="cb220-29"><a href="#cb220-29" aria-hidden="true" tabindex="-1"></a>   }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Different weights, summary descriptives</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">item</th>
<th style="text-align: left;">group1</th>
<th style="text-align: right;">vars</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">trimmed</th>
<th style="text-align: right;">mad</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">range</th>
<th style="text-align: right;">skew</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">iiw1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">i0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">1.8464076</td>
<td style="text-align: right;">1.9802604</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.3731192</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">6.479385</td>
<td style="text-align: right;">5.479385e+00</td>
<td style="text-align: right;">1.9121364</td>
<td style="text-align: right;">1.6562841</td>
<td style="text-align: right;">0.0065981</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw2</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">i0b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">0.8986002</td>
<td style="text-align: right;">0.2372356</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9553002</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3435686</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">6.564314e-01</td>
<td style="text-align: right;">-1.9121364</td>
<td style="text-align: right;">1.6562841</td>
<td style="text-align: right;">0.0007905</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw3</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">i0c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30988</td>
<td style="text-align: right;">1.4988009</td>
<td style="text-align: right;">0.5526275</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.4846252</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">2.111044</td>
<td style="text-align: right;">1.111044e+00</td>
<td style="text-align: right;">0.2052710</td>
<td style="text-align: right;">-1.9579270</td>
<td style="text-align: right;">0.0031393</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw4</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">i0d</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30988</td>
<td style="text-align: right;">0.7889996</td>
<td style="text-align: right;">0.0784465</td>
<td style="text-align: right;">0.7598355</td>
<td style="text-align: right;">0.7662774</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.7598355</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">2.401645e-01</td>
<td style="text-align: right;">2.3178907</td>
<td style="text-align: right;">3.3727262</td>
<td style="text-align: right;">0.0004456</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw5</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">i1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">0.9119083</td>
<td style="text-align: right;">0.1872022</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9587877</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3903843</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">6.096157e-01</td>
<td style="text-align: right;">-1.8254047</td>
<td style="text-align: right;">1.6834181</td>
<td style="text-align: right;">0.0006237</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw6</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">i1b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">0.8542926</td>
<td style="text-align: right;">0.3133476</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9333340</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0232989</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">9.767011e-01</td>
<td style="text-align: right;">-1.8044064</td>
<td style="text-align: right;">1.4691605</td>
<td style="text-align: right;">0.0010441</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw7</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">i1c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30988</td>
<td style="text-align: right;">2.6599175</td>
<td style="text-align: right;">1.5977913</td>
<td style="text-align: right;">3.0455687</td>
<td style="text-align: right;">2.5897254</td>
<td style="text-align: right;">2.3898431</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">5.104169</td>
<td style="text-align: right;">4.104169e+00</td>
<td style="text-align: right;">0.1254937</td>
<td style="text-align: right;">-1.7159442</td>
<td style="text-align: right;">0.0090766</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw8</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">i1d</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30988</td>
<td style="text-align: right;">0.4845744</td>
<td style="text-align: right;">0.2113451</td>
<td style="text-align: right;">0.3917356</td>
<td style="text-align: right;">0.4541405</td>
<td style="text-align: right;">0.1221457</td>
<td style="text-align: right;">0.3093494</td>
<td style="text-align: right;">1.047275</td>
<td style="text-align: right;">7.379257e-01</td>
<td style="text-align: right;">0.8898299</td>
<td style="text-align: right;">-0.4759514</td>
<td style="text-align: right;">0.0012006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw9</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">i2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">1.7202764</td>
<td style="text-align: right;">1.6227108</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.3104177</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">44.918862</td>
<td style="text-align: right;">4.391886e+01</td>
<td style="text-align: right;">2.6481313</td>
<td style="text-align: right;">13.3027889</td>
<td style="text-align: right;">0.0054068</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw10</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">i3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">1.5860218</td>
<td style="text-align: right;">1.2752966</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.2569181</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.7554467</td>
<td style="text-align: right;">5.880294</td>
<td style="text-align: right;">5.124847e+00</td>
<td style="text-align: right;">1.9150319</td>
<td style="text-align: right;">2.0573721</td>
<td style="text-align: right;">0.0042492</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw11</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">i3b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">0.9053333</td>
<td style="text-align: right;">0.2172963</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9668945</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1634565</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">8.365435e-01</td>
<td style="text-align: right;">-2.2189636</td>
<td style="text-align: right;">3.5708295</td>
<td style="text-align: right;">0.0007240</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw12</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">i4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">1.7202764</td>
<td style="text-align: right;">1.6227108</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.3104177</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">44.918862</td>
<td style="text-align: right;">4.391886e+01</td>
<td style="text-align: right;">2.6481313</td>
<td style="text-align: right;">13.3027889</td>
<td style="text-align: right;">0.0054068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw13</td>
<td style="text-align: left;">13</td>
<td style="text-align: left;">i4b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">0.8535921</td>
<td style="text-align: right;">0.3146328</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9326223</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0086746</td>
<td style="text-align: right;">1.023063</td>
<td style="text-align: right;">1.014388e+00</td>
<td style="text-align: right;">-1.7995183</td>
<td style="text-align: right;">1.4485057</td>
<td style="text-align: right;">0.0010483</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw14</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">i4c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30988</td>
<td style="text-align: right;">4.9086872</td>
<td style="text-align: right;">289.9031455</td>
<td style="text-align: right;">0.8565799</td>
<td style="text-align: right;">0.7783143</td>
<td style="text-align: right;">0.9844717</td>
<td style="text-align: right;">0.1925629</td>
<td style="text-align: right;">49523.911445</td>
<td style="text-align: right;">4.952372e+04</td>
<td style="text-align: right;">162.2555130</td>
<td style="text-align: right;">27512.6578355</td>
<td style="text-align: right;">1.6468580</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw15</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">i4d</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30988</td>
<td style="text-align: right;">1.5153260</td>
<td style="text-align: right;">104.0729164</td>
<td style="text-align: right;">0.2103919</td>
<td style="text-align: right;">0.2517302</td>
<td style="text-align: right;">0.1181386</td>
<td style="text-align: right;">0.1307086</td>
<td style="text-align: right;">18136.282466</td>
<td style="text-align: right;">1.813615e+04</td>
<td style="text-align: right;">170.9329232</td>
<td style="text-align: right;">29750.5713178</td>
<td style="text-align: right;">0.5912089</td>
</tr>
<tr class="even">
<td style="text-align: left;">iiw16</td>
<td style="text-align: left;">16</td>
<td style="text-align: left;">i5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">1.5860218</td>
<td style="text-align: right;">1.2752966</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1.2569181</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.7554467</td>
<td style="text-align: right;">5.880294</td>
<td style="text-align: right;">5.124847e+00</td>
<td style="text-align: right;">1.9150319</td>
<td style="text-align: right;">2.0573721</td>
<td style="text-align: right;">0.0042492</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iiw17</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">i5b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">90075</td>
<td style="text-align: right;">0.9053333</td>
<td style="text-align: right;">0.2172963</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9668945</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1634565</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">8.365435e-01</td>
<td style="text-align: right;">-2.2189636</td>
<td style="text-align: right;">3.5708295</td>
<td style="text-align: right;">0.0007240</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Attaching package: ‘cowplot’</p>
</div>
<div class="message">
<p>The following object is masked from ‘package:ggpubr’:</p>
<pre><code>get_legend</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(ploti0, ploti0b, ploti0c, ploti0d, ploti1, ploti1b, ploti1c, ploti1d, ploti2, ploti3, ploti3b, ploti4, ploti4b, ploti4c, ploti4d, ploti5, ploti5b, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">'v'</span>, <span class="at">axis =</span> <span class="st">'tb'</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-3-3-iiw-output-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(combined_plot, <span class="at">file=</span><span class="st">"_proposal_grant/2023/_figs/comb_plot_24_04_18.jpg"</span>, <span class="at">width=</span><span class="fl">8.5</span>, <span class="at">height=</span><span class="fl">15.5</span>, <span class="at">dpi=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"20240430_avance_iiw.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We included several covariates in the model, such as PSU (<code>policonsumo2</code>), previous treatment completion status (if any, <code>event.lag</code>), previous biopsychosocial status (if any, <code>lag(compromiso_biopsicosocial.y)</code>), sex (<code>sex</code>), age of onset of substance use (<code>edad_ini_cons</code>), educational attainment (<code>escolaridad_rec</code>), primary substance at admission to treatment (<code>sus_principal_mod</code>), frequency of primary substance (<code>freq_cons_sus_prin_ord</code>), occupational status (<code>condicion_ocupacional_corr24</code>), number of children (binary, <code>num_hijos_mod_joel_bin</code>), housing tenure status (<code>tenencia_de_la_vivienda_mod</code>), administrative macro-zone of municipality of residence (<code>macrozona</code>), psychiatric co-morbidity (ICD-10, <code>dg_cie_10_rec</code>), SUD severity diagnosis (ICD-10, <code>dg_trs_cons_sus_or</code>), rurality status of municipality of residence (<code>clas_r</code>), poverty index of municipality of residence (<code>porc_pobr</code>), starting substance used (<code>sus_ini_mod_mvv</code>), corrected year of birth (<code>ano_nac_corr</code>), and cohabitation status (who the individual lives with, <code>con_quien_vive_joel</code>). These covariates are used to adjust for potential confounding factors that may affect the survival outcome.</p>
<p>We provisionally selected <code>i4d</code> (not only events; dichotomous transformation of previous biopsychosocial compromise, previous time in treatment (0-90 vs.&nbsp;&gt;90), previous PSU and treatment counts). However, Lokku et al., does not recommend including treatment counts. So we ended selecting <code>i1</code> : Not only events; dichotomous transformation of previous biopsychosocial compromise, previous time in treatment (0-90 vs.&nbsp;&gt;90), previous PSU and lag first 1s; without treatment count.</p>
<p><br></p>
<section id="definitive-model" class="level4">
<h4 class="anchored" data-anchor-id="definitive-model">Definitive model</h4>
<p>To account for the dynamic relationship between time since follow-up, we included terms for time elapsed from the first treatment.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-17: data_mine2_miss_proc2 not needed, data_mine_miss_proc2 instead (no longer needed to select events==1 [only with visits], because we already selected them)"</span>)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2 <span class="ot">&lt;-</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">group_by</span>(data_mine_miss_proc, hash_key), <span class="at">lag_tr_outcome=</span> <span class="fu">lag</span>(tr_outcome, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_comp_bpsc_y2_moderate=</span> <span class="fu">lag</span>(comp_bpsc_y2_moderate, <span class="at">default=</span><span class="dv">0</span>), <span class="at">lag_comp_bpsc_y3_severe=</span> <span class="fu">lag</span>(comp_bpsc_y3_severe, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_fech_egres_num=</span> <span class="fu">lag</span>(fech_egres_num), <span class="at">lag_less_90d_tr1=</span> <span class="fu">lag</span>(less_90d_tr1, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_policonsumo2=</span> <span class="fu">lag</span>(policonsumo2, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_dias_treat_imp_sin_na=</span> <span class="fu">lag</span>(dias_treat_imp_sin_na)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na=</span> <span class="fu">log</span>(lag_dias_treat_imp_sin_na<span class="fl">+0.001</span>), <span class="at">log_dias_treat_imp_sin_na=</span> <span class="fu">log</span>(dias_treat_imp_sin_na<span class="fl">+0.001</span>), <span class="at">esc_dum_rec_3prim =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(escolaridad_rec)<span class="sc">==</span><span class="st">"3-Completed primary school or less"</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">esc_dum_rec_2high =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(escolaridad_rec)<span class="sc">==</span> <span class="st">"2-Completed high school or less"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_oh =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Alcohol"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_coc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Cocaine hydrochloride"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_pbc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Cocaine paste"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_mar =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Marijuana"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_5day=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"5. Daily"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_44to6wk=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"4. 4 to 6 days a week"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_32to3wk=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"3. 2 to 3 days a week"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_21wkmore=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"2. 1 day a week or more"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cond_oc_dum_3unemp=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(condicion_ocupacional_corr24)<span class="sc">==</span> <span class="st">"Unemployed"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cond_oc_dum_2inact=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(condicion_ocupacional_corr24)<span class="sc">==</span> <span class="st">"Inactive"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_illegal=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Illegal Settlement"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_own=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Owner/Transferred dwellings/Pays Dividends"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_rent=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Renting"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_temp=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Stays temporarily with a relative"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">macro_dum_south=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(macrozona)<span class="sc">==</span> <span class="st">"South"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">macro_dum_north=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(macrozona)<span class="sc">==</span> <span class="st">"North"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">psycom_dum_with=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(dg_cie_10_rec)<span class="sc">==</span> <span class="st">"With psychiatric comorbidity"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">psycom_dum_study=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(dg_cie_10_rec)<span class="sc">==</span> <span class="st">"Diagnosis unknown (under study)"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">psycom_dum_study=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(dg_cie_10_rec)<span class="sc">==</span> <span class="st">"Diagnosis unknown (under study)"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">rurality_rural=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(clas_r)<span class="sc">==</span> <span class="st">"Rural"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">rurality_mix=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(clas_r)<span class="sc">==</span> <span class="st">"Mixed"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_oh =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Alcohol"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_coc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Cocaine hydrochloride"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_pbc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Cocaine paste"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_mar =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Marijuana"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cohab_dum_alone =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(con_quien_vive_joel)<span class="sc">==</span> <span class="st">"Alone"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cohab_dum_fam_or =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(con_quien_vive_joel)<span class="sc">==</span> <span class="st">"Family of origin"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cohab_dum_cpl_child =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(con_quien_vive_joel)<span class="sc">==</span> <span class="st">"With couple/children"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">surv_time=</span> <span class="fu">ifelse</span>(surv_time<span class="sc">&lt;</span><span class="fl">0.001</span>, <span class="fl">0.0001</span>, surv_time)) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() </span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-05-02: problem with different values in people with plans (possibly imputed)"</span>)</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2 <span class="ot">&lt;-</span></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">group_by</span>(data_mine_miss_restr_proc, hash_key), <span class="at">lag_tr_outcome=</span> <span class="fu">lag</span>(tr_outcome, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_comp_bpsc_y2_moderate=</span> <span class="fu">lag</span>(comp_bpsc_y2_moderate, <span class="at">default=</span><span class="dv">0</span>), <span class="at">lag_comp_bpsc_y3_severe=</span> <span class="fu">lag</span>(comp_bpsc_y3_severe, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_fech_egres_num=</span> <span class="fu">lag</span>(fech_egres_num), <span class="at">lag_less_90d_tr1=</span> <span class="fu">lag</span>(less_90d_tr1, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_policonsumo2=</span> <span class="fu">lag</span>(policonsumo2, <span class="at">default=</span><span class="dv">1</span>), <span class="at">lag_dias_treat_imp_sin_na=</span> <span class="fu">lag</span>(dias_treat_imp_sin_na)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na=</span> <span class="fu">log</span>(lag_dias_treat_imp_sin_na<span class="fl">+0.001</span>), <span class="at">log_dias_treat_imp_sin_na=</span> <span class="fu">log</span>(dias_treat_imp_sin_na<span class="fl">+0.001</span>), <span class="at">esc_dum_rec_3prim =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(escolaridad_rec)<span class="sc">==</span><span class="st">"3-Completed primary school or less"</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">esc_dum_rec_2high =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(escolaridad_rec)<span class="sc">==</span> <span class="st">"2-Completed high school or less"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_oh =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Alcohol"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_coc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Cocaine hydrochloride"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_pbc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Cocaine paste"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susprindum_mar =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_principal_mod)<span class="sc">==</span> <span class="st">"Marijuana"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_5day=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"5. Daily"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_44to6wk=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"4. 4 to 6 days a week"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_32to3wk=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"3. 2 to 3 days a week"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">freq_cons_dum_21wkmore=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(freq_cons_sus_prin_ord)<span class="sc">==</span> <span class="st">"2. 1 day a week or more"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cond_oc_dum_3unemp=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(condicion_ocupacional_corr24)<span class="sc">==</span> <span class="st">"Unemployed"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cond_oc_dum_2inact=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(condicion_ocupacional_corr24)<span class="sc">==</span> <span class="st">"Inactive"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_illegal=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Illegal Settlement"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_own=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Owner/Transferred dwellings/Pays Dividends"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_rent=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Renting"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">viv_dum_temp=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(tenencia_de_la_vivienda_mod)<span class="sc">==</span> <span class="st">"Stays temporarily with a relative"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">macro_dum_south=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(macrozona)<span class="sc">==</span> <span class="st">"South"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">macro_dum_north=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(macrozona)<span class="sc">==</span> <span class="st">"North"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">psycom_dum_with=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(dg_cie_10_rec)<span class="sc">==</span> <span class="st">"With psychiatric comorbidity"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">psycom_dum_study=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(dg_cie_10_rec)<span class="sc">==</span> <span class="st">"Diagnosis unknown (under study)"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">psycom_dum_study=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(dg_cie_10_rec)<span class="sc">==</span> <span class="st">"Diagnosis unknown (under study)"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">rurality_rural=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(clas_r)<span class="sc">==</span> <span class="st">"Rural"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">rurality_mix=</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(clas_r)<span class="sc">==</span> <span class="st">"Mixed"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_oh =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Alcohol"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_coc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Cocaine hydrochloride"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_pbc =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Cocaine paste"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">susinidum_mar =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(sus_ini_mod_mvv)<span class="sc">==</span> <span class="st">"Marijuana"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cohab_dum_alone =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(con_quien_vive_joel)<span class="sc">==</span> <span class="st">"Alone"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cohab_dum_fam_or =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(con_quien_vive_joel)<span class="sc">==</span> <span class="st">"Family of origin"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">cohab_dum_cpl_child =</span> <span class="fu">ifelse</span>(<span class="fu">as.character</span>(con_quien_vive_joel)<span class="sc">==</span> <span class="st">"With couple/children"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">surv_time=</span> <span class="fu">ifelse</span>(surv_time<span class="sc">&lt;</span><span class="fl">0.001</span>, <span class="fl">0.0001</span>, surv_time)) <span class="sc">%&gt;%</span> </span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tipo_de_plan_2_mod=</span><span class="fu">first</span>(tipo_de_plan_2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>() </span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>dis_run_w_more_type_plan<span class="ot">&lt;-</span></span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count_n_dis=</span><span class="fu">n_distinct</span>(tipo_de_plan_2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb226-23"><a href="#cb226-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(count_n_dis<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(id)</span>
<span id="cb226-24"><a href="#cb226-24" aria-hidden="true" tabindex="-1"></a><span class="co"># data_mine_miss_restr_proc2 %&gt;% </span></span>
<span id="cb226-25"><a href="#cb226-25" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::group_by(id) %&gt;% </span></span>
<span id="cb226-26"><a href="#cb226-26" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::mutate(tipo_de_plan_2_mod=first(tipo_de_plan_2_mod)) %&gt;% </span></span>
<span id="cb226-27"><a href="#cb226-27" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::ungroup() %&gt;% </span></span>
<span id="cb226-28"><a href="#cb226-28" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr::filter(id  %in% dis_run_w_more_type_plan$id)</span></span>
<span id="cb226-29"><a href="#cb226-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-30"><a href="#cb226-30" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"export to python"</span>)</span>
<span id="cb226-31"><a href="#cb226-31" aria-hidden="true" tabindex="-1"></a>arrow<span class="sc">::</span><span class="fu">write_parquet</span>(data_mine_miss_proc2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(lag_time),<span class="dv">0</span>,lag_time)), </span>
<span id="cb226-32"><a href="#cb226-32" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"_proposal_grant/2023/data_mine_miss_proc2_20240417.gz.parquet"</span>, </span>
<span id="cb226-33"><a href="#cb226-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">compression =</span> <span class="st">"gzip"</span>, <span class="at">compression_level =</span> <span class="dv">5</span>)</span>
<span id="cb226-34"><a href="#cb226-34" aria-hidden="true" tabindex="-1"></a>arrow<span class="sc">::</span><span class="fu">write_parquet</span>(data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lag_time=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(lag_time),<span class="dv">0</span>,lag_time)), </span>
<span id="cb226-35"><a href="#cb226-35" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"_proposal_grant/2023/data_mine_miss_restr_proc2_20240427.gz.parquet"</span>, </span>
<span id="cb226-36"><a href="#cb226-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">compression =</span> <span class="st">"gzip"</span>, <span class="at">compression_level =</span> <span class="dv">5</span>)</span>
<span id="cb226-37"><a href="#cb226-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-38"><a href="#cb226-38" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb226-39"><a href="#cb226-39" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb226-40"><a href="#cb226-40" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb226-41"><a href="#cb226-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-42"><a href="#cb226-42" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb226-43"><a href="#cb226-43" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Explore residuals"</span>)</span>
<span id="cb226-44"><a href="#cb226-44" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_tr_outcome<span class="sc">+</span> lag_comp_bpsc_y3_severe<span class="sc">+</span> lag_less_90d_tr1<span class="sc">+</span> log_lag_dias_treat_imp_sin_na<span class="sc">+</span> lag_policonsumo2<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="fu">strata</span>(tipo_de_plan_2), <span class="at">data =</span> data_mine_miss_proc2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(lag_time, time, event) ~ lag_tr_outcome + 
    lag_comp_bpsc_y3_severe + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + 
    lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + strata(tipo_de_plan_2), 
    data = data_mine_miss_proc2, cluster = id)

                                   coef exp(coef)  se(coef) robust se      z
lag_tr_outcome                 0.139006  1.149130  0.019532  0.017338  8.017
lag_comp_bpsc_y3_severe        0.128602  1.137237  0.015722  0.014992  8.578
lag_less_90d_tr1               0.119770  1.127237  0.021018  0.023973  4.996
log_lag_dias_treat_imp_sin_na -0.027843  0.972541  0.007598  0.010508 -2.650
lag_policonsumo2              -0.011019  0.989041  0.020273  0.018189 -0.606
edad_al_ing_1                  0.232879  1.262229  0.004098  0.003826 60.866
ano_nac_corr                   0.236261  1.266505  0.004070  0.003788 62.373
                                     p
lag_tr_outcome                1.08e-15
lag_comp_bpsc_y3_severe        &lt; 2e-16
lag_less_90d_tr1              5.85e-07
log_lag_dias_treat_imp_sin_na  0.00805
lag_policonsumo2               0.54462
edad_al_ing_1                  &lt; 2e-16
ano_nac_corr                   &lt; 2e-16

Likelihood ratio test=3814  on 7 df, p=&lt; 2.2e-16
n= 17671, number of events= 17671 
   (72404 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se      z        p</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 0.139016  1.149142  0.019531  0.017338  8.018 1.07e-15</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        0.129501  1.138261  0.015740  0.015006  8.630  &lt; 2e-16</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1               0.119756  1.127222  0.021016  0.023976  4.995 5.89e-07</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na -0.027876  0.972509  0.007595  0.010510 -2.652    0.008</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2              -0.010438  0.989616  0.020266  0.018185 -0.574    0.566</span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.232959  1.262330  0.004099  0.003827 60.870  &lt; 2e-16</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.236313  1.266571  0.004070  0.003788 62.377  &lt; 2e-16</span></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_tr_outcome<span class="sc">+</span> lag_comp_bpsc_y3_severe<span class="sc">+</span> lag_less_90d_tr1<span class="sc">+</span> log_lag_dias_treat_imp_sin_na<span class="sc">+</span> lag_policonsumo2<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="fu">strata</span>(tipo_de_plan_2), <span class="at">data =</span> data_mine_miss_restr_proc2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(lag_time, time, event) ~ lag_tr_outcome + 
    lag_comp_bpsc_y3_severe + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + 
    lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + strata(tipo_de_plan_2), 
    data = data_mine_miss_restr_proc2, cluster = id)

                                   coef exp(coef)  se(coef) robust se      z
lag_tr_outcome                 0.139006  1.149130  0.019532  0.017338  8.017
lag_comp_bpsc_y3_severe        0.128602  1.137237  0.015722  0.014992  8.578
lag_less_90d_tr1               0.119770  1.127237  0.021018  0.023973  4.996
log_lag_dias_treat_imp_sin_na -0.027843  0.972541  0.007598  0.010508 -2.650
lag_policonsumo2              -0.011019  0.989041  0.020273  0.018189 -0.606
edad_al_ing_1                  0.232879  1.262229  0.004098  0.003826 60.866
ano_nac_corr                   0.236261  1.266505  0.004070  0.003788 62.373
                                     p
lag_tr_outcome                1.08e-15
lag_comp_bpsc_y3_severe        &lt; 2e-16
lag_less_90d_tr1              5.85e-07
log_lag_dias_treat_imp_sin_na  0.00805
lag_policonsumo2               0.54462
edad_al_ing_1                  &lt; 2e-16
ano_nac_corr                   &lt; 2e-16

Likelihood ratio test=3814  on 7 df, p=&lt; 2.2e-16
n= 17671, number of events= 17671 
   (13317 observations deleted due to missingness)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 coef exp(coef) se(coef) robust se    z      p</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 0.139     1.149    0.020     0.017  8.0  1e-15</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        0.128     1.137    0.016     0.015  8.6 &lt;2e-16</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1               0.120     1.128    0.021     0.024  5.0  5e-07</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na -0.028     0.972    0.008     0.011 -2.7  0.008</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2              -0.010     0.990    0.020     0.018 -0.6  0.574</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.233     1.262    0.004     0.004 60.9 &lt;2e-16</span></span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.236     1.267    0.004     0.004 62.4 &lt;2e-16</span></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(</span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coxph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_tr_outcome<span class="sc">+</span> lag_comp_bpsc_y3_severe<span class="sc">+</span> lag_less_90d_tr1<span class="sc">+</span> log_lag_dias_treat_imp_sin_na<span class="sc">+</span> lag_policonsumo2<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="fu">strata</span>(tipo_de_plan_2), <span class="at">data=</span> data_mine_miss_proc2)</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               chisq df       p
lag_tr_outcome                 37.88  1 7.5e-10
lag_comp_bpsc_y3_severe        61.07  1 5.5e-15
lag_less_90d_tr1              147.34  1 &lt; 2e-16
log_lag_dias_treat_imp_sin_na 178.31  1 &lt; 2e-16
lag_policonsumo2               13.27  1 0.00027
edad_al_ing_1                  35.36  1 2.7e-09
ano_nac_corr                    8.64  1 0.00328
GLOBAL                        521.18  7 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                chisq df       p</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 37.98  1 7.1e-10</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        61.87  1 3.7e-15</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1              147.28  1 &lt; 2e-16</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na 178.13  1 &lt; 2e-16</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2               13.18  1 0.00028</span></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  35.57  1 2.5e-09</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    8.73  1 0.00312</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        521.92  7 &lt; 2e-16</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coxph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_tr_outcome<span class="sc">+</span> lag_comp_bpsc_y3_severe<span class="sc">+</span> lag_less_90d_tr1<span class="sc">+</span> log_lag_dias_treat_imp_sin_na<span class="sc">+</span> lag_policonsumo2<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="fu">strata</span>(tipo_de_plan_2), <span class="at">data=</span> data_mine_miss_restr_proc2)</span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               chisq df       p
lag_tr_outcome                 37.88  1 7.5e-10
lag_comp_bpsc_y3_severe        61.07  1 5.5e-15
lag_less_90d_tr1              147.34  1 &lt; 2e-16
log_lag_dias_treat_imp_sin_na 178.31  1 &lt; 2e-16
lag_policonsumo2               13.27  1 0.00027
edad_al_ing_1                  35.36  1 2.7e-09
ano_nac_corr                    8.64  1 0.00328
GLOBAL                        521.18  7 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                chisq df       p</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 37.95  1 7.3e-10</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        57.93  1 2.7e-14</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1              147.25  1 &lt; 2e-16</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na 178.15  1 &lt; 2e-16</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2               13.21  1 0.00028</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  35.50  1 2.6e-09</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    8.71  1 0.00317</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        519.01  7 &lt; 2e-16</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Tiene mejor ajuste que las alternativas sólo con días de tto. continuos (log) o el dicotomizado solo:  186751.2 vs. 186756.6 vs. 186779.1; 2024-04-21: 261769.5 el actual sin moderado 262293.3, vs. mucho menos cuando intento agregar términos. Pero lo haré dirigido por la teoría"</span>)</span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(</span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coxph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_tr_outcome<span class="sc">+</span> lag_comp_bpsc_y3_severe<span class="sc">+</span> lag_less_90d_tr1<span class="sc">+</span> log_lag_dias_treat_imp_sin_na<span class="sc">+</span> lag_policonsumo2<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="fu">strata</span>(tipo_de_plan_2_mod), <span class="at">data=</span> data_mine_miss_restr_proc2)</span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               chisq df       p
lag_tr_outcome                 54.28  1 1.7e-13
lag_comp_bpsc_y3_severe        20.29  1 6.7e-06
lag_less_90d_tr1              130.84  1 &lt; 2e-16
log_lag_dias_treat_imp_sin_na 142.09  1 &lt; 2e-16
lag_policonsumo2                9.78  1  0.0018
edad_al_ing_1                  33.55  1 7.0e-09
ano_nac_corr                    7.91  1  0.0049
GLOBAL                        460.60  7 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                chisq df       p</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 54.66  1 1.4e-13</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        19.67  1 9.2e-06</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1              130.48  1 &lt; 2e-16</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na 141.52  1 &lt; 2e-16</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                9.72  1  0.0018</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  33.47  1 7.2e-09</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    7.88  1  0.0050</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        459.34  7 &lt; 2e-16</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>final <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> log_dias_treat_imp_sin_na.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> </span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cluster</span>(hash_key),</span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_proc2,</span>
<span id="cb236-18"><a href="#cb236-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>),</span>
<span id="cb236-19"><a href="#cb236-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb236-20"><a href="#cb236-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxfu=</span> maxfu_df,<span class="co">#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb236-21"><a href="#cb236-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>), <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb236-22"><a href="#cb236-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb236-23"><a href="#cb236-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb236-24"><a href="#cb236-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-25"><a href="#cb236-25" aria-hidden="true" tabindex="-1"></a>final_restr <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb236-26"><a href="#cb236-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> log_dias_treat_imp_sin_na.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> </span>
<span id="cb236-27"><a href="#cb236-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cluster</span>(hash_key),</span>
<span id="cb236-28"><a href="#cb236-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb236-29"><a href="#cb236-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb236-30"><a href="#cb236-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb236-31"><a href="#cb236-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_restr_proc2,</span>
<span id="cb236-32"><a href="#cb236-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>),</span>
<span id="cb236-33"><a href="#cb236-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb236-34"><a href="#cb236-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxfu=</span> maxfu_restr_df,<span class="co">#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb236-35"><a href="#cb236-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>), <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb236-36"><a href="#cb236-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb236-37"><a href="#cb236-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb236-38"><a href="#cb236-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-39"><a href="#cb236-39" aria-hidden="true" tabindex="-1"></a>final_b <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb236-40"><a href="#cb236-40" aria-hidden="true" tabindex="-1"></a>   <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> log_dias_treat_imp_sin_na.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> </span>
<span id="cb236-41"><a href="#cb236-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cluster</span>(hash_key),</span>
<span id="cb236-42"><a href="#cb236-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb236-43"><a href="#cb236-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb236-44"><a href="#cb236-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb236-45"><a href="#cb236-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_proc2,</span>
<span id="cb236-46"><a href="#cb236-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>),</span>
<span id="cb236-47"><a href="#cb236-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb236-48"><a href="#cb236-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxfu=</span> maxfu_df,<span class="co">#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb236-49"><a href="#cb236-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>), <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb236-50"><a href="#cb236-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb236-51"><a href="#cb236-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb236-52"><a href="#cb236-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-53"><a href="#cb236-53" aria-hidden="true" tabindex="-1"></a>final_restr_b <span class="ot">&lt;-</span> <span class="fu">iiw.weights</span>(</span>
<span id="cb236-54"><a href="#cb236-54" aria-hidden="true" tabindex="-1"></a>   <span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> tr_outcome.lag<span class="sc">+</span> comp_bpsc_y3_severe.lag<span class="sc">+</span> less_90d_tr1.lag<span class="sc">+</span> log_dias_treat_imp_sin_na.lag<span class="sc">+</span> policonsumo2.lag<span class="sc">+</span> edad_al_ing_1<span class="sc">+</span> ano_nac_corr<span class="sc">+</span> </span>
<span id="cb236-55"><a href="#cb236-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cluster</span>(hash_key),</span>
<span id="cb236-56"><a href="#cb236-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb236-57"><a href="#cb236-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb236-58"><a href="#cb236-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">event=</span> <span class="st">"event"</span>,</span>
<span id="cb236-59"><a href="#cb236-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_restr_proc2,</span>
<span id="cb236-60"><a href="#cb236-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>),</span>
<span id="cb236-61"><a href="#cb236-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"policonsumo2"</span>),</span>
<span id="cb236-62"><a href="#cb236-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxfu=</span> maxfu_restr_df,<span class="co">#Base_fiscalia_v15f_grant_23_24_long2$cens_time,</span></span>
<span id="cb236-63"><a href="#cb236-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>), <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb236-64"><a href="#cb236-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">first=</span> T  <span class="co">#If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred</span></span>
<span id="cb236-65"><a href="#cb236-65" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb236-66"><a href="#cb236-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb236-67"><a href="#cb236-67" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(final<span class="sc">$</span>m, <span class="at">conf.int=</span>T, <span class="at">exponentiate =</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 x 8
  term                 estim~1 std.e~2 robus~3 stati~4   p.value conf.~5 conf.~6
  &lt;chr&gt;                  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 tr_outcome.lag          1.33 0.0194  0.0183    15.6  4.62e- 55    1.28    1.38
2 comp_bpsc_y3_severe~    1.72 0.0129  0.0135    40.3  0            1.68    1.77
3 less_90d_tr1.lag        3.30 0.0179  0.0205    58.3  0            3.17    3.44
4 log_dias_treat_imp_~    1.39 0.0106  0.0139    23.9  2.11e-126    1.36    1.43
5 policonsumo2.lag        1.10 0.0191  0.0196     5.07 4.03e-  7    1.06    1.15
6 edad_al_ing_1           1.08 0.00153 0.00141   57.9  0            1.08    1.09
7 ano_nac_corr            1.09 0.00153 0.00140   64.4  0            1.09    1.10
# ... with abbreviated variable names 1: estimate, 2: std.error, 3: robust.se,
#   4: statistic, 5: conf.low, 6: conf.high</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   term                    estimate std.error robust.se statistic  p.value conf.low conf.high</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 tr_outcome.lag              1.17   0.0189    0.0172       9.01 2.07e-19     1.13      1.21</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 comp_bpsc_y3_severe.lag     1.80   0.0126    0.0130      45.3  0            1.75      1.85</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 less_90d_tr1.lag            2.27   0.0130    0.0142      57.6  0            2.21      2.34</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 policonsumo2.lag            1.18   0.0189    0.0196       8.30 1.06e-16     1.13      1.22</span></span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 edad_al_ing_1               1.09   0.00153   0.00139     60.3  0            1.08      1.09</span></span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 ano_nac_corr                1.10   0.00153   0.00138     66.2  0            1.09      1.10</span></span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(final_restr<span class="sc">$</span>m, <span class="at">conf.int=</span>T, <span class="at">exponentiate =</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 x 8
  term                 estim~1 std.e~2 robus~3 stati~4   p.value conf.~5 conf.~6
  &lt;chr&gt;                  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 tr_outcome.lag          1.27 0.0196  0.0175    13.7  5.54e- 43    1.23    1.32
2 comp_bpsc_y3_severe~    1.58 0.0135  0.0130    35.0  4.07e-268    1.54    1.62
3 less_90d_tr1.lag        2.47 0.0198  0.0221    40.9  0            2.37    2.58
4 log_dias_treat_imp_~    1.26 0.0109  0.0132    17.6  1.17e- 69    1.23    1.29
5 policonsumo2.lag        1.12 0.0195  0.0179     6.17 6.73e- 10    1.08    1.16
6 edad_al_ing_1           1.15 0.00296 0.00266   53.2  0            1.15    1.16
7 ano_nac_corr            1.15 0.00293 0.00263   54.4  0            1.15    1.16
# ... with abbreviated variable names 1: estimate, 2: std.error, 3: robust.se,
#   4: statistic, 5: conf.low, 6: conf.high</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># term                          estimate std.error robust.se statistic   p.value conf.low conf.high</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome.lag                    1.27   0.0196    0.0175      13.7  9.41e- 43     1.23      1.32</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe.lag           1.58   0.0135    0.0130      35.1  5.67e-270     1.54      1.62</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1.lag                  2.47   0.0198    0.0221      41.0  0             2.37      2.58</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag     1.26   0.0109    0.0132      17.6  1.97e- 69     1.23      1.29</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                  1.12   0.0195    0.0179       6.31 2.70e- 10     1.08      1.16</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                     1.15   0.00296   0.00267     53.2  0             1.15      1.16</span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                      1.15   0.00293   0.00263     54.4  0             1.15      1.16</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(final_b<span class="sc">$</span>m, <span class="at">conf.int=</span>T, <span class="at">exponentiate =</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 x 8
  term                 estim~1 std.e~2 robus~3 stati~4   p.value conf.~5 conf.~6
  &lt;chr&gt;                  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 tr_outcome.lag         0.661 0.0144  0.0197   -21.0  5.52e- 98   0.636   0.687
2 comp_bpsc_y3_severe~   0.913 0.0144  0.0193    -4.72 2.40e-  6   0.879   0.948
3 less_90d_tr1.lag       0.871 0.0180  0.0248    -5.58 2.38e-  8   0.829   0.914
4 log_dias_treat_imp_~   0.829 0.00303 0.0121   -15.5  4.29e- 54   0.810   0.849
5 policonsumo2.lag       0.531 0.0144  0.0239   -26.5  4.80e-155   0.507   0.556
6 edad_al_ing_1          1.07  0.00153 0.00140   50.1  0           1.07    1.08 
7 ano_nac_corr           1.09  0.00152 0.00140   58.9  0           1.08    1.09 
# ... with abbreviated variable names 1: estimate, 2: std.error, 3: robust.se,
#   4: statistic, 5: conf.low, 6: conf.high</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   term                          estimate std.error robust.se statistic  p.value conf.low conf.high</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 tr_outcome.lag                   0.551   0.0133    0.0152     -39.3  0           0.534     0.567</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 comp_bpsc_y3_severe.lag          0.866   0.0142    0.0162      -8.88 6.86e-19    0.839     0.894</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 less_90d_tr1.lag                 0.904   0.0184    0.0263      -3.83 1.31e- 4    0.859     0.952</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 log_dias_treat_imp_sin_na.lag    0.873   0.00421   0.0137      -9.86 6.23e-23    0.850     0.897</span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 policonsumo2.lag                 0.450   0.0135    0.0167     -47.9  0           0.435     0.465</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 edad_al_ing_1                    1.07    0.00153   0.00138     51.0  0           1.07      1.08 </span></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 7 ano_nac_corr                     1.09    0.00152   0.00138     60.0  0           1.08      1.09 </span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(final_restr_b<span class="sc">$</span>m, <span class="at">conf.int=</span>T, <span class="at">exponentiate =</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 x 8
  term                 estim~1 std.e~2 robus~3 stati~4   p.value conf.~5 conf.~6
  &lt;chr&gt;                  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 tr_outcome.lag         0.679 0.0150  0.0185   -21.0  1.78e- 97   0.654   0.704
2 comp_bpsc_y3_severe~   0.937 0.0146  0.0178    -3.67 2.39e-  4   0.904   0.970
3 less_90d_tr1.lag       0.857 0.0181  0.0246    -6.29 3.10e- 10   0.816   0.899
4 log_dias_treat_imp_~   0.835 0.00326 0.0130   -13.9  6.21e- 44   0.814   0.857
5 policonsumo2.lag       0.576 0.0152  0.0211   -26.1  2.67e-150   0.552   0.600
6 edad_al_ing_1          1.14  0.00293 0.00274   47.3  0           1.13    1.14 
7 ano_nac_corr           1.15  0.00293 0.00268   52.1  0           1.14    1.16 
# ... with abbreviated variable names 1: estimate, 2: std.error, 3: robust.se,
#   4: statistic, 5: conf.low, 6: conf.high</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># term                          estimate std.error robust.se statistic   p.value conf.low conf.high</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome.lag                   0.603   0.0144    0.0155     -32.6  1.17e-232    0.585     0.621</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe.lag          0.913   0.0144    0.0149      -6.14 8.03e- 10    0.886     0.940</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1.lag                 0.898   0.0187    0.0249      -4.34 1.45e-  5    0.855     0.943</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    0.887   0.00464   0.0134      -8.92 4.53e- 19    0.864     0.911</span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.514   0.0146    0.0163     -40.9  0            0.498     0.530</span></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.13    0.00291   0.00250     48.1  0            1.12      1.13 </span></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.14    0.00291   0.00249     52.9  0            1.14      1.15 </span></span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>final_coefs<span class="ot">&lt;-</span></span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"tr_outcome.lag"</span>, <span class="st">"comp_bpsc_y3_severe.lag"</span>, <span class="st">"less_90d_tr1.lag"</span>, <span class="st">"policonsumo2.lag"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>), <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fl">1.1680161176676</span>, <span class="fl">1.79963517024553</span>, <span class="fl">2.2710236051536</span>, <span class="fl">1.17641492065206</span>, <span class="fl">1.08756180792251</span>, <span class="fl">1.09565232375642</span>), <span class="at">std.error =</span> <span class="fu">c</span>(<span class="fl">0.0188883080181889</span>, <span class="fl">0.0125981011876289</span>, <span class="fl">0.0129873997440068</span>, <span class="fl">0.0189035437658918</span>, <span class="fl">0.00153425515290826</span>, <span class="fl">0.00153498904364182</span>), <span class="at">robust.se =</span> <span class="fu">c</span>(<span class="fl">0.0172377882900819</span>, <span class="fl">0.0129754816518389</span>, <span class="fl">0.0142405606352216</span>, <span class="fl">0.0195792679568791</span>, <span class="fl">0.00139105857932987</span>, <span class="fl">0.00138071917329718</span>), <span class="at">statistic =</span> <span class="fu">c</span>(<span class="fl">9.0096641790833</span>, <span class="fl">45.2841734070737</span>, <span class="fl">57.5981998354651</span>, <span class="fl">8.29814532853555</span>, <span class="fl">60.3413245741051</span>, <span class="fl">66.1611116269822</span>), <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">2.06688423909932e-19</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">1.05749268471728e-16</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">conf.low =</span> <span class="fu">c</span>(<span class="fl">1.12921334955458</span>, <span class="fl">1.75444485412689</span>, <span class="fl">2.20851351433301</span>, <span class="fl">1.13212562626954</span>, <span class="fl">1.0846006909948</span>, <span class="fl">1.09269132170511</span>), <span class="at">conf.high =</span> <span class="fu">c</span>(<span class="fl">1.20815225189237</span>, <span class="fl">1.84598948115495</span>, <span class="fl">2.33530299076412</span>, <span class="fl">1.22243683335131</span>, <span class="fl">1.09053100912818</span>, <span class="fl">1.09862134960454</span>))</span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
 0.07435  1.00000  1.00000  0.90727  1.00000 68.81131 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>   <span class="co">#  0.1     1.0     1.0     0.9     1.0    67.9 </span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_restr<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
 0.08549  0.44872  0.84983  0.74315  1.00000 22.25216 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 0.09    0.45    0.85    0.74    1.00   22.04 </span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Generar los pesos a asignar"</span>)</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(final<span class="sc">$</span>iiw, data_mine_miss_proc<span class="sc">$</span>treatment) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var1=</span><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Var1)), <span class="at">Freq=</span><span class="fu">as.numeric</span>(Freq)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="sc">-</span>Freq) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Var2) <span class="sc">%&gt;%</span>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>structure(list(Var1 = c(1, 0.2934922955593, 0.0743489610317217, 
0.0757106912282225, 0.0762091661974078, 0.0783327140965704, 0.0803105805175816, 
0.0803344064102367, 0.0804539791818909, 0.0820904544526977, 0.0841827879338751, 
0.0844743814169596, 0.0849411523170872, 0.0851903256041754, 0.0855473256157542, 
0.0865205249520326, 0.0867570352679417, 0.088066938352575, 0.0880950865189643, 
0.0881021667861931), Freq = c(72404, 2, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)), row.names = c(NA, 20L), class = "data.frame")</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>df_iiw_final<span class="ot">&lt;-</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">Var1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.688125981472609</span>, <span class="fl">0.160330998755955</span>, <span class="fl">0.162315144547036</span>, <span class="fl">0.196774517463519</span>, <span class="fl">0.199606787793155</span>, <span class="fl">0.208958220652199</span>, <span class="fl">0.225731677712565</span>, <span class="fl">0.23160770335121</span>, <span class="fl">0.234224555582056</span>, <span class="fl">0.248919669741449</span>, <span class="fl">0.256310292435046</span>, <span class="fl">0.275606737385485</span>, <span class="fl">0.286468644357305</span>, <span class="fl">0.291310136239186</span>, <span class="fl">0.313585733564029</span>, <span class="fl">0.314758256721433</span>, <span class="fl">0.325438651308499</span>, <span class="fl">0.329390866243409</span>, </span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.334785138867613</span>), <span class="at">Freq =</span> <span class="fu">c</span>(<span class="dv">72404</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Vemos un ejemplo que los pesos asignados son ABSOLUTAMENTE DISTINTOS DEPENDIENDO DEL MODELO"</span>)</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">mod1=</span> final<span class="sc">$</span>iiw, <span class="at">mod2=</span> final_b<span class="sc">$</span>iiw) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">filter</span>(mod1<span class="sc">!=</span>mod2) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        mod1     mod2
1  0.1996962 3.830127
2  0.6129391 4.376810
3  0.4980109 5.125454
4  0.2382301 4.547194
5  0.5663714 3.425793
6  0.2268115 4.153721
7  0.1720342 5.678893
8  0.4969182 5.333688
9  0.1529589 3.750321
10 0.6696665 3.895218
11 0.5430455 2.042192
12 0.3793116 3.575538
13 0.4025839 3.457417
14 0.3729438 4.203298
15 0.4674447 2.872873
16 0.2808815 2.449836
17 0.5428789 8.560529
18 0.4052071 8.143959
19 0.7632280 7.063683
20 0.5840069 1.996160</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>diff_in_iiw_final<span class="ot">&lt;-</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">mod1 =</span> <span class="fu">c</span>(<span class="fl">0.199498133334888</span>, <span class="fl">0.615044327911636</span>, <span class="fl">0.498702140851273</span>, <span class="fl">0.238887400402573</span>, <span class="fl">0.564883027201795</span>, <span class="fl">0.226856508027775</span>, <span class="fl">0.172052897285973</span>, <span class="fl">0.495624040479963</span>, <span class="fl">0.152900128488306</span>, <span class="fl">0.669574361459713</span>, <span class="fl">0.543818575958686</span>, <span class="fl">0.379205064180558</span>, <span class="fl">0.402370920088421</span>, <span class="fl">0.373500499352896</span>, <span class="fl">0.467980694989343</span>, <span class="fl">0.281860985585125</span>, <span class="fl">0.544134768464911</span>, <span class="fl">0.404800245361857</span>, <span class="fl">0.763907890441244</span>, <span class="fl">0.585275800391092</span>), <span class="at">mod2 =</span> <span class="fu">c</span>(<span class="fl">3.92318595976502</span>, <span class="fl">3.44378094343031</span>, <span class="fl">4.97127471370872</span>, <span class="fl">4.5599185879251</span>, <span class="fl">3.04873855278048</span>, </span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fl">3.31979843463701</span>, <span class="fl">6.0865617052278</span>, <span class="fl">5.81549682361537</span>, <span class="fl">4.09528203750446</span>, <span class="fl">3.99883088697191</span>, <span class="fl">1.7257302695626</span>, <span class="fl">3.11919908361139</span>, <span class="fl">3.04433093376514</span>, <span class="fl">4.05407333418453</span>, <span class="fl">2.28706611143663</span>, <span class="fl">2.08872102380155</span>, <span class="fl">8.02426306030948</span>, <span class="fl">8.36617898514813</span>, <span class="fl">6.98296103354168</span>, <span class="fl">1.33559630246317</span>))</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(rms)</span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>cox_iiw_proposed<span class="ot">&lt;-</span></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>rms<span class="sc">::</span><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> </span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>          lag_tr_outcome<span class="sc">+</span> </span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>          lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a>          log_lag_dias_treat_imp_sin_na<span class="sc">+</span></span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a>          lag_comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a>          lag_policonsumo2<span class="sc">+</span> </span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb252-18"><a href="#cb252-18" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb252-19"><a href="#cb252-19" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb252-20"><a href="#cb252-20" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb252-21"><a href="#cb252-21" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb252-22"><a href="#cb252-22" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb252-23"><a href="#cb252-23" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb252-24"><a href="#cb252-24" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span> </span>
<span id="cb252-25"><a href="#cb252-25" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb252-26"><a href="#cb252-26" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb252-27"><a href="#cb252-27" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb252-28"><a href="#cb252-28" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb252-29"><a href="#cb252-29" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb252-30"><a href="#cb252-30" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb252-31"><a href="#cb252-31" aria-hidden="true" tabindex="-1"></a>          susprindum_mar <span class="sc">+</span></span>
<span id="cb252-32"><a href="#cb252-32" aria-hidden="true" tabindex="-1"></a>          <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb252-33"><a href="#cb252-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> data_mine_miss_proc2, </span>
<span id="cb252-34"><a href="#cb252-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="cn">TRUE</span>, </span>
<span id="cb252-35"><a href="#cb252-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="cn">TRUE</span>,</span>
<span id="cb252-36"><a href="#cb252-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">surv=</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-37"><a href="#cb252-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Must use x=TRUE,y=TRUE to get survival curves with time-dep. covariables</span></span>
<span id="cb252-38"><a href="#cb252-38" aria-hidden="true" tabindex="-1"></a>cox_iiw_proposed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
  Surv(lag_time, time, event)                   cluster(id) 
                        72404                             0 
               lag_tr_outcome              lag_less_90d_tr1 
                            0                             0 
log_lag_dias_treat_imp_sin_na       lag_comp_bpsc_y3_severe 
                        72404                             0 
             lag_policonsumo2                 edad_al_ing_1 
                            0                             0 
                 ano_nac_corr                  susinidum_oh 
                            0                             0 
                susinidum_coc                 susinidum_pbc 
                            0                             0 
                susinidum_mar               psycom_dum_with 
                            0                             0 
             psycom_dum_study            freq_cons_dum_5day 
                            0                             0 
           cond_oc_dum_2inact            cond_oc_dum_3unemp 
                            0                             0 
                susprindum_oh                susprindum_coc 
                            0                             0 
               susprindum_pbc                susprindum_mar 
                            0                             0 
           tipo_de_plan_2_mod 
                            0 

Cox Proportional Hazards Model
 
 rms::cph(formula = Surv(lag_time, time, event) ~ cluster(id) + 
     lag_tr_outcome + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + 
     lag_comp_bpsc_y3_severe + lag_policonsumo2 + edad_al_ing_1 + 
     ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
     susinidum_mar + psycom_dum_with + psycom_dum_study + freq_cons_dum_5day + 
     cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_oh + 
     susprindum_coc + susprindum_pbc + susprindum_mar + strat(tipo_de_plan_2_mod), 
     data = data_mine_miss_proc2, x = TRUE, y = TRUE, surv = TRUE)
 
 
                                             Status
 Stratum                                      No Event Event
   tipo_de_plan_2_mod=basic ambulatory               0  5622
   tipo_de_plan_2_mod=GP intensive ambulatory        0  6501
   tipo_de_plan_2_mod=GP residential                 0  3034
   tipo_de_plan_2_mod=WO intensive ambulatory        0  1015
   tipo_de_plan_2_mod=WO residential                 0  1499
 
                           Model Tests       Discrimination    
                                                    Indexes    
 Obs       17671    LR chi2    3826.50       R2       0.195    
 Events    17671    d.f.            20    R2(20,17671)0.194    
 Center 474.9181    Pr(&gt; chi2)  0.0000       Dxy      0.255    
                    Score chi2 3855.18                         
                    Pr(&gt; chi2)  0.0000                         
 
                               Coef    S.E.   Wald Z Pr(&gt;|Z|)
 lag_tr_outcome                 0.1545 0.0176  8.76  &lt;0.0001 
 lag_less_90d_tr1               0.1033 0.0242  4.27  &lt;0.0001 
 log_lag_dias_treat_imp_sin_na -0.0222 0.0100 -2.22  0.0263  
 lag_comp_bpsc_y3_severe        0.0584 0.0165  3.54  0.0004  
 lag_policonsumo2              -0.0181 0.0186 -0.97  0.3314  
 edad_al_ing_1                  0.2345 0.0039 60.56  &lt;0.0001 
 ano_nac_corr                   0.2359 0.0038 61.97  &lt;0.0001 
 susinidum_oh                   0.0441 0.0465  0.95  0.3436  
 susinidum_coc                  0.1096 0.0573  1.91  0.0558  
 susinidum_pbc                  0.1586 0.0527  3.01  0.0026  
 susinidum_mar                  0.1589 0.0474  3.35  0.0008  
 psycom_dum_with                0.0174 0.0161  1.08  0.2783  
 psycom_dum_study               0.0304 0.0224  1.36  0.1741  
 freq_cons_dum_5day             0.0135 0.0155  0.87  0.3834  
 cond_oc_dum_2inact             0.0581 0.0214  2.72  0.0066  
 cond_oc_dum_3unemp             0.0621 0.0171  3.63  0.0003  
 susprindum_oh                 -0.1040 0.0626 -1.66  0.0968  
 susprindum_coc                -0.1105 0.0636 -1.74  0.0822  
 susprindum_pbc                -0.0906 0.0622 -1.46  0.1452  
 susprindum_mar                -0.1151 0.0688 -1.67  0.0945  
 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox Proportional Hazards Model</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rms::cph(formula = Surv(lag_time, time, event) ~ lag_tr_outcome + </span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + lag_comp_bpsc_y3_severe + </span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + susinidum_oh + </span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + </span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar + cluster(id) + strat(tipo_de_plan_2_mod), </span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data_mine_miss_proc2, x = TRUE, y = TRUE, surv = TRUE)</span></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                             Status</span></span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratum                                      No Event Event</span></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory               0  5622</span></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory        0  6501</span></span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential                 0  3034</span></span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory        0  1015</span></span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential                 0  1499</span></span>
<span id="cb254-20"><a href="#cb254-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb254-21"><a href="#cb254-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                           Model Tests       Discrimination    </span></span>
<span id="cb254-22"><a href="#cb254-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                    Indexes    </span></span>
<span id="cb254-23"><a href="#cb254-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Obs       17671    LR chi2    3826.50       R2       0.195    </span></span>
<span id="cb254-24"><a href="#cb254-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Events    17671    d.f.            20    R2(20,17671)0.194    </span></span>
<span id="cb254-25"><a href="#cb254-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Center 474.9181    Pr(&gt; chi2)  0.0000       Dxy      0.255    </span></span>
<span id="cb254-26"><a href="#cb254-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Score chi2 3855.18                         </span></span>
<span id="cb254-27"><a href="#cb254-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Pr(&gt; chi2)  0.0000                         </span></span>
<span id="cb254-28"><a href="#cb254-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb254-29"><a href="#cb254-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                               Coef    S.E.   Wald Z Pr(&gt;|Z|)</span></span>
<span id="cb254-30"><a href="#cb254-30" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 0.1545 0.0176  8.76  &lt;0.0001 </span></span>
<span id="cb254-31"><a href="#cb254-31" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1               0.1033 0.0242  4.27  &lt;0.0001 </span></span>
<span id="cb254-32"><a href="#cb254-32" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na -0.0222 0.0100 -2.22  0.0263  </span></span>
<span id="cb254-33"><a href="#cb254-33" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        0.0584 0.0165  3.54  0.0004  </span></span>
<span id="cb254-34"><a href="#cb254-34" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2              -0.0181 0.0186 -0.97  0.3314  </span></span>
<span id="cb254-35"><a href="#cb254-35" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.2345 0.0039 60.56  &lt;0.0001 </span></span>
<span id="cb254-36"><a href="#cb254-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.2359 0.0038 61.97  &lt;0.0001 </span></span>
<span id="cb254-37"><a href="#cb254-37" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.0441 0.0465  0.95  0.3436  </span></span>
<span id="cb254-38"><a href="#cb254-38" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                  0.1096 0.0573  1.91  0.0558  </span></span>
<span id="cb254-39"><a href="#cb254-39" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.1586 0.0527  3.01  0.0026  </span></span>
<span id="cb254-40"><a href="#cb254-40" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.1589 0.0474  3.35  0.0008  </span></span>
<span id="cb254-41"><a href="#cb254-41" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                0.0174 0.0161  1.08  0.2783  </span></span>
<span id="cb254-42"><a href="#cb254-42" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               0.0304 0.0224  1.36  0.1741  </span></span>
<span id="cb254-43"><a href="#cb254-43" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.0135 0.0155  0.87  0.3834  </span></span>
<span id="cb254-44"><a href="#cb254-44" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.0581 0.0214  2.72  0.0066  </span></span>
<span id="cb254-45"><a href="#cb254-45" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.0621 0.0171  3.63  0.0003  </span></span>
<span id="cb254-46"><a href="#cb254-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.1040 0.0626 -1.66  0.0968  </span></span>
<span id="cb254-47"><a href="#cb254-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                -0.1105 0.0636 -1.74  0.0822  </span></span>
<span id="cb254-48"><a href="#cb254-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                -0.0906 0.0622 -1.46  0.1452  </span></span>
<span id="cb254-49"><a href="#cb254-49" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                -0.1151 0.0688 -1.67  0.0945 </span></span>
<span id="cb254-50"><a href="#cb254-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-51"><a href="#cb254-51" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 chisq df      p
lag_tr_outcome                 53.1085  1 0.0000
lag_less_90d_tr1              130.0606  1 0.0000
log_lag_dias_treat_imp_sin_na 142.4076  1 0.0000
lag_comp_bpsc_y3_severe        20.3681  1 0.0000
lag_policonsumo2                8.3301  1 0.0039
edad_al_ing_1                  33.2395  1 0.0000
ano_nac_corr                    7.7556  1 0.0054
susinidum_oh                   40.0796  1 0.0000
susinidum_coc                   0.9605  1 0.3271
susinidum_pbc                   6.6977  1 0.0097
susinidum_mar                  24.9223  1 0.0000
psycom_dum_with                16.2090  1 0.0001
psycom_dum_study               37.2938  1 0.0000
freq_cons_dum_5day              2.1105  1 0.1463
cond_oc_dum_2inact              3.1074  1 0.0779
cond_oc_dum_3unemp             14.3746  1 0.0001
susprindum_oh                  24.9308  1 0.0000
susprindum_coc                  0.7316  1 0.3924
susprindum_pbc                 19.7982  1 0.0000
susprindum_mar                  2.6082  1 0.1063
GLOBAL                        495.5153 20 0.0000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 53.1085  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1              130.0606  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na 142.4076  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        20.3681  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                8.3301  1 0.0039 #</span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  33.2395  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    7.7556  1 0.0054 #</span></span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   40.0796  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                   0.9605  1 0.3271</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   6.6977  1 0.0097</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  24.9223  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                16.2090  1 0.0001 </span><span class="al">###</span></span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               37.2938  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              2.1105  1 0.1463</span></span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              3.1074  1 0.0779</span></span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             14.3746  1 0.0001 </span><span class="al">###</span></span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  24.9308  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  0.7316  1 0.3924</span></span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 19.7982  1 0.0000 </span><span class="al">###</span></span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  2.6082  1 0.1063</span></span>
<span id="cb256-21"><a href="#cb256-21" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        495.5153 20 0.0000 </span></span>
<span id="cb256-22"><a href="#cb256-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-23"><a href="#cb256-23" aria-hidden="true" tabindex="-1"></a>cox_iiw_restr_proposed<span class="ot">&lt;-</span></span>
<span id="cb256-24"><a href="#cb256-24" aria-hidden="true" tabindex="-1"></a>rms<span class="sc">::</span><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> </span>
<span id="cb256-25"><a href="#cb256-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb256-26"><a href="#cb256-26" aria-hidden="true" tabindex="-1"></a>          lag_tr_outcome<span class="sc">+</span> </span>
<span id="cb256-27"><a href="#cb256-27" aria-hidden="true" tabindex="-1"></a>          lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb256-28"><a href="#cb256-28" aria-hidden="true" tabindex="-1"></a>          log_lag_dias_treat_imp_sin_na<span class="sc">+</span></span>
<span id="cb256-29"><a href="#cb256-29" aria-hidden="true" tabindex="-1"></a>          lag_comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb256-30"><a href="#cb256-30" aria-hidden="true" tabindex="-1"></a>          lag_policonsumo2<span class="sc">+</span> </span>
<span id="cb256-31"><a href="#cb256-31" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb256-32"><a href="#cb256-32" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb256-33"><a href="#cb256-33" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb256-34"><a href="#cb256-34" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb256-35"><a href="#cb256-35" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb256-36"><a href="#cb256-36" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb256-37"><a href="#cb256-37" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb256-38"><a href="#cb256-38" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span> </span>
<span id="cb256-39"><a href="#cb256-39" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb256-40"><a href="#cb256-40" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb256-41"><a href="#cb256-41" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb256-42"><a href="#cb256-42" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb256-43"><a href="#cb256-43" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb256-44"><a href="#cb256-44" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb256-45"><a href="#cb256-45" aria-hidden="true" tabindex="-1"></a>          susprindum_mar <span class="sc">+</span></span>
<span id="cb256-46"><a href="#cb256-46" aria-hidden="true" tabindex="-1"></a>          <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb256-47"><a href="#cb256-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> data_mine_miss_restr_proc2, </span>
<span id="cb256-48"><a href="#cb256-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="cn">TRUE</span>, </span>
<span id="cb256-49"><a href="#cb256-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="cn">TRUE</span>,</span>
<span id="cb256-50"><a href="#cb256-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">surv=</span> <span class="cn">TRUE</span>)</span>
<span id="cb256-51"><a href="#cb256-51" aria-hidden="true" tabindex="-1"></a><span class="co">#Must use x=TRUE,y=TRUE to get survival curves with time-dep. covariables</span></span>
<span id="cb256-52"><a href="#cb256-52" aria-hidden="true" tabindex="-1"></a>cox_iiw_restr_proposed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
  Surv(lag_time, time, event)                   cluster(id) 
                        13317                             0 
               lag_tr_outcome              lag_less_90d_tr1 
                            0                             0 
log_lag_dias_treat_imp_sin_na       lag_comp_bpsc_y3_severe 
                        13317                             0 
             lag_policonsumo2                 edad_al_ing_1 
                            0                             0 
                 ano_nac_corr                  susinidum_oh 
                            0                             0 
                susinidum_coc                 susinidum_pbc 
                            0                             0 
                susinidum_mar               psycom_dum_with 
                            0                             0 
             psycom_dum_study            freq_cons_dum_5day 
                            0                             0 
           cond_oc_dum_2inact            cond_oc_dum_3unemp 
                            0                             0 
                susprindum_oh                susprindum_coc 
                            0                             0 
               susprindum_pbc                susprindum_mar 
                            0                             0 
           tipo_de_plan_2_mod 
                            0 

Cox Proportional Hazards Model
 
 rms::cph(formula = Surv(lag_time, time, event) ~ cluster(id) + 
     lag_tr_outcome + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + 
     lag_comp_bpsc_y3_severe + lag_policonsumo2 + edad_al_ing_1 + 
     ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
     susinidum_mar + psycom_dum_with + psycom_dum_study + freq_cons_dum_5day + 
     cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_oh + 
     susprindum_coc + susprindum_pbc + susprindum_mar + strat(tipo_de_plan_2_mod), 
     data = data_mine_miss_restr_proc2, x = TRUE, y = TRUE, surv = TRUE)
 
 
                                             Status
 Stratum                                      No Event Event
   tipo_de_plan_2_mod=basic ambulatory               0  5633
   tipo_de_plan_2_mod=GP intensive ambulatory        0  6499
   tipo_de_plan_2_mod=GP residential                 0  3026
   tipo_de_plan_2_mod=WO intensive ambulatory        0  1015
   tipo_de_plan_2_mod=WO residential                 0  1498
 
                           Model Tests       Discrimination    
                                                    Indexes    
 Obs       17671    LR chi2    3826.06       R2       0.195    
 Events    17671    d.f.            20    R2(20,17671)0.194    
 Center 474.8266    Pr(&gt; chi2)  0.0000       Dxy      0.255    
                    Score chi2 3854.74                         
                    Pr(&gt; chi2)  0.0000                         
 
                               Coef    S.E.   Wald Z Pr(&gt;|Z|)
 lag_tr_outcome                 0.1540 0.0176  8.73  &lt;0.0001 
 lag_less_90d_tr1               0.1036 0.0242  4.28  &lt;0.0001 
 log_lag_dias_treat_imp_sin_na -0.0223 0.0100 -2.23  0.0257  
 lag_comp_bpsc_y3_severe        0.0590 0.0165  3.58  0.0003  
 lag_policonsumo2              -0.0181 0.0186 -0.97  0.3312  
 edad_al_ing_1                  0.2345 0.0039 60.55  &lt;0.0001 
 ano_nac_corr                   0.2359 0.0038 61.96  &lt;0.0001 
 susinidum_oh                   0.0441 0.0465  0.95  0.3434  
 susinidum_coc                  0.1097 0.0573  1.91  0.0555  
 susinidum_pbc                  0.1589 0.0527  3.01  0.0026  
 susinidum_mar                  0.1589 0.0474  3.35  0.0008  
 psycom_dum_with                0.0174 0.0161  1.09  0.2778  
 psycom_dum_study               0.0303 0.0224  1.35  0.1762  
 freq_cons_dum_5day             0.0139 0.0155  0.89  0.3716  
 cond_oc_dum_2inact             0.0581 0.0214  2.72  0.0065  
 cond_oc_dum_3unemp             0.0625 0.0171  3.66  0.0003  
 susprindum_oh                 -0.1038 0.0626 -1.66  0.0973  
 susprindum_coc                -0.1104 0.0636 -1.74  0.0826  
 susprindum_pbc                -0.0902 0.0622 -1.45  0.1467  
 susprindum_mar                -0.1150 0.0688 -1.67  0.0947  
 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox Proportional Hazards Model</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rms::cph(formula = Surv(lag_time, time, event) ~ lag_tr_outcome + </span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + lag_comp_bpsc_y3_severe + </span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + susinidum_oh + </span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + </span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar + cluster(id) + strat(tipo_de_plan_2_mod), </span></span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data_mine_miss_restr_proc2, x = TRUE, y = TRUE, surv = TRUE)</span></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                             Status</span></span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratum                                      No Event Event</span></span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory               0  5622</span></span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory        0  6501</span></span>
<span id="cb258-17"><a href="#cb258-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential                 0  3034</span></span>
<span id="cb258-18"><a href="#cb258-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory        0  1015</span></span>
<span id="cb258-19"><a href="#cb258-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential                 0  1499</span></span>
<span id="cb258-20"><a href="#cb258-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb258-21"><a href="#cb258-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                           Model Tests       Discrimination    </span></span>
<span id="cb258-22"><a href="#cb258-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                    Indexes    </span></span>
<span id="cb258-23"><a href="#cb258-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Obs       17671    LR chi2    3826.50       R2       0.195    </span></span>
<span id="cb258-24"><a href="#cb258-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Events    17671    d.f.            20    R2(20,17671)0.194    </span></span>
<span id="cb258-25"><a href="#cb258-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Center 474.9181    Pr(&gt; chi2)  0.0000       Dxy      0.255    </span></span>
<span id="cb258-26"><a href="#cb258-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Score chi2 3855.18                         </span></span>
<span id="cb258-27"><a href="#cb258-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                    Pr(&gt; chi2)  0.0000                         </span></span>
<span id="cb258-28"><a href="#cb258-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb258-29"><a href="#cb258-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                               Coef    S.E.   Wald Z Pr(&gt;|Z|)</span></span>
<span id="cb258-30"><a href="#cb258-30" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 0.1545 0.0176  8.76  &lt;0.0001 </span></span>
<span id="cb258-31"><a href="#cb258-31" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1               0.1033 0.0242  4.27  &lt;0.0001 </span></span>
<span id="cb258-32"><a href="#cb258-32" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na -0.0222 0.0100 -2.22  0.0263  </span></span>
<span id="cb258-33"><a href="#cb258-33" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        0.0584 0.0165  3.54  0.0004  </span></span>
<span id="cb258-34"><a href="#cb258-34" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2              -0.0181 0.0186 -0.97  0.3314  </span></span>
<span id="cb258-35"><a href="#cb258-35" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.2345 0.0039 60.56  &lt;0.0001 </span></span>
<span id="cb258-36"><a href="#cb258-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.2359 0.0038 61.97  &lt;0.0001 </span></span>
<span id="cb258-37"><a href="#cb258-37" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.0441 0.0465  0.95  0.3436  </span></span>
<span id="cb258-38"><a href="#cb258-38" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                  0.1096 0.0573  1.91  0.0558  </span></span>
<span id="cb258-39"><a href="#cb258-39" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.1586 0.0527  3.01  0.0026  </span></span>
<span id="cb258-40"><a href="#cb258-40" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.1589 0.0474  3.35  0.0008  </span></span>
<span id="cb258-41"><a href="#cb258-41" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                0.0174 0.0161  1.08  0.2783  </span></span>
<span id="cb258-42"><a href="#cb258-42" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               0.0304 0.0224  1.36  0.1741  </span></span>
<span id="cb258-43"><a href="#cb258-43" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.0135 0.0155  0.87  0.3834  </span></span>
<span id="cb258-44"><a href="#cb258-44" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.0581 0.0214  2.72  0.0066  </span></span>
<span id="cb258-45"><a href="#cb258-45" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.0621 0.0171  3.63  0.0003  </span></span>
<span id="cb258-46"><a href="#cb258-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.1040 0.0626 -1.66  0.0968  </span></span>
<span id="cb258-47"><a href="#cb258-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                -0.1105 0.0636 -1.74  0.0822  </span></span>
<span id="cb258-48"><a href="#cb258-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                -0.0906 0.0622 -1.46  0.1452  </span></span>
<span id="cb258-49"><a href="#cb258-49" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                -0.1151 0.0688 -1.67  0.0945  </span></span>
<span id="cb258-50"><a href="#cb258-50" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(cox_iiw_restr_proposed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                chisq df       p
lag_tr_outcome                 52.745  1 3.8e-13
lag_less_90d_tr1              130.440  1 &lt; 2e-16
log_lag_dias_treat_imp_sin_na 143.001  1 &lt; 2e-16
lag_comp_bpsc_y3_severe        20.975  1 4.7e-06
lag_policonsumo2                8.383  1 0.00379
edad_al_ing_1                  33.324  1 7.8e-09
ano_nac_corr                    7.786  1 0.00526
susinidum_oh                   40.366  1 2.1e-10
susinidum_coc                   0.960  1 0.32728
susinidum_pbc                   6.850  1 0.00887
susinidum_mar                  24.998  1 5.7e-07
psycom_dum_with                16.153  1 5.8e-05
psycom_dum_study               37.275  1 1.0e-09
freq_cons_dum_5day              2.262  1 0.13261
cond_oc_dum_2inact              3.092  1 0.07866
cond_oc_dum_3unemp             14.720  1 0.00012
susprindum_oh                  25.145  1 5.3e-07
susprindum_coc                  0.758  1 0.38382
susprindum_pbc                 20.116  1 7.3e-06
susprindum_mar                  2.568  1 0.10906
GLOBAL                        497.106 20 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 chisq df       p</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 53.109  1 3.2e-13</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1              130.061  1 &lt; 2e-16</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na 142.408  1 &lt; 2e-16</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        20.368  1 6.4e-06</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                8.330  1 0.00390</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  33.239  1 8.1e-09</span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    7.756  1 0.00535</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   40.080  1 2.4e-10</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                   0.961  1 0.32706</span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   6.698  1 0.00965</span></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  24.922  1 6.0e-07</span></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                16.209  1 5.7e-05</span></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               37.294  1 1.0e-09</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              2.110  1 0.14630</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              3.107  1 0.07794</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             14.375  1 0.00015</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  24.931  1 5.9e-07</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  0.732  1 0.39237</span></span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 19.798  1 8.6e-06</span></span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  2.608  1 0.10631</span></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        495.515 20 &lt; 2e-16</span></span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"552.545, schoenfeld residuals; now, 496"</span>)</span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(cox_iiw_proposed, <span class="st">"scaledsch"</span>)</span>
<span id="cb260-27"><a href="#cb260-27" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res)[[<span class="dv">1</span>]])</span>
<span id="cb260-28"><a href="#cb260-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-29"><a href="#cb260-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-30"><a href="#cb260-30" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb260-31"><a href="#cb260-31" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb260-32"><a href="#cb260-32" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb260-33"><a href="#cb260-33" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span> <span class="fu">paste0</span>(folder_path,<span class="st">"zph/schoefeld_res_all_variables_240421.jpg"</span>), <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">quality =</span> <span class="dv">600</span>)<span class="co">#Users/CISS Fondecyt/</span></span>
<span id="cb260-34"><a href="#cb260-34" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>)) </span>
<span id="cb260-35"><a href="#cb260-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-36"><a href="#cb260-36" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"lag_tr_outcome"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb260-37"><a href="#cb260-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z2))</span>
<span id="cb260-38"><a href="#cb260-38" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"lag_tr_outcome"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-39"><a href="#cb260-39" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_tr_outcome"</span>)</span>
<span id="cb260-40"><a href="#cb260-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-41"><a href="#cb260-41" aria-hidden="true" tabindex="-1"></a>z3 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"lag_less_90d_tr1"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residual</span></span>
<span id="cb260-42"><a href="#cb260-42" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z3))</span>
<span id="cb260-43"><a href="#cb260-43" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"lag_less_90d_tr1"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-44"><a href="#cb260-44" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_less_90d_tr1"</span>)</span>
<span id="cb260-45"><a href="#cb260-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-46"><a href="#cb260-46" aria-hidden="true" tabindex="-1"></a>z4 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb260-47"><a href="#cb260-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z4))</span>
<span id="cb260-48"><a href="#cb260-48" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-49"><a href="#cb260-49" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., log_lag_dias_treat_imp_sin_na"</span>)</span>
<span id="cb260-50"><a href="#cb260-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-51"><a href="#cb260-51" aria-hidden="true" tabindex="-1"></a>z5 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"lag_comp_bpsc_y3_severe"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb260-52"><a href="#cb260-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z5))</span>
<span id="cb260-53"><a href="#cb260-53" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"lag_comp_bpsc_y3_severe"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-54"><a href="#cb260-54" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_comp_bpsc_y3_severe"</span>)</span>
<span id="cb260-55"><a href="#cb260-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-56"><a href="#cb260-56" aria-hidden="true" tabindex="-1"></a>z6 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"lag_policonsumo2"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb260-57"><a href="#cb260-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z6))</span>
<span id="cb260-58"><a href="#cb260-58" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"lag_policonsumo2"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-59"><a href="#cb260-59" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_policonsumo2"</span>)</span>
<span id="cb260-60"><a href="#cb260-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-61"><a href="#cb260-61" aria-hidden="true" tabindex="-1"></a>z7 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"edad_al_ing_1"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb260-62"><a href="#cb260-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z7))</span>
<span id="cb260-63"><a href="#cb260-63" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"edad_al_ing_1"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-64"><a href="#cb260-64" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., edad_al_ing_1"</span>)</span>
<span id="cb260-65"><a href="#cb260-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-66"><a href="#cb260-66" aria-hidden="true" tabindex="-1"></a>z8 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"susinidum_oh"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb260-67"><a href="#cb260-67" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z8))</span>
<span id="cb260-68"><a href="#cb260-68" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"susinidum_oh"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-69"><a href="#cb260-69" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., susinidum_oh"</span>)</span>
<span id="cb260-70"><a href="#cb260-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-71"><a href="#cb260-71" aria-hidden="true" tabindex="-1"></a>z9 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res[,<span class="st">"psycom_dum_study"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb260-72"><a href="#cb260-72" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z9))</span>
<span id="cb260-73"><a href="#cb260-73" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time, res[,<span class="st">"psycom_dum_study"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb260-74"><a href="#cb260-74" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., psycom_dum_study"</span>)</span>
<span id="cb260-75"><a href="#cb260-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-76"><a href="#cb260-76" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_}</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_}</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Explore residuals in restricted subsample"</span>)</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_}#_#_#_#_#_#_#_#_#_#_#_}</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>res_restr <span class="ot">&lt;-</span> <span class="fu">resid</span>(cox_iiw_restr_proposed, <span class="st">"scaledsch"</span>)</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>time_restr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res_restr)[[<span class="dv">1</span>]])</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span> <span class="fu">paste0</span>(folder_path,<span class="st">"zph/schoefeld_res_all_variables_restr_240428.jpg"</span>), <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">quality =</span> <span class="dv">600</span>)<span class="co">#Users/CISS Fondecyt/</span></span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>)) </span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>z2_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"lag_tr_outcome"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_restr, <span class="fu">fitted</span>(z2_restr))</span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"lag_tr_outcome"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_tr_outcome"</span>)</span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>z3_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"lag_less_90d_tr1"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residual</span></span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_restr, <span class="fu">fitted</span>(z3_restr))</span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"lag_less_90d_tr1"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_less_90d_tr1"</span>)</span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a>z4_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb262-28"><a href="#cb262-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, <span class="fu">fitted</span>(z4_restr))</span>
<span id="cb262-29"><a href="#cb262-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-30"><a href="#cb262-30" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., log_lag_dias_treat_imp_sin_na"</span>)</span>
<span id="cb262-31"><a href="#cb262-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-32"><a href="#cb262-32" aria-hidden="true" tabindex="-1"></a>z5_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"lag_comp_bpsc_y3_severe"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb262-33"><a href="#cb262-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_restr, <span class="fu">fitted</span>(z5_restr))</span>
<span id="cb262-34"><a href="#cb262-34" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"lag_comp_bpsc_y3_severe"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-35"><a href="#cb262-35" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_comp_bpsc_y3_severe"</span>)</span>
<span id="cb262-36"><a href="#cb262-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-37"><a href="#cb262-37" aria-hidden="true" tabindex="-1"></a>z6_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"lag_policonsumo2"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb262-38"><a href="#cb262-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_restr, <span class="fu">fitted</span>(z6_restr))</span>
<span id="cb262-39"><a href="#cb262-39" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"lag_policonsumo2"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-40"><a href="#cb262-40" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_policonsumo2"</span>)</span>
<span id="cb262-41"><a href="#cb262-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-42"><a href="#cb262-42" aria-hidden="true" tabindex="-1"></a>z7_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"edad_al_ing_1"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb262-43"><a href="#cb262-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_restr, <span class="fu">fitted</span>(z7_restr))</span>
<span id="cb262-44"><a href="#cb262-44" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"edad_al_ing_1"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-45"><a href="#cb262-45" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., edad_al_ing_1"</span>)</span>
<span id="cb262-46"><a href="#cb262-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-47"><a href="#cb262-47" aria-hidden="true" tabindex="-1"></a>z8_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"susinidum_oh"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb262-48"><a href="#cb262-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_restr, <span class="fu">fitted</span>(z8_restr))</span>
<span id="cb262-49"><a href="#cb262-49" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"susinidum_oh"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-50"><a href="#cb262-50" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., susinidum_oh"</span>)</span>
<span id="cb262-51"><a href="#cb262-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-52"><a href="#cb262-52" aria-hidden="true" tabindex="-1"></a>z9_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_restr[,<span class="st">"psycom_dum_study"</span>] <span class="sc">~</span> time, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals</span></span>
<span id="cb262-53"><a href="#cb262-53" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time_restr, <span class="fu">fitted</span>(z9_restr))</span>
<span id="cb262-54"><a href="#cb262-54" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time_restr, res_restr[,<span class="st">"psycom_dum_study"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb262-55"><a href="#cb262-55" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., psycom_dum_study"</span>)</span>
<span id="cb262-56"><a href="#cb262-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-57"><a href="#cb262-57" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co">#save.image("C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/20240422_avance_iiw.RData")</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_}</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)[<span class="fu">which</span>(<span class="fu">attr</span>(cox_iiw_proposed<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"log_lag_dias_treat_imp_sin_na"</span>)], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>cox_iiw_proposed<span class="sc">$</span>coefficients[<span class="st">"log_lag_dias_treat_imp_sin_na"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-3-iiw-weights-integrated-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_}</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>km_days_tr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> log_lag_dias_treat_imp_sin_na<span class="sc">+</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_proc2)</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_days_tr, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,</span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by lag_less_90d_tr1"</span>)</span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-3-iiw-weights-integrated-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Restricted"</span>)</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(cox_iiw_restr_proposed)[<span class="fu">which</span>(<span class="fu">attr</span>(cox_iiw_restr_proposed<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"log_lag_dias_treat_imp_sin_na"</span>)], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>cox_iiw_restr_proposed<span class="sc">$</span>coefficients[<span class="st">"log_lag_dias_treat_imp_sin_na"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-3-iiw-weights-integrated-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_}</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>km_days_tr_restr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> log_lag_dias_treat_imp_sin_na<span class="sc">+</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_days_tr_restr, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by log_lag_dias_treat_imp_sin_na (restr)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-3-iiw-weights-integrated-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co">#legend("bottomright", legend=c("=0", "=1"), col=c("black", "red"), lty=1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="transforming-variables" class="level4">
<h4 class="anchored" data-anchor-id="transforming-variables">Transforming variables</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load("C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/20240422_avance_iiw.RData")</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="co">#load("E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/20240422_avance_iiw.RData")</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(splines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Loading required package: splines</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Primero necesito buscar log_lag_dias_treat_imp_sin_na , luego lag_comp_bpsc_y3_severe, edad_al_ing_1 y porc_pobr"</span>)</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="co">#specs_dias_treat &lt;- paste0("log_lag_dias_treat_imp_sin_na *", c("time", "poly(time, 3)", "poly(time, 4)", "poly(time, 5)", "poly(time, 6)", "bs(time, 3)", "bs(time, 4)", "bs(time, 5)", "bs(time, 6)", "ns(time, 3)", "ns(time, 4)", "ns(time, 5)", "ns(time, 6)", "rcs(time, 3)", "rcs(time, 4)", "rcs(time, 5)", "rcs(time, 6)"))</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>specs_dias_treat <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">""</span>, <span class="fu">c</span>(<span class="st">"lag_dias_treat_imp_sin_na"</span>, <span class="st">"poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 3)"</span>, <span class="st">"poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 4)"</span>, <span class="st">"poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 5)"</span>, <span class="st">"poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 6)"</span>, <span class="st">"bs(log_lag_dias_treat_imp_sin_na, 3)"</span>, <span class="st">"bs(log_lag_dias_treat_imp_sin_na, 4)"</span>, <span class="st">"bs(log_lag_dias_treat_imp_sin_na, 5)"</span>, <span class="st">"bs(log_lag_dias_treat_imp_sin_na, 6)"</span>, <span class="st">"ns(log_lag_dias_treat_imp_sin_na, 3)"</span>, <span class="st">"ns(log_lag_dias_treat_imp_sin_na, 4)"</span>, <span class="st">"ns(log_lag_dias_treat_imp_sin_na, 5)"</span>, <span class="st">"ns(log_lag_dias_treat_imp_sin_na, 6)"</span>, <span class="st">"rcs(log_lag_dias_treat_imp_sin_na, 3)"</span>, <span class="st">"rcs(log_lag_dias_treat_imp_sin_na, 4)"</span>, <span class="st">"rcs(log_lag_dias_treat_imp_sin_na, 5)"</span>, <span class="st">"rcs(log_lag_dias_treat_imp_sin_na, 6)"</span>))</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>aic_values0 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span><span class="fu">length</span>(specs_dias_treat))</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>coxzph_values0 <span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">length=</span><span class="fu">length</span>(specs_dias_treat))</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(specs_dias_treat)) {</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> specs_dias_treat[i]</span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># TryCatch block to handle errors during model fitting</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#result &lt;- tryCatch({</span></span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id) +</span></span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome + </span></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1 +"</span>,</span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a>            l,</span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"lag_comp_bpsc_y3_severe + </span></span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh +</span></span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc +</span></span>
<span id="cb270-22"><a href="#cb270-22" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb270-27"><a href="#cb270-27" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb270-28"><a href="#cb270-28" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb270-29"><a href="#cb270-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb270-30"><a href="#cb270-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb270-31"><a href="#cb270-31" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb270-32"><a href="#cb270-32" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar +</span></span>
<span id="cb270-33"><a href="#cb270-33" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2)"</span>, <span class="at">sep=</span><span class="st">" +"</span>)), </span>
<span id="cb270-34"><a href="#cb270-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>data_mine_miss_proc2, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb270-35"><a href="#cb270-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb270-36"><a href="#cb270-36" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="fu">extractAIC</span>(model)[[<span class="dv">2</span>]]</span>
<span id="cb270-37"><a href="#cb270-37" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>]</span>
<span id="cb270-38"><a href="#cb270-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-39"><a href="#cb270-39" aria-hidden="true" tabindex="-1"></a>   <span class="co"># return(c(aic_val, cox_zph_val))</span></span>
<span id="cb270-40"><a href="#cb270-40" aria-hidden="true" tabindex="-1"></a><span class="co">#  }, error = function(e) {</span></span>
<span id="cb270-41"><a href="#cb270-41" aria-hidden="true" tabindex="-1"></a><span class="co">#    return(c(NA, NA))</span></span>
<span id="cb270-42"><a href="#cb270-42" aria-hidden="true" tabindex="-1"></a> <span class="co"># })</span></span>
<span id="cb270-43"><a href="#cb270-43" aria-hidden="true" tabindex="-1"></a>    aic_values0[i] <span class="ot">&lt;-</span> aic_val</span>
<span id="cb270-44"><a href="#cb270-44" aria-hidden="true" tabindex="-1"></a>    coxzph_values0[i] <span class="ot">&lt;-</span> cox_zph_val</span>
<span id="cb270-45"><a href="#cb270-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Spec: "</span>, l, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb270-46"><a href="#cb270-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"AIC: "</span>, aic_val[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb270-47"><a href="#cb270-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Cox zph test statistic: "</span>, cox_zph_val[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))     </span>
<span id="cb270-48"><a href="#cb270-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spec:  lag_dias_treat_imp_sin_na 
NULL
AIC:  258772.431420878 
NULL
Cox zph test statistic:  700.698782419001 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 3) 
NULL
AIC:  258752.758407148 
NULL
Cox zph test statistic:  681.320358260574 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 4) 
NULL
AIC:  258752.352037703 
NULL
Cox zph test statistic:  685.49092454129 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 5) 
NULL
AIC:  258754.237212064 
NULL
Cox zph test statistic:  688.359919424507 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 6) 
NULL
AIC:  258756.065355281 
NULL
Cox zph test statistic:  699.028740090731 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 3) 
NULL
AIC:  258752.758407148 
NULL
Cox zph test statistic:  681.32035826058 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 4) 
NULL
AIC:  258752.591529064 
NULL
Cox zph test statistic:  692.29531570604 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 5) 
NULL
AIC:  258754.375773626 
NULL
Cox zph test statistic:  692.851794860437 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 6) 
NULL
AIC:  258755.643123221 
NULL
Cox zph test statistic:  692.08808495201 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 3) 
NULL
AIC:  258751.283635165 
NULL
Cox zph test statistic:  686.265288516322 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 4) 
NULL
AIC:  258753.142150926 
NULL
Cox zph test statistic:  689.263524577162 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 5) 
NULL
AIC:  258754.209648194 
NULL
Cox zph test statistic:  688.709704889273 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 6) 
NULL
AIC:  258755.749792632 
NULL
Cox zph test statistic:  688.462498438466 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 3) 
NULL
AIC:  258770.719152328 
NULL
Cox zph test statistic:  684.053264675061 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 4) 
NULL
AIC:  258769.093325505 
NULL
Cox zph test statistic:  690.115532063767 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 5) 
NULL
AIC:  258770.713482787 
NULL
Cox zph test statistic:  693.692481658824 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 6) 
NULL
AIC:  258769.353464904 
NULL
Cox zph test statistic:  697.798435975237 
NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"There was no model that improved cox zph of the restricted sample (vs. "</span>, <span class="fu">round</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),<span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>There was no model that improved cox zph of the restricted sample (vs.&nbsp;495.5)</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co">#There was no model that improved cox zph of the restricted sample (vs. 495.5)</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>aic_values0_restr <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length=</span><span class="fu">length</span>(specs_dias_treat))</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>coxzph_values0_restr <span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">length=</span><span class="fu">length</span>(specs_dias_treat))</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(specs_dias_treat)) {</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> specs_dias_treat[i]</span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># TryCatch block to handle errors during model fitting</span></span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#result &lt;- tryCatch({</span></span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a><span class="st">                cluster(id) +</span></span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a><span class="st">                lag_tr_outcome + </span></span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a><span class="st">                lag_less_90d_tr1 +"</span>,</span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"I(round("</span>,l,<span class="st">",2))+"</span>,</span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"lag_comp_bpsc_y3_severe + </span></span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true" tabindex="-1"></a><span class="st">                lag_policonsumo2 + </span></span>
<span id="cb273-17"><a href="#cb273-17" aria-hidden="true" tabindex="-1"></a><span class="st">                edad_al_ing_1 + </span></span>
<span id="cb273-18"><a href="#cb273-18" aria-hidden="true" tabindex="-1"></a><span class="st">                ano_nac_corr + </span></span>
<span id="cb273-19"><a href="#cb273-19" aria-hidden="true" tabindex="-1"></a><span class="st">                susinidum_oh +</span></span>
<span id="cb273-20"><a href="#cb273-20" aria-hidden="true" tabindex="-1"></a><span class="st">                susinidum_coc +</span></span>
<span id="cb273-21"><a href="#cb273-21" aria-hidden="true" tabindex="-1"></a><span class="st">                susinidum_pbc +</span></span>
<span id="cb273-22"><a href="#cb273-22" aria-hidden="true" tabindex="-1"></a><span class="st">                susinidum_mar +</span></span>
<span id="cb273-23"><a href="#cb273-23" aria-hidden="true" tabindex="-1"></a><span class="st">                psycom_dum_with +</span></span>
<span id="cb273-24"><a href="#cb273-24" aria-hidden="true" tabindex="-1"></a><span class="st">                psycom_dum_study + </span></span>
<span id="cb273-25"><a href="#cb273-25" aria-hidden="true" tabindex="-1"></a><span class="st">                freq_cons_dum_5day +</span></span>
<span id="cb273-26"><a href="#cb273-26" aria-hidden="true" tabindex="-1"></a><span class="st">                cond_oc_dum_2inact +</span></span>
<span id="cb273-27"><a href="#cb273-27" aria-hidden="true" tabindex="-1"></a><span class="st">                cond_oc_dum_3unemp +</span></span>
<span id="cb273-28"><a href="#cb273-28" aria-hidden="true" tabindex="-1"></a><span class="st">                susprindum_oh +</span></span>
<span id="cb273-29"><a href="#cb273-29" aria-hidden="true" tabindex="-1"></a><span class="st">                susprindum_coc +</span></span>
<span id="cb273-30"><a href="#cb273-30" aria-hidden="true" tabindex="-1"></a><span class="st">                susprindum_pbc +</span></span>
<span id="cb273-31"><a href="#cb273-31" aria-hidden="true" tabindex="-1"></a><span class="st">                susprindum_mar +</span></span>
<span id="cb273-32"><a href="#cb273-32" aria-hidden="true" tabindex="-1"></a><span class="st">                strat(tipo_de_plan_2_mod)"</span>, <span class="at">sep=</span><span class="st">""</span>)), </span>
<span id="cb273-33"><a href="#cb273-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>)</span>
<span id="cb273-34"><a href="#cb273-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-35"><a href="#cb273-35" aria-hidden="true" tabindex="-1"></a>    aic_val_restr <span class="ot">&lt;-</span> <span class="fu">extractAIC</span>(model)[[<span class="dv">2</span>]]</span>
<span id="cb273-36"><a href="#cb273-36" aria-hidden="true" tabindex="-1"></a>    cox_zph_val_restr <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>]</span>
<span id="cb273-37"><a href="#cb273-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-38"><a href="#cb273-38" aria-hidden="true" tabindex="-1"></a>   <span class="co"># return(c(aic_val, cox_zph_val))</span></span>
<span id="cb273-39"><a href="#cb273-39" aria-hidden="true" tabindex="-1"></a><span class="co">#  }, error = function(e) {</span></span>
<span id="cb273-40"><a href="#cb273-40" aria-hidden="true" tabindex="-1"></a><span class="co">#    return(c(NA, NA))</span></span>
<span id="cb273-41"><a href="#cb273-41" aria-hidden="true" tabindex="-1"></a> <span class="co"># })</span></span>
<span id="cb273-42"><a href="#cb273-42" aria-hidden="true" tabindex="-1"></a>    aic_values0_restr[i] <span class="ot">&lt;-</span> aic_val_restr</span>
<span id="cb273-43"><a href="#cb273-43" aria-hidden="true" tabindex="-1"></a>    coxzph_values0_restr[i] <span class="ot">&lt;-</span> cox_zph_val_restr</span>
<span id="cb273-44"><a href="#cb273-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Spec: "</span>, l, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb273-45"><a href="#cb273-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"AIC: "</span>, aic_val_restr[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb273-46"><a href="#cb273-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Cox zph test statistic: "</span>, cox_zph_val_restr[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))     </span>
<span id="cb273-47"><a href="#cb273-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Spec:  lag_dias_treat_imp_sin_na 
NULL
AIC:  246485.806233321 
NULL
Cox zph test statistic:  639.107234814594 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 3) 
NULL
AIC:  246485.395254038 
NULL
Cox zph test statistic:  563.585278389179 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 4) 
NULL
AIC:  246487.221628619 
NULL
Cox zph test statistic:  567.377829244832 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 5) 
NULL
AIC:  246487.489808795 
NULL
Cox zph test statistic:  589.036438983096 
NULL
Spec:  poly(ifelse(is.na(log_lag_dias_treat_imp_sin_na),.001,log_lag_dias_treat_imp_sin_na), 6) 
NULL
AIC:  246489.392166329 
NULL
Cox zph test statistic:  594.368973890416 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 3) 
NULL
AIC:  246471.938352736 
NULL
Cox zph test statistic:  619.854794379174 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 4) 
NULL
AIC:  246471.919669293 
NULL
Cox zph test statistic:  630.581400491839 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 5) 
NULL
AIC:  246473.415412343 
NULL
Cox zph test statistic:  632.455278206685 
NULL
Spec:  bs(log_lag_dias_treat_imp_sin_na, 6) 
NULL
AIC:  246473.86359796 
NULL
Cox zph test statistic:  631.440180459019 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 3) 
NULL
AIC:  246471.745534296 
NULL
Cox zph test statistic:  625.638986339057 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 4) 
NULL
AIC:  246471.324101404 
NULL
Cox zph test statistic:  626.922786275545 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 5) 
NULL
AIC:  246473.612068326 
NULL
Cox zph test statistic:  626.854990209742 
NULL
Spec:  ns(log_lag_dias_treat_imp_sin_na, 6) 
NULL
AIC:  246475.935992451 
NULL
Cox zph test statistic:  627.023802589597 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 3) 
NULL
AIC:  246481.982378402 
NULL
Cox zph test statistic:  625.011096881098 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 4) 
NULL
AIC:  246479.729583509 
NULL
Cox zph test statistic:  629.005973316837 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 5) 
NULL
AIC:  246480.719358582 
NULL
Cox zph test statistic:  633.068535007454 
NULL
Spec:  rcs(log_lag_dias_treat_imp_sin_na, 6) 
NULL
AIC:  246480.612072818 
NULL
Cox zph test statistic:  631.710467477473 
NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"There was no model that improved cox zph of the restricted sample (vs. "</span>, <span class="fu">round</span>(<span class="fu">cox.zph</span>(cox_iiw_restr_proposed)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(cox_iiw_restr_proposed)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),<span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>There was no model that improved cox zph of the restricted sample (vs.&nbsp;497.1)</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co">#There was no model that improved cox zph of the restricted sample (vs. 495.5)</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>model_after_mod_log_lag_dias_treat<span class="ot">&lt;-</span></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> </span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>    lag_tr_outcome <span class="sc">+</span></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>    log_lag_dias_treat_imp_sin_na_rec<span class="fl">.1</span><span class="sc">+</span></span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>    log_lag_dias_treat_imp_sin_na_rec<span class="fl">.2</span><span class="sc">+</span></span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>    log_lag_dias_treat_imp_sin_na_rec<span class="fl">.3</span><span class="sc">+</span></span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>    lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>    lag_comp_bpsc_y3_severe <span class="sc">+</span> </span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a>    lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb276-13"><a href="#cb276-13" aria-hidden="true" tabindex="-1"></a>    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb276-14"><a href="#cb276-14" aria-hidden="true" tabindex="-1"></a>    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb276-15"><a href="#cb276-15" aria-hidden="true" tabindex="-1"></a>    susinidum_oh <span class="sc">+</span></span>
<span id="cb276-16"><a href="#cb276-16" aria-hidden="true" tabindex="-1"></a>    susinidum_coc <span class="sc">+</span></span>
<span id="cb276-17"><a href="#cb276-17" aria-hidden="true" tabindex="-1"></a>    susinidum_pbc <span class="sc">+</span></span>
<span id="cb276-18"><a href="#cb276-18" aria-hidden="true" tabindex="-1"></a>    susinidum_mar <span class="sc">+</span></span>
<span id="cb276-19"><a href="#cb276-19" aria-hidden="true" tabindex="-1"></a>    psycom_dum_with <span class="sc">+</span></span>
<span id="cb276-20"><a href="#cb276-20" aria-hidden="true" tabindex="-1"></a>    psycom_dum_study <span class="sc">+</span> </span>
<span id="cb276-21"><a href="#cb276-21" aria-hidden="true" tabindex="-1"></a>    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb276-22"><a href="#cb276-22" aria-hidden="true" tabindex="-1"></a>    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb276-23"><a href="#cb276-23" aria-hidden="true" tabindex="-1"></a>    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb276-24"><a href="#cb276-24" aria-hidden="true" tabindex="-1"></a>    susprindum_oh <span class="sc">+</span></span>
<span id="cb276-25"><a href="#cb276-25" aria-hidden="true" tabindex="-1"></a>    susprindum_coc <span class="sc">+</span></span>
<span id="cb276-26"><a href="#cb276-26" aria-hidden="true" tabindex="-1"></a>    susprindum_pbc <span class="sc">+</span></span>
<span id="cb276-27"><a href="#cb276-27" aria-hidden="true" tabindex="-1"></a>    susprindum_mar <span class="sc">+</span></span>
<span id="cb276-28"><a href="#cb276-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strat</span>(tipo_de_plan_2), </span>
<span id="cb276-29"><a href="#cb276-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_proc2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec=</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb276-30"><a href="#cb276-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-31"><a href="#cb276-31" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(model_after_mod_log_lag_dias_treat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                      chisq df       p
lag_tr_outcome                       42.103  1 8.7e-11
log_lag_dias_treat_imp_sin_na_rec.1 239.412  1 &lt; 2e-16
log_lag_dias_treat_imp_sin_na_rec.2 275.169  1 &lt; 2e-16
log_lag_dias_treat_imp_sin_na_rec.3 310.127  1 &lt; 2e-16
lag_less_90d_tr1                    165.596  1 &lt; 2e-16
lag_comp_bpsc_y3_severe              59.927  1 9.8e-15
lag_policonsumo2                     11.242  1 0.00080
edad_al_ing_1                        38.030  1 7.0e-10
ano_nac_corr                          9.980  1 0.00158
susinidum_oh                         48.294  1 3.7e-12
susinidum_coc                         0.687  1 0.40706
susinidum_pbc                        11.416  1 0.00073
susinidum_mar                        27.299  1 1.7e-07
psycom_dum_with                      11.212  1 0.00081
psycom_dum_study                     42.523  1 7.0e-11
freq_cons_dum_5day                   14.890  1 0.00011
cond_oc_dum_2inact                    0.241  1 0.62313
cond_oc_dum_3unemp                   28.081  1 1.2e-07
susprindum_oh                        35.197  1 3.0e-09
susprindum_coc                        1.806  1 0.17901
susprindum_pbc                       33.775  1 6.2e-09
susprindum_mar                        1.108  1 0.29243
GLOBAL                              681.320 22 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"The unadjusted was  547; now its 673 21 &lt; 2e-16; we kept the simplest model"</span>)</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now we see less than 90 days in treatment interactions, given that the interaction with time of log tr. days did not improved the model"</span>)</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a>res240422_1 <span class="ot">&lt;-</span> <span class="fu">resid</span>(cox_iiw_proposed, <span class="st">"scaledsch"</span>)</span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a>time240422_1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res240422_1)[[<span class="dv">1</span>]])</span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a>z_240422_1_1 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_1[,<span class="st">"lag_less_90d_tr1"</span>] <span class="sc">~</span> time240422_1, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a><span class="co"># x11() </span></span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_1, <span class="fu">fitted</span>(z_240422_1_1))</span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_1, res240422_1[,<span class="st">"psycom_dum_study"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_less_90d_tr1"</span>)</span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)[<span class="fu">which</span>(<span class="fu">attr</span>(cox_iiw_proposed<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"lag_less_90d_tr1"</span>)], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb278-20"><a href="#cb278-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>cox_iiw_proposed<span class="sc">$</span>coefficients[<span class="st">"lag_less_90d_tr1"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb278-21"><a href="#cb278-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb278-22"><a href="#cb278-22" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb278-23"><a href="#cb278-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-24"><a href="#cb278-24" aria-hidden="true" tabindex="-1"></a>km_home <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb278-25"><a href="#cb278-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_proc2)</span>
<span id="cb278-26"><a href="#cb278-26" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(km_home) # just to see the km curves</span></span>
<span id="cb278-27"><a href="#cb278-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_home, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>),</span>
<span id="cb278-28"><a href="#cb278-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by lag_less_90d_tr1"</span>)</span>
<span id="cb278-29"><a href="#cb278-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-5-iiw-weights-test-int-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_lag_less_90d_tr1.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"restricted"</span>)</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(cox_iiw_restr_proposed)[<span class="fu">which</span>(<span class="fu">attr</span>(cox_iiw_restr_proposed<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"lag_less_90d_tr1"</span>)], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>cox_iiw_restr_proposed<span class="sc">$</span>coefficients[<span class="st">"lag_less_90d_tr1"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb281-13"><a href="#cb281-13" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb281-14"><a href="#cb281-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-15"><a href="#cb281-15" aria-hidden="true" tabindex="-1"></a>km_less90d_restr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb281-16"><a href="#cb281-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb281-17"><a href="#cb281-17" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(km_home) # just to see the km curves</span></span>
<span id="cb281-18"><a href="#cb281-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_less90d_restr, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>),</span>
<span id="cb281-19"><a href="#cb281-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by lag_less_90d_tr1 (restr)"</span>)</span>
<span id="cb281-20"><a href="#cb281-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-5-iiw-weights-test-int-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_lag_less_90d_tr1_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>create_time_varying_effect <span class="ot">&lt;-</span> <span class="cf">function</span>(binary_covariate, t, decrease_end, increase_start, max_time) {</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize the effect to be equal to the covariate</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>  adjusted_effect <span class="ot">&lt;-</span> binary_covariate</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Decrease phase: a sharp decrease from the start until decrease_end</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The covariate's effect is reduced to zero by decrease_end</span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>  adjusted_effect <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(t <span class="sc">&lt;=</span> decrease_end, binary_covariate <span class="sc">*</span> (decrease_end <span class="sc">-</span> t) <span class="sc">/</span> decrease_end, adjusted_effect)</span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flat phase: between decrease_end and increase_start, the effect is zero</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>  adjusted_effect <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(t <span class="sc">&gt;</span> decrease_end <span class="sc">&amp;</span> t <span class="sc">&lt;=</span> increase_start, <span class="dv">0</span>, adjusted_effect)</span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Increase phase: a gradual increase from increase_start to max_time</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The covariate's effect is increased back to its original value by max_time</span></span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>  time_range <span class="ot">&lt;-</span> max_time <span class="sc">-</span> increase_start</span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>  adjusted_effect <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(t <span class="sc">&gt;</span> increase_start, binary_covariate <span class="sc">*</span> (t <span class="sc">-</span> increase_start) <span class="sc">/</span> time_range, adjusted_effect)</span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adjusted_effect)</span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb284-19"><a href="#cb284-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-20"><a href="#cb284-20" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2<span class="sc">$</span>lag_less_90d_tr1_rec<span class="ot">&lt;-</span></span>
<span id="cb284-21"><a href="#cb284-21" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_proc2<span class="sc">$</span>lag_less_90d_tr1, </span>
<span id="cb284-22"><a href="#cb284-22" aria-hidden="true" tabindex="-1"></a>                           data_mine_miss_proc2<span class="sc">$</span>time, </span>
<span id="cb284-23"><a href="#cb284-23" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">20</span>,</span>
<span id="cb284-24"><a href="#cb284-24" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">80</span>,</span>
<span id="cb284-25"><a href="#cb284-25" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">max</span>(data_mine_miss_proc2<span class="sc">$</span>time))</span>
<span id="cb284-26"><a href="#cb284-26" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1_rec<span class="ot">&lt;-</span></span>
<span id="cb284-27"><a href="#cb284-27" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1, </span>
<span id="cb284-28"><a href="#cb284-28" aria-hidden="true" tabindex="-1"></a>                           data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb284-29"><a href="#cb284-29" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">20</span>,</span>
<span id="cb284-30"><a href="#cb284-30" aria-hidden="true" tabindex="-1"></a>                           <span class="dv">80</span>,</span>
<span id="cb284-31"><a href="#cb284-31" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb284-32"><a href="#cb284-32" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-33"><a href="#cb284-33" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-34"><a href="#cb284-34" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-35"><a href="#cb284-35" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Remove residuals"</span>)</span>
<span id="cb284-36"><a href="#cb284-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-37"><a href="#cb284-37" aria-hidden="true" tabindex="-1"></a>mean_resid <span class="ot">&lt;-</span> <span class="fu">mean</span>(res240422_1[,<span class="st">"lag_less_90d_tr1"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb284-38"><a href="#cb284-38" aria-hidden="true" tabindex="-1"></a>sd_resid <span class="ot">&lt;-</span> <span class="fu">sd</span>(res240422_1[,<span class="st">"lag_less_90d_tr1"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb284-39"><a href="#cb284-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-40"><a href="#cb284-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outliers as those residuals greater than 3 standard deviations from the mean</span></span>
<span id="cb284-41"><a href="#cb284-41" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(res240422_1[,<span class="st">"lag_less_90d_tr1"</span>] <span class="sc">-</span> mean_resid) <span class="sc">&gt;</span> (<span class="dv">3</span> <span class="sc">*</span> sd_resid))</span>
<span id="cb284-42"><a href="#cb284-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-43"><a href="#cb284-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-44"><a href="#cb284-44" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> data_mine_miss_proc2[<span class="sc">-</span>outliers, ]</span>
<span id="cb284-45"><a href="#cb284-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-46"><a href="#cb284-46" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"even it worse results. Not important //DISCARDED"</span>)</span>
<span id="cb284-47"><a href="#cb284-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-48"><a href="#cb284-48" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-49"><a href="#cb284-49" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-50"><a href="#cb284-50" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-51"><a href="#cb284-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-52"><a href="#cb284-52" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Used a clog log plot, and told chat gpt to suggest a function"</span>)</span>
<span id="cb284-53"><a href="#cb284-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Here's a possible function that you can tailor to fit the divergence you observe in your log-log plot:</span></span>
<span id="cb284-54"><a href="#cb284-54" aria-hidden="true" tabindex="-1"></a>time_varying_coeff <span class="ot">&lt;-</span> <span class="cf">function</span>(t, change_points, coefficients) {</span>
<span id="cb284-55"><a href="#cb284-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t: vector of times</span></span>
<span id="cb284-56"><a href="#cb284-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change_points: vector of times at which the hazard ratio changes</span></span>
<span id="cb284-57"><a href="#cb284-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coefficients: vector of coefficients corresponding to intervals defined by change_points</span></span>
<span id="cb284-58"><a href="#cb284-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb284-59"><a href="#cb284-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure change_points are sorted</span></span>
<span id="cb284-60"><a href="#cb284-60" aria-hidden="true" tabindex="-1"></a>    change_points <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>, change_points, <span class="cn">Inf</span>))</span>
<span id="cb284-61"><a href="#cb284-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a vector to hold the coefficient for each time t</span></span>
<span id="cb284-62"><a href="#cb284-62" aria-hidden="true" tabindex="-1"></a>    t_coeff <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(t))</span>
<span id="cb284-63"><a href="#cb284-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb284-64"><a href="#cb284-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over the intervals defined by change_points</span></span>
<span id="cb284-65"><a href="#cb284-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(coefficients)) {</span>
<span id="cb284-66"><a href="#cb284-66" aria-hidden="true" tabindex="-1"></a>        interval_start <span class="ot">&lt;-</span> change_points[i]</span>
<span id="cb284-67"><a href="#cb284-67" aria-hidden="true" tabindex="-1"></a>        interval_end <span class="ot">&lt;-</span> change_points[i <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb284-68"><a href="#cb284-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Assign the coefficient to times within the current interval</span></span>
<span id="cb284-69"><a href="#cb284-69" aria-hidden="true" tabindex="-1"></a>        t_coeff[t <span class="sc">&gt;</span> interval_start <span class="sc">&amp;</span> t <span class="sc">&lt;=</span> interval_end] <span class="ot">&lt;-</span> coefficients[i]</span>
<span id="cb284-70"><a href="#cb284-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb284-71"><a href="#cb284-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb284-72"><a href="#cb284-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(t_coeff)</span>
<span id="cb284-73"><a href="#cb284-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb284-74"><a href="#cb284-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-75"><a href="#cb284-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the change points and coefficients based on your data and log-log plot</span></span>
<span id="cb284-76"><a href="#cb284-76" aria-hidden="true" tabindex="-1"></a>change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)  <span class="co"># Example change points (months)</span></span>
<span id="cb284-77"><a href="#cb284-77" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb284-78"><a href="#cb284-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb284-79"><a href="#cb284-79" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2<span class="sc">$</span>lag_less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_proc2,</span>
<span id="cb284-80"><a href="#cb284-80" aria-hidden="true" tabindex="-1"></a>                                        lag_less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb284-81"><a href="#cb284-81" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2<span class="sc">$</span>less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_proc2,</span>
<span id="cb284-82"><a href="#cb284-82" aria-hidden="true" tabindex="-1"></a>                                        less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb284-83"><a href="#cb284-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-84"><a href="#cb284-84" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-30: restricted"</span>)</span>
<span id="cb284-85"><a href="#cb284-85" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb284-86"><a href="#cb284-86" aria-hidden="true" tabindex="-1"></a>                                        lag_less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb284-87"><a href="#cb284-87" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb284-88"><a href="#cb284-88" aria-hidden="true" tabindex="-1"></a>                                        less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb284-89"><a href="#cb284-89" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-90"><a href="#cb284-90" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb284-91"><a href="#cb284-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-92"><a href="#cb284-92" aria-hidden="true" tabindex="-1"></a>model_after_mod_not_log_lag_dias_treat_lag_less_90d<span class="ot">&lt;-</span></span>
<span id="cb284-93"><a href="#cb284-93" aria-hidden="true" tabindex="-1"></a><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> </span>
<span id="cb284-94"><a href="#cb284-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb284-95"><a href="#cb284-95" aria-hidden="true" tabindex="-1"></a>    lag_tr_outcome <span class="sc">+</span></span>
<span id="cb284-96"><a href="#cb284-96" aria-hidden="true" tabindex="-1"></a>    log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb284-97"><a href="#cb284-97" aria-hidden="true" tabindex="-1"></a>    lag_less_90d_tr1_rec2<span class="sc">+</span></span>
<span id="cb284-98"><a href="#cb284-98" aria-hidden="true" tabindex="-1"></a>    lag_comp_bpsc_y3_severe <span class="sc">+</span> </span>
<span id="cb284-99"><a href="#cb284-99" aria-hidden="true" tabindex="-1"></a>    lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb284-100"><a href="#cb284-100" aria-hidden="true" tabindex="-1"></a>    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb284-101"><a href="#cb284-101" aria-hidden="true" tabindex="-1"></a>    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb284-102"><a href="#cb284-102" aria-hidden="true" tabindex="-1"></a>    susinidum_oh <span class="sc">+</span></span>
<span id="cb284-103"><a href="#cb284-103" aria-hidden="true" tabindex="-1"></a>    susinidum_coc <span class="sc">+</span></span>
<span id="cb284-104"><a href="#cb284-104" aria-hidden="true" tabindex="-1"></a>    susinidum_pbc <span class="sc">+</span></span>
<span id="cb284-105"><a href="#cb284-105" aria-hidden="true" tabindex="-1"></a>    susinidum_mar <span class="sc">+</span></span>
<span id="cb284-106"><a href="#cb284-106" aria-hidden="true" tabindex="-1"></a>    psycom_dum_with <span class="sc">+</span></span>
<span id="cb284-107"><a href="#cb284-107" aria-hidden="true" tabindex="-1"></a>    psycom_dum_study <span class="sc">+</span> </span>
<span id="cb284-108"><a href="#cb284-108" aria-hidden="true" tabindex="-1"></a>    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb284-109"><a href="#cb284-109" aria-hidden="true" tabindex="-1"></a>    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb284-110"><a href="#cb284-110" aria-hidden="true" tabindex="-1"></a>    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb284-111"><a href="#cb284-111" aria-hidden="true" tabindex="-1"></a>    susprindum_oh <span class="sc">+</span></span>
<span id="cb284-112"><a href="#cb284-112" aria-hidden="true" tabindex="-1"></a>    susprindum_coc <span class="sc">+</span></span>
<span id="cb284-113"><a href="#cb284-113" aria-hidden="true" tabindex="-1"></a>    susprindum_pbc <span class="sc">+</span></span>
<span id="cb284-114"><a href="#cb284-114" aria-hidden="true" tabindex="-1"></a>    susprindum_mar<span class="sc">+</span></span>
<span id="cb284-115"><a href="#cb284-115" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strat</span>(tipo_de_plan_2), </span>
<span id="cb284-116"><a href="#cb284-116" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data= data_clean,</span></span>
<span id="cb284-117"><a href="#cb284-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_proc2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec=</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(),</span>
<span id="cb284-118"><a href="#cb284-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb284-119"><a href="#cb284-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-120"><a href="#cb284-120" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(model_after_mod_not_log_lag_dias_treat_lag_less_90d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                chisq df       p
lag_tr_outcome                 37.918  1 7.4e-10
log_lag_dias_treat_imp_sin_na 179.021  1 &lt; 2e-16
lag_less_90d_tr1_rec2          89.397  1 &lt; 2e-16
lag_comp_bpsc_y3_severe        59.737  1 1.1e-14
lag_policonsumo2               10.980  1 0.00092
edad_al_ing_1                  35.338  1 2.8e-09
ano_nac_corr                    8.684  1 0.00321
susinidum_oh                   45.623  1 1.4e-11
susinidum_coc                   0.773  1 0.37918
susinidum_pbc                  10.736  1 0.00105
susinidum_mar                  25.726  1 3.9e-07
psycom_dum_with                10.019  1 0.00155
psycom_dum_study               42.363  1 7.6e-11
freq_cons_dum_5day             15.415  1 8.6e-05
cond_oc_dum_2inact              0.113  1 0.73706
cond_oc_dum_3unemp             27.499  1 1.6e-07
susprindum_oh                  32.538  1 1.2e-08
susprindum_coc                  1.707  1 0.19134
susprindum_pbc                 31.291  1 2.2e-08
susprindum_mar                  1.017  1 0.31319
GLOBAL                        543.671 20 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 chisq df       p</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na 163.562  1 &lt; 2e-16</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1_rec2          85.349  1 &lt; 2e-16</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        55.509  1 9.3e-14</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2               11.327  1 0.00076</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  33.351  1 7.7e-09</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    7.573  1 0.00592</span></span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   32.526  1 1.2e-08</span></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                   0.831  1 0.36209</span></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   2.136  1 0.14387</span></span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  22.932  1 1.7e-06</span></span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                10.244  1 0.00137</span></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               41.095  1 1.4e-10</span></span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             15.029  1 0.00011</span></span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              0.171  1 0.67918</span></span>
<span id="cb286-16"><a href="#cb286-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             27.481  1 1.6e-07</span></span>
<span id="cb286-17"><a href="#cb286-17" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  32.539  1 1.2e-08</span></span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  1.498  1 0.22104</span></span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 30.540  1 3.3e-08</span></span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  0.970  1 0.32457</span></span>
<span id="cb286-21"><a href="#cb286-21" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        513.580 19 &lt; 2e-16</span></span>
<span id="cb286-22"><a href="#cb286-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-23"><a href="#cb286-23" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"There was no model that improved cox zph of the restricted sample (vs. "</span>, <span class="fu">round</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),<span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>There was no model that improved cox zph of the restricted sample (vs.&nbsp;495.5)</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"We improved fit from 552 to 513"</span>)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"We do not longer try to change log_lag_dias_treat_imp_sin_na_rec"</span>)</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-30: restricted w/ tipo de plan 2 mod"</span>)</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="dv">7</span>,.<span class="dv">1</span>)) {</span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a>  change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span>i, <span class="dv">10</span><span class="sc">*</span>i, <span class="dv">15</span><span class="sc">*</span>i)  <span class="co"># Example change points (months)</span></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a>                                                           lag_less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a>                                                       less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d<span class="ot">&lt;-</span></span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb287-19"><a href="#cb287-19" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb287-20"><a href="#cb287-20" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_tr_outcome +</span></span>
<span id="cb287-21"><a href="#cb287-21" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb287-22"><a href="#cb287-22" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec2+</span></span>
<span id="cb287-23"><a href="#cb287-23" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe + </span></span>
<span id="cb287-24"><a href="#cb287-24" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb287-25"><a href="#cb287-25" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb287-26"><a href="#cb287-26" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb287-27"><a href="#cb287-27" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb287-28"><a href="#cb287-28" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb287-29"><a href="#cb287-29" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb287-30"><a href="#cb287-30" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb287-31"><a href="#cb287-31" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb287-32"><a href="#cb287-32" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb287-33"><a href="#cb287-33" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb287-34"><a href="#cb287-34" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb287-35"><a href="#cb287-35" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb287-36"><a href="#cb287-36" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb287-37"><a href="#cb287-37" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb287-38"><a href="#cb287-38" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb287-39"><a href="#cb287-39" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb287-40"><a href="#cb287-40" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb287-41"><a href="#cb287-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb287-42"><a href="#cb287-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb287-43"><a href="#cb287-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb287-44"><a href="#cb287-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb287-45"><a href="#cb287-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d)</span>
<span id="cb287-46"><a href="#cb287-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb287-47"><a href="#cb287-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb287-48"><a href="#cb287-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(change_points)</span>
<span id="cb287-49"><a href="#cb287-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d)<span class="sc">$</span>table), <span class="dv">1</span>]))</span>
<span id="cb287-50"><a href="#cb287-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb287-51"><a href="#cb287-51" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] 0.5 1.0 1.5
[1] "493.4811"
[1] "iteration: 0.2"
[1] 1 2 3
[1] "493.2048"
[1] "iteration: 0.3"
[1] 1.5 3.0 4.5
[1] "492.4265"
[1] "iteration: 0.4"
[1] 2 4 6
[1] "480.5242"
[1] "iteration: 0.5"
[1] 2.5 5.0 7.5
[1] "477.4635"
[1] "iteration: 0.6"
[1] 3 6 9
[1] "482.7047"
[1] "iteration: 0.7"
[1]  3.5  7.0 10.5
[1] "482.1585"
[1] "iteration: 0.8"
[1]  4  8 12
[1] "479.9969"
[1] "iteration: 0.9"
[1]  4.5  9.0 13.5
[1] "477.7753"
[1] "iteration: 1"
[1]  5 10 15
[1] "479.6782"
[1] "iteration: 1.1"
[1]  5.5 11.0 16.5
[1] "480.8076"
[1] "iteration: 1.2"
[1]  6 12 18
[1] "478.0329"
[1] "iteration: 1.3"
[1]  6.5 13.0 19.5
[1] "477.8009"
[1] "iteration: 1.4"
[1]  7 14 21
[1] "478.0451"
[1] "iteration: 1.5"
[1]  7.5 15.0 22.5
[1] "477.306"
[1] "iteration: 1.6"
[1]  8 16 24
[1] "476.7152"
[1] "iteration: 1.7"
[1]  8.5 17.0 25.5
[1] "475.7639"
[1] "iteration: 1.8"
[1]  9 18 27
[1] "477.6404"
[1] "iteration: 1.9"
[1]  9.5 19.0 28.5
[1] "478.1175"
[1] "iteration: 2"
[1] 10 20 30
[1] "478.6989"
[1] "iteration: 2.1"
[1] 10.5 21.0 31.5
[1] "477.3389"
[1] "iteration: 2.2"
[1] 11 22 33
[1] "477.742"
[1] "iteration: 2.3"
[1] 11.5 23.0 34.5
[1] "479.8333"
[1] "iteration: 2.4"
[1] 12 24 36
[1] "480.6214"
[1] "iteration: 2.5"
[1] 12.5 25.0 37.5
[1] "479.5284"
[1] "iteration: 2.6"
[1] 13 26 39
[1] "479.3746"
[1] "iteration: 2.7"
[1] 13.5 27.0 40.5
[1] "479.5649"
[1] "iteration: 2.8"
[1] 14 28 42
[1] "480.0663"
[1] "iteration: 2.9"
[1] 14.5 29.0 43.5
[1] "482.4381"
[1] "iteration: 3"
[1] 15 30 45
[1] "483.276"
[1] "iteration: 3.1"
[1] 15.5 31.0 46.5
[1] "485.369"
[1] "iteration: 3.2"
[1] 16 32 48
[1] "488.6019"
[1] "iteration: 3.3"
[1] 16.5 33.0 49.5
[1] "488.7055"
[1] "iteration: 3.4"
[1] 17 34 51
[1] "490.8723"
[1] "iteration: 3.5"
[1] 17.5 35.0 52.5
[1] "490.1774"
[1] "iteration: 3.6"
[1] 18 36 54
[1] "491.0848"
[1] "iteration: 3.7"
[1] 18.5 37.0 55.5
[1] "491.8408"
[1] "iteration: 3.8"
[1] 19 38 57
[1] "493.2258"
[1] "iteration: 3.9"
[1] 19.5 39.0 58.5
[1] "493.0619"
[1] "iteration: 4"
[1] 20 40 60
[1] "494.1005"
[1] "iteration: 4.1"
[1] 20.5 41.0 61.5
[1] "495.7924"
[1] "iteration: 4.2"
[1] 21 42 63
[1] "496.9032"
[1] "iteration: 4.3"
[1] 21.5 43.0 64.5
[1] "497.0522"
[1] "iteration: 4.4"
[1] 22 44 66
[1] "497.3046"
[1] "iteration: 4.5"
[1] 22.5 45.0 67.5
[1] "497.4102"
[1] "iteration: 4.6"
[1] 23 46 69
[1] "497.9092"
[1] "iteration: 4.7"
[1] 23.5 47.0 70.5
[1] "498.3643"
[1] "iteration: 4.8"
[1] 24 48 72
[1] "498.6149"
[1] "iteration: 4.9"
[1] 24.5 49.0 73.5
[1] "500.2164"
[1] "iteration: 5"
[1] 25 50 75
[1] "500.4883"
[1] "iteration: 5.1"
[1] 25.5 51.0 76.5
[1] "501.8345"
[1] "iteration: 5.2"
[1] 26 52 78
[1] "502.9337"
[1] "iteration: 5.3"
[1] 26.5 53.0 79.5
[1] "503.2239"
[1] "iteration: 5.4"
[1] 27 54 81
[1] "502.2895"
[1] "iteration: 5.5"
[1] 27.5 55.0 82.5
[1] "502.7881"
[1] "iteration: 5.6"
[1] 28 56 84
[1] "503.4912"
[1] "iteration: 5.7"
[1] 28.5 57.0 85.5
[1] "503.9953"
[1] "iteration: 5.8"
[1] 29 58 87
[1] "504.2127"
[1] "iteration: 5.9"
[1] 29.5 59.0 88.5
[1] "504.5094"
[1] "iteration: 6"
[1] 30 60 90
[1] "504.3318"
[1] "iteration: 6.1"
[1] 30.5 61.0 91.5
[1] "503.4482"
[1] "iteration: 6.2"
[1] 31 62 93
[1] "503.827"
[1] "iteration: 6.3"
[1] 31.5 63.0 94.5
[1] "503.1115"
[1] "iteration: 6.4"
[1] 32 64 96
[1] "503.6159"
[1] "iteration: 6.5"
[1] 32.5 65.0 97.5
[1] "503.661"
[1] "iteration: 6.6"
[1] 33 66 99
[1] "503.5745"
[1] "iteration: 6.7"
[1]  33.5  67.0 100.5
[1] "503.7049"
[1] "iteration: 6.8"
[1]  34  68 102
[1] "503.1642"
[1] "iteration: 6.9"
[1]  34.5  69.0 103.5
[1] "503.5052"
[1] "iteration: 7"
[1]  35  70 105
[1] "502.6516"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "iteration: 0.5"</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 2.5 5.0 7.5</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "475.9965"</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"There was no model that improved cox zph of the restricted sample (vs. "</span>, <span class="fu">round</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),<span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>There was no model that improved cox zph of the restricted sample (vs.&nbsp;495.5)</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co">#There was no model that improved cox zph of the restricted sample (vs. 495.5)</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Grid search of reduction of TVCs"</span>)</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="fl">1.5</span>,.<span class="dv">05</span>)) {</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>  tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span>i</span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1_rec<span class="ot">&lt;-</span></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1, </span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a>                           data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">1</span>],</span>
<span id="cb290-13"><a href="#cb290-13" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">2</span>],</span>
<span id="cb290-14"><a href="#cb290-14" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb290-15"><a href="#cb290-15" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>less_90d_tr1_rec<span class="ot">&lt;-</span></span>
<span id="cb290-16"><a href="#cb290-16" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>less_90d_tr1, </span>
<span id="cb290-17"><a href="#cb290-17" aria-hidden="true" tabindex="-1"></a>                           data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb290-18"><a href="#cb290-18" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">1</span>],</span>
<span id="cb290-19"><a href="#cb290-19" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">2</span>],</span>
<span id="cb290-20"><a href="#cb290-20" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb290-21"><a href="#cb290-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-22"><a href="#cb290-22" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt<span class="ot">&lt;-</span></span>
<span id="cb290-23"><a href="#cb290-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb290-24"><a href="#cb290-24" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb290-25"><a href="#cb290-25" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_tr_outcome +</span></span>
<span id="cb290-26"><a href="#cb290-26" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb290-27"><a href="#cb290-27" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec+</span></span>
<span id="cb290-28"><a href="#cb290-28" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe + </span></span>
<span id="cb290-29"><a href="#cb290-29" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb290-30"><a href="#cb290-30" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb290-31"><a href="#cb290-31" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb290-32"><a href="#cb290-32" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb290-33"><a href="#cb290-33" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb290-34"><a href="#cb290-34" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb290-35"><a href="#cb290-35" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb290-36"><a href="#cb290-36" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb290-37"><a href="#cb290-37" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb290-38"><a href="#cb290-38" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb290-39"><a href="#cb290-39" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb290-40"><a href="#cb290-40" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb290-41"><a href="#cb290-41" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb290-42"><a href="#cb290-42" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb290-43"><a href="#cb290-43" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb290-44"><a href="#cb290-44" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb290-45"><a href="#cb290-45" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb290-46"><a href="#cb290-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb290-47"><a href="#cb290-47" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb290-48"><a href="#cb290-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb290-49"><a href="#cb290-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-50"><a href="#cb290-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)</span>
<span id="cb290-51"><a href="#cb290-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb290-52"><a href="#cb290-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb290-53"><a href="#cb290-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(tvcs)</span>
<span id="cb290-54"><a href="#cb290-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table), <span class="dv">1</span>]))</span>
<span id="cb290-55"><a href="#cb290-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb290-56"><a href="#cb290-56" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] 2 8
[1] "1710.118"
[1] "iteration: 0.15"
[1]  3 12
[1] "1642.617"
[1] "iteration: 0.2"
[1]  4 16
[1] "1319.002"
[1] "iteration: 0.25"
[1]  5 20
[1] "885.2445"
[1] "iteration: 0.3"
[1]  6 24
[1] "503.2978"
[1] "iteration: 0.35"
[1]  7 28
[1] "363.183"
[1] "iteration: 0.4"
[1]  8 32
[1] "609.1047"
[1] "iteration: 0.45"
[1]  9 36
[1] "1241.478"
[1] "iteration: 0.5"
[1] 10 40
[1] "2116.105"
[1] "iteration: 0.55"
[1] 11 44
[1] "3014.795"
[1] "iteration: 0.6"
[1] 12 48
[1] "3752.182"
[1] "iteration: 0.65"
[1] 13 52
[1] "4241.554"
[1] "iteration: 0.7"
[1] 14 56
[1] "4487.798"
[1] "iteration: 0.75"
[1] 15 60
[1] "4534.477"
[1] "iteration: 0.8"
[1] 16 64
[1] "4426.349"
[1] "iteration: 0.85"
[1] 17 68
[1] "4208.187"
[1] "iteration: 0.9"
[1] 18 72
[1] "3908.978"
[1] "iteration: 0.95"
[1] 19 76
[1] "3553.854"
[1] "iteration: 1"
[1] 20 80
[1] "3162.509"
[1] "iteration: 1.05"
[1] 21 84
[1] "2756.184"
[1] "iteration: 1.1"
[1] 22 88
[1] "2339.299"
[1] "iteration: 1.15"
[1] 23 92
[1] "1922.443"
[1] "iteration: 1.2"
[1] 24 96
[1] "1526.312"
[1] "iteration: 1.25"
[1]  25 100
[1] "1186.425"
[1] "iteration: 1.3"
[1]  26 104
[1] "943.2429"
[1] "iteration: 1.35"
[1]  27 108
[1] "826.6724"
[1] "iteration: 1.4"
[1]  28 112
[1] "871.2033"
[1] "iteration: 1.45"
[1]  29 116
[1] "1124.667"
[1] "iteration: 1.5"
[1]  30 120
[1] "1270.214"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "iteration: 0.35"</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [1]  7 28</span></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "361.9089"</span></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "iteration: 0.5"</span></span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 2.5 5.0 7.5</span></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "475.9965"</span></span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a>change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">5</span>, <span class="fl">7.5</span>)  <span class="co"># Example change points (months)</span></span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a>                                                         lag_less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb292-15"><a href="#cb292-15" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>less_90d_tr1_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb292-16"><a href="#cb292-16" aria-hidden="true" tabindex="-1"></a>                                                     less_90d_tr1<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb292-17"><a href="#cb292-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-18"><a href="#cb292-18" aria-hidden="true" tabindex="-1"></a>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d<span class="ot">&lt;-</span></span>
<span id="cb292-19"><a href="#cb292-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> </span>
<span id="cb292-20"><a href="#cb292-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id) <span class="sc">+</span> </span>
<span id="cb292-21"><a href="#cb292-21" aria-hidden="true" tabindex="-1"></a>    lag_tr_outcome <span class="sc">+</span></span>
<span id="cb292-22"><a href="#cb292-22" aria-hidden="true" tabindex="-1"></a>    log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb292-23"><a href="#cb292-23" aria-hidden="true" tabindex="-1"></a>    lag_less_90d_tr1_rec2 <span class="sc">+</span></span>
<span id="cb292-24"><a href="#cb292-24" aria-hidden="true" tabindex="-1"></a>    lag_comp_bpsc_y3_severe <span class="sc">+</span> </span>
<span id="cb292-25"><a href="#cb292-25" aria-hidden="true" tabindex="-1"></a>    lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb292-26"><a href="#cb292-26" aria-hidden="true" tabindex="-1"></a>    edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb292-27"><a href="#cb292-27" aria-hidden="true" tabindex="-1"></a>    ano_nac_corr <span class="sc">+</span> </span>
<span id="cb292-28"><a href="#cb292-28" aria-hidden="true" tabindex="-1"></a>    susinidum_oh <span class="sc">+</span></span>
<span id="cb292-29"><a href="#cb292-29" aria-hidden="true" tabindex="-1"></a>    susinidum_coc <span class="sc">+</span></span>
<span id="cb292-30"><a href="#cb292-30" aria-hidden="true" tabindex="-1"></a>    susinidum_pbc <span class="sc">+</span></span>
<span id="cb292-31"><a href="#cb292-31" aria-hidden="true" tabindex="-1"></a>    susinidum_mar <span class="sc">+</span></span>
<span id="cb292-32"><a href="#cb292-32" aria-hidden="true" tabindex="-1"></a>    psycom_dum_with <span class="sc">+</span></span>
<span id="cb292-33"><a href="#cb292-33" aria-hidden="true" tabindex="-1"></a>    psycom_dum_study <span class="sc">+</span> </span>
<span id="cb292-34"><a href="#cb292-34" aria-hidden="true" tabindex="-1"></a>    freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb292-35"><a href="#cb292-35" aria-hidden="true" tabindex="-1"></a>    cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb292-36"><a href="#cb292-36" aria-hidden="true" tabindex="-1"></a>    cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb292-37"><a href="#cb292-37" aria-hidden="true" tabindex="-1"></a>    susprindum_oh <span class="sc">+</span></span>
<span id="cb292-38"><a href="#cb292-38" aria-hidden="true" tabindex="-1"></a>    susprindum_coc <span class="sc">+</span></span>
<span id="cb292-39"><a href="#cb292-39" aria-hidden="true" tabindex="-1"></a>    susprindum_pbc <span class="sc">+</span></span>
<span id="cb292-40"><a href="#cb292-40" aria-hidden="true" tabindex="-1"></a>    susprindum_mar<span class="sc">+</span></span>
<span id="cb292-41"><a href="#cb292-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb292-42"><a href="#cb292-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data= data_clean,</span></span>
<span id="cb292-43"><a href="#cb292-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec=</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(),</span>
<span id="cb292-44"><a href="#cb292-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb292-45"><a href="#cb292-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-46"><a href="#cb292-46" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                chisq df       p
lag_tr_outcome                 54.041  1 2.0e-13
log_lag_dias_treat_imp_sin_na 144.161  1 &lt; 2e-16
lag_less_90d_tr1_rec2          53.529  1 2.5e-13
lag_comp_bpsc_y3_severe        21.026  1 4.5e-06
lag_policonsumo2                8.345  1 0.00387
edad_al_ing_1                  33.844  1 6.0e-09
ano_nac_corr                    8.075  1 0.00449
susinidum_oh                   40.358  1 2.1e-10
susinidum_coc                   0.976  1 0.32311
susinidum_pbc                   6.830  1 0.00897
susinidum_mar                  25.019  1 5.7e-07
psycom_dum_with                17.112  1 3.5e-05
psycom_dum_study               40.295  1 2.2e-10
freq_cons_dum_5day              2.353  1 0.12505
cond_oc_dum_2inact              3.057  1 0.08040
cond_oc_dum_3unemp             14.775  1 0.00012
susprindum_oh                  25.139  1 5.3e-07
susprindum_coc                  0.780  1 0.37706
susprindum_pbc                 20.331  1 6.5e-06
susprindum_mar                  2.509  1 0.11319
GLOBAL                        477.463 20 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The model improved from "</span>, <span class="fu">round</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),<span class="st">" to 476"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The model improved from 495.5 to 476</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model improved from 495.5 to 476</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "iteration: 0.35"</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a><span class="co"># [1]  7 28</span></span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "361.9089"</span></span>
<span id="cb295-9"><a href="#cb295-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-10"><a href="#cb295-10" aria-hidden="true" tabindex="-1"></a>tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span><span class="fl">0.35</span></span>
<span id="cb295-11"><a href="#cb295-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-12"><a href="#cb295-12" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1_rec<span class="ot">&lt;-</span></span>
<span id="cb295-13"><a href="#cb295-13" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>lag_less_90d_tr1, </span>
<span id="cb295-14"><a href="#cb295-14" aria-hidden="true" tabindex="-1"></a>                           data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb295-15"><a href="#cb295-15" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">1</span>],</span>
<span id="cb295-16"><a href="#cb295-16" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">2</span>],</span>
<span id="cb295-17"><a href="#cb295-17" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb295-18"><a href="#cb295-18" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>less_90d_tr1_rec<span class="ot">&lt;-</span></span>
<span id="cb295-19"><a href="#cb295-19" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>less_90d_tr1, </span>
<span id="cb295-20"><a href="#cb295-20" aria-hidden="true" tabindex="-1"></a>                           data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb295-21"><a href="#cb295-21" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">1</span>],</span>
<span id="cb295-22"><a href="#cb295-22" aria-hidden="true" tabindex="-1"></a>                           tvcs[<span class="dv">2</span>],</span>
<span id="cb295-23"><a href="#cb295-23" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb295-24"><a href="#cb295-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb295-25"><a href="#cb295-25" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt<span class="ot">&lt;-</span></span>
<span id="cb295-26"><a href="#cb295-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb295-27"><a href="#cb295-27" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb295-28"><a href="#cb295-28" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_tr_outcome +</span></span>
<span id="cb295-29"><a href="#cb295-29" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb295-30"><a href="#cb295-30" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec+</span></span>
<span id="cb295-31"><a href="#cb295-31" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe + </span></span>
<span id="cb295-32"><a href="#cb295-32" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb295-33"><a href="#cb295-33" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb295-34"><a href="#cb295-34" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb295-35"><a href="#cb295-35" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb295-36"><a href="#cb295-36" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb295-37"><a href="#cb295-37" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb295-38"><a href="#cb295-38" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb295-39"><a href="#cb295-39" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb295-40"><a href="#cb295-40" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb295-41"><a href="#cb295-41" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb295-42"><a href="#cb295-42" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb295-43"><a href="#cb295-43" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb295-44"><a href="#cb295-44" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb295-45"><a href="#cb295-45" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb295-46"><a href="#cb295-46" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb295-47"><a href="#cb295-47" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb295-48"><a href="#cb295-48" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb295-49"><a href="#cb295-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb295-50"><a href="#cb295-50" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb295-51"><a href="#cb295-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb295-52"><a href="#cb295-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb295-53"><a href="#cb295-53" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                chisq df       p
lag_tr_outcome                 20.783  1 5.1e-06
log_lag_dias_treat_imp_sin_na  41.447  1 1.2e-10
lag_less_90d_tr1_rec           14.941  1 0.00011
lag_comp_bpsc_y3_severe        16.927  1 3.9e-05
lag_policonsumo2                8.209  1 0.00417
edad_al_ing_1                  20.696  1 5.4e-06
ano_nac_corr                    2.130  1 0.14448
susinidum_oh                   33.052  1 9.0e-09
susinidum_coc                   1.324  1 0.24985
susinidum_pbc                   3.595  1 0.05794
susinidum_mar                  22.314  1 2.3e-06
psycom_dum_with                 6.947  1 0.00840
psycom_dum_study               11.181  1 0.00083
freq_cons_dum_5day              1.635  1 0.20096
cond_oc_dum_2inact              3.157  1 0.07561
cond_oc_dum_3unemp             12.212  1 0.00047
susprindum_oh                  19.510  1 1.0e-05
susprindum_coc                  0.602  1 0.43788
susprindum_pbc                 13.440  1 0.00025
susprindum_mar                  4.138  1 0.04192
GLOBAL                        363.183 20 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Analyse the violation of proportional hazards"</span>)</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>res240422_2 <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_after_mod_not_log_lag_dias_treat_lag_less_90d, <span class="st">"scaledsch"</span>)</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>time240422_2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res240422_2)[[<span class="dv">1</span>]])</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>z_240422_2_1 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_2[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>] <span class="sc">~</span> time240422_2, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a><span class="co"># x11() </span></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_2, <span class="fu">fitted</span>(z_240422_2_1))</span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_2, res240422_2[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., log_lag_dias_treat_imp_sin_na"</span>)</span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a>z_240422_2_2 <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_2[,<span class="st">"lag_comp_bpsc_y3_severe"</span>] <span class="sc">~</span> time240422_2, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co">#</span></span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_2, <span class="fu">fitted</span>(z_240422_2_2))</span>
<span id="cb297-17"><a href="#cb297-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_2, res240422_2[,<span class="st">"lag_comp_bpsc_y3_severe"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb297-18"><a href="#cb297-18" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_comp_bpsc_y3_severe"</span>)</span>
<span id="cb297-19"><a href="#cb297-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-20"><a href="#cb297-20" aria-hidden="true" tabindex="-1"></a>km_lag_comp_bpsc_y3_severe <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb297-21"><a href="#cb297-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_proc2)</span>
<span id="cb297-22"><a href="#cb297-22" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(km_home) # just to see the km curves</span></span>
<span id="cb297-23"><a href="#cb297-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-24"><a href="#cb297-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_lag_comp_bpsc_y3_severe, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>),</span>
<span id="cb297-25"><a href="#cb297-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by km_lag_comp_bpsc_y3_severe"</span>)</span>
<span id="cb297-26"><a href="#cb297-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-6-iiw-weights-test-int2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_comp_bpsc.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-30: Analyse the violation of proportional hazards (restricted)"</span>)</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>res240422_2_restr <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt, <span class="st">"scaledsch"</span>)</span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>time240422_2_restr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res240422_2_restr)[[<span class="dv">1</span>]])</span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>z_240422_2_1_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_2_restr[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>] <span class="sc">~</span> time240422_2_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a><span class="co"># x11() </span></span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_2_restr, <span class="fu">fitted</span>(z_240422_2_1_restr))</span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_2_restr, res240422_2_restr[,<span class="st">"log_lag_dias_treat_imp_sin_na"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., log_lag_dias_treat_imp_sin_na (restricted)"</span>)</span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a>z_240422_2_2_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_2_restr[,<span class="st">"lag_comp_bpsc_y3_severe"</span>] <span class="sc">~</span> time240422_2_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co">#</span></span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_2_restr, <span class="fu">fitted</span>(z_240422_2_2_restr))</span>
<span id="cb300-17"><a href="#cb300-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_2_restr, res240422_2_restr[,<span class="st">"lag_comp_bpsc_y3_severe"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb300-18"><a href="#cb300-18" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_comp_bpsc_y3_severe (restricted)"</span>)</span>
<span id="cb300-19"><a href="#cb300-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-20"><a href="#cb300-20" aria-hidden="true" tabindex="-1"></a>km_lag_comp_bpsc_y3_severe_restr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb300-21"><a href="#cb300-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb300-22"><a href="#cb300-22" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(km_home) # just to see the km curves</span></span>
<span id="cb300-23"><a href="#cb300-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-24"><a href="#cb300-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_lag_comp_bpsc_y3_severe_restr, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>),</span>
<span id="cb300-25"><a href="#cb300-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by km_lag_comp_bpsc_y3_severe"</span>)</span>
<span id="cb300-26"><a href="#cb300-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-6-iiw-weights-test-int2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_comp_bpsc_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-05-30: restricted w/ tipo de plan 2 mod; find TVCs"</span>)</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The model was better after correction: "</span>,</span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>)</span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a>               ,<span class="st">" vs. the original: "</span>,</span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(cox_iiw_proposed)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>)</span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a>               ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The model was better after correction: 363.2 vs.&nbsp;the original: 495.5</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The model was better after correction: 361.9 vs. the original: 495.5</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="dv">7</span>,.<span class="dv">1</span>)) {</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>  change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span>i, <span class="dv">10</span><span class="sc">*</span>i, <span class="dv">15</span><span class="sc">*</span>i)  <span class="co"># Example change points (months)</span></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_comp_bpsc_y3_severe_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2, lag_comp_bpsc_y3_severe<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>comp_bpsc_y3_severe_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2, comp_bpsc_y3_severe<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe<span class="ot">&lt;-</span></span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb304-16"><a href="#cb304-16" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_tr_outcome +</span></span>
<span id="cb304-17"><a href="#cb304-17" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb304-18"><a href="#cb304-18" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec+</span></span>
<span id="cb304-19"><a href="#cb304-19" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe_rec2 + </span></span>
<span id="cb304-20"><a href="#cb304-20" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb304-21"><a href="#cb304-21" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb304-22"><a href="#cb304-22" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb304-23"><a href="#cb304-23" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb304-24"><a href="#cb304-24" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb304-25"><a href="#cb304-25" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb304-26"><a href="#cb304-26" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb304-27"><a href="#cb304-27" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb304-28"><a href="#cb304-28" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb304-29"><a href="#cb304-29" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb304-30"><a href="#cb304-30" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb304-31"><a href="#cb304-31" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb304-32"><a href="#cb304-32" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb304-33"><a href="#cb304-33" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb304-34"><a href="#cb304-34" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb304-35"><a href="#cb304-35" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb304-36"><a href="#cb304-36" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb304-37"><a href="#cb304-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb304-38"><a href="#cb304-38" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb304-39"><a href="#cb304-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb304-40"><a href="#cb304-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb304-41"><a href="#cb304-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe)</span>
<span id="cb304-42"><a href="#cb304-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb304-43"><a href="#cb304-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb304-44"><a href="#cb304-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(change_points)</span>
<span id="cb304-45"><a href="#cb304-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe)<span class="sc">$</span>table), <span class="dv">1</span>]))</span>
<span id="cb304-46"><a href="#cb304-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb304-47"><a href="#cb304-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] 0.5 1.0 1.5
[1] "366.7352"
[1] "iteration: 0.2"
[1] 1 2 3
[1] "367.6181"
[1] "iteration: 0.3"
[1] 1.5 3.0 4.5
[1] "359.0755"
[1] "iteration: 0.4"
[1] 2 4 6
[1] "358.9647"
[1] "iteration: 0.5"
[1] 2.5 5.0 7.5
[1] "362.0432"
[1] "iteration: 0.6"
[1] 3 6 9
[1] "367.2566"
[1] "iteration: 0.7"
[1]  3.5  7.0 10.5
[1] "368.7599"
[1] "iteration: 0.8"
[1]  4  8 12
[1] "364.0977"
[1] "iteration: 0.9"
[1]  4.5  9.0 13.5
[1] "363.4215"
[1] "iteration: 1"
[1]  5 10 15
[1] "361.3236"
[1] "iteration: 1.1"
[1]  5.5 11.0 16.5
[1] "361.5829"
[1] "iteration: 1.2"
[1]  6 12 18
[1] "359.3325"
[1] "iteration: 1.3"
[1]  6.5 13.0 19.5
[1] "357.4246"
[1] "iteration: 1.4"
[1]  7 14 21
[1] "356.7213"
[1] "iteration: 1.5"
[1]  7.5 15.0 22.5
[1] "356.5751"
[1] "iteration: 1.6"
[1]  8 16 24
[1] "356.1985"
[1] "iteration: 1.7"
[1]  8.5 17.0 25.5
[1] "355.9476"
[1] "iteration: 1.8"
[1]  9 18 27
[1] "356.0388"
[1] "iteration: 1.9"
[1]  9.5 19.0 28.5
[1] "355.7839"
[1] "iteration: 2"
[1] 10 20 30
[1] "355.8856"
[1] "iteration: 2.1"
[1] 10.5 21.0 31.5
[1] "355.274"
[1] "iteration: 2.2"
[1] 11 22 33
[1] "355.3662"
[1] "iteration: 2.3"
[1] 11.5 23.0 34.5
[1] "355.2717"
[1] "iteration: 2.4"
[1] 12 24 36
[1] "355.2632"
[1] "iteration: 2.5"
[1] 12.5 25.0 37.5
[1] "355.6316"
[1] "iteration: 2.6"
[1] 13 26 39
[1] "355.7911"
[1] "iteration: 2.7"
[1] 13.5 27.0 40.5
[1] "355.9782"
[1] "iteration: 2.8"
[1] 14 28 42
[1] "355.725"
[1] "iteration: 2.9"
[1] 14.5 29.0 43.5
[1] "356.2413"
[1] "iteration: 3"
[1] 15 30 45
[1] "356.405"
[1] "iteration: 3.1"
[1] 15.5 31.0 46.5
[1] "356.2095"
[1] "iteration: 3.2"
[1] 16 32 48
[1] "357.5944"
[1] "iteration: 3.3"
[1] 16.5 33.0 49.5
[1] "358.5072"
[1] "iteration: 3.4"
[1] 17 34 51
[1] "359.3226"
[1] "iteration: 3.5"
[1] 17.5 35.0 52.5
[1] "359.6748"
[1] "iteration: 3.6"
[1] 18 36 54
[1] "359.214"
[1] "iteration: 3.7"
[1] 18.5 37.0 55.5
[1] "359.4672"
[1] "iteration: 3.8"
[1] 19 38 57
[1] "361.2473"
[1] "iteration: 3.9"
[1] 19.5 39.0 58.5
[1] "361.1348"
[1] "iteration: 4"
[1] 20 40 60
[1] "361.7292"
[1] "iteration: 4.1"
[1] 20.5 41.0 61.5
[1] "364.4573"
[1] "iteration: 4.2"
[1] 21 42 63
[1] "363.8848"
[1] "iteration: 4.3"
[1] 21.5 43.0 64.5
[1] "363.5723"
[1] "iteration: 4.4"
[1] 22 44 66
[1] "364.5945"
[1] "iteration: 4.5"
[1] 22.5 45.0 67.5
[1] "365.1071"
[1] "iteration: 4.6"
[1] 23 46 69
[1] "365.8701"
[1] "iteration: 4.7"
[1] 23.5 47.0 70.5
[1] "364.955"
[1] "iteration: 4.8"
[1] 24 48 72
[1] "365.3112"
[1] "iteration: 4.9"
[1] 24.5 49.0 73.5
[1] "365.706"
[1] "iteration: 5"
[1] 25 50 75
[1] "366.3371"
[1] "iteration: 5.1"
[1] 25.5 51.0 76.5
[1] "367.0493"
[1] "iteration: 5.2"
[1] 26 52 78
[1] "367.9306"
[1] "iteration: 5.3"
[1] 26.5 53.0 79.5
[1] "368.4692"
[1] "iteration: 5.4"
[1] 27 54 81
[1] "368.9484"
[1] "iteration: 5.5"
[1] 27.5 55.0 82.5
[1] "370.2654"
[1] "iteration: 5.6"
[1] 28 56 84
[1] "370.4634"
[1] "iteration: 5.7"
[1] 28.5 57.0 85.5
[1] "371.0471"
[1] "iteration: 5.8"
[1] 29 58 87
[1] "371.8349"
[1] "iteration: 5.9"
[1] 29.5 59.0 88.5
[1] "372.2448"
[1] "iteration: 6"
[1] 30 60 90
[1] "371.6"
[1] "iteration: 6.1"
[1] 30.5 61.0 91.5
[1] "371.2923"
[1] "iteration: 6.2"
[1] 31 62 93
[1] "371.9248"
[1] "iteration: 6.3"
[1] 31.5 63.0 94.5
[1] "372.2759"
[1] "iteration: 6.4"
[1] 32 64 96
[1] "371.9611"
[1] "iteration: 6.5"
[1] 32.5 65.0 97.5
[1] "371.9074"
[1] "iteration: 6.6"
[1] 33 66 99
[1] "371.3031"
[1] "iteration: 6.7"
[1]  33.5  67.0 100.5
[1] "371.2377"
[1] "iteration: 6.8"
[1]  34  68 102
[1] "370.6362"
[1] "iteration: 6.9"
[1]  34.5  69.0 103.5
[1] "371.8994"
[1] "iteration: 7"
[1]  35  70 105
[1] "371.8839"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The previously modified model: "</span>,</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the actual models: 354.7"</span></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>               ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The previously modified model: 363.2 vs.&nbsp;the actual models: 354.7</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The previously modified model: 361.9 vs. the actual models: 354.7</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>results_bpsc_severe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="fl">1.5</span>,.<span class="dv">025</span>)) {</span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span>i</span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_comp_bpsc_y3_severe_rec<span class="ot">&lt;-</span></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>lag_comp_bpsc_y3_severe, </span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>comp_bpsc_y3_severe_rec<span class="ot">&lt;-</span></span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>comp_bpsc_y3_severe, </span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb307-20"><a href="#cb307-20" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb307-21"><a href="#cb307-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb307-22"><a href="#cb307-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb307-23"><a href="#cb307-23" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt<span class="ot">&lt;-</span></span>
<span id="cb307-24"><a href="#cb307-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb307-25"><a href="#cb307-25" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb307-26"><a href="#cb307-26" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_tr_outcome +</span></span>
<span id="cb307-27"><a href="#cb307-27" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb307-28"><a href="#cb307-28" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec+</span></span>
<span id="cb307-29"><a href="#cb307-29" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb307-30"><a href="#cb307-30" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb307-31"><a href="#cb307-31" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb307-32"><a href="#cb307-32" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb307-33"><a href="#cb307-33" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb307-34"><a href="#cb307-34" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb307-35"><a href="#cb307-35" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb307-36"><a href="#cb307-36" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb307-37"><a href="#cb307-37" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb307-38"><a href="#cb307-38" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb307-39"><a href="#cb307-39" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb307-40"><a href="#cb307-40" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb307-41"><a href="#cb307-41" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb307-42"><a href="#cb307-42" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb307-43"><a href="#cb307-43" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb307-44"><a href="#cb307-44" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb307-45"><a href="#cb307-45" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb307-46"><a href="#cb307-46" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb307-47"><a href="#cb307-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb307-48"><a href="#cb307-48" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb307-49"><a href="#cb307-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb307-50"><a href="#cb307-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb307-51"><a href="#cb307-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)</span>
<span id="cb307-52"><a href="#cb307-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb307-53"><a href="#cb307-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb307-54"><a href="#cb307-54" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb307-55"><a href="#cb307-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]))</span>
<span id="cb307-56"><a href="#cb307-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb307-57"><a href="#cb307-57" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb307-58"><a href="#cb307-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb307-59"><a href="#cb307-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb307-60"><a href="#cb307-60" aria-hidden="true" tabindex="-1"></a>  results_bpsc_severe <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_bpsc_severe, </span>
<span id="cb307-61"><a href="#cb307-61" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cbind.data.frame</span>(</span>
<span id="cb307-62"><a href="#cb307-62" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; tvcs: "</span>, tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]), </span>
<span id="cb307-63"><a href="#cb307-63" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">aic =</span> aic_iter,</span>
<span id="cb307-64"><a href="#cb307-64" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb307-65"><a href="#cb307-65" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">success =</span> T</span>
<span id="cb307-66"><a href="#cb307-66" aria-hidden="true" tabindex="-1"></a>                                          ))</span>
<span id="cb307-67"><a href="#cb307-67" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] "Time points: 2, 8"
[1] "AIC: 244648.5"
[1] "Cox ZPH: 2027.052"
[1] "iteration: 0.125"
[1] "Time points: 2.5, 10"
[1] "AIC: 244584.1"
[1] "Cox ZPH: 2126.697"
[1] "iteration: 0.15"
[1] "Time points: 3, 12"
[1] "AIC: 244529.8"
[1] "Cox ZPH: 2176.088"
[1] "iteration: 0.175"
[1] "Time points: 3.5, 14"
[1] "AIC: 244488.4"
[1] "Cox ZPH: 2165.634"
[1] "iteration: 0.2"
[1] "Time points: 4, 16"
[1] "AIC: 244463.4"
[1] "Cox ZPH: 2084.661"
[1] "iteration: 0.225"
[1] "Time points: 4.5, 18"
[1] "AIC: 244450.7"
[1] "Cox ZPH: 1955.693"
[1] "iteration: 0.25"
[1] "Time points: 5, 20"
[1] "AIC: 244448.3"
[1] "Cox ZPH: 1792.717"
[1] "iteration: 0.275"
[1] "Time points: 5.5, 22"
[1] "AIC: 244464.3"
[1] "Cox ZPH: 1576.648"
[1] "iteration: 0.3"
[1] "Time points: 6, 24"
[1] "AIC: 244495.7"
[1] "Cox ZPH: 1325.06"
[1] "iteration: 0.325"
[1] "Time points: 6.5, 26"
[1] "AIC: 244537.3"
[1] "Cox ZPH: 1069.782"
[1] "iteration: 0.35"
[1] "Time points: 7, 28"
[1] "AIC: 244590.8"
[1] "Cox ZPH: 825.2673"
[1] "iteration: 0.375"
[1] "Time points: 7.5, 30"
[1] "AIC: 244656"
[1] "Cox ZPH: 608.8866"
[1] "iteration: 0.4"
[1] "Time points: 8, 32"
[1] "AIC: 244730.5"
[1] "Cox ZPH: 444.7581"
[1] "iteration: 0.425"
[1] "Time points: 8.5, 34"
[1] "AIC: 244815.5"
[1] "Cox ZPH: 352.1245"
[1] "iteration: 0.45"
[1] "Time points: 9, 36"
[1] "AIC: 244909.7"
[1] "Cox ZPH: 353.8899"
[1] "iteration: 0.475"
[1] "Time points: 9.5, 38"
[1] "AIC: 245009.8"
[1] "Cox ZPH: 465.3513"
[1] "iteration: 0.5"
[1] "Time points: 10, 40"
[1] "AIC: 245111.2"
[1] "Cox ZPH: 687.6218"
[1] "iteration: 0.525"
[1] "Time points: 10.5, 42"
[1] "AIC: 245215"
[1] "Cox ZPH: 1018.352"
[1] "iteration: 0.55"
[1] "Time points: 11, 44"
[1] "AIC: 245321.5"
[1] "Cox ZPH: 1450.489"
[1] "iteration: 0.575"
[1] "Time points: 11.5, 46"
[1] "AIC: 245426.3"
[1] "Cox ZPH: 1956.628"
[1] "iteration: 0.6"
[1] "Time points: 12, 48"
[1] "AIC: 245526.3"
[1] "Cox ZPH: 2500.774"
[1] "iteration: 0.625"
[1] "Time points: 12.5, 50"
[1] "AIC: 245620.4"
[1] "Cox ZPH: 3058.768"
[1] "iteration: 0.65"
[1] "Time points: 13, 52"
[1] "AIC: 245707.3"
[1] "Cox ZPH: 3601.197"
[1] "iteration: 0.675"
[1] "Time points: 13.5, 54"
[1] "AIC: 245785.6"
[1] "Cox ZPH: 4103.462"
[1] "iteration: 0.7"
[1] "Time points: 14, 56"
[1] "AIC: 245853"
[1] "Cox ZPH: 4540.246"
[1] "iteration: 0.725"
[1] "Time points: 14.5, 58"
[1] "AIC: 245907.2"
[1] "Cox ZPH: 4898.792"
[1] "iteration: 0.75"
[1] "Time points: 15, 60"
[1] "AIC: 245946"
[1] "Cox ZPH: 5174.502"
[1] "iteration: 0.775"
[1] "Time points: 15.5, 62"
[1] "AIC: 245968.4"
[1] "Cox ZPH: 5365.95"
[1] "iteration: 0.8"
[1] "Time points: 16, 64"
[1] "AIC: 245972.6"
[1] "Cox ZPH: 5481.321"
[1] "iteration: 0.825"
[1] "Time points: 16.5, 66"
[1] "AIC: 245957.5"
[1] "Cox ZPH: 5527.575"
[1] "iteration: 0.85"
[1] "Time points: 17, 68"
[1] "AIC: 245922.4"
[1] "Cox ZPH: 5514.13"
[1] "iteration: 0.875"
[1] "Time points: 17.5, 70"
[1] "AIC: 245866.7"
[1] "Cox ZPH: 5451.26"
[1] "iteration: 0.9"
[1] "Time points: 18, 72"
[1] "AIC: 245789.7"
[1] "Cox ZPH: 5347.218"
[1] "iteration: 0.925"
[1] "Time points: 18.5, 74"
[1] "AIC: 245690.6"
[1] "Cox ZPH: 5203.803"
[1] "iteration: 0.95"
[1] "Time points: 19, 76"
[1] "AIC: 245569.6"
[1] "Cox ZPH: 5028.824"
[1] "iteration: 0.975"
[1] "Time points: 19.5, 78"
[1] "AIC: 245425.6"
[1] "Cox ZPH: 4827.561"
[1] "iteration: 1"
[1] "Time points: 20, 80"
[1] "AIC: 245258.7"
[1] "Cox ZPH: 4603.399"
[1] "iteration: 1.025"
[1] "Time points: 20.5, 82"
[1] "AIC: 245070.3"
[1] "Cox ZPH: 4363.59"
[1] "iteration: 1.05"
[1] "Time points: 21, 84"
[1] "AIC: 244861.8"
[1] "Cox ZPH: 4111.058"
[1] "iteration: 1.075"
[1] "Time points: 21.5, 86"
[1] "AIC: 244633.9"
[1] "Cox ZPH: 3848.298"
[1] "iteration: 1.1"
[1] "Time points: 22, 88"
[1] "AIC: 244389.1"
[1] "Cox ZPH: 3579.744"
[1] "iteration: 1.125"
[1] "Time points: 22.5, 90"
[1] "AIC: 244129.8"
[1] "Cox ZPH: 3308.287"
[1] "iteration: 1.15"
[1] "Time points: 23, 92"
[1] "AIC: 243857.6"
[1] "Cox ZPH: 3037.355"
[1] "iteration: 1.175"
[1] "Time points: 23.5, 94"
[1] "AIC: 243578.2"
[1] "Cox ZPH: 2772.307"
[1] "iteration: 1.2"
[1] "Time points: 24, 96"
[1] "AIC: 243291.8"
[1] "Cox ZPH: 2512.812"
[1] "iteration: 1.225"
[1] "Time points: 24.5, 98"
[1] "AIC: 243000.5"
[1] "Cox ZPH: 2265.902"
[1] "iteration: 1.25"
[1] "Time points: 25, 100"
[1] "AIC: 242705.8"
[1] "Cox ZPH: 2025.213"
[1] "iteration: 1.275"
[1] "Time points: 25.5, 102"
[1] "AIC: 242407"
[1] "Cox ZPH: 1795.87"
[1] "iteration: 1.3"
[1] "Time points: 26, 104"
[1] "AIC: 242104.5"
[1] "Cox ZPH: 1579.576"
[1] "iteration: 1.325"
[1] "Time points: 26.5, 106"
[1] "AIC: 241802.2"
[1] "Cox ZPH: 1380.713"
[1] "iteration: 1.35"
[1] "Time points: 27, 108"
[1] "AIC: 241506.2"
[1] "Cox ZPH: 1203.313"
[1] "iteration: 1.375"
[1] "Time points: 27.5, 110"
[1] "AIC: 241224.7"
[1] "Cox ZPH: 1051.053"
[1] "iteration: 1.4"
[1] "Time points: 28, 112"
[1] "AIC: 240963.6"
[1] "Cox ZPH: 927.1896"
[1] "iteration: 1.425"
[1] "Time points: 28.5, 114"
[1] "AIC: 240715"
[1] "Cox ZPH: 832.7559"
[1] "iteration: 1.45"
[1] "Time points: 29, 116"
[1] "AIC: 240498.4"
[1] "Cox ZPH: 775.9883"
[1] "iteration: 1.475"
[1] "Time points: 29.5, 118"
[1] "AIC: 240307.3"
[1] "Cox ZPH: 769.6182"
[1] "iteration: 1.5"
[1] "Time points: 30, 120"
[1] "AIC: 240155.7"
[1] "Cox ZPH: 837.3566"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>results_bpsc_severe[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_bpsc_severe<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_bpsc_severe<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              spec      aic  cox_zph success
14 iteration: 0.425; tvcs: 8.5, 34 244815.5 352.1245    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                               spec      aic  cox_zph success</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 14 iteration: 0.425; tvcs: 8.5, 34 244802.6 351.5909    TRUE</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span><span class="fl">0.425</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_comp_bpsc_y3_severe_rec<span class="ot">&lt;-</span></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>lag_comp_bpsc_y3_severe, </span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>comp_bpsc_y3_severe_rec<span class="ot">&lt;-</span></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>comp_bpsc_y3_severe, </span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt<span class="ot">&lt;-</span></span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span> </span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb311-22"><a href="#cb311-22" aria-hidden="true" tabindex="-1"></a>            lag_tr_outcome <span class="sc">+</span></span>
<span id="cb311-23"><a href="#cb311-23" aria-hidden="true" tabindex="-1"></a>            log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb311-24"><a href="#cb311-24" aria-hidden="true" tabindex="-1"></a>            lag_less_90d_tr1_rec<span class="sc">+</span></span>
<span id="cb311-25"><a href="#cb311-25" aria-hidden="true" tabindex="-1"></a>            lag_comp_bpsc_y3_severe_rec <span class="sc">+</span> </span>
<span id="cb311-26"><a href="#cb311-26" aria-hidden="true" tabindex="-1"></a>            lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb311-27"><a href="#cb311-27" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb311-28"><a href="#cb311-28" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb311-29"><a href="#cb311-29" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb311-30"><a href="#cb311-30" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb311-31"><a href="#cb311-31" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb311-32"><a href="#cb311-32" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb311-33"><a href="#cb311-33" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb311-34"><a href="#cb311-34" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb311-35"><a href="#cb311-35" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb311-36"><a href="#cb311-36" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb311-37"><a href="#cb311-37" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb311-38"><a href="#cb311-38" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb311-39"><a href="#cb311-39" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb311-40"><a href="#cb311-40" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb311-41"><a href="#cb311-41" aria-hidden="true" tabindex="-1"></a>            susprindum_mar<span class="sc">+</span></span>
<span id="cb311-42"><a href="#cb311-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb311-43"><a href="#cb311-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb311-44"><a href="#cb311-44" aria-hidden="true" tabindex="-1"></a>        data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb311-45"><a href="#cb311-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb311-46"><a href="#cb311-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-47"><a href="#cb311-47" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 chisq df       p
lag_tr_outcome                 19.1955  1 1.2e-05
log_lag_dias_treat_imp_sin_na  49.0939  1 2.4e-12
lag_less_90d_tr1_rec           42.0858  1 8.7e-11
lag_comp_bpsc_y3_severe_rec     1.5266  1 0.21662
lag_policonsumo2                1.5932  1 0.20687
edad_al_ing_1                  17.6296  1 2.7e-05
ano_nac_corr                    1.6974  1 0.19263
susinidum_oh                   23.7232  1 1.1e-06
susinidum_coc                   3.6139  1 0.05730
susinidum_pbc                   2.7404  1 0.09784
susinidum_mar                  13.2315  1 0.00028
psycom_dum_with                14.6452  1 0.00013
psycom_dum_study                8.0507  1 0.00455
freq_cons_dum_5day              0.4958  1 0.48136
cond_oc_dum_2inact              7.9362  1 0.00485
cond_oc_dum_3unemp              5.2995  1 0.02133
susprindum_oh                  11.5928  1 0.00066
susprindum_coc                  0.0487  1 0.82530
susprindum_pbc                  2.8441  1 0.09171
susprindum_mar                  7.8036  1 0.00521
GLOBAL                        352.1245 20 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  chisq df       p</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 19.4440  1 1.0e-05 </span><span class="al">###</span></span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na  48.7236  1 2.9e-12 ####</span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1_rec           42.0653  1 8.8e-11 ####</span></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe_rec     1.5369  1 0.21508 </span></span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                1.5765  1 0.20926</span></span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  17.5785  1 2.8e-05 </span><span class="al">###</span></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    1.6876  1 0.19392</span></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   23.5183  1 1.2e-06 </span><span class="al">###</span></span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                   3.6019  1 0.05771</span></span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   2.6388  1 0.10428</span></span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  13.2146  1 0.00028 ##</span></span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                14.7208  1 0.00012 #</span></span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                8.0570  1 0.00453 #</span></span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              0.5748  1 0.44834</span></span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              7.9683  1 0.00476</span></span>
<span id="cb313-17"><a href="#cb313-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp              5.0871  1 0.02410 #</span></span>
<span id="cb313-18"><a href="#cb313-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  11.4536  1 0.00071 ##</span></span>
<span id="cb313-19"><a href="#cb313-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  0.0549  1 0.81473</span></span>
<span id="cb313-20"><a href="#cb313-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                  2.7348  1 0.09818</span></span>
<span id="cb313-21"><a href="#cb313-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  7.8675  1 0.00503 ##</span></span>
<span id="cb313-22"><a href="#cb313-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        351.5909 20 &lt; 2e-16</span></span>
<span id="cb313-23"><a href="#cb313-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb313-24"><a href="#cb313-24" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb313-25"><a href="#cb313-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb313-26"><a href="#cb313-26" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Analyse the violation of proportional hazards"</span>)</span>
<span id="cb313-27"><a href="#cb313-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb313-28"><a href="#cb313-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb313-29"><a href="#cb313-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-30"><a href="#cb313-30" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-04-30: restricted"</span>)</span>
<span id="cb313-31"><a href="#cb313-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-32"><a href="#cb313-32" aria-hidden="true" tabindex="-1"></a>res240422_3_restr <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt, <span class="st">"scaledsch"</span>)</span>
<span id="cb313-33"><a href="#cb313-33" aria-hidden="true" tabindex="-1"></a>time240422_3_restr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res240422_3_restr)[[<span class="dv">1</span>]])</span>
<span id="cb313-34"><a href="#cb313-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-35"><a href="#cb313-35" aria-hidden="true" tabindex="-1"></a>z_240422_3_1_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_3_restr[,<span class="st">"susinidum_oh"</span>] <span class="sc">~</span> time240422_3_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb313-36"><a href="#cb313-36" aria-hidden="true" tabindex="-1"></a><span class="co"># x11() </span></span>
<span id="cb313-37"><a href="#cb313-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-38"><a href="#cb313-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb313-39"><a href="#cb313-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_3_restr, <span class="fu">fitted</span>(z_240422_3_1_restr))</span>
<span id="cb313-40"><a href="#cb313-40" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_3_restr, res240422_3_restr[,<span class="st">"susinidum_oh"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb313-41"><a href="#cb313-41" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., susinidum_oh"</span>)</span>
<span id="cb313-42"><a href="#cb313-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-43"><a href="#cb313-43" aria-hidden="true" tabindex="-1"></a>z_240422_3_2_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_3_restr[,<span class="st">"susinidum_oh"</span>] <span class="sc">~</span> time240422_3_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co">#</span></span>
<span id="cb313-44"><a href="#cb313-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_3_restr, <span class="fu">fitted</span>(z_240422_3_2_restr))</span>
<span id="cb313-45"><a href="#cb313-45" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_3_restr, res240422_3_restr[,<span class="st">"susinidum_oh"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb313-46"><a href="#cb313-46" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., susinidum_oh"</span>)</span>
<span id="cb313-47"><a href="#cb313-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-48"><a href="#cb313-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)[<span class="fu">which</span>(<span class="fu">attr</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"psycom_dum_study"</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span> <span class="st">"Residuals of psycom_dum_study"</span>)</span>
<span id="cb313-49"><a href="#cb313-49" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb313-50"><a href="#cb313-50" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt<span class="sc">$</span>coefficients[<span class="st">"psycom_dum_study"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb313-51"><a href="#cb313-51" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb313-52"><a href="#cb313-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-53"><a href="#cb313-53" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)[<span class="fu">which</span>(<span class="fu">attr</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"psycom_dum_with"</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span> <span class="st">"Residuals of psycom_dum_with"</span>)</span>
<span id="cb313-54"><a href="#cb313-54" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb313-55"><a href="#cb313-55" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt<span class="sc">$</span>coefficients[<span class="st">"psycom_dum_with"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb313-56"><a href="#cb313-56" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb313-57"><a href="#cb313-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-58"><a href="#cb313-58" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(km_home) # just to see the km curves</span></span>
<span id="cb313-59"><a href="#cb313-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-60"><a href="#cb313-60" aria-hidden="true" tabindex="-1"></a>km_psycom_dum_study_restr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> psycom_dum_study<span class="sc">+</span> </span>
<span id="cb313-61"><a href="#cb313-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb313-62"><a href="#cb313-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_psycom_dum_study_restr, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by psycom_dum_study (restricted)"</span>)</span>
<span id="cb313-63"><a href="#cb313-63" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb313-64"><a href="#cb313-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-65"><a href="#cb313-65" aria-hidden="true" tabindex="-1"></a>km_psycom_dum_with_restr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> psycom_dum_with<span class="sc">+</span> </span>
<span id="cb313-66"><a href="#cb313-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb313-67"><a href="#cb313-67" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(km_home) # just to see the km curves</span></span>
<span id="cb313-68"><a href="#cb313-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-69"><a href="#cb313-69" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_psycom_dum_with_restr, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by km_psycom_dum_with (restricted)"</span>)</span>
<span id="cb313-70"><a href="#cb313-70" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-7-iiw-weights-test-int3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_psycom_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-05-01: restricted"</span>)</span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>res240422_4_restr <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt, <span class="st">"scaledsch"</span>)</span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>time240422_4_restr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res240422_3_restr)[[<span class="dv">1</span>]])</span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a>z_240422_4_1_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_4_restr[,<span class="st">"lag_tr_outcome"</span>] <span class="sc">~</span> time240422_4_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a><span class="co"># x11() </span></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb316-12"><a href="#cb316-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_4_restr, <span class="fu">fitted</span>(z_240422_4_1_restr))</span>
<span id="cb316-13"><a href="#cb316-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_4_restr, res240422_4_restr[,<span class="st">"lag_tr_outcome"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb316-14"><a href="#cb316-14" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., lag_tr_outcome"</span>)</span>
<span id="cb316-15"><a href="#cb316-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-16"><a href="#cb316-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt)[<span class="fu">which</span>(<span class="fu">attr</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"lag_tr_outcome"</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span> <span class="st">"Residuals of lag_tr_outcome"</span>)</span>
<span id="cb316-17"><a href="#cb316-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb316-18"><a href="#cb316-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt<span class="sc">$</span>coefficients[<span class="st">"lag_tr_outcome"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb316-19"><a href="#cb316-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb316-20"><a href="#cb316-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-21"><a href="#cb316-21" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(km_home) # just to see the km curves</span></span>
<span id="cb316-22"><a href="#cb316-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-23"><a href="#cb316-23" aria-hidden="true" tabindex="-1"></a>km_lag_tr_outcome_restr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> lag_tr_outcome<span class="sc">+</span> </span>
<span id="cb316-24"><a href="#cb316-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb316-25"><a href="#cb316-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_lag_tr_outcome_restr, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by km_lag_tr_outcome (restricted)"</span>)</span>
<span id="cb316-26"><a href="#cb316-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="proposal_grant_23_24_3_files/figure-html/irrelong-7-iiw-weights-test-int3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_lag_tr_outcome_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load("E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/20240502_avance_iiw.RData")</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>results_lag_tr_outcome <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="fl">1.5</span>,.<span class="dv">025</span>)) {</span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a>tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span>i</span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_tr_outcome_rec<span class="ot">&lt;-</span></span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>lag_tr_outcome, </span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb319-14"><a href="#cb319-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb319-15"><a href="#cb319-15" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>tr_outcome_rec<span class="ot">&lt;-</span></span>
<span id="cb319-16"><a href="#cb319-16" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tr_outcome, </span>
<span id="cb319-17"><a href="#cb319-17" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb319-18"><a href="#cb319-18" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb319-19"><a href="#cb319-19" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb319-20"><a href="#cb319-20" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb319-21"><a href="#cb319-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-22"><a href="#cb319-22" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out<span class="ot">&lt;-</span></span>
<span id="cb319-23"><a href="#cb319-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb319-24"><a href="#cb319-24" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb319-25"><a href="#cb319-25" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_tr_outcome_rec +</span></span>
<span id="cb319-26"><a href="#cb319-26" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb319-27"><a href="#cb319-27" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec+</span></span>
<span id="cb319-28"><a href="#cb319-28" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb319-29"><a href="#cb319-29" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb319-30"><a href="#cb319-30" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb319-31"><a href="#cb319-31" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb319-32"><a href="#cb319-32" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb319-33"><a href="#cb319-33" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb319-34"><a href="#cb319-34" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb319-35"><a href="#cb319-35" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb319-36"><a href="#cb319-36" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb319-37"><a href="#cb319-37" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb319-38"><a href="#cb319-38" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb319-39"><a href="#cb319-39" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb319-40"><a href="#cb319-40" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb319-41"><a href="#cb319-41" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb319-42"><a href="#cb319-42" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb319-43"><a href="#cb319-43" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb319-44"><a href="#cb319-44" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb319-45"><a href="#cb319-45" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb319-46"><a href="#cb319-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb319-47"><a href="#cb319-47" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb319-48"><a href="#cb319-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb319-49"><a href="#cb319-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-50"><a href="#cb319-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)</span>
<span id="cb319-51"><a href="#cb319-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb319-52"><a href="#cb319-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb319-53"><a href="#cb319-53" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb319-54"><a href="#cb319-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]))</span>
<span id="cb319-55"><a href="#cb319-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb319-56"><a href="#cb319-56" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb319-57"><a href="#cb319-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb319-58"><a href="#cb319-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb319-59"><a href="#cb319-59" aria-hidden="true" tabindex="-1"></a>  results_lag_tr_outcome <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_lag_tr_outcome, </span>
<span id="cb319-60"><a href="#cb319-60" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cbind.data.frame</span>(</span>
<span id="cb319-61"><a href="#cb319-61" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; tvcs: "</span>, tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]), </span>
<span id="cb319-62"><a href="#cb319-62" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">aic =</span> aic_iter,</span>
<span id="cb319-63"><a href="#cb319-63" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb319-64"><a href="#cb319-64" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">success =</span> T</span>
<span id="cb319-65"><a href="#cb319-65" aria-hidden="true" tabindex="-1"></a>                                          ))</span>
<span id="cb319-66"><a href="#cb319-66" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] "Time points: 2, 8"
[1] "AIC: 241646.4"
[1] "Cox ZPH: 6034.712"
[1] "iteration: 0.125"
[1] "Time points: 2.5, 10"
[1] "AIC: 241490.1"
[1] "Cox ZPH: 6318.221"
[1] "iteration: 0.15"
[1] "Time points: 3, 12"
[1] "AIC: 241364.7"
[1] "Cox ZPH: 6459.451"
[1] "iteration: 0.175"
[1] "Time points: 3.5, 14"
[1] "AIC: 241275"
[1] "Cox ZPH: 6445.888"
[1] "iteration: 0.2"
[1] "Time points: 4, 16"
[1] "AIC: 241227.8"
[1] "Cox ZPH: 6262.837"
[1] "iteration: 0.225"
[1] "Time points: 4.5, 18"
[1] "AIC: 241218.5"
[1] "Cox ZPH: 5937.099"
[1] "iteration: 0.25"
[1] "Time points: 5, 20"
[1] "AIC: 241244"
[1] "Cox ZPH: 5480.285"
[1] "iteration: 0.275"
[1] "Time points: 5.5, 22"
[1] "AIC: 241314.3"
[1] "Cox ZPH: 4871.568"
[1] "iteration: 0.3"
[1] "Time points: 6, 24"
[1] "AIC: 241431.2"
[1] "Cox ZPH: 4108.697"
[1] "iteration: 0.325"
[1] "Time points: 6.5, 26"
[1] "AIC: 241579.4"
[1] "Cox ZPH: 3270.654"
[1] "iteration: 0.35"
[1] "Time points: 7, 28"
[1] "AIC: 241763.2"
[1] "Cox ZPH: 2385.785"
[1] "iteration: 0.375"
[1] "Time points: 7.5, 30"
[1] "AIC: 241978.3"
[1] "Cox ZPH: 1540.282"
[1] "iteration: 0.4"
[1] "Time points: 8, 32"
[1] "AIC: 242214.4"
[1] "Cox ZPH: 856.6484"
[1] "iteration: 0.425"
[1] "Time points: 8.5, 34"
[1] "AIC: 242469.5"
[1] "Cox ZPH: 423.423"
[1] "iteration: 0.45"
[1] "Time points: 9, 36"
[1] "AIC: 242741.2"
[1] "Cox ZPH: 321.6527"
[1] "iteration: 0.475"
[1] "Time points: 9.5, 38"
[1] "AIC: 243020.3"
[1] "Cox ZPH: 600.673"
[1] "iteration: 0.5"
[1] "Time points: 10, 40"
[1] "AIC: 243294.4"
[1] "Cox ZPH: 1241.962"
[1] "iteration: 0.525"
[1] "Time points: 10.5, 42"
[1] "AIC: 243564.4"
[1] "Cox ZPH: 2200.14"
[1] "iteration: 0.55"
[1] "Time points: 11, 44"
[1] "AIC: 243826.5"
[1] "Cox ZPH: 3401.45"
[1] "iteration: 0.575"
[1] "Time points: 11.5, 46"
[1] "AIC: 244069.7"
[1] "Cox ZPH: 4719.541"
[1] "iteration: 0.6"
[1] "Time points: 12, 48"
[1] "AIC: 244289.8"
[1] "Cox ZPH: 6050.557"
[1] "iteration: 0.625"
[1] "Time points: 12.5, 50"
[1] "AIC: 244485"
[1] "Cox ZPH: 7321.242"
[1] "iteration: 0.65"
[1] "Time points: 13, 52"
[1] "AIC: 244649.6"
[1] "Cox ZPH: 8448.845"
[1] "iteration: 0.675"
[1] "Time points: 13.5, 54"
[1] "AIC: 244779.6"
[1] "Cox ZPH: 9389.054"
[1] "iteration: 0.7"
[1] "Time points: 14, 56"
[1] "AIC: 244870"
[1] "Cox ZPH: 10113.72"
[1] "iteration: 0.725"
[1] "Time points: 14.5, 58"
[1] "AIC: 244916.8"
[1] "Cox ZPH: 10634.71"
[1] "iteration: 0.75"
[1] "Time points: 15, 60"
[1] "AIC: 244917.4"
[1] "Cox ZPH: 10977.17"
[1] "iteration: 0.775"
[1] "Time points: 15.5, 62"
[1] "AIC: 244869.9"
[1] "Cox ZPH: 11163.84"
[1] "iteration: 0.8"
[1] "Time points: 16, 64"
[1] "AIC: 244772.8"
[1] "Cox ZPH: 11235.97"
[1] "iteration: 0.825"
[1] "Time points: 16.5, 66"
[1] "AIC: 244626.8"
[1] "Cox ZPH: 11225.28"
[1] "iteration: 0.85"
[1] "Time points: 17, 68"
[1] "AIC: 244433.5"
[1] "Cox ZPH: 11152.15"
[1] "iteration: 0.875"
[1] "Time points: 17.5, 70"
[1] "AIC: 244193.4"
[1] "Cox ZPH: 11031.52"
[1] "iteration: 0.9"
[1] "Time points: 18, 72"
[1] "AIC: 243905.5"
[1] "Cox ZPH: 10877.46"
[1] "iteration: 0.925"
[1] "Time points: 18.5, 74"
[1] "AIC: 243572.4"
[1] "Cox ZPH: 10696.07"
[1] "iteration: 0.95"
[1] "Time points: 19, 76"
[1] "AIC: 243196.2"
[1] "Cox ZPH: 10495.89"
[1] "iteration: 0.975"
[1] "Time points: 19.5, 78"
[1] "AIC: 242775.1"
[1] "Cox ZPH: 10286.2"
[1] "iteration: 1"
[1] "Time points: 20, 80"
[1] "AIC: 242307"
[1] "Cox ZPH: 10071.06"
[1] "iteration: 1.025"
[1] "Time points: 20.5, 82"
[1] "AIC: 241797.4"
[1] "Cox ZPH: 9853.469"
[1] "iteration: 1.05"
[1] "Time points: 21, 84"
[1] "AIC: 241247"
[1] "Cox ZPH: 9636.775"
[1] "iteration: 1.075"
[1] "Time points: 21.5, 86"
[1] "AIC: 240656.4"
[1] "Cox ZPH: 9416.648"
[1] "iteration: 1.1"
[1] "Time points: 22, 88"
[1] "AIC: 240017.6"
[1] "Cox ZPH: 9186.961"
[1] "iteration: 1.125"
[1] "Time points: 22.5, 90"
[1] "AIC: 239332.2"
[1] "Cox ZPH: 8946.098"
[1] "iteration: 1.15"
[1] "Time points: 23, 92"
[1] "AIC: 238596"
[1] "Cox ZPH: 8687.54"
[1] "iteration: 1.175"
[1] "Time points: 23.5, 94"
[1] "AIC: 237808.6"
[1] "Cox ZPH: 8407.242"
[1] "iteration: 1.2"
[1] "Time points: 24, 96"
[1] "AIC: 236965.9"
[1] "Cox ZPH: 8104.911"
[1] "iteration: 1.225"
[1] "Time points: 24.5, 98"
[1] "AIC: 236068.8"
[1] "Cox ZPH: 7780.982"
[1] "iteration: 1.25"
[1] "Time points: 25, 100"
[1] "AIC: 235123.9"
[1] "Cox ZPH: 7435.731"
[1] "iteration: 1.275"
[1] "Time points: 25.5, 102"
[1] "AIC: 234128.5"
[1] "Cox ZPH: 7071.559"
[1] "iteration: 1.3"
[1] "Time points: 26, 104"
[1] "AIC: 233087.8"
[1] "Cox ZPH: 6690.547"
[1] "iteration: 1.325"
[1] "Time points: 26.5, 106"
[1] "AIC: 232023.4"
[1] "Cox ZPH: 6300.418"
[1] "iteration: 1.35"
[1] "Time points: 27, 108"
[1] "AIC: 230934.8"
[1] "Cox ZPH: 5901.547"
[1] "iteration: 1.375"
[1] "Time points: 27.5, 110"
[1] "AIC: 229821"
[1] "Cox ZPH: 5497.145"
[1] "iteration: 1.4"
[1] "Time points: 28, 112"
[1] "AIC: 228696.5"
[1] "Cox ZPH: 5091.223"
[1] "iteration: 1.425"
[1] "Time points: 28.5, 114"
[1] "AIC: 227581"
[1] "Cox ZPH: 4677.408"
[1] "iteration: 1.45"
[1] "Time points: 29, 116"
[1] "AIC: 226445.4"
[1] "Cox ZPH: 4221.169"
[1] "iteration: 1.475"
[1] "Time points: 29.5, 118"
[1] "AIC: 225226.2"
[1] "Cox ZPH: 3672.86"
[1] "iteration: 1.5"
[1] "Time points: 30, 120"
[1] "AIC: 223853.3"
[1] "Cox ZPH: 2998.596"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>results_lag_tr_outcome[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           spec      aic  cox_zph success
15 iteration: 0.45; tvcs: 9, 36 242741.2 321.6527    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                            spec      aic  cox_zph success</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 15 iteration: 0.45; tvcs: 9, 36 242729.5 321.3004    TRUE</span></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The previously modified model: "</span>,</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_alt)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_lag_tr_outcome[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>               ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The previously modified model: 363.2 vs.&nbsp;the minimum model: 321.6527</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The previously modified model: 361.9 vs. the minimum model: 321.3004</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(splines)</span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a>specs_lag_tr_out <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"lag_tr_outcome *"</span>, <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log(time+0.001)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 3)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 4)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 5)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 6)"</span>, <span class="st">"pspline(log(time+0.001), df=3)"</span>, <span class="st">"pspline(log(time+0.001), df=4)"</span>, <span class="st">"pspline(log(time+0.001), df=5)"</span>, <span class="st">"pspline(log(time+0.001), df=6)"</span>, <span class="st">"bs(time, 3)"</span>, <span class="st">"bs(time, 4)"</span>, <span class="st">"bs(time, 5)"</span>, <span class="st">"bs(time, 6)"</span>, <span class="st">"ns(time, 3)"</span>, <span class="st">"ns(time, 4)"</span>, <span class="st">"ns(time, 5)"</span>, <span class="st">"ns(time, 6)"</span>, <span class="st">"rcs(time, 3)"</span>, <span class="st">"rcs(time, 4)"</span>, <span class="st">"rcs(time, 5)"</span>, <span class="st">"rcs(time, 6)"</span>))</span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>results_lag_tr_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(specs_lag_tr_out)) {</span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> specs_lag_tr_out[i]</span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb324-16"><a href="#cb324-16" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb324-17"><a href="#cb324-17" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb324-18"><a href="#cb324-18" aria-hidden="true" tabindex="-1"></a><span class="st">              I(round("</span>,l,<span class="st">",2)) +</span></span>
<span id="cb324-19"><a href="#cb324-19" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb324-20"><a href="#cb324-20" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec+</span></span>
<span id="cb324-21"><a href="#cb324-21" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb324-22"><a href="#cb324-22" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb324-23"><a href="#cb324-23" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb324-24"><a href="#cb324-24" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb324-25"><a href="#cb324-25" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb324-26"><a href="#cb324-26" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb324-27"><a href="#cb324-27" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb324-28"><a href="#cb324-28" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb324-29"><a href="#cb324-29" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb324-30"><a href="#cb324-30" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb324-31"><a href="#cb324-31" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb324-32"><a href="#cb324-32" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb324-33"><a href="#cb324-33" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb324-34"><a href="#cb324-34" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb324-35"><a href="#cb324-35" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb324-36"><a href="#cb324-36" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb324-37"><a href="#cb324-37" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb324-38"><a href="#cb324-38" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb324-39"><a href="#cb324-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb324-40"><a href="#cb324-40" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec =</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb324-41"><a href="#cb324-41" aria-hidden="true" tabindex="-1"></a>            data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb324-42"><a href="#cb324-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb324-43"><a href="#cb324-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-44"><a href="#cb324-44" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="fu">extractAIC</span>(model)[[<span class="dv">2</span>]]</span>
<span id="cb324-45"><a href="#cb324-45" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>]</span>
<span id="cb324-46"><a href="#cb324-46" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">TRUE</span> </span>
<span id="cb324-47"><a href="#cb324-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-48"><a href="#cb324-48" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb324-49"><a href="#cb324-49" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb324-50"><a href="#cb324-50" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb324-51"><a href="#cb324-51" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb324-52"><a href="#cb324-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Error fitting specification "</span>, i, <span class="st">" ("</span>, l, <span class="st">"): "</span>, e))</span>
<span id="cb324-53"><a href="#cb324-53" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb324-54"><a href="#cb324-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-55"><a href="#cb324-55" aria-hidden="true" tabindex="-1"></a>  results_lag_tr_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_lag_tr_out, <span class="fu">data.frame</span>(<span class="at">spec =</span> l, <span class="at">aic =</span> aic_val, <span class="at">cox_zph =</span> cox_zph_val, <span class="at">success =</span> success))</span>
<span id="cb324-56"><a href="#cb324-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-57"><a href="#cb324-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Iteration:"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) <span class="co"># Add iteration number</span></span>
<span id="cb324-58"><a href="#cb324-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Spec: "</span>, l, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb324-59"><a href="#cb324-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"AIC: "</span>, results_lag_tr_out<span class="sc">$</span>aic[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) </span>
<span id="cb324-60"><a href="#cb324-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Cox zph test statistic: "</span>, results_lag_tr_out<span class="sc">$</span>cox_zph[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb324-61"><a href="#cb324-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 1 
NULL
Spec:  lag_tr_outcome *time 
NULL
AIC:  242375.661429718 
NULL
Cox zph test statistic:  4294.36756065618 
NULL
Iteration: 2 
NULL
Spec:  lag_tr_outcome *log(time+0.001) 
NULL
AIC:  244573.478733201 
NULL
Cox zph test statistic:  1250.69604172358 
NULL
Iteration: 3 
NULL
Spec:  lag_tr_outcome *poly(ifelse(is.na(time), .001,time), 3) 
NULL
AIC:  241209.963903167 
NULL
Cox zph test statistic:  12162.2885407214 
NULL
Iteration: 4 
NULL
Spec:  lag_tr_outcome *poly(ifelse(is.na(time), .001,time), 4) 
NULL
AIC:  240784.062529073 
NULL
Cox zph test statistic:  12595.5788006453 
NULL
Iteration: 5 
NULL
Spec:  lag_tr_outcome *poly(ifelse(is.na(time), .001,time), 5) 
NULL
AIC:  240655.695209592 
NULL
Cox zph test statistic:  12721.8186063262 
NULL
Iteration: 6 
NULL
Spec:  lag_tr_outcome *poly(ifelse(is.na(time), .001,time), 6) 
NULL
AIC:  240210.222768023 
NULL
Cox zph test statistic:  12447.9992558718 
NULL
Iteration: 7 
NULL
Spec:  lag_tr_outcome *pspline(log(time+0.001), df=3) 
NULL
AIC:  240210.222768023 
NULL
Cox zph test statistic:  12447.9992558718 
NULL
Iteration: 8 
NULL
Spec:  lag_tr_outcome *pspline(log(time+0.001), df=4) 
NULL
AIC:  240210.222768023 
NULL
Cox zph test statistic:  12447.9992558718 
NULL
Iteration: 9 
NULL
Spec:  lag_tr_outcome *pspline(log(time+0.001), df=5) 
NULL
AIC:  240210.222768023 
NULL
Cox zph test statistic:  12447.9992558718 
NULL
Iteration: 10 
NULL
Spec:  lag_tr_outcome *pspline(log(time+0.001), df=6) 
NULL
AIC:  240210.222768023 
NULL
Cox zph test statistic:  12447.9992558718 
NULL
Iteration: 11 
NULL
Spec:  lag_tr_outcome *bs(time, 3) 
NULL
AIC:  238139.168565678 
NULL
Cox zph test statistic:  20194.0931692 
NULL
Iteration: 12 
NULL
Spec:  lag_tr_outcome *bs(time, 4) 
NULL
AIC:  221388.904711619 
NULL
Cox zph test statistic:  92983.6270487867 
NULL
Iteration: 13 
NULL
Spec:  lag_tr_outcome *bs(time, 5) 
NULL
AIC:  213169.70279823 
NULL
Cox zph test statistic:  77263.2011050867 
NULL
Iteration: 14 
NULL
Spec:  lag_tr_outcome *bs(time, 6) 
NULL
AIC:  211342.28883079 
NULL
Cox zph test statistic:  103010.888687678 
NULL
Iteration: 15 
NULL
Spec:  lag_tr_outcome *ns(time, 3) 
NULL
AIC:  230455.219132658 
NULL
Cox zph test statistic:  50605.4601854322 
NULL
Iteration: 16 
NULL
Spec:  lag_tr_outcome *ns(time, 4) 
NULL
AIC:  219389.439286971 
NULL
Cox zph test statistic:  78509.834057776 
NULL
Iteration: 17 
NULL
Spec:  lag_tr_outcome *ns(time, 5) 
NULL
AIC:  215468.139506862 
NULL
Cox zph test statistic:  83287.572463163 
NULL
Iteration: 18 
NULL
Spec:  lag_tr_outcome *ns(time, 6) 
NULL
AIC:  213583.907149193 
NULL
Cox zph test statistic:  101262.397922225 
NULL
Iteration: 19 
NULL
Spec:  lag_tr_outcome *rcs(time, 3) 
NULL
AIC:  239536.406693165 
NULL
Cox zph test statistic:  17245.5074031239 
NULL
Iteration: 20 
NULL
Spec:  lag_tr_outcome *rcs(time, 4) 
NULL
AIC:  228684.622158062 
NULL
Cox zph test statistic:  65410.1688298938 
NULL
Iteration: 21 
NULL
Spec:  lag_tr_outcome *rcs(time, 5) 
NULL
AIC:  226434.369582259 
NULL
Cox zph test statistic:  23238.4847315333 
NULL
X matrix deemed to be singular; variable time''' 
Iteration: 22 
NULL
Spec:  lag_tr_outcome *rcs(time, 6) 
NULL
AIC:  226434.369582259 
NULL
Cox zph test statistic:  23238.4847315333 
NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>results_lag_tr_out[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_lag_tr_out<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_lag_tr_out<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             spec      aic  cox_zph success
2 lag_tr_outcome *log(time+0.001) 244573.5 1250.696    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                              spec      aic  cox_zph success</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 lag_tr_outcome *log(time+0.001) 244561.9 1248.051    TRUE</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen. We do nothing"</span>)</span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>results_lag_tr_outcome_alt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,.<span class="dv">1</span>)) {</span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span>i, <span class="dv">10</span><span class="sc">*</span>i, <span class="dv">15</span><span class="sc">*</span>i)  <span class="co"># Example change points (months)</span></span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_tr_outcome_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb328-15"><a href="#cb328-15" aria-hidden="true" tabindex="-1"></a>                                                 lag_tr_outcome<span class="sc">*</span><span class="fu">time_varying_coeff</span>(lag_time, change_points, coefficients))</span>
<span id="cb328-16"><a href="#cb328-16" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>tr_outcome_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb328-17"><a href="#cb328-17" aria-hidden="true" tabindex="-1"></a>                                                 tr_outcome<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb328-18"><a href="#cb328-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb328-19"><a href="#cb328-19" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_alt<span class="ot">&lt;-</span></span>
<span id="cb328-20"><a href="#cb328-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb328-21"><a href="#cb328-21" aria-hidden="true" tabindex="-1"></a><span class="st">              cluster(id)+ </span></span>
<span id="cb328-22"><a href="#cb328-22" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_tr_outcome_rec2 +</span></span>
<span id="cb328-23"><a href="#cb328-23" aria-hidden="true" tabindex="-1"></a><span class="st">              log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb328-24"><a href="#cb328-24" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_less_90d_tr1_rec+</span></span>
<span id="cb328-25"><a href="#cb328-25" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb328-26"><a href="#cb328-26" aria-hidden="true" tabindex="-1"></a><span class="st">              lag_policonsumo2 + </span></span>
<span id="cb328-27"><a href="#cb328-27" aria-hidden="true" tabindex="-1"></a><span class="st">              edad_al_ing_1 + </span></span>
<span id="cb328-28"><a href="#cb328-28" aria-hidden="true" tabindex="-1"></a><span class="st">              ano_nac_corr + </span></span>
<span id="cb328-29"><a href="#cb328-29" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_oh +</span></span>
<span id="cb328-30"><a href="#cb328-30" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_coc +</span></span>
<span id="cb328-31"><a href="#cb328-31" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_pbc +</span></span>
<span id="cb328-32"><a href="#cb328-32" aria-hidden="true" tabindex="-1"></a><span class="st">              susinidum_mar +</span></span>
<span id="cb328-33"><a href="#cb328-33" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_with +</span></span>
<span id="cb328-34"><a href="#cb328-34" aria-hidden="true" tabindex="-1"></a><span class="st">              psycom_dum_study + </span></span>
<span id="cb328-35"><a href="#cb328-35" aria-hidden="true" tabindex="-1"></a><span class="st">              freq_cons_dum_5day +</span></span>
<span id="cb328-36"><a href="#cb328-36" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_2inact +</span></span>
<span id="cb328-37"><a href="#cb328-37" aria-hidden="true" tabindex="-1"></a><span class="st">              cond_oc_dum_3unemp +</span></span>
<span id="cb328-38"><a href="#cb328-38" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_oh +</span></span>
<span id="cb328-39"><a href="#cb328-39" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_coc +</span></span>
<span id="cb328-40"><a href="#cb328-40" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_pbc +</span></span>
<span id="cb328-41"><a href="#cb328-41" aria-hidden="true" tabindex="-1"></a><span class="st">              susprindum_mar+</span></span>
<span id="cb328-42"><a href="#cb328-42" aria-hidden="true" tabindex="-1"></a><span class="st">              strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb328-43"><a href="#cb328-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb328-44"><a href="#cb328-44" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb328-45"><a href="#cb328-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb328-46"><a href="#cb328-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb328-47"><a href="#cb328-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_alt)</span>
<span id="cb328-48"><a href="#cb328-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb328-49"><a href="#cb328-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb328-50"><a href="#cb328-50" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_alt)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb328-51"><a href="#cb328-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-52"><a href="#cb328-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]))</span>
<span id="cb328-53"><a href="#cb328-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb328-54"><a href="#cb328-54" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_alt)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb328-55"><a href="#cb328-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb328-56"><a href="#cb328-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb328-57"><a href="#cb328-57" aria-hidden="true" tabindex="-1"></a>  results_lag_tr_outcome_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_lag_tr_outcome_alt, </span>
<span id="cb328-58"><a href="#cb328-58" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cbind.data.frame</span>(</span>
<span id="cb328-59"><a href="#cb328-59" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; change points: "</span>, change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]), </span>
<span id="cb328-60"><a href="#cb328-60" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">aic =</span> aic_iter,</span>
<span id="cb328-61"><a href="#cb328-61" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb328-62"><a href="#cb328-62" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">success =</span> T</span>
<span id="cb328-63"><a href="#cb328-63" aria-hidden="true" tabindex="-1"></a>                                          ))</span>
<span id="cb328-64"><a href="#cb328-64" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 1"
[1] "Time points: 5, 10, 15"
[1] "AIC: 244899.5"
[1] "Cox ZPH: 359.0971"
[1] "iteration: 1.1"
[1] "Time points: 5.5, 11, 16.5"
[1] "AIC: 244900.4"
[1] "Cox ZPH: 361.2743"
[1] "iteration: 1.2"
[1] "Time points: 6, 12, 18"
[1] "AIC: 244903.3"
[1] "Cox ZPH: 358.6406"
[1] "iteration: 1.3"
[1] "Time points: 6.5, 13, 19.5"
[1] "AIC: 244906.3"
[1] "Cox ZPH: 359.1773"
[1] "iteration: 1.4"
[1] "Time points: 7, 14, 21"
[1] "AIC: 244906.5"
[1] "Cox ZPH: 360.6033"
[1] "iteration: 1.5"
[1] "Time points: 7.5, 15, 22.5"
[1] "AIC: 244906.8"
[1] "Cox ZPH: 362.1983"
[1] "iteration: 1.6"
[1] "Time points: 8, 16, 24"
[1] "AIC: 244902.5"
[1] "Cox ZPH: 361.868"
[1] "iteration: 1.7"
[1] "Time points: 8.5, 17, 25.5"
[1] "AIC: 244901.8"
[1] "Cox ZPH: 364.0377"
[1] "iteration: 1.8"
[1] "Time points: 9, 18, 27"
[1] "AIC: 244905.9"
[1] "Cox ZPH: 364.3575"
[1] "iteration: 1.9"
[1] "Time points: 9.5, 19, 28.5"
[1] "AIC: 244905.3"
[1] "Cox ZPH: 365.32"
[1] "iteration: 2"
[1] "Time points: 10, 20, 30"
[1] "AIC: 244901.4"
[1] "Cox ZPH: 368.9659"
[1] "iteration: 2.1"
[1] "Time points: 10.5, 21, 31.5"
[1] "AIC: 244901.9"
[1] "Cox ZPH: 369.6159"
[1] "iteration: 2.2"
[1] "Time points: 11, 22, 33"
[1] "AIC: 244903"
[1] "Cox ZPH: 365.9987"
[1] "iteration: 2.3"
[1] "Time points: 11.5, 23, 34.5"
[1] "AIC: 244895.1"
[1] "Cox ZPH: 361.7019"
[1] "iteration: 2.4"
[1] "Time points: 12, 24, 36"
[1] "AIC: 244896.9"
[1] "Cox ZPH: 356.4047"
[1] "iteration: 2.5"
[1] "Time points: 12.5, 25, 37.5"
[1] "AIC: 244893.9"
[1] "Cox ZPH: 357.1797"
[1] "iteration: 2.6"
[1] "Time points: 13, 26, 39"
[1] "AIC: 244891.6"
[1] "Cox ZPH: 356.8042"
[1] "iteration: 2.7"
[1] "Time points: 13.5, 27, 40.5"
[1] "AIC: 244885.7"
[1] "Cox ZPH: 354.4202"
[1] "iteration: 2.8"
[1] "Time points: 14, 28, 42"
[1] "AIC: 244880.4"
[1] "Cox ZPH: 354.3132"
[1] "iteration: 2.9"
[1] "Time points: 14.5, 29, 43.5"
[1] "AIC: 244879.2"
[1] "Cox ZPH: 352.0868"
[1] "iteration: 3"
[1] "Time points: 15, 30, 45"
[1] "AIC: 244879.9"
[1] "Cox ZPH: 349.6504"
[1] "iteration: 3.1"
[1] "Time points: 15.5, 31, 46.5"
[1] "AIC: 244883.7"
[1] "Cox ZPH: 349.1183"
[1] "iteration: 3.2"
[1] "Time points: 16, 32, 48"
[1] "AIC: 244880.6"
[1] "Cox ZPH: 348.1966"
[1] "iteration: 3.3"
[1] "Time points: 16.5, 33, 49.5"
[1] "AIC: 244877.7"
[1] "Cox ZPH: 348.1207"
[1] "iteration: 3.4"
[1] "Time points: 17, 34, 51"
[1] "AIC: 244881.7"
[1] "Cox ZPH: 348.0226"
[1] "iteration: 3.5"
[1] "Time points: 17.5, 35, 52.5"
[1] "AIC: 244881.8"
[1] "Cox ZPH: 348.0872"
[1] "iteration: 3.6"
[1] "Time points: 18, 36, 54"
[1] "AIC: 244883"
[1] "Cox ZPH: 349.6944"
[1] "iteration: 3.7"
[1] "Time points: 18.5, 37, 55.5"
[1] "AIC: 244883.3"
[1] "Cox ZPH: 350.0009"
[1] "iteration: 3.8"
[1] "Time points: 19, 38, 57"
[1] "AIC: 244880.6"
[1] "Cox ZPH: 350.4467"
[1] "iteration: 3.9"
[1] "Time points: 19.5, 39, 58.5"
[1] "AIC: 244877.4"
[1] "Cox ZPH: 350.8478"
[1] "iteration: 4"
[1] "Time points: 20, 40, 60"
[1] "AIC: 244878.7"
[1] "Cox ZPH: 351.8303"
[1] "iteration: 4.1"
[1] "Time points: 20.5, 41, 61.5"
[1] "AIC: 244880"
[1] "Cox ZPH: 354.9833"
[1] "iteration: 4.2"
[1] "Time points: 21, 42, 63"
[1] "AIC: 244877"
[1] "Cox ZPH: 354.6689"
[1] "iteration: 4.3"
[1] "Time points: 21.5, 43, 64.5"
[1] "AIC: 244873.9"
[1] "Cox ZPH: 355.1347"
[1] "iteration: 4.4"
[1] "Time points: 22, 44, 66"
[1] "AIC: 244871.1"
[1] "Cox ZPH: 356.1269"
[1] "iteration: 4.5"
[1] "Time points: 22.5, 45, 67.5"
[1] "AIC: 244874.5"
[1] "Cox ZPH: 357.1391"
[1] "iteration: 4.6"
[1] "Time points: 23, 46, 69"
[1] "AIC: 244875.8"
[1] "Cox ZPH: 358.4438"
[1] "iteration: 4.7"
[1] "Time points: 23.5, 47, 70.5"
[1] "AIC: 244874.8"
[1] "Cox ZPH: 359.9124"
[1] "iteration: 4.8"
[1] "Time points: 24, 48, 72"
[1] "AIC: 244865.4"
[1] "Cox ZPH: 358.8837"
[1] "iteration: 4.9"
[1] "Time points: 24.5, 49, 73.5"
[1] "AIC: 244868.3"
[1] "Cox ZPH: 360.8408"
[1] "iteration: 5"
[1] "Time points: 25, 50, 75"
[1] "AIC: 244868.9"
[1] "Cox ZPH: 361.8831"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>results_lag_tr_outcome_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome_alt<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                        spec      aic  cox_zph success
25 iteration: 3.4; change points: 17, 34, 51 244881.7 348.0226    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                         spec      aic  cox_zph success</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 25 iteration: 3.4; change points: 17, 34, 51 244869.2 347.3415    TRUE</span></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The minimum of the first modified model: "</span>,</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>                results_lag_tr_outcome[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>],</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_lag_tr_outcome_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome_alt<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>               ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The minimum of the first modified model: 321.6527 vs.&nbsp;the minimum model: 348.0226</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The minimum of the first modified model: 321.3004 vs. the minimum model: 347.3415</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>results_lag_tr_outcome_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_lag_tr_outcome<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                        spec      aic  cox_zph success
15 iteration: 2.4; change points: 12, 24, 36 244896.9 356.4047    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                            spec      aic  cox_zph success</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 15 iteration: 0.45; tvcs: 9, 36 242729.5 321.3004    TRUE</span></span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>tvcs<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">36</span>)</span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>lag_tr_outcome_rec<span class="ot">&lt;-</span></span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>lag_tr_outcome, </span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>tr_outcome_rec<span class="ot">&lt;-</span></span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a><span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tr_outcome, </span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a>                   data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">1</span>],</span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a>                   tvcs[<span class="dv">2</span>],</span>
<span id="cb335-17"><a href="#cb335-17" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb335-18"><a href="#cb335-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-19"><a href="#cb335-19" aria-hidden="true" tabindex="-1"></a>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out<span class="ot">&lt;-</span></span>
<span id="cb335-20"><a href="#cb335-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span> </span>
<span id="cb335-21"><a href="#cb335-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb335-22"><a href="#cb335-22" aria-hidden="true" tabindex="-1"></a>            lag_tr_outcome_rec <span class="sc">+</span></span>
<span id="cb335-23"><a href="#cb335-23" aria-hidden="true" tabindex="-1"></a>            log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb335-24"><a href="#cb335-24" aria-hidden="true" tabindex="-1"></a>            lag_less_90d_tr1_rec<span class="sc">+</span></span>
<span id="cb335-25"><a href="#cb335-25" aria-hidden="true" tabindex="-1"></a>            lag_comp_bpsc_y3_severe_rec <span class="sc">+</span> </span>
<span id="cb335-26"><a href="#cb335-26" aria-hidden="true" tabindex="-1"></a>            lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb335-27"><a href="#cb335-27" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb335-28"><a href="#cb335-28" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb335-29"><a href="#cb335-29" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb335-30"><a href="#cb335-30" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb335-31"><a href="#cb335-31" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb335-32"><a href="#cb335-32" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb335-33"><a href="#cb335-33" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb335-34"><a href="#cb335-34" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb335-35"><a href="#cb335-35" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb335-36"><a href="#cb335-36" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb335-37"><a href="#cb335-37" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb335-38"><a href="#cb335-38" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb335-39"><a href="#cb335-39" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb335-40"><a href="#cb335-40" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb335-41"><a href="#cb335-41" aria-hidden="true" tabindex="-1"></a>            susprindum_mar<span class="sc">+</span></span>
<span id="cb335-42"><a href="#cb335-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb335-43"><a href="#cb335-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb335-44"><a href="#cb335-44" aria-hidden="true" tabindex="-1"></a>        data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb335-45"><a href="#cb335-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb335-46"><a href="#cb335-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-47"><a href="#cb335-47" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 chisq df      p
lag_tr_outcome_rec             66.5194  1 0.0000
log_lag_dias_treat_imp_sin_na  10.3514  1 0.0013
lag_less_90d_tr1_rec           84.0336  1 0.0000
lag_comp_bpsc_y3_severe_rec    17.2563  1 0.0000
lag_policonsumo2                3.2167  1 0.0729
edad_al_ing_1                   0.1446  1 0.7038
ano_nac_corr                    5.1810  1 0.0228
susinidum_oh                   20.1319  1 0.0000
susinidum_coc                   9.7922  1 0.0018
susinidum_pbc                   2.0721  1 0.1500
susinidum_mar                   6.7050  1 0.0096
psycom_dum_with                11.7329  1 0.0006
psycom_dum_study                1.6100  1 0.2045
freq_cons_dum_5day              0.0801  1 0.7772
cond_oc_dum_2inact              4.4364  1 0.0352
cond_oc_dum_3unemp              1.7433  1 0.1867
susprindum_oh                   4.4295  1 0.0353
susprindum_coc                  1.6332  1 0.2013
susprindum_pbc                  0.0553  1 0.8141
susprindum_mar                  5.2895  1 0.0215
GLOBAL                        321.6527 20 0.0000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  chisq df      p</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome_rec             66.6269  1 0.0000 ####</span></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na  10.1949  1 0.0014 #</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1_rec           84.0361  1 0.0000 ####</span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe_rec    17.2093  1 0.0000 ####</span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                3.1849  1 0.0743</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                   0.1368  1 0.7115</span></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    5.2180  1 0.0224 #</span></span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   19.9277  1 0.0000 ####</span></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                   9.7729  1 0.0018 ##</span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   1.9935  1 0.1580</span></span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                   6.6712  1 0.0098 #</span></span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                11.7874  1 0.0006 ##</span></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                1.6215  1 0.2029</span></span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              0.0521  1 0.8194</span></span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              4.4607  1 0.0347</span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp              1.6238  1 0.2026</span></span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                   4.3416  1 0.0372</span></span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  1.6713  1 0.1961</span></span>
<span id="cb337-20"><a href="#cb337-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                  0.0723  1 0.7879</span></span>
<span id="cb337-21"><a href="#cb337-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  5.3392  1 0.0209</span></span>
<span id="cb337-22"><a href="#cb337-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        321.3004 20 0.0000</span></span>
<span id="cb337-23"><a href="#cb337-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-24"><a href="#cb337-24" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb337-25"><a href="#cb337-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb337-26"><a href="#cb337-26" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Analyse the violation of proportional hazards"</span>)</span>
<span id="cb337-27"><a href="#cb337-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb337-28"><a href="#cb337-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb337-29"><a href="#cb337-29" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">dev.off</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>res240422_5_restr <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out, <span class="st">"scaledsch"</span>)</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>time240422_5_restr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res240422_5_restr)[[<span class="dv">1</span>]])</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>z_240422_5_1_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_5_restr[,<span class="st">"susinidum_oh"</span>] <span class="sc">~</span> time240422_5_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_5_restr, <span class="fu">fitted</span>(z_240422_5_1_restr))</span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_5_restr, res240422_5_restr[,<span class="st">"susinidum_oh"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., susinidum_oh"</span>)</span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)[<span class="fu">which</span>(<span class="fu">attr</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"susinidum_oh"</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span> <span class="st">"Residuals of susinidum_oh"</span>)</span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out<span class="sc">$</span>coefficients[<span class="st">"susinidum_oh"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb339-15"><a href="#cb339-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-16"><a href="#cb339-16" aria-hidden="true" tabindex="-1"></a>km_susinidum_oh <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> susinidum_oh<span class="sc">+</span> </span>
<span id="cb339-17"><a href="#cb339-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb339-18"><a href="#cb339-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_susinidum_oh, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by susinidum_oh"</span>)</span>
<span id="cb339-19"><a href="#cb339-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb339-20"><a href="#cb339-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-21"><a href="#cb339-21" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb339-22"><a href="#cb339-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-23"><a href="#cb339-23" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb339-24"><a href="#cb339-24" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb339-25"><a href="#cb339-25" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb339-26"><a href="#cb339-26" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_susinidum_oh_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb339-27"><a href="#cb339-27" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb339-28"><a href="#cb339-28" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>pdf 
  2 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now with Initial substance: Alcohol"</span>)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="fl">1.5</span>,.<span class="dv">025</span>)) {</span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>  tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span>i</span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_oh_rec<span class="ot">&lt;-</span></span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_oh, </span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a>                               data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">1</span>],</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">2</span>],</span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh<span class="ot">&lt;-</span></span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh_rec +</span></span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc +</span></span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb341-31"><a href="#cb341-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb341-32"><a href="#cb341-32" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb341-33"><a href="#cb341-33" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb341-34"><a href="#cb341-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb341-35"><a href="#cb341-35" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb341-36"><a href="#cb341-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb341-37"><a href="#cb341-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb341-38"><a href="#cb341-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb341-39"><a href="#cb341-39" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb341-40"><a href="#cb341-40" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb341-41"><a href="#cb341-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb341-42"><a href="#cb341-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb341-43"><a href="#cb341-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb341-44"><a href="#cb341-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-45"><a href="#cb341-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh)</span>
<span id="cb341-46"><a href="#cb341-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb341-47"><a href="#cb341-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb341-48"><a href="#cb341-48" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb341-49"><a href="#cb341-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]))</span>
<span id="cb341-50"><a href="#cb341-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb341-51"><a href="#cb341-51" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb341-52"><a href="#cb341-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb341-53"><a href="#cb341-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb341-54"><a href="#cb341-54" aria-hidden="true" tabindex="-1"></a>  results_susinidum_oh <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_susinidum_oh, </span>
<span id="cb341-55"><a href="#cb341-55" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">cbind.data.frame</span>(</span>
<span id="cb341-56"><a href="#cb341-56" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; tvcs: "</span>, tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]), </span>
<span id="cb341-57"><a href="#cb341-57" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">aic =</span> aic_iter,</span>
<span id="cb341-58"><a href="#cb341-58" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb341-59"><a href="#cb341-59" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">success =</span> T</span>
<span id="cb341-60"><a href="#cb341-60" aria-hidden="true" tabindex="-1"></a>                                             ))</span>
<span id="cb341-61"><a href="#cb341-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] "Time points: 2, 8"
[1] "AIC: 239429.8"
[1] "Cox ZPH: 5741.105"
[1] "iteration: 0.125"
[1] "Time points: 2.5, 10"
[1] "AIC: 239392.7"
[1] "Cox ZPH: 5911.203"
[1] "iteration: 0.15"
[1] "Time points: 3, 12"
[1] "AIC: 239385.1"
[1] "Cox ZPH: 5995.153"
[1] "iteration: 0.175"
[1] "Time points: 3.5, 14"
[1] "AIC: 239405.8"
[1] "Cox ZPH: 6004.474"
[1] "iteration: 0.2"
[1] "Time points: 4, 16"
[1] "AIC: 239458"
[1] "Cox ZPH: 5931.333"
[1] "iteration: 0.225"
[1] "Time points: 4.5, 18"
[1] "AIC: 239533.6"
[1] "Cox ZPH: 5798.068"
[1] "iteration: 0.25"
[1] "Time points: 5, 20"
[1] "AIC: 239629.6"
[1] "Cox ZPH: 5605.943"
[1] "iteration: 0.275"
[1] "Time points: 5.5, 22"
[1] "AIC: 239746.7"
[1] "Cox ZPH: 5345.649"
[1] "iteration: 0.3"
[1] "Time points: 6, 24"
[1] "AIC: 239888"
[1] "Cox ZPH: 4997.661"
[1] "iteration: 0.325"
[1] "Time points: 6.5, 26"
[1] "AIC: 240042.6"
[1] "Cox ZPH: 4586.522"
[1] "iteration: 0.35"
[1] "Time points: 7, 28"
[1] "AIC: 240211.5"
[1] "Cox ZPH: 4104.321"
[1] "iteration: 0.375"
[1] "Time points: 7.5, 30"
[1] "AIC: 240387.4"
[1] "Cox ZPH: 3584.708"
[1] "iteration: 0.4"
[1] "Time points: 8, 32"
[1] "AIC: 240565.7"
[1] "Cox ZPH: 3057.196"
[1] "iteration: 0.425"
[1] "Time points: 8.5, 34"
[1] "AIC: 240747.1"
[1] "Cox ZPH: 2541.069"
[1] "iteration: 0.45"
[1] "Time points: 9, 36"
[1] "AIC: 240930.5"
[1] "Cox ZPH: 2078.364"
[1] "iteration: 0.475"
[1] "Time points: 9.5, 38"
[1] "AIC: 241113.3"
[1] "Cox ZPH: 1728.213"
[1] "iteration: 0.5"
[1] "Time points: 10, 40"
[1] "AIC: 241288.4"
[1] "Cox ZPH: 1549.536"
[1] "iteration: 0.525"
[1] "Time points: 10.5, 42"
[1] "AIC: 241459.6"
[1] "Cox ZPH: 1566.979"
[1] "iteration: 0.55"
[1] "Time points: 11, 44"
[1] "AIC: 241626.8"
[1] "Cox ZPH: 1794.567"
[1] "iteration: 0.575"
[1] "Time points: 11.5, 46"
[1] "AIC: 241787.2"
[1] "Cox ZPH: 2219.701"
[1] "iteration: 0.6"
[1] "Time points: 12, 48"
[1] "AIC: 241939.2"
[1] "Cox ZPH: 2804.371"
[1] "iteration: 0.625"
[1] "Time points: 12.5, 50"
[1] "AIC: 242083.7"
[1] "Cox ZPH: 3505.791"
[1] "iteration: 0.65"
[1] "Time points: 13, 52"
[1] "AIC: 242219.9"
[1] "Cox ZPH: 4264.682"
[1] "iteration: 0.675"
[1] "Time points: 13.5, 54"
[1] "AIC: 242345.1"
[1] "Cox ZPH: 5015.719"
[1] "iteration: 0.7"
[1] "Time points: 14, 56"
[1] "AIC: 242456.5"
[1] "Cox ZPH: 5696.982"
[1] "iteration: 0.725"
[1] "Time points: 14.5, 58"
[1] "AIC: 242551.4"
[1] "Cox ZPH: 6259.37"
[1] "iteration: 0.75"
[1] "Time points: 15, 60"
[1] "AIC: 242628.8"
[1] "Cox ZPH: 6683.401"
[1] "iteration: 0.775"
[1] "Time points: 15.5, 62"
[1] "AIC: 242687.4"
[1] "Cox ZPH: 6956.512"
[1] "iteration: 0.8"
[1] "Time points: 16, 64"
[1] "AIC: 242725.2"
[1] "Cox ZPH: 7085.722"
[1] "iteration: 0.825"
[1] "Time points: 16.5, 66"
[1] "AIC: 242740.8"
[1] "Cox ZPH: 7091.269"
[1] "iteration: 0.85"
[1] "Time points: 17, 68"
[1] "AIC: 242733.4"
[1] "Cox ZPH: 6995.256"
[1] "iteration: 0.875"
[1] "Time points: 17.5, 70"
[1] "AIC: 242701.7"
[1] "Cox ZPH: 6819.604"
[1] "iteration: 0.9"
[1] "Time points: 18, 72"
[1] "AIC: 242645.4"
[1] "Cox ZPH: 6586.407"
[1] "iteration: 0.925"
[1] "Time points: 18.5, 74"
[1] "AIC: 242565.4"
[1] "Cox ZPH: 6318.07"
[1] "iteration: 0.95"
[1] "Time points: 19, 76"
[1] "AIC: 242461.6"
[1] "Cox ZPH: 6026.228"
[1] "iteration: 0.975"
[1] "Time points: 19.5, 78"
[1] "AIC: 242333.9"
[1] "Cox ZPH: 5721.657"
[1] "iteration: 1"
[1] "Time points: 20, 80"
[1] "AIC: 242181.2"
[1] "Cox ZPH: 5408.085"
[1] "iteration: 1.025"
[1] "Time points: 20.5, 82"
[1] "AIC: 242004.9"
[1] "Cox ZPH: 5098.267"
[1] "iteration: 1.05"
[1] "Time points: 21, 84"
[1] "AIC: 241807"
[1] "Cox ZPH: 4801.207"
[1] "iteration: 1.075"
[1] "Time points: 21.5, 86"
[1] "AIC: 241592"
[1] "Cox ZPH: 4522.922"
[1] "iteration: 1.1"
[1] "Time points: 22, 88"
[1] "AIC: 241359.7"
[1] "Cox ZPH: 4260.851"
[1] "iteration: 1.125"
[1] "Time points: 22.5, 90"
[1] "AIC: 241110.3"
[1] "Cox ZPH: 4013.58"
[1] "iteration: 1.15"
[1] "Time points: 23, 92"
[1] "AIC: 240849.8"
[1] "Cox ZPH: 3785.966"
[1] "iteration: 1.175"
[1] "Time points: 23.5, 94"
[1] "AIC: 240579.4"
[1] "Cox ZPH: 3575.447"
[1] "iteration: 1.2"
[1] "Time points: 24, 96"
[1] "AIC: 240299.9"
[1] "Cox ZPH: 3386.906"
[1] "iteration: 1.225"
[1] "Time points: 24.5, 98"
[1] "AIC: 240018.9"
[1] "Cox ZPH: 3223.323"
[1] "iteration: 1.25"
[1] "Time points: 25, 100"
[1] "AIC: 239740.7"
[1] "Cox ZPH: 3085.226"
[1] "iteration: 1.275"
[1] "Time points: 25.5, 102"
[1] "AIC: 239466.2"
[1] "Cox ZPH: 2973.787"
[1] "iteration: 1.3"
[1] "Time points: 26, 104"
[1] "AIC: 239195"
[1] "Cox ZPH: 2887.063"
[1] "iteration: 1.325"
[1] "Time points: 26.5, 106"
[1] "AIC: 238931.4"
[1] "Cox ZPH: 2829.198"
[1] "iteration: 1.35"
[1] "Time points: 27, 108"
[1] "AIC: 238672.7"
[1] "Cox ZPH: 2804.632"
[1] "iteration: 1.375"
[1] "Time points: 27.5, 110"
[1] "AIC: 238420.6"
[1] "Cox ZPH: 2817.714"
[1] "iteration: 1.4"
[1] "Time points: 28, 112"
[1] "AIC: 238188.2"
[1] "Cox ZPH: 2873.441"
[1] "iteration: 1.425"
[1] "Time points: 28.5, 114"
[1] "AIC: 237975.4"
[1] "Cox ZPH: 2981.972"
[1] "iteration: 1.45"
[1] "Time points: 29, 116"
[1] "AIC: 237779.2"
[1] "Cox ZPH: 3159.954"
[1] "iteration: 1.475"
[1] "Time points: 29.5, 118"
[1] "AIC: 237606.6"
[1] "Cox ZPH: 3430.731"
[1] "iteration: 1.5"
[1] "Time points: 30, 120"
[1] "AIC: 237464"
[1] "Cox ZPH: 3868.406"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           spec      aic  cox_zph success
17 iteration: 0.5; tvcs: 10, 40 241288.4 1549.536    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                            spec      aic  cox_zph success</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 15 iteration: 0.45; tvcs: 9, 36 242729.5 321.3004    TRUE</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The previously modified model: "</span>,</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_susinidum_oh[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The previously modified model: 321.7 vs.&nbsp;the minimum model: 1549.536</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The previously modified model: 321.3 vs. the minimum model: 1547.708</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen"</span>)</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(splines)</span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a>specs_susinidum_oh <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"susinidum_oh *"</span>, <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log(time+0.001)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 3)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 4)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 5)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 6)"</span>, <span class="st">"pspline(log(time+0.001), df=3)"</span>, <span class="st">"pspline(log(time+0.001), df=4)"</span>, <span class="st">"pspline(log(time+0.001), df=5)"</span>, <span class="st">"pspline(log(time+0.001), df=6)"</span>, <span class="st">"bs(time, 3)"</span>, <span class="st">"bs(time, 4)"</span>, <span class="st">"bs(time, 5)"</span>, <span class="st">"bs(time, 6)"</span>, <span class="st">"ns(time, 3)"</span>, <span class="st">"ns(time, 4)"</span>, <span class="st">"ns(time, 5)"</span>, <span class="st">"ns(time, 6)"</span>, <span class="st">"rcs(time, 3)"</span>, <span class="st">"rcs(time, 4)"</span>, <span class="st">"rcs(time, 5)"</span>, <span class="st">"rcs(time, 6)"</span>))</span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>results_susini_oh <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(specs_susinidum_oh)) {</span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> specs_susinidum_oh[i]</span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-15"><a href="#cb346-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb346-16"><a href="#cb346-16" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb346-17"><a href="#cb346-17" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb346-18"><a href="#cb346-18" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb346-19"><a href="#cb346-19" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb346-20"><a href="#cb346-20" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb346-21"><a href="#cb346-21" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb346-22"><a href="#cb346-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb346-23"><a href="#cb346-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb346-24"><a href="#cb346-24" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb346-25"><a href="#cb346-25" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb346-26"><a href="#cb346-26" aria-hidden="true" tabindex="-1"></a><span class="st">            I(round("</span>,l,<span class="st">",2)) +</span></span>
<span id="cb346-27"><a href="#cb346-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc +</span></span>
<span id="cb346-28"><a href="#cb346-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb346-29"><a href="#cb346-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb346-30"><a href="#cb346-30" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb346-31"><a href="#cb346-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb346-32"><a href="#cb346-32" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb346-33"><a href="#cb346-33" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb346-34"><a href="#cb346-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb346-35"><a href="#cb346-35" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb346-36"><a href="#cb346-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb346-37"><a href="#cb346-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb346-38"><a href="#cb346-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb346-39"><a href="#cb346-39" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb346-40"><a href="#cb346-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb346-41"><a href="#cb346-41" aria-hidden="true" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec =</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb346-42"><a href="#cb346-42" aria-hidden="true" tabindex="-1"></a>                   data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb346-43"><a href="#cb346-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb346-44"><a href="#cb346-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb346-45"><a href="#cb346-45" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="fu">extractAIC</span>(model)[[<span class="dv">2</span>]]</span>
<span id="cb346-46"><a href="#cb346-46" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>]</span>
<span id="cb346-47"><a href="#cb346-47" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">TRUE</span> </span>
<span id="cb346-48"><a href="#cb346-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb346-49"><a href="#cb346-49" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb346-50"><a href="#cb346-50" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb346-51"><a href="#cb346-51" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb346-52"><a href="#cb346-52" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb346-53"><a href="#cb346-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Error fitting specification "</span>, i, <span class="st">" ("</span>, l, <span class="st">"): "</span>, e))</span>
<span id="cb346-54"><a href="#cb346-54" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb346-55"><a href="#cb346-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-56"><a href="#cb346-56" aria-hidden="true" tabindex="-1"></a>  results_susini_oh <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_susini_oh, <span class="fu">data.frame</span>(<span class="at">spec =</span> l, <span class="at">aic =</span> aic_val, <span class="at">cox_zph =</span> cox_zph_val, <span class="at">success =</span> success))</span>
<span id="cb346-57"><a href="#cb346-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb346-58"><a href="#cb346-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Iteration:"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) <span class="co"># Add iteration number</span></span>
<span id="cb346-59"><a href="#cb346-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Spec: "</span>, l, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb346-60"><a href="#cb346-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"AIC: "</span>, results_susini_oh<span class="sc">$</span>aic[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) </span>
<span id="cb346-61"><a href="#cb346-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Cox zph test statistic: "</span>, results_susini_oh<span class="sc">$</span>cox_zph[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb346-62"><a href="#cb346-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 1 
NULL
Spec:  susinidum_oh *time 
NULL
AIC:  239724.019577566 
NULL
Cox zph test statistic:  4672.22758383257 
NULL
Iteration: 2 
NULL
Spec:  susinidum_oh *log(time+0.001) 
NULL
AIC:  241585.150871146 
NULL
Cox zph test statistic:  1204.10177494143 
NULL
Iteration: 3 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 3) 
NULL
AIC:  240219.630415016 
NULL
Cox zph test statistic:  7926.39955359493 
NULL
Iteration: 4 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 4) 
NULL
AIC:  240063.039259188 
NULL
Cox zph test statistic:  8212.21889149851 
NULL
Iteration: 5 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 5) 
NULL
AIC:  240016.095427946 
NULL
Cox zph test statistic:  8304.47329075385 
NULL
Iteration: 6 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 6) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 7 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=3) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 8 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=4) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 9 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=5) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 10 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=6) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 11 
NULL
Spec:  susinidum_oh *bs(time, 3) 
NULL
AIC:  239518.026724213 
NULL
Cox zph test statistic:  10331.3482921498 
NULL
Iteration: 12 
NULL
Spec:  susinidum_oh *bs(time, 4) 
NULL
AIC:  236772.640457164 
NULL
Cox zph test statistic:  18133.928243881 
NULL
Iteration: 13 
NULL
Spec:  susinidum_oh *bs(time, 5) 
NULL
AIC:  235970.965928735 
NULL
Cox zph test statistic:  20900.8309746657 
NULL
Iteration: 14 
NULL
Spec:  susinidum_oh *bs(time, 6) 
NULL
AIC:  235677.262806318 
NULL
Cox zph test statistic:  21727.8304904265 
NULL
Iteration: 15 
NULL
Spec:  susinidum_oh *ns(time, 3) 
NULL
AIC:  238253.396508616 
NULL
Cox zph test statistic:  14728.7767838593 
NULL
Iteration: 16 
NULL
Spec:  susinidum_oh *ns(time, 4) 
NULL
AIC:  236653.226858842 
NULL
Cox zph test statistic:  19308.1808541226 
NULL
Iteration: 17 
NULL
Spec:  susinidum_oh *ns(time, 5) 
NULL
AIC:  236251.069626771 
NULL
Cox zph test statistic:  20993.031671471 
NULL
Iteration: 18 
NULL
Spec:  susinidum_oh *ns(time, 6) 
NULL
AIC:  235896.939555169 
NULL
Cox zph test statistic:  21101.9090902985 
NULL
Iteration: 19 
NULL
Spec:  susinidum_oh *rcs(time, 3) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
X matrix deemed to be singular; variable time'' 
Iteration: 20 
NULL
Spec:  susinidum_oh *rcs(time, 4) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
X matrix deemed to be singular; variable time'' time''' 
Iteration: 21 
NULL
Spec:  susinidum_oh *rcs(time, 5) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
X matrix deemed to be singular; variable time'' time''' 
Iteration: 22 
NULL
Spec:  susinidum_oh *rcs(time, 6) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>results_susini_oh[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susini_oh<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susini_oh<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           spec      aic  cox_zph success
2 susinidum_oh *log(time+0.001) 241585.2 1204.102    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                            spec    aic cox_zph success</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 susinidum_oh *log(time+0.001) 241573 1203.69    TRUE</span></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen. We do nothing"</span>)</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh_alt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,.<span class="dv">1</span>)) {</span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>  change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span>i, <span class="dv">10</span><span class="sc">*</span>i, <span class="dv">15</span><span class="sc">*</span>i)  <span class="co"># Example change points (months)</span></span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_oh_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a>                                                       susinidum_oh<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh_alt<span class="ot">&lt;-</span></span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb350-19"><a href="#cb350-19" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb350-20"><a href="#cb350-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb350-21"><a href="#cb350-21" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb350-22"><a href="#cb350-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb350-23"><a href="#cb350-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb350-24"><a href="#cb350-24" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb350-25"><a href="#cb350-25" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb350-26"><a href="#cb350-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb350-27"><a href="#cb350-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh_rec2 +</span></span>
<span id="cb350-28"><a href="#cb350-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc +</span></span>
<span id="cb350-29"><a href="#cb350-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb350-30"><a href="#cb350-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb350-31"><a href="#cb350-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb350-32"><a href="#cb350-32" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb350-33"><a href="#cb350-33" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb350-34"><a href="#cb350-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb350-35"><a href="#cb350-35" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb350-36"><a href="#cb350-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb350-37"><a href="#cb350-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb350-38"><a href="#cb350-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb350-39"><a href="#cb350-39" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb350-40"><a href="#cb350-40" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb350-41"><a href="#cb350-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb350-42"><a href="#cb350-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb350-43"><a href="#cb350-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb350-44"><a href="#cb350-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb350-45"><a href="#cb350-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh_alt)</span>
<span id="cb350-46"><a href="#cb350-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb350-47"><a href="#cb350-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb350-48"><a href="#cb350-48" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh_alt)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb350-49"><a href="#cb350-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb350-50"><a href="#cb350-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]))</span>
<span id="cb350-51"><a href="#cb350-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb350-52"><a href="#cb350-52" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh_alt)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb350-53"><a href="#cb350-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb350-54"><a href="#cb350-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb350-55"><a href="#cb350-55" aria-hidden="true" tabindex="-1"></a>  results_susinidum_oh_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_susinidum_oh_alt, </span>
<span id="cb350-56"><a href="#cb350-56" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">cbind.data.frame</span>(</span>
<span id="cb350-57"><a href="#cb350-57" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; change points: "</span>, change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]), </span>
<span id="cb350-58"><a href="#cb350-58" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">aic =</span> aic_iter,</span>
<span id="cb350-59"><a href="#cb350-59" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb350-60"><a href="#cb350-60" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">success =</span> T</span>
<span id="cb350-61"><a href="#cb350-61" aria-hidden="true" tabindex="-1"></a>                                                 ))</span>
<span id="cb350-62"><a href="#cb350-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 1"
[1] "Time points: 5, 10, 15"
[1] "AIC: 242702.9"
[1] "Cox ZPH: 345.489"
[1] "iteration: 1.1"
[1] "Time points: 5.5, 11, 16.5"
[1] "AIC: 242711.2"
[1] "Cox ZPH: 329.665"
[1] "iteration: 1.2"
[1] "Time points: 6, 12, 18"
[1] "AIC: 242707.8"
[1] "Cox ZPH: 329.167"
[1] "iteration: 1.3"
[1] "Time points: 6.5, 13, 19.5"
[1] "AIC: 242722"
[1] "Cox ZPH: 337.8074"
[1] "iteration: 1.4"
[1] "Time points: 7, 14, 21"
[1] "AIC: 242730.6"
[1] "Cox ZPH: 360.014"
[1] "iteration: 1.5"
[1] "Time points: 7.5, 15, 22.5"
[1] "AIC: 242736.7"
[1] "Cox ZPH: 396.3886"
[1] "iteration: 1.6"
[1] "Time points: 8, 16, 24"
[1] "AIC: 242739.4"
[1] "Cox ZPH: 415.7995"
[1] "iteration: 1.7"
[1] "Time points: 8.5, 17, 25.5"
[1] "AIC: 242741.2"
[1] "Cox ZPH: 449.8164"
[1] "iteration: 1.8"
[1] "Time points: 9, 18, 27"
[1] "AIC: 242740.8"
[1] "Cox ZPH: 465.6994"
[1] "iteration: 1.9"
[1] "Time points: 9.5, 19, 28.5"
[1] "AIC: 242739"
[1] "Cox ZPH: 484.3736"
[1] "iteration: 2"
[1] "Time points: 10, 20, 30"
[1] "AIC: 242735.2"
[1] "Cox ZPH: 495.5218"
[1] "iteration: 2.1"
[1] "Time points: 10.5, 21, 31.5"
[1] "AIC: 242732.2"
[1] "Cox ZPH: 468.4899"
[1] "iteration: 2.2"
[1] "Time points: 11, 22, 33"
[1] "AIC: 242722.2"
[1] "Cox ZPH: 451.4285"
[1] "iteration: 2.3"
[1] "Time points: 11.5, 23, 34.5"
[1] "AIC: 242718.2"
[1] "Cox ZPH: 423.5481"
[1] "iteration: 2.4"
[1] "Time points: 12, 24, 36"
[1] "AIC: 242716.3"
[1] "Cox ZPH: 395.6226"
[1] "iteration: 2.5"
[1] "Time points: 12.5, 25, 37.5"
[1] "AIC: 242716.8"
[1] "Cox ZPH: 364.4011"
[1] "iteration: 2.6"
[1] "Time points: 13, 26, 39"
[1] "AIC: 242717.5"
[1] "Cox ZPH: 340.7294"
[1] "iteration: 2.7"
[1] "Time points: 13.5, 27, 40.5"
[1] "AIC: 242720.7"
[1] "Cox ZPH: 331.1452"
[1] "iteration: 2.8"
[1] "Time points: 14, 28, 42"
[1] "AIC: 242724.9"
[1] "Cox ZPH: 334.6488"
[1] "iteration: 2.9"
[1] "Time points: 14.5, 29, 43.5"
[1] "AIC: 242729.4"
[1] "Cox ZPH: 353.4168"
[1] "iteration: 3"
[1] "Time points: 15, 30, 45"
[1] "AIC: 242733.9"
[1] "Cox ZPH: 395.1191"
[1] "iteration: 3.1"
[1] "Time points: 15.5, 31, 46.5"
[1] "AIC: 242737"
[1] "Cox ZPH: 455.8316"
[1] "iteration: 3.2"
[1] "Time points: 16, 32, 48"
[1] "AIC: 242740.4"
[1] "Cox ZPH: 524.5127"
[1] "iteration: 3.3"
[1] "Time points: 16.5, 33, 49.5"
[1] "AIC: 242741.2"
[1] "Cox ZPH: 601.5584"
[1] "iteration: 3.4"
[1] "Time points: 17, 34, 51"
[1] "AIC: 242740.6"
[1] "Cox ZPH: 686.4199"
[1] "iteration: 3.5"
[1] "Time points: 17.5, 35, 52.5"
[1] "AIC: 242738.5"
[1] "Cox ZPH: 771.4445"
[1] "iteration: 3.6"
[1] "Time points: 18, 36, 54"
[1] "AIC: 242733.6"
[1] "Cox ZPH: 868.9633"
[1] "iteration: 3.7"
[1] "Time points: 18.5, 37, 55.5"
[1] "AIC: 242730.4"
[1] "Cox ZPH: 951.8658"
[1] "iteration: 3.8"
[1] "Time points: 19, 38, 57"
[1] "AIC: 242721.3"
[1] "Cox ZPH: 1085.059"
[1] "iteration: 3.9"
[1] "Time points: 19.5, 39, 58.5"
[1] "AIC: 242709.4"
[1] "Cox ZPH: 1204.189"
[1] "iteration: 4"
[1] "Time points: 20, 40, 60"
[1] "AIC: 242693.7"
[1] "Cox ZPH: 1337.112"
[1] "iteration: 4.1"
[1] "Time points: 20.5, 41, 61.5"
[1] "AIC: 242682"
[1] "Cox ZPH: 1438.932"
[1] "iteration: 4.2"
[1] "Time points: 21, 42, 63"
[1] "AIC: 242664.9"
[1] "Cox ZPH: 1562.72"
[1] "iteration: 4.3"
[1] "Time points: 21.5, 43, 64.5"
[1] "AIC: 242651.1"
[1] "Cox ZPH: 1674.387"
[1] "iteration: 4.4"
[1] "Time points: 22, 44, 66"
[1] "AIC: 242620.8"
[1] "Cox ZPH: 1769.552"
[1] "iteration: 4.5"
[1] "Time points: 22.5, 45, 67.5"
[1] "AIC: 242607.7"
[1] "Cox ZPH: 1846.276"
[1] "iteration: 4.6"
[1] "Time points: 23, 46, 69"
[1] "AIC: 242585.1"
[1] "Cox ZPH: 1908.988"
[1] "iteration: 4.7"
[1] "Time points: 23.5, 47, 70.5"
[1] "AIC: 242569.1"
[1] "Cox ZPH: 1995.936"
[1] "iteration: 4.8"
[1] "Time points: 24, 48, 72"
[1] "AIC: 242551.2"
[1] "Cox ZPH: 2104.284"
[1] "iteration: 4.9"
[1] "Time points: 24.5, 49, 73.5"
[1] "AIC: 242534.8"
[1] "Cox ZPH: 2177.389"
[1] "iteration: 5"
[1] "Time points: 25, 50, 75"
[1] "AIC: 242517.7"
[1] "Cox ZPH: 2242.511"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh_alt<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                      spec      aic cox_zph success
3 iteration: 1.2; change points: 6, 12, 18 242707.8 329.167    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       spec    aic  cox_zph success</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 iteration: 1.2; change points: 6, 12, 18 242696 328.8011    TRUE</span></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The minimum of the first modified model: "</span>,</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table), <span class="dv">1</span>]),</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_susinidum_oh_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh_alt<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The minimum of the first modified model: 321.6527 vs.&nbsp;the minimum model: 329.167</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The minimum of the first modified model: 321.3004 vs. the minimum model: 328.8011</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsens. We do not integrate this model"</span>)</span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Analyse the violation of proportional hazards"</span>)</span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb355-9"><a href="#cb355-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb355-10"><a href="#cb355-10" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">dev.off</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>z_240422_5_2_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_5_restr[,<span class="st">"susinidum_coc"</span>] <span class="sc">~</span> time240422_5_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_5_restr, <span class="fu">fitted</span>(z_240422_5_2_restr))</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_5_restr, res240422_5_restr[,<span class="st">"susinidum_coc"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., susinidum_coc"</span>)</span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)[<span class="fu">which</span>(<span class="fu">attr</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"susinidum_coc"</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span> <span class="st">"Residuals of susinidum_coc"</span>)</span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out<span class="sc">$</span>coefficients[<span class="st">"susinidum_coc"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-13"><a href="#cb357-13" aria-hidden="true" tabindex="-1"></a>km_susinidum_coc <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> susinidum_coc<span class="sc">+</span> </span>
<span id="cb357-14"><a href="#cb357-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb357-15"><a href="#cb357-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_susinidum_coc, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by susinidum_coc"</span>)</span>
<span id="cb357-16"><a href="#cb357-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb357-17"><a href="#cb357-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-18"><a href="#cb357-18" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb357-19"><a href="#cb357-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-20"><a href="#cb357-20" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb357-21"><a href="#cb357-21" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb357-22"><a href="#cb357-22" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb357-23"><a href="#cb357-23" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_susinidum_coc_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb357-24"><a href="#cb357-24" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb357-25"><a href="#cb357-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>pdf 
  2 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now with Initial substance: Cocaine"</span>)</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>results_susinidum_coc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="fl">1.5</span>,.<span class="dv">025</span>)) {</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>  tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span>i</span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_coc_rec<span class="ot">&lt;-</span></span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_coc, </span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a>                               data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">1</span>],</span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">2</span>],</span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc<span class="ot">&lt;-</span></span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh +</span></span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec +</span></span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc)</span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb359-47"><a href="#cb359-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb359-48"><a href="#cb359-48" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb359-49"><a href="#cb359-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]))</span>
<span id="cb359-50"><a href="#cb359-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb359-51"><a href="#cb359-51" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb359-52"><a href="#cb359-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb359-53"><a href="#cb359-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-54"><a href="#cb359-54" aria-hidden="true" tabindex="-1"></a>  results_susinidum_coc <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_susinidum_coc, </span>
<span id="cb359-55"><a href="#cb359-55" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">cbind.data.frame</span>(</span>
<span id="cb359-56"><a href="#cb359-56" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; tvcs: "</span>, tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]), </span>
<span id="cb359-57"><a href="#cb359-57" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">aic =</span> aic_iter,</span>
<span id="cb359-58"><a href="#cb359-58" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb359-59"><a href="#cb359-59" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">success =</span> T</span>
<span id="cb359-60"><a href="#cb359-60" aria-hidden="true" tabindex="-1"></a>                                             ))</span>
<span id="cb359-61"><a href="#cb359-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] "Time points: 2, 8"
[1] "AIC: 242541.3"
[1] "Cox ZPH: 475.1056"
[1] "iteration: 0.125"
[1] "Time points: 2.5, 10"
[1] "AIC: 242534.1"
[1] "Cox ZPH: 489.6475"
[1] "iteration: 0.15"
[1] "Time points: 3, 12"
[1] "AIC: 242528.2"
[1] "Cox ZPH: 500.2812"
[1] "iteration: 0.175"
[1] "Time points: 3.5, 14"
[1] "AIC: 242524.4"
[1] "Cox ZPH: 504.4021"
[1] "iteration: 0.2"
[1] "Time points: 4, 16"
[1] "AIC: 242522.7"
[1] "Cox ZPH: 501.8106"
[1] "iteration: 0.225"
[1] "Time points: 4.5, 18"
[1] "AIC: 242523.2"
[1] "Cox ZPH: 492.8092"
[1] "iteration: 0.25"
[1] "Time points: 5, 20"
[1] "AIC: 242525.5"
[1] "Cox ZPH: 479.0295"
[1] "iteration: 0.275"
[1] "Time points: 5.5, 22"
[1] "AIC: 242530.1"
[1] "Cox ZPH: 458.4139"
[1] "iteration: 0.3"
[1] "Time points: 6, 24"
[1] "AIC: 242536.2"
[1] "Cox ZPH: 435.6086"
[1] "iteration: 0.325"
[1] "Time points: 6.5, 26"
[1] "AIC: 242543.6"
[1] "Cox ZPH: 411.411"
[1] "iteration: 0.35"
[1] "Time points: 7, 28"
[1] "AIC: 242553.4"
[1] "Cox ZPH: 384.4102"
[1] "iteration: 0.375"
[1] "Time points: 7.5, 30"
[1] "AIC: 242564.6"
[1] "Cox ZPH: 359.8189"
[1] "iteration: 0.4"
[1] "Time points: 8, 32"
[1] "AIC: 242576.1"
[1] "Cox ZPH: 342.9774"
[1] "iteration: 0.425"
[1] "Time points: 8.5, 34"
[1] "AIC: 242587.3"
[1] "Cox ZPH: 337.1026"
[1] "iteration: 0.45"
[1] "Time points: 9, 36"
[1] "AIC: 242597.7"
[1] "Cox ZPH: 343.4623"
[1] "iteration: 0.475"
[1] "Time points: 9.5, 38"
[1] "AIC: 242607.8"
[1] "Cox ZPH: 362.4096"
[1] "iteration: 0.5"
[1] "Time points: 10, 40"
[1] "AIC: 242617.6"
[1] "Cox ZPH: 394.2462"
[1] "iteration: 0.525"
[1] "Time points: 10.5, 42"
[1] "AIC: 242627.6"
[1] "Cox ZPH: 440.5531"
[1] "iteration: 0.55"
[1] "Time points: 11, 44"
[1] "AIC: 242638.2"
[1] "Cox ZPH: 503.2296"
[1] "iteration: 0.575"
[1] "Time points: 11.5, 46"
[1] "AIC: 242648.6"
[1] "Cox ZPH: 577.8865"
[1] "iteration: 0.6"
[1] "Time points: 12, 48"
[1] "AIC: 242659.1"
[1] "Cox ZPH: 662.8315"
[1] "iteration: 0.625"
[1] "Time points: 12.5, 50"
[1] "AIC: 242669.5"
[1] "Cox ZPH: 753.6261"
[1] "iteration: 0.65"
[1] "Time points: 13, 52"
[1] "AIC: 242679.9"
[1] "Cox ZPH: 846.3598"
[1] "iteration: 0.675"
[1] "Time points: 13.5, 54"
[1] "AIC: 242689.6"
[1] "Cox ZPH: 931.1736"
[1] "iteration: 0.7"
[1] "Time points: 14, 56"
[1] "AIC: 242698.7"
[1] "Cox ZPH: 1007.856"
[1] "iteration: 0.725"
[1] "Time points: 14.5, 58"
[1] "AIC: 242707.1"
[1] "Cox ZPH: 1071.06"
[1] "iteration: 0.75"
[1] "Time points: 15, 60"
[1] "AIC: 242715"
[1] "Cox ZPH: 1120.409"
[1] "iteration: 0.775"
[1] "Time points: 15.5, 62"
[1] "AIC: 242722.2"
[1] "Cox ZPH: 1154.777"
[1] "iteration: 0.8"
[1] "Time points: 16, 64"
[1] "AIC: 242728.3"
[1] "Cox ZPH: 1176.89"
[1] "iteration: 0.825"
[1] "Time points: 16.5, 66"
[1] "AIC: 242733.5"
[1] "Cox ZPH: 1187.06"
[1] "iteration: 0.85"
[1] "Time points: 17, 68"
[1] "AIC: 242737.5"
[1] "Cox ZPH: 1183.687"
[1] "iteration: 0.875"
[1] "Time points: 17.5, 70"
[1] "AIC: 242740.1"
[1] "Cox ZPH: 1169.481"
[1] "iteration: 0.9"
[1] "Time points: 18, 72"
[1] "AIC: 242741.3"
[1] "Cox ZPH: 1145.532"
[1] "iteration: 0.925"
[1] "Time points: 18.5, 74"
[1] "AIC: 242740.9"
[1] "Cox ZPH: 1112.816"
[1] "iteration: 0.95"
[1] "Time points: 19, 76"
[1] "AIC: 242738.7"
[1] "Cox ZPH: 1073.512"
[1] "iteration: 0.975"
[1] "Time points: 19.5, 78"
[1] "AIC: 242734.7"
[1] "Cox ZPH: 1029.364"
[1] "iteration: 1"
[1] "Time points: 20, 80"
[1] "AIC: 242728.6"
[1] "Cox ZPH: 981.5722"
[1] "iteration: 1.025"
[1] "Time points: 20.5, 82"
[1] "AIC: 242720.4"
[1] "Cox ZPH: 932.6265"
[1] "iteration: 1.05"
[1] "Time points: 21, 84"
[1] "AIC: 242709.7"
[1] "Cox ZPH: 881.6735"
[1] "iteration: 1.075"
[1] "Time points: 21.5, 86"
[1] "AIC: 242696.1"
[1] "Cox ZPH: 829.7161"
[1] "iteration: 1.1"
[1] "Time points: 22, 88"
[1] "AIC: 242679.4"
[1] "Cox ZPH: 776.9707"
[1] "iteration: 1.125"
[1] "Time points: 22.5, 90"
[1] "AIC: 242659.1"
[1] "Cox ZPH: 724.111"
[1] "iteration: 1.15"
[1] "Time points: 23, 92"
[1] "AIC: 242634.5"
[1] "Cox ZPH: 670.8339"
[1] "iteration: 1.175"
[1] "Time points: 23.5, 94"
[1] "AIC: 242605.3"
[1] "Cox ZPH: 617.9034"
[1] "iteration: 1.2"
[1] "Time points: 24, 96"
[1] "AIC: 242571.5"
[1] "Cox ZPH: 566.5202"
[1] "iteration: 1.225"
[1] "Time points: 24.5, 98"
[1] "AIC: 242534.1"
[1] "Cox ZPH: 518.4305"
[1] "iteration: 1.25"
[1] "Time points: 25, 100"
[1] "AIC: 242494.1"
[1] "Cox ZPH: 483.4053"
[1] "iteration: 1.275"
[1] "Time points: 25.5, 102"
[1] "AIC: 242453.5"
[1] "Cox ZPH: 449.0626"
[1] "iteration: 1.3"
[1] "Time points: 26, 104"
[1] "AIC: 242423.1"
[1] "Cox ZPH: 428.7996"
[1] "iteration: 1.325"
[1] "Time points: 26.5, 106"
[1] "AIC: 242394.9"
[1] "Cox ZPH: 415.4705"
[1] "iteration: 1.35"
[1] "Time points: 27, 108"
[1] "AIC: 242371.7"
[1] "Cox ZPH: 411.3971"
[1] "iteration: 1.375"
[1] "Time points: 27.5, 110"
[1] "AIC: 242350"
[1] "Cox ZPH: 424.4674"
[1] "iteration: 1.4"
[1] "Time points: 28, 112"
[1] "AIC: 242330.3"
[1] "Cox ZPH: 474.1608"
[1] "iteration: 1.425"
[1] "Time points: 28.5, 114"
[1] "AIC: 242313.6"
[1] "Cox ZPH: 581.5571"
[1] "iteration: 1.45"
[1] "Time points: 29, 116"
[1] "AIC: 242304.5"
[1] "Cox ZPH: 701.7825"
[1] "iteration: 1.475"
[1] "Time points: 29.5, 118"
[1] "AIC: 242301.8"
[1] "Cox ZPH: 757.7131"
[1] "iteration: 1.5"
[1] "Time points: 30, 120"
[1] "AIC: 242301.4"
[1] "Cox ZPH: 769.7678"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>results_susinidum_coc[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_coc<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_coc<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              spec      aic  cox_zph success
14 iteration: 0.425; tvcs: 8.5, 34 242587.3 337.1026    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                               spec      aic  cox_zph success</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 14 iteration: 0.425; tvcs: 8.5, 34 242575.7 336.8893    TRUE</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The previously modified model: "</span>,</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_susinidum_coc[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_coc<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_coc<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The previously modified model: 321.7 vs.&nbsp;the minimum model: 337.1026</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The previously modified model: 321.3 vs. the minimum model: 336.8893</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen"</span>)</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(splines)</span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>specs_susinidum_coc <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"susinidum_coc *"</span>, <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log(time+0.001)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 3)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 4)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 5)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 6)"</span>, <span class="st">"pspline(log(time+0.001), df=3)"</span>, <span class="st">"pspline(log(time+0.001), df=4)"</span>, <span class="st">"pspline(log(time+0.001), df=5)"</span>, <span class="st">"pspline(log(time+0.001), df=6)"</span>, <span class="st">"bs(time, 3)"</span>, <span class="st">"bs(time, 4)"</span>, <span class="st">"bs(time, 5)"</span>, <span class="st">"bs(time, 6)"</span>, <span class="st">"ns(time, 3)"</span>, <span class="st">"ns(time, 4)"</span>, <span class="st">"ns(time, 5)"</span>, <span class="st">"ns(time, 6)"</span>, <span class="st">"rcs(time, 3)"</span>, <span class="st">"rcs(time, 4)"</span>, <span class="st">"rcs(time, 5)"</span>, <span class="st">"rcs(time, 6)"</span>))</span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>results_susini_coc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(specs_susinidum_coc)) {</span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> specs_susinidum_coc[i]</span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb364-17"><a href="#cb364-17" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb364-18"><a href="#cb364-18" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb364-19"><a href="#cb364-19" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb364-20"><a href="#cb364-20" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb364-21"><a href="#cb364-21" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb364-22"><a href="#cb364-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb364-23"><a href="#cb364-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb364-24"><a href="#cb364-24" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb364-25"><a href="#cb364-25" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb364-26"><a href="#cb364-26" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh +</span></span>
<span id="cb364-27"><a href="#cb364-27" aria-hidden="true" tabindex="-1"></a><span class="st">            I(round("</span>,l,<span class="st">",2)) +</span></span>
<span id="cb364-28"><a href="#cb364-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb364-29"><a href="#cb364-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb364-30"><a href="#cb364-30" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb364-31"><a href="#cb364-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb364-32"><a href="#cb364-32" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb364-33"><a href="#cb364-33" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb364-34"><a href="#cb364-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb364-35"><a href="#cb364-35" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb364-36"><a href="#cb364-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb364-37"><a href="#cb364-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb364-38"><a href="#cb364-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb364-39"><a href="#cb364-39" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb364-40"><a href="#cb364-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb364-41"><a href="#cb364-41" aria-hidden="true" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec =</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb364-42"><a href="#cb364-42" aria-hidden="true" tabindex="-1"></a>                   data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb364-43"><a href="#cb364-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb364-44"><a href="#cb364-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb364-45"><a href="#cb364-45" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="fu">extractAIC</span>(model)[[<span class="dv">2</span>]]</span>
<span id="cb364-46"><a href="#cb364-46" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>]</span>
<span id="cb364-47"><a href="#cb364-47" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">TRUE</span> </span>
<span id="cb364-48"><a href="#cb364-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb364-49"><a href="#cb364-49" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb364-50"><a href="#cb364-50" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb364-51"><a href="#cb364-51" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb364-52"><a href="#cb364-52" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb364-53"><a href="#cb364-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Error fitting specification "</span>, i, <span class="st">" ("</span>, l, <span class="st">"): "</span>, e))</span>
<span id="cb364-54"><a href="#cb364-54" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb364-55"><a href="#cb364-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-56"><a href="#cb364-56" aria-hidden="true" tabindex="-1"></a>  results_susini_coc <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_susini_coc, <span class="fu">data.frame</span>(<span class="at">spec =</span> l, <span class="at">aic =</span> aic_val, <span class="at">cox_zph =</span> cox_zph_val, <span class="at">success =</span> success))</span>
<span id="cb364-57"><a href="#cb364-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-58"><a href="#cb364-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Iteration:"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) <span class="co"># Add iteration number</span></span>
<span id="cb364-59"><a href="#cb364-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Spec: "</span>, l, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb364-60"><a href="#cb364-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"AIC: "</span>, results_susini_oh<span class="sc">$</span>aic[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) </span>
<span id="cb364-61"><a href="#cb364-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Cox zph test statistic: "</span>, results_susini_oh<span class="sc">$</span>cox_zph[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb364-62"><a href="#cb364-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 1 
NULL
Spec:  susinidum_coc *time 
NULL
AIC:  239724.019577566 
NULL
Cox zph test statistic:  4672.22758383257 
NULL
Iteration: 2 
NULL
Spec:  susinidum_coc *log(time+0.001) 
NULL
AIC:  241585.150871146 
NULL
Cox zph test statistic:  1204.10177494143 
NULL
Iteration: 3 
NULL
Spec:  susinidum_coc *poly(ifelse(is.na(time), .001,time), 3) 
NULL
AIC:  240219.630415016 
NULL
Cox zph test statistic:  7926.39955359493 
NULL
Iteration: 4 
NULL
Spec:  susinidum_coc *poly(ifelse(is.na(time), .001,time), 4) 
NULL
AIC:  240063.039259188 
NULL
Cox zph test statistic:  8212.21889149851 
NULL
Iteration: 5 
NULL
Spec:  susinidum_coc *poly(ifelse(is.na(time), .001,time), 5) 
NULL
AIC:  240016.095427946 
NULL
Cox zph test statistic:  8304.47329075385 
NULL
Iteration: 6 
NULL
Spec:  susinidum_coc *poly(ifelse(is.na(time), .001,time), 6) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 7 
NULL
Spec:  susinidum_coc *pspline(log(time+0.001), df=3) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 8 
NULL
Spec:  susinidum_coc *pspline(log(time+0.001), df=4) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 9 
NULL
Spec:  susinidum_coc *pspline(log(time+0.001), df=5) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 10 
NULL
Spec:  susinidum_coc *pspline(log(time+0.001), df=6) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 11 
NULL
Spec:  susinidum_coc *bs(time, 3) 
NULL
AIC:  239518.026724213 
NULL
Cox zph test statistic:  10331.3482921498 
NULL
Iteration: 12 
NULL
Spec:  susinidum_coc *bs(time, 4) 
NULL
AIC:  236772.640457164 
NULL
Cox zph test statistic:  18133.928243881 
NULL
Iteration: 13 
NULL
Spec:  susinidum_coc *bs(time, 5) 
NULL
AIC:  235970.965928735 
NULL
Cox zph test statistic:  20900.8309746657 
NULL
Iteration: 14 
NULL
Spec:  susinidum_coc *bs(time, 6) 
NULL
AIC:  235677.262806318 
NULL
Cox zph test statistic:  21727.8304904265 
NULL
Iteration: 15 
NULL
Spec:  susinidum_coc *ns(time, 3) 
NULL
AIC:  238253.396508616 
NULL
Cox zph test statistic:  14728.7767838593 
NULL
Iteration: 16 
NULL
Spec:  susinidum_coc *ns(time, 4) 
NULL
AIC:  236653.226858842 
NULL
Cox zph test statistic:  19308.1808541226 
NULL
Iteration: 17 
NULL
Spec:  susinidum_coc *ns(time, 5) 
NULL
AIC:  236251.069626771 
NULL
Cox zph test statistic:  20993.031671471 
NULL
Iteration: 18 
NULL
Spec:  susinidum_coc *ns(time, 6) 
NULL
AIC:  235896.939555169 
NULL
Cox zph test statistic:  21101.9090902985 
NULL
Iteration: 19 
NULL
Spec:  susinidum_coc *rcs(time, 3) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
Iteration: 20 
NULL
Spec:  susinidum_coc *rcs(time, 4) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
Iteration: 21 
NULL
Spec:  susinidum_coc *rcs(time, 5) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
X matrix deemed to be singular; variable time''' 
Iteration: 22 
NULL
Spec:  susinidum_coc *rcs(time, 6) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>results_susini_coc[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susini_coc<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susini_coc<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            spec      aic  cox_zph success
2 susinidum_coc *log(time+0.001) 242707.4 323.3394    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                             spec      aic cox_zph success</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 susinidum_coc *log(time+0.001) 242695.6 323.038    TRUE</span></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen. We do nothing"</span>)</span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>results_susinidum_coc_alt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,.<span class="dv">1</span>)) {</span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>  change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span>i, <span class="dv">10</span><span class="sc">*</span>i, <span class="dv">15</span><span class="sc">*</span>i)  <span class="co"># Example change points (months)</span></span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_coc_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a>                                                       susinidum_coc<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt<span class="ot">&lt;-</span></span>
<span id="cb368-18"><a href="#cb368-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb368-19"><a href="#cb368-19" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb368-20"><a href="#cb368-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb368-21"><a href="#cb368-21" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb368-22"><a href="#cb368-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb368-23"><a href="#cb368-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb368-24"><a href="#cb368-24" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb368-25"><a href="#cb368-25" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb368-26"><a href="#cb368-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb368-27"><a href="#cb368-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec2 +</span></span>
<span id="cb368-28"><a href="#cb368-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh +</span></span>
<span id="cb368-29"><a href="#cb368-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb368-30"><a href="#cb368-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb368-31"><a href="#cb368-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb368-32"><a href="#cb368-32" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb368-33"><a href="#cb368-33" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb368-34"><a href="#cb368-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb368-35"><a href="#cb368-35" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb368-36"><a href="#cb368-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb368-37"><a href="#cb368-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb368-38"><a href="#cb368-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb368-39"><a href="#cb368-39" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb368-40"><a href="#cb368-40" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb368-41"><a href="#cb368-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb368-42"><a href="#cb368-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb368-43"><a href="#cb368-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb368-44"><a href="#cb368-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb368-45"><a href="#cb368-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)</span>
<span id="cb368-46"><a href="#cb368-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb368-47"><a href="#cb368-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb368-48"><a href="#cb368-48" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb368-49"><a href="#cb368-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb368-50"><a href="#cb368-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]))</span>
<span id="cb368-51"><a href="#cb368-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb368-52"><a href="#cb368-52" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb368-53"><a href="#cb368-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb368-54"><a href="#cb368-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb368-55"><a href="#cb368-55" aria-hidden="true" tabindex="-1"></a>  results_susinidum_coc_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_susinidum_coc_alt, </span>
<span id="cb368-56"><a href="#cb368-56" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">cbind.data.frame</span>(</span>
<span id="cb368-57"><a href="#cb368-57" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; change points: "</span>, change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]), </span>
<span id="cb368-58"><a href="#cb368-58" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">aic =</span> aic_iter,</span>
<span id="cb368-59"><a href="#cb368-59" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb368-60"><a href="#cb368-60" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">success =</span> T</span>
<span id="cb368-61"><a href="#cb368-61" aria-hidden="true" tabindex="-1"></a>                                                 ))</span>
<span id="cb368-62"><a href="#cb368-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 1"
[1] "Time points: 5, 10, 15"
[1] "AIC: 242740.9"
[1] "Cox ZPH: 318.8496"
[1] "iteration: 1.1"
[1] "Time points: 5.5, 11, 16.5"
[1] "AIC: 242740.9"
[1] "Cox ZPH: 319.5982"
[1] "iteration: 1.2"
[1] "Time points: 6, 12, 18"
[1] "AIC: 242741"
[1] "Cox ZPH: 321.6762"
[1] "iteration: 1.3"
[1] "Time points: 6.5, 13, 19.5"
[1] "AIC: 242740.9"
[1] "Cox ZPH: 321.3254"
[1] "iteration: 1.4"
[1] "Time points: 7, 14, 21"
[1] "AIC: 242740.8"
[1] "Cox ZPH: 321.5408"
[1] "iteration: 1.5"
[1] "Time points: 7.5, 15, 22.5"
[1] "AIC: 242740.6"
[1] "Cox ZPH: 322.0213"
[1] "iteration: 1.6"
[1] "Time points: 8, 16, 24"
[1] "AIC: 242741"
[1] "Cox ZPH: 324.2359"
[1] "iteration: 1.7"
[1] "Time points: 8.5, 17, 25.5"
[1] "AIC: 242741.3"
[1] "Cox ZPH: 327.4271"
[1] "iteration: 1.8"
[1] "Time points: 9, 18, 27"
[1] "AIC: 242741.3"
[1] "Cox ZPH: 327.9855"
[1] "iteration: 1.9"
[1] "Time points: 9.5, 19, 28.5"
[1] "AIC: 242741.3"
[1] "Cox ZPH: 328.6902"
[1] "iteration: 2"
[1] "Time points: 10, 20, 30"
[1] "AIC: 242741.1"
[1] "Cox ZPH: 329.7676"
[1] "iteration: 2.1"
[1] "Time points: 10.5, 21, 31.5"
[1] "AIC: 242741"
[1] "Cox ZPH: 327.3083"
[1] "iteration: 2.2"
[1] "Time points: 11, 22, 33"
[1] "AIC: 242741"
[1] "Cox ZPH: 325.072"
[1] "iteration: 2.3"
[1] "Time points: 11.5, 23, 34.5"
[1] "AIC: 242740.3"
[1] "Cox ZPH: 324.9401"
[1] "iteration: 2.4"
[1] "Time points: 12, 24, 36"
[1] "AIC: 242739.6"
[1] "Cox ZPH: 323.5421"
[1] "iteration: 2.5"
[1] "Time points: 12.5, 25, 37.5"
[1] "AIC: 242740.1"
[1] "Cox ZPH: 321.4559"
[1] "iteration: 2.6"
[1] "Time points: 13, 26, 39"
[1] "AIC: 242739.5"
[1] "Cox ZPH: 319.2246"
[1] "iteration: 2.7"
[1] "Time points: 13.5, 27, 40.5"
[1] "AIC: 242739"
[1] "Cox ZPH: 318.7078"
[1] "iteration: 2.8"
[1] "Time points: 14, 28, 42"
[1] "AIC: 242738.8"
[1] "Cox ZPH: 317.9917"
[1] "iteration: 2.9"
[1] "Time points: 14.5, 29, 43.5"
[1] "AIC: 242739.3"
[1] "Cox ZPH: 317.7749"
[1] "iteration: 3"
[1] "Time points: 15, 30, 45"
[1] "AIC: 242740.1"
[1] "Cox ZPH: 317.7125"
[1] "iteration: 3.1"
[1] "Time points: 15.5, 31, 46.5"
[1] "AIC: 242740.4"
[1] "Cox ZPH: 317.9962"
[1] "iteration: 3.2"
[1] "Time points: 16, 32, 48"
[1] "AIC: 242741.2"
[1] "Cox ZPH: 319.1036"
[1] "iteration: 3.3"
[1] "Time points: 16.5, 33, 49.5"
[1] "AIC: 242741.3"
[1] "Cox ZPH: 320.6839"
[1] "iteration: 3.4"
[1] "Time points: 17, 34, 51"
[1] "AIC: 242741.3"
[1] "Cox ZPH: 323.1721"
[1] "iteration: 3.5"
[1] "Time points: 17.5, 35, 52.5"
[1] "AIC: 242740.6"
[1] "Cox ZPH: 326.611"
[1] "iteration: 3.6"
[1] "Time points: 18, 36, 54"
[1] "AIC: 242740.6"
[1] "Cox ZPH: 328.6784"
[1] "iteration: 3.7"
[1] "Time points: 18.5, 37, 55.5"
[1] "AIC: 242740"
[1] "Cox ZPH: 333.0428"
[1] "iteration: 3.8"
[1] "Time points: 19, 38, 57"
[1] "AIC: 242739.3"
[1] "Cox ZPH: 336.2208"
[1] "iteration: 3.9"
[1] "Time points: 19.5, 39, 58.5"
[1] "AIC: 242738.4"
[1] "Cox ZPH: 339.4407"
[1] "iteration: 4"
[1] "Time points: 20, 40, 60"
[1] "AIC: 242737.2"
[1] "Cox ZPH: 344.0601"
[1] "iteration: 4.1"
[1] "Time points: 20.5, 41, 61.5"
[1] "AIC: 242735.7"
[1] "Cox ZPH: 347.9692"
[1] "iteration: 4.2"
[1] "Time points: 21, 42, 63"
[1] "AIC: 242735"
[1] "Cox ZPH: 352.4328"
[1] "iteration: 4.3"
[1] "Time points: 21.5, 43, 64.5"
[1] "AIC: 242734.3"
[1] "Cox ZPH: 357.9312"
[1] "iteration: 4.4"
[1] "Time points: 22, 44, 66"
[1] "AIC: 242732.4"
[1] "Cox ZPH: 359.4456"
[1] "iteration: 4.5"
[1] "Time points: 22.5, 45, 67.5"
[1] "AIC: 242731"
[1] "Cox ZPH: 364.9348"
[1] "iteration: 4.6"
[1] "Time points: 23, 46, 69"
[1] "AIC: 242730.3"
[1] "Cox ZPH: 365.0121"
[1] "iteration: 4.7"
[1] "Time points: 23.5, 47, 70.5"
[1] "AIC: 242729.2"
[1] "Cox ZPH: 363.3641"
[1] "iteration: 4.8"
[1] "Time points: 24, 48, 72"
[1] "AIC: 242727.3"
[1] "Cox ZPH: 367.802"
[1] "iteration: 4.9"
[1] "Time points: 24.5, 49, 73.5"
[1] "AIC: 242728.2"
[1] "Cox ZPH: 370.3726"
[1] "iteration: 5"
[1] "Time points: 25, 50, 75"
[1] "AIC: 242727.4"
[1] "Cox ZPH: 370.8872"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>results_susinidum_coc_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                      spec      aic  cox_zph success
21 iteration: 3; change points: 15, 30, 45 242740.1 317.7125    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       spec      aic  cox_zph success</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 21 iteration: 3; change points: 15, 30, 45 242728.3 317.3692    TRUE</span></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The minimum of the first modified model: "</span>,</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out)<span class="sc">$</span>table), <span class="dv">1</span>]),</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_susinidum_coc_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The minimum of the first modified model: 321.6527 vs.&nbsp;the minimum model: 317.7125</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The minimum of the first modified model: 321.3004 vs. the minimum model: 317.3692</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It improves"</span>)</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>results_susinidum_coc_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                      spec      aic  cox_zph success
21 iteration: 3; change points: 15, 30, 45 242740.1 317.7125    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">*</span><span class="dv">3</span>, <span class="dv">15</span><span class="sc">*</span><span class="dv">3</span>)  <span class="co"># Example change points (months)</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_coc_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>                                                     susinidum_coc<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt<span class="ot">&lt;-</span></span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span> </span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>            lag_tr_outcome_rec <span class="sc">+</span></span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a>            log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a>            lag_less_90d_tr1_rec<span class="sc">+</span></span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a>            lag_comp_bpsc_y3_severe_rec <span class="sc">+</span> </span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a>            lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb375-19"><a href="#cb375-19" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb375-20"><a href="#cb375-20" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb375-21"><a href="#cb375-21" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb375-22"><a href="#cb375-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb375-23"><a href="#cb375-23" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb375-24"><a href="#cb375-24" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb375-25"><a href="#cb375-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb375-26"><a href="#cb375-26" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb375-27"><a href="#cb375-27" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb375-28"><a href="#cb375-28" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb375-29"><a href="#cb375-29" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb375-30"><a href="#cb375-30" aria-hidden="true" tabindex="-1"></a>            susprindum_mar<span class="sc">+</span></span>
<span id="cb375-31"><a href="#cb375-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb375-32"><a href="#cb375-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb375-33"><a href="#cb375-33" aria-hidden="true" tabindex="-1"></a>        data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb375-34"><a href="#cb375-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb375-35"><a href="#cb375-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-36"><a href="#cb375-36" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 chisq df      p
lag_tr_outcome_rec             66.6088  1 0.0000
log_lag_dias_treat_imp_sin_na  10.5341  1 0.0012
lag_less_90d_tr1_rec           84.1713  1 0.0000
lag_comp_bpsc_y3_severe_rec    17.3155  1 0.0000
lag_policonsumo2                3.2002  1 0.0736
edad_al_ing_1                   0.1512  1 0.6974
ano_nac_corr                    5.1470  1 0.0233
susinidum_coc_rec2              2.9483  1 0.0860
susinidum_oh                   19.9650  1 0.0000
susinidum_pbc                   2.0948  1 0.1478
susinidum_mar                   6.7931  1 0.0092
psycom_dum_with                11.7373  1 0.0006
psycom_dum_study                1.6233  1 0.2026
freq_cons_dum_5day              0.0825  1 0.7739
cond_oc_dum_2inact              4.4758  1 0.0344
cond_oc_dum_3unemp              1.7447  1 0.1865
susprindum_oh                   4.3698  1 0.0366
susprindum_coc                  1.5662  1 0.2108
susprindum_pbc                  0.0503  1 0.8226
susprindum_mar                  5.2711  1 0.0217
GLOBAL                        317.7125 20 0.0000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  chisq df      p</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome_rec             66.7157  1 0.0000</span></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na  10.3761  1 0.0013</span></span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1_rec           84.1743  1 0.0000</span></span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe_rec    17.2693  1 0.0000</span></span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                3.1689  1 0.0751</span></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                   0.1432  1 0.7051</span></span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    5.1839  1 0.0228</span></span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2              2.9377  1 0.0865</span></span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   19.7620  1 0.0000</span></span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   2.0158  1 0.1557</span></span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                   6.7590  1 0.0093</span></span>
<span id="cb377-13"><a href="#cb377-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                11.7916  1 0.0006</span></span>
<span id="cb377-14"><a href="#cb377-14" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                1.6349  1 0.2010</span></span>
<span id="cb377-15"><a href="#cb377-15" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              0.0541  1 0.8161</span></span>
<span id="cb377-16"><a href="#cb377-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              4.5002  1 0.0339</span></span>
<span id="cb377-17"><a href="#cb377-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp              1.6255  1 0.2023</span></span>
<span id="cb377-18"><a href="#cb377-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                   4.2826  1 0.0385</span></span>
<span id="cb377-19"><a href="#cb377-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  1.6036  1 0.2054</span></span>
<span id="cb377-20"><a href="#cb377-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                  0.0666  1 0.7964</span></span>
<span id="cb377-21"><a href="#cb377-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  5.3207  1 0.0211</span></span>
<span id="cb377-22"><a href="#cb377-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        317.3692 20 0.0000</span></span>
<span id="cb377-23"><a href="#cb377-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-24"><a href="#cb377-24" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb377-25"><a href="#cb377-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb377-26"><a href="#cb377-26" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Analyse the violation of proportional hazards"</span>)</span>
<span id="cb377-27"><a href="#cb377-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb377-28"><a href="#cb377-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb377-29"><a href="#cb377-29" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">dev.off</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>res240422_6_restr <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt, <span class="st">"scaledsch"</span>)</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>time240422_6_restr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dimnames</span>(res240422_6_restr)[[<span class="dv">1</span>]])</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>z_240422_6_1_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_6_restr[,<span class="st">"susinidum_oh"</span>] <span class="sc">~</span> time240422_6_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_6_restr, <span class="fu">fitted</span>(z_240422_6_1_restr))</span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_6_restr, res240422_6_restr[,<span class="st">"susinidum_oh"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., susinidum_coc"</span>)</span>
<span id="cb379-10"><a href="#cb379-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-11"><a href="#cb379-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)[<span class="fu">which</span>(<span class="fu">attr</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"susinidum_oh"</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span> <span class="st">"Residuals of susinidum_oh"</span>)</span>
<span id="cb379-12"><a href="#cb379-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb379-13"><a href="#cb379-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt<span class="sc">$</span>coefficients[<span class="st">"susinidum_oh"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb379-14"><a href="#cb379-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb379-15"><a href="#cb379-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-16"><a href="#cb379-16" aria-hidden="true" tabindex="-1"></a>km_susinidum_oh <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> susinidum_oh<span class="sc">+</span> </span>
<span id="cb379-17"><a href="#cb379-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb379-18"><a href="#cb379-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_susinidum_oh, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by susinidum_oh"</span>)</span>
<span id="cb379-19"><a href="#cb379-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb379-20"><a href="#cb379-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-21"><a href="#cb379-21" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb379-22"><a href="#cb379-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-23"><a href="#cb379-23" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb379-24"><a href="#cb379-24" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb379-25"><a href="#cb379-25" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb379-26"><a href="#cb379-26" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_susinidum_oh2_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb379-27"><a href="#cb379-27" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb379-28"><a href="#cb379-28" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>pdf 
  2 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now with Initial substance: Alcohol AGAIN"</span>)</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="fl">1.5</span>,.<span class="dv">025</span>)) {</span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>  tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span>i</span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_oh_rec<span class="ot">&lt;-</span></span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_oh, </span>
<span id="cb381-12"><a href="#cb381-12" aria-hidden="true" tabindex="-1"></a>                               data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb381-13"><a href="#cb381-13" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">1</span>],</span>
<span id="cb381-14"><a href="#cb381-14" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">2</span>],</span>
<span id="cb381-15"><a href="#cb381-15" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb381-16"><a href="#cb381-16" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_susinidum_oh<span class="ot">&lt;-</span></span>
<span id="cb381-17"><a href="#cb381-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb381-18"><a href="#cb381-18" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb381-19"><a href="#cb381-19" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb381-20"><a href="#cb381-20" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb381-21"><a href="#cb381-21" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb381-22"><a href="#cb381-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb381-23"><a href="#cb381-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb381-24"><a href="#cb381-24" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb381-25"><a href="#cb381-25" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb381-26"><a href="#cb381-26" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec2 +</span></span>
<span id="cb381-27"><a href="#cb381-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh_rec +</span></span>
<span id="cb381-28"><a href="#cb381-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb381-29"><a href="#cb381-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb381-30"><a href="#cb381-30" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb381-31"><a href="#cb381-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb381-32"><a href="#cb381-32" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb381-33"><a href="#cb381-33" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb381-34"><a href="#cb381-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb381-35"><a href="#cb381-35" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb381-36"><a href="#cb381-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb381-37"><a href="#cb381-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb381-38"><a href="#cb381-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb381-39"><a href="#cb381-39" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb381-40"><a href="#cb381-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb381-41"><a href="#cb381-41" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb381-42"><a href="#cb381-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb381-43"><a href="#cb381-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb381-44"><a href="#cb381-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_susinidum_oh)</span>
<span id="cb381-45"><a href="#cb381-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb381-46"><a href="#cb381-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb381-47"><a href="#cb381-47" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_susinidum_oh)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb381-48"><a href="#cb381-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]))</span>
<span id="cb381-49"><a href="#cb381-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb381-50"><a href="#cb381-50" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_susinidum_oh)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_susinidum_oh)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb381-51"><a href="#cb381-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb381-52"><a href="#cb381-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb381-53"><a href="#cb381-53" aria-hidden="true" tabindex="-1"></a>  results_susinidum_oh2 <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_susinidum_oh2, </span>
<span id="cb381-54"><a href="#cb381-54" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">cbind.data.frame</span>(</span>
<span id="cb381-55"><a href="#cb381-55" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; tvcs: "</span>, tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]), </span>
<span id="cb381-56"><a href="#cb381-56" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">aic =</span> aic_iter,</span>
<span id="cb381-57"><a href="#cb381-57" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb381-58"><a href="#cb381-58" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">success =</span> T</span>
<span id="cb381-59"><a href="#cb381-59" aria-hidden="true" tabindex="-1"></a>                                             ))</span>
<span id="cb381-60"><a href="#cb381-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] "Time points: 2, 8"
[1] "AIC: 239556.7"
[1] "Cox ZPH: 5469.566"
[1] "iteration: 0.125"
[1] "Time points: 2.5, 10"
[1] "AIC: 239513.6"
[1] "Cox ZPH: 5660.287"
[1] "iteration: 0.15"
[1] "Time points: 3, 12"
[1] "AIC: 239499.1"
[1] "Cox ZPH: 5766.978"
[1] "iteration: 0.175"
[1] "Time points: 3.5, 14"
[1] "AIC: 239512.2"
[1] "Cox ZPH: 5799.257"
[1] "iteration: 0.2"
[1] "Time points: 4, 16"
[1] "AIC: 239556.4"
[1] "Cox ZPH: 5748.393"
[1] "iteration: 0.225"
[1] "Time points: 4.5, 18"
[1] "AIC: 239623.7"
[1] "Cox ZPH: 5636.161"
[1] "iteration: 0.25"
[1] "Time points: 5, 20"
[1] "AIC: 239711.5"
[1] "Cox ZPH: 5463.947"
[1] "iteration: 0.275"
[1] "Time points: 5.5, 22"
[1] "AIC: 239820.5"
[1] "Cox ZPH: 5222.299"
[1] "iteration: 0.3"
[1] "Time points: 6, 24"
[1] "AIC: 239953.8"
[1] "Cox ZPH: 4892.01"
[1] "iteration: 0.325"
[1] "Time points: 6.5, 26"
[1] "AIC: 240100.8"
[1] "Cox ZPH: 4497.324"
[1] "iteration: 0.35"
[1] "Time points: 7, 28"
[1] "AIC: 240262.6"
[1] "Cox ZPH: 4030.255"
[1] "iteration: 0.375"
[1] "Time points: 7.5, 30"
[1] "AIC: 240431.9"
[1] "Cox ZPH: 3523.814"
[1] "iteration: 0.4"
[1] "Time points: 8, 32"
[1] "AIC: 240604.4"
[1] "Cox ZPH: 3007.152"
[1] "iteration: 0.425"
[1] "Time points: 8.5, 34"
[1] "AIC: 240780.5"
[1] "Cox ZPH: 2499.49"
[1] "iteration: 0.45"
[1] "Time points: 9, 36"
[1] "AIC: 240959.3"
[1] "Cox ZPH: 2042.524"
[1] "iteration: 0.475"
[1] "Time points: 9.5, 38"
[1] "AIC: 241138"
[1] "Cox ZPH: 1695.105"
[1] "iteration: 0.5"
[1] "Time points: 10, 40"
[1] "AIC: 241309.6"
[1] "Cox ZPH: 1516.189"
[1] "iteration: 0.525"
[1] "Time points: 10.5, 42"
[1] "AIC: 241477.7"
[1] "Cox ZPH: 1530.988"
[1] "iteration: 0.55"
[1] "Time points: 11, 44"
[1] "AIC: 241642.2"
[1] "Cox ZPH: 1754.078"
[1] "iteration: 0.575"
[1] "Time points: 11.5, 46"
[1] "AIC: 241800.2"
[1] "Cox ZPH: 2173.52"
[1] "iteration: 0.6"
[1] "Time points: 12, 48"
[1] "AIC: 241950.1"
[1] "Cox ZPH: 2751.925"
[1] "iteration: 0.625"
[1] "Time points: 12.5, 50"
[1] "AIC: 242092.6"
[1] "Cox ZPH: 3446.823"
[1] "iteration: 0.65"
[1] "Time points: 13, 52"
[1] "AIC: 242227"
[1] "Cox ZPH: 4199.34"
[1] "iteration: 0.675"
[1] "Time points: 13.5, 54"
[1] "AIC: 242350.7"
[1] "Cox ZPH: 4944.467"
[1] "iteration: 0.7"
[1] "Time points: 14, 56"
[1] "AIC: 242460.7"
[1] "Cox ZPH: 5620.455"
[1] "iteration: 0.725"
[1] "Time points: 14.5, 58"
[1] "AIC: 242554.3"
[1] "Cox ZPH: 6178.287"
[1] "iteration: 0.75"
[1] "Time points: 15, 60"
[1] "AIC: 242630.7"
[1] "Cox ZPH: 6598.576"
[1] "iteration: 0.775"
[1] "Time points: 15.5, 62"
[1] "AIC: 242688.3"
[1] "Cox ZPH: 6868.943"
[1] "iteration: 0.8"
[1] "Time points: 16, 64"
[1] "AIC: 242725.3"
[1] "Cox ZPH: 6996.218"
[1] "iteration: 0.825"
[1] "Time points: 16.5, 66"
[1] "AIC: 242740.2"
[1] "Cox ZPH: 7000.32"
[1] "iteration: 0.85"
[1] "Time points: 17, 68"
[1] "AIC: 242732.2"
[1] "Cox ZPH: 6903.379"
[1] "iteration: 0.875"
[1] "Time points: 17.5, 70"
[1] "AIC: 242700"
[1] "Cox ZPH: 6727.182"
[1] "iteration: 0.9"
[1] "Time points: 18, 72"
[1] "AIC: 242643.3"
[1] "Cox ZPH: 6493.766"
[1] "iteration: 0.925"
[1] "Time points: 18.5, 74"
[1] "AIC: 242562.9"
[1] "Cox ZPH: 6225.363"
[1] "iteration: 0.95"
[1] "Time points: 19, 76"
[1] "AIC: 242458.8"
[1] "Cox ZPH: 5933.628"
[1] "iteration: 0.975"
[1] "Time points: 19.5, 78"
[1] "AIC: 242330.8"
[1] "Cox ZPH: 5629.225"
[1] "iteration: 1"
[1] "Time points: 20, 80"
[1] "AIC: 242178"
[1] "Cox ZPH: 5315.827"
[1] "iteration: 1.025"
[1] "Time points: 20.5, 82"
[1] "AIC: 242001.4"
[1] "Cox ZPH: 5006.006"
[1] "iteration: 1.05"
[1] "Time points: 21, 84"
[1] "AIC: 241803.4"
[1] "Cox ZPH: 4708.628"
[1] "iteration: 1.075"
[1] "Time points: 21.5, 86"
[1] "AIC: 241588.2"
[1] "Cox ZPH: 4429.636"
[1] "iteration: 1.1"
[1] "Time points: 22, 88"
[1] "AIC: 241355.7"
[1] "Cox ZPH: 4166.516"
[1] "iteration: 1.125"
[1] "Time points: 22.5, 90"
[1] "AIC: 241106.1"
[1] "Cox ZPH: 3917.886"
[1] "iteration: 1.15"
[1] "Time points: 23, 92"
[1] "AIC: 240845.4"
[1] "Cox ZPH: 3688.558"
[1] "iteration: 1.175"
[1] "Time points: 23.5, 94"
[1] "AIC: 240574.7"
[1] "Cox ZPH: 3476.06"
[1] "iteration: 1.2"
[1] "Time points: 24, 96"
[1] "AIC: 240294.8"
[1] "Cox ZPH: 3285.221"
[1] "iteration: 1.225"
[1] "Time points: 24.5, 98"
[1] "AIC: 240013.4"
[1] "Cox ZPH: 3118.936"
[1] "iteration: 1.25"
[1] "Time points: 25, 100"
[1] "AIC: 239734.8"
[1] "Cox ZPH: 2977.732"
[1] "iteration: 1.275"
[1] "Time points: 25.5, 102"
[1] "AIC: 239459.9"
[1] "Cox ZPH: 2862.778"
[1] "iteration: 1.3"
[1] "Time points: 26, 104"
[1] "AIC: 239188.1"
[1] "Cox ZPH: 2772.228"
[1] "iteration: 1.325"
[1] "Time points: 26.5, 106"
[1] "AIC: 238923.8"
[1] "Cox ZPH: 2710.248"
[1] "iteration: 1.35"
[1] "Time points: 27, 108"
[1] "AIC: 238664.5"
[1] "Cox ZPH: 2681.074"
[1] "iteration: 1.375"
[1] "Time points: 27.5, 110"
[1] "AIC: 238411.7"
[1] "Cox ZPH: 2689.043"
[1] "iteration: 1.4"
[1] "Time points: 28, 112"
[1] "AIC: 238178.4"
[1] "Cox ZPH: 2739.046"
[1] "iteration: 1.425"
[1] "Time points: 28.5, 114"
[1] "AIC: 237964.8"
[1] "Cox ZPH: 2841.23"
[1] "iteration: 1.45"
[1] "Time points: 29, 116"
[1] "AIC: 237767.9"
[1] "Cox ZPH: 3011.975"
[1] "iteration: 1.475"
[1] "Time points: 29.5, 118"
[1] "AIC: 237594.5"
[1] "Cox ZPH: 3274.361"
[1] "iteration: 1.5"
[1] "Time points: 30, 120"
[1] "AIC: 237451.1"
[1] "Cox ZPH: 3701.742"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh2[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           spec      aic  cox_zph success
17 iteration: 0.5; tvcs: 10, 40 241309.6 1516.189    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                            spec      aic  cox_zph success</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 15 iteration: 0.45; tvcs: 9, 36 242729.5 321.3004    TRUE</span></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>results_susinidum_coc_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_coc_alt<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "317.7125"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The previously modified model: "</span>,</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_susinidum_oh2[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The previously modified model: 317.7 vs.&nbsp;the minimum model: 1516.189</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The previously modified model: 326.3 vs. the minimum model: 1514.375</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen"</span>)</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(splines)</span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a>specs_susinidum_oh <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"susinidum_oh *"</span>, <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log(time+0.001)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 3)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 4)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 5)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 6)"</span>, <span class="st">"pspline(log(time+0.001), df=3)"</span>, <span class="st">"pspline(log(time+0.001), df=4)"</span>, <span class="st">"pspline(log(time+0.001), df=5)"</span>, <span class="st">"pspline(log(time+0.001), df=6)"</span>, <span class="st">"bs(time, 3)"</span>, <span class="st">"bs(time, 4)"</span>, <span class="st">"bs(time, 5)"</span>, <span class="st">"bs(time, 6)"</span>, <span class="st">"ns(time, 3)"</span>, <span class="st">"ns(time, 4)"</span>, <span class="st">"ns(time, 5)"</span>, <span class="st">"ns(time, 6)"</span>, <span class="st">"rcs(time, 3)"</span>, <span class="st">"rcs(time, 4)"</span>, <span class="st">"rcs(time, 5)"</span>, <span class="st">"rcs(time, 6)"</span>))</span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a>results_susini_oh2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-12"><a href="#cb388-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(specs_susinidum_oh)) {</span>
<span id="cb388-13"><a href="#cb388-13" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> specs_susinidum_oh[i]</span>
<span id="cb388-14"><a href="#cb388-14" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb388-15"><a href="#cb388-15" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb388-16"><a href="#cb388-16" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb388-17"><a href="#cb388-17" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb388-18"><a href="#cb388-18" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb388-19"><a href="#cb388-19" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb388-20"><a href="#cb388-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb388-21"><a href="#cb388-21" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb388-22"><a href="#cb388-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb388-23"><a href="#cb388-23" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb388-24"><a href="#cb388-24" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb388-25"><a href="#cb388-25" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec2 +</span></span>
<span id="cb388-26"><a href="#cb388-26" aria-hidden="true" tabindex="-1"></a><span class="st">            I(round("</span>,l,<span class="st">",2)) +</span></span>
<span id="cb388-27"><a href="#cb388-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb388-28"><a href="#cb388-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb388-29"><a href="#cb388-29" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb388-30"><a href="#cb388-30" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb388-31"><a href="#cb388-31" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb388-32"><a href="#cb388-32" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb388-33"><a href="#cb388-33" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb388-34"><a href="#cb388-34" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb388-35"><a href="#cb388-35" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb388-36"><a href="#cb388-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb388-37"><a href="#cb388-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb388-38"><a href="#cb388-38" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb388-39"><a href="#cb388-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb388-40"><a href="#cb388-40" aria-hidden="true" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec =</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb388-41"><a href="#cb388-41" aria-hidden="true" tabindex="-1"></a>                   data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb388-42"><a href="#cb388-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb388-43"><a href="#cb388-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb388-44"><a href="#cb388-44" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="fu">extractAIC</span>(model)[[<span class="dv">2</span>]]</span>
<span id="cb388-45"><a href="#cb388-45" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>]</span>
<span id="cb388-46"><a href="#cb388-46" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">TRUE</span> </span>
<span id="cb388-47"><a href="#cb388-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb388-48"><a href="#cb388-48" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb388-49"><a href="#cb388-49" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb388-50"><a href="#cb388-50" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb388-51"><a href="#cb388-51" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb388-52"><a href="#cb388-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Error fitting specification "</span>, i, <span class="st">" ("</span>, l, <span class="st">"): "</span>, e))</span>
<span id="cb388-53"><a href="#cb388-53" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb388-54"><a href="#cb388-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb388-55"><a href="#cb388-55" aria-hidden="true" tabindex="-1"></a>  results_susini_oh2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_susini_oh2, <span class="fu">data.frame</span>(<span class="at">spec =</span> l, <span class="at">aic =</span> aic_val, <span class="at">cox_zph =</span> cox_zph_val, <span class="at">success =</span> success))</span>
<span id="cb388-56"><a href="#cb388-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb388-57"><a href="#cb388-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Iteration:"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) <span class="co"># Add iteration number</span></span>
<span id="cb388-58"><a href="#cb388-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Spec: "</span>, l, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb388-59"><a href="#cb388-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"AIC: "</span>, results_susini_oh<span class="sc">$</span>aic[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) </span>
<span id="cb388-60"><a href="#cb388-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Cox zph test statistic: "</span>, results_susini_oh<span class="sc">$</span>cox_zph[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb388-61"><a href="#cb388-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 1 
NULL
Spec:  susinidum_oh *time 
NULL
AIC:  239724.019577566 
NULL
Cox zph test statistic:  4672.22758383257 
NULL
Iteration: 2 
NULL
Spec:  susinidum_oh *log(time+0.001) 
NULL
AIC:  241585.150871146 
NULL
Cox zph test statistic:  1204.10177494143 
NULL
Iteration: 3 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 3) 
NULL
AIC:  240219.630415016 
NULL
Cox zph test statistic:  7926.39955359493 
NULL
Iteration: 4 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 4) 
NULL
AIC:  240063.039259188 
NULL
Cox zph test statistic:  8212.21889149851 
NULL
Iteration: 5 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 5) 
NULL
AIC:  240016.095427946 
NULL
Cox zph test statistic:  8304.47329075385 
NULL
Iteration: 6 
NULL
Spec:  susinidum_oh *poly(ifelse(is.na(time), .001,time), 6) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 7 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=3) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 8 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=4) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 9 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=5) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 10 
NULL
Spec:  susinidum_oh *pspline(log(time+0.001), df=6) 
NULL
AIC:  239508.178249717 
NULL
Cox zph test statistic:  8101.01468172362 
NULL
Iteration: 11 
NULL
Spec:  susinidum_oh *bs(time, 3) 
NULL
AIC:  239518.026724213 
NULL
Cox zph test statistic:  10331.3482921498 
NULL
Iteration: 12 
NULL
Spec:  susinidum_oh *bs(time, 4) 
NULL
AIC:  236772.640457164 
NULL
Cox zph test statistic:  18133.928243881 
NULL
Iteration: 13 
NULL
Spec:  susinidum_oh *bs(time, 5) 
NULL
AIC:  235970.965928735 
NULL
Cox zph test statistic:  20900.8309746657 
NULL
Iteration: 14 
NULL
Spec:  susinidum_oh *bs(time, 6) 
NULL
AIC:  235677.262806318 
NULL
Cox zph test statistic:  21727.8304904265 
NULL
Iteration: 15 
NULL
Spec:  susinidum_oh *ns(time, 3) 
NULL
AIC:  238253.396508616 
NULL
Cox zph test statistic:  14728.7767838593 
NULL
Iteration: 16 
NULL
Spec:  susinidum_oh *ns(time, 4) 
NULL
AIC:  236653.226858842 
NULL
Cox zph test statistic:  19308.1808541226 
NULL
Iteration: 17 
NULL
Spec:  susinidum_oh *ns(time, 5) 
NULL
AIC:  236251.069626771 
NULL
Cox zph test statistic:  20993.031671471 
NULL
Iteration: 18 
NULL
Spec:  susinidum_oh *ns(time, 6) 
NULL
AIC:  235896.939555169 
NULL
Cox zph test statistic:  21101.9090902985 
NULL
Iteration: 19 
NULL
Spec:  susinidum_oh *rcs(time, 3) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
X matrix deemed to be singular; variable time'' 
Iteration: 20 
NULL
Spec:  susinidum_oh *rcs(time, 4) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
X matrix deemed to be singular; variable time'' time''' 
Iteration: 21 
NULL
Spec:  susinidum_oh *rcs(time, 5) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL
X matrix deemed to be singular; variable time'' time''' 
Iteration: 22 
NULL
Spec:  susinidum_oh *rcs(time, 6) 
NULL
AIC:  239671.217452014 
NULL
Cox zph test statistic:  9313.41322424369 
NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>results_susini_oh2[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susini_oh2<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susini_oh2<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           spec      aic  cox_zph success
2 susinidum_oh *log(time+0.001) 241724.4 1088.605    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                            spec      aic cox_zph success</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 susinidum_oh *log(time+0.001) 241712.3 1088.12    TRUE</span></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen. We do nothing"</span>)</span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh2_alt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-9"><a href="#cb392-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,.<span class="dv">1</span>)) {</span>
<span id="cb392-10"><a href="#cb392-10" aria-hidden="true" tabindex="-1"></a>  change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span>i, <span class="dv">10</span><span class="sc">*</span>i, <span class="dv">15</span><span class="sc">*</span>i)  <span class="co"># Example change points (months)</span></span>
<span id="cb392-11"><a href="#cb392-11" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb392-12"><a href="#cb392-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb392-13"><a href="#cb392-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb392-14"><a href="#cb392-14" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>susinidum_oh2_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb392-15"><a href="#cb392-15" aria-hidden="true" tabindex="-1"></a>                                                       susinidum_oh<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb392-16"><a href="#cb392-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-17"><a href="#cb392-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh2_alt<span class="ot">&lt;-</span></span>
<span id="cb392-18"><a href="#cb392-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb392-19"><a href="#cb392-19" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb392-20"><a href="#cb392-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb392-21"><a href="#cb392-21" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb392-22"><a href="#cb392-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb392-23"><a href="#cb392-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb392-24"><a href="#cb392-24" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb392-25"><a href="#cb392-25" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb392-26"><a href="#cb392-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb392-27"><a href="#cb392-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec2 +</span></span>
<span id="cb392-28"><a href="#cb392-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh2_rec2 +</span></span>
<span id="cb392-29"><a href="#cb392-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb392-30"><a href="#cb392-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb392-31"><a href="#cb392-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with +</span></span>
<span id="cb392-32"><a href="#cb392-32" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb392-33"><a href="#cb392-33" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb392-34"><a href="#cb392-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb392-35"><a href="#cb392-35" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb392-36"><a href="#cb392-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb392-37"><a href="#cb392-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb392-38"><a href="#cb392-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb392-39"><a href="#cb392-39" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb392-40"><a href="#cb392-40" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb392-41"><a href="#cb392-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb392-42"><a href="#cb392-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb392-43"><a href="#cb392-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb392-44"><a href="#cb392-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb392-45"><a href="#cb392-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh2_alt)</span>
<span id="cb392-46"><a href="#cb392-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb392-47"><a href="#cb392-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb392-48"><a href="#cb392-48" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh2_alt)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb392-49"><a href="#cb392-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb392-50"><a href="#cb392-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]))</span>
<span id="cb392-51"><a href="#cb392-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb392-52"><a href="#cb392-52" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh2_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_oh2_alt)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb392-53"><a href="#cb392-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb392-54"><a href="#cb392-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb392-55"><a href="#cb392-55" aria-hidden="true" tabindex="-1"></a>  results_susinidum_oh2_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_susinidum_oh2_alt, </span>
<span id="cb392-56"><a href="#cb392-56" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">cbind.data.frame</span>(</span>
<span id="cb392-57"><a href="#cb392-57" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; change points: "</span>, change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]), </span>
<span id="cb392-58"><a href="#cb392-58" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">aic =</span> aic_iter,</span>
<span id="cb392-59"><a href="#cb392-59" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb392-60"><a href="#cb392-60" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">success =</span> T</span>
<span id="cb392-61"><a href="#cb392-61" aria-hidden="true" tabindex="-1"></a>                                                 ))</span>
<span id="cb392-62"><a href="#cb392-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 1"
[1] "Time points: 5, 10, 15"
[1] "AIC: 242713.4"
[1] "Cox ZPH: 346.5879"
[1] "iteration: 1.1"
[1] "Time points: 5.5, 11, 16.5"
[1] "AIC: 242719.6"
[1] "Cox ZPH: 326.4351"
[1] "iteration: 1.2"
[1] "Time points: 6, 12, 18"
[1] "AIC: 242716.7"
[1] "Cox ZPH: 322.6523"
[1] "iteration: 1.3"
[1] "Time points: 6.5, 13, 19.5"
[1] "AIC: 242727.5"
[1] "Cox ZPH: 323.4345"
[1] "iteration: 1.4"
[1] "Time points: 7, 14, 21"
[1] "AIC: 242733.8"
[1] "Cox ZPH: 337.7665"
[1] "iteration: 1.5"
[1] "Time points: 7.5, 15, 22.5"
[1] "AIC: 242738.1"
[1] "Cox ZPH: 364.8138"
[1] "iteration: 1.6"
[1] "Time points: 8, 16, 24"
[1] "AIC: 242739.8"
[1] "Cox ZPH: 379.663"
[1] "iteration: 1.7"
[1] "Time points: 8.5, 17, 25.5"
[1] "AIC: 242740.4"
[1] "Cox ZPH: 406.437"
[1] "iteration: 1.8"
[1] "Time points: 9, 18, 27"
[1] "AIC: 242739.5"
[1] "Cox ZPH: 419.1016"
[1] "iteration: 1.9"
[1] "Time points: 9.5, 19, 28.5"
[1] "AIC: 242737.2"
[1] "Cox ZPH: 434.1251"
[1] "iteration: 2"
[1] "Time points: 10, 20, 30"
[1] "AIC: 242733"
[1] "Cox ZPH: 442.814"
[1] "iteration: 2.1"
[1] "Time points: 10.5, 21, 31.5"
[1] "AIC: 242730"
[1] "Cox ZPH: 420.1959"
[1] "iteration: 2.2"
[1] "Time points: 11, 22, 33"
[1] "AIC: 242719.9"
[1] "Cox ZPH: 405.4619"
[1] "iteration: 2.3"
[1] "Time points: 11.5, 23, 34.5"
[1] "AIC: 242715.8"
[1] "Cox ZPH: 382.8406"
[1] "iteration: 2.4"
[1] "Time points: 12, 24, 36"
[1] "AIC: 242713.8"
[1] "Cox ZPH: 361.1335"
[1] "iteration: 2.5"
[1] "Time points: 12.5, 25, 37.5"
[1] "AIC: 242714.2"
[1] "Cox ZPH: 338.2163"
[1] "iteration: 2.6"
[1] "Time points: 13, 26, 39"
[1] "AIC: 242714.9"
[1] "Cox ZPH: 323.4996"
[1] "iteration: 2.7"
[1] "Time points: 13.5, 27, 40.5"
[1] "AIC: 242718.1"
[1] "Cox ZPH: 322.4792"
[1] "iteration: 2.8"
[1] "Time points: 14, 28, 42"
[1] "AIC: 242722.4"
[1] "Cox ZPH: 333.2702"
[1] "iteration: 2.9"
[1] "Time points: 14.5, 29, 43.5"
[1] "AIC: 242727"
[1] "Cox ZPH: 359.1076"
[1] "iteration: 3"
[1] "Time points: 15, 30, 45"
[1] "AIC: 242731.8"
[1] "Cox ZPH: 408.2805"
[1] "iteration: 3.1"
[1] "Time points: 15.5, 31, 46.5"
[1] "AIC: 242735.1"
[1] "Cox ZPH: 475.1458"
[1] "iteration: 3.2"
[1] "Time points: 16, 32, 48"
[1] "AIC: 242739"
[1] "Cox ZPH: 548.163"
[1] "iteration: 3.3"
[1] "Time points: 16.5, 33, 49.5"
[1] "AIC: 242740.2"
[1] "Cox ZPH: 628.4228"
[1] "iteration: 3.4"
[1] "Time points: 17, 34, 51"
[1] "AIC: 242740.2"
[1] "Cox ZPH: 715.4628"
[1] "iteration: 3.5"
[1] "Time points: 17.5, 35, 52.5"
[1] "AIC: 242738.7"
[1] "Cox ZPH: 801.7517"
[1] "iteration: 3.6"
[1] "Time points: 18, 36, 54"
[1] "AIC: 242734.7"
[1] "Cox ZPH: 899.7736"
[1] "iteration: 3.7"
[1] "Time points: 18.5, 37, 55.5"
[1] "AIC: 242731.9"
[1] "Cox ZPH: 982.7124"
[1] "iteration: 3.8"
[1] "Time points: 19, 38, 57"
[1] "AIC: 242723.8"
[1] "Cox ZPH: 1115.342"
[1] "iteration: 3.9"
[1] "Time points: 19.5, 39, 58.5"
[1] "AIC: 242713.1"
[1] "Cox ZPH: 1233.031"
[1] "iteration: 4"
[1] "Time points: 20, 40, 60"
[1] "AIC: 242698.8"
[1] "Cox ZPH: 1364.041"
[1] "iteration: 4.1"
[1] "Time points: 20.5, 41, 61.5"
[1] "AIC: 242688.1"
[1] "Cox ZPH: 1463.879"
[1] "iteration: 4.2"
[1] "Time points: 21, 42, 63"
[1] "AIC: 242672.2"
[1] "Cox ZPH: 1584.966"
[1] "iteration: 4.3"
[1] "Time points: 21.5, 43, 64.5"
[1] "AIC: 242659.5"
[1] "Cox ZPH: 1694.048"
[1] "iteration: 4.4"
[1] "Time points: 22, 44, 66"
[1] "AIC: 242631.3"
[1] "Cox ZPH: 1785.864"
[1] "iteration: 4.5"
[1] "Time points: 22.5, 45, 67.5"
[1] "AIC: 242619.1"
[1] "Cox ZPH: 1860.616"
[1] "iteration: 4.6"
[1] "Time points: 23, 46, 69"
[1] "AIC: 242597.9"
[1] "Cox ZPH: 1920.634"
[1] "iteration: 4.7"
[1] "Time points: 23.5, 47, 70.5"
[1] "AIC: 242583"
[1] "Cox ZPH: 2004.666"
[1] "iteration: 4.8"
[1] "Time points: 24, 48, 72"
[1] "AIC: 242566.1"
[1] "Cox ZPH: 2109.5"
[1] "iteration: 4.9"
[1] "Time points: 24.5, 49, 73.5"
[1] "AIC: 242550.8"
[1] "Cox ZPH: 2180.038"
[1] "iteration: 5"
[1] "Time points: 25, 50, 75"
[1] "AIC: 242534.7"
[1] "Cox ZPH: 2241.884"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>results_susinidum_oh2_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2_alt<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                            spec      aic  cox_zph success
18 iteration: 2.7; change points: 13.5, 27, 40.5 242718.1 322.4792    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                             spec      aic cox_zph success</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 18 iteration: 2.7; change points: 13.5, 27, 40.5 242706.4  322.13    TRUE</span></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The minimum of the previous model: "</span>,</span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table), <span class="dv">1</span>]),</span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_susinidum_oh2_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_susinidum_oh2_alt<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb396-7"><a href="#cb396-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The minimum of the previous model: 317.7125 vs.&nbsp;the minimum model: 322.4792</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The minimum of the first modified model: 321.3004 vs. the minimum model: 328.8011</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsens. We do not integrate this model"</span>)</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Analyse the violation of proportional hazards"</span>)</span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb397-9"><a href="#cb397-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb397-10"><a href="#cb397-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-11"><a href="#cb397-11" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">dev.off</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>null device 
          1 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>z_240422_6_2_restr <span class="ot">&lt;-</span> <span class="fu">loess</span>(res240422_6_restr[,<span class="st">"psycom_dum_with"</span>] <span class="sc">~</span> time240422_6_restr, <span class="at">span=</span><span class="fl">0.50</span>)   <span class="co"># residuals </span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time240422_6_restr, <span class="fu">fitted</span>(z_240422_6_2_restr))</span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">supsmu</span>(time240422_6_restr, res240422_6_restr[,<span class="st">"psycom_dum_with"</span>]),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Sch. res., psycom_dum_with"</span>)</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)[<span class="fu">which</span>(<span class="fu">attr</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt<span class="sc">$</span>coefficients, <span class="st">"names"</span>) <span class="sc">==</span> <span class="st">"psycom_dum_with"</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">main=</span> <span class="st">"Residuals of psycom_dum_with"</span>)</span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt<span class="sc">$</span>coefficients[<span class="st">"psycom_dum_with"</span>], <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend=</span> <span class="fu">c</span>(<span class="st">"Reference line for the null effect"</span>, <span class="st">"Average hazard over time"</span>, <span class="st">"Time-varying hazard"</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb399-12"><a href="#cb399-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-13"><a href="#cb399-13" aria-hidden="true" tabindex="-1"></a>km_psycom_dum_with <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span> psycom_dum_with<span class="sc">+</span> </span>
<span id="cb399-14"><a href="#cb399-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cluster</span>(id), <span class="at">data =</span> data_mine_miss_restr_proc2)</span>
<span id="cb399-15"><a href="#cb399-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(km_psycom_dum_with, <span class="at">fun =</span> <span class="st">"cloglog"</span>, <span class="at">xlab =</span> <span class="st">"Time (in days) using log"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">ylab =</span> <span class="st">"log-log survival"</span>, <span class="at">main =</span> <span class="st">"log-log curves by psycom_dum_with"</span>)</span>
<span id="cb399-16"><a href="#cb399-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"=0"</span>, <span class="st">"=1"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">bg =</span> <span class="st">"transparent"</span>)</span>
<span id="cb399-17"><a href="#cb399-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-18"><a href="#cb399-18" aria-hidden="true" tabindex="-1"></a>recorded_plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>() </span>
<span id="cb399-19"><a href="#cb399-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-20"><a href="#cb399-20" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb399-21"><a href="#cb399-21" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb399-22"><a href="#cb399-22" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb399-23"><a href="#cb399-23" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"zph/proportionallity_psycom_dum_with_restr.png"</span>), <span class="at">height=</span><span class="dv">13</span>, <span class="at">width=</span><span class="dv">10</span>, <span class="at">res=</span><span class="dv">500</span>, <span class="at">units=</span><span class="st">"in"</span>) </span>
<span id="cb399-24"><a href="#cb399-24" aria-hidden="true" tabindex="-1"></a>recorded_plot</span>
<span id="cb399-25"><a href="#cb399-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>pdf 
  2 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Now with Initial substance: Alcohol"</span>)</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>results_psycom_dum_with <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-7"><a href="#cb401-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(.<span class="dv">1</span>,<span class="fl">1.5</span>,.<span class="dv">025</span>)) {</span>
<span id="cb401-8"><a href="#cb401-8" aria-hidden="true" tabindex="-1"></a>  tvcs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">80</span>)<span class="sc">*</span>i</span>
<span id="cb401-9"><a href="#cb401-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb401-10"><a href="#cb401-10" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>psycom_dum_with_rec<span class="ot">&lt;-</span></span>
<span id="cb401-11"><a href="#cb401-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_time_varying_effect</span>(data_mine_miss_restr_proc2<span class="sc">$</span>psycom_dum_with, </span>
<span id="cb401-12"><a href="#cb401-12" aria-hidden="true" tabindex="-1"></a>                               data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb401-13"><a href="#cb401-13" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">1</span>],</span>
<span id="cb401-14"><a href="#cb401-14" aria-hidden="true" tabindex="-1"></a>                               tvcs[<span class="dv">2</span>],</span>
<span id="cb401-15"><a href="#cb401-15" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time))</span>
<span id="cb401-16"><a href="#cb401-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-17"><a href="#cb401-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with<span class="ot">&lt;-</span></span>
<span id="cb401-18"><a href="#cb401-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb401-19"><a href="#cb401-19" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb401-20"><a href="#cb401-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb401-21"><a href="#cb401-21" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb401-22"><a href="#cb401-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb401-23"><a href="#cb401-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb401-24"><a href="#cb401-24" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb401-25"><a href="#cb401-25" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb401-26"><a href="#cb401-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb401-27"><a href="#cb401-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec2 +</span></span>
<span id="cb401-28"><a href="#cb401-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh +</span></span>
<span id="cb401-29"><a href="#cb401-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb401-30"><a href="#cb401-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb401-31"><a href="#cb401-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with_rec +</span></span>
<span id="cb401-32"><a href="#cb401-32" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb401-33"><a href="#cb401-33" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb401-34"><a href="#cb401-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb401-35"><a href="#cb401-35" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb401-36"><a href="#cb401-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb401-37"><a href="#cb401-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb401-38"><a href="#cb401-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb401-39"><a href="#cb401-39" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb401-40"><a href="#cb401-40" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb401-41"><a href="#cb401-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb401-42"><a href="#cb401-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb401-43"><a href="#cb401-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb401-44"><a href="#cb401-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb401-45"><a href="#cb401-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with)</span>
<span id="cb401-46"><a href="#cb401-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb401-47"><a href="#cb401-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb401-48"><a href="#cb401-48" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb401-49"><a href="#cb401-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]))</span>
<span id="cb401-50"><a href="#cb401-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb401-51"><a href="#cb401-51" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb401-52"><a href="#cb401-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb401-53"><a href="#cb401-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb401-54"><a href="#cb401-54" aria-hidden="true" tabindex="-1"></a>  results_psycom_dum_with <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_psycom_dum_with, </span>
<span id="cb401-55"><a href="#cb401-55" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">cbind.data.frame</span>(</span>
<span id="cb401-56"><a href="#cb401-56" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; tvcs: "</span>, tvcs[<span class="dv">1</span>],<span class="st">", "</span>, tvcs[<span class="dv">2</span>]), </span>
<span id="cb401-57"><a href="#cb401-57" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">aic =</span> aic_iter,</span>
<span id="cb401-58"><a href="#cb401-58" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb401-59"><a href="#cb401-59" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">success =</span> T</span>
<span id="cb401-60"><a href="#cb401-60" aria-hidden="true" tabindex="-1"></a>                                             ))</span>
<span id="cb401-61"><a href="#cb401-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 0.1"
[1] "Time points: 2, 8"
[1] "AIC: 241851.2"
[1] "Cox ZPH: 1883.112"
[1] "iteration: 0.125"
[1] "Time points: 2.5, 10"
[1] "AIC: 241793.5"
[1] "Cox ZPH: 2047.944"
[1] "iteration: 0.15"
[1] "Time points: 3, 12"
[1] "AIC: 241741.1"
[1] "Cox ZPH: 2185.512"
[1] "iteration: 0.175"
[1] "Time points: 3.5, 14"
[1] "AIC: 241695.6"
[1] "Cox ZPH: 2289.825"
[1] "iteration: 0.2"
[1] "Time points: 4, 16"
[1] "AIC: 241659.1"
[1] "Cox ZPH: 2351.071"
[1] "iteration: 0.225"
[1] "Time points: 4.5, 18"
[1] "AIC: 241631.3"
[1] "Cox ZPH: 2370.834"
[1] "iteration: 0.25"
[1] "Time points: 5, 20"
[1] "AIC: 241612.3"
[1] "Cox ZPH: 2350.685"
[1] "iteration: 0.275"
[1] "Time points: 5.5, 22"
[1] "AIC: 241606.1"
[1] "Cox ZPH: 2272.468"
[1] "iteration: 0.3"
[1] "Time points: 6, 24"
[1] "AIC: 241612.6"
[1] "Cox ZPH: 2133.379"
[1] "iteration: 0.325"
[1] "Time points: 6.5, 26"
[1] "AIC: 241629.3"
[1] "Cox ZPH: 1950.946"
[1] "iteration: 0.35"
[1] "Time points: 7, 28"
[1] "AIC: 241658.1"
[1] "Cox ZPH: 1722"
[1] "iteration: 0.375"
[1] "Time points: 7.5, 30"
[1] "AIC: 241699.2"
[1] "Cox ZPH: 1448.429"
[1] "iteration: 0.4"
[1] "Time points: 8, 32"
[1] "AIC: 241749.9"
[1] "Cox ZPH: 1153.775"
[1] "iteration: 0.425"
[1] "Time points: 8.5, 34"
[1] "AIC: 241808.6"
[1] "Cox ZPH: 864.9711"
[1] "iteration: 0.45"
[1] "Time points: 9, 36"
[1] "AIC: 241873.7"
[1] "Cox ZPH: 612.0001"
[1] "iteration: 0.475"
[1] "Time points: 9.5, 38"
[1] "AIC: 241944.7"
[1] "Cox ZPH: 428.4835"
[1] "iteration: 0.5"
[1] "Time points: 10, 40"
[1] "AIC: 242017.1"
[1] "Cox ZPH: 355.5976"
[1] "iteration: 0.525"
[1] "Time points: 10.5, 42"
[1] "AIC: 242092.7"
[1] "Cox ZPH: 414.2425"
[1] "iteration: 0.55"
[1] "Time points: 11, 44"
[1] "AIC: 242169.9"
[1] "Cox ZPH: 617.0852"
[1] "iteration: 0.575"
[1] "Time points: 11.5, 46"
[1] "AIC: 242247.3"
[1] "Cox ZPH: 957.8698"
[1] "iteration: 0.6"
[1] "Time points: 12, 48"
[1] "AIC: 242323"
[1] "Cox ZPH: 1409.342"
[1] "iteration: 0.625"
[1] "Time points: 12.5, 50"
[1] "AIC: 242398.4"
[1] "Cox ZPH: 1950.015"
[1] "iteration: 0.65"
[1] "Time points: 13, 52"
[1] "AIC: 242471.1"
[1] "Cox ZPH: 2532.404"
[1] "iteration: 0.675"
[1] "Time points: 13.5, 54"
[1] "AIC: 242538.1"
[1] "Cox ZPH: 3100.883"
[1] "iteration: 0.7"
[1] "Time points: 14, 56"
[1] "AIC: 242599"
[1] "Cox ZPH: 3619.677"
[1] "iteration: 0.725"
[1] "Time points: 14.5, 58"
[1] "AIC: 242651.6"
[1] "Cox ZPH: 4060.109"
[1] "iteration: 0.75"
[1] "Time points: 15, 60"
[1] "AIC: 242694.7"
[1] "Cox ZPH: 4405.333"
[1] "iteration: 0.775"
[1] "Time points: 15.5, 62"
[1] "AIC: 242727.3"
[1] "Cox ZPH: 4647.372"
[1] "iteration: 0.8"
[1] "Time points: 16, 64"
[1] "AIC: 242747.8"
[1] "Cox ZPH: 4790.599"
[1] "iteration: 0.825"
[1] "Time points: 16.5, 66"
[1] "AIC: 242754.7"
[1] "Cox ZPH: 4840.749"
[1] "iteration: 0.85"
[1] "Time points: 17, 68"
[1] "AIC: 242746.9"
[1] "Cox ZPH: 4814.885"
[1] "iteration: 0.875"
[1] "Time points: 17.5, 70"
[1] "AIC: 242723.5"
[1] "Cox ZPH: 4725.884"
[1] "iteration: 0.9"
[1] "Time points: 18, 72"
[1] "AIC: 242683.9"
[1] "Cox ZPH: 4587.648"
[1] "iteration: 0.925"
[1] "Time points: 18.5, 74"
[1] "AIC: 242628.3"
[1] "Cox ZPH: 4412.073"
[1] "iteration: 0.95"
[1] "Time points: 19, 76"
[1] "AIC: 242556"
[1] "Cox ZPH: 4211.442"
[1] "iteration: 0.975"
[1] "Time points: 19.5, 78"
[1] "AIC: 242466.1"
[1] "Cox ZPH: 3995.497"
[1] "iteration: 1"
[1] "Time points: 20, 80"
[1] "AIC: 242357.4"
[1] "Cox ZPH: 3766.605"
[1] "iteration: 1.025"
[1] "Time points: 20.5, 82"
[1] "AIC: 242230.8"
[1] "Cox ZPH: 3532.535"
[1] "iteration: 1.05"
[1] "Time points: 21, 84"
[1] "AIC: 242086.1"
[1] "Cox ZPH: 3296.79"
[1] "iteration: 1.075"
[1] "Time points: 21.5, 86"
[1] "AIC: 241928.2"
[1] "Cox ZPH: 3068.773"
[1] "iteration: 1.1"
[1] "Time points: 22, 88"
[1] "AIC: 241757.4"
[1] "Cox ZPH: 2846.697"
[1] "iteration: 1.125"
[1] "Time points: 22.5, 90"
[1] "AIC: 241572.4"
[1] "Cox ZPH: 2629.15"
[1] "iteration: 1.15"
[1] "Time points: 23, 92"
[1] "AIC: 241374.5"
[1] "Cox ZPH: 2418.478"
[1] "iteration: 1.175"
[1] "Time points: 23.5, 94"
[1] "AIC: 241169.8"
[1] "Cox ZPH: 2218.64"
[1] "iteration: 1.2"
[1] "Time points: 24, 96"
[1] "AIC: 240956.5"
[1] "Cox ZPH: 2028.07"
[1] "iteration: 1.225"
[1] "Time points: 24.5, 98"
[1] "AIC: 240741.7"
[1] "Cox ZPH: 1853.869"
[1] "iteration: 1.25"
[1] "Time points: 25, 100"
[1] "AIC: 240521.7"
[1] "Cox ZPH: 1687.786"
[1] "iteration: 1.275"
[1] "Time points: 25.5, 102"
[1] "AIC: 240296.6"
[1] "Cox ZPH: 1534.548"
[1] "iteration: 1.3"
[1] "Time points: 26, 104"
[1] "AIC: 240084.3"
[1] "Cox ZPH: 1405.457"
[1] "iteration: 1.325"
[1] "Time points: 26.5, 106"
[1] "AIC: 239877.9"
[1] "Cox ZPH: 1295.962"
[1] "iteration: 1.35"
[1] "Time points: 27, 108"
[1] "AIC: 239675.8"
[1] "Cox ZPH: 1208.163"
[1] "iteration: 1.375"
[1] "Time points: 27.5, 110"
[1] "AIC: 239479.2"
[1] "Cox ZPH: 1148.109"
[1] "iteration: 1.4"
[1] "Time points: 28, 112"
[1] "AIC: 239290.5"
[1] "Cox ZPH: 1123.353"
[1] "iteration: 1.425"
[1] "Time points: 28.5, 114"
[1] "AIC: 239120.8"
[1] "Cox ZPH: 1142.212"
[1] "iteration: 1.45"
[1] "Time points: 29, 116"
[1] "AIC: 238980.7"
[1] "Cox ZPH: 1210.523"
[1] "iteration: 1.475"
[1] "Time points: 29.5, 118"
[1] "AIC: 238863.6"
[1] "Cox ZPH: 1343.285"
[1] "iteration: 1.5"
[1] "Time points: 30, 120"
[1] "AIC: 238771.2"
[1] "Cox ZPH: 1582.226"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>results_psycom_dum_with[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           spec      aic  cox_zph success
17 iteration: 0.5; tvcs: 10, 40 242017.1 355.5976    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                            spec      aic  cox_zph success</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 17 iteration: 0.5; tvcs: 10, 40 242005.3 355.3837    TRUE</span></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The previously modified model: "</span>,</span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table), <span class="dv">1</span>],<span class="dv">1</span>),</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_psycom_dum_with[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The previously modified model: 317.7 vs.&nbsp;the minimum model: 355.5976</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The previously modified model: 317.4 vs. the minimum model: 355.3837</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen"</span>)</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(splines)</span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a>specs_psycom_dum_with_rec <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"psycom_dum_with *"</span>, <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log(time+0.001)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 3)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 4)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 5)"</span>, <span class="st">"poly(ifelse(is.na(time), .001,time), 6)"</span>, <span class="st">"pspline(log(time+0.001), df=3)"</span>, <span class="st">"pspline(log(time+0.001), df=4)"</span>, <span class="st">"pspline(log(time+0.001), df=5)"</span>, <span class="st">"pspline(log(time+0.001), df=6)"</span>, <span class="st">"bs(time, 3)"</span>, <span class="st">"bs(time, 4)"</span>, <span class="st">"bs(time, 5)"</span>, <span class="st">"bs(time, 6)"</span>, <span class="st">"ns(time, 3)"</span>, <span class="st">"ns(time, 4)"</span>, <span class="st">"ns(time, 5)"</span>, <span class="st">"ns(time, 6)"</span>, <span class="st">"rcs(time, 3)"</span>, <span class="st">"rcs(time, 4)"</span>, <span class="st">"rcs(time, 5)"</span>, <span class="st">"rcs(time, 6)"</span>))</span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a>results_psycom_dum_with_rec <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb406-11"><a href="#cb406-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb406-12"><a href="#cb406-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(specs_psycom_dum_with_rec)) {</span>
<span id="cb406-13"><a href="#cb406-13" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> specs_psycom_dum_with_rec[i]</span>
<span id="cb406-14"><a href="#cb406-14" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb406-15"><a href="#cb406-15" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb406-16"><a href="#cb406-16" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb406-17"><a href="#cb406-17" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb406-18"><a href="#cb406-18" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb406-19"><a href="#cb406-19" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb406-20"><a href="#cb406-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb406-21"><a href="#cb406-21" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb406-22"><a href="#cb406-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb406-23"><a href="#cb406-23" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb406-24"><a href="#cb406-24" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb406-25"><a href="#cb406-25" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec2 +</span></span>
<span id="cb406-26"><a href="#cb406-26" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh +</span></span>
<span id="cb406-27"><a href="#cb406-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb406-28"><a href="#cb406-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb406-29"><a href="#cb406-29" aria-hidden="true" tabindex="-1"></a><span class="st">            I(round("</span>,l,<span class="st">",2)) +</span></span>
<span id="cb406-30"><a href="#cb406-30" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb406-31"><a href="#cb406-31" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb406-32"><a href="#cb406-32" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb406-33"><a href="#cb406-33" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb406-34"><a href="#cb406-34" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb406-35"><a href="#cb406-35" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb406-36"><a href="#cb406-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb406-37"><a href="#cb406-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb406-38"><a href="#cb406-38" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb406-39"><a href="#cb406-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb406-40"><a href="#cb406-40" aria-hidden="true" tabindex="-1"></a>                   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_lag_dias_treat_imp_sin_na_rec =</span> <span class="fu">bs</span>(log_lag_dias_treat_imp_sin_na, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb406-41"><a href="#cb406-41" aria-hidden="true" tabindex="-1"></a>                   data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb406-42"><a href="#cb406-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb406-43"><a href="#cb406-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb406-44"><a href="#cb406-44" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="fu">extractAIC</span>(model)[[<span class="dv">2</span>]]</span>
<span id="cb406-45"><a href="#cb406-45" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>]</span>
<span id="cb406-46"><a href="#cb406-46" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">TRUE</span> </span>
<span id="cb406-47"><a href="#cb406-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb406-48"><a href="#cb406-48" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb406-49"><a href="#cb406-49" aria-hidden="true" tabindex="-1"></a>    aic_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb406-50"><a href="#cb406-50" aria-hidden="true" tabindex="-1"></a>    cox_zph_val <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb406-51"><a href="#cb406-51" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb406-52"><a href="#cb406-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Error fitting specification "</span>, i, <span class="st">" ("</span>, l, <span class="st">"): "</span>, e))</span>
<span id="cb406-53"><a href="#cb406-53" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb406-54"><a href="#cb406-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb406-55"><a href="#cb406-55" aria-hidden="true" tabindex="-1"></a>  results_psycom_dum_with_rec <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_psycom_dum_with_rec, <span class="fu">data.frame</span>(<span class="at">spec =</span> l, <span class="at">aic =</span> aic_val, <span class="at">cox_zph =</span> cox_zph_val, <span class="at">success =</span> success))</span>
<span id="cb406-56"><a href="#cb406-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb406-57"><a href="#cb406-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Iteration:"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) <span class="co"># Add iteration number</span></span>
<span id="cb406-58"><a href="#cb406-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Spec: "</span>, l, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb406-59"><a href="#cb406-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"AIC: "</span>, results_psycom_dum_with_rec<span class="sc">$</span>aic[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) </span>
<span id="cb406-60"><a href="#cb406-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Cox zph test statistic: "</span>, results_psycom_dum_with_rec<span class="sc">$</span>cox_zph[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)))</span>
<span id="cb406-61"><a href="#cb406-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration: 1 
NULL
Spec:  psycom_dum_with *time 
NULL
AIC:  242073.646015772 
NULL
Cox zph test statistic:  1270.82638037256 
NULL
Iteration: 2 
NULL
Spec:  psycom_dum_with *log(time+0.001) 
NULL
AIC:  242679.202046089 
NULL
Cox zph test statistic:  495.282058112557 
NULL
Iteration: 3 
NULL
Spec:  psycom_dum_with *poly(ifelse(is.na(time), .001,time), 3) 
NULL
AIC:  241653.345412216 
NULL
Cox zph test statistic:  5532.18767068606 
NULL
Iteration: 4 
NULL
Spec:  psycom_dum_with *poly(ifelse(is.na(time), .001,time), 4) 
NULL
AIC:  241374.872334666 
NULL
Cox zph test statistic:  5845.6906904199 
NULL
Iteration: 5 
NULL
Spec:  psycom_dum_with *poly(ifelse(is.na(time), .001,time), 5) 
NULL
AIC:  241301.737606574 
NULL
Cox zph test statistic:  5895.95894768982 
NULL
Iteration: 6 
NULL
Spec:  psycom_dum_with *poly(ifelse(is.na(time), .001,time), 6) 
NULL
AIC:  241133.859850746 
NULL
Cox zph test statistic:  5814.08088848928 
NULL
Iteration: 7 
NULL
Spec:  psycom_dum_with *pspline(log(time+0.001), df=3) 
NULL
AIC:  241133.859850746 
NULL
Cox zph test statistic:  5814.08088848928 
NULL
Iteration: 8 
NULL
Spec:  psycom_dum_with *pspline(log(time+0.001), df=4) 
NULL
AIC:  241133.859850746 
NULL
Cox zph test statistic:  5814.08088848928 
NULL
Iteration: 9 
NULL
Spec:  psycom_dum_with *pspline(log(time+0.001), df=5) 
NULL
AIC:  241133.859850746 
NULL
Cox zph test statistic:  5814.08088848928 
NULL
Iteration: 10 
NULL
Spec:  psycom_dum_with *pspline(log(time+0.001), df=6) 
NULL
AIC:  241133.859850746 
NULL
Cox zph test statistic:  5814.08088848928 
NULL
Iteration: 11 
NULL
Spec:  psycom_dum_with *bs(time, 3) 
NULL
AIC:  240806.877886123 
NULL
Cox zph test statistic:  8350.2319648494 
NULL
Iteration: 12 
NULL
Spec:  psycom_dum_with *bs(time, 4) 
NULL
AIC:  237979.785769352 
NULL
Cox zph test statistic:  13977.8757470223 
NULL
Iteration: 13 
NULL
Spec:  psycom_dum_with *bs(time, 5) 
NULL
AIC:  237406.174681623 
NULL
Cox zph test statistic:  15528.301431604 
NULL
Iteration: 14 
NULL
Spec:  psycom_dum_with *bs(time, 6) 
NULL
AIC:  237229.627963973 
NULL
Cox zph test statistic:  16040.7359383214 
NULL
Iteration: 15 
NULL
Spec:  psycom_dum_with *ns(time, 3) 
NULL
AIC:  239286.89566843 
NULL
Cox zph test statistic:  11649.939360018 
NULL
Iteration: 16 
NULL
Spec:  psycom_dum_with *ns(time, 4) 
NULL
AIC:  237893.753000825 
NULL
Cox zph test statistic:  14575.1889880412 
NULL
Iteration: 17 
NULL
Spec:  psycom_dum_with *ns(time, 5) 
NULL
AIC:  237600.950385534 
NULL
Cox zph test statistic:  15639.9138673865 
NULL
Iteration: 18 
NULL
Spec:  psycom_dum_with *ns(time, 6) 
NULL
AIC:  237354.154406415 
NULL
Cox zph test statistic:  15735.8237332929 
NULL
Iteration: 19 
NULL
Spec:  psycom_dum_with *rcs(time, 3) 
NULL
AIC:  240998.015320773 
NULL
Cox zph test statistic:  7177.11023618446 
NULL
X matrix deemed to be singular; variable time'' 
Iteration: 20 
NULL
Spec:  psycom_dum_with *rcs(time, 4) 
NULL
AIC:  240998.015320773 
NULL
Cox zph test statistic:  7177.11023618446 
NULL
X matrix deemed to be singular; variable time'' time''' 
Iteration: 21 
NULL
Spec:  psycom_dum_with *rcs(time, 5) 
NULL
AIC:  240998.015320773 
NULL
Cox zph test statistic:  7177.11023618446 
NULL
X matrix deemed to be singular; variable time'' time''' 
Iteration: 22 
NULL
Spec:  psycom_dum_with *rcs(time, 6) 
NULL
AIC:  240998.015320773 
NULL
Cox zph test statistic:  7177.11023618446 
NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>results_psycom_dum_with_rec[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_rec<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_rec<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              spec      aic  cox_zph success
2 psycom_dum_with *log(time+0.001) 242679.2 495.2821    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                               spec      aic  cox_zph success</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 psycom_dum_with *log(time+0.001) 242667.5 494.8698    TRUE</span></span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsen. We do nothing"</span>)</span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a>results_psycom_dum_with_alt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">spec =</span> <span class="fu">character</span>(), <span class="at">aic =</span> <span class="fu">numeric</span>(), <span class="at">cox_zph =</span> <span class="fu">numeric</span>(), <span class="at">success =</span> <span class="fu">logical</span>())</span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,.<span class="dv">1</span>)) {</span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a>  change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span>i, <span class="dv">10</span><span class="sc">*</span>i, <span class="dv">15</span><span class="sc">*</span>i)  <span class="co"># Example change points (months)</span></span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb410-13"><a href="#cb410-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb410-14"><a href="#cb410-14" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>psycom_dum_with_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb410-15"><a href="#cb410-15" aria-hidden="true" tabindex="-1"></a>                                                       psycom_dum_with<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb410-16"><a href="#cb410-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-17"><a href="#cb410-17" aria-hidden="true" tabindex="-1"></a>  model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt<span class="ot">&lt;-</span></span>
<span id="cb410-18"><a href="#cb410-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event==1)~ </span></span>
<span id="cb410-19"><a href="#cb410-19" aria-hidden="true" tabindex="-1"></a><span class="st">            cluster(id)+ </span></span>
<span id="cb410-20"><a href="#cb410-20" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_tr_outcome_rec +</span></span>
<span id="cb410-21"><a href="#cb410-21" aria-hidden="true" tabindex="-1"></a><span class="st">            log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb410-22"><a href="#cb410-22" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_less_90d_tr1_rec+</span></span>
<span id="cb410-23"><a href="#cb410-23" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_comp_bpsc_y3_severe_rec + </span></span>
<span id="cb410-24"><a href="#cb410-24" aria-hidden="true" tabindex="-1"></a><span class="st">            lag_policonsumo2 + </span></span>
<span id="cb410-25"><a href="#cb410-25" aria-hidden="true" tabindex="-1"></a><span class="st">            edad_al_ing_1 + </span></span>
<span id="cb410-26"><a href="#cb410-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ano_nac_corr + </span></span>
<span id="cb410-27"><a href="#cb410-27" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_coc_rec2 +</span></span>
<span id="cb410-28"><a href="#cb410-28" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_oh +</span></span>
<span id="cb410-29"><a href="#cb410-29" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_pbc +</span></span>
<span id="cb410-30"><a href="#cb410-30" aria-hidden="true" tabindex="-1"></a><span class="st">            susinidum_mar +</span></span>
<span id="cb410-31"><a href="#cb410-31" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_with_rec2 +</span></span>
<span id="cb410-32"><a href="#cb410-32" aria-hidden="true" tabindex="-1"></a><span class="st">            psycom_dum_study + </span></span>
<span id="cb410-33"><a href="#cb410-33" aria-hidden="true" tabindex="-1"></a><span class="st">            freq_cons_dum_5day +</span></span>
<span id="cb410-34"><a href="#cb410-34" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_2inact +</span></span>
<span id="cb410-35"><a href="#cb410-35" aria-hidden="true" tabindex="-1"></a><span class="st">            cond_oc_dum_3unemp +</span></span>
<span id="cb410-36"><a href="#cb410-36" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_oh +</span></span>
<span id="cb410-37"><a href="#cb410-37" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_coc +</span></span>
<span id="cb410-38"><a href="#cb410-38" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_pbc +</span></span>
<span id="cb410-39"><a href="#cb410-39" aria-hidden="true" tabindex="-1"></a><span class="st">            susprindum_mar+</span></span>
<span id="cb410-40"><a href="#cb410-40" aria-hidden="true" tabindex="-1"></a><span class="st">            strat(tipo_de_plan_2_mod)"</span>)), </span>
<span id="cb410-41"><a href="#cb410-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb410-42"><a href="#cb410-42" aria-hidden="true" tabindex="-1"></a>          data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb410-43"><a href="#cb410-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb410-44"><a href="#cb410-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb410-45"><a href="#cb410-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt)</span>
<span id="cb410-46"><a href="#cb410-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="st">""</span>)</span>
<span id="cb410-47"><a href="#cb410-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i))</span>
<span id="cb410-48"><a href="#cb410-48" aria-hidden="true" tabindex="-1"></a>  aic_iter <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">extractAIC</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt)[[<span class="dv">2</span>]],<span class="dv">1</span>)</span>
<span id="cb410-49"><a href="#cb410-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb410-50"><a href="#cb410-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"Time points: "</span>,change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]))</span>
<span id="cb410-51"><a href="#cb410-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">"AIC: "</span>, aic_iter))</span>
<span id="cb410-52"><a href="#cb410-52" aria-hidden="true" tabindex="-1"></a>  cox_zph_iter <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb410-53"><a href="#cb410-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Cox ZPH: "</span>, cox_zph_iter))</span>
<span id="cb410-54"><a href="#cb410-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb410-55"><a href="#cb410-55" aria-hidden="true" tabindex="-1"></a>  results_psycom_dum_with_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(results_psycom_dum_with_alt, </span>
<span id="cb410-56"><a href="#cb410-56" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">cbind.data.frame</span>(</span>
<span id="cb410-57"><a href="#cb410-57" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">spec =</span> <span class="fu">paste0</span>(<span class="st">"iteration: "</span>,i, <span class="st">"; change points: "</span>, change_points[<span class="dv">1</span>],<span class="st">", "</span>, change_points[<span class="dv">2</span>], <span class="st">", "</span>,change_points[<span class="dv">3</span>]), </span>
<span id="cb410-58"><a href="#cb410-58" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">aic =</span> aic_iter,</span>
<span id="cb410-59"><a href="#cb410-59" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">cox_zph =</span> cox_zph_iter,</span>
<span id="cb410-60"><a href="#cb410-60" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">success =</span> T</span>
<span id="cb410-61"><a href="#cb410-61" aria-hidden="true" tabindex="-1"></a>                                                 ))</span>
<span id="cb410-62"><a href="#cb410-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "iteration: 1"
[1] "Time points: 5, 10, 15"
[1] "AIC: 242751.2"
[1] "Cox ZPH: 328.9806"
[1] "iteration: 1.1"
[1] "Time points: 5.5, 11, 16.5"
[1] "AIC: 242750.6"
[1] "Cox ZPH: 320.86"
[1] "iteration: 1.2"
[1] "Time points: 6, 12, 18"
[1] "AIC: 242750.2"
[1] "Cox ZPH: 315.1147"
[1] "iteration: 1.3"
[1] "Time points: 6.5, 13, 19.5"
[1] "AIC: 242747.3"
[1] "Cox ZPH: 308.1648"
[1] "iteration: 1.4"
[1] "Time points: 7, 14, 21"
[1] "AIC: 242746.4"
[1] "Cox ZPH: 306.6321"
[1] "iteration: 1.5"
[1] "Time points: 7.5, 15, 22.5"
[1] "AIC: 242745.3"
[1] "Cox ZPH: 306.8176"
[1] "iteration: 1.6"
[1] "Time points: 8, 16, 24"
[1] "AIC: 242742.7"
[1] "Cox ZPH: 307.9781"
[1] "iteration: 1.7"
[1] "Time points: 8.5, 17, 25.5"
[1] "AIC: 242739.7"
[1] "Cox ZPH: 310.7349"
[1] "iteration: 1.8"
[1] "Time points: 9, 18, 27"
[1] "AIC: 242740.6"
[1] "Cox ZPH: 311.398"
[1] "iteration: 1.9"
[1] "Time points: 9.5, 19, 28.5"
[1] "AIC: 242738.9"
[1] "Cox ZPH: 312.5175"
[1] "iteration: 2"
[1] "Time points: 10, 20, 30"
[1] "AIC: 242732.5"
[1] "Cox ZPH: 314.7717"
[1] "iteration: 2.1"
[1] "Time points: 10.5, 21, 31.5"
[1] "AIC: 242731.2"
[1] "Cox ZPH: 313.7358"
[1] "iteration: 2.2"
[1] "Time points: 11, 22, 33"
[1] "AIC: 242725.9"
[1] "Cox ZPH: 314.3701"
[1] "iteration: 2.3"
[1] "Time points: 11.5, 23, 34.5"
[1] "AIC: 242724.4"
[1] "Cox ZPH: 312.8812"
[1] "iteration: 2.4"
[1] "Time points: 12, 24, 36"
[1] "AIC: 242723"
[1] "Cox ZPH: 311.2805"
[1] "iteration: 2.5"
[1] "Time points: 12.5, 25, 37.5"
[1] "AIC: 242724.9"
[1] "Cox ZPH: 310.5611"
[1] "iteration: 2.6"
[1] "Time points: 13, 26, 39"
[1] "AIC: 242720.3"
[1] "Cox ZPH: 312.4336"
[1] "iteration: 2.7"
[1] "Time points: 13.5, 27, 40.5"
[1] "AIC: 242719.7"
[1] "Cox ZPH: 316.791"
[1] "iteration: 2.8"
[1] "Time points: 14, 28, 42"
[1] "AIC: 242719.8"
[1] "Cox ZPH: 325.1106"
[1] "iteration: 2.9"
[1] "Time points: 14.5, 29, 43.5"
[1] "AIC: 242724.8"
[1] "Cox ZPH: 336.6359"
[1] "iteration: 3"
[1] "Time points: 15, 30, 45"
[1] "AIC: 242727.3"
[1] "Cox ZPH: 351.6382"
[1] "iteration: 3.1"
[1] "Time points: 15.5, 31, 46.5"
[1] "AIC: 242730.9"
[1] "Cox ZPH: 372.395"
[1] "iteration: 3.2"
[1] "Time points: 16, 32, 48"
[1] "AIC: 242736.4"
[1] "Cox ZPH: 399.6994"
[1] "iteration: 3.3"
[1] "Time points: 16.5, 33, 49.5"
[1] "AIC: 242739.6"
[1] "Cox ZPH: 428.2439"
[1] "iteration: 3.4"
[1] "Time points: 17, 34, 51"
[1] "AIC: 242744.2"
[1] "Cox ZPH: 468.6018"
[1] "iteration: 3.5"
[1] "Time points: 17.5, 35, 52.5"
[1] "AIC: 242746.8"
[1] "Cox ZPH: 502.0081"
[1] "iteration: 3.6"
[1] "Time points: 18, 36, 54"
[1] "AIC: 242750"
[1] "Cox ZPH: 538.8976"
[1] "iteration: 3.7"
[1] "Time points: 18.5, 37, 55.5"
[1] "AIC: 242751.2"
[1] "Cox ZPH: 571.5965"
[1] "iteration: 3.8"
[1] "Time points: 19, 38, 57"
[1] "AIC: 242753.3"
[1] "Cox ZPH: 613.0588"
[1] "iteration: 3.9"
[1] "Time points: 19.5, 39, 58.5"
[1] "AIC: 242754.5"
[1] "Cox ZPH: 653.7076"
[1] "iteration: 4"
[1] "Time points: 20, 40, 60"
[1] "AIC: 242754.7"
[1] "Cox ZPH: 711.0753"
[1] "iteration: 4.1"
[1] "Time points: 20.5, 41, 61.5"
[1] "AIC: 242754.3"
[1] "Cox ZPH: 751.489"
[1] "iteration: 4.2"
[1] "Time points: 21, 42, 63"
[1] "AIC: 242752.7"
[1] "Cox ZPH: 801.2111"
[1] "iteration: 4.3"
[1] "Time points: 21.5, 43, 64.5"
[1] "AIC: 242750.3"
[1] "Cox ZPH: 852.915"
[1] "iteration: 4.4"
[1] "Time points: 22, 44, 66"
[1] "AIC: 242746.5"
[1] "Cox ZPH: 899.0964"
[1] "iteration: 4.5"
[1] "Time points: 22.5, 45, 67.5"
[1] "AIC: 242743.9"
[1] "Cox ZPH: 938.8631"
[1] "iteration: 4.6"
[1] "Time points: 23, 46, 69"
[1] "AIC: 242741.7"
[1] "Cox ZPH: 961.7692"
[1] "iteration: 4.7"
[1] "Time points: 23.5, 47, 70.5"
[1] "AIC: 242738.3"
[1] "Cox ZPH: 1000.855"
[1] "iteration: 4.8"
[1] "Time points: 24, 48, 72"
[1] "AIC: 242733.8"
[1] "Cox ZPH: 1045.778"
[1] "iteration: 4.9"
[1] "Time points: 24.5, 49, 73.5"
[1] "AIC: 242729.4"
[1] "Cox ZPH: 1075.742"
[1] "iteration: 5"
[1] "Time points: 25, 50, 75"
[1] "AIC: 242725.9"
[1] "Cox ZPH: 1113.625"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>results_psycom_dum_with_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_alt<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                      spec      aic  cox_zph success
5 iteration: 1.4; change points: 7, 14, 21 242746.4 306.6321    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       spec      aic  cox_zph success</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 iteration: 1.4; change points: 7, 14, 21 242734.7 306.2739    TRUE</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"The minimum of the previous model: "</span>,</span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">format</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt)<span class="sc">$</span>table), <span class="dv">1</span>]),</span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">" vs. the minimum model: "</span>,  results_psycom_dum_with_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span> <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_alt<span class="sc">$</span>cox_zph))),<span class="st">"cox_zph"</span>]</span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>The minimum of the previous model: 317.7125 vs.&nbsp;the minimum model: 306.6321</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The minimum of the previous model: 317.3692 vs. the minimum model: 306.2739</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It worsens. We do not integrate this model"</span>)</span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a>results_psycom_dum_with_alt[<span class="fu">which</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_alt<span class="sc">$</span>cox_zph)<span class="sc">==</span></span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">min</span>(<span class="fu">as.numeric</span>(results_psycom_dum_with_alt<span class="sc">$</span>cox_zph))),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                      spec      aic  cox_zph success
5 iteration: 1.4; change points: 7, 14, 21 242746.4 306.6321    TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>change_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)<span class="sc">*</span><span class="fl">1.4</span>  <span class="co"># Example change points (months)</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)  <span class="co"># Example coefficients</span></span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the time-varying coefficient to your model</span></span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>psycom_dum_with_rec2 <span class="ot">&lt;-</span> <span class="fu">with</span>(data_mine_miss_restr_proc2,</span>
<span id="cb417-6"><a href="#cb417-6" aria-hidden="true" tabindex="-1"></a>                                                     psycom_dum_with<span class="sc">*</span><span class="fu">time_varying_coeff</span>(time, change_points, coefficients))</span>
<span id="cb417-7"><a href="#cb417-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-8"><a href="#cb417-8" aria-hidden="true" tabindex="-1"></a>model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt<span class="ot">&lt;-</span></span>
<span id="cb417-9"><a href="#cb417-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span> </span>
<span id="cb417-10"><a href="#cb417-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb417-11"><a href="#cb417-11" aria-hidden="true" tabindex="-1"></a>            lag_tr_outcome_rec <span class="sc">+</span></span>
<span id="cb417-12"><a href="#cb417-12" aria-hidden="true" tabindex="-1"></a>            log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb417-13"><a href="#cb417-13" aria-hidden="true" tabindex="-1"></a>            lag_less_90d_tr1_rec<span class="sc">+</span></span>
<span id="cb417-14"><a href="#cb417-14" aria-hidden="true" tabindex="-1"></a>            lag_comp_bpsc_y3_severe_rec <span class="sc">+</span> </span>
<span id="cb417-15"><a href="#cb417-15" aria-hidden="true" tabindex="-1"></a>            lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb417-16"><a href="#cb417-16" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb417-17"><a href="#cb417-17" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb417-18"><a href="#cb417-18" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb417-19"><a href="#cb417-19" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb417-20"><a href="#cb417-20" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb417-21"><a href="#cb417-21" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb417-22"><a href="#cb417-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb417-23"><a href="#cb417-23" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb417-24"><a href="#cb417-24" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb417-25"><a href="#cb417-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb417-26"><a href="#cb417-26" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb417-27"><a href="#cb417-27" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb417-28"><a href="#cb417-28" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb417-29"><a href="#cb417-29" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb417-30"><a href="#cb417-30" aria-hidden="true" tabindex="-1"></a>            susprindum_mar<span class="sc">+</span></span>
<span id="cb417-31"><a href="#cb417-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">strat</span>(tipo_de_plan_2_mod), </span>
<span id="cb417-32"><a href="#cb417-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb417-33"><a href="#cb417-33" aria-hidden="true" tabindex="-1"></a>        data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb417-34"><a href="#cb417-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb417-35"><a href="#cb417-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-36"><a href="#cb417-36" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cox.zph</span>(model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt)<span class="sc">$</span>table,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 chisq df      p
lag_tr_outcome_rec             66.0738  1 0.0000
log_lag_dias_treat_imp_sin_na  10.3740  1 0.0013
lag_less_90d_tr1_rec           83.7240  1 0.0000
lag_comp_bpsc_y3_severe_rec    17.2145  1 0.0000
lag_policonsumo2                3.2530  1 0.0713
edad_al_ing_1                   0.1557  1 0.6931
ano_nac_corr                    5.1059  1 0.0238
susinidum_coc_rec2              2.9522  1 0.0858
susinidum_oh                   19.8355  1 0.0000
susinidum_pbc                   2.0732  1 0.1499
susinidum_mar                   6.7703  1 0.0093
psycom_dum_with_rec2            0.7582  1 0.3839
psycom_dum_study                1.4761  1 0.2244
freq_cons_dum_5day              0.0802  1 0.7770
cond_oc_dum_2inact              4.4838  1 0.0342
cond_oc_dum_3unemp              1.7238  1 0.1892
susprindum_oh                   4.4440  1 0.0350
susprindum_coc                  1.5636  1 0.2111
susprindum_pbc                  0.0418  1 0.8380
susprindum_mar                  5.2227  1 0.0223
GLOBAL                        306.6321 20 0.0000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  chisq df      p</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome_rec             66.1801  1 0.0000 ####</span></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na  10.2171  1 0.0014 #</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1_rec           83.7258  1 0.0000 ####</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe_rec    17.1686  1 0.0000 ####</span></span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                3.2220  1 0.0727</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                   0.1476  1 0.7008</span></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    5.1430  1 0.0233</span></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2              2.9413  1 0.0863</span></span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   19.6325  1 0.0000 ####</span></span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   1.9940  1 0.1579</span></span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                   6.7367  1 0.0094 #</span></span>
<span id="cb419-13"><a href="#cb419-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2            0.7771  1 0.3780</span></span>
<span id="cb419-14"><a href="#cb419-14" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                1.4873  1 0.2226</span></span>
<span id="cb419-15"><a href="#cb419-15" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              0.0522  1 0.8193</span></span>
<span id="cb419-16"><a href="#cb419-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              4.5082  1 0.0337</span></span>
<span id="cb419-17"><a href="#cb419-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp              1.6053  1 0.2051</span></span>
<span id="cb419-18"><a href="#cb419-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                   4.3562  1 0.0369</span></span>
<span id="cb419-19"><a href="#cb419-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  1.6009  1 0.2058</span></span>
<span id="cb419-20"><a href="#cb419-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                  0.0568  1 0.8117</span></span>
<span id="cb419-21"><a href="#cb419-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  5.2723  1 0.0217</span></span>
<span id="cb419-22"><a href="#cb419-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        306.2739 20 0.0000</span></span>
<span id="cb419-23"><a href="#cb419-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-24"><a href="#cb419-24" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb419-25"><a href="#cb419-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb419-26"><a href="#cb419-26" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Analyse the violation of proportional hazards"</span>)</span>
<span id="cb419-27"><a href="#cb419-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb419-28"><a href="#cb419-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="apply" class="level5">
<h5 class="anchored" data-anchor-id="apply">Apply</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"IIW"</span>)</span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a>levels_tipo_de_plan_2_mod <span class="ot">&lt;-</span><span class="fu">attr</span>(<span class="fu">table</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod),<span class="st">"name"</span>)</span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"model_restr_after_mod_not_log_lag_dias_treat_lag_less_90d_bpsc_severe_alt_tr_out_susinidum_coc_alt_psycom_dum_with_alt, make IIWs"</span>)</span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"basic ambulatory"</span>)</span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-13"><a href="#cb420-13" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_ba<span class="ot">&lt;-</span></span>
<span id="cb420-14"><a href="#cb420-14" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb420-15"><a href="#cb420-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb420-16"><a href="#cb420-16" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb420-17"><a href="#cb420-17" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb420-18"><a href="#cb420-18" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb420-19"><a href="#cb420-19" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb420-20"><a href="#cb420-20" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb420-21"><a href="#cb420-21" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb420-22"><a href="#cb420-22" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb420-23"><a href="#cb420-23" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb420-24"><a href="#cb420-24" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb420-25"><a href="#cb420-25" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb420-26"><a href="#cb420-26" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb420-27"><a href="#cb420-27" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb420-28"><a href="#cb420-28" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb420-29"><a href="#cb420-29" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb420-30"><a href="#cb420-30" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb420-31"><a href="#cb420-31" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb420-32"><a href="#cb420-32" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb420-33"><a href="#cb420-33" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb420-34"><a href="#cb420-34" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb420-35"><a href="#cb420-35" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb420-36"><a href="#cb420-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb420-37"><a href="#cb420-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb420-38"><a href="#cb420-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb420-39"><a href="#cb420-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb420-40"><a href="#cb420-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">1</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb420-41"><a href="#cb420-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb420-42"><a href="#cb420-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb420-43"><a href="#cb420-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb420-44"><a href="#cb420-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb420-45"><a href="#cb420-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb420-46"><a href="#cb420-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb420-47"><a href="#cb420-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb420-48"><a href="#cb420-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-49"><a href="#cb420-49" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"2024-05-02: problem with different values in people with plans (possibly imputed)"</span>)</span>
<span id="cb420-50"><a href="#cb420-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-51"><a href="#cb420-51" aria-hidden="true" tabindex="-1"></a>dis_run_w_more_type_plan<span class="ot">&lt;-</span></span>
<span id="cb420-52"><a href="#cb420-52" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> </span>
<span id="cb420-53"><a href="#cb420-53" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb420-54"><a href="#cb420-54" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">count_n_dis=</span><span class="fu">n_distinct</span>(tipo_de_plan_2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb420-55"><a href="#cb420-55" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(count_n_dis<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(id)</span>
<span id="cb420-56"><a href="#cb420-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-57"><a href="#cb420-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-58"><a href="#cb420-58" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_ba<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 13471, number of events= 9113 
   (880 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se       z
tr_outcome_rec.lag             0.170110  1.185436  0.055701  0.082986   2.050
log_dias_treat_imp_sin_na.lag -0.236237  0.789594  0.006277  0.022273 -10.606
less_90d_tr1_rec.lag          -0.112838  0.893295  0.070938  0.086272  -1.308
comp_bpsc_y3_severe_rec.lag    0.034013  1.034598  0.092579  0.074490   0.457
policonsumo2.lag              -0.636014  0.529398  0.025642  0.026439 -24.056
edad_al_ing_1                  0.039205  1.039984  0.005187  0.003358  11.675
ano_nac_corr                   0.044017  1.045000  0.005112  0.003333  13.207
susinidum_coc_rec2             0.166251  1.180869  0.082712  0.064699   2.570
susinidum_oh                   0.102885  1.108363  0.064329  0.049501   2.078
susinidum_pbc                 -0.016869  0.983272  0.076770  0.057891  -0.291
susinidum_mar                  0.097263  1.102151  0.065595  0.052648   1.847
psycom_dum_with_rec2           0.015614  1.015737  0.021836  0.014045   1.112
psycom_dum_study              -0.182551  0.833142  0.032157  0.030477  -5.990
freq_cons_dum_5day            -0.016709  0.983430  0.024123  0.020375  -0.820
cond_oc_dum_2inact            -0.002615  0.997388  0.033110  0.025535  -0.102
cond_oc_dum_3unemp             0.066169  1.068408  0.025464  0.017982   3.680
susprindum_oh                 -0.019388  0.980799  0.097556  0.059609  -0.325
susprindum_coc                 0.101071  1.106356  0.098804  0.060316   1.676
susprindum_pbc                 0.118128  1.125388  0.097381  0.060901   1.940
susprindum_mar                 0.122394  1.130199  0.103347  0.062593   1.955
                              Pr(&gt;|z|)    
tr_outcome_rec.lag            0.040377 *  
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
less_90d_tr1_rec.lag          0.190897    
comp_bpsc_y3_severe_rec.lag   0.647949    
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_coc_rec2            0.010181 *  
susinidum_oh                  0.037671 *  
susinidum_pbc                 0.770749    
susinidum_mar                 0.064684 .  
psycom_dum_with_rec2          0.266259    
psycom_dum_study               2.1e-09 ***
freq_cons_dum_5day            0.412174    
cond_oc_dum_2inact            0.918429    
cond_oc_dum_3unemp            0.000233 ***
susprindum_oh                 0.744993    
susprindum_coc                0.093799 .  
susprindum_pbc                0.052420 .  
susprindum_mar                0.050537 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               1.1854     0.8436    1.0075    1.3948
log_dias_treat_imp_sin_na.lag    0.7896     1.2665    0.7559    0.8248
less_90d_tr1_rec.lag             0.8933     1.1195    0.7543    1.0579
comp_bpsc_y3_severe_rec.lag      1.0346     0.9666    0.8941    1.1972
policonsumo2.lag                 0.5294     1.8889    0.5027    0.5576
edad_al_ing_1                    1.0400     0.9616    1.0332    1.0469
ano_nac_corr                     1.0450     0.9569    1.0382    1.0518
susinidum_coc_rec2               1.1809     0.8468    1.0402    1.3405
susinidum_oh                     1.1084     0.9022    1.0059    1.2213
susinidum_pbc                    0.9833     1.0170    0.8778    1.1014
susinidum_mar                    1.1022     0.9073    0.9941    1.2220
psycom_dum_with_rec2             1.0157     0.9845    0.9882    1.0441
psycom_dum_study                 0.8331     1.2003    0.7848    0.8844
freq_cons_dum_5day               0.9834     1.0168    0.9449    1.0235
cond_oc_dum_2inact               0.9974     1.0026    0.9487    1.0486
cond_oc_dum_3unemp               1.0684     0.9360    1.0314    1.1067
susprindum_oh                    0.9808     1.0196    0.8727    1.1023
susprindum_coc                   1.1064     0.9039    0.9830    1.2452
susprindum_pbc                   1.1254     0.8886    0.9988    1.2681
susprindum_mar                   1.1302     0.8848    0.9997    1.2777

Concordance= 0.635  (se = 0.002 )
Likelihood ratio test= 2204  on 20 df,   p=&lt;2e-16
Wald test            = 1947  on 20 df,   p=&lt;2e-16
Score (logrank) test = 2554  on 20 df,   p=&lt;2e-16,   Robust = 2679  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 13471, number of events= 9113 </span></span>
<span id="cb422-11"><a href="#cb422-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (880 observations deleted due to missingness)</span></span>
<span id="cb422-12"><a href="#cb422-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb422-13"><a href="#cb422-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se       z Pr(&gt;|z|)    </span></span>
<span id="cb422-14"><a href="#cb422-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag            -0.053168  0.948220  0.057677  0.039772  -1.337  0.18128    </span></span>
<span id="cb422-15"><a href="#cb422-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag -0.038928  0.961820  0.013773  0.015230  -2.556  0.01059 *  </span></span>
<span id="cb422-16"><a href="#cb422-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.095160  1.099835  0.073449  0.053940   1.764  0.07770 .  </span></span>
<span id="cb422-17"><a href="#cb422-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.009360  1.009404  0.092595  0.069811   0.134  0.89335    </span></span>
<span id="cb422-18"><a href="#cb422-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag              -0.799276  0.449654  0.024645  0.019765 -40.438  &lt; 2e-16 ***</span></span>
<span id="cb422-19"><a href="#cb422-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.023181  1.023452  0.005167  0.003189   7.268 3.64e-13 ***</span></span>
<span id="cb422-20"><a href="#cb422-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.030272  1.030735  0.005099  0.003160   9.581  &lt; 2e-16 ***</span></span>
<span id="cb422-21"><a href="#cb422-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.113215  1.119873  0.081735  0.057953   1.954  0.05075 .  </span></span>
<span id="cb422-22"><a href="#cb422-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.064995  1.067154  0.064022  0.041330   1.573  0.11581    </span></span>
<span id="cb422-23"><a href="#cb422-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                 -0.091810  0.912278  0.076500  0.051320  -1.789  0.07362 .  </span></span>
<span id="cb422-24"><a href="#cb422-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.070750  1.073313  0.065353  0.042346   1.671  0.09477 .  </span></span>
<span id="cb422-25"><a href="#cb422-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2           0.009316  1.009359  0.021927  0.012820   0.727  0.46744    </span></span>
<span id="cb422-26"><a href="#cb422-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.172542  0.841523  0.032163  0.024628  -7.006 2.45e-12 ***</span></span>
<span id="cb422-27"><a href="#cb422-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.002757  1.002760  0.024133  0.014661   0.188  0.85086    </span></span>
<span id="cb422-28"><a href="#cb422-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact            -0.019184  0.980999  0.033110  0.020755  -0.924  0.35532    </span></span>
<span id="cb422-29"><a href="#cb422-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.053533  1.054991  0.025441  0.016401   3.264  0.00110 ** </span></span>
<span id="cb422-30"><a href="#cb422-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  0.004280  1.004289  0.097915  0.059290   0.072  0.94245    </span></span>
<span id="cb422-31"><a href="#cb422-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.167440  1.182274  0.099029  0.060961   2.747  0.00602 ** </span></span>
<span id="cb422-32"><a href="#cb422-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.166351  1.180988  0.097732  0.060049   2.770  0.00560 ** </span></span>
<span id="cb422-33"><a href="#cb422-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.152467  1.164705  0.103688  0.062710   2.431  0.01504 *  </span></span>
<span id="cb422-34"><a href="#cb422-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb422-35"><a href="#cb422-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb422-36"><a href="#cb422-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb422-37"><a href="#cb422-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb422-38"><a href="#cb422-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               0.9482     1.0546    0.8771    1.0251</span></span>
<span id="cb422-39"><a href="#cb422-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    0.9618     1.0397    0.9335    0.9910</span></span>
<span id="cb422-40"><a href="#cb422-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.0998     0.9092    0.9895    1.2225</span></span>
<span id="cb422-41"><a href="#cb422-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.0094     0.9907    0.8803    1.1574</span></span>
<span id="cb422-42"><a href="#cb422-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.4497     2.2239    0.4326    0.4674</span></span>
<span id="cb422-43"><a href="#cb422-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.0235     0.9771    1.0171    1.0299</span></span>
<span id="cb422-44"><a href="#cb422-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.0307     0.9702    1.0244    1.0371</span></span>
<span id="cb422-45"><a href="#cb422-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.1199     0.8930    0.9996    1.2546</span></span>
<span id="cb422-46"><a href="#cb422-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.0672     0.9371    0.9841    1.1572</span></span>
<span id="cb422-47"><a href="#cb422-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    0.9123     1.0962    0.8250    1.0088</span></span>
<span id="cb422-48"><a href="#cb422-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.0733     0.9317    0.9878    1.1662</span></span>
<span id="cb422-49"><a href="#cb422-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             1.0094     0.9907    0.9843    1.0350</span></span>
<span id="cb422-50"><a href="#cb422-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.8415     1.1883    0.8019    0.8831</span></span>
<span id="cb422-51"><a href="#cb422-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               1.0028     0.9972    0.9744    1.0320</span></span>
<span id="cb422-52"><a href="#cb422-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               0.9810     1.0194    0.9419    1.0217</span></span>
<span id="cb422-53"><a href="#cb422-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.0550     0.9479    1.0216    1.0895</span></span>
<span id="cb422-54"><a href="#cb422-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    1.0043     0.9957    0.8941    1.1280</span></span>
<span id="cb422-55"><a href="#cb422-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.1823     0.8458    1.0491    1.3323</span></span>
<span id="cb422-56"><a href="#cb422-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.1810     0.8467    1.0499    1.3285</span></span>
<span id="cb422-57"><a href="#cb422-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.1647     0.8586    1.0300    1.3170</span></span>
<span id="cb422-58"><a href="#cb422-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb422-59"><a href="#cb422-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.609  (se = 0.002 )</span></span>
<span id="cb422-60"><a href="#cb422-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 1284  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb422-61"><a href="#cb422-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 2579  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb422-62"><a href="#cb422-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 1333  on 20 df,   p=&lt;2e-16,   Robust = 2025  p=&lt;2e-16</span></span>
<span id="cb422-63"><a href="#cb422-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb422-64"><a href="#cb422-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb422-65"><a href="#cb422-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb422-66"><a href="#cb422-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-67"><a href="#cb422-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_ba<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.09172 0.55656 1.00031 1.24301 1.82741 5.01220 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.5685  0.8381  1.0387  1.3327  1.8348  3.4639 </span></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_ba_alt<span class="ot">&lt;-</span></span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb424-12"><a href="#cb424-12" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb424-13"><a href="#cb424-13" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb424-14"><a href="#cb424-14" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb424-15"><a href="#cb424-15" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb424-16"><a href="#cb424-16" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb424-17"><a href="#cb424-17" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb424-18"><a href="#cb424-18" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb424-19"><a href="#cb424-19" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb424-20"><a href="#cb424-20" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb424-21"><a href="#cb424-21" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb424-22"><a href="#cb424-22" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb424-23"><a href="#cb424-23" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb424-24"><a href="#cb424-24" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb424-25"><a href="#cb424-25" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb424-26"><a href="#cb424-26" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb424-27"><a href="#cb424-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb424-28"><a href="#cb424-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb424-29"><a href="#cb424-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb424-30"><a href="#cb424-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb424-31"><a href="#cb424-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">1</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb424-32"><a href="#cb424-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb424-33"><a href="#cb424-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb424-34"><a href="#cb424-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb424-35"><a href="#cb424-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb424-36"><a href="#cb424-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb424-37"><a href="#cb424-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_ba_alt<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 13471, number of events= 9113 
   (880 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome_rec.lag             2.114216  8.283090  0.072640  0.068485 30.871
log_dias_treat_imp_sin_na.lag  0.484348  1.623117  0.023209  0.028675 16.891
less_90d_tr1_rec.lag           0.399869  1.491630  0.070287  0.062216  6.427
comp_bpsc_y3_severe_rec.lag    0.692117  1.997940  0.055532  0.054833 12.622
policonsumo2.lag              -0.009252  0.990791  0.032970  0.027511 -0.336
edad_al_ing_1                  0.095935  1.100687  0.005243  0.004801 19.983
ano_nac_corr                   0.101247  1.106550  0.005183  0.004728 21.415
susinidum_coc_rec2             0.162364  1.176289  0.080265  0.090627  1.792
susinidum_oh                   0.049976  1.051246  0.063197  0.057214  0.873
susinidum_pbc                  0.067771  1.070120  0.075944  0.068309  0.992
susinidum_mar                  0.080871  1.084231  0.064602  0.058516  1.382
psycom_dum_with_rec2          -0.077395  0.925524  0.021792  0.017770 -4.355
psycom_dum_study              -0.171662  0.842263  0.032046  0.030499 -5.629
freq_cons_dum_5day            -0.013027  0.987058  0.024045  0.021068 -0.618
cond_oc_dum_2inact            -0.005455  0.994559  0.033066  0.028766 -0.190
cond_oc_dum_3unemp             0.047916  1.049082  0.025405  0.022455  2.134
susprindum_oh                  0.124032  1.132052  0.097439  0.078021  1.590
susprindum_coc                 0.176572  1.193120  0.098636  0.079742  2.214
susprindum_pbc                 0.217877  1.243434  0.097414  0.078704  2.768
susprindum_mar                 0.183830  1.201811  0.103376  0.083412  2.204
                              Pr(&gt;|z|)    
tr_outcome_rec.lag             &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
less_90d_tr1_rec.lag          1.30e-10 ***
comp_bpsc_y3_severe_rec.lag    &lt; 2e-16 ***
policonsumo2.lag               0.73665    
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_coc_rec2             0.07320 .  
susinidum_oh                   0.38240    
susinidum_pbc                  0.32114    
susinidum_mar                  0.16696    
psycom_dum_with_rec2          1.33e-05 ***
psycom_dum_study              1.82e-08 ***
freq_cons_dum_5day             0.53636    
cond_oc_dum_2inact             0.84959    
cond_oc_dum_3unemp             0.03285 *  
susprindum_oh                  0.11190    
susprindum_coc                 0.02681 *  
susprindum_pbc                 0.00563 ** 
susprindum_mar                 0.02753 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               8.2831     0.1207    7.2427    9.4730
log_dias_treat_imp_sin_na.lag    1.6231     0.6161    1.5344    1.7170
less_90d_tr1_rec.lag             1.4916     0.6704    1.3204    1.6851
comp_bpsc_y3_severe_rec.lag      1.9979     0.5005    1.7944    2.2246
policonsumo2.lag                 0.9908     1.0093    0.9388    1.0457
edad_al_ing_1                    1.1007     0.9085    1.0904    1.1111
ano_nac_corr                     1.1065     0.9037    1.0963    1.1169
susinidum_coc_rec2               1.1763     0.8501    0.9849    1.4049
susinidum_oh                     1.0512     0.9513    0.9397    1.1760
susinidum_pbc                    1.0701     0.9345    0.9360    1.2234
susinidum_mar                    1.0842     0.9223    0.9667    1.2160
psycom_dum_with_rec2             0.9255     1.0805    0.8938    0.9583
psycom_dum_study                 0.8423     1.1873    0.7934    0.8941
freq_cons_dum_5day               0.9871     1.0131    0.9471    1.0287
cond_oc_dum_2inact               0.9946     1.0055    0.9400    1.0522
cond_oc_dum_3unemp               1.0491     0.9532    1.0039    1.0963
susprindum_oh                    1.1321     0.8834    0.9715    1.3191
susprindum_coc                   1.1931     0.8381    1.0205    1.3950
susprindum_pbc                   1.2434     0.8042    1.0657    1.4508
susprindum_mar                   1.2018     0.8321    1.0206    1.4153

Concordance= 0.706  (se = 0.002 )
Likelihood ratio test= 5371  on 20 df,   p=&lt;2e-16
Wald test            = 5053  on 20 df,   p=&lt;2e-16
Score (logrank) test = 5632  on 20 df,   p=&lt;2e-16,   Robust = 3864  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 13471, number of events= 9113 </span></span>
<span id="cb426-11"><a href="#cb426-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (880 observations deleted due to missingness)</span></span>
<span id="cb426-12"><a href="#cb426-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb426-13"><a href="#cb426-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se      z Pr(&gt;|z|)    </span></span>
<span id="cb426-14"><a href="#cb426-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag             2.114216  8.283090  0.072640  0.068485 30.871  &lt; 2e-16 ***</span></span>
<span id="cb426-15"><a href="#cb426-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.484348  1.623117  0.023209  0.028675 16.891  &lt; 2e-16 ***</span></span>
<span id="cb426-16"><a href="#cb426-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.399869  1.491630  0.070287  0.062216  6.427 1.30e-10 ***</span></span>
<span id="cb426-17"><a href="#cb426-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.692117  1.997940  0.055532  0.054833 12.622  &lt; 2e-16 ***</span></span>
<span id="cb426-18"><a href="#cb426-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag              -0.009252  0.990791  0.032970  0.027511 -0.336  0.73665    </span></span>
<span id="cb426-19"><a href="#cb426-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.095935  1.100687  0.005243  0.004801 19.983  &lt; 2e-16 ***</span></span>
<span id="cb426-20"><a href="#cb426-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.101247  1.106550  0.005183  0.004728 21.415  &lt; 2e-16 ***</span></span>
<span id="cb426-21"><a href="#cb426-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.162364  1.176289  0.080265  0.090627  1.792  0.07320 .  </span></span>
<span id="cb426-22"><a href="#cb426-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.049976  1.051246  0.063197  0.057214  0.873  0.38240    </span></span>
<span id="cb426-23"><a href="#cb426-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.067771  1.070120  0.075944  0.068309  0.992  0.32114    </span></span>
<span id="cb426-24"><a href="#cb426-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.080871  1.084231  0.064602  0.058516  1.382  0.16696    </span></span>
<span id="cb426-25"><a href="#cb426-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2          -0.077395  0.925524  0.021792  0.017770 -4.355 1.33e-05 ***</span></span>
<span id="cb426-26"><a href="#cb426-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.171662  0.842263  0.032046  0.030499 -5.629 1.82e-08 ***</span></span>
<span id="cb426-27"><a href="#cb426-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day            -0.013027  0.987058  0.024045  0.021068 -0.618  0.53636    </span></span>
<span id="cb426-28"><a href="#cb426-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact            -0.005455  0.994559  0.033066  0.028766 -0.190  0.84959    </span></span>
<span id="cb426-29"><a href="#cb426-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.047916  1.049082  0.025405  0.022455  2.134  0.03285 *  </span></span>
<span id="cb426-30"><a href="#cb426-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  0.124032  1.132052  0.097439  0.078021  1.590  0.11190    </span></span>
<span id="cb426-31"><a href="#cb426-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.176572  1.193120  0.098636  0.079742  2.214  0.02681 *  </span></span>
<span id="cb426-32"><a href="#cb426-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.217877  1.243434  0.097414  0.078704  2.768  0.00563 ** </span></span>
<span id="cb426-33"><a href="#cb426-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.183830  1.201811  0.103376  0.083412  2.204  0.02753 *  </span></span>
<span id="cb426-34"><a href="#cb426-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb426-35"><a href="#cb426-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb426-36"><a href="#cb426-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb426-37"><a href="#cb426-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb426-38"><a href="#cb426-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               8.2831     0.1207    7.2427    9.4730</span></span>
<span id="cb426-39"><a href="#cb426-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.6231     0.6161    1.5344    1.7170</span></span>
<span id="cb426-40"><a href="#cb426-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.4916     0.6704    1.3204    1.6851</span></span>
<span id="cb426-41"><a href="#cb426-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.9979     0.5005    1.7944    2.2246</span></span>
<span id="cb426-42"><a href="#cb426-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.9908     1.0093    0.9388    1.0457</span></span>
<span id="cb426-43"><a href="#cb426-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.1007     0.9085    1.0904    1.1111</span></span>
<span id="cb426-44"><a href="#cb426-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.1065     0.9037    1.0963    1.1169</span></span>
<span id="cb426-45"><a href="#cb426-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.1763     0.8501    0.9849    1.4049</span></span>
<span id="cb426-46"><a href="#cb426-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.0512     0.9513    0.9397    1.1760</span></span>
<span id="cb426-47"><a href="#cb426-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    1.0701     0.9345    0.9360    1.2234</span></span>
<span id="cb426-48"><a href="#cb426-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.0842     0.9223    0.9667    1.2160</span></span>
<span id="cb426-49"><a href="#cb426-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             0.9255     1.0805    0.8938    0.9583</span></span>
<span id="cb426-50"><a href="#cb426-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.8423     1.1873    0.7934    0.8941</span></span>
<span id="cb426-51"><a href="#cb426-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               0.9871     1.0131    0.9471    1.0287</span></span>
<span id="cb426-52"><a href="#cb426-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               0.9946     1.0055    0.9400    1.0522</span></span>
<span id="cb426-53"><a href="#cb426-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.0491     0.9532    1.0039    1.0963</span></span>
<span id="cb426-54"><a href="#cb426-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    1.1321     0.8834    0.9715    1.3191</span></span>
<span id="cb426-55"><a href="#cb426-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.1931     0.8381    1.0205    1.3950</span></span>
<span id="cb426-56"><a href="#cb426-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.2434     0.8042    1.0657    1.4508</span></span>
<span id="cb426-57"><a href="#cb426-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.2018     0.8321    1.0206    1.4153</span></span>
<span id="cb426-58"><a href="#cb426-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb426-59"><a href="#cb426-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.706  (se = 0.002 )</span></span>
<span id="cb426-60"><a href="#cb426-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 5371  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb426-61"><a href="#cb426-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 5053  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb426-62"><a href="#cb426-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 5632  on 20 df,   p=&lt;2e-16,   Robust = 3864  p=&lt;2e-16</span></span>
<span id="cb426-63"><a href="#cb426-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb426-64"><a href="#cb426-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb426-65"><a href="#cb426-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb426-66"><a href="#cb426-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-67"><a href="#cb426-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_ba_alt<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
   0.0643    0.1402    0.5821    1.1179    1.4574 1294.5167 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.0643    0.1402    0.5821    1.1179    1.4574 1294.5167 </span></span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb428-6"><a href="#cb428-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"GP intensive ambulatory"</span>)</span>
<span id="cb428-7"><a href="#cb428-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-8"><a href="#cb428-8" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_gp_ia<span class="ot">&lt;-</span></span>
<span id="cb428-9"><a href="#cb428-9" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb428-10"><a href="#cb428-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb428-11"><a href="#cb428-11" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb428-12"><a href="#cb428-12" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb428-13"><a href="#cb428-13" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb428-14"><a href="#cb428-14" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb428-15"><a href="#cb428-15" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb428-16"><a href="#cb428-16" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb428-17"><a href="#cb428-17" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb428-18"><a href="#cb428-18" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb428-19"><a href="#cb428-19" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb428-20"><a href="#cb428-20" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb428-21"><a href="#cb428-21" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb428-22"><a href="#cb428-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb428-23"><a href="#cb428-23" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb428-24"><a href="#cb428-24" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb428-25"><a href="#cb428-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb428-26"><a href="#cb428-26" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb428-27"><a href="#cb428-27" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb428-28"><a href="#cb428-28" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb428-29"><a href="#cb428-29" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb428-30"><a href="#cb428-30" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb428-31"><a href="#cb428-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb428-32"><a href="#cb428-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb428-33"><a href="#cb428-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb428-34"><a href="#cb428-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb428-35"><a href="#cb428-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">2</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb428-36"><a href="#cb428-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb428-37"><a href="#cb428-37" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb428-38"><a href="#cb428-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb428-39"><a href="#cb428-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb428-40"><a href="#cb428-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb428-41"><a href="#cb428-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb428-42"><a href="#cb428-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb428-43"><a href="#cb428-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-44"><a href="#cb428-44" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_gp_ia<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 15256, number of events= 10260 
   (1237 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se       z
tr_outcome_rec.lag             0.385527  1.470389  0.059938  0.052500   7.343
log_dias_treat_imp_sin_na.lag -0.159892  0.852236  0.005840  0.012235 -13.068
less_90d_tr1_rec.lag          -0.129562  0.878480  0.065487  0.063315  -2.046
comp_bpsc_y3_severe_rec.lag   -0.064406  0.937624  0.057456  0.050548  -1.274
policonsumo2.lag              -0.751697  0.471566  0.023787  0.023197 -32.405
edad_al_ing_1                  0.047348  1.048487  0.004745  0.002975  15.915
ano_nac_corr                   0.050791  1.052102  0.004669  0.002920  17.392
susinidum_coc_rec2             0.141599  1.152114  0.073895  0.055690   2.543
susinidum_oh                   0.140127  1.150420  0.058018  0.039225   3.572
susinidum_pbc                  0.002339  1.002341  0.068236  0.046669   0.050
susinidum_mar                  0.169380  1.184570  0.059120  0.040104   4.224
psycom_dum_with_rec2          -0.002221  0.997781  0.019789  0.013096  -0.170
psycom_dum_study              -0.285588  0.751572  0.032376  0.027958 -10.215
freq_cons_dum_5day             0.009801  1.009849  0.020311  0.013832   0.709
cond_oc_dum_2inact            -0.061440  0.940410  0.030576  0.019679  -3.122
cond_oc_dum_3unemp            -0.018074  0.982089  0.021957  0.014496  -1.247
susprindum_oh                 -0.106767  0.898735  0.087977  0.052865  -2.020
susprindum_coc                 0.029272  1.029704  0.088615  0.053023   0.552
susprindum_pbc                 0.039693  1.040491  0.086621  0.051892   0.765
susprindum_mar                 0.006736  1.006759  0.095242  0.059612   0.113
                              Pr(&gt;|z|)    
tr_outcome_rec.lag            2.08e-13 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
less_90d_tr1_rec.lag          0.040727 *  
comp_bpsc_y3_severe_rec.lag   0.202613    
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_coc_rec2            0.011003 *  
susinidum_oh                  0.000354 ***
susinidum_pbc                 0.960035    
susinidum_mar                 2.41e-05 ***
psycom_dum_with_rec2          0.865316    
psycom_dum_study               &lt; 2e-16 ***
freq_cons_dum_5day            0.478583    
cond_oc_dum_2inact            0.001796 ** 
cond_oc_dum_3unemp            0.212480    
susprindum_oh                 0.043422 *  
susprindum_coc                0.580909    
susprindum_pbc                0.444322    
susprindum_mar                0.910028    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               1.4704     0.6801    1.3266    1.6297
log_dias_treat_imp_sin_na.lag    0.8522     1.1734    0.8320    0.8729
less_90d_tr1_rec.lag             0.8785     1.1383    0.7760    0.9945
comp_bpsc_y3_severe_rec.lag      0.9376     1.0665    0.8492    1.0353
policonsumo2.lag                 0.4716     2.1206    0.4506    0.4935
edad_al_ing_1                    1.0485     0.9538    1.0424    1.0546
ano_nac_corr                     1.0521     0.9505    1.0461    1.0581
susinidum_coc_rec2               1.1521     0.8680    1.0330    1.2850
susinidum_oh                     1.1504     0.8692    1.0653    1.2424
susinidum_pbc                    1.0023     0.9977    0.9147    1.0983
susinidum_mar                    1.1846     0.8442    1.0950    1.2814
psycom_dum_with_rec2             0.9978     1.0022    0.9725    1.0237
psycom_dum_study                 0.7516     1.3305    0.7115    0.7939
freq_cons_dum_5day               1.0098     0.9902    0.9828    1.0376
cond_oc_dum_2inact               0.9404     1.0634    0.9048    0.9774
cond_oc_dum_3unemp               0.9821     1.0182    0.9546    1.0104
susprindum_oh                    0.8987     1.1127    0.8103    0.9969
susprindum_coc                   1.0297     0.9712    0.9281    1.1425
susprindum_pbc                   1.0405     0.9611    0.9399    1.1519
susprindum_mar                   1.0068     0.9933    0.8957    1.1315

Concordance= 0.633  (se = 0.002 )
Likelihood ratio test= 2140  on 20 df,   p=&lt;2e-16
Wald test            = 2876  on 20 df,   p=&lt;2e-16
Score (logrank) test = 2305  on 20 df,   p=&lt;2e-16,   Robust = 2637  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 15256, number of events= 10260 </span></span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (1237 observations deleted due to missingness)</span></span>
<span id="cb430-12"><a href="#cb430-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb430-13"><a href="#cb430-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se       z Pr(&gt;|z|)    </span></span>
<span id="cb430-14"><a href="#cb430-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag             0.194561  1.214778  0.060033  0.041647   4.672 2.99e-06 ***</span></span>
<span id="cb430-15"><a href="#cb430-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.037861  1.038587  0.012193  0.011379   3.327 0.000877 ***</span></span>
<span id="cb430-16"><a href="#cb430-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.109752  1.116001  0.068389  0.049698   2.208 0.027217 *  </span></span>
<span id="cb430-17"><a href="#cb430-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.023291  1.023564  0.058271  0.040852   0.570 0.568590    </span></span>
<span id="cb430-18"><a href="#cb430-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag              -0.865899  0.420673  0.023128  0.019879 -43.559  &lt; 2e-16 ***</span></span>
<span id="cb430-19"><a href="#cb430-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.037553  1.038267  0.004720  0.002930  12.819  &lt; 2e-16 ***</span></span>
<span id="cb430-20"><a href="#cb430-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.042753  1.043681  0.004647  0.002895  14.771  &lt; 2e-16 ***</span></span>
<span id="cb430-21"><a href="#cb430-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.131486  1.140522  0.074109  0.050774   2.590 0.009607 ** </span></span>
<span id="cb430-22"><a href="#cb430-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.145019  1.156062  0.058176  0.037817   3.835 0.000126 ***</span></span>
<span id="cb430-23"><a href="#cb430-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                 -0.007182  0.992844  0.068385  0.045736  -0.157 0.875226    </span></span>
<span id="cb430-24"><a href="#cb430-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.175201  1.191485  0.059249  0.038641   4.534 5.79e-06 ***</span></span>
<span id="cb430-25"><a href="#cb430-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2           0.019278  1.019465  0.019842  0.011894   1.621 0.105056    </span></span>
<span id="cb430-26"><a href="#cb430-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.242411  0.784734  0.032301  0.026523  -9.140  &lt; 2e-16 ***</span></span>
<span id="cb430-27"><a href="#cb430-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.018721  1.018897  0.020325  0.013005   1.439 0.150020    </span></span>
<span id="cb430-28"><a href="#cb430-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact            -0.059131  0.942583  0.030582  0.019607  -3.016 0.002562 ** </span></span>
<span id="cb430-29"><a href="#cb430-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.008273  1.008307  0.021893  0.013962   0.593 0.553497    </span></span>
<span id="cb430-30"><a href="#cb430-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.104867  0.900444  0.088141  0.051923  -2.020 0.043417 *  </span></span>
<span id="cb430-31"><a href="#cb430-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.047539  1.048688  0.088742  0.052255   0.910 0.362951    </span></span>
<span id="cb430-32"><a href="#cb430-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.056574  1.058205  0.086757  0.051073   1.108 0.267988    </span></span>
<span id="cb430-33"><a href="#cb430-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.058619  1.060371  0.095320  0.056059   1.046 0.295721    </span></span>
<span id="cb430-34"><a href="#cb430-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb430-35"><a href="#cb430-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb430-36"><a href="#cb430-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb430-37"><a href="#cb430-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb430-38"><a href="#cb430-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               1.2148     0.8232    1.1196    1.3181</span></span>
<span id="cb430-39"><a href="#cb430-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.0386     0.9628    1.0157    1.0620</span></span>
<span id="cb430-40"><a href="#cb430-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.1160     0.8961    1.0124    1.2302</span></span>
<span id="cb430-41"><a href="#cb430-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.0236     0.9770    0.9448    1.1089</span></span>
<span id="cb430-42"><a href="#cb430-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.4207     2.3771    0.4046    0.4374</span></span>
<span id="cb430-43"><a href="#cb430-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.0383     0.9631    1.0323    1.0442</span></span>
<span id="cb430-44"><a href="#cb430-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.0437     0.9581    1.0378    1.0496</span></span>
<span id="cb430-45"><a href="#cb430-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.1405     0.8768    1.0325    1.2599</span></span>
<span id="cb430-46"><a href="#cb430-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.1561     0.8650    1.0735    1.2450</span></span>
<span id="cb430-47"><a href="#cb430-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    0.9928     1.0072    0.9077    1.0860</span></span>
<span id="cb430-48"><a href="#cb430-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.1915     0.8393    1.1046    1.2852</span></span>
<span id="cb430-49"><a href="#cb430-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             1.0195     0.9809    0.9960    1.0435</span></span>
<span id="cb430-50"><a href="#cb430-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.7847     1.2743    0.7450    0.8266</span></span>
<span id="cb430-51"><a href="#cb430-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               1.0189     0.9815    0.9933    1.0452</span></span>
<span id="cb430-52"><a href="#cb430-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               0.9426     1.0609    0.9070    0.9795</span></span>
<span id="cb430-53"><a href="#cb430-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.0083     0.9918    0.9811    1.0363</span></span>
<span id="cb430-54"><a href="#cb430-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    0.9004     1.1106    0.8133    0.9969</span></span>
<span id="cb430-55"><a href="#cb430-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.0487     0.9536    0.9466    1.1618</span></span>
<span id="cb430-56"><a href="#cb430-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.0582     0.9450    0.9574    1.1696</span></span>
<span id="cb430-57"><a href="#cb430-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.0604     0.9431    0.9500    1.1835</span></span>
<span id="cb430-58"><a href="#cb430-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb430-59"><a href="#cb430-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.625  (se = 0.002 )</span></span>
<span id="cb430-60"><a href="#cb430-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 1595  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb430-61"><a href="#cb430-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 2810  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb430-62"><a href="#cb430-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 1706  on 20 df,   p=&lt;2e-16,   Robust = 2370  p=&lt;2e-16</span></span>
<span id="cb430-63"><a href="#cb430-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb430-64"><a href="#cb430-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb430-65"><a href="#cb430-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb430-66"><a href="#cb430-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-67"><a href="#cb430-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_gp_ia<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.2832  0.7168  1.1537  1.4504  2.0894  5.3832 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5251  0.9191  1.2296  1.4771  1.9988  3.7976 </span></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_gp_ia_alt<span class="ot">&lt;-</span></span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb432-10"><a href="#cb432-10" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb432-11"><a href="#cb432-11" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb432-12"><a href="#cb432-12" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb432-13"><a href="#cb432-13" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb432-14"><a href="#cb432-14" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb432-15"><a href="#cb432-15" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb432-16"><a href="#cb432-16" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb432-17"><a href="#cb432-17" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb432-18"><a href="#cb432-18" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb432-19"><a href="#cb432-19" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb432-20"><a href="#cb432-20" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb432-21"><a href="#cb432-21" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb432-22"><a href="#cb432-22" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb432-23"><a href="#cb432-23" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb432-24"><a href="#cb432-24" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb432-25"><a href="#cb432-25" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb432-26"><a href="#cb432-26" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb432-27"><a href="#cb432-27" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb432-28"><a href="#cb432-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb432-29"><a href="#cb432-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb432-30"><a href="#cb432-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb432-31"><a href="#cb432-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb432-32"><a href="#cb432-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">2</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb432-33"><a href="#cb432-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb432-34"><a href="#cb432-34" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb432-35"><a href="#cb432-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb432-36"><a href="#cb432-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb432-37"><a href="#cb432-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb432-38"><a href="#cb432-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb432-39"><a href="#cb432-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb432-40"><a href="#cb432-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-41"><a href="#cb432-41" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_gp_ia_alt<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 15256, number of events= 10260 
   (1237 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome_rec.lag             2.014920  7.500129  0.071852  0.068771 29.299
log_dias_treat_imp_sin_na.lag  0.500735  1.649933  0.019681  0.026847 18.652
less_90d_tr1_rec.lag           0.549827  1.732953  0.059743  0.050431 10.903
comp_bpsc_y3_severe_rec.lag    0.433513  1.542667  0.048326  0.045058  9.621
policonsumo2.lag               0.079196  1.082417  0.034122  0.029496  2.685
edad_al_ing_1                  0.107546  1.113542  0.004831  0.004325 24.868
ano_nac_corr                   0.111431  1.117877  0.004759  0.004253 26.199
susinidum_coc_rec2             0.103013  1.108506  0.072414  0.075162  1.371
susinidum_oh                   0.102275  1.107689  0.057331  0.051648  1.980
susinidum_pbc                  0.112886  1.119504  0.067849  0.060463  1.867
susinidum_mar                  0.157963  1.171122  0.058585  0.052701  2.997
psycom_dum_with_rec2          -0.047860  0.953267  0.019768  0.015955 -3.000
psycom_dum_study              -0.281336  0.754775  0.031771  0.031912 -8.816
freq_cons_dum_5day             0.030022  1.030478  0.020274  0.017996  1.668
cond_oc_dum_2inact            -0.037308  0.963380  0.030618  0.026755 -1.394
cond_oc_dum_3unemp             0.031426  1.031925  0.021888  0.019230  1.634
susprindum_oh                 -0.085834  0.917747  0.087841  0.069617 -1.233
susprindum_coc                -0.021955  0.978285  0.088512  0.070315 -0.312
susprindum_pbc                 0.017908  1.018069  0.086516  0.068698  0.261
susprindum_mar                -0.053078  0.948306  0.095181  0.077342 -0.686
                              Pr(&gt;|z|)    
tr_outcome_rec.lag             &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
less_90d_tr1_rec.lag           &lt; 2e-16 ***
comp_bpsc_y3_severe_rec.lag    &lt; 2e-16 ***
policonsumo2.lag               0.00725 ** 
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_coc_rec2             0.17051    
susinidum_oh                   0.04768 *  
susinidum_pbc                  0.06190 .  
susinidum_mar                  0.00272 ** 
psycom_dum_with_rec2           0.00270 ** 
psycom_dum_study               &lt; 2e-16 ***
freq_cons_dum_5day             0.09525 .  
cond_oc_dum_2inact             0.16320    
cond_oc_dum_3unemp             0.10222    
susprindum_oh                  0.21760    
susprindum_coc                 0.75487    
susprindum_pbc                 0.79435    
susprindum_mar                 0.49254    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               7.5001     0.1333    6.5544    8.5824
log_dias_treat_imp_sin_na.lag    1.6499     0.6061    1.5654    1.7391
less_90d_tr1_rec.lag             1.7330     0.5770    1.5699    1.9130
comp_bpsc_y3_severe_rec.lag      1.5427     0.6482    1.4123    1.6851
policonsumo2.lag                 1.0824     0.9239    1.0216    1.1468
edad_al_ing_1                    1.1135     0.8980    1.1041    1.1230
ano_nac_corr                     1.1179     0.8946    1.1086    1.1272
susinidum_coc_rec2               1.1085     0.9021    0.9567    1.2844
susinidum_oh                     1.1077     0.9028    1.0010    1.2257
susinidum_pbc                    1.1195     0.8933    0.9944    1.2604
susinidum_mar                    1.1711     0.8539    1.0562    1.2986
psycom_dum_with_rec2             0.9533     1.0490    0.9239    0.9835
psycom_dum_study                 0.7548     1.3249    0.7090    0.8035
freq_cons_dum_5day               1.0305     0.9704    0.9948    1.0675
cond_oc_dum_2inact               0.9634     1.0380    0.9142    1.0152
cond_oc_dum_3unemp               1.0319     0.9691    0.9938    1.0716
susprindum_oh                    0.9177     1.0896    0.8007    1.0519
susprindum_coc                   0.9783     1.0222    0.8523    1.1228
susprindum_pbc                   1.0181     0.9823    0.8898    1.1648
susprindum_mar                   0.9483     1.0545    0.8149    1.1035

Concordance= 0.707  (se = 0.002 )
Likelihood ratio test= 5753  on 20 df,   p=&lt;2e-16
Wald test            = 5237  on 20 df,   p=&lt;2e-16
Score (logrank) test = 5780  on 20 df,   p=&lt;2e-16,   Robust = 4219  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb434-9"><a href="#cb434-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb434-10"><a href="#cb434-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 15256, number of events= 10260 </span></span>
<span id="cb434-11"><a href="#cb434-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (1237 observations deleted due to missingness)</span></span>
<span id="cb434-12"><a href="#cb434-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb434-13"><a href="#cb434-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se      z Pr(&gt;|z|)    </span></span>
<span id="cb434-14"><a href="#cb434-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag             2.014920  7.500129  0.071852  0.068771 29.299  &lt; 2e-16 ***</span></span>
<span id="cb434-15"><a href="#cb434-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.500735  1.649933  0.019681  0.026847 18.652  &lt; 2e-16 ***</span></span>
<span id="cb434-16"><a href="#cb434-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.549827  1.732953  0.059743  0.050431 10.903  &lt; 2e-16 ***</span></span>
<span id="cb434-17"><a href="#cb434-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.433513  1.542667  0.048326  0.045058  9.621  &lt; 2e-16 ***</span></span>
<span id="cb434-18"><a href="#cb434-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag               0.079196  1.082417  0.034122  0.029496  2.685  0.00725 ** </span></span>
<span id="cb434-19"><a href="#cb434-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.107546  1.113542  0.004831  0.004325 24.868  &lt; 2e-16 ***</span></span>
<span id="cb434-20"><a href="#cb434-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.111431  1.117877  0.004759  0.004253 26.199  &lt; 2e-16 ***</span></span>
<span id="cb434-21"><a href="#cb434-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.103013  1.108506  0.072414  0.075162  1.371  0.17051    </span></span>
<span id="cb434-22"><a href="#cb434-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.102275  1.107689  0.057331  0.051648  1.980  0.04768 *  </span></span>
<span id="cb434-23"><a href="#cb434-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.112886  1.119504  0.067849  0.060463  1.867  0.06190 .  </span></span>
<span id="cb434-24"><a href="#cb434-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.157963  1.171122  0.058585  0.052701  2.997  0.00272 ** </span></span>
<span id="cb434-25"><a href="#cb434-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2          -0.047860  0.953267  0.019768  0.015955 -3.000  0.00270 ** </span></span>
<span id="cb434-26"><a href="#cb434-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.281336  0.754775  0.031771  0.031912 -8.816  &lt; 2e-16 ***</span></span>
<span id="cb434-27"><a href="#cb434-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.030022  1.030478  0.020274  0.017996  1.668  0.09525 .  </span></span>
<span id="cb434-28"><a href="#cb434-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact            -0.037308  0.963380  0.030618  0.026755 -1.394  0.16320    </span></span>
<span id="cb434-29"><a href="#cb434-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.031426  1.031925  0.021888  0.019230  1.634  0.10222    </span></span>
<span id="cb434-30"><a href="#cb434-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.085834  0.917747  0.087841  0.069617 -1.233  0.21760    </span></span>
<span id="cb434-31"><a href="#cb434-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                -0.021955  0.978285  0.088512  0.070315 -0.312  0.75487    </span></span>
<span id="cb434-32"><a href="#cb434-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.017908  1.018069  0.086516  0.068698  0.261  0.79435    </span></span>
<span id="cb434-33"><a href="#cb434-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                -0.053078  0.948306  0.095181  0.077342 -0.686  0.49254    </span></span>
<span id="cb434-34"><a href="#cb434-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb434-35"><a href="#cb434-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb434-36"><a href="#cb434-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb434-37"><a href="#cb434-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb434-38"><a href="#cb434-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               7.5001     0.1333    6.5544    8.5824</span></span>
<span id="cb434-39"><a href="#cb434-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.6499     0.6061    1.5654    1.7391</span></span>
<span id="cb434-40"><a href="#cb434-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.7330     0.5770    1.5699    1.9130</span></span>
<span id="cb434-41"><a href="#cb434-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.5427     0.6482    1.4123    1.6851</span></span>
<span id="cb434-42"><a href="#cb434-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 1.0824     0.9239    1.0216    1.1468</span></span>
<span id="cb434-43"><a href="#cb434-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.1135     0.8980    1.1041    1.1230</span></span>
<span id="cb434-44"><a href="#cb434-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.1179     0.8946    1.1086    1.1272</span></span>
<span id="cb434-45"><a href="#cb434-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.1085     0.9021    0.9567    1.2844</span></span>
<span id="cb434-46"><a href="#cb434-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.1077     0.9028    1.0010    1.2257</span></span>
<span id="cb434-47"><a href="#cb434-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    1.1195     0.8933    0.9944    1.2604</span></span>
<span id="cb434-48"><a href="#cb434-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.1711     0.8539    1.0562    1.2986</span></span>
<span id="cb434-49"><a href="#cb434-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             0.9533     1.0490    0.9239    0.9835</span></span>
<span id="cb434-50"><a href="#cb434-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.7548     1.3249    0.7090    0.8035</span></span>
<span id="cb434-51"><a href="#cb434-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               1.0305     0.9704    0.9948    1.0675</span></span>
<span id="cb434-52"><a href="#cb434-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               0.9634     1.0380    0.9142    1.0152</span></span>
<span id="cb434-53"><a href="#cb434-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.0319     0.9691    0.9938    1.0716</span></span>
<span id="cb434-54"><a href="#cb434-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    0.9177     1.0896    0.8007    1.0519</span></span>
<span id="cb434-55"><a href="#cb434-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   0.9783     1.0222    0.8523    1.1228</span></span>
<span id="cb434-56"><a href="#cb434-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.0181     0.9823    0.8898    1.1648</span></span>
<span id="cb434-57"><a href="#cb434-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   0.9483     1.0545    0.8149    1.1035</span></span>
<span id="cb434-58"><a href="#cb434-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb434-59"><a href="#cb434-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.707  (se = 0.002 )</span></span>
<span id="cb434-60"><a href="#cb434-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 5753  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb434-61"><a href="#cb434-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 5237  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb434-62"><a href="#cb434-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 5780  on 20 df,   p=&lt;2e-16,   Robust = 4219  p=&lt;2e-16</span></span>
<span id="cb434-63"><a href="#cb434-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb434-64"><a href="#cb434-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb434-65"><a href="#cb434-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb434-66"><a href="#cb434-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-67"><a href="#cb434-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_gp_ia_alt<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
   0.0678    0.1663    0.5251    1.4332    1.3754 1183.8688 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.0678    0.1663    0.5251    1.4332    1.3754 1183.8688 </span></span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"GP residential"</span>)</span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-8"><a href="#cb436-8" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_gp_res<span class="ot">&lt;-</span></span>
<span id="cb436-9"><a href="#cb436-9" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb436-10"><a href="#cb436-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb436-11"><a href="#cb436-11" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb436-12"><a href="#cb436-12" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb436-13"><a href="#cb436-13" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb436-14"><a href="#cb436-14" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb436-15"><a href="#cb436-15" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb436-16"><a href="#cb436-16" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb436-17"><a href="#cb436-17" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb436-18"><a href="#cb436-18" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb436-19"><a href="#cb436-19" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb436-20"><a href="#cb436-20" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb436-21"><a href="#cb436-21" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb436-22"><a href="#cb436-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb436-23"><a href="#cb436-23" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb436-24"><a href="#cb436-24" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb436-25"><a href="#cb436-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb436-26"><a href="#cb436-26" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb436-27"><a href="#cb436-27" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb436-28"><a href="#cb436-28" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb436-29"><a href="#cb436-29" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb436-30"><a href="#cb436-30" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb436-31"><a href="#cb436-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">3</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb436-32"><a href="#cb436-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb436-33"><a href="#cb436-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb436-34"><a href="#cb436-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb436-35"><a href="#cb436-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">3</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb436-36"><a href="#cb436-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb436-37"><a href="#cb436-37" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb436-38"><a href="#cb436-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb436-39"><a href="#cb436-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb436-40"><a href="#cb436-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb436-41"><a href="#cb436-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb436-42"><a href="#cb436-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb436-43"><a href="#cb436-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-44"><a href="#cb436-44" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_gp_res<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 6745, number of events= 4567 
   (637 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se       z
tr_outcome_rec.lag             0.128188  1.136767  0.101990  0.086925   1.475
log_dias_treat_imp_sin_na.lag -0.085496  0.918057  0.008798  0.011288  -7.574
less_90d_tr1_rec.lag          -0.088387  0.915407  0.103118  0.084266  -1.049
comp_bpsc_y3_severe_rec.lag    0.175771  1.192165  0.082749  0.081533   2.156
policonsumo2.lag              -0.750680  0.472045  0.036058  0.034731 -21.614
edad_al_ing_1                  0.028939  1.029361  0.007348  0.004632   6.248
ano_nac_corr                   0.032926  1.033474  0.007304  0.004592   7.170
susinidum_coc_rec2             0.183915  1.201913  0.125673  0.096940   1.897
susinidum_oh                   0.138489  1.148536  0.094577  0.076211   1.817
susinidum_pbc                  0.032443  1.032975  0.101841  0.081788   0.397
susinidum_mar                  0.118222  1.125494  0.094812  0.076811   1.539
psycom_dum_with_rec2           0.056826  1.058472  0.029195  0.019809   2.869
psycom_dum_study              -0.207341  0.812742  0.048764  0.037096  -5.589
freq_cons_dum_5day            -0.027696  0.972684  0.034087  0.023537  -1.177
cond_oc_dum_2inact             0.091545  1.095866  0.055552  0.040162   2.279
cond_oc_dum_3unemp             0.107838  1.113867  0.045740  0.031919   3.379
susprindum_oh                 -0.058676  0.943012  0.158396  0.098428  -0.596
susprindum_coc                 0.091597  1.095923  0.159134  0.098627   0.929
susprindum_pbc                 0.039675  1.040473  0.154505  0.094983   0.418
susprindum_mar                -0.075467  0.927310  0.178402  0.113375  -0.666
                              Pr(&gt;|z|)    
tr_outcome_rec.lag            0.140295    
log_dias_treat_imp_sin_na.lag 3.62e-14 ***
less_90d_tr1_rec.lag          0.294224    
comp_bpsc_y3_severe_rec.lag   0.031096 *  
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                 4.17e-10 ***
ano_nac_corr                  7.52e-13 ***
susinidum_coc_rec2            0.057802 .  
susinidum_oh                  0.069192 .  
susinidum_pbc                 0.691608    
susinidum_mar                 0.123774    
psycom_dum_with_rec2          0.004121 ** 
psycom_dum_study              2.28e-08 ***
freq_cons_dum_5day            0.239318    
cond_oc_dum_2inact            0.022644 *  
cond_oc_dum_3unemp            0.000729 ***
susprindum_oh                 0.551086    
susprindum_coc                0.353037    
susprindum_pbc                0.676161    
susprindum_mar                0.505641    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               1.1368     0.8797    0.9587    1.3479
log_dias_treat_imp_sin_na.lag    0.9181     1.0893    0.8980    0.9386
less_90d_tr1_rec.lag             0.9154     1.0924    0.7760    1.0798
comp_bpsc_y3_severe_rec.lag      1.1922     0.8388    1.0161    1.3987
policonsumo2.lag                 0.4720     2.1184    0.4410    0.5053
edad_al_ing_1                    1.0294     0.9715    1.0201    1.0387
ano_nac_corr                     1.0335     0.9676    1.0242    1.0428
susinidum_coc_rec2               1.2019     0.8320    0.9939    1.4534
susinidum_oh                     1.1485     0.8707    0.9892    1.3336
susinidum_pbc                    1.0330     0.9681    0.8800    1.2126
susinidum_mar                    1.1255     0.8885    0.9682    1.3084
psycom_dum_with_rec2             1.0585     0.9448    1.0182    1.1004
psycom_dum_study                 0.8127     1.2304    0.7557    0.8740
freq_cons_dum_5day               0.9727     1.0281    0.9288    1.0186
cond_oc_dum_2inact               1.0959     0.9125    1.0129    1.1856
cond_oc_dum_3unemp               1.1139     0.8978    1.0463    1.1858
susprindum_oh                    0.9430     1.0604    0.7776    1.1437
susprindum_coc                   1.0959     0.9125    0.9033    1.3296
susprindum_pbc                   1.0405     0.9611    0.8637    1.2534
susprindum_mar                   0.9273     1.0784    0.7425    1.1581

Concordance= 0.605  (se = 0.003 )
Likelihood ratio test= 695.9  on 20 df,   p=&lt;2e-16
Wald test            = 1085  on 20 df,   p=&lt;2e-16
Score (logrank) test = 743.2  on 20 df,   p=&lt;2e-16,   Robust = 996.3  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb438-7"><a href="#cb438-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb438-8"><a href="#cb438-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb438-9"><a href="#cb438-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb438-10"><a href="#cb438-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 6745, number of events= 4567 </span></span>
<span id="cb438-11"><a href="#cb438-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (637 observations deleted due to missingness)</span></span>
<span id="cb438-12"><a href="#cb438-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb438-13"><a href="#cb438-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se       z Pr(&gt;|z|)    </span></span>
<span id="cb438-14"><a href="#cb438-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag            -0.039009  0.961742  0.105701  0.074349  -0.525 0.599808    </span></span>
<span id="cb438-15"><a href="#cb438-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.078977  1.082180  0.015647  0.013905   5.680 1.35e-08 ***</span></span>
<span id="cb438-16"><a href="#cb438-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.150856  1.162829  0.107295  0.080559   1.873 0.061122 .  </span></span>
<span id="cb438-17"><a href="#cb438-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.353959  1.424696  0.090172  0.070675   5.008 5.49e-07 ***</span></span>
<span id="cb438-18"><a href="#cb438-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag              -0.837956  0.432594  0.035119  0.032878 -25.487  &lt; 2e-16 ***</span></span>
<span id="cb438-19"><a href="#cb438-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.025965  1.026305  0.007319  0.004690   5.536 3.09e-08 ***</span></span>
<span id="cb438-20"><a href="#cb438-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.030994  1.031479  0.007283  0.004684   6.617 3.66e-11 ***</span></span>
<span id="cb438-21"><a href="#cb438-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.160851  1.174510  0.124649  0.094183   1.708 0.087664 .  </span></span>
<span id="cb438-22"><a href="#cb438-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.114160  1.120931  0.094181  0.074294   1.537 0.124391    </span></span>
<span id="cb438-23"><a href="#cb438-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.009529  1.009575  0.101467  0.080150   0.119 0.905358    </span></span>
<span id="cb438-24"><a href="#cb438-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.103063  1.108562  0.094427  0.074787   1.378 0.168173    </span></span>
<span id="cb438-25"><a href="#cb438-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2           0.071582  1.074206  0.029128  0.019756   3.623 0.000291 ***</span></span>
<span id="cb438-26"><a href="#cb438-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.187465  0.829058  0.048601  0.037539  -4.994 5.92e-07 ***</span></span>
<span id="cb438-27"><a href="#cb438-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day            -0.017574  0.982579  0.034084  0.023154  -0.759 0.447831    </span></span>
<span id="cb438-28"><a href="#cb438-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.102551  1.107994  0.055537  0.038242   2.682 0.007327 ** </span></span>
<span id="cb438-29"><a href="#cb438-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.099801  1.104951  0.045743  0.031127   3.206 0.001345 ** </span></span>
<span id="cb438-30"><a href="#cb438-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.030306  0.970149  0.158516  0.107214  -0.283 0.777431    </span></span>
<span id="cb438-31"><a href="#cb438-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.111599  1.118064  0.159135  0.107984   1.033 0.301381    </span></span>
<span id="cb438-32"><a href="#cb438-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.080561  1.083895  0.154488  0.104564   0.770 0.441033    </span></span>
<span id="cb438-33"><a href="#cb438-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.064293  1.066405  0.177941  0.113070   0.569 0.569619    </span></span>
<span id="cb438-34"><a href="#cb438-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb438-35"><a href="#cb438-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb438-36"><a href="#cb438-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb438-37"><a href="#cb438-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb438-38"><a href="#cb438-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               0.9617     1.0398    0.8313    1.1126</span></span>
<span id="cb438-39"><a href="#cb438-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.0822     0.9241    1.0531    1.1121</span></span>
<span id="cb438-40"><a href="#cb438-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.1628     0.8600    0.9930    1.3617</span></span>
<span id="cb438-41"><a href="#cb438-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.4247     0.7019    1.2404    1.6364</span></span>
<span id="cb438-42"><a href="#cb438-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.4326     2.3116    0.4056    0.4614</span></span>
<span id="cb438-43"><a href="#cb438-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.0263     0.9744    1.0169    1.0358</span></span>
<span id="cb438-44"><a href="#cb438-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.0315     0.9695    1.0221    1.0410</span></span>
<span id="cb438-45"><a href="#cb438-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.1745     0.8514    0.9765    1.4126</span></span>
<span id="cb438-46"><a href="#cb438-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.1209     0.8921    0.9690    1.2966</span></span>
<span id="cb438-47"><a href="#cb438-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    1.0096     0.9905    0.8628    1.1813</span></span>
<span id="cb438-48"><a href="#cb438-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.1086     0.9021    0.9574    1.2836</span></span>
<span id="cb438-49"><a href="#cb438-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             1.0742     0.9309    1.0334    1.1166</span></span>
<span id="cb438-50"><a href="#cb438-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.8291     1.2062    0.7702    0.8924</span></span>
<span id="cb438-51"><a href="#cb438-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               0.9826     1.0177    0.9390    1.0282</span></span>
<span id="cb438-52"><a href="#cb438-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               1.1080     0.9025    1.0280    1.1942</span></span>
<span id="cb438-53"><a href="#cb438-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.1050     0.9050    1.0396    1.1745</span></span>
<span id="cb438-54"><a href="#cb438-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    0.9701     1.0308    0.7863    1.1970</span></span>
<span id="cb438-55"><a href="#cb438-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.1181     0.8944    0.9048    1.3816</span></span>
<span id="cb438-56"><a href="#cb438-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.0839     0.9226    0.8830    1.3304</span></span>
<span id="cb438-57"><a href="#cb438-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.0664     0.9377    0.8544    1.3310</span></span>
<span id="cb438-58"><a href="#cb438-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb438-59"><a href="#cb438-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.618  (se = 0.003 )</span></span>
<span id="cb438-60"><a href="#cb438-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 644.2  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb438-61"><a href="#cb438-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 1048  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb438-62"><a href="#cb438-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 689.3  on 20 df,   p=&lt;2e-16,   Robust = 950.3  p=&lt;2e-16</span></span>
<span id="cb438-63"><a href="#cb438-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb438-64"><a href="#cb438-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb438-65"><a href="#cb438-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb438-66"><a href="#cb438-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-67"><a href="#cb438-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_gp_res<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3321  0.7511  1.1708  1.3145  1.8355  3.2183 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.5131  0.8729  1.2617  1.3565  1.7689  6.7300 </span></span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_gp_res_alt<span class="ot">&lt;-</span></span>
<span id="cb440-7"><a href="#cb440-7" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb440-8"><a href="#cb440-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb440-9"><a href="#cb440-9" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb440-10"><a href="#cb440-10" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb440-11"><a href="#cb440-11" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb440-12"><a href="#cb440-12" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb440-13"><a href="#cb440-13" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb440-14"><a href="#cb440-14" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb440-15"><a href="#cb440-15" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb440-16"><a href="#cb440-16" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb440-17"><a href="#cb440-17" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb440-18"><a href="#cb440-18" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb440-19"><a href="#cb440-19" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb440-20"><a href="#cb440-20" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb440-21"><a href="#cb440-21" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb440-22"><a href="#cb440-22" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb440-23"><a href="#cb440-23" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb440-24"><a href="#cb440-24" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb440-25"><a href="#cb440-25" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb440-26"><a href="#cb440-26" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb440-27"><a href="#cb440-27" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb440-28"><a href="#cb440-28" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb440-29"><a href="#cb440-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">3</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb440-30"><a href="#cb440-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb440-31"><a href="#cb440-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb440-32"><a href="#cb440-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb440-33"><a href="#cb440-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">3</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb440-34"><a href="#cb440-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb440-35"><a href="#cb440-35" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb440-36"><a href="#cb440-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb440-37"><a href="#cb440-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb440-38"><a href="#cb440-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb440-39"><a href="#cb440-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb440-40"><a href="#cb440-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb440-41"><a href="#cb440-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-42"><a href="#cb440-42" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_gp_res_alt<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 6745, number of events= 4567 
   (637 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome_rec.lag             0.981483  2.668410  0.120321  0.103018  9.527
log_dias_treat_imp_sin_na.lag  0.328445  1.388807  0.021738  0.031862 10.308
less_90d_tr1_rec.lag           0.482546  1.620195  0.097638  0.084879  5.685
comp_bpsc_y3_severe_rec.lag    0.940955  2.562426  0.100147  0.088610 10.619
policonsumo2.lag               0.161177  1.174893  0.054428  0.050466  3.194
edad_al_ing_1                  0.060548  1.062418  0.007416  0.006446  9.393
ano_nac_corr                   0.063469  1.065526  0.007369  0.006388  9.936
susinidum_coc_rec2             0.226938  1.254752  0.122208  0.130113  1.744
susinidum_oh                   0.083881  1.087500  0.093000  0.086277  0.972
susinidum_pbc                  0.163264  1.177348  0.100532  0.094265  1.732
susinidum_mar                  0.107515  1.113507  0.093363  0.086830  1.238
psycom_dum_with_rec2          -0.050914  0.950360  0.029484  0.024602 -2.069
psycom_dum_study              -0.357490  0.699430  0.047553  0.046607 -7.670
freq_cons_dum_5day            -0.012423  0.987654  0.033856  0.029387 -0.423
cond_oc_dum_2inact             0.106389  1.112255  0.055170  0.048125  2.211
cond_oc_dum_3unemp             0.065295  1.067474  0.045224  0.039172  1.667
susprindum_oh                  0.101693  1.107044  0.158048  0.131136  0.775
susprindum_coc                 0.046216  1.047300  0.159165  0.131835  0.351
susprindum_pbc                 0.015162  1.015277  0.154594  0.127081  0.119
susprindum_mar                 0.042951  1.043887  0.177913  0.138399  0.310
                              Pr(&gt;|z|)    
tr_outcome_rec.lag             &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
less_90d_tr1_rec.lag          1.31e-08 ***
comp_bpsc_y3_severe_rec.lag    &lt; 2e-16 ***
policonsumo2.lag                0.0014 ** 
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_coc_rec2              0.0811 .  
susinidum_oh                    0.3309    
susinidum_pbc                   0.0833 .  
susinidum_mar                   0.2156    
psycom_dum_with_rec2            0.0385 *  
psycom_dum_study              1.72e-14 ***
freq_cons_dum_5day              0.6725    
cond_oc_dum_2inact              0.0271 *  
cond_oc_dum_3unemp              0.0955 .  
susprindum_oh                   0.4381    
susprindum_coc                  0.7259    
susprindum_pbc                  0.9050    
susprindum_mar                  0.7563    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               2.6684     0.3748    2.1805    3.2654
log_dias_treat_imp_sin_na.lag    1.3888     0.7200    1.3047    1.4783
less_90d_tr1_rec.lag             1.6202     0.6172    1.3719    1.9134
comp_bpsc_y3_severe_rec.lag      2.5624     0.3903    2.1539    3.0484
policonsumo2.lag                 1.1749     0.8511    1.0642    1.2970
edad_al_ing_1                    1.0624     0.9412    1.0491    1.0759
ano_nac_corr                     1.0655     0.9385    1.0523    1.0790
susinidum_coc_rec2               1.2548     0.7970    0.9723    1.6192
susinidum_oh                     1.0875     0.9195    0.9183    1.2879
susinidum_pbc                    1.1773     0.8494    0.9787    1.4163
susinidum_mar                    1.1135     0.8981    0.9393    1.3201
psycom_dum_with_rec2             0.9504     1.0522    0.9056    0.9973
psycom_dum_study                 0.6994     1.4297    0.6384    0.7663
freq_cons_dum_5day               0.9877     1.0125    0.9324    1.0462
cond_oc_dum_2inact               1.1123     0.8991    1.0121    1.2223
cond_oc_dum_3unemp               1.0675     0.9368    0.9886    1.1527
susprindum_oh                    1.1070     0.9033    0.8561    1.4315
susprindum_coc                   1.0473     0.9548    0.8088    1.3561
susprindum_pbc                   1.0153     0.9850    0.7914    1.3024
susprindum_mar                   1.0439     0.9580    0.7959    1.3692

Concordance= 0.682  (se = 0.003 )
Likelihood ratio test= 1994  on 20 df,   p=&lt;2e-16
Wald test            = 2159  on 20 df,   p=&lt;2e-16
Score (logrank) test = 2003  on 20 df,   p=&lt;2e-16,   Robust = 1726  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb442-6"><a href="#cb442-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb442-7"><a href="#cb442-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb442-8"><a href="#cb442-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb442-9"><a href="#cb442-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb442-10"><a href="#cb442-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 6745, number of events= 4567 </span></span>
<span id="cb442-11"><a href="#cb442-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (637 observations deleted due to missingness)</span></span>
<span id="cb442-12"><a href="#cb442-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb442-13"><a href="#cb442-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se      z Pr(&gt;|z|)    </span></span>
<span id="cb442-14"><a href="#cb442-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag             0.981483  2.668410  0.120321  0.103018  9.527  &lt; 2e-16 ***</span></span>
<span id="cb442-15"><a href="#cb442-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.328445  1.388807  0.021738  0.031862 10.308  &lt; 2e-16 ***</span></span>
<span id="cb442-16"><a href="#cb442-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.482546  1.620195  0.097638  0.084879  5.685 1.31e-08 ***</span></span>
<span id="cb442-17"><a href="#cb442-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.940955  2.562426  0.100147  0.088610 10.619  &lt; 2e-16 ***</span></span>
<span id="cb442-18"><a href="#cb442-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag               0.161177  1.174893  0.054428  0.050466  3.194   0.0014 ** </span></span>
<span id="cb442-19"><a href="#cb442-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.060548  1.062418  0.007416  0.006446  9.393  &lt; 2e-16 ***</span></span>
<span id="cb442-20"><a href="#cb442-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.063469  1.065526  0.007369  0.006388  9.936  &lt; 2e-16 ***</span></span>
<span id="cb442-21"><a href="#cb442-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.226938  1.254752  0.122208  0.130113  1.744   0.0811 .  </span></span>
<span id="cb442-22"><a href="#cb442-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.083881  1.087500  0.093000  0.086277  0.972   0.3309    </span></span>
<span id="cb442-23"><a href="#cb442-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.163264  1.177348  0.100532  0.094265  1.732   0.0833 .  </span></span>
<span id="cb442-24"><a href="#cb442-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.107515  1.113507  0.093363  0.086830  1.238   0.2156    </span></span>
<span id="cb442-25"><a href="#cb442-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2          -0.050914  0.950360  0.029484  0.024602 -2.069   0.0385 *  </span></span>
<span id="cb442-26"><a href="#cb442-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.357490  0.699430  0.047553  0.046607 -7.670 1.72e-14 ***</span></span>
<span id="cb442-27"><a href="#cb442-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day            -0.012423  0.987654  0.033856  0.029387 -0.423   0.6725    </span></span>
<span id="cb442-28"><a href="#cb442-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.106389  1.112255  0.055170  0.048125  2.211   0.0271 *  </span></span>
<span id="cb442-29"><a href="#cb442-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.065295  1.067474  0.045224  0.039172  1.667   0.0955 .  </span></span>
<span id="cb442-30"><a href="#cb442-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  0.101693  1.107044  0.158048  0.131136  0.775   0.4381    </span></span>
<span id="cb442-31"><a href="#cb442-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.046216  1.047300  0.159165  0.131835  0.351   0.7259    </span></span>
<span id="cb442-32"><a href="#cb442-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.015162  1.015277  0.154594  0.127081  0.119   0.9050    </span></span>
<span id="cb442-33"><a href="#cb442-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.042951  1.043887  0.177913  0.138399  0.310   0.7563    </span></span>
<span id="cb442-34"><a href="#cb442-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb442-35"><a href="#cb442-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb442-36"><a href="#cb442-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb442-37"><a href="#cb442-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb442-38"><a href="#cb442-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               2.6684     0.3748    2.1805    3.2654</span></span>
<span id="cb442-39"><a href="#cb442-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.3888     0.7200    1.3047    1.4783</span></span>
<span id="cb442-40"><a href="#cb442-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.6202     0.6172    1.3719    1.9134</span></span>
<span id="cb442-41"><a href="#cb442-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      2.5624     0.3903    2.1539    3.0484</span></span>
<span id="cb442-42"><a href="#cb442-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 1.1749     0.8511    1.0642    1.2970</span></span>
<span id="cb442-43"><a href="#cb442-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.0624     0.9412    1.0491    1.0759</span></span>
<span id="cb442-44"><a href="#cb442-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.0655     0.9385    1.0523    1.0790</span></span>
<span id="cb442-45"><a href="#cb442-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.2548     0.7970    0.9723    1.6192</span></span>
<span id="cb442-46"><a href="#cb442-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.0875     0.9195    0.9183    1.2879</span></span>
<span id="cb442-47"><a href="#cb442-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    1.1773     0.8494    0.9787    1.4163</span></span>
<span id="cb442-48"><a href="#cb442-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.1135     0.8981    0.9393    1.3201</span></span>
<span id="cb442-49"><a href="#cb442-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             0.9504     1.0522    0.9056    0.9973</span></span>
<span id="cb442-50"><a href="#cb442-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.6994     1.4297    0.6384    0.7663</span></span>
<span id="cb442-51"><a href="#cb442-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               0.9877     1.0125    0.9324    1.0462</span></span>
<span id="cb442-52"><a href="#cb442-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               1.1123     0.8991    1.0121    1.2223</span></span>
<span id="cb442-53"><a href="#cb442-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.0675     0.9368    0.9886    1.1527</span></span>
<span id="cb442-54"><a href="#cb442-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    1.1070     0.9033    0.8561    1.4315</span></span>
<span id="cb442-55"><a href="#cb442-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.0473     0.9548    0.8088    1.3561</span></span>
<span id="cb442-56"><a href="#cb442-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.0153     0.9850    0.7914    1.3024</span></span>
<span id="cb442-57"><a href="#cb442-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.0439     0.9580    0.7959    1.3692</span></span>
<span id="cb442-58"><a href="#cb442-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb442-59"><a href="#cb442-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.682  (se = 0.003 )</span></span>
<span id="cb442-60"><a href="#cb442-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 1994  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb442-61"><a href="#cb442-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 2159  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb442-62"><a href="#cb442-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 2003  on 20 df,   p=&lt;2e-16,   Robust = 1726  p=&lt;2e-16</span></span>
<span id="cb442-63"><a href="#cb442-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb442-64"><a href="#cb442-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb442-65"><a href="#cb442-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb442-66"><a href="#cb442-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-67"><a href="#cb442-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-68"><a href="#cb442-68" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb442-69"><a href="#cb442-69" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb442-70"><a href="#cb442-70" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"WO intensive ambulatory"</span>)</span>
<span id="cb442-71"><a href="#cb442-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-72"><a href="#cb442-72" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_wo_ia<span class="ot">&lt;-</span></span>
<span id="cb442-73"><a href="#cb442-73" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb442-74"><a href="#cb442-74" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb442-75"><a href="#cb442-75" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb442-76"><a href="#cb442-76" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb442-77"><a href="#cb442-77" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb442-78"><a href="#cb442-78" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb442-79"><a href="#cb442-79" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb442-80"><a href="#cb442-80" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb442-81"><a href="#cb442-81" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb442-82"><a href="#cb442-82" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb442-83"><a href="#cb442-83" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb442-84"><a href="#cb442-84" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb442-85"><a href="#cb442-85" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb442-86"><a href="#cb442-86" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb442-87"><a href="#cb442-87" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb442-88"><a href="#cb442-88" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb442-89"><a href="#cb442-89" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb442-90"><a href="#cb442-90" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb442-91"><a href="#cb442-91" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb442-92"><a href="#cb442-92" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb442-93"><a href="#cb442-93" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb442-94"><a href="#cb442-94" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb442-95"><a href="#cb442-95" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">4</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb442-96"><a href="#cb442-96" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb442-97"><a href="#cb442-97" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb442-98"><a href="#cb442-98" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb442-99"><a href="#cb442-99" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">4</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb442-100"><a href="#cb442-100" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb442-101"><a href="#cb442-101" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb442-102"><a href="#cb442-102" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb442-103"><a href="#cb442-103" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb442-104"><a href="#cb442-104" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb442-105"><a href="#cb442-105" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb442-106"><a href="#cb442-106" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb442-107"><a href="#cb442-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-108"><a href="#cb442-108" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_ia<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2342, number of events= 1597 
   (163 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se       z
tr_outcome_rec.lag             0.590396  1.804703  0.165929  0.118174   4.996
log_dias_treat_imp_sin_na.lag -0.243294  0.784041  0.022535  0.025535  -9.528
less_90d_tr1_rec.lag          -0.206354  0.813545  0.194073  0.151714  -1.360
comp_bpsc_y3_severe_rec.lag   -0.132974  0.875488  0.164473  0.115583  -1.150
policonsumo2.lag              -0.615544  0.540347  0.061535  0.054363 -11.323
edad_al_ing_1                  0.037924  1.038652  0.012119  0.007974   4.756
ano_nac_corr                   0.042599  1.043519  0.011695  0.007815   5.451
susinidum_coc_rec2            -0.042127  0.958748  0.170050  0.135358  -0.311
susinidum_oh                  -0.025163  0.975151  0.143634  0.096426  -0.261
susinidum_pbc                 -0.020822  0.979393  0.156236  0.108823  -0.191
susinidum_mar                  0.012483  1.012562  0.144243  0.094129   0.133
psycom_dum_with_rec2           0.016660  1.016799  0.049880  0.031631   0.527
psycom_dum_study              -0.275828  0.758943  0.085551  0.072534  -3.803
freq_cons_dum_5day             0.031700  1.032208  0.051667  0.032640   0.971
cond_oc_dum_2inact            -0.018931  0.981247  0.065151  0.042881  -0.441
cond_oc_dum_3unemp            -0.005474  0.994541  0.067826  0.042655  -0.128
susprindum_oh                  0.088216  1.092224  0.183762  0.117491   0.751
susprindum_coc                 0.128627  1.137265  0.186221  0.126652   1.016
susprindum_pbc                 0.100929  1.106199  0.180469  0.123526   0.817
susprindum_mar                 0.086862  1.090746  0.199405  0.140061   0.620
                              Pr(&gt;|z|)    
tr_outcome_rec.lag            5.85e-07 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
less_90d_tr1_rec.lag          0.173783    
comp_bpsc_y3_severe_rec.lag   0.249954    
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                 1.97e-06 ***
ano_nac_corr                  5.00e-08 ***
susinidum_coc_rec2            0.755627    
susinidum_oh                  0.794129    
susinidum_pbc                 0.848260    
susinidum_mar                 0.894494    
psycom_dum_with_rec2          0.598406    
psycom_dum_study              0.000143 ***
freq_cons_dum_5day            0.331444    
cond_oc_dum_2inact            0.658865    
cond_oc_dum_3unemp            0.897892    
susprindum_oh                 0.452755    
susprindum_coc                0.309823    
susprindum_pbc                0.413890    
susprindum_mar                0.535147    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               1.8047     0.5541    1.4316    2.2751
log_dias_treat_imp_sin_na.lag    0.7840     1.2754    0.7458    0.8243
less_90d_tr1_rec.lag             0.8135     1.2292    0.6043    1.0953
comp_bpsc_y3_severe_rec.lag      0.8755     1.1422    0.6980    1.0981
policonsumo2.lag                 0.5403     1.8507    0.4857    0.6011
edad_al_ing_1                    1.0387     0.9628    1.0225    1.0550
ano_nac_corr                     1.0435     0.9583    1.0277    1.0596
susinidum_coc_rec2               0.9587     1.0430    0.7353    1.2500
susinidum_oh                     0.9752     1.0255    0.8072    1.1780
susinidum_pbc                    0.9794     1.0210    0.7913    1.2122
susinidum_mar                    1.0126     0.9876    0.8420    1.2177
psycom_dum_with_rec2             1.0168     0.9835    0.9557    1.0818
psycom_dum_study                 0.7589     1.3176    0.6584    0.8749
freq_cons_dum_5day               1.0322     0.9688    0.9682    1.1004
cond_oc_dum_2inact               0.9812     1.0191    0.9021    1.0673
cond_oc_dum_3unemp               0.9945     1.0055    0.9148    1.0813
susprindum_oh                    1.0922     0.9156    0.8676    1.3751
susprindum_coc                   1.1373     0.8793    0.8873    1.4577
susprindum_pbc                   1.1062     0.9040    0.8683    1.4092
susprindum_mar                   1.0907     0.9168    0.8289    1.4353

Concordance= 0.634  (se = 0.006 )
Likelihood ratio test= 334.3  on 20 df,   p=&lt;2e-16
Wald test            = 467.2  on 20 df,   p=&lt;2e-16
Score (logrank) test = 346.7  on 20 df,   p=&lt;2e-16,   Robust = 401.6  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb444-8"><a href="#cb444-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb444-9"><a href="#cb444-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-10"><a href="#cb444-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 2342, number of events= 1597 </span></span>
<span id="cb444-11"><a href="#cb444-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (163 observations deleted due to missingness)</span></span>
<span id="cb444-12"><a href="#cb444-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-13"><a href="#cb444-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     coef  exp(coef)   se(coef)  robust se       z Pr(&gt;|z|)    </span></span>
<span id="cb444-14"><a href="#cb444-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag             0.0960769  1.1008437  0.1608893  0.1073787   0.895 0.370922    </span></span>
<span id="cb444-15"><a href="#cb444-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.0601846  1.0620325  0.0341951  0.0323800   1.859 0.063070 .  </span></span>
<span id="cb444-16"><a href="#cb444-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.3920119  1.4799554  0.1955210  0.1410453   2.779 0.005447 ** </span></span>
<span id="cb444-17"><a href="#cb444-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.0021099  1.0021122  0.1634728  0.1074412   0.020 0.984332    </span></span>
<span id="cb444-18"><a href="#cb444-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag              -0.8194113  0.4406910  0.0577374  0.0471515 -17.378  &lt; 2e-16 ***</span></span>
<span id="cb444-19"><a href="#cb444-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.0264262  1.0267785  0.0120769  0.0079482   3.325 0.000885 ***</span></span>
<span id="cb444-20"><a href="#cb444-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.0326238  1.0331618  0.0116686  0.0077493   4.210 2.55e-05 ***</span></span>
<span id="cb444-21"><a href="#cb444-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.0065845  1.0066062  0.1708421  0.1250574   0.053 0.958010    </span></span>
<span id="cb444-22"><a href="#cb444-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.0354693  1.0361059  0.1442859  0.1006518   0.352 0.724541    </span></span>
<span id="cb444-23"><a href="#cb444-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.0354305  1.0360656  0.1568797  0.1101749   0.322 0.747768    </span></span>
<span id="cb444-24"><a href="#cb444-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.0902561  1.0944546  0.1448738  0.0980071   0.921 0.357095    </span></span>
<span id="cb444-25"><a href="#cb444-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2           0.0288659  1.0292865  0.0500612  0.0300631   0.960 0.336967    </span></span>
<span id="cb444-26"><a href="#cb444-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.2367838  0.7891619  0.0863122  0.0688161  -3.441 0.000580 ***</span></span>
<span id="cb444-27"><a href="#cb444-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.0330127  1.0335637  0.0517079  0.0316338   1.044 0.296676    </span></span>
<span id="cb444-28"><a href="#cb444-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact            -0.0004428  0.9995573  0.0653684  0.0422072  -0.010 0.991630    </span></span>
<span id="cb444-29"><a href="#cb444-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp            -0.0078465  0.9921842  0.0678832  0.0425011  -0.185 0.853528    </span></span>
<span id="cb444-30"><a href="#cb444-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  0.0346128  1.0352188  0.1838352  0.1319090   0.262 0.793014    </span></span>
<span id="cb444-31"><a href="#cb444-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.1080539  1.1141078  0.1862425  0.1412067   0.765 0.444142    </span></span>
<span id="cb444-32"><a href="#cb444-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.1142682  1.1210528  0.1808628  0.1382042   0.827 0.408346    </span></span>
<span id="cb444-33"><a href="#cb444-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.1072029  1.1131601  0.1989858  0.1539935   0.696 0.486334    </span></span>
<span id="cb444-34"><a href="#cb444-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb444-35"><a href="#cb444-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb444-36"><a href="#cb444-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-37"><a href="#cb444-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb444-38"><a href="#cb444-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               1.1008     0.9084    0.8919    1.3587</span></span>
<span id="cb444-39"><a href="#cb444-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.0620     0.9416    0.9967    1.1316</span></span>
<span id="cb444-40"><a href="#cb444-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.4800     0.6757    1.1225    1.9512</span></span>
<span id="cb444-41"><a href="#cb444-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.0021     0.9979    0.8118    1.2370</span></span>
<span id="cb444-42"><a href="#cb444-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.4407     2.2692    0.4018    0.4834</span></span>
<span id="cb444-43"><a href="#cb444-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.0268     0.9739    1.0109    1.0429</span></span>
<span id="cb444-44"><a href="#cb444-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.0332     0.9679    1.0176    1.0490</span></span>
<span id="cb444-45"><a href="#cb444-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.0066     0.9934    0.7878    1.2862</span></span>
<span id="cb444-46"><a href="#cb444-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.0361     0.9652    0.8506    1.2621</span></span>
<span id="cb444-47"><a href="#cb444-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    1.0361     0.9652    0.8348    1.2858</span></span>
<span id="cb444-48"><a href="#cb444-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.0945     0.9137    0.9032    1.3262</span></span>
<span id="cb444-49"><a href="#cb444-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             1.0293     0.9715    0.9704    1.0918</span></span>
<span id="cb444-50"><a href="#cb444-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.7892     1.2672    0.6896    0.9031</span></span>
<span id="cb444-51"><a href="#cb444-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               1.0336     0.9675    0.9714    1.0997</span></span>
<span id="cb444-52"><a href="#cb444-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               0.9996     1.0004    0.9202    1.0858</span></span>
<span id="cb444-53"><a href="#cb444-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               0.9922     1.0079    0.9129    1.0784</span></span>
<span id="cb444-54"><a href="#cb444-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    1.0352     0.9660    0.7994    1.3406</span></span>
<span id="cb444-55"><a href="#cb444-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.1141     0.8976    0.8448    1.4693</span></span>
<span id="cb444-56"><a href="#cb444-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.1211     0.8920    0.8550    1.4698</span></span>
<span id="cb444-57"><a href="#cb444-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.1132     0.8983    0.8231    1.5053</span></span>
<span id="cb444-58"><a href="#cb444-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-59"><a href="#cb444-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.627  (se = 0.005 )</span></span>
<span id="cb444-60"><a href="#cb444-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 226.7  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb444-61"><a href="#cb444-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 427.2  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb444-62"><a href="#cb444-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 241.2  on 20 df,   p=&lt;2e-16,   Robust = 343  p=&lt;2e-16</span></span>
<span id="cb444-63"><a href="#cb444-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb444-64"><a href="#cb444-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb444-65"><a href="#cb444-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb444-66"><a href="#cb444-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-67"><a href="#cb444-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_ia<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.336   0.616   1.124   1.368   1.966   5.427 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5302  0.9069  1.1501  1.3870  1.8680  3.0902 </span></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-6"><a href="#cb446-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-7"><a href="#cb446-7" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_wo_ia_alt<span class="ot">&lt;-</span></span>
<span id="cb446-8"><a href="#cb446-8" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb446-9"><a href="#cb446-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb446-10"><a href="#cb446-10" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb446-11"><a href="#cb446-11" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb446-12"><a href="#cb446-12" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb446-13"><a href="#cb446-13" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb446-14"><a href="#cb446-14" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb446-15"><a href="#cb446-15" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb446-16"><a href="#cb446-16" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb446-17"><a href="#cb446-17" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb446-18"><a href="#cb446-18" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb446-19"><a href="#cb446-19" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb446-20"><a href="#cb446-20" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb446-21"><a href="#cb446-21" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb446-22"><a href="#cb446-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb446-23"><a href="#cb446-23" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb446-24"><a href="#cb446-24" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb446-25"><a href="#cb446-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb446-26"><a href="#cb446-26" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb446-27"><a href="#cb446-27" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb446-28"><a href="#cb446-28" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb446-29"><a href="#cb446-29" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb446-30"><a href="#cb446-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">4</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb446-31"><a href="#cb446-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb446-32"><a href="#cb446-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb446-33"><a href="#cb446-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb446-34"><a href="#cb446-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">4</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb446-35"><a href="#cb446-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb446-36"><a href="#cb446-36" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb446-37"><a href="#cb446-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb446-38"><a href="#cb446-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb446-39"><a href="#cb446-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb446-40"><a href="#cb446-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb446-41"><a href="#cb446-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb446-42"><a href="#cb446-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-43"><a href="#cb446-43" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_ia_alt<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2342, number of events= 1597 
   (163 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se      z
tr_outcome_rec.lag             2.07668   7.97793  0.18951   0.17050 12.180
log_dias_treat_imp_sin_na.lag  0.48119   1.61800  0.04878   0.05862  8.208
less_90d_tr1_rec.lag           0.53253   1.70324  0.15975   0.12591  4.230
comp_bpsc_y3_severe_rec.lag    0.24739   1.28067  0.13099   0.12212  2.026
policonsumo2.lag              -0.06660   0.93557  0.07911   0.07156 -0.931
edad_al_ing_1                  0.10711   1.11305  0.01271   0.01175  9.116
ano_nac_corr                   0.11118   1.11759  0.01230   0.01146  9.705
susinidum_coc_rec2            -0.19912   0.81945  0.16603   0.16462 -1.210
susinidum_oh                  -0.24978   0.77897  0.14191   0.12065 -2.070
susinidum_pbc                 -0.07015   0.93225  0.15381   0.13115 -0.535
susinidum_mar                 -0.14500   0.86502  0.14235   0.11908 -1.218
psycom_dum_with_rec2          -0.03390   0.96667  0.05027   0.04078 -0.831
psycom_dum_study              -0.22053   0.80210  0.08298   0.08202 -2.689
freq_cons_dum_5day             0.03082   1.03130  0.05150   0.04617  0.668
cond_oc_dum_2inact             0.02049   1.02070  0.06522   0.06013  0.341
cond_oc_dum_3unemp            -0.01038   0.98968  0.06734   0.06267 -0.166
susprindum_oh                  0.03448   1.03508  0.18281   0.17658  0.195
susprindum_coc                 0.06938   1.07184  0.18629   0.18800  0.369
susprindum_pbc                 0.11002   1.11631  0.18066   0.18587  0.592
susprindum_mar                 0.05398   1.05546  0.19901   0.20360  0.265
                              Pr(&gt;|z|)    
tr_outcome_rec.lag             &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag 2.24e-16 ***
less_90d_tr1_rec.lag          2.34e-05 ***
comp_bpsc_y3_severe_rec.lag    0.04280 *  
policonsumo2.lag               0.35204    
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_coc_rec2             0.22642    
susinidum_oh                   0.03842 *  
susinidum_pbc                  0.59273    
susinidum_mar                  0.22334    
psycom_dum_with_rec2           0.40585    
psycom_dum_study               0.00717 ** 
freq_cons_dum_5day             0.50442    
cond_oc_dum_2inact             0.73326    
cond_oc_dum_3unemp             0.86850    
susprindum_oh                  0.84517    
susprindum_coc                 0.71210    
susprindum_pbc                 0.55390    
susprindum_mar                 0.79092    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               7.9779     0.1253    5.7117   11.1434
log_dias_treat_imp_sin_na.lag    1.6180     0.6180    1.4424    1.8150
less_90d_tr1_rec.lag             1.7032     0.5871    1.3308    2.1799
comp_bpsc_y3_severe_rec.lag      1.2807     0.7808    1.0081    1.6270
policonsumo2.lag                 0.9356     1.0689    0.8131    1.0764
edad_al_ing_1                    1.1131     0.8984    1.0877    1.1390
ano_nac_corr                     1.1176     0.8948    1.0928    1.1430
susinidum_coc_rec2               0.8194     1.2203    0.5935    1.1315
susinidum_oh                     0.7790     1.2837    0.6149    0.9868
susinidum_pbc                    0.9323     1.0727    0.7209    1.2055
susinidum_mar                    0.8650     1.1560    0.6850    1.0924
psycom_dum_with_rec2             0.9667     1.0345    0.8924    1.0471
psycom_dum_study                 0.8021     1.2467    0.6830    0.9420
freq_cons_dum_5day               1.0313     0.9696    0.9421    1.1290
cond_oc_dum_2inact               1.0207     0.9797    0.9072    1.1484
cond_oc_dum_3unemp               0.9897     1.0104    0.8753    1.1190
susprindum_oh                    1.0351     0.9661    0.7323    1.4631
susprindum_coc                   1.0718     0.9330    0.7415    1.5494
susprindum_pbc                   1.1163     0.8958    0.7755    1.6069
susprindum_mar                   1.0555     0.9475    0.7082    1.5731

Concordance= 0.697  (se = 0.006 )
Likelihood ratio test= 817.7  on 20 df,   p=&lt;2e-16
Wald test            = 852.1  on 20 df,   p=&lt;2e-16
Score (logrank) test = 848  on 20 df,   p=&lt;2e-16,   Robust = 632.9  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 2342, number of events= 1597 </span></span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (163 observations deleted due to missingness)</span></span>
<span id="cb448-12"><a href="#cb448-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb448-13"><a href="#cb448-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   coef exp(coef) se(coef) robust se      z Pr(&gt;|z|)    </span></span>
<span id="cb448-14"><a href="#cb448-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag             2.07668   7.97793  0.18951   0.17050 12.180  &lt; 2e-16 ***</span></span>
<span id="cb448-15"><a href="#cb448-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.48119   1.61800  0.04878   0.05862  8.208 2.24e-16 ***</span></span>
<span id="cb448-16"><a href="#cb448-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.53253   1.70324  0.15975   0.12591  4.230 2.34e-05 ***</span></span>
<span id="cb448-17"><a href="#cb448-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.24739   1.28067  0.13099   0.12212  2.026  0.04280 *  </span></span>
<span id="cb448-18"><a href="#cb448-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag              -0.06660   0.93557  0.07911   0.07156 -0.931  0.35204    </span></span>
<span id="cb448-19"><a href="#cb448-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.10711   1.11305  0.01271   0.01175  9.116  &lt; 2e-16 ***</span></span>
<span id="cb448-20"><a href="#cb448-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.11118   1.11759  0.01230   0.01146  9.705  &lt; 2e-16 ***</span></span>
<span id="cb448-21"><a href="#cb448-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2            -0.19912   0.81945  0.16603   0.16462 -1.210  0.22642    </span></span>
<span id="cb448-22"><a href="#cb448-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                  -0.24978   0.77897  0.14191   0.12065 -2.070  0.03842 *  </span></span>
<span id="cb448-23"><a href="#cb448-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                 -0.07015   0.93225  0.15381   0.13115 -0.535  0.59273    </span></span>
<span id="cb448-24"><a href="#cb448-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                 -0.14500   0.86502  0.14235   0.11908 -1.218  0.22334    </span></span>
<span id="cb448-25"><a href="#cb448-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2          -0.03390   0.96667  0.05027   0.04078 -0.831  0.40585    </span></span>
<span id="cb448-26"><a href="#cb448-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.22053   0.80210  0.08298   0.08202 -2.689  0.00717 ** </span></span>
<span id="cb448-27"><a href="#cb448-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.03082   1.03130  0.05150   0.04617  0.668  0.50442    </span></span>
<span id="cb448-28"><a href="#cb448-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.02049   1.02070  0.06522   0.06013  0.341  0.73326    </span></span>
<span id="cb448-29"><a href="#cb448-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp            -0.01038   0.98968  0.06734   0.06267 -0.166  0.86850    </span></span>
<span id="cb448-30"><a href="#cb448-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  0.03448   1.03508  0.18281   0.17658  0.195  0.84517    </span></span>
<span id="cb448-31"><a href="#cb448-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.06938   1.07184  0.18629   0.18800  0.369  0.71210    </span></span>
<span id="cb448-32"><a href="#cb448-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.11002   1.11631  0.18066   0.18587  0.592  0.55390    </span></span>
<span id="cb448-33"><a href="#cb448-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.05398   1.05546  0.19901   0.20360  0.265  0.79092    </span></span>
<span id="cb448-34"><a href="#cb448-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb448-35"><a href="#cb448-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb448-36"><a href="#cb448-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb448-37"><a href="#cb448-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb448-38"><a href="#cb448-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               7.9779     0.1253    5.7117   11.1434</span></span>
<span id="cb448-39"><a href="#cb448-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.6180     0.6180    1.4424    1.8150</span></span>
<span id="cb448-40"><a href="#cb448-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.7032     0.5871    1.3308    2.1799</span></span>
<span id="cb448-41"><a href="#cb448-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.2807     0.7808    1.0081    1.6270</span></span>
<span id="cb448-42"><a href="#cb448-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.9356     1.0689    0.8131    1.0764</span></span>
<span id="cb448-43"><a href="#cb448-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.1131     0.8984    1.0877    1.1390</span></span>
<span id="cb448-44"><a href="#cb448-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.1176     0.8948    1.0928    1.1430</span></span>
<span id="cb448-45"><a href="#cb448-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               0.8194     1.2203    0.5935    1.1315</span></span>
<span id="cb448-46"><a href="#cb448-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     0.7790     1.2837    0.6149    0.9868</span></span>
<span id="cb448-47"><a href="#cb448-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    0.9323     1.0727    0.7209    1.2055</span></span>
<span id="cb448-48"><a href="#cb448-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    0.8650     1.1560    0.6850    1.0924</span></span>
<span id="cb448-49"><a href="#cb448-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             0.9667     1.0345    0.8924    1.0471</span></span>
<span id="cb448-50"><a href="#cb448-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.8021     1.2467    0.6830    0.9420</span></span>
<span id="cb448-51"><a href="#cb448-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               1.0313     0.9696    0.9421    1.1290</span></span>
<span id="cb448-52"><a href="#cb448-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               1.0207     0.9797    0.9072    1.1484</span></span>
<span id="cb448-53"><a href="#cb448-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               0.9897     1.0104    0.8753    1.1190</span></span>
<span id="cb448-54"><a href="#cb448-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    1.0351     0.9661    0.7323    1.4631</span></span>
<span id="cb448-55"><a href="#cb448-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.0718     0.9330    0.7415    1.5494</span></span>
<span id="cb448-56"><a href="#cb448-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   1.1163     0.8958    0.7755    1.6069</span></span>
<span id="cb448-57"><a href="#cb448-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.0555     0.9475    0.7082    1.5731</span></span>
<span id="cb448-58"><a href="#cb448-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb448-59"><a href="#cb448-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.697  (se = 0.006 )</span></span>
<span id="cb448-60"><a href="#cb448-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 817.7  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb448-61"><a href="#cb448-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 852.1  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb448-62"><a href="#cb448-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 848  on 20 df,   p=&lt;2e-16,   Robust = 632.9  p=&lt;2e-16</span></span>
<span id="cb448-63"><a href="#cb448-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb448-64"><a href="#cb448-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb448-65"><a href="#cb448-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb448-66"><a href="#cb448-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-67"><a href="#cb448-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_ia_alt<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1065  0.2508  0.7104  1.3025  1.8834 27.4746 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.1065  0.2508  0.7104  1.3025  1.8834 27.4746 </span></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"WO residential"</span>)</span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_wo_res<span class="ot">&lt;-</span></span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb450-11"><a href="#cb450-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb450-12"><a href="#cb450-12" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb450-13"><a href="#cb450-13" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb450-14"><a href="#cb450-14" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb450-15"><a href="#cb450-15" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb450-16"><a href="#cb450-16" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb450-17"><a href="#cb450-17" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb450-18"><a href="#cb450-18" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb450-19"><a href="#cb450-19" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb450-20"><a href="#cb450-20" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb450-21"><a href="#cb450-21" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb450-22"><a href="#cb450-22" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb450-23"><a href="#cb450-23" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb450-24"><a href="#cb450-24" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb450-25"><a href="#cb450-25" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb450-26"><a href="#cb450-26" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb450-27"><a href="#cb450-27" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb450-28"><a href="#cb450-28" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb450-29"><a href="#cb450-29" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb450-30"><a href="#cb450-30" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb450-31"><a href="#cb450-31" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb450-32"><a href="#cb450-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">5</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb450-33"><a href="#cb450-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb450-34"><a href="#cb450-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb450-35"><a href="#cb450-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb450-36"><a href="#cb450-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">5</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb450-37"><a href="#cb450-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb450-38"><a href="#cb450-38" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb450-39"><a href="#cb450-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb450-40"><a href="#cb450-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb450-41"><a href="#cb450-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb450-42"><a href="#cb450-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb450-43"><a href="#cb450-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb450-44"><a href="#cb450-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-45"><a href="#cb450-45" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_res<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 3189, number of events= 2153 
   (381 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se       z
tr_outcome_rec.lag            -0.121612  0.885492  0.165763  0.129366  -0.940
log_dias_treat_imp_sin_na.lag -0.130201  0.877919  0.014462  0.014401  -9.041
less_90d_tr1_rec.lag           0.090970  1.095236  0.149749  0.121156   0.751
comp_bpsc_y3_severe_rec.lag    0.404439  1.498462  0.142265  0.111507   3.627
policonsumo2.lag              -0.669071  0.512184  0.052846  0.047637 -14.045
edad_al_ing_1                  0.033148  1.033703  0.010263  0.006975   4.752
ano_nac_corr                   0.039915  1.040723  0.009991  0.006723   5.937
susinidum_coc_rec2             0.423752  1.527683  0.156368  0.113984   3.718
susinidum_oh                   0.340455  1.405586  0.131706  0.085631   3.976
susinidum_pbc                  0.248609  1.282241  0.138130  0.094813   2.622
susinidum_mar                  0.339920  1.404836  0.132224  0.085995   3.953
psycom_dum_with_rec2           0.080161  1.083462  0.047830  0.034178   2.345
psycom_dum_study              -0.359226  0.698216  0.069917  0.058469  -6.144
freq_cons_dum_5day            -0.014932  0.985179  0.050738  0.034074  -0.438
cond_oc_dum_2inact             0.017569  1.017725  0.081296  0.053721   0.327
cond_oc_dum_3unemp             0.089596  1.093733  0.081392  0.054694   1.638
susprindum_oh                 -0.081599  0.921642  0.147882  0.078177  -1.044
susprindum_coc                 0.046968  1.048088  0.149001  0.085066   0.552
susprindum_pbc                -0.045903  0.955134  0.139802  0.074248  -0.618
susprindum_mar                 0.120782  1.128378  0.210478  0.124728   0.968
                              Pr(&gt;|z|)    
tr_outcome_rec.lag            0.347187    
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
less_90d_tr1_rec.lag          0.452744    
comp_bpsc_y3_severe_rec.lag   0.000287 ***
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                 2.01e-06 ***
ano_nac_corr                  2.89e-09 ***
susinidum_coc_rec2            0.000201 ***
susinidum_oh                  7.01e-05 ***
susinidum_pbc                 0.008739 ** 
susinidum_mar                 7.72e-05 ***
psycom_dum_with_rec2          0.019005 *  
psycom_dum_study              8.05e-10 ***
freq_cons_dum_5day            0.661225    
cond_oc_dum_2inact            0.743632    
cond_oc_dum_3unemp            0.101394    
susprindum_oh                 0.296592    
susprindum_coc                0.580858    
susprindum_pbc                0.536413    
susprindum_mar                0.332866    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               0.8855     1.1293    0.6872    1.1410
log_dias_treat_imp_sin_na.lag    0.8779     1.1391    0.8535    0.9031
less_90d_tr1_rec.lag             1.0952     0.9130    0.8637    1.3888
comp_bpsc_y3_severe_rec.lag      1.4985     0.6674    1.2043    1.8645
policonsumo2.lag                 0.5122     1.9524    0.4665    0.5623
edad_al_ing_1                    1.0337     0.9674    1.0197    1.0479
ano_nac_corr                     1.0407     0.9609    1.0271    1.0545
susinidum_coc_rec2               1.5277     0.6546    1.2218    1.9101
susinidum_oh                     1.4056     0.7114    1.1884    1.6624
susinidum_pbc                    1.2822     0.7799    1.0648    1.5441
susinidum_mar                    1.4048     0.7118    1.1869    1.6627
psycom_dum_with_rec2             1.0835     0.9230    1.0133    1.1585
psycom_dum_study                 0.6982     1.4322    0.6226    0.7830
freq_cons_dum_5day               0.9852     1.0150    0.9215    1.0532
cond_oc_dum_2inact               1.0177     0.9826    0.9160    1.1307
cond_oc_dum_3unemp               1.0937     0.9143    0.9826    1.2175
susprindum_oh                    0.9216     1.0850    0.7907    1.0743
susprindum_coc                   1.0481     0.9541    0.8871    1.2382
susprindum_pbc                   0.9551     1.0470    0.8258    1.1048
susprindum_mar                   1.1284     0.8862    0.8837    1.4409

Concordance= 0.612  (se = 0.005 )
Likelihood ratio test= 365.4  on 20 df,   p=&lt;2e-16
Wald test            = 543  on 20 df,   p=&lt;2e-16
Score (logrank) test = 379.9  on 20 df,   p=&lt;2e-16,   Robust = 480.8  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb452-7"><a href="#cb452-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb452-8"><a href="#cb452-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb452-9"><a href="#cb452-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb452-10"><a href="#cb452-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 3189, number of events= 2153 </span></span>
<span id="cb452-11"><a href="#cb452-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (381 observations deleted due to missingness)</span></span>
<span id="cb452-12"><a href="#cb452-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb452-13"><a href="#cb452-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    coef exp(coef)  se(coef) robust se       z Pr(&gt;|z|)    </span></span>
<span id="cb452-14"><a href="#cb452-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag            -0.126675  0.881020  0.163284  0.124402  -1.018 0.308550    </span></span>
<span id="cb452-15"><a href="#cb452-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.031652  1.032159  0.022850  0.021963   1.441 0.149546    </span></span>
<span id="cb452-16"><a href="#cb452-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.363190  1.437908  0.157358  0.121227   2.996 0.002736 ** </span></span>
<span id="cb452-17"><a href="#cb452-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.349023  1.417682  0.139042  0.107539   3.246 0.001172 ** </span></span>
<span id="cb452-18"><a href="#cb452-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag              -0.778676  0.459014  0.050648  0.044979 -17.312  &lt; 2e-16 ***</span></span>
<span id="cb452-19"><a href="#cb452-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.023880  1.024168  0.010199  0.006895   3.463 0.000534 ***</span></span>
<span id="cb452-20"><a href="#cb452-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.030909  1.031392  0.009928  0.006625   4.666 3.07e-06 ***</span></span>
<span id="cb452-21"><a href="#cb452-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.353985  1.424734  0.156986  0.101414   3.490 0.000482 ***</span></span>
<span id="cb452-22"><a href="#cb452-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.291847  1.338899  0.132369  0.078022   3.741 0.000184 ***</span></span>
<span id="cb452-23"><a href="#cb452-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.186272  1.204750  0.138703  0.088234   2.111 0.034763 *  </span></span>
<span id="cb452-24"><a href="#cb452-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.294218  1.342076  0.132819  0.078394   3.753 0.000175 ***</span></span>
<span id="cb452-25"><a href="#cb452-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2           0.075649  1.078584  0.048007  0.033882   2.233 0.025566 *  </span></span>
<span id="cb452-26"><a href="#cb452-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.341685  0.710572  0.070190  0.057146  -5.979 2.24e-09 ***</span></span>
<span id="cb452-27"><a href="#cb452-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day            -0.020624  0.979587  0.050671  0.033925  -0.608 0.543239    </span></span>
<span id="cb452-28"><a href="#cb452-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.011996  1.012068  0.081341  0.053444   0.224 0.822402    </span></span>
<span id="cb452-29"><a href="#cb452-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.076550  1.079556  0.081384  0.054527   1.404 0.160354    </span></span>
<span id="cb452-30"><a href="#cb452-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.077120  0.925778  0.148321  0.077766  -0.992 0.321346    </span></span>
<span id="cb452-31"><a href="#cb452-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.072353  1.075035  0.149194  0.083542   0.866 0.386453    </span></span>
<span id="cb452-32"><a href="#cb452-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                -0.011860  0.988210  0.140132  0.073586  -0.161 0.871956    </span></span>
<span id="cb452-33"><a href="#cb452-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.154065  1.166566  0.210712  0.124652   1.236 0.216472    </span></span>
<span id="cb452-34"><a href="#cb452-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb452-35"><a href="#cb452-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb452-36"><a href="#cb452-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb452-37"><a href="#cb452-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb452-38"><a href="#cb452-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               0.8810     1.1350    0.6904    1.1243</span></span>
<span id="cb452-39"><a href="#cb452-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.0322     0.9688    0.9887    1.0776</span></span>
<span id="cb452-40"><a href="#cb452-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.4379     0.6955    1.1338    1.8236</span></span>
<span id="cb452-41"><a href="#cb452-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      1.4177     0.7054    1.1483    1.7503</span></span>
<span id="cb452-42"><a href="#cb452-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 0.4590     2.1786    0.4203    0.5013</span></span>
<span id="cb452-43"><a href="#cb452-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.0242     0.9764    1.0104    1.0381</span></span>
<span id="cb452-44"><a href="#cb452-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.0314     0.9696    1.0181    1.0449</span></span>
<span id="cb452-45"><a href="#cb452-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.4247     0.7019    1.1679    1.7380</span></span>
<span id="cb452-46"><a href="#cb452-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.3389     0.7469    1.1490    1.5601</span></span>
<span id="cb452-47"><a href="#cb452-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    1.2047     0.8300    1.0134    1.4322</span></span>
<span id="cb452-48"><a href="#cb452-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.3421     0.7451    1.1509    1.5650</span></span>
<span id="cb452-49"><a href="#cb452-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             1.0786     0.9271    1.0093    1.1526</span></span>
<span id="cb452-50"><a href="#cb452-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.7106     1.4073    0.6353    0.7948</span></span>
<span id="cb452-51"><a href="#cb452-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               0.9796     1.0208    0.9166    1.0469</span></span>
<span id="cb452-52"><a href="#cb452-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               1.0121     0.9881    0.9114    1.1238</span></span>
<span id="cb452-53"><a href="#cb452-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.0796     0.9263    0.9701    1.2013</span></span>
<span id="cb452-54"><a href="#cb452-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    0.9258     1.0802    0.7949    1.0782</span></span>
<span id="cb452-55"><a href="#cb452-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.0750     0.9302    0.9127    1.2663</span></span>
<span id="cb452-56"><a href="#cb452-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   0.9882     1.0119    0.8555    1.1415</span></span>
<span id="cb452-57"><a href="#cb452-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   1.1666     0.8572    0.9137    1.4894</span></span>
<span id="cb452-58"><a href="#cb452-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb452-59"><a href="#cb452-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.612  (se = 0.005 )</span></span>
<span id="cb452-60"><a href="#cb452-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 298.2  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb452-61"><a href="#cb452-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 480.2  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb452-62"><a href="#cb452-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 312.9  on 20 df,   p=&lt;2e-16,   Robust = 428.9  p=&lt;2e-16</span></span>
<span id="cb452-63"><a href="#cb452-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb452-64"><a href="#cb452-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb452-65"><a href="#cb452-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb452-66"><a href="#cb452-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-67"><a href="#cb452-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_res<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.2809  0.6732  1.0225  1.1916  1.6473  3.6104 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.4578  0.8652  1.2333  1.3288  1.6967  4.6168 </span></span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a>iiw_model_after_ph_wo_res_alt<span class="ot">&lt;-</span></span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb454-10"><a href="#cb454-10" aria-hidden="true" tabindex="-1"></a>            tr_outcome_rec.lag <span class="sc">+</span></span>
<span id="cb454-11"><a href="#cb454-11" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb454-12"><a href="#cb454-12" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1_rec.lag<span class="sc">+</span></span>
<span id="cb454-13"><a href="#cb454-13" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe_rec.lag <span class="sc">+</span> </span>
<span id="cb454-14"><a href="#cb454-14" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb454-15"><a href="#cb454-15" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb454-16"><a href="#cb454-16" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb454-17"><a href="#cb454-17" aria-hidden="true" tabindex="-1"></a>            susinidum_coc_rec2 <span class="sc">+</span></span>
<span id="cb454-18"><a href="#cb454-18" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb454-19"><a href="#cb454-19" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb454-20"><a href="#cb454-20" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb454-21"><a href="#cb454-21" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with_rec2 <span class="sc">+</span></span>
<span id="cb454-22"><a href="#cb454-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb454-23"><a href="#cb454-23" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb454-24"><a href="#cb454-24" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb454-25"><a href="#cb454-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb454-26"><a href="#cb454-26" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb454-27"><a href="#cb454-27" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb454-28"><a href="#cb454-28" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb454-29"><a href="#cb454-29" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb454-30"><a href="#cb454-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span> levels_tipo_de_plan_2_mod[[<span class="dv">5</span>]]) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb454-31"><a href="#cb454-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb454-32"><a href="#cb454-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb454-33"><a href="#cb454-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb454-34"><a href="#cb454-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span>  maxfu.id <span class="sc">%in%</span> <span class="fu">subset</span>(data_mine_miss_restr_proc2, tipo_de_plan_2_mod<span class="sc">==</span>levels_tipo_de_plan_2_mod[[<span class="dv">5</span>]])<span class="sc">$</span>id) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb454-35"><a href="#cb454-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb454-36"><a href="#cb454-36" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb454-37"><a href="#cb454-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc_rec2"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with_rec2"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb454-38"><a href="#cb454-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome_rec"</span>, <span class="st">"comp_bpsc_y3_severe_rec"</span>, <span class="st">"less_90d_tr1_rec"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb454-39"><a href="#cb454-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb454-40"><a href="#cb454-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb454-41"><a href="#cb454-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb454-42"><a href="#cb454-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-43"><a href="#cb454-43" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_res_alt<span class="sc">$</span>m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + 
    log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + 
    susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 3189, number of events= 2153 
   (381 observations deleted due to missingness)

                                    coef  exp(coef)   se(coef)  robust se
tr_outcome_rec.lag             0.7205801  2.0556254  0.1852413  0.1688667
log_dias_treat_imp_sin_na.lag  0.2567171  1.2926793  0.0273630  0.0340385
less_90d_tr1_rec.lag           0.6130288  1.8460141  0.1493355  0.1272692
comp_bpsc_y3_severe_rec.lag    0.8473593  2.3334766  0.1535169  0.1444312
policonsumo2.lag               0.0184737  1.0186454  0.0734914  0.0667181
edad_al_ing_1                  0.0575836  1.0592739  0.0104369  0.0089922
ano_nac_corr                   0.0650981  1.0672637  0.0101748  0.0087168
susinidum_coc_rec2             0.3116140  1.3656274  0.1602666  0.1367453
susinidum_oh                   0.1895267  1.2086774  0.1337491  0.0914487
susinidum_pbc                  0.1983614  1.2194030  0.1404151  0.1021221
susinidum_mar                  0.1989101  1.2200723  0.1343948  0.0922898
psycom_dum_with_rec2          -0.0087068  0.9913310  0.0483988  0.0404580
psycom_dum_study              -0.3746894  0.6875028  0.0680287  0.0652967
freq_cons_dum_5day             0.0004056  1.0004056  0.0506595  0.0444514
cond_oc_dum_2inact             0.0813419  1.0847417  0.0809746  0.0759279
cond_oc_dum_3unemp             0.1300692  1.1389072  0.0814469  0.0765984
susprindum_oh                 -0.1079311  0.8976894  0.1483977  0.1155415
susprindum_coc                 0.0027078  1.0027114  0.1498413  0.1207600
susprindum_pbc                -0.0637471  0.9382423  0.1407408  0.1099733
susprindum_mar                -0.0838286  0.9195888  0.2112160  0.1592995
                                   z Pr(&gt;|z|)    
tr_outcome_rec.lag             4.267 1.98e-05 ***
log_dias_treat_imp_sin_na.lag  7.542 4.63e-14 ***
less_90d_tr1_rec.lag           4.817 1.46e-06 ***
comp_bpsc_y3_severe_rec.lag    5.867 4.44e-09 ***
policonsumo2.lag               0.277   0.7819    
edad_al_ing_1                  6.404 1.52e-10 ***
ano_nac_corr                   7.468 8.14e-14 ***
susinidum_coc_rec2             2.279   0.0227 *  
susinidum_oh                   2.072   0.0382 *  
susinidum_pbc                  1.942   0.0521 .  
susinidum_mar                  2.155   0.0311 *  
psycom_dum_with_rec2          -0.215   0.8296    
psycom_dum_study              -5.738 9.57e-09 ***
freq_cons_dum_5day             0.009   0.9927    
cond_oc_dum_2inact             1.071   0.2840    
cond_oc_dum_3unemp             1.698   0.0895 .  
susprindum_oh                 -0.934   0.3502    
susprindum_coc                 0.022   0.9821    
susprindum_pbc                -0.580   0.5621    
susprindum_mar                -0.526   0.5987    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome_rec.lag               2.0556     0.4865    1.4764    2.8621
log_dias_treat_imp_sin_na.lag    1.2927     0.7736    1.2093    1.3819
less_90d_tr1_rec.lag             1.8460     0.5417    1.4385    2.3690
comp_bpsc_y3_severe_rec.lag      2.3335     0.4285    1.7582    3.0970
policonsumo2.lag                 1.0186     0.9817    0.8938    1.1610
edad_al_ing_1                    1.0593     0.9440    1.0408    1.0781
ano_nac_corr                     1.0673     0.9370    1.0492    1.0857
susinidum_coc_rec2               1.3656     0.7323    1.0446    1.7854
susinidum_oh                     1.2087     0.8274    1.0103    1.4459
susinidum_pbc                    1.2194     0.8201    0.9982    1.4896
susinidum_mar                    1.2201     0.8196    1.0182    1.4620
psycom_dum_with_rec2             0.9913     1.0087    0.9158    1.0731
psycom_dum_study                 0.6875     1.4545    0.6049    0.7814
freq_cons_dum_5day               1.0004     0.9996    0.9169    1.0915
cond_oc_dum_2inact               1.0847     0.9219    0.9348    1.2588
cond_oc_dum_3unemp               1.1389     0.8780    0.9801    1.3234
susprindum_oh                    0.8977     1.1140    0.7158    1.1258
susprindum_coc                   1.0027     0.9973    0.7914    1.2705
susprindum_pbc                   0.9382     1.0658    0.7563    1.1639
susprindum_mar                   0.9196     1.0874    0.6730    1.2566

Concordance= 0.666  (se = 0.005 )
Likelihood ratio test= 814.4  on 20 df,   p=&lt;2e-16
Wald test            = 982.1  on 20 df,   p=&lt;2e-16
Score (logrank) test = 834.4  on 20 df,   p=&lt;2e-16,   Robust = 780.6  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Call:</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="co"># coxph(formula = Surv(time.lag, time, event) ~ tr_outcome_rec.lag + </span></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     log_dias_treat_imp_sin_na.lag + less_90d_tr1_rec.lag + comp_bpsc_y3_severe_rec.lag + </span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_coc_rec2 + </span></span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_oh + susinidum_pbc + susinidum_mar + psycom_dum_with_rec2 + </span></span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb456-8"><a href="#cb456-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar, data = datacox, cluster = id)</span></span>
<span id="cb456-9"><a href="#cb456-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb456-10"><a href="#cb456-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   n= 3189, number of events= 2153 </span></span>
<span id="cb456-11"><a href="#cb456-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    (381 observations deleted due to missingness)</span></span>
<span id="cb456-12"><a href="#cb456-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb456-13"><a href="#cb456-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     coef  exp(coef)   se(coef)  robust se      z Pr(&gt;|z|)    </span></span>
<span id="cb456-14"><a href="#cb456-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag             0.7205801  2.0556254  0.1852413  0.1688667  4.267 1.98e-05 ***</span></span>
<span id="cb456-15"><a href="#cb456-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag  0.2567171  1.2926793  0.0273630  0.0340385  7.542 4.63e-14 ***</span></span>
<span id="cb456-16"><a href="#cb456-16" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag           0.6130288  1.8460141  0.1493355  0.1272692  4.817 1.46e-06 ***</span></span>
<span id="cb456-17"><a href="#cb456-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag    0.8473593  2.3334766  0.1535169  0.1444312  5.867 4.44e-09 ***</span></span>
<span id="cb456-18"><a href="#cb456-18" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag               0.0184737  1.0186454  0.0734914  0.0667181  0.277   0.7819    </span></span>
<span id="cb456-19"><a href="#cb456-19" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.0575836  1.0592739  0.0104369  0.0089922  6.404 1.52e-10 ***</span></span>
<span id="cb456-20"><a href="#cb456-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.0650981  1.0672637  0.0101748  0.0087168  7.468 8.14e-14 ***</span></span>
<span id="cb456-21"><a href="#cb456-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2             0.3116140  1.3656274  0.1602666  0.1367453  2.279   0.0227 *  </span></span>
<span id="cb456-22"><a href="#cb456-22" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.1895267  1.2086774  0.1337491  0.0914487  2.072   0.0382 *  </span></span>
<span id="cb456-23"><a href="#cb456-23" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.1983614  1.2194030  0.1404151  0.1021221  1.942   0.0521 .  </span></span>
<span id="cb456-24"><a href="#cb456-24" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.1989101  1.2200723  0.1343948  0.0922898  2.155   0.0311 *  </span></span>
<span id="cb456-25"><a href="#cb456-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2          -0.0087068  0.9913310  0.0483988  0.0404580 -0.215   0.8296    </span></span>
<span id="cb456-26"><a href="#cb456-26" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study              -0.3746894  0.6875028  0.0680287  0.0652967 -5.738 9.57e-09 ***</span></span>
<span id="cb456-27"><a href="#cb456-27" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.0004056  1.0004056  0.0506595  0.0444514  0.009   0.9927    </span></span>
<span id="cb456-28"><a href="#cb456-28" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.0813419  1.0847417  0.0809746  0.0759279  1.071   0.2840    </span></span>
<span id="cb456-29"><a href="#cb456-29" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.1300692  1.1389072  0.0814469  0.0765984  1.698   0.0895 .  </span></span>
<span id="cb456-30"><a href="#cb456-30" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.1079311  0.8976894  0.1483977  0.1155415 -0.934   0.3502    </span></span>
<span id="cb456-31"><a href="#cb456-31" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.0027078  1.0027114  0.1498413  0.1207600  0.022   0.9821    </span></span>
<span id="cb456-32"><a href="#cb456-32" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                -0.0637471  0.9382423  0.1407408  0.1099733 -0.580   0.5621    </span></span>
<span id="cb456-33"><a href="#cb456-33" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                -0.0838286  0.9195888  0.2112160  0.1592995 -0.526   0.5987    </span></span>
<span id="cb456-34"><a href="#cb456-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb456-35"><a href="#cb456-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb456-36"><a href="#cb456-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb456-37"><a href="#cb456-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                               exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span id="cb456-38"><a href="#cb456-38" aria-hidden="true" tabindex="-1"></a><span class="co"># tr_outcome_rec.lag               2.0556     0.4865    1.4764    2.8621</span></span>
<span id="cb456-39"><a href="#cb456-39" aria-hidden="true" tabindex="-1"></a><span class="co"># log_dias_treat_imp_sin_na.lag    1.2927     0.7736    1.2093    1.3819</span></span>
<span id="cb456-40"><a href="#cb456-40" aria-hidden="true" tabindex="-1"></a><span class="co"># less_90d_tr1_rec.lag             1.8460     0.5417    1.4385    2.3690</span></span>
<span id="cb456-41"><a href="#cb456-41" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_bpsc_y3_severe_rec.lag      2.3335     0.4285    1.7582    3.0970</span></span>
<span id="cb456-42"><a href="#cb456-42" aria-hidden="true" tabindex="-1"></a><span class="co"># policonsumo2.lag                 1.0186     0.9817    0.8938    1.1610</span></span>
<span id="cb456-43"><a href="#cb456-43" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                    1.0593     0.9440    1.0408    1.0781</span></span>
<span id="cb456-44"><a href="#cb456-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                     1.0673     0.9370    1.0492    1.0857</span></span>
<span id="cb456-45"><a href="#cb456-45" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc_rec2               1.3656     0.7323    1.0446    1.7854</span></span>
<span id="cb456-46"><a href="#cb456-46" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                     1.2087     0.8274    1.0103    1.4459</span></span>
<span id="cb456-47"><a href="#cb456-47" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                    1.2194     0.8201    0.9982    1.4896</span></span>
<span id="cb456-48"><a href="#cb456-48" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                    1.2201     0.8196    1.0182    1.4620</span></span>
<span id="cb456-49"><a href="#cb456-49" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with_rec2             0.9913     1.0087    0.9158    1.0731</span></span>
<span id="cb456-50"><a href="#cb456-50" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                 0.6875     1.4545    0.6049    0.7814</span></span>
<span id="cb456-51"><a href="#cb456-51" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day               1.0004     0.9996    0.9169    1.0915</span></span>
<span id="cb456-52"><a href="#cb456-52" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact               1.0847     0.9219    0.9348    1.2588</span></span>
<span id="cb456-53"><a href="#cb456-53" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp               1.1389     0.8780    0.9801    1.3234</span></span>
<span id="cb456-54"><a href="#cb456-54" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                    0.8977     1.1140    0.7158    1.1258</span></span>
<span id="cb456-55"><a href="#cb456-55" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                   1.0027     0.9973    0.7914    1.2705</span></span>
<span id="cb456-56"><a href="#cb456-56" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                   0.9382     1.0658    0.7563    1.1639</span></span>
<span id="cb456-57"><a href="#cb456-57" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                   0.9196     1.0874    0.6730    1.2566</span></span>
<span id="cb456-58"><a href="#cb456-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb456-59"><a href="#cb456-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance= 0.666  (se = 0.005 )</span></span>
<span id="cb456-60"><a href="#cb456-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test= 814.4  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb456-61"><a href="#cb456-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test            = 982.1  on 20 df,   p=&lt;2e-16</span></span>
<span id="cb456-62"><a href="#cb456-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Score (logrank) test = 834.4  on 20 df,   p=&lt;2e-16,   Robust = 780.6  p=&lt;2e-16</span></span>
<span id="cb456-63"><a href="#cb456-63" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb456-64"><a href="#cb456-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Note: the likelihood ratio and score tests assume independence of</span></span>
<span id="cb456-65"><a href="#cb456-65" aria-hidden="true" tabindex="-1"></a><span class="co">#      observations within a cluster, the Wald and robust score tests do not).</span></span>
<span id="cb456-66"><a href="#cb456-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-67"><a href="#cb456-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_model_after_ph_wo_res_alt<span class="sc">$</span>iiw.weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1235  0.2374  0.5581  0.8884  1.2695 52.2809 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1235  0.2374  0.5581  0.8884  1.2695 52.2809 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Initialize empty result</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a>df_models_after_ph<span class="ot">&lt;-</span></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">tipo_de_plan_2=</span> <span class="fu">attr</span>(<span class="fu">table</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod),<span class="st">"names"</span>), </span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">models_after_ph=</span> <span class="fu">c</span>(<span class="st">"iiw_model_after_ph_ba"</span>, </span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_gp_ia"</span>, </span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_gp_res"</span>, </span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_wo_ia"</span>, </span>
<span id="cb459-9"><a href="#cb459-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_wo_res"</span>))</span>
<span id="cb459-10"><a href="#cb459-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-11"><a href="#cb459-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df_models_after_ph)) {</span>
<span id="cb459-12"><a href="#cb459-12" aria-hidden="true" tabindex="-1"></a>    subset_data0 <span class="ot">&lt;-</span> <span class="fu">subset</span>(dplyr<span class="sc">::</span><span class="fu">mutate</span>(data_mine_miss_restr_proc2, <span class="at">rn=</span>dplyr<span class="sc">::</span><span class="fu">row_number</span>()), <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span> df_models_after_ph[i,<span class="dv">1</span>])</span>
<span id="cb459-13"><a href="#cb459-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb459-14"><a href="#cb459-14" aria-hidden="true" tabindex="-1"></a>    subset_data02<span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(subset_data0, <span class="at">iiw_after_ph=</span> <span class="fu">get</span>(df_models_after_ph[i,<span class="dv">2</span>])<span class="sc">$</span>iiw.weight)</span>
<span id="cb459-15"><a href="#cb459-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb459-16"><a href="#cb459-16" aria-hidden="true" tabindex="-1"></a>    data_mine_miss_restr_proc2_iiw_after_ph <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(data_mine_miss_restr_proc2_iiw_after_ph, subset_data02)</span>
<span id="cb459-17"><a href="#cb459-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb459-18"><a href="#cb459-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-19"><a href="#cb459-19" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-20"><a href="#cb459-20" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-21"><a href="#cb459-21" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-22"><a href="#cb459-22" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-23"><a href="#cb459-23" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-24"><a href="#cb459-24" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-25"><a href="#cb459-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-26"><a href="#cb459-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb459-27"><a href="#cb459-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-28"><a href="#cb459-28" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph_alt <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Initialize empty result</span></span>
<span id="cb459-29"><a href="#cb459-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-30"><a href="#cb459-30" aria-hidden="true" tabindex="-1"></a>df_models_after_ph_alt<span class="ot">&lt;-</span></span>
<span id="cb459-31"><a href="#cb459-31" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">tipo_de_plan_2=</span> <span class="fu">attr</span>(<span class="fu">table</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod),<span class="st">"names"</span>), </span>
<span id="cb459-32"><a href="#cb459-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">models_after_ph=</span> <span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"iiw_model_after_ph_ba"</span>, </span>
<span id="cb459-33"><a href="#cb459-33" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_gp_ia"</span>, </span>
<span id="cb459-34"><a href="#cb459-34" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_gp_res"</span>, </span>
<span id="cb459-35"><a href="#cb459-35" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_wo_ia"</span>, </span>
<span id="cb459-36"><a href="#cb459-36" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"iiw_model_after_ph_wo_res"</span>),<span class="st">"_alt"</span>))</span>
<span id="cb459-37"><a href="#cb459-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df_models_after_ph_alt)) {</span>
<span id="cb459-38"><a href="#cb459-38" aria-hidden="true" tabindex="-1"></a>    subset_data00 <span class="ot">&lt;-</span> <span class="fu">subset</span>(dplyr<span class="sc">::</span><span class="fu">mutate</span>(data_mine_miss_restr_proc2, <span class="at">rn=</span>dplyr<span class="sc">::</span><span class="fu">row_number</span>()), <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span> df_models_after_ph_alt[i,<span class="dv">1</span>])</span>
<span id="cb459-39"><a href="#cb459-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb459-40"><a href="#cb459-40" aria-hidden="true" tabindex="-1"></a>    subset_data002<span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(subset_data00, <span class="at">iiw_after_ph=</span> <span class="fu">get</span>(df_models_after_ph_alt[i,<span class="dv">2</span>])<span class="sc">$</span>iiw.weight)</span>
<span id="cb459-41"><a href="#cb459-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb459-42"><a href="#cb459-42" aria-hidden="true" tabindex="-1"></a>    data_mine_miss_restr_proc2_iiw_after_ph_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt, subset_data002)</span>
<span id="cb459-43"><a href="#cb459-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb459-44"><a href="#cb459-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-45"><a href="#cb459-45" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.09172 0.66527 1.08442 1.33483 1.90360 5.42701 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.4578  0.8791  1.1600  1.3930  1.8724  6.7300 </span></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
   0.0643    0.1688    0.5455    1.1908    1.3579 1294.5167 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.0643    0.1688    0.5455    1.1908    1.3579 1294.5167 </span></span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb463-6"><a href="#cb463-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb463-7"><a href="#cb463-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Stabilize weights"</span>)</span>
<span id="cb463-8"><a href="#cb463-8" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph_st<span class="ot">&lt;-</span>data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph</span>
<span id="cb463-9"><a href="#cb463-9" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph_st[data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph<span class="sc">&gt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph,<span class="fl">0.975</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph,<span class="fl">0.975</span>)</span>
<span id="cb463-10"><a href="#cb463-10" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph_st[data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph<span class="sc">&lt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph,<span class="fl">0.025</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph,<span class="fl">0.025</span>)</span>
<span id="cb463-11"><a href="#cb463-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-12"><a href="#cb463-12" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"stabilize alternative weights"</span>)</span>
<span id="cb463-13"><a href="#cb463-13" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph_st<span class="ot">&lt;-</span>data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph</span>
<span id="cb463-14"><a href="#cb463-14" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph_st[data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph<span class="sc">&gt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph,<span class="fl">0.975</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph,<span class="fl">0.975</span>)</span>
<span id="cb463-15"><a href="#cb463-15" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph_st[data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph<span class="sc">&lt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph,<span class="fl">0.025</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph,<span class="fl">0.025</span>)</span>
<span id="cb463-16"><a href="#cb463-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-17"><a href="#cb463-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-18"><a href="#cb463-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4682  0.6653  1.0844  1.3266  1.9036  3.0250 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.6912  0.8791  1.1600  1.3873  1.8724  2.5741 </span></span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.09766 0.16882 0.54545 0.88019 1.35785 3.56260 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co">#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.09766 0.16882 0.54545 0.88019 1.35785 3.56260 </span></span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-5"><a href="#cb467-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb467-6"><a href="#cb467-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Primary (after PH, lag=0)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph_st)))),</span>
<span id="cb467-7"><a href="#cb467-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Alternative (after PH, lag=1)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph_alt<span class="sc">$</span>iiw_after_ph_st)))))<span class="sc">%&gt;%</span> </span>
<span id="cb467-8"><a href="#cb467-8" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb467-9"><a href="#cb467-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/iiw_after_ph_240426.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb467-10"><a href="#cb467-10" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Weights (after correction for PHs)"</span>, <span class="at">col.names=</span> <span class="fu">c</span>(<span class="st">"Weight"</span>,<span class="fu">attr</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_after_ph_st),<span class="st">"names"</span>)) ) </span>
<span id="cb467-11"><a href="#cb467-11" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Weights (after correction for PHs)</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Weight</th>
<th style="text-align: right;">Min.</th>
<th style="text-align: right;">1st Qu.</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">3rd Qu.</th>
<th style="text-align: right;">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Primary (after PH, lag=0)</td>
<td style="text-align: right;">0.4681976</td>
<td style="text-align: right;">0.6652737</td>
<td style="text-align: right;">1.084424</td>
<td style="text-align: right;">1.3266201</td>
<td style="text-align: right;">1.903597</td>
<td style="text-align: right;">3.025044</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alternative (after PH, lag=1)</td>
<td style="text-align: right;">0.0976600</td>
<td style="text-align: right;">0.1688223</td>
<td style="text-align: right;">0.545454</td>
<td style="text-align: right;">0.8801874</td>
<td style="text-align: right;">1.357854</td>
<td style="text-align: right;">3.562599</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="gee" class="level5">
<h5 class="anchored" data-anchor-id="gee">GEE</h5>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The id= option is where we specify the clusters within which we have repeated observations that may be correlated, and tehe scale.fix=T option is to avoid R's default approach of introducing an overdispersion scale parameter.</span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="co">#However, caution is advised when employing QIC and its use should not be routine, see Wang et al. (2015). growing use of quasi-likelihood-based information criteria for longitudinal data to select a working correlation structure in a generalized estimating equation framework. [https://onlinelibrary.wiley.com/doi/full/10.1002/sta4.95]</span></span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="co">#poisson(link = "log"),</span></span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.thelancet.com/cms/10.1016/S2468-2667(22)00042-1/attachment/eb69ffc4-cb6c-4a47-9524-94e1ba9302b2/mmc1.pdf</span></span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.thelancet.com/cms/10.1016/S2468-2667(22)00201-8/attachment/05a17ae1-1e31-4ffd-a727-78ec915dc03b/mmc1.pdf</span></span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-9"><a href="#cb468-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb468-10"><a href="#cb468-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb468-11"><a href="#cb468-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-12"><a href="#cb468-12" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Must be independence structure"</span>)</span>
<span id="cb468-13"><a href="#cb468-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-14"><a href="#cb468-14" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb468-15"><a href="#cb468-15" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb468-16"><a href="#cb468-16" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb468-17"><a href="#cb468-17" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb468-18"><a href="#cb468-18" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb468-19"><a href="#cb468-19" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb468-20"><a href="#cb468-20" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb468-21"><a href="#cb468-21" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb468-22"><a href="#cb468-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb468-23"><a href="#cb468-23" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb468-24"><a href="#cb468-24" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb468-25"><a href="#cb468-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb468-26"><a href="#cb468-26" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb468-27"><a href="#cb468-27" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb468-28"><a href="#cb468-28" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb468-29"><a href="#cb468-29" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph, <span class="at">family=</span>binomial, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb468-30"><a href="#cb468-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = binomial, data = data_mine_miss_restr_proc2_iiw_after_ph, 
    id = id, corstr = "independence")

 Coefficients:
                     Estimate    Std.err    Wald Pr(&gt;|W|)    
(Intercept)        -43.338627  13.168777  10.831 0.000998 ***
policonsumo2         0.057600   0.035967   2.565 0.109271    
edad_al_ing_1       -0.006693   0.006676   1.005 0.316079    
ano_nac_corr         0.022507   0.006543  11.831 0.000583 ***
susinidum_oh        -0.073882   0.094343   0.613 0.433556    
susinidum_coc       -0.015069   0.118072   0.016 0.898446    
susinidum_pbc        0.145421   0.107807   1.820 0.177366    
susinidum_mar        0.047494   0.096584   0.242 0.622904    
psycom_dum_study     0.863462   0.046317 347.538  &lt; 2e-16 ***
psycom_dum_with      0.060458   0.032631   3.433 0.063916 .  
freq_cons_dum_5day  -0.029792   0.030889   0.930 0.334802    
cond_oc_dum_2inact  -0.258428   0.042900  36.288 1.70e-09 ***
cond_oc_dum_3unemp  -0.192816   0.034495  31.245 2.27e-08 ***
susprindum_coc       0.029585   0.048404   0.374 0.541054    
susprindum_pbc       0.237070   0.040895  33.606 6.75e-09 ***
susprindum_mar       0.062763   0.074961   0.701 0.402438    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    1.001 0.01624
Number of clusters:   13317  Maximum cluster size: 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>m_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb470-8"><a href="#cb470-8" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb470-9"><a href="#cb470-9" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb470-10"><a href="#cb470-10" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb470-11"><a href="#cb470-11" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb470-12"><a href="#cb470-12" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb470-13"><a href="#cb470-13" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb470-14"><a href="#cb470-14" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb470-15"><a href="#cb470-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb470-16"><a href="#cb470-16" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb470-17"><a href="#cb470-17" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb470-18"><a href="#cb470-18" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb470-19"><a href="#cb470-19" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb470-20"><a href="#cb470-20" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb470-21"><a href="#cb470-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb470-22"><a href="#cb470-22" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb470-23"><a href="#cb470-23" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb470-24"><a href="#cb470-24" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb470-25"><a href="#cb470-25" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb470-26"><a href="#cb470-26" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb470-27"><a href="#cb470-27" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb470-28"><a href="#cb470-28" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb470-29"><a href="#cb470-29" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb470-30"><a href="#cb470-30" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb470-31"><a href="#cb470-31" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph, <span class="at">family=</span>binomial, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb470-32"><a href="#cb470-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-33"><a href="#cb470-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-34"><a href="#cb470-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(m, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(m_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb470-35"><a href="#cb470-35" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb470-36"><a href="#cb470-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/gee_240502.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb470-37"><a href="#cb470-37" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models (after correction for PHs)"</span>) </span>
<span id="cb470-38"><a href="#cb470-38" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models (after correction for PHs)</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.1093</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0079</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>edad_al_ing_1_st <span class="ot">=</span> data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>edad_al_ing_1 <span class="sc">-</span> <span class="fu">mean</span>(data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>edad_al_ing_1)</span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a><span class="co"># can use to fit a weighted GEE</span></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a>mw <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb471-8"><a href="#cb471-8" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb471-9"><a href="#cb471-9" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb471-10"><a href="#cb471-10" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb471-11"><a href="#cb471-11" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb471-12"><a href="#cb471-12" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb471-13"><a href="#cb471-13" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb471-14"><a href="#cb471-14" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb471-15"><a href="#cb471-15" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb471-16"><a href="#cb471-16" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb471-17"><a href="#cb471-17" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb471-18"><a href="#cb471-18" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb471-19"><a href="#cb471-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph, <span class="at">family=</span> binomial, <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mw)</span></span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a>mwpois <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb472-8"><a href="#cb472-8" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb472-9"><a href="#cb472-9" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb472-10"><a href="#cb472-10" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb472-11"><a href="#cb472-11" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb472-12"><a href="#cb472-12" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb472-13"><a href="#cb472-13" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb472-14"><a href="#cb472-14" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb472-15"><a href="#cb472-15" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb472-16"><a href="#cb472-16" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb472-17"><a href="#cb472-17" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb472-18"><a href="#cb472-18" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb472-19"><a href="#cb472-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb472-20"><a href="#cb472-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mwpois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = poisson(link = "log"), 
    data = data_mine_miss_restr_proc2_iiw_after_ph, weights = iiw_after_ph_st, 
    id = id, corstr = "independence")

 Coefficients:
                   Estimate  Std.err   Wald Pr(&gt;|W|)    
(Intercept)        -6.48845  3.56281   3.32   0.0686 .  
policonsumo2        0.02903  0.01098   6.99   0.0082 ** 
edad_al_ing_1      -0.00520  0.00182   8.13   0.0044 ** 
ano_nac_corr        0.00318  0.00177   3.23   0.0724 .  
susinidum_oh       -0.01208  0.02868   0.18   0.6736    
susinidum_coc       0.00578  0.03446   0.03   0.8668    
susinidum_pbc       0.03984  0.03091   1.66   0.1975    
susinidum_mar       0.01794  0.02878   0.39   0.5331    
psycom_dum_study    0.13012  0.01024 161.40  &lt; 2e-16 ***
psycom_dum_with     0.00609  0.01002   0.37   0.5436    
freq_cons_dum_5day  0.00429  0.00860   0.25   0.6179    
cond_oc_dum_2inact -0.05450  0.01246  19.14  1.2e-05 ***
cond_oc_dum_3unemp -0.03855  0.00943  16.71  4.4e-05 ***
susprindum_coc      0.01730  0.01487   1.35   0.2447    
susprindum_pbc      0.05929  0.01247  22.60  2.0e-06 ***
susprindum_mar      0.01361  0.02142   0.40   0.5252    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.256 0.00339
Number of clusters:   13317  Maximum cluster size: 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true" tabindex="-1"></a>mw_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb474-5"><a href="#cb474-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb474-6"><a href="#cb474-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb474-7"><a href="#cb474-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb474-8"><a href="#cb474-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb474-9"><a href="#cb474-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb474-10"><a href="#cb474-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb474-11"><a href="#cb474-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb474-12"><a href="#cb474-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb474-13"><a href="#cb474-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb474-14"><a href="#cb474-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb474-15"><a href="#cb474-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb474-16"><a href="#cb474-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb474-17"><a href="#cb474-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb474-18"><a href="#cb474-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb474-19"><a href="#cb474-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb474-20"><a href="#cb474-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb474-21"><a href="#cb474-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb474-22"><a href="#cb474-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb474-23"><a href="#cb474-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb474-24"><a href="#cb474-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb474-25"><a href="#cb474-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb474-26"><a href="#cb474-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb474-27"><a href="#cb474-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb474-28"><a href="#cb474-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb474-29"><a href="#cb474-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb474-30"><a href="#cb474-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb474-31"><a href="#cb474-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb474-32"><a href="#cb474-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb474-33"><a href="#cb474-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb474-34"><a href="#cb474-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph, <span class="at">family=</span>binomial, <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a>mwpois_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb475-9"><a href="#cb475-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb475-10"><a href="#cb475-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb475-11"><a href="#cb475-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb475-12"><a href="#cb475-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb475-13"><a href="#cb475-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb475-14"><a href="#cb475-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb475-15"><a href="#cb475-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb475-16"><a href="#cb475-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb475-17"><a href="#cb475-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb475-18"><a href="#cb475-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb475-19"><a href="#cb475-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb475-20"><a href="#cb475-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb475-21"><a href="#cb475-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb475-22"><a href="#cb475-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb475-23"><a href="#cb475-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb475-24"><a href="#cb475-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb475-25"><a href="#cb475-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb475-26"><a href="#cb475-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb475-27"><a href="#cb475-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb475-28"><a href="#cb475-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb475-29"><a href="#cb475-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb475-30"><a href="#cb475-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb475-31"><a href="#cb475-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb475-32"><a href="#cb475-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb475-33"><a href="#cb475-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb475-34"><a href="#cb475-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb475-35"><a href="#cb475-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-36"><a href="#cb475-36" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Model fit"</span>)</span>
<span id="cb475-37"><a href="#cb475-37" aria-hidden="true" tabindex="-1"></a><span class="co">#broom::glance(mwpois_full)</span></span>
<span id="cb475-38"><a href="#cb475-38" aria-hidden="true" tabindex="-1"></a><span class="co">#QIC(mw)</span></span>
<span id="cb475-39"><a href="#cb475-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-40"><a href="#cb475-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-41"><a href="#cb475-41" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb475-42"><a href="#cb475-42" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb475-43"><a href="#cb475-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-44"><a href="#cb475-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb475-45"><a href="#cb475-45" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb475-46"><a href="#cb475-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/geew_240502.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb475-47"><a href="#cb475-47" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models, weighted (after correction for PHs)"</span>) </span>
<span id="cb475-48"><a href="#cb475-48" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models, weighted (after correction for PHs)</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0238</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0032</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">1.22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0082</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0013</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.06</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can use to fit a weighted GEE</span></span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>mw_alt <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb476-11"><a href="#cb476-11" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb476-12"><a href="#cb476-12" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb476-13"><a href="#cb476-13" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb476-14"><a href="#cb476-14" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb476-15"><a href="#cb476-15" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb476-16"><a href="#cb476-16" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb476-17"><a href="#cb476-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph_alt, <span class="at">family=</span> binomial, <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mw)</span></span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true" tabindex="-1"></a>mwpois_alt <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb477-5"><a href="#cb477-5" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb477-6"><a href="#cb477-6" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb477-7"><a href="#cb477-7" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb477-8"><a href="#cb477-8" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb477-9"><a href="#cb477-9" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb477-10"><a href="#cb477-10" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb477-11"><a href="#cb477-11" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb477-12"><a href="#cb477-12" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb477-13"><a href="#cb477-13" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb477-14"><a href="#cb477-14" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb477-15"><a href="#cb477-15" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb477-16"><a href="#cb477-16" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb477-17"><a href="#cb477-17" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb477-18"><a href="#cb477-18" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb477-19"><a href="#cb477-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph_alt, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb477-20"><a href="#cb477-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mwpois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = poisson(link = "log"), 
    data = data_mine_miss_restr_proc2_iiw_after_ph, weights = iiw_after_ph_st, 
    id = id, corstr = "independence")

 Coefficients:
                   Estimate  Std.err   Wald Pr(&gt;|W|)    
(Intercept)        -6.48845  3.56281   3.32   0.0686 .  
policonsumo2        0.02903  0.01098   6.99   0.0082 ** 
edad_al_ing_1      -0.00520  0.00182   8.13   0.0044 ** 
ano_nac_corr        0.00318  0.00177   3.23   0.0724 .  
susinidum_oh       -0.01208  0.02868   0.18   0.6736    
susinidum_coc       0.00578  0.03446   0.03   0.8668    
susinidum_pbc       0.03984  0.03091   1.66   0.1975    
susinidum_mar       0.01794  0.02878   0.39   0.5331    
psycom_dum_study    0.13012  0.01024 161.40  &lt; 2e-16 ***
psycom_dum_with     0.00609  0.01002   0.37   0.5436    
freq_cons_dum_5day  0.00429  0.00860   0.25   0.6179    
cond_oc_dum_2inact -0.05450  0.01246  19.14  1.2e-05 ***
cond_oc_dum_3unemp -0.03855  0.00943  16.71  4.4e-05 ***
susprindum_coc      0.01730  0.01487   1.35   0.2447    
susprindum_pbc      0.05929  0.01247  22.60  2.0e-06 ***
susprindum_mar      0.01361  0.02142   0.40   0.5252    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.256 0.00339
Number of clusters:   13317  Maximum cluster size: 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a>mw_alt_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb479-5"><a href="#cb479-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb479-6"><a href="#cb479-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb479-7"><a href="#cb479-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb479-8"><a href="#cb479-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb479-9"><a href="#cb479-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb479-10"><a href="#cb479-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb479-11"><a href="#cb479-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb479-12"><a href="#cb479-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb479-13"><a href="#cb479-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb479-14"><a href="#cb479-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb479-15"><a href="#cb479-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb479-16"><a href="#cb479-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb479-17"><a href="#cb479-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb479-18"><a href="#cb479-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb479-19"><a href="#cb479-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb479-20"><a href="#cb479-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb479-21"><a href="#cb479-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb479-22"><a href="#cb479-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb479-23"><a href="#cb479-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb479-24"><a href="#cb479-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb479-25"><a href="#cb479-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb479-26"><a href="#cb479-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb479-27"><a href="#cb479-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb479-28"><a href="#cb479-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb479-29"><a href="#cb479-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb479-30"><a href="#cb479-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb479-31"><a href="#cb479-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb479-32"><a href="#cb479-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb479-33"><a href="#cb479-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb479-34"><a href="#cb479-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph_alt, <span class="at">family=</span>binomial, <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true" tabindex="-1"></a>mwpois_alt_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb480-5"><a href="#cb480-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb480-6"><a href="#cb480-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb480-7"><a href="#cb480-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb480-8"><a href="#cb480-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb480-9"><a href="#cb480-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb480-10"><a href="#cb480-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb480-11"><a href="#cb480-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb480-12"><a href="#cb480-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb480-13"><a href="#cb480-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb480-14"><a href="#cb480-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb480-15"><a href="#cb480-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb480-16"><a href="#cb480-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb480-17"><a href="#cb480-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb480-18"><a href="#cb480-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb480-19"><a href="#cb480-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb480-20"><a href="#cb480-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb480-21"><a href="#cb480-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb480-22"><a href="#cb480-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb480-23"><a href="#cb480-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb480-24"><a href="#cb480-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb480-25"><a href="#cb480-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb480-26"><a href="#cb480-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb480-27"><a href="#cb480-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb480-28"><a href="#cb480-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb480-29"><a href="#cb480-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb480-30"><a href="#cb480-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb480-31"><a href="#cb480-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb480-32"><a href="#cb480-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb480-33"><a href="#cb480-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb480-34"><a href="#cb480-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2_iiw_after_ph_alt, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_after_ph_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb480-35"><a href="#cb480-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-36"><a href="#cb480-36" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Model fit"</span>)</span>
<span id="cb480-37"><a href="#cb480-37" aria-hidden="true" tabindex="-1"></a><span class="co">#broom::glance(mwpois_full)</span></span>
<span id="cb480-38"><a href="#cb480-38" aria-hidden="true" tabindex="-1"></a><span class="co">#QIC(mw)</span></span>
<span id="cb480-39"><a href="#cb480-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-40"><a href="#cb480-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-41"><a href="#cb480-41" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb480-42"><a href="#cb480-42" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb480-43"><a href="#cb480-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-44"><a href="#cb480-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_alt, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_alt_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois_alt, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois_alt_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb480-45"><a href="#cb480-45" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb480-46"><a href="#cb480-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/geew_alt_240502.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb480-47"><a href="#cb480-47" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models, alternative weighting (after correction for PHs)"</span>) </span>
<span id="cb480-48"><a href="#cb480-48" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models, alternative weighting (after correction for PHs)</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.0457</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.0135</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0184</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0064</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.07</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="stratifying" class="level4">
<h4 class="anchored" data-anchor-id="stratifying">Stratifying</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define possible sets of breakpoints</span></span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a>samp1<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2121</span>)</span>
<span id="cb481-5"><a href="#cb481-5" aria-hidden="true" tabindex="-1"></a>samp2<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-6"><a href="#cb481-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">2121e4</span>)</span>
<span id="cb481-7"><a href="#cb481-7" aria-hidden="true" tabindex="-1"></a>samp3<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-8"><a href="#cb481-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">2121e2</span>)</span>
<span id="cb481-9"><a href="#cb481-9" aria-hidden="true" tabindex="-1"></a>samp4<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-10"><a href="#cb481-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">2121e3</span>)</span>
<span id="cb481-11"><a href="#cb481-11" aria-hidden="true" tabindex="-1"></a>samp5<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-12"><a href="#cb481-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">212e3</span>)</span>
<span id="cb481-13"><a href="#cb481-13" aria-hidden="true" tabindex="-1"></a>samp6<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-14"><a href="#cb481-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">212e4</span>)</span>
<span id="cb481-15"><a href="#cb481-15" aria-hidden="true" tabindex="-1"></a>samp7<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-16"><a href="#cb481-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">21e4</span>)</span>
<span id="cb481-17"><a href="#cb481-17" aria-hidden="true" tabindex="-1"></a>samp8<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-18"><a href="#cb481-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">21e6</span>)</span>
<span id="cb481-19"><a href="#cb481-19" aria-hidden="true" tabindex="-1"></a>samp9<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-20"><a href="#cb481-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">21e8</span>)</span>
<span id="cb481-21"><a href="#cb481-21" aria-hidden="true" tabindex="-1"></a>samp10<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-22"><a href="#cb481-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">1e2</span>)</span>
<span id="cb481-23"><a href="#cb481-23" aria-hidden="true" tabindex="-1"></a>samp11<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-24"><a href="#cb481-24" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">1e3</span>)</span>
<span id="cb481-25"><a href="#cb481-25" aria-hidden="true" tabindex="-1"></a>samp12<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-26"><a href="#cb481-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">1e4</span>)</span>
<span id="cb481-27"><a href="#cb481-27" aria-hidden="true" tabindex="-1"></a>samp13<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-28"><a href="#cb481-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">1e7</span>)</span>
<span id="cb481-29"><a href="#cb481-29" aria-hidden="true" tabindex="-1"></a>samp14<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-30"><a href="#cb481-30" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">1e5</span>)</span>
<span id="cb481-31"><a href="#cb481-31" aria-hidden="true" tabindex="-1"></a>samp15<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-32"><a href="#cb481-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb481-33"><a href="#cb481-33" aria-hidden="true" tabindex="-1"></a>samp16<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-34"><a href="#cb481-34" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb481-35"><a href="#cb481-35" aria-hidden="true" tabindex="-1"></a>samp17<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-36"><a href="#cb481-36" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb481-37"><a href="#cb481-37" aria-hidden="true" tabindex="-1"></a>samp17<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-38"><a href="#cb481-38" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb481-39"><a href="#cb481-39" aria-hidden="true" tabindex="-1"></a>samp18<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-40"><a href="#cb481-40" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb481-41"><a href="#cb481-41" aria-hidden="true" tabindex="-1"></a>samp19<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-42"><a href="#cb481-42" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb481-43"><a href="#cb481-43" aria-hidden="true" tabindex="-1"></a>samp20<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-44"><a href="#cb481-44" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">217e2</span>)</span>
<span id="cb481-45"><a href="#cb481-45" aria-hidden="true" tabindex="-1"></a>samp21<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-46"><a href="#cb481-46" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">215e2</span>)</span>
<span id="cb481-47"><a href="#cb481-47" aria-hidden="true" tabindex="-1"></a>samp22<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-48"><a href="#cb481-48" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">214e2</span>)</span>
<span id="cb481-49"><a href="#cb481-49" aria-hidden="true" tabindex="-1"></a>samp23<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-50"><a href="#cb481-50" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">213e2</span>)</span>
<span id="cb481-51"><a href="#cb481-51" aria-hidden="true" tabindex="-1"></a>samp24<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-52"><a href="#cb481-52" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">212e2</span>)</span>
<span id="cb481-53"><a href="#cb481-53" aria-hidden="true" tabindex="-1"></a>samp25<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-54"><a href="#cb481-54" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">211e2</span>)</span>
<span id="cb481-55"><a href="#cb481-55" aria-hidden="true" tabindex="-1"></a>samp26<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-56"><a href="#cb481-56" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">2111e3</span>)</span>
<span id="cb481-57"><a href="#cb481-57" aria-hidden="true" tabindex="-1"></a>samp27<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-58"><a href="#cb481-58" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">2112e3</span>)</span>
<span id="cb481-59"><a href="#cb481-59" aria-hidden="true" tabindex="-1"></a>samp28<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-60"><a href="#cb481-60" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">2113e3</span>)</span>
<span id="cb481-61"><a href="#cb481-61" aria-hidden="true" tabindex="-1"></a>samp29<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-62"><a href="#cb481-62" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fl">2114e3</span>)</span>
<span id="cb481-63"><a href="#cb481-63" aria-hidden="true" tabindex="-1"></a>samp30<span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">sample.int</span>(<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="at">replace =</span> F),<span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)))</span>
<span id="cb481-64"><a href="#cb481-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-65"><a href="#cb481-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-66"><a href="#cb481-66" aria-hidden="true" tabindex="-1"></a>breaks_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb481-67"><a href="#cb481-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)),</span>
<span id="cb481-68"><a href="#cb481-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">75</span>, <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)),</span>
<span id="cb481-69"><a href="#cb481-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)),</span>
<span id="cb481-70"><a href="#cb481-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>, <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)),</span>
<span id="cb481-71"><a href="#cb481-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Unevenly spaced, emphasizing early times</span></span>
<span id="cb481-72"><a href="#cb481-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">70</span>, <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)),</span>
<span id="cb481-73"><a href="#cb481-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Long tail distribution</span></span>
<span id="cb481-74"><a href="#cb481-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="fu">max</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time)),</span>
<span id="cb481-75"><a href="#cb481-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Quantile-based intervals (ensure you have no NA in `time`)</span></span>
<span id="cb481-76"><a href="#cb481-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb481-77"><a href="#cb481-77" aria-hidden="true" tabindex="-1"></a>  samp1, </span>
<span id="cb481-78"><a href="#cb481-78" aria-hidden="true" tabindex="-1"></a>  samp2, </span>
<span id="cb481-79"><a href="#cb481-79" aria-hidden="true" tabindex="-1"></a>  samp3, </span>
<span id="cb481-80"><a href="#cb481-80" aria-hidden="true" tabindex="-1"></a>  samp4, </span>
<span id="cb481-81"><a href="#cb481-81" aria-hidden="true" tabindex="-1"></a>  samp5,</span>
<span id="cb481-82"><a href="#cb481-82" aria-hidden="true" tabindex="-1"></a>  samp6,</span>
<span id="cb481-83"><a href="#cb481-83" aria-hidden="true" tabindex="-1"></a>  samp7,</span>
<span id="cb481-84"><a href="#cb481-84" aria-hidden="true" tabindex="-1"></a>  samp8,</span>
<span id="cb481-85"><a href="#cb481-85" aria-hidden="true" tabindex="-1"></a>  samp9, </span>
<span id="cb481-86"><a href="#cb481-86" aria-hidden="true" tabindex="-1"></a>  samp10,</span>
<span id="cb481-87"><a href="#cb481-87" aria-hidden="true" tabindex="-1"></a>  samp11, </span>
<span id="cb481-88"><a href="#cb481-88" aria-hidden="true" tabindex="-1"></a>  samp12, </span>
<span id="cb481-89"><a href="#cb481-89" aria-hidden="true" tabindex="-1"></a>  samp13, </span>
<span id="cb481-90"><a href="#cb481-90" aria-hidden="true" tabindex="-1"></a>  samp14, </span>
<span id="cb481-91"><a href="#cb481-91" aria-hidden="true" tabindex="-1"></a>  samp15,</span>
<span id="cb481-92"><a href="#cb481-92" aria-hidden="true" tabindex="-1"></a>  samp16,</span>
<span id="cb481-93"><a href="#cb481-93" aria-hidden="true" tabindex="-1"></a>  samp17,</span>
<span id="cb481-94"><a href="#cb481-94" aria-hidden="true" tabindex="-1"></a>  samp18,</span>
<span id="cb481-95"><a href="#cb481-95" aria-hidden="true" tabindex="-1"></a>  samp19, </span>
<span id="cb481-96"><a href="#cb481-96" aria-hidden="true" tabindex="-1"></a>  samp20,  </span>
<span id="cb481-97"><a href="#cb481-97" aria-hidden="true" tabindex="-1"></a>  samp21, </span>
<span id="cb481-98"><a href="#cb481-98" aria-hidden="true" tabindex="-1"></a>  samp22, </span>
<span id="cb481-99"><a href="#cb481-99" aria-hidden="true" tabindex="-1"></a>  samp23, </span>
<span id="cb481-100"><a href="#cb481-100" aria-hidden="true" tabindex="-1"></a>  samp24, </span>
<span id="cb481-101"><a href="#cb481-101" aria-hidden="true" tabindex="-1"></a>  samp25,</span>
<span id="cb481-102"><a href="#cb481-102" aria-hidden="true" tabindex="-1"></a>  samp26,</span>
<span id="cb481-103"><a href="#cb481-103" aria-hidden="true" tabindex="-1"></a>  samp27,</span>
<span id="cb481-104"><a href="#cb481-104" aria-hidden="true" tabindex="-1"></a>  samp28,</span>
<span id="cb481-105"><a href="#cb481-105" aria-hidden="true" tabindex="-1"></a>  samp29, </span>
<span id="cb481-106"><a href="#cb481-106" aria-hidden="true" tabindex="-1"></a>  samp30</span>
<span id="cb481-107"><a href="#cb481-107" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb481-108"><a href="#cb481-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-109"><a href="#cb481-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare to store results</span></span>
<span id="cb481-110"><a href="#cb481-110" aria-hidden="true" tabindex="-1"></a>results_strat <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb481-111"><a href="#cb481-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-112"><a href="#cb481-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over the list of breakpoints</span></span>
<span id="cb481-113"><a href="#cb481-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(breaks_list)) {</span>
<span id="cb481-114"><a href="#cb481-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the factor variable with the current set of time intervals</span></span>
<span id="cb481-115"><a href="#cb481-115" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_restr_proc2<span class="sc">$</span>time_interval2 <span class="ot">&lt;-</span> <span class="fu">cut</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time, breaks_list[[i]], <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb481-116"><a href="#cb481-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the Cox model</span></span>
<span id="cb481-117"><a href="#cb481-117" aria-hidden="true" tabindex="-1"></a>  model<span class="ot">&lt;-</span></span>
<span id="cb481-118"><a href="#cb481-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cph</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">"Surv(lag_time,time,event)~ </span></span>
<span id="cb481-119"><a href="#cb481-119" aria-hidden="true" tabindex="-1"></a><span class="st">          cluster(id)+ </span></span>
<span id="cb481-120"><a href="#cb481-120" aria-hidden="true" tabindex="-1"></a><span class="st">          lag_tr_outcome+</span></span>
<span id="cb481-121"><a href="#cb481-121" aria-hidden="true" tabindex="-1"></a><span class="st">          lag_comp_bpsc_y3_severe+</span></span>
<span id="cb481-122"><a href="#cb481-122" aria-hidden="true" tabindex="-1"></a><span class="st">          lag_less_90d_tr1+</span></span>
<span id="cb481-123"><a href="#cb481-123" aria-hidden="true" tabindex="-1"></a><span class="st">          log_lag_dias_treat_imp_sin_na +</span></span>
<span id="cb481-124"><a href="#cb481-124" aria-hidden="true" tabindex="-1"></a><span class="st">          lag_policonsumo2 + </span></span>
<span id="cb481-125"><a href="#cb481-125" aria-hidden="true" tabindex="-1"></a><span class="st">          edad_al_ing_1 + </span></span>
<span id="cb481-126"><a href="#cb481-126" aria-hidden="true" tabindex="-1"></a><span class="st">          ano_nac_corr + </span></span>
<span id="cb481-127"><a href="#cb481-127" aria-hidden="true" tabindex="-1"></a><span class="st">          susinidum_oh +</span></span>
<span id="cb481-128"><a href="#cb481-128" aria-hidden="true" tabindex="-1"></a><span class="st">          susinidum_coc +</span></span>
<span id="cb481-129"><a href="#cb481-129" aria-hidden="true" tabindex="-1"></a><span class="st">          susinidum_pbc +</span></span>
<span id="cb481-130"><a href="#cb481-130" aria-hidden="true" tabindex="-1"></a><span class="st">          susinidum_mar +</span></span>
<span id="cb481-131"><a href="#cb481-131" aria-hidden="true" tabindex="-1"></a><span class="st">          psycom_dum_study +</span></span>
<span id="cb481-132"><a href="#cb481-132" aria-hidden="true" tabindex="-1"></a><span class="st">          psycom_dum_with +</span></span>
<span id="cb481-133"><a href="#cb481-133" aria-hidden="true" tabindex="-1"></a><span class="st">          freq_cons_dum_5day +</span></span>
<span id="cb481-134"><a href="#cb481-134" aria-hidden="true" tabindex="-1"></a><span class="st">          cond_oc_dum_2inact +</span></span>
<span id="cb481-135"><a href="#cb481-135" aria-hidden="true" tabindex="-1"></a><span class="st">          cond_oc_dum_3unemp +</span></span>
<span id="cb481-136"><a href="#cb481-136" aria-hidden="true" tabindex="-1"></a><span class="st">          susprindum_oh +</span></span>
<span id="cb481-137"><a href="#cb481-137" aria-hidden="true" tabindex="-1"></a><span class="st">          susprindum_coc +</span></span>
<span id="cb481-138"><a href="#cb481-138" aria-hidden="true" tabindex="-1"></a><span class="st">          susprindum_pbc +</span></span>
<span id="cb481-139"><a href="#cb481-139" aria-hidden="true" tabindex="-1"></a><span class="st">          susprindum_mar +</span></span>
<span id="cb481-140"><a href="#cb481-140" aria-hidden="true" tabindex="-1"></a><span class="st">          strat(tipo_de_plan_2_mod)+</span></span>
<span id="cb481-141"><a href="#cb481-141" aria-hidden="true" tabindex="-1"></a><span class="st">          strat(time_interval2)"</span>)), </span>
<span id="cb481-142"><a href="#cb481-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb481-143"><a href="#cb481-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-144"><a href="#cb481-144" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform cox.zph test</span></span>
<span id="cb481-145"><a href="#cb481-145" aria-hidden="true" tabindex="-1"></a>  cox_test <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table[<span class="fu">nrow</span>(<span class="fu">cox.zph</span>(model)<span class="sc">$</span>table), <span class="dv">1</span>])</span>
<span id="cb481-146"><a href="#cb481-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb481-147"><a href="#cb481-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a contingency table</span></span>
<span id="cb481-148"><a href="#cb481-148" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time_interval2, data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2)</span>
<span id="cb481-149"><a href="#cb481-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb481-150"><a href="#cb481-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb481-151"><a href="#cb481-151" aria-hidden="true" tabindex="-1"></a>  results_strat[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb481-152"><a href="#cb481-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIC =</span> <span class="fu">AIC</span>(model),</span>
<span id="cb481-153"><a href="#cb481-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">cox_zph =</span> cox_test,</span>
<span id="cb481-154"><a href="#cb481-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">table =</span> contingency_table,</span>
<span id="cb481-155"><a href="#cb481-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">fail=</span> model<span class="sc">$</span>fail,</span>
<span id="cb481-156"><a href="#cb481-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">lrtest=</span> <span class="fu">paste0</span>(model<span class="sc">$</span>stats[<span class="st">"Model L.R."</span>],<span class="st">", "</span>,model<span class="sc">$</span>stats[<span class="st">"d.f."</span>],<span class="st">" p="</span>, model<span class="sc">$</span>stats[<span class="st">"P"</span>]),</span>
<span id="cb481-157"><a href="#cb481-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">r2=</span> model<span class="sc">$</span>stats[<span class="st">"R2"</span>]</span>
<span id="cb481-158"><a href="#cb481-158" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb481-159"><a href="#cb481-159" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb481-160"><a href="#cb481-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-161"><a href="#cb481-161" aria-hidden="true" tabindex="-1"></a><span class="co"># You can now inspect 'results' for the output from each set of breakpoints</span></span>
<span id="cb481-162"><a href="#cb481-162" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_strat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$AIC
[1] 201623

[[1]]$cox_zph
[1] "132"

[[1]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,10]               3697                 4941        3018
  (10,20]              1701                 2693        1618
  (20,40]              1766                 3099        1774
  (40,60]               911                 1686         938
  (60,80]               450                  938         517
  (80,135]              270                  642         329

[[1]]$fail
[1] FALSE

[[1]]$lrtest
[1] "244.41760910835, 20 p=0"

[[1]]$r2
    R2 
0.0137 


[[2]]
[[2]]$AIC
[1] 199180

[[2]]$cox_zph
[1] "123"

[[2]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,15]               4692                 6504        3976
  (15,30]              1748                 2892        1728
  (30,45]              1018                 1890         992
  (45,60]               617                 1133         652
  (60,75]               364                  762         411
  (75,135]              356                  818         435

[[2]]$fail
[1] FALSE

[[2]]$lrtest
[1] "236.569110802346, 20 p=0"

[[2]]$r2
    R2 
0.0133 


[[3]]
[[3]]$AIC
[1] 199350

[[3]]$cox_zph
[1] "136"

[[3]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,15]               4692                 6504        3976
  (15,30]              1748                 2892        1728
  (30,45]              1018                 1890         992
  (45,60]               617                 1133         652
  (60,80]               450                  938         517
  (80,135]              270                  642         329

[[3]]$fail
[1] FALSE

[[3]]$lrtest
[1] "234.629002713889, 20 p=0"

[[3]]$r2
    R2 
0.0132 


[[4]]
[[4]]$AIC
[1] 205132

[[4]]$cox_zph
[1] "149"

[[4]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,20]                5398                 7634        4636
  (20,40]               1766                 3099        1774
  (40,60]                911                 1686         938
  (60,80]                450                  938         517
  (80,100]               189                  472         246
  (100,135]               81                  170          83

[[4]]$fail
[1] FALSE

[[4]]$lrtest
[1] "266.667155946809, 20 p=0"

[[4]]$r2
   R2 
0.015 


[[5]]
[[5]]$AIC
[1] 198563

[[5]]$cox_zph
[1] "177"

[[5]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,10]               3697                 4941        3018
  (10,20]              1701                 2693        1618
  (20,30]              1042                 1762        1068
  (30,50]              1246                 2306        1231
  (50,70]               660                 1275         710
  (70,135]              449                 1022         549

[[5]]$fail
[1] FALSE

[[5]]$lrtest
[1] "263.532100785029, 20 p=0"

[[5]]$r2
    R2 
0.0148 


[[6]]
[[6]]$AIC
[1] 205132

[[6]]$cox_zph
[1] "149"

[[6]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,20]                5398                 7634        4636
  (20,40]               1766                 3099        1774
  (40,60]                911                 1686         938
  (60,80]                450                  938         517
  (80,100]               189                  472         246
  (100,135]               81                  170          83
  (135,150]                0                    0           0

[[6]]$fail
[1] FALSE

[[6]]$lrtest
[1] "266.667155946809, 20 p=0"

[[6]]$r2
   R2 
0.015 


[[7]]
[[7]]$AIC
[1] 210729

[[7]]$cox_zph
[1] "646"

[[7]]$table
             
              basic ambulatory intensive ambulatory residential
  [0,4.85]                1887                 2634        1684
  (4.85,11]               2030                 2648        1529
  (11,22.1]               1747                 2777        1658
  (22.1,42.1]             1631                 2899        1668
  (42.1,135]              1500                 3041        1655

[[7]]$fail
[1] FALSE

[[7]]$lrtest
[1] "678.659228396689, 20 p=0"

[[7]]$r2
    R2 
0.0377 


[[8]]
[[8]]$AIC
[1] 236876

[[8]]$cox_zph
[1] "273"

[[8]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,74]                8424                13137        7734
  (74,90]                222                  496         284
  (90,108]               117                  288         130
  (108,117]               26                   63          37
  (117,128]                6                   13           9
  (128,135]                0                    2           0

[[8]]$fail
[1] FALSE

[[8]]$lrtest
[1] "2002.72773700504, 20 p=0"

[[8]]$r2
   R2 
0.107 


[[9]]
[[9]]$AIC
[1] 220361

[[9]]$cox_zph
[1] "289"

[[9]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,18]                5132                 7218        4392
  (18,68]               3174                 5664        3202
  (68,73]                 93                  215         119
  (73,80]                126                  260         152
  (80,119]               266                  632         325
  (119,135]                4                   10           4

[[9]]$fail
[1] FALSE

[[9]]$lrtest
[1] "821.194660197216, 20 p=0"

[[9]]$r2
    R2 
0.0454 


[[10]]
[[10]]$AIC
[1] 202224

[[10]]$cox_zph
[1] "158"

[[10]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,15]               4692                 6504        3976
  (15,25]              1270                 2044        1211
  (25,50]              1724                 3154        1748
  (50,70]               660                 1275         710
  (70,85]               248                  523         304
  (85,135]              201                  499         245

[[10]]$fail
[1] FALSE

[[10]]$lrtest
[1] "242.145208129747, 20 p=0"

[[10]]$r2
    R2 
0.0136 


[[11]]
[[11]]$AIC
[1] 213893

[[11]]$cox_zph
[1] "211"

[[11]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,1]                   88                  177         402
  (1,24]                5779                 8203        4691
  (24,54]               1986                 3617        2021
  (54,70]                493                  980         531
  (70,125]               447                 1019         549
  (125,135]                2                    3           0

[[11]]$fail
[1] FALSE

[[11]]$lrtest
[1] "450.440814013651, 20 p=0"

[[11]]$r2
    R2 
0.0252 


[[12]]
[[12]]$AIC
[1] 220078

[[12]]$cox_zph
[1] "225"

[[12]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,1]                   88                  177         402
  (1,39]                7005                10427        5944
  (39,64]               1100                 2070        1126
  (64,90]                453                  959         546
  (90,122]               147                  360         176
  (122,135]                2                    6           0

[[12]]$fail
[1] FALSE

[[12]]$lrtest
[1] "567.485317411018, 20 p=0"

[[12]]$r2
    R2 
0.0316 


[[13]]
[[13]]$AIC
[1] 224070

[[13]]$cox_zph
[1] "223"

[[13]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,42]                7292                10953        6531
  (42,78]               1198                 2340        1295
  (78,84]                 90                  182         104
  (84,126]               215                  521         264
  (126,128]                0                    1           0
  (128,135]                0                    2           0

[[13]]$fail
[1] FALSE

[[13]]$lrtest
[1] "892.089426955208, 20 p=0"

[[13]]$r2
    R2 
0.0492 


[[14]]
[[14]]$AIC
[1] 231083

[[14]]$cox_zph
[1] "244"

[[14]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,11]                3917                 5282        3213
  (11,78]               4573                 8011        4613
  (78,86]                115                  230         143
  (86,119]               186                  466         221
  (119,129]                4                    9           4
  (129,135]                0                    1           0

[[14]]$fail
[1] FALSE

[[14]]$lrtest
[1] "1732.33594561392, 20 p=0"

[[14]]$r2
    R2 
0.0934 


[[15]]
[[15]]$AIC
[1] 222381

[[15]]$cox_zph
[1] "241"

[[15]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,15]                4692                 6504        3976
  (15,65]               3536                 6218        3521
  (65,90]                418                  911         521
  (90,107]               112                  275         126
  (107,120]               34                   81          50
  (120,135]                3                   10           0

[[15]]$fail
[1] FALSE

[[15]]$lrtest
[1] "957.269989653141, 20 p=0"

[[15]]$r2
    R2 
0.0527 


[[16]]
[[16]]$AIC
[1] 216166

[[16]]$cox_zph
[1] "317"

[[16]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,29]                6350                 9232        5603
  (29,51]               1385                 2542        1372
  (51,99]                974                 2042        1129
  (99,110]                61                  125          56
  (110,131]               25                   57          34
  (131,135]                0                    1           0

[[16]]$fail
[1] FALSE

[[16]]$lrtest
[1] "526.069504202693, 20 p=0"

[[16]]$r2
    R2 
0.0293 


[[17]]
[[17]]$AIC
[1] 241240

[[17]]$cox_zph
[1] "336"

[[17]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,88]                8623                13584        7988
  (88,93]                 47                  113          58
  (93,110]               100                  244         114
  (110,129]               25                   57          34
  (129,133]                0                    0           0
  (133,135]                0                    1           0

[[17]]$fail
[1] FALSE

[[17]]$lrtest
[1] "2685.26883503475, 20 p=0"

[[17]]$r2
   R2 
0.141 


[[18]]
[[18]]$AIC
[1] 227090

[[18]]$cox_zph
[1] "240"

[[18]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,4]                 1474                 2139        1422
  (4,55]                6419                 9938        5742
  (55,70]                453                  900         481
  (70,102]               387                  869         477
  (102,112]               47                  111          43
  (112,135]               15                   42          29

[[18]]$fail
[1] FALSE

[[18]]$lrtest
[1] "1063.35690842738, 20 p=0"

[[18]]$r2
    R2 
0.0584 


[[19]]
[[19]]$AIC
[1] 204946

[[19]]$cox_zph
[1] "222"

[[19]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,29]               6350                 9232        5603
  (29,43]               998                 1837         989
  (43,51]               387                  705         383
  (51,68]               571                 1108         619
  (68,88]               317                  702         394
  (88,135]              172                  415         206

[[19]]$fail
[1] FALSE

[[19]]$lrtest
[1] "309.440397133556, 20 p=0"

[[19]]$r2
    R2 
0.0174 


[[20]]
[[20]]$AIC
[1] 207600

[[20]]$cox_zph
[1] "163"

[[20]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,9]                3455                 4593        2807
  (9,30]               2985                 4803        2897
  (30,45]              1018                 1890         992
  (45,79]              1052                 2043        1148
  (79,84]                70                  146          86
  (84,135]              215                  524         264

[[20]]$fail
[1] FALSE

[[20]]$lrtest
[1] "418.016287462291, 20 p=0"

[[20]]$r2
    R2 
0.0234 


[[21]]
[[21]]$AIC
[1] 227986

[[21]]$cox_zph
[1] "172"

[[21]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,6]                2395                 3270        2033
  (6,9]                1060                 1323         774
  (9,70]               4891                 8384        4838
  (70,80]               179                  380         220
  (80,92]               134                  317         175
  (92,135]              136                  325         154

[[21]]$fail
[1] FALSE

[[21]]$lrtest
[1] "1537.47392012289, 20 p=0"

[[21]]$r2
    R2 
0.0833 


[[22]]
[[22]]$AIC
[1] 228537

[[22]]$cox_zph
[1] "232"

[[22]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,54]                7853                11997        7114
  (54,76]                609                 1226         666
  (76,106]               291                  678         360
  (106,107]                5                    7           4
  (107,131]               37                   90          50
  (131,135]                0                    1           0

[[22]]$fail
[1] FALSE

[[22]]$lrtest
[1] "1075.1562108639, 20 p=0"

[[22]]$r2
   R2 
0.059 


[[23]]
[[23]]$AIC
[1] 209837

[[23]]$cox_zph
[1] "168"

[[23]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,14]                4509                 6237        3819
  (14,43]               2839                 4832        2773
  (43,51]                387                  705         383
  (51,68]                571                 1108         619
  (68,129]               489                 1116         600
  (129,135]                0                    1           0

[[23]]$fail
[1] FALSE

[[23]]$lrtest
[1] "453.468024794711, 20 p=0"

[[23]]$r2
    R2 
0.0253 


[[24]]
[[24]]$AIC
[1] 209169

[[24]]$cox_zph
[1] "224"

[[24]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,5]                 1947                 2708        1720
  (5,20]                3451                 4926        2916
  (20,36]               1499                 2599        1538
  (36,74]               1527                 2904        1560
  (74,107]               334                  771         410
  (107,135]               37                   91          50

[[24]]$fail
[1] FALSE

[[24]]$lrtest
[1] "440.86968850813, 20 p=0"

[[24]]$r2
    R2 
0.0246 


[[25]]
[[25]]$AIC
[1] 225610

[[25]]$cox_zph
[1] "260"

[[25]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,3]                  915                 1436        1091
  (3,51]                6820                10338        5884
  (51,71]                629                 1242         700
  (71,75]                 75                  165          84
  (75,115]               347                  789         421
  (115,135]                9                   29          14

[[25]]$fail
[1] FALSE

[[25]]$lrtest
[1] "908.308044379839, 20 p=0"

[[25]]$r2
    R2 
0.0501 


[[26]]
[[26]]$AIC
[1] 220425

[[26]]$cox_zph
[1] "244"

[[26]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,41]                7224                10837        6468
  (41,66]               1024                 1948        1067
  (66,71]                116                  231         140
  (71,107]               394                  892         469
  (107,121]               35                   82          50
  (121,135]                2                    9           0

[[26]]$fail
[1] FALSE

[[26]]$lrtest
[1] "695.022012121801, 20 p=0"

[[26]]$r2
    R2 
0.0386 


[[27]]
[[27]]$AIC
[1] 218142

[[27]]$cox_zph
[1] "152"

[[27]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,10]                3697                 4941        3018
  (10,53]               4118                 6978        4055
  (53,60]                260                  500         275
  (60,78]                415                  874         478
  (78,100]               224                  536         285
  (100,135]               81                  170          83

[[27]]$fail
[1] FALSE

[[27]]$lrtest
[1] "743.24174347092, 20 p=0"

[[27]]$r2
    R2 
0.0412 


[[28]]
[[28]]$AIC
[1] 218161

[[28]]$cox_zph
[1] "252"

[[28]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,33]                6697                 9826        5947
  (33,36]                200                  407         227
  (36,76]               1565                 2990        1606
  (76,77]                 15                   23          20
  (77,122]               316                  747         394
  (122,135]                2                    6           0

[[28]]$fail
[1] FALSE

[[28]]$lrtest
[1] "658.233573928737, 20 p=0"

[[28]]$r2
    R2 
0.0366 


[[29]]
[[29]]$AIC
[1] 216388

[[29]]$cox_zph
[1] "236"

[[29]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,36]                6897                10233        6174
  (36,52]                873                 1621         853
  (52,86]                835                 1669         942
  (86,102]               128                  323         153
  (102,132]               62                  152          72
  (132,135]                0                    1           0

[[29]]$fail
[1] FALSE

[[29]]$lrtest
[1] "513.853596449771, 20 p=0"

[[29]]$r2
    R2 
0.0287 


[[30]]
[[30]]$AIC
[1] 197479

[[30]]$cox_zph
[1] "396"

[[30]]$table
          
           basic ambulatory intensive ambulatory residential
  [0,13]               4335                 5941        3619
  (13,17]               657                 1039         637
  (17,28]              1271                 2094        1259
  (28,36]               634                 1159         659
  (36,52]               873                 1621         853
  (52,135]             1025                 2145        1167

[[30]]$fail
[1] FALSE

[[30]]$lrtest
[1] "316.936203734804, 20 p=0"

[[30]]$r2
    R2 
0.0178 


[[31]]
[[31]]$AIC
[1] 224694

[[31]]$cox_zph
[1] "253"

[[31]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,50]                7686                11702        6935
  (50,62]                449                  838         469
  (62,96]                555                 1202         672
  (96,106]                63                  159          64
  (106,116]               34                   77          44
  (116,135]                8                   21          10

[[31]]$fail
[1] FALSE

[[31]]$lrtest
[1] "908.547777739586, 20 p=0"

[[31]]$r2
    R2 
0.0501 


[[32]]
[[32]]$AIC
[1] 232440

[[32]]$cox_zph
[1] "249"

[[32]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,62]                8135                12540        7404
  (62,73]                264                  557         309
  (73,113]               382                  861         455
  (113,120]               11                   31          26
  (120,129]                3                    9           0
  (129,135]                0                    1           0

[[32]]$fail
[1] FALSE

[[32]]$lrtest
[1] "1438.46574364958, 20 p=0"

[[32]]$r2
    R2 
0.0782 


[[33]]
[[33]]$AIC
[1] 229114

[[33]]$cox_zph
[1] "262"

[[33]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,55]                7893                12077        7164
  (55,81]                645                 1318         716
  (81,82]                 13                   35          19
  (82,107]               207                  478         245
  (107,124]               35                   88          50
  (124,135]                2                    3           0

[[33]]$fail
[1] FALSE

[[33]]$lrtest
[1] "1131.15766450859, 20 p=0"

[[33]]$r2
   R2 
0.062 


[[34]]
[[34]]$AIC
[1] 207443

[[34]]$cox_zph
[1] "324"

[[34]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,16]                4837                 6759        4118
  (16,38]               2194                 3717        2174
  (38,43]                317                  593         300
  (43,51]                387                  705         383
  (51,132]              1060                 2224        1219
  (132,135]                0                    1           0

[[34]]$fail
[1] FALSE

[[34]]$lrtest
[1] "488.713657127577, 20 p=0"

[[34]]$r2
    R2 
0.0273 


[[35]]
[[35]]$AIC
[1] 215882

[[35]]$cox_zph
[1] "685"

[[35]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,8]                 3151                 4168        2554
  (8,28]                3112                 4906        2961
  (28,35]                568                 1010         582
  (35,112]              1949                 3873        2068
  (112,114]                5                    9          10
  (114,135]               10                   33          19

[[35]]$fail
[1] FALSE

[[35]]$lrtest
[1] "872.879308136587, 20 p=0"

[[35]]$r2
    R2 
0.0482 


[[36]]
[[36]]$AIC
[1] 226868

[[36]]$cox_zph
[1] "466"

[[36]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,1]                   88                  177         402
  (1,34]                6681                 9783        5633
  (34,98]               1932                 3827        2062
  (98,128]                94                  210          97
  (128,132]                0                    1           0
  (132,135]                0                    1           0

[[36]]$fail
[1] FALSE

[[36]]$lrtest
[1] "1064.25334982859, 20 p=0"

[[36]]$r2
    R2 
0.0584 


[[37]]
[[37]]$AIC
[1] 219085

[[37]]$cox_zph
[1] "185"

[[37]]$table
           
            basic ambulatory intensive ambulatory residential
  [0,4]                 1474                 2139        1422
  (4,10]                2223                 2802        1596
  (10,45]               3761                 6345        3678
  (45,75]                981                 1895        1063
  (75,124]               354                  815         435
  (124,135]                2                    3           0

[[37]]$fail
[1] FALSE

[[37]]$lrtest
[1] "697.807880941953, 20 p=0"

[[37]]$r2
    R2 
0.0387 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_strat[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$AIC
[1] 199180

$cox_zph
[1] "123"

$table
          
           basic ambulatory intensive ambulatory residential
  [0,15]               4692                 6504        3976
  (15,30]              1748                 2892        1728
  (30,45]              1018                 1890         992
  (45,60]               617                 1133         652
  (60,75]               364                  762         411
  (75,135]              356                  818         435

$fail
[1] FALSE

$lrtest
[1] "236.569110802346, 20 p=0"

$r2
    R2 
0.0133 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co">#117</span></span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"El original X2= 430.6824, df=18, p&lt; 2e-16; "</span>)</span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"SELECTY INTERVAL TIME TO STRATIFY"</span>)</span>
<span id="cb485-8"><a href="#cb485-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb485-9"><a href="#cb485-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/selected_models_strat.R"</span>)</span>
<span id="cb485-10"><a href="#cb485-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a factor variable with time intervals</span></span>
<span id="cb485-11"><a href="#cb485-11" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3 <span class="ot">&lt;-</span> <span class="fu">cut</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb485-12"><a href="#cb485-12" aria-hidden="true" tabindex="-1"></a>                                                 breaks_list[[<span class="dv">17</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">7</span>)], </span>
<span id="cb485-13"><a href="#cb485-13" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb485-14"><a href="#cb485-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-15"><a href="#cb485-15" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb485-16"><a href="#cb485-16" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb485-17"><a href="#cb485-17" aria-hidden="true" tabindex="-1"></a>model_after_time_strat<span class="ot">&lt;-</span></span>
<span id="cb485-18"><a href="#cb485-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span></span>
<span id="cb485-19"><a href="#cb485-19" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb485-20"><a href="#cb485-20" aria-hidden="true" tabindex="-1"></a>          lag_tr_outcome<span class="sc">+</span></span>
<span id="cb485-21"><a href="#cb485-21" aria-hidden="true" tabindex="-1"></a>          lag_comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb485-22"><a href="#cb485-22" aria-hidden="true" tabindex="-1"></a>          lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb485-23"><a href="#cb485-23" aria-hidden="true" tabindex="-1"></a>          log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb485-24"><a href="#cb485-24" aria-hidden="true" tabindex="-1"></a>          lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb485-25"><a href="#cb485-25" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb485-26"><a href="#cb485-26" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr <span class="sc">+</span> </span>
<span id="cb485-27"><a href="#cb485-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb485-28"><a href="#cb485-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb485-29"><a href="#cb485-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb485-30"><a href="#cb485-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar <span class="sc">+</span></span>
<span id="cb485-31"><a href="#cb485-31" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study <span class="sc">+</span></span>
<span id="cb485-32"><a href="#cb485-32" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with <span class="sc">+</span></span>
<span id="cb485-33"><a href="#cb485-33" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb485-34"><a href="#cb485-34" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb485-35"><a href="#cb485-35" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb485-36"><a href="#cb485-36" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb485-37"><a href="#cb485-37" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb485-38"><a href="#cb485-38" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb485-39"><a href="#cb485-39" aria-hidden="true" tabindex="-1"></a>          susprindum_mar <span class="sc">+</span></span>
<span id="cb485-40"><a href="#cb485-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">strat</span>(tipo_de_plan_2_mod)<span class="sc">+</span></span>
<span id="cb485-41"><a href="#cb485-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">strat</span>(time_interval3),</span>
<span id="cb485-42"><a href="#cb485-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb485-43"><a href="#cb485-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb485-44"><a href="#cb485-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb485-45"><a href="#cb485-45" aria-hidden="true" tabindex="-1"></a>model_after_time_strat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
  Surv(lag_time, time, event)                   cluster(id) 
                        13317                             0 
               lag_tr_outcome       lag_comp_bpsc_y3_severe 
                            0                             0 
             lag_less_90d_tr1 log_lag_dias_treat_imp_sin_na 
                            0                         13317 
             lag_policonsumo2                 edad_al_ing_1 
                            0                             0 
                 ano_nac_corr                  susinidum_oh 
                            0                             0 
                susinidum_coc                 susinidum_pbc 
                            0                             0 
                susinidum_mar              psycom_dum_study 
                            0                             0 
              psycom_dum_with            freq_cons_dum_5day 
                            0                             0 
           cond_oc_dum_2inact            cond_oc_dum_3unemp 
                            0                             0 
                susprindum_oh                susprindum_coc 
                            0                             0 
               susprindum_pbc                susprindum_mar 
                            0                             0 
           tipo_de_plan_2_mod                time_interval3 
                            0                             0 

Cox Proportional Hazards Model
 
 cph(formula = Surv(lag_time, time, event) ~ cluster(id) + lag_tr_outcome + 
     lag_comp_bpsc_y3_severe + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + 
     lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
     susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_study + 
     psycom_dum_with + freq_cons_dum_5day + cond_oc_dum_2inact + 
     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
     susprindum_mar + strat(tipo_de_plan_2_mod) + strat(time_interval3), 
     data = data_mine_miss_restr_proc2 %&gt;% data.table::as.data.table() %&gt;% 
         data.frame(), x = TRUE, y = TRUE, iter.max = 250 * 4, 
     tol = 1e-06, surv = TRUE)
 
 
                                                                     Status
 Stratum                                                              No Event
   tipo_de_plan_2_mod=basic ambulatory.time_interval3=[0,88]                 0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=[0,88]          0
   tipo_de_plan_2_mod=GP residential.time_interval3=[0,88]                   0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=[0,88]          0
   tipo_de_plan_2_mod=WO residential.time_interval3=[0,88]                   0
   tipo_de_plan_2_mod=basic ambulatory.time_interval3=(88,93]                0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=(88,93]         0
   tipo_de_plan_2_mod=GP residential.time_interval3=(88,93]                  0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=(88,93]         0
   tipo_de_plan_2_mod=WO residential.time_interval3=(88,93]                  0
   tipo_de_plan_2_mod=basic ambulatory.time_interval3=(93,135]               0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=(93,135]        0
   tipo_de_plan_2_mod=GP residential.time_interval3=(93,135]                 0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=(93,135]        0
   tipo_de_plan_2_mod=WO residential.time_interval3=(93,135]                 0
                                                                     Status
 Stratum                                                              Event
   tipo_de_plan_2_mod=basic ambulatory.time_interval3=[0,88]           5356
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=[0,88]    6212
   tipo_de_plan_2_mod=GP residential.time_interval3=[0,88]             2895
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=[0,88]     964
   tipo_de_plan_2_mod=WO residential.time_interval3=[0,88]             1451
   tipo_de_plan_2_mod=basic ambulatory.time_interval3=(88,93]            77
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=(88,93]     74
   tipo_de_plan_2_mod=GP residential.time_interval3=(88,93]              44
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=(88,93]     10
   tipo_de_plan_2_mod=WO residential.time_interval3=(88,93]              13
   tipo_de_plan_2_mod=basic ambulatory.time_interval3=(93,135]          200
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=(93,135]   213
   tipo_de_plan_2_mod=GP residential.time_interval3=(93,135]             87
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=(93,135]    41
   tipo_de_plan_2_mod=WO residential.time_interval3=(93,135]             34
 
                        Model Tests       Discrimination    
                                                 Indexes    
 Obs    17671    LR chi2    2722.85       R2       0.143    
 Events 17671    d.f.            20    R2(20,17671)0.142    
 Center   402    Pr(&gt; chi2)  0.0000       Dxy      0.256    
                 Score chi2 2731.11                         
                 Pr(&gt; chi2)  0.0000                         
 
                               Coef    S.E.   Wald Z Pr(&gt;|Z|)
 lag_tr_outcome                 0.1374 0.0182  7.55  &lt;0.0001 
 lag_comp_bpsc_y3_severe        0.0508 0.0169  3.00  0.0027  
 lag_less_90d_tr1               0.1048 0.0252  4.16  &lt;0.0001 
 log_lag_dias_treat_imp_sin_na -0.0197 0.0110 -1.79  0.0733  
 lag_policonsumo2              -0.0206 0.0191 -1.07  0.2828  
 edad_al_ing_1                  0.1987 0.0038 52.28  &lt;0.0001 
 ano_nac_corr                   0.1997 0.0037 53.44  &lt;0.0001 
 susinidum_oh                   0.0440 0.0483  0.91  0.3623  
 susinidum_coc                  0.1127 0.0595  1.89  0.0582  
 susinidum_pbc                  0.1409 0.0545  2.58  0.0098  
 susinidum_mar                  0.1610 0.0492  3.27  0.0011  
 psycom_dum_study               0.0132 0.0231  0.57  0.5691  
 psycom_dum_with                0.0145 0.0164  0.89  0.3759  
 freq_cons_dum_5day             0.0094 0.0160  0.59  0.5556  
 cond_oc_dum_2inact             0.0757 0.0218  3.47  0.0005  
 cond_oc_dum_3unemp             0.0841 0.0176  4.79  &lt;0.0001 
 susprindum_oh                 -0.0798 0.0679 -1.18  0.2398  
 susprindum_coc                -0.0757 0.0687 -1.10  0.2708  
 susprindum_pbc                -0.0578 0.0675 -0.86  0.3917  
 susprindum_mar                -0.0801 0.0744 -1.08  0.2814  
 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox Proportional Hazards Model</span></span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cph(formula = Surv(lag_time, time, event) ~ cluster(id) + lag_tr_outcome + </span></span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_comp_bpsc_y3_severe + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + </span></span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + susinidum_oh + </span></span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_study + </span></span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_with + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb487-8"><a href="#cb487-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb487-9"><a href="#cb487-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar + strat(tipo_de_plan_2_mod) + strat(time_interval3), </span></span>
<span id="cb487-10"><a href="#cb487-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data_mine_miss_restr_proc2 %&gt;% data.table::as.data.table() %&gt;% </span></span>
<span id="cb487-11"><a href="#cb487-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         data.frame(), x = TRUE, y = TRUE, iter.max = 250 * 4, </span></span>
<span id="cb487-12"><a href="#cb487-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     tol = 1e-06, surv = TRUE)</span></span>
<span id="cb487-13"><a href="#cb487-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb487-14"><a href="#cb487-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb487-15"><a href="#cb487-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                                     Status</span></span>
<span id="cb487-16"><a href="#cb487-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratum                                                              No Event Event</span></span>
<span id="cb487-17"><a href="#cb487-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3=[0,88]                 0  5356</span></span>
<span id="cb487-18"><a href="#cb487-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=[0,88]          0  6212</span></span>
<span id="cb487-19"><a href="#cb487-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3=[0,88]                   0  2895</span></span>
<span id="cb487-20"><a href="#cb487-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=[0,88]          0   964</span></span>
<span id="cb487-21"><a href="#cb487-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3=[0,88]                   0  1451</span></span>
<span id="cb487-22"><a href="#cb487-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3=(88,93]                0    77</span></span>
<span id="cb487-23"><a href="#cb487-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=(88,93]         0    74</span></span>
<span id="cb487-24"><a href="#cb487-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3=(88,93]                  0    44</span></span>
<span id="cb487-25"><a href="#cb487-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=(88,93]         0    10</span></span>
<span id="cb487-26"><a href="#cb487-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3=(88,93]                  0    13</span></span>
<span id="cb487-27"><a href="#cb487-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3=(93,135]               0   200</span></span>
<span id="cb487-28"><a href="#cb487-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3=(93,135]        0   213</span></span>
<span id="cb487-29"><a href="#cb487-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3=(93,135]                 0    87</span></span>
<span id="cb487-30"><a href="#cb487-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3=(93,135]        0    41</span></span>
<span id="cb487-31"><a href="#cb487-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3=(93,135]                 0    34</span></span>
<span id="cb487-32"><a href="#cb487-32" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb487-33"><a href="#cb487-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                        Model Tests       Discrimination    </span></span>
<span id="cb487-34"><a href="#cb487-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                 Indexes    </span></span>
<span id="cb487-35"><a href="#cb487-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Obs    17671    LR chi2    2722.85       R2       0.143    </span></span>
<span id="cb487-36"><a href="#cb487-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Events 17671    d.f.            20    R2(20,17671)0.142    </span></span>
<span id="cb487-37"><a href="#cb487-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Center   402    Pr(&gt; chi2)  0.0000       Dxy      0.256    </span></span>
<span id="cb487-38"><a href="#cb487-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Score chi2 2731.11                         </span></span>
<span id="cb487-39"><a href="#cb487-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Pr(&gt; chi2)  0.0000                         </span></span>
<span id="cb487-40"><a href="#cb487-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb487-41"><a href="#cb487-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                               Coef    S.E.   Wald Z Pr(&gt;|Z|)</span></span>
<span id="cb487-42"><a href="#cb487-42" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 0.1374 0.0182  7.55  &lt;0.0001 </span></span>
<span id="cb487-43"><a href="#cb487-43" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        0.0508 0.0169  3.00  0.0027  </span></span>
<span id="cb487-44"><a href="#cb487-44" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1               0.1048 0.0252  4.16  &lt;0.0001 </span></span>
<span id="cb487-45"><a href="#cb487-45" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na -0.0197 0.0110 -1.79  0.0733  </span></span>
<span id="cb487-46"><a href="#cb487-46" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2              -0.0206 0.0191 -1.07  0.2828  </span></span>
<span id="cb487-47"><a href="#cb487-47" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.1987 0.0038 52.28  &lt;0.0001 </span></span>
<span id="cb487-48"><a href="#cb487-48" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.1997 0.0037 53.44  &lt;0.0001 </span></span>
<span id="cb487-49"><a href="#cb487-49" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   0.0440 0.0483  0.91  0.3623  </span></span>
<span id="cb487-50"><a href="#cb487-50" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                  0.1127 0.0595  1.89  0.0582  </span></span>
<span id="cb487-51"><a href="#cb487-51" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  0.1409 0.0545  2.58  0.0098  </span></span>
<span id="cb487-52"><a href="#cb487-52" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  0.1610 0.0492  3.27  0.0011  </span></span>
<span id="cb487-53"><a href="#cb487-53" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               0.0132 0.0231  0.57  0.5691  </span></span>
<span id="cb487-54"><a href="#cb487-54" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                0.0145 0.0164  0.89  0.3759  </span></span>
<span id="cb487-55"><a href="#cb487-55" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.0094 0.0160  0.59  0.5556  </span></span>
<span id="cb487-56"><a href="#cb487-56" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact             0.0757 0.0218  3.47  0.0005  </span></span>
<span id="cb487-57"><a href="#cb487-57" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.0841 0.0176  4.79  &lt;0.0001 </span></span>
<span id="cb487-58"><a href="#cb487-58" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                 -0.0798 0.0679 -1.18  0.2398  </span></span>
<span id="cb487-59"><a href="#cb487-59" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                -0.0757 0.0687 -1.10  0.2708  </span></span>
<span id="cb487-60"><a href="#cb487-60" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                -0.0578 0.0675 -0.86  0.3917  </span></span>
<span id="cb487-61"><a href="#cb487-61" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                -0.0801 0.0744 -1.08  0.2814  </span></span>
<span id="cb487-62"><a href="#cb487-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-63"><a href="#cb487-63" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(model_after_time_strat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                chisq df       p
lag_tr_outcome                 60.354  1 7.9e-15
lag_comp_bpsc_y3_severe        20.528  1 5.9e-06
lag_less_90d_tr1              151.524  1 &lt; 2e-16
log_lag_dias_treat_imp_sin_na 160.971  1 &lt; 2e-16
lag_policonsumo2                5.712  1 0.01685
edad_al_ing_1                  31.506  1 2.0e-08
ano_nac_corr                   19.244  1 1.2e-05
susinidum_oh                   35.309  1 2.8e-09
susinidum_coc                   0.931  1 0.33456
susinidum_pbc                  10.487  1 0.00120
susinidum_mar                  17.059  1 3.6e-05
psycom_dum_study               51.800  1 6.1e-13
psycom_dum_with                18.230  1 2.0e-05
freq_cons_dum_5day              3.577  1 0.05860
cond_oc_dum_2inact              3.270  1 0.07055
cond_oc_dum_3unemp              7.459  1 0.00631
susprindum_oh                  16.966  1 3.8e-05
susprindum_coc                  0.186  1 0.66631
susprindum_pbc                 12.610  1 0.00038
susprindum_mar                  1.337  1 0.24758
GLOBAL                        323.981 20 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 chisq df       p</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 60.354  1 7.9e-15</span></span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        20.528  1 5.9e-06</span></span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1              151.524  1 &lt; 2e-16</span></span>
<span id="cb489-5"><a href="#cb489-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na 160.971  1 &lt; 2e-16</span></span>
<span id="cb489-6"><a href="#cb489-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                5.712  1 0.01685</span></span>
<span id="cb489-7"><a href="#cb489-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  31.506  1 2.0e-08</span></span>
<span id="cb489-8"><a href="#cb489-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   19.244  1 1.2e-05</span></span>
<span id="cb489-9"><a href="#cb489-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                   35.309  1 2.8e-09</span></span>
<span id="cb489-10"><a href="#cb489-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                   0.931  1 0.33456</span></span>
<span id="cb489-11"><a href="#cb489-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                  10.487  1 0.00120</span></span>
<span id="cb489-12"><a href="#cb489-12" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                  17.059  1 3.6e-05</span></span>
<span id="cb489-13"><a href="#cb489-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               51.800  1 6.1e-13</span></span>
<span id="cb489-14"><a href="#cb489-14" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                18.230  1 2.0e-05</span></span>
<span id="cb489-15"><a href="#cb489-15" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              3.577  1 0.05860</span></span>
<span id="cb489-16"><a href="#cb489-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              3.270  1 0.07055</span></span>
<span id="cb489-17"><a href="#cb489-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp              7.459  1 0.00631</span></span>
<span id="cb489-18"><a href="#cb489-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  16.966  1 3.8e-05</span></span>
<span id="cb489-19"><a href="#cb489-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  0.186  1 0.66631</span></span>
<span id="cb489-20"><a href="#cb489-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 12.610  1 0.00038</span></span>
<span id="cb489-21"><a href="#cb489-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  1.337  1 0.24758</span></span>
<span id="cb489-22"><a href="#cb489-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        323.981 20 &lt; 2e-16</span></span>
<span id="cb489-23"><a href="#cb489-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-24"><a href="#cb489-24" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3, data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
           basic ambulatory GP intensive ambulatory GP residential
  [0,88]               9716                   11210           5073
  (88,93]                77                      74             44
  (93,135]              200                     213             87
          
           WO intensive ambulatory WO residential
  [0,88]                      1709           2487
  (88,93]                       10             13
  (93,135]                      41             34</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#          basic ambulatory GP intensive ambulatory GP residential WO intensive ambulatory WO residential</span></span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># [0,88]               9716                   11210           5073                    1709           2487</span></span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (88,93]                77                      74             44                      10             13</span></span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (93,135]              200                     213             87                      41             34</span></span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-6"><a href="#cb491-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb491-7"><a href="#cb491-7" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb491-8"><a href="#cb491-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb491-9"><a href="#cb491-9" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3_alt <span class="ot">&lt;-</span> <span class="fu">cut</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time, </span>
<span id="cb491-10"><a href="#cb491-10" aria-hidden="true" tabindex="-1"></a>                                                 breaks_list[[<span class="dv">5</span>]], </span>
<span id="cb491-11"><a href="#cb491-11" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb491-12"><a href="#cb491-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-13"><a href="#cb491-13" aria-hidden="true" tabindex="-1"></a>model_after_time_strat_alt<span class="ot">&lt;-</span></span>
<span id="cb491-14"><a href="#cb491-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cph</span>(<span class="fu">Surv</span>(lag_time,time,event)<span class="sc">~</span></span>
<span id="cb491-15"><a href="#cb491-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb491-16"><a href="#cb491-16" aria-hidden="true" tabindex="-1"></a>          lag_tr_outcome<span class="sc">+</span></span>
<span id="cb491-17"><a href="#cb491-17" aria-hidden="true" tabindex="-1"></a>          lag_comp_bpsc_y3_severe<span class="sc">+</span></span>
<span id="cb491-18"><a href="#cb491-18" aria-hidden="true" tabindex="-1"></a>          lag_less_90d_tr1<span class="sc">+</span></span>
<span id="cb491-19"><a href="#cb491-19" aria-hidden="true" tabindex="-1"></a>          log_lag_dias_treat_imp_sin_na <span class="sc">+</span></span>
<span id="cb491-20"><a href="#cb491-20" aria-hidden="true" tabindex="-1"></a>          lag_policonsumo2 <span class="sc">+</span> </span>
<span id="cb491-21"><a href="#cb491-21" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb491-22"><a href="#cb491-22" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr <span class="sc">+</span> </span>
<span id="cb491-23"><a href="#cb491-23" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb491-24"><a href="#cb491-24" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb491-25"><a href="#cb491-25" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb491-26"><a href="#cb491-26" aria-hidden="true" tabindex="-1"></a>          susinidum_mar <span class="sc">+</span></span>
<span id="cb491-27"><a href="#cb491-27" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study <span class="sc">+</span></span>
<span id="cb491-28"><a href="#cb491-28" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with <span class="sc">+</span></span>
<span id="cb491-29"><a href="#cb491-29" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb491-30"><a href="#cb491-30" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb491-31"><a href="#cb491-31" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb491-32"><a href="#cb491-32" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb491-33"><a href="#cb491-33" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb491-34"><a href="#cb491-34" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb491-35"><a href="#cb491-35" aria-hidden="true" tabindex="-1"></a>          susprindum_mar <span class="sc">+</span></span>
<span id="cb491-36"><a href="#cb491-36" aria-hidden="true" tabindex="-1"></a>          <span class="fu">strat</span>(tipo_de_plan_2_mod)<span class="sc">+</span></span>
<span id="cb491-37"><a href="#cb491-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">strat</span>(time_interval3_alt),</span>
<span id="cb491-38"><a href="#cb491-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(), </span>
<span id="cb491-39"><a href="#cb491-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>, <span class="at">surv=</span><span class="cn">TRUE</span>, <span class="at">iter.max =</span> <span class="dv">250</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb491-40"><a href="#cb491-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb491-41"><a href="#cb491-41" aria-hidden="true" tabindex="-1"></a>model_after_time_strat_alt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies of Missing Values Due to Each Variable
  Surv(lag_time, time, event)                   cluster(id) 
                        13317                             0 
               lag_tr_outcome       lag_comp_bpsc_y3_severe 
                            0                             0 
             lag_less_90d_tr1 log_lag_dias_treat_imp_sin_na 
                            0                         13317 
             lag_policonsumo2                 edad_al_ing_1 
                            0                             0 
                 ano_nac_corr                  susinidum_oh 
                            0                             0 
                susinidum_coc                 susinidum_pbc 
                            0                             0 
                susinidum_mar              psycom_dum_study 
                            0                             0 
              psycom_dum_with            freq_cons_dum_5day 
                            0                             0 
           cond_oc_dum_2inact            cond_oc_dum_3unemp 
                            0                             0 
                susprindum_oh                susprindum_coc 
                            0                             0 
               susprindum_pbc                susprindum_mar 
                            0                             0 
           tipo_de_plan_2_mod            time_interval3_alt 
                            0                             0 

Cox Proportional Hazards Model
 
 cph(formula = Surv(lag_time, time, event) ~ cluster(id) + lag_tr_outcome + 
     lag_comp_bpsc_y3_severe + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + 
     lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
     susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_study + 
     psycom_dum_with + freq_cons_dum_5day + cond_oc_dum_2inact + 
     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
     susprindum_mar + strat(tipo_de_plan_2_mod) + strat(time_interval3_alt), 
     data = data_mine_miss_restr_proc2 %&gt;% data.table::as.data.table() %&gt;% 
         data.frame(), x = TRUE, y = TRUE, iter.max = 250 * 4, 
     tol = 1e-06, surv = TRUE)
 
 
                                                                         Status
 Stratum                                                                  No Event
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=[0,10]                 0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=[0,10]          0
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=[0,10]                   0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=[0,10]          0
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=[0,10]                   0
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(10,20]                0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(10,20]         0
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(10,20]                  0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(10,20]         0
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(10,20]                  0
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(20,30]                0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(20,30]         0
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(20,30]                  0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(20,30]         0
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(20,30]                  0
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(30,50]                0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(30,50]         0
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(30,50]                  0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(30,50]         0
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(30,50]                  0
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(50,70]                0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(50,70]         0
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(50,70]                  0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(50,70]         0
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(50,70]                  0
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(70,135]               0
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(70,135]        0
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(70,135]                 0
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(70,135]        0
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(70,135]                 0
                                                                         Status
 Stratum                                                                  Event
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=[0,10]            313
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=[0,10]     427
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=[0,10]              306
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=[0,10]      55
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=[0,10]              178
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(10,20]          1040
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(10,20]   1288
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(10,20]             673
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(10,20]    223
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(10,20]             322
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(20,30]          1073
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(20,30]   1311
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(20,30]             578
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(20,30]    216
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(20,30]             310
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(30,50]          1535
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(30,50]   1774
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(30,50]             752
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(30,50]    265
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(30,50]             370
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(50,70]           973
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(50,70]    952
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(50,70]             392
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(50,70]    147
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(50,70]             178
   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(70,135]          699
   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(70,135]   747
   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(70,135]            325
   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(70,135]   109
   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(70,135]            140
 
                       Model Tests       Discrimination    
                                                Indexes    
 Obs    17671    LR chi2    263.53       R2       0.015    
 Events 17671    d.f.           20    R2(20,17671)0.014    
 Center   105    Pr(&gt; chi2) 0.0000       Dxy      0.251    
                 Score chi2 263.20                         
                 Pr(&gt; chi2) 0.0000                         
 
                               Coef    S.E.   Wald Z Pr(&gt;|Z|)
 lag_tr_outcome                 0.0448 0.0190  2.36  0.0183  
 lag_comp_bpsc_y3_severe        0.0238 0.0170  1.40  0.1629  
 lag_less_90d_tr1               0.0374 0.0227  1.65  0.0993  
 log_lag_dias_treat_imp_sin_na -0.0289 0.0084 -3.44  0.0006  
 lag_policonsumo2              -0.0071 0.0201 -0.35  0.7234  
 edad_al_ing_1                  0.0520 0.0038 13.68  &lt;0.0001 
 ano_nac_corr                   0.0524 0.0038 13.96  &lt;0.0001 
 susinidum_oh                  -0.0306 0.0524 -0.58  0.5591  
 susinidum_coc                  0.0607 0.0617  0.98  0.3256  
 susinidum_pbc                 -0.0096 0.0573 -0.17  0.8671  
 susinidum_mar                 -0.0109 0.0529 -0.21  0.8361  
 psycom_dum_study               0.0047 0.0220  0.21  0.8311  
 psycom_dum_with               -0.0208 0.0169 -1.23  0.2190  
 freq_cons_dum_5day             0.0204 0.0161  1.26  0.2067  
 cond_oc_dum_2inact            -0.0145 0.0222 -0.65  0.5137  
 cond_oc_dum_3unemp             0.0231 0.0178  1.30  0.1938  
 susprindum_oh                  0.0811 0.0694  1.17  0.2423  
 susprindum_coc                 0.0585 0.0700  0.84  0.4034  
 susprindum_pbc                 0.0645 0.0684  0.94  0.3454  
 susprindum_mar                 0.0681 0.0745  0.91  0.3607  
 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox Proportional Hazards Model</span></span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb493-3"><a href="#cb493-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cph(formula = Surv(lag_time, time, event) ~ cluster(id) + lag_tr_outcome + </span></span>
<span id="cb493-4"><a href="#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_comp_bpsc_y3_severe + lag_less_90d_tr1 + log_lag_dias_treat_imp_sin_na + </span></span>
<span id="cb493-5"><a href="#cb493-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     lag_policonsumo2 + edad_al_ing_1 + ano_nac_corr + susinidum_oh + </span></span>
<span id="cb493-6"><a href="#cb493-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_study + </span></span>
<span id="cb493-7"><a href="#cb493-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     psycom_dum_with + freq_cons_dum_5day + cond_oc_dum_2inact + </span></span>
<span id="cb493-8"><a href="#cb493-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + </span></span>
<span id="cb493-9"><a href="#cb493-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     susprindum_mar + strat(tipo_de_plan_2_mod) + strat(time_interval3_alt), </span></span>
<span id="cb493-10"><a href="#cb493-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data_mine_miss_restr_proc2 %&gt;% data.table::as.data.table() %&gt;% </span></span>
<span id="cb493-11"><a href="#cb493-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         data.frame(), x = TRUE, y = TRUE, iter.max = 250 * 4, </span></span>
<span id="cb493-12"><a href="#cb493-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     tol = 1e-06, surv = TRUE)</span></span>
<span id="cb493-13"><a href="#cb493-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb493-14"><a href="#cb493-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb493-15"><a href="#cb493-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                                         Status</span></span>
<span id="cb493-16"><a href="#cb493-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratum                                                                  No Event Event</span></span>
<span id="cb493-17"><a href="#cb493-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=[0,10]                 0   313</span></span>
<span id="cb493-18"><a href="#cb493-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=[0,10]          0   427</span></span>
<span id="cb493-19"><a href="#cb493-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3_alt=[0,10]                   0   306</span></span>
<span id="cb493-20"><a href="#cb493-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=[0,10]          0    55</span></span>
<span id="cb493-21"><a href="#cb493-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3_alt=[0,10]                   0   178</span></span>
<span id="cb493-22"><a href="#cb493-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(10,20]                0  1040</span></span>
<span id="cb493-23"><a href="#cb493-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(10,20]         0  1288</span></span>
<span id="cb493-24"><a href="#cb493-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(10,20]                  0   673</span></span>
<span id="cb493-25"><a href="#cb493-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(10,20]         0   223</span></span>
<span id="cb493-26"><a href="#cb493-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(10,20]                  0   322</span></span>
<span id="cb493-27"><a href="#cb493-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(20,30]                0  1073</span></span>
<span id="cb493-28"><a href="#cb493-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(20,30]         0  1311</span></span>
<span id="cb493-29"><a href="#cb493-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(20,30]                  0   578</span></span>
<span id="cb493-30"><a href="#cb493-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(20,30]         0   216</span></span>
<span id="cb493-31"><a href="#cb493-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(20,30]                  0   310</span></span>
<span id="cb493-32"><a href="#cb493-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(30,50]                0  1535</span></span>
<span id="cb493-33"><a href="#cb493-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(30,50]         0  1774</span></span>
<span id="cb493-34"><a href="#cb493-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(30,50]                  0   752</span></span>
<span id="cb493-35"><a href="#cb493-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(30,50]         0   265</span></span>
<span id="cb493-36"><a href="#cb493-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(30,50]                  0   370</span></span>
<span id="cb493-37"><a href="#cb493-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(50,70]                0   973</span></span>
<span id="cb493-38"><a href="#cb493-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(50,70]         0   952</span></span>
<span id="cb493-39"><a href="#cb493-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(50,70]                  0   392</span></span>
<span id="cb493-40"><a href="#cb493-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(50,70]         0   147</span></span>
<span id="cb493-41"><a href="#cb493-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(50,70]                  0   178</span></span>
<span id="cb493-42"><a href="#cb493-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=basic ambulatory.time_interval3_alt=(70,135]               0   699</span></span>
<span id="cb493-43"><a href="#cb493-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP intensive ambulatory.time_interval3_alt=(70,135]        0   747</span></span>
<span id="cb493-44"><a href="#cb493-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=GP residential.time_interval3_alt=(70,135]                 0   325</span></span>
<span id="cb493-45"><a href="#cb493-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO intensive ambulatory.time_interval3_alt=(70,135]        0   109</span></span>
<span id="cb493-46"><a href="#cb493-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   tipo_de_plan_2_mod=WO residential.time_interval3_alt=(70,135]                 0   140</span></span>
<span id="cb493-47"><a href="#cb493-47" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb493-48"><a href="#cb493-48" aria-hidden="true" tabindex="-1"></a><span class="co">#                       Model Tests       Discrimination    </span></span>
<span id="cb493-49"><a href="#cb493-49" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                Indexes    </span></span>
<span id="cb493-50"><a href="#cb493-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Obs    17671    LR chi2    263.53       R2       0.015    </span></span>
<span id="cb493-51"><a href="#cb493-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Events 17671    d.f.           20    R2(20,17671)0.014    </span></span>
<span id="cb493-52"><a href="#cb493-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Center   105    Pr(&gt; chi2) 0.0000       Dxy      0.251    </span></span>
<span id="cb493-53"><a href="#cb493-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Score chi2 263.20                         </span></span>
<span id="cb493-54"><a href="#cb493-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Pr(&gt; chi2) 0.0000                         </span></span>
<span id="cb493-55"><a href="#cb493-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb493-56"><a href="#cb493-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                               Coef    S.E.   Wald Z Pr(&gt;|Z|)</span></span>
<span id="cb493-57"><a href="#cb493-57" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                 0.0448 0.0190  2.36  0.0183  </span></span>
<span id="cb493-58"><a href="#cb493-58" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe        0.0238 0.0170  1.40  0.1629  </span></span>
<span id="cb493-59"><a href="#cb493-59" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1               0.0374 0.0227  1.65  0.0993  </span></span>
<span id="cb493-60"><a href="#cb493-60" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na -0.0289 0.0084 -3.44  0.0006  </span></span>
<span id="cb493-61"><a href="#cb493-61" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2              -0.0071 0.0201 -0.35  0.7234  </span></span>
<span id="cb493-62"><a href="#cb493-62" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                  0.0520 0.0038 13.68  &lt;0.0001 </span></span>
<span id="cb493-63"><a href="#cb493-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                   0.0524 0.0038 13.96  &lt;0.0001 </span></span>
<span id="cb493-64"><a href="#cb493-64" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                  -0.0306 0.0524 -0.58  0.5591  </span></span>
<span id="cb493-65"><a href="#cb493-65" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                  0.0607 0.0617  0.98  0.3256  </span></span>
<span id="cb493-66"><a href="#cb493-66" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                 -0.0096 0.0573 -0.17  0.8671  </span></span>
<span id="cb493-67"><a href="#cb493-67" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                 -0.0109 0.0529 -0.21  0.8361  </span></span>
<span id="cb493-68"><a href="#cb493-68" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study               0.0047 0.0220  0.21  0.8311  </span></span>
<span id="cb493-69"><a href="#cb493-69" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with               -0.0208 0.0169 -1.23  0.2190  </span></span>
<span id="cb493-70"><a href="#cb493-70" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day             0.0204 0.0161  1.26  0.2067  </span></span>
<span id="cb493-71"><a href="#cb493-71" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact            -0.0145 0.0222 -0.65  0.5137  </span></span>
<span id="cb493-72"><a href="#cb493-72" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp             0.0231 0.0178  1.30  0.1938  </span></span>
<span id="cb493-73"><a href="#cb493-73" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                  0.0811 0.0694  1.17  0.2423  </span></span>
<span id="cb493-74"><a href="#cb493-74" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                 0.0585 0.0700  0.84  0.4034  </span></span>
<span id="cb493-75"><a href="#cb493-75" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                 0.0645 0.0684  0.94  0.3454  </span></span>
<span id="cb493-76"><a href="#cb493-76" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                 0.0681 0.0745  0.91  0.3607 </span></span>
<span id="cb493-77"><a href="#cb493-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-78"><a href="#cb493-78" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(model_after_time_strat_alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 chisq df       p
lag_tr_outcome                  6.8110  1  0.0091
lag_comp_bpsc_y3_severe         3.2478  1  0.0715
lag_less_90d_tr1               16.6116  1 4.6e-05
log_lag_dias_treat_imp_sin_na  32.2194  1 1.4e-08
lag_policonsumo2                0.6498  1  0.4202
edad_al_ing_1                   3.4324  1  0.0639
ano_nac_corr                    0.2407  1  0.6237
susinidum_oh                    3.3813  1  0.0659
susinidum_coc                   1.5745  1  0.2096
susinidum_pbc                   1.7148  1  0.1904
susinidum_mar                   0.5145  1  0.4732
psycom_dum_study                5.8375  1  0.0157
psycom_dum_with                 3.0765  1  0.0794
freq_cons_dum_5day              0.2376  1  0.6259
cond_oc_dum_2inact              0.7335  1  0.3918
cond_oc_dum_3unemp              4.4843  1  0.0342
susprindum_oh                   4.5222  1  0.0335
susprindum_coc                  0.0816  1  0.7751
susprindum_pbc                  2.2638  1  0.1324
susprindum_mar                  1.6041  1  0.2053
GLOBAL                        177.1396 20 &lt; 2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  chisq df       p</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_tr_outcome                  6.8110  1  0.0091</span></span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_comp_bpsc_y3_severe         3.2478  1  0.0715</span></span>
<span id="cb495-4"><a href="#cb495-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_less_90d_tr1               16.6116  1 4.6e-05</span></span>
<span id="cb495-5"><a href="#cb495-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log_lag_dias_treat_imp_sin_na  32.2194  1 1.4e-08</span></span>
<span id="cb495-6"><a href="#cb495-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lag_policonsumo2                0.6498  1  0.4202</span></span>
<span id="cb495-7"><a href="#cb495-7" aria-hidden="true" tabindex="-1"></a><span class="co"># edad_al_ing_1                   3.4324  1  0.0639</span></span>
<span id="cb495-8"><a href="#cb495-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_nac_corr                    0.2407  1  0.6237</span></span>
<span id="cb495-9"><a href="#cb495-9" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_oh                    3.3813  1  0.0659</span></span>
<span id="cb495-10"><a href="#cb495-10" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_coc                   1.5745  1  0.2096</span></span>
<span id="cb495-11"><a href="#cb495-11" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_pbc                   1.7148  1  0.1904</span></span>
<span id="cb495-12"><a href="#cb495-12" aria-hidden="true" tabindex="-1"></a><span class="co"># susinidum_mar                   0.5145  1  0.4732</span></span>
<span id="cb495-13"><a href="#cb495-13" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_study                5.8375  1  0.0157</span></span>
<span id="cb495-14"><a href="#cb495-14" aria-hidden="true" tabindex="-1"></a><span class="co"># psycom_dum_with                 3.0765  1  0.0794</span></span>
<span id="cb495-15"><a href="#cb495-15" aria-hidden="true" tabindex="-1"></a><span class="co"># freq_cons_dum_5day              0.2376  1  0.6259</span></span>
<span id="cb495-16"><a href="#cb495-16" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_2inact              0.7335  1  0.3918</span></span>
<span id="cb495-17"><a href="#cb495-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cond_oc_dum_3unemp              4.4843  1  0.0342</span></span>
<span id="cb495-18"><a href="#cb495-18" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_oh                   4.5222  1  0.0335</span></span>
<span id="cb495-19"><a href="#cb495-19" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_coc                  0.0816  1  0.7751</span></span>
<span id="cb495-20"><a href="#cb495-20" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_pbc                  2.2638  1  0.1324</span></span>
<span id="cb495-21"><a href="#cb495-21" aria-hidden="true" tabindex="-1"></a><span class="co"># susprindum_mar                  1.6041  1  0.2053</span></span>
<span id="cb495-22"><a href="#cb495-22" aria-hidden="true" tabindex="-1"></a><span class="co"># GLOBAL                        177.1396 20 &lt; 2e-16</span></span>
<span id="cb495-23"><a href="#cb495-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-24"><a href="#cb495-24" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3_alt, data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
           basic ambulatory GP intensive ambulatory GP residential
  [0,10]               3756                    4289           2015
  (10,20]              1787                    2228           1104
  (20,30]              1208                    1468            612
  (30,50]              1568                    1813            756
  (50,70]               975                     952            392
  (70,135]              699                     747            325
          
           WO intensive ambulatory WO residential
  [0,10]                       602            994
  (10,20]                      383            510
  (20,30]                      247            337
  (30,50]                      272            374
  (50,70]                      147            179
  (70,135]                     109            140</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co">#          basic ambulatory GP intensive ambulatory GP residential WO intensive ambulatory WO residential</span></span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [0,10]               3756                    4289           2015                     602            994</span></span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (10,20]              1787                    2228           1104                     383            510</span></span>
<span id="cb497-4"><a href="#cb497-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (20,30]              1208                    1468            612                     247            337</span></span>
<span id="cb497-5"><a href="#cb497-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (30,50]              1568                    1813            756                     272            374</span></span>
<span id="cb497-6"><a href="#cb497-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (50,70]               975                     952            392                     147            179</span></span>
<span id="cb497-7"><a href="#cb497-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (70,135]              699                     747            325                     109            140</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb498-3"><a href="#cb498-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb498-4"><a href="#cb498-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"20240503_avance_iiw.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="apply-1" class="level5">
<h5 class="anchored" data-anchor-id="apply-1">Apply</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co">#iiws_strat_id &lt;- data.frame(spec = character(), aic = numeric(), cox_zph = numeric(), success = logical())</span></span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a>iiws_strat <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb499-4"><a href="#cb499-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-5"><a href="#cb499-5" aria-hidden="true" tabindex="-1"></a>comb_strata <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod), </span>
<span id="cb499-6"><a href="#cb499-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3))</span>
<span id="cb499-7"><a href="#cb499-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-8"><a href="#cb499-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (xx <span class="cf">in</span> <span class="fu">seq_along</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comb_strata))) {</span>
<span id="cb499-9"><a href="#cb499-9" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span> comb_strata[xx,<span class="st">"Var1"</span>]</span>
<span id="cb499-10"><a href="#cb499-10" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span> comb_strata[xx,<span class="st">"Var2"</span>]</span>
<span id="cb499-11"><a href="#cb499-11" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_proc2_subset<span class="ot">&lt;-</span></span>
<span id="cb499-12"><a href="#cb499-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(data_mine_miss_restr_proc2, <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span>i <span class="sc">&amp;</span> time_interval3<span class="sc">==</span>j)</span>
<span id="cb499-13"><a href="#cb499-13" aria-hidden="true" tabindex="-1"></a>  maxfu_df_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span> maxfu.id <span class="sc">%in%</span> <span class="fu">unique</span>(data_mine_miss_proc2_subset<span class="sc">$</span>id))</span>
<span id="cb499-14"><a href="#cb499-14" aria-hidden="true" tabindex="-1"></a>  iiw_model_strat<span class="ot">&lt;-</span></span>
<span id="cb499-15"><a href="#cb499-15" aria-hidden="true" tabindex="-1"></a>    IrregLong<span class="sc">::</span><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb499-16"><a href="#cb499-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="co">#If a frailty model is used, the cluster(id) term should appear before other covariates</span></span>
<span id="cb499-17"><a href="#cb499-17" aria-hidden="true" tabindex="-1"></a>          tr_outcome.lag<span class="sc">+</span></span>
<span id="cb499-18"><a href="#cb499-18" aria-hidden="true" tabindex="-1"></a>          less_90d_tr1.lag<span class="sc">+</span></span>
<span id="cb499-19"><a href="#cb499-19" aria-hidden="true" tabindex="-1"></a>          log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb499-20"><a href="#cb499-20" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe.lag<span class="sc">+</span></span>
<span id="cb499-21"><a href="#cb499-21" aria-hidden="true" tabindex="-1"></a>          policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb499-22"><a href="#cb499-22" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb499-23"><a href="#cb499-23" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr <span class="sc">+</span> </span>
<span id="cb499-24"><a href="#cb499-24" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb499-25"><a href="#cb499-25" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb499-26"><a href="#cb499-26" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb499-27"><a href="#cb499-27" aria-hidden="true" tabindex="-1"></a>          susinidum_mar <span class="sc">+</span></span>
<span id="cb499-28"><a href="#cb499-28" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with <span class="sc">+</span></span>
<span id="cb499-29"><a href="#cb499-29" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study <span class="sc">+</span> </span>
<span id="cb499-30"><a href="#cb499-30" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb499-31"><a href="#cb499-31" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb499-32"><a href="#cb499-32" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb499-33"><a href="#cb499-33" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb499-34"><a href="#cb499-34" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb499-35"><a href="#cb499-35" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb499-36"><a href="#cb499-36" aria-hidden="true" tabindex="-1"></a>          susprindum_mar, </span>
<span id="cb499-37"><a href="#cb499-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc2_subset,</span>
<span id="cb499-38"><a href="#cb499-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb499-39"><a href="#cb499-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb499-40"><a href="#cb499-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb499-41"><a href="#cb499-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df_subset,</span>
<span id="cb499-42"><a href="#cb499-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with"</span>, <span class="st">"psycom_dum_study_rec2"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb499-43"><a href="#cb499-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>,<span class="st">"log_dias_treat_imp_sin_na"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb499-44"><a href="#cb499-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">0</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb499-45"><a href="#cb499-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T</span>
<span id="cb499-46"><a href="#cb499-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb499-47"><a href="#cb499-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb499-48"><a href="#cb499-48" aria-hidden="true" tabindex="-1"></a>  iiws_strat[[xx]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb499-49"><a href="#cb499-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> iiw_model_strat,</span>
<span id="cb499-50"><a href="#cb499-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">comb =</span> <span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j,<span class="st">"."</span>),</span>
<span id="cb499-51"><a href="#cb499-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">cox_iiw =</span> <span class="fu">summary</span>(iiw_model_strat<span class="sc">$</span>m),</span>
<span id="cb499-52"><a href="#cb499-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">iiw =</span> <span class="fu">summary</span>(iiw_model_strat<span class="sc">$</span>iiw)</span>
<span id="cb499-53"><a href="#cb499-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb499-54"><a href="#cb499-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j))</span>
<span id="cb499-55"><a href="#cb499-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat<span class="sc">$</span>m))</span>
<span id="cb499-56"><a href="#cb499-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat<span class="sc">$</span>iiw))</span>
<span id="cb499-57"><a href="#cb499-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-58"><a href="#cb499-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Modality: WO residential\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2106, number of events= 2106 
   (1417 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.19320   0.82432  0.05878   0.05420 -3.56
less_90d_tr1.lag              -0.20058   0.81825  0.06876   0.08209 -2.44
log_dias_treat_imp_sin_na.lag -0.14656   0.86367  0.01558   0.02449 -5.98
comp_bpsc_y3_severe.lag       -0.26031   0.77081  0.05617   0.06067 -4.29
policonsumo2.lag              -0.43585   0.64671  0.06064   0.06111 -7.13
edad_al_ing_1                  0.11002   1.11630  0.01083   0.00926 11.89
ano_nac_corr                   0.12040   1.12795  0.01059   0.00897 13.42
susinidum_oh                   0.21004   1.23372  0.16479   0.13855  1.52
susinidum_coc                  0.27717   1.31939  0.18873   0.15659  1.77
susinidum_pbc                  0.21194   1.23607  0.17095   0.14735  1.44
susinidum_mar                  0.26304   1.30088  0.16570   0.14167  1.86
psycom_dum_with                0.07609   1.07906  0.06264   0.05653  1.35
psycom_dum_study              -0.04540   0.95561  0.08076   0.07887 -0.58
freq_cons_dum_5day            -0.00615   0.99387  0.05188   0.04702 -0.13
cond_oc_dum_2inact             0.02411   1.02441  0.08128   0.08206  0.29
cond_oc_dum_3unemp             0.11695   1.12406  0.08213   0.08238  1.42
susprindum_oh                  0.10001   1.10518  0.15112   0.13956  0.72
susprindum_coc                -0.00818   0.99185  0.15385   0.14136 -0.06
susprindum_pbc                 0.08569   1.08947  0.14360   0.13471  0.64
susprindum_mar                -0.03637   0.96429  0.21621   0.18971 -0.19
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.00036 ***
less_90d_tr1.lag               0.01455 *  
log_dias_treat_imp_sin_na.lag  2.2e-09 ***
comp_bpsc_y3_severe.lag        1.8e-05 ***
policonsumo2.lag               9.9e-13 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                   0.12952    
susinidum_coc                  0.07673 .  
susinidum_pbc                  0.15034    
susinidum_mar                  0.06334 .  
psycom_dum_with                0.17828    
psycom_dum_study               0.56488    
freq_cons_dum_5day             0.89601    
cond_oc_dum_2inact             0.76885    
cond_oc_dum_3unemp             0.15573    
susprindum_oh                  0.47362    
susprindum_coc                 0.95386    
susprindum_pbc                 0.52469    
susprindum_mar                 0.84798    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.824      1.213     0.741     0.917
less_90d_tr1.lag                  0.818      1.222     0.697     0.961
log_dias_treat_imp_sin_na.lag     0.864      1.158     0.823     0.906
comp_bpsc_y3_severe.lag           0.771      1.297     0.684     0.868
policonsumo2.lag                  0.647      1.546     0.574     0.729
edad_al_ing_1                     1.116      0.896     1.096     1.137
ano_nac_corr                      1.128      0.887     1.108     1.148
susinidum_oh                      1.234      0.811     0.940     1.619
susinidum_coc                     1.319      0.758     0.971     1.793
susinidum_pbc                     1.236      0.809     0.926     1.650
susinidum_mar                     1.301      0.769     0.985     1.717
psycom_dum_with                   1.079      0.927     0.966     1.205
psycom_dum_study                  0.956      1.046     0.819     1.115
freq_cons_dum_5day                0.994      1.006     0.906     1.090
cond_oc_dum_2inact                1.024      0.976     0.872     1.203
cond_oc_dum_3unemp                1.124      0.890     0.956     1.321
susprindum_oh                     1.105      0.905     0.841     1.453
susprindum_coc                    0.992      1.008     0.752     1.308
susprindum_pbc                    1.089      0.918     0.837     1.419
susprindum_mar                    0.964      1.037     0.665     1.399

Concordance= 0.653  (se = 0.005 )
Likelihood ratio test= 529  on 20 df,   p=&lt;2e-16
Wald test            = 611  on 20 df,   p=&lt;2e-16
Score (logrank) test = 555  on 20 df,   p=&lt;2e-16,   Robust = 539  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.20    0.58    1.09    1.28    1.87    4.98 
[1] "Modality: GP intensive ambulatory\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 9973, number of events= 9973 
   (6233 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se      z
tr_outcome.lag                -0.41578   0.65982  0.02667   0.03341 -12.44
less_90d_tr1.lag              -0.21477   0.80673  0.03249   0.04867  -4.41
log_dias_treat_imp_sin_na.lag -0.21470   0.80678  0.00596   0.02474  -8.68
comp_bpsc_y3_severe.lag       -0.17022   0.84348  0.02524   0.02689  -6.33
policonsumo2.lag              -0.50518   0.60340  0.02670   0.03880 -13.02
edad_al_ing_1                  0.12951   1.13827  0.00497   0.00468  27.69
ano_nac_corr                   0.13571   1.14535  0.00490   0.00455  29.85
susinidum_oh                  -0.02056   0.97965  0.06953   0.06257  -0.33
susinidum_coc                  0.01638   1.01652  0.08325   0.07644   0.21
susinidum_pbc                  0.06987   1.07237  0.07878   0.07419   0.94
susinidum_mar                  0.08715   1.09106  0.07084   0.06432   1.35
psycom_dum_with                0.03784   1.03857  0.02222   0.02392   1.58
psycom_dum_study               0.04332   1.04427  0.03479   0.04956   0.87
freq_cons_dum_5day             0.07887   1.08207  0.02063   0.02328   3.39
cond_oc_dum_2inact            -0.00544   0.99458  0.03099   0.03969  -0.14
cond_oc_dum_3unemp             0.03677   1.03746  0.02222   0.02389   1.54
susprindum_oh                 -0.03507   0.96554  0.09009   0.10089  -0.35
susprindum_coc                 0.06420   1.06631  0.09125   0.10167   0.63
susprindum_pbc                 0.11017   1.11647  0.08896   0.10047   1.10
susprindum_mar                 0.00978   1.00983  0.09767   0.11394   0.09
                              Pr(&gt;|z|)    
tr_outcome.lag                 &lt; 2e-16 ***
less_90d_tr1.lag               1.0e-05 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
comp_bpsc_y3_severe.lag        2.4e-10 ***
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                    0.7424    
susinidum_coc                   0.8303    
susinidum_pbc                   0.3463    
susinidum_mar                   0.1755    
psycom_dum_with                 0.1136    
psycom_dum_study                0.3820    
freq_cons_dum_5day              0.0007 ***
cond_oc_dum_2inact              0.8910    
cond_oc_dum_3unemp              0.1238    
susprindum_oh                   0.7281    
susprindum_coc                  0.5277    
susprindum_pbc                  0.2728    
susprindum_mar                  0.9316    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.660      1.516     0.618     0.704
less_90d_tr1.lag                  0.807      1.240     0.733     0.887
log_dias_treat_imp_sin_na.lag     0.807      1.239     0.769     0.847
comp_bpsc_y3_severe.lag           0.843      1.186     0.800     0.889
policonsumo2.lag                  0.603      1.657     0.559     0.651
edad_al_ing_1                     1.138      0.879     1.128     1.149
ano_nac_corr                      1.145      0.873     1.135     1.156
susinidum_oh                      0.980      1.021     0.867     1.107
susinidum_coc                     1.017      0.984     0.875     1.181
susinidum_pbc                     1.072      0.933     0.927     1.240
susinidum_mar                     1.091      0.917     0.962     1.238
psycom_dum_with                   1.039      0.963     0.991     1.088
psycom_dum_study                  1.044      0.958     0.948     1.151
freq_cons_dum_5day                1.082      0.924     1.034     1.133
cond_oc_dum_2inact                0.995      1.005     0.920     1.075
cond_oc_dum_3unemp                1.037      0.964     0.990     1.087
susprindum_oh                     0.966      1.036     0.792     1.177
susprindum_coc                    1.066      0.938     0.874     1.301
susprindum_pbc                    1.116      0.896     0.917     1.359
susprindum_mar                    1.010      0.990     0.808     1.263

Concordance= 0.688  (se = 0.002 )
Likelihood ratio test= 3666  on 20 df,   p=&lt;2e-16
Wald test            = 3057  on 20 df,   p=&lt;2e-16
Score (logrank) test = 4025  on 20 df,   p=&lt;2e-16,   Robust = 3204  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.19    0.62    1.39    1.85    2.82    9.29 
[1] "Modality: basic ambulatory\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 8836, number of events= 8836 
   (5238 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se      z
tr_outcome.lag                -0.49853   0.60743  0.02786   0.04278 -11.65
less_90d_tr1.lag              -0.29625   0.74360  0.03653   0.05216  -5.68
log_dias_treat_imp_sin_na.lag -0.26775   0.76510  0.00666   0.03198  -8.37
comp_bpsc_y3_severe.lag        0.03051   1.03098  0.03630   0.03660   0.83
policonsumo2.lag              -0.50815   0.60161  0.02767   0.04248 -11.96
edad_al_ing_1                  0.12296   1.13084  0.00541   0.00517  23.78
ano_nac_corr                   0.13106   1.14004  0.00535   0.00523  25.04
susinidum_oh                   0.03928   1.04007  0.07640   0.06470   0.61
susinidum_coc                  0.10149   1.10682  0.09014   0.08332   1.22
susinidum_pbc                  0.16419   1.17844  0.08742   0.07761   2.12
susinidum_mar                  0.13452   1.14399  0.07752   0.06679   2.01
psycom_dum_with               -0.00807   0.99196  0.02372   0.02648  -0.30
psycom_dum_study               0.17443   1.19057  0.03412   0.04334   4.03
freq_cons_dum_5day             0.00245   1.00245  0.02458   0.02389   0.10
cond_oc_dum_2inact             0.03825   1.03899  0.03378   0.03151   1.21
cond_oc_dum_3unemp             0.06070   1.06258  0.02600   0.02462   2.47
susprindum_oh                  0.03566   1.03631  0.10103   0.07942   0.45
susprindum_coc                 0.05788   1.05959  0.10247   0.08154   0.71
susprindum_pbc                 0.13649   1.14625  0.10072   0.08066   1.69
susprindum_mar                 0.10793   1.11397  0.10699   0.08789   1.23
                              Pr(&gt;|z|)    
tr_outcome.lag                 &lt; 2e-16 ***
less_90d_tr1.lag               1.4e-08 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
comp_bpsc_y3_severe.lag          0.404    
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                     0.544    
susinidum_coc                    0.223    
susinidum_pbc                    0.034 *  
susinidum_mar                    0.044 *  
psycom_dum_with                  0.760    
psycom_dum_study               5.7e-05 ***
freq_cons_dum_5day               0.918    
cond_oc_dum_2inact               0.225    
cond_oc_dum_3unemp               0.014 *  
susprindum_oh                    0.653    
susprindum_coc                   0.478    
susprindum_pbc                   0.091 .  
susprindum_mar                   0.219    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.607      1.646     0.559     0.661
less_90d_tr1.lag                  0.744      1.345     0.671     0.824
log_dias_treat_imp_sin_na.lag     0.765      1.307     0.719     0.815
comp_bpsc_y3_severe.lag           1.031      0.970     0.960     1.108
policonsumo2.lag                  0.602      1.662     0.554     0.654
edad_al_ing_1                     1.131      0.884     1.119     1.142
ano_nac_corr                      1.140      0.877     1.128     1.152
susinidum_oh                      1.040      0.961     0.916     1.181
susinidum_coc                     1.107      0.903     0.940     1.303
susinidum_pbc                     1.178      0.849     1.012     1.372
susinidum_mar                     1.144      0.874     1.004     1.304
psycom_dum_with                   0.992      1.008     0.942     1.045
psycom_dum_study                  1.191      0.840     1.094     1.296
freq_cons_dum_5day                1.002      0.998     0.957     1.051
cond_oc_dum_2inact                1.039      0.962     0.977     1.105
cond_oc_dum_3unemp                1.063      0.941     1.013     1.115
susprindum_oh                     1.036      0.965     0.887     1.211
susprindum_coc                    1.060      0.944     0.903     1.243
susprindum_pbc                    1.146      0.872     0.979     1.343
susprindum_mar                    1.114      0.898     0.938     1.323

Concordance= 0.692  (se = 0.003 )
Likelihood ratio test= 3513  on 20 df,   p=&lt;2e-16
Wald test            = 2853  on 20 df,   p=&lt;2e-16
Score (logrank) test = 3910  on 20 df,   p=&lt;2e-16,   Robust = 3228  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.11    0.54    1.34    1.80    2.78   11.57 
[1] "Modality: GP residential\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 4436, number of events= 4436 
   (2815 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se      z
tr_outcome.lag                -0.16991   0.84374  0.03876   0.03958  -4.29
less_90d_tr1.lag              -0.19179   0.82548  0.04678   0.05353  -3.58
log_dias_treat_imp_sin_na.lag -0.08727   0.91643  0.00829   0.01870  -4.67
comp_bpsc_y3_severe.lag       -0.24899   0.77959  0.03621   0.04101  -6.07
policonsumo2.lag              -0.60356   0.54686  0.03971   0.04967 -12.15
edad_al_ing_1                  0.09289   1.09734  0.00765   0.00648  14.34
ano_nac_corr                   0.09753   1.10245  0.00760   0.00638  15.28
susinidum_oh                   0.11062   1.11697  0.10673   0.12937   0.86
susinidum_coc                  0.17321   1.18912  0.13021   0.14678   1.18
susinidum_pbc                  0.17984   1.19703  0.11357   0.13542   1.33
susinidum_mar                  0.29456   1.34254  0.10690   0.12899   2.28
psycom_dum_with               -0.04422   0.95675  0.03443   0.03172  -1.39
psycom_dum_study               0.01251   1.01259  0.05082   0.05272   0.24
freq_cons_dum_5day             0.08040   1.08372  0.03485   0.03422   2.35
cond_oc_dum_2inact             0.09636   1.10116  0.05613   0.05494   1.75
cond_oc_dum_3unemp             0.19515   1.21549  0.04615   0.04405   4.43
susprindum_oh                 -0.11367   0.89255  0.16054   0.14683  -0.77
susprindum_coc                -0.02726   0.97311  0.16143   0.14574  -0.19
susprindum_pbc                -0.04708   0.95401  0.15660   0.14174  -0.33
susprindum_mar                -0.16196   0.85048  0.18174   0.18838  -0.86
                              Pr(&gt;|z|)    
tr_outcome.lag                 1.8e-05 ***
less_90d_tr1.lag               0.00034 ***
log_dias_treat_imp_sin_na.lag  3.1e-06 ***
comp_bpsc_y3_severe.lag        1.3e-09 ***
policonsumo2.lag               &lt; 2e-16 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                   0.39250    
susinidum_coc                  0.23796    
susinidum_pbc                  0.18418    
susinidum_mar                  0.02239 *  
psycom_dum_with                0.16332    
psycom_dum_study               0.81244    
freq_cons_dum_5day             0.01878 *  
cond_oc_dum_2inact             0.07944 .  
cond_oc_dum_3unemp             9.4e-06 ***
susprindum_oh                  0.43884    
susprindum_coc                 0.85165    
susprindum_pbc                 0.73975    
susprindum_mar                 0.38994    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.844      1.185     0.781     0.912
less_90d_tr1.lag                  0.825      1.211     0.743     0.917
log_dias_treat_imp_sin_na.lag     0.916      1.091     0.883     0.951
comp_bpsc_y3_severe.lag           0.780      1.283     0.719     0.845
policonsumo2.lag                  0.547      1.829     0.496     0.603
edad_al_ing_1                     1.097      0.911     1.084     1.111
ano_nac_corr                      1.102      0.907     1.089     1.116
susinidum_oh                      1.117      0.895     0.867     1.439
susinidum_coc                     1.189      0.841     0.892     1.586
susinidum_pbc                     1.197      0.835     0.918     1.561
susinidum_mar                     1.343      0.745     1.043     1.729
psycom_dum_with                   0.957      1.045     0.899     1.018
psycom_dum_study                  1.013      0.988     0.913     1.123
freq_cons_dum_5day                1.084      0.923     1.013     1.159
cond_oc_dum_2inact                1.101      0.908     0.989     1.226
cond_oc_dum_3unemp                1.215      0.823     1.115     1.325
susprindum_oh                     0.893      1.120     0.669     1.190
susprindum_coc                    0.973      1.028     0.731     1.295
susprindum_pbc                    0.954      1.048     0.723     1.260
susprindum_mar                    0.850      1.176     0.588     1.230

Concordance= 0.648  (se = 0.004 )
Likelihood ratio test= 1017  on 20 df,   p=&lt;2e-16
Wald test            = 1099  on 20 df,   p=&lt;2e-16
Score (logrank) test = 1052  on 20 df,   p=&lt;2e-16,   Robust = 998  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.27    0.66    1.22    1.42    2.07    4.40 
[1] "Modality: WO intensive ambulatory\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1546, number of events= 1546 
   (908 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se      z
tr_outcome.lag                -0.1752    0.8393   0.0737    0.0693  -2.53
less_90d_tr1.lag              -0.3547    0.7014   0.0956    0.0974  -3.64
log_dias_treat_imp_sin_na.lag -0.4430    0.6421   0.0288    0.0285 -15.52
comp_bpsc_y3_severe.lag       -0.0625    0.9394   0.0658    0.0629  -0.99
policonsumo2.lag              -0.1927    0.8247   0.0777    0.0715  -2.69
edad_al_ing_1                  0.1324    1.1416   0.0130    0.0117  11.30
ano_nac_corr                   0.1351    1.1447   0.0127    0.0113  11.96
susinidum_oh                  -0.1597    0.8524   0.1803    0.1983  -0.81
susinidum_coc                  0.0881    1.0921   0.2123    0.2232   0.39
susinidum_pbc                 -0.0693    0.9331   0.1926    0.2043  -0.34
susinidum_mar                  0.0105    1.0105   0.1817    0.2002   0.05
psycom_dum_with               -0.0250    0.9753   0.0579    0.0539  -0.46
psycom_dum_study              -0.0806    0.9225   0.0915    0.0945  -0.85
freq_cons_dum_5day             0.0368    1.0375   0.0530    0.0513   0.72
cond_oc_dum_2inact             0.1451    1.1561   0.0667    0.0637   2.28
cond_oc_dum_3unemp             0.0518    1.0531   0.0692    0.0694   0.75
susprindum_oh                 -0.2115    0.8094   0.1931    0.1562  -1.35
susprindum_coc                -0.0335    0.9671   0.1974    0.1628  -0.21
susprindum_pbc                -0.0755    0.9273   0.1908    0.1590  -0.47
susprindum_mar                -0.2156    0.8060   0.2084    0.1865  -1.16
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.01154 *  
less_90d_tr1.lag               0.00027 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
comp_bpsc_y3_severe.lag        0.32051    
policonsumo2.lag               0.00705 ** 
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                   0.42062    
susinidum_coc                  0.69305    
susinidum_pbc                  0.73457    
susinidum_mar                  0.95833    
psycom_dum_with                0.64313    
psycom_dum_study               0.39373    
freq_cons_dum_5day             0.47326    
cond_oc_dum_2inact             0.02281 *  
cond_oc_dum_3unemp             0.45561    
susprindum_oh                  0.17571    
susprindum_coc                 0.83715    
susprindum_pbc                 0.63501    
susprindum_mar                 0.24748    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.839      1.191     0.733     0.962
less_90d_tr1.lag                  0.701      1.426     0.579     0.849
log_dias_treat_imp_sin_na.lag     0.642      1.557     0.607     0.679
comp_bpsc_y3_severe.lag           0.939      1.064     0.830     1.063
policonsumo2.lag                  0.825      1.213     0.717     0.949
edad_al_ing_1                     1.142      0.876     1.116     1.168
ano_nac_corr                      1.145      0.874     1.120     1.170
susinidum_oh                      0.852      1.173     0.578     1.257
susinidum_coc                     1.092      0.916     0.705     1.691
susinidum_pbc                     0.933      1.072     0.625     1.393
susinidum_mar                     1.011      0.990     0.682     1.496
psycom_dum_with                   0.975      1.025     0.878     1.084
psycom_dum_study                  0.923      1.084     0.766     1.110
freq_cons_dum_5day                1.037      0.964     0.938     1.147
cond_oc_dum_2inact                1.156      0.865     1.020     1.310
cond_oc_dum_3unemp                1.053      0.950     0.919     1.206
susprindum_oh                     0.809      1.236     0.596     1.099
susprindum_coc                    0.967      1.034     0.703     1.331
susprindum_pbc                    0.927      1.078     0.679     1.266
susprindum_mar                    0.806      1.241     0.559     1.162

Concordance= 0.692  (se = 0.006 )
Likelihood ratio test= 626  on 20 df,   p=&lt;2e-16
Wald test            = 626  on 20 df,   p=&lt;2e-16
Score (logrank) test = 659  on 20 df,   p=&lt;2e-16,   Robust = 544  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.21    0.54    1.46    1.93    2.89   13.67 
[1] "Modality: WO residential\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 34, number of events= 34 
   (32 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se     z
tr_outcome.lag                -1.44e+01  5.81e-07  7.40e+00  6.96e+00 -2.06
less_90d_tr1.lag                     NA        NA  0.00e+00  0.00e+00    NA
log_dias_treat_imp_sin_na.lag  4.42e+00  8.31e+01  2.12e+00  1.90e+00  2.32
comp_bpsc_y3_severe.lag              NA        NA  0.00e+00  0.00e+00    NA
policonsumo2.lag                     NA        NA  0.00e+00  0.00e+00    NA
edad_al_ing_1                  2.49e+00  1.20e+01  7.01e-01  8.29e-01  3.00
ano_nac_corr                   2.37e+00  1.07e+01  6.78e-01  8.04e-01  2.95
susinidum_oh                  -4.33e+00  1.32e-02  1.64e+00  1.38e+00 -3.14
susinidum_coc                        NA        NA  0.00e+00  0.00e+00    NA
susinidum_pbc                 -4.56e+00  1.05e-02  1.69e+00  1.54e+00 -2.96
susinidum_mar                 -4.08e+00  1.69e-02  1.53e+00  1.07e+00 -3.81
psycom_dum_with                3.15e-01  1.37e+00  6.25e-01  5.93e-01  0.53
psycom_dum_study               1.83e+00  6.23e+00  1.23e+00  1.12e+00  1.63
freq_cons_dum_5day            -2.80e-01  7.56e-01  5.60e-01  6.16e-01 -0.45
cond_oc_dum_2inact             6.22e-01  1.86e+00  1.24e+00  1.77e+00  0.35
cond_oc_dum_3unemp             1.16e+00  3.18e+00  1.15e+00  1.69e+00  0.68
susprindum_oh                 -1.67e+00  1.88e-01  1.93e+00  1.73e+00 -0.97
susprindum_coc                -5.05e-01  6.04e-01  1.46e+00  1.09e+00 -0.46
susprindum_pbc                -5.15e-01  5.98e-01  1.21e+00  7.97e-01 -0.65
susprindum_mar                       NA        NA  0.00e+00  0.00e+00    NA
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.03905 *  
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag  0.02013 *  
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                  0.00272 ** 
ano_nac_corr                   0.00313 ** 
susinidum_oh                   0.00172 ** 
susinidum_coc                       NA    
susinidum_pbc                  0.00310 ** 
susinidum_mar                  0.00014 ***
psycom_dum_with                0.59557    
psycom_dum_study               0.10206    
freq_cons_dum_5day             0.65023    
cond_oc_dum_2inact             0.72545    
cond_oc_dum_3unemp             0.49430    
susprindum_oh                  0.33431    
susprindum_coc                 0.64295    
susprindum_pbc                 0.51798    
susprindum_mar                      NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                 5.81e-07   1.72e+06  6.94e-13     0.486
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag  8.31e+01   1.20e-02  2.00e+00  3452.547
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                  1.20e+01   8.33e-02  2.36e+00    60.966
ano_nac_corr                   1.07e+01   9.31e-02  2.22e+00    51.931
susinidum_oh                   1.32e-02   7.59e+01  8.79e-04     0.197
susinidum_coc                        NA         NA        NA        NA
susinidum_pbc                  1.05e-02   9.52e+01  5.13e-04     0.215
susinidum_mar                  1.69e-02   5.92e+01  2.07e-03     0.138
psycom_dum_with                1.37e+00   7.30e-01  4.28e-01     4.384
psycom_dum_study               6.23e+00   1.61e-01  6.95e-01    55.791
freq_cons_dum_5day             7.56e-01   1.32e+00  2.26e-01     2.531
cond_oc_dum_2inact             1.86e+00   5.37e-01  5.78e-02    60.021
cond_oc_dum_3unemp             3.18e+00   3.15e-01  1.15e-01    87.653
susprindum_oh                  1.88e-01   5.31e+00  6.37e-03     5.578
susprindum_coc                 6.04e-01   1.66e+00  7.14e-02     5.101
susprindum_pbc                 5.98e-01   1.67e+00  1.25e-01     2.847
susprindum_mar                       NA         NA        NA        NA

Concordance= 0.777  (se = 0.035 )
Likelihood ratio test= 29.1  on 15 df,   p=0.02
Wald test            = 93.5  on 15 df,   p=2e-13
Score (logrank) test = 36.1  on 15 df,   p=0.002,   Robust = 28.5  p=0.02

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      3      28      94     179     288     729 
[1] "Modality: GP intensive ambulatory\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 213, number of events= 213 
   (202 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 -0.0698    0.9325   0.7845    0.3906 -0.18
less_90d_tr1.lag                4.6058  100.0624   1.5181    0.7605  6.06
log_dias_treat_imp_sin_na.lag  -0.1856    0.8306   0.2664    0.1478 -1.26
comp_bpsc_y3_severe.lag         0.3339    1.3965   0.6787    0.3763  0.89
policonsumo2.lag               -0.4480    0.6389   0.7853    0.4145 -1.08
edad_al_ing_1                   0.7114    2.0369   0.1093    0.1073  6.63
ano_nac_corr                    0.7070    2.0279   0.1107    0.1092  6.47
susinidum_oh                   -0.0482    0.9530   0.3646    0.3959 -0.12
susinidum_coc                   0.0251    1.0254   0.5269    0.4897  0.05
susinidum_pbc                   0.0582    1.0599   0.5221    0.6476  0.09
susinidum_mar                  -0.0926    0.9116   0.3800    0.4148 -0.22
psycom_dum_with                -0.1165    0.8901   0.1637    0.1548 -0.75
psycom_dum_study               -0.1574    0.8544   0.2574    0.2633 -0.60
freq_cons_dum_5day              0.2429    1.2749   0.1658    0.1569  1.55
cond_oc_dum_2inact             -0.0213    0.9789   0.2682    0.2480 -0.09
cond_oc_dum_3unemp             -0.0428    0.9581   0.1665    0.1641 -0.26
susprindum_oh                  -0.8775    0.4158   0.6748    0.5933 -1.48
susprindum_coc                 -0.9359    0.3922   0.6822    0.6089 -1.54
susprindum_pbc                 -0.5899    0.5544   0.6602    0.5883 -1.00
susprindum_mar                 -0.7845    0.4564   0.7115    0.6598 -1.19
                              Pr(&gt;|z|)    
tr_outcome.lag                    0.86    
less_90d_tr1.lag               1.4e-09 ***
log_dias_treat_imp_sin_na.lag     0.21    
comp_bpsc_y3_severe.lag           0.37    
policonsumo2.lag                  0.28    
edad_al_ing_1                  3.3e-11 ***
ano_nac_corr                   9.6e-11 ***
susinidum_oh                      0.90    
susinidum_coc                     0.96    
susinidum_pbc                     0.93    
susinidum_mar                     0.82    
psycom_dum_with                   0.45    
psycom_dum_study                  0.55    
freq_cons_dum_5day                0.12    
cond_oc_dum_2inact                0.93    
cond_oc_dum_3unemp                0.79    
susprindum_oh                     0.14    
susprindum_coc                    0.12    
susprindum_pbc                    0.32    
susprindum_mar                    0.23    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.933    1.07234     0.434      2.01
less_90d_tr1.lag                100.062    0.00999    22.539    444.24
log_dias_treat_imp_sin_na.lag     0.831    1.20397     0.622      1.11
comp_bpsc_y3_severe.lag           1.396    0.71610     0.668      2.92
policonsumo2.lag                  0.639    1.56513     0.284      1.44
edad_al_ing_1                     2.037    0.49094     1.651      2.51
ano_nac_corr                      2.028    0.49313     1.637      2.51
susinidum_oh                      0.953    1.04934     0.439      2.07
susinidum_coc                     1.025    0.97525     0.393      2.68
susinidum_pbc                     1.060    0.94347     0.298      3.77
susinidum_mar                     0.912    1.09702     0.404      2.06
psycom_dum_with                   0.890    1.12353     0.657      1.21
psycom_dum_study                  0.854    1.17043     0.510      1.43
freq_cons_dum_5day                1.275    0.78436     0.937      1.73
cond_oc_dum_2inact                0.979    1.02157     0.602      1.59
cond_oc_dum_3unemp                0.958    1.04374     0.695      1.32
susprindum_oh                     0.416    2.40490     0.130      1.33
susprindum_coc                    0.392    2.54955     0.119      1.29
susprindum_pbc                    0.554    1.80387     0.175      1.76
susprindum_mar                    0.456    2.19123     0.125      1.66

Concordance= 0.65  (se = 0.021 )
Likelihood ratio test= 67.7  on 20 df,   p=4e-07
Wald test            = 141  on 20 df,   p=&lt;2e-16
Score (logrank) test = 79.4  on 20 df,   p=5e-09,   Robust = 61.6  p=4e-06

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.07    1.45    2.09    2.66    3.06   15.52 
[1] "Modality: basic ambulatory\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 200, number of events= 200 
   (189 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.06539   1.06758  0.89003   0.52807  0.12
less_90d_tr1.lag                    NA        NA  0.00000   0.00000    NA
log_dias_treat_imp_sin_na.lag -0.80835   0.44559  0.69768   0.41145 -1.96
comp_bpsc_y3_severe.lag        0.68033   1.97453  0.84695   0.44081  1.54
policonsumo2.lag               2.09839   8.15300  1.98344   1.21808  1.72
edad_al_ing_1                  0.76099   2.14038  0.11599   0.12604  6.04
ano_nac_corr                   0.74979   2.11655  0.11568   0.12543  5.98
susinidum_oh                   0.52839   1.69620  0.52634   0.39173  1.35
susinidum_coc                  0.17927   1.19634  0.58825   0.42912  0.42
susinidum_pbc                  0.63893   1.89445  0.57098   0.43414  1.47
susinidum_mar                  0.72591   2.06661  0.53943   0.40960  1.77
psycom_dum_with                0.03583   1.03648  0.17578   0.16452  0.22
psycom_dum_study               0.03533   1.03596  0.21114   0.20776  0.17
freq_cons_dum_5day             0.26250   1.30018  0.16544   0.16890  1.55
cond_oc_dum_2inact             0.27583   1.31763  0.23875   0.28028  0.98
cond_oc_dum_3unemp             0.00744   1.00747  0.18384   0.16345  0.05
susprindum_oh                 -0.71035   0.49147  0.51982   0.46058 -1.54
susprindum_coc                -0.74138   0.47646  0.52322   0.46904 -1.58
susprindum_pbc                -0.64819   0.52299  0.50722   0.44972 -1.44
susprindum_mar                -0.20680   0.81319  0.55075   0.53491 -0.39
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.901    
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag    0.049 *  
comp_bpsc_y3_severe.lag          0.123    
policonsumo2.lag                 0.085 .  
edad_al_ing_1                  1.6e-09 ***
ano_nac_corr                   2.3e-09 ***
susinidum_oh                     0.177    
susinidum_coc                    0.676    
susinidum_pbc                    0.141    
susinidum_mar                    0.076 .  
psycom_dum_with                  0.828    
psycom_dum_study                 0.865    
freq_cons_dum_5day               0.120    
cond_oc_dum_2inact               0.325    
cond_oc_dum_3unemp               0.964    
susprindum_oh                    0.123    
susprindum_coc                   0.114    
susprindum_pbc                   0.149    
susprindum_mar                   0.699    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.068      0.937     0.379     3.005
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag     0.446      2.244     0.199     0.998
comp_bpsc_y3_severe.lag           1.975      0.506     0.832     4.685
policonsumo2.lag                  8.153      0.123     0.749    88.746
edad_al_ing_1                     2.140      0.467     1.672     2.740
ano_nac_corr                      2.117      0.472     1.655     2.706
susinidum_oh                      1.696      0.590     0.787     3.655
susinidum_coc                     1.196      0.836     0.516     2.774
susinidum_pbc                     1.894      0.528     0.809     4.436
susinidum_mar                     2.067      0.484     0.926     4.612
psycom_dum_with                   1.036      0.965     0.751     1.431
psycom_dum_study                  1.036      0.965     0.689     1.557
freq_cons_dum_5day                1.300      0.769     0.934     1.810
cond_oc_dum_2inact                1.318      0.759     0.761     2.282
cond_oc_dum_3unemp                1.007      0.993     0.731     1.388
susprindum_oh                     0.491      2.035     0.199     1.212
susprindum_coc                    0.476      2.099     0.190     1.195
susprindum_pbc                    0.523      1.912     0.217     1.263
susprindum_mar                    0.813      1.230     0.285     2.320

Concordance= 0.664  (se = 0.022 )
Likelihood ratio test= 66.7  on 19 df,   p=3e-07
Wald test            = 96.4  on 19 df,   p=2e-12
Score (logrank) test = 65.2  on 19 df,   p=6e-07,   Robust = 66.6  p=3e-07

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.16    0.47    0.76    1.07    1.31    7.33 
[1] "Modality: GP residential\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 87, number of events= 87 
   (80 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.06200   1.06396  1.61401   1.02888  0.06
less_90d_tr1.lag               1.11330   3.04439  1.21710   0.96928  1.15
log_dias_treat_imp_sin_na.lag  2.21808   9.18970  1.19508   1.12830  1.97
comp_bpsc_y3_severe.lag       -2.81004   0.06020  2.41466   2.01758 -1.39
policonsumo2.lag              -5.68931   0.00338  2.59786   2.19430 -2.59
edad_al_ing_1                  1.01020   2.74615  0.21856   0.19540  5.17
ano_nac_corr                   0.99800   2.71284  0.21846   0.19453  5.13
susinidum_oh                  -1.06298   0.34542  1.05591   0.33960 -3.13
susinidum_coc                 -1.10348   0.33172  1.21863   0.52419 -2.11
susinidum_pbc                 -0.97188   0.37837  1.08524   0.48477 -2.00
susinidum_mar                 -1.19098   0.30392  1.06093   0.32881 -3.62
psycom_dum_with                0.10268   1.10814  0.30116   0.27290  0.38
psycom_dum_study               0.39160   1.47935  0.41112   0.32489  1.21
freq_cons_dum_5day            -0.76394   0.46583  0.29504   0.25756 -2.97
cond_oc_dum_2inact            -0.33948   0.71214  0.50269   0.56349 -0.60
cond_oc_dum_3unemp            -0.73718   0.47846  0.41746   0.52470 -1.40
susprindum_oh                 -3.54379   0.02890  1.29324   0.70176 -5.05
susprindum_coc                -2.46160   0.08530  1.29604   0.79542 -3.09
susprindum_pbc                -2.26402   0.10393  1.27244   0.75037 -3.02
susprindum_mar                -1.64439   0.19313  1.51917   0.81467 -2.02
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.95195    
less_90d_tr1.lag               0.25073    
log_dias_treat_imp_sin_na.lag  0.04931 *  
comp_bpsc_y3_severe.lag        0.16369    
policonsumo2.lag               0.00952 ** 
edad_al_ing_1                  2.3e-07 ***
ano_nac_corr                   2.9e-07 ***
susinidum_oh                   0.00175 ** 
susinidum_coc                  0.03528 *  
susinidum_pbc                  0.04498 *  
susinidum_mar                  0.00029 ***
psycom_dum_with                0.70672    
psycom_dum_study               0.22807    
freq_cons_dum_5day             0.00302 ** 
cond_oc_dum_2inact             0.54687    
cond_oc_dum_3unemp             0.16003    
susprindum_oh                  4.4e-07 ***
susprindum_coc                 0.00197 ** 
susprindum_pbc                 0.00255 ** 
susprindum_mar                 0.04354 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                  1.06396      0.940  1.42e-01     7.993
less_90d_tr1.lag                3.04439      0.328  4.55e-01    20.350
log_dias_treat_imp_sin_na.lag   9.18970      0.109  1.01e+00    83.890
comp_bpsc_y3_severe.lag         0.06020     16.611  1.15e-03     3.140
policonsumo2.lag                0.00338    295.691  4.59e-05     0.249
edad_al_ing_1                   2.74615      0.364  1.87e+00     4.028
ano_nac_corr                    2.71284      0.369  1.85e+00     3.972
susinidum_oh                    0.34542      2.895  1.78e-01     0.672
susinidum_coc                   0.33172      3.015  1.19e-01     0.927
susinidum_pbc                   0.37837      2.643  1.46e-01     0.978
susinidum_mar                   0.30392      3.290  1.60e-01     0.579
psycom_dum_with                 1.10814      0.902  6.49e-01     1.892
psycom_dum_study                1.47935      0.676  7.83e-01     2.796
freq_cons_dum_5day              0.46583      2.147  2.81e-01     0.772
cond_oc_dum_2inact              0.71214      1.404  2.36e-01     2.149
cond_oc_dum_3unemp              0.47846      2.090  1.71e-01     1.338
susprindum_oh                   0.02890     34.598  7.30e-03     0.114
susprindum_coc                  0.08530     11.724  1.79e-02     0.406
susprindum_pbc                  0.10393      9.622  2.39e-02     0.452
susprindum_mar                  0.19313      5.178  3.91e-02     0.953

Concordance= 0.729  (se = 0.029 )
Likelihood ratio test= 53.7  on 20 df,   p=6e-05
Wald test            = 118  on 20 df,   p=8e-16
Score (logrank) test = 49  on 20 df,   p=3e-04,   Robust = 43.5  p=0.002

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     17      68     123     305     261    3240 
[1] "Modality: WO intensive ambulatory\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 41, number of events= 41 
   (36 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 1.1304    3.0969   1.5680    0.9116  1.24
less_90d_tr1.lag                   NA        NA   0.0000    0.0000    NA
log_dias_treat_imp_sin_na.lag  0.1992    1.2204   0.2918    0.2185  0.91
comp_bpsc_y3_severe.lag       -3.0324    0.0482   1.7463    1.0916 -2.78
policonsumo2.lag              -3.5939    0.0275   2.0412    1.5108 -2.38
edad_al_ing_1                  0.4265    1.5319   0.3017    0.3236  1.32
ano_nac_corr                   0.3897    1.4765   0.2918    0.3157  1.23
susinidum_oh                  -1.2588    0.2840   0.6121    0.7170 -1.76
susinidum_coc                 -3.3142    0.0364   1.3930    1.0273 -3.23
susinidum_pbc                 -1.3977    0.2472   0.7332    0.8635 -1.62
susinidum_mar                      NA        NA   0.0000    0.0000    NA
psycom_dum_with                0.4333    1.5423   0.5645    0.5095  0.85
psycom_dum_study              -0.3400    0.7118   0.6199    0.6590 -0.52
freq_cons_dum_5day             1.9088    6.7448   0.6268    0.6090  3.13
cond_oc_dum_2inact            -1.7361    0.1762   0.9768    1.0968 -1.58
cond_oc_dum_3unemp            -1.7825    0.1682   1.0476    1.0569 -1.69
susprindum_oh                 -1.8979    0.1499   1.5268    1.5030 -1.26
susprindum_coc                -0.6726    0.5104   1.2308    0.7463 -0.90
susprindum_pbc                -0.6693    0.5121   1.1493    0.7270 -0.92
susprindum_mar                -1.7836    0.1680   1.4825    1.1096 -1.61
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.2149   
less_90d_tr1.lag                    NA   
log_dias_treat_imp_sin_na.lag   0.3620   
comp_bpsc_y3_severe.lag         0.0055 **
policonsumo2.lag                0.0174 * 
edad_al_ing_1                   0.1875   
ano_nac_corr                    0.2171   
susinidum_oh                    0.0791 . 
susinidum_coc                   0.0013 **
susinidum_pbc                   0.1055   
susinidum_mar                       NA   
psycom_dum_with                 0.3951   
psycom_dum_study                0.6059   
freq_cons_dum_5day              0.0017 **
cond_oc_dum_2inact              0.1135   
cond_oc_dum_3unemp              0.0917 . 
susprindum_oh                   0.2067   
susprindum_coc                  0.3675   
susprindum_pbc                  0.3572   
susprindum_mar                  0.1079   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                   3.0969      0.323   0.51881    18.486
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag    1.2204      0.819   0.79528     1.873
comp_bpsc_y3_severe.lag          0.0482     20.748   0.00567     0.409
policonsumo2.lag                 0.0275     36.376   0.00142     0.531
edad_al_ing_1                    1.5319      0.653   0.81240     2.888
ano_nac_corr                     1.4765      0.677   0.79523     2.741
susinidum_oh                     0.2840      3.521   0.06966     1.158
susinidum_coc                    0.0364     27.502   0.00485     0.272
susinidum_pbc                    0.2472      4.046   0.04550     1.343
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                  1.5423      0.648   0.56817     4.187
psycom_dum_study                 0.7118      1.405   0.19560     2.590
freq_cons_dum_5day               6.7448      0.148   2.04461    22.250
cond_oc_dum_2inact               0.1762      5.675   0.02053     1.512
cond_oc_dum_3unemp               0.1682      5.945   0.02119     1.335
susprindum_oh                    0.1499      6.672   0.00788     2.852
susprindum_coc                   0.5104      1.959   0.11820     2.204
susprindum_pbc                   0.5121      1.953   0.12317     2.129
susprindum_mar                   0.1680      5.951   0.01910     1.479

Concordance= 0.714  (se = 0.049 )
Likelihood ratio test= 23.5  on 18 df,   p=0.2
Wald test            = 191  on 18 df,   p=&lt;2e-16
Score (logrank) test = 26.4  on 18 df,   p=0.09,   Robust = 19.6  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1       7      15      34      32     354 
[1] "Modality: WO residential\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 13, number of events= 13 
   (13 observations deleted due to missingness)

                                    coef  exp(coef)   se(coef)  robust se     z
tr_outcome.lag                        NA         NA   0.00e+00   0.00e+00    NA
less_90d_tr1.lag                      NA         NA   0.00e+00   0.00e+00    NA
log_dias_treat_imp_sin_na.lag         NA         NA   0.00e+00   0.00e+00    NA
comp_bpsc_y3_severe.lag               NA         NA   0.00e+00   0.00e+00    NA
policonsumo2.lag                      NA         NA   0.00e+00   0.00e+00    NA
edad_al_ing_1                  -5.69e+01   2.01e-25   5.83e+02   2.31e+00 -24.7
ano_nac_corr                   -3.70e+01   8.29e-17   2.42e+04   1.94e+00 -19.1
susinidum_oh                    2.40e+02  1.77e+104   3.87e+05   7.01e+00  34.2
susinidum_coc                         NA         NA   0.00e+00   0.00e+00    NA
susinidum_pbc                   1.68e+02   9.89e+72   1.69e+05   5.26e+00  31.9
susinidum_mar                         NA         NA   0.00e+00   0.00e+00    NA
psycom_dum_with                -2.17e+01   3.76e-10   7.26e+04   1.38e+00 -15.7
psycom_dum_study               -1.21e+02   1.81e-53   4.11e+05   5.48e+00 -22.2
freq_cons_dum_5day             -6.09e+01   3.71e-27   2.42e+04   2.26e+00 -26.9
cond_oc_dum_2inact                    NA         NA   0.00e+00   0.00e+00    NA
cond_oc_dum_3unemp                    NA         NA   0.00e+00   0.00e+00    NA
susprindum_oh                   9.63e+01   6.38e+41   1.21e+05   5.27e+00  18.2
susprindum_coc                  1.21e+02   2.66e+52   7.26e+04   3.47e+00  34.8
susprindum_pbc                  1.14e+02   3.44e+49   2.43e+04   4.27e+00  26.7
susprindum_mar                        NA         NA   0.00e+00   0.00e+00    NA
                              Pr(&gt;|z|)    
tr_outcome.lag                      NA    
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag       NA    
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                   &lt;2e-16 ***
ano_nac_corr                    &lt;2e-16 ***
susinidum_oh                    &lt;2e-16 ***
susinidum_coc                       NA    
susinidum_pbc                   &lt;2e-16 ***
susinidum_mar                       NA    
psycom_dum_with                 &lt;2e-16 ***
psycom_dum_study                &lt;2e-16 ***
freq_cons_dum_5day              &lt;2e-16 ***
cond_oc_dum_2inact                  NA    
cond_oc_dum_3unemp                  NA    
susprindum_oh                   &lt;2e-16 ***
susprindum_coc                  &lt;2e-16 ***
susprindum_pbc                  &lt;2e-16 ***
susprindum_mar                      NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                  2.01e-25   4.98e+24  2.19e-27  1.84e-23
ano_nac_corr                   8.29e-17   1.21e+16  1.84e-18  3.73e-15
susinidum_oh                  1.77e+104  5.64e-105  1.92e+98 1.64e+110
susinidum_coc                        NA         NA        NA        NA
susinidum_pbc                  9.89e+72   1.01e-73  3.30e+68  2.97e+77
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                3.76e-10   2.66e+09  2.52e-11  5.61e-09
psycom_dum_study               1.81e-53   5.53e+52  3.91e-58  8.35e-49
freq_cons_dum_5day             3.71e-27   2.70e+26  4.43e-29  3.11e-25
cond_oc_dum_2inact                   NA         NA        NA        NA
cond_oc_dum_3unemp                   NA         NA        NA        NA
susprindum_oh                  6.38e+41   1.57e-42  2.07e+37  1.97e+46
susprindum_coc                 2.66e+52   3.76e-53  2.98e+49  2.37e+55
susprindum_pbc                 3.44e+49   2.90e-50  7.99e+45  1.48e+53
susprindum_mar                       NA         NA        NA        NA

Concordance= 1  (se = 0 )
Likelihood ratio test= 45.1  on 10 df,   p=2e-06
Wald test            = 1819  on 10 df,   p=&lt;2e-16
Score (logrank) test = 16.9  on 10 df,   p=0.08,   Robust = 12.6  p=0.2

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.00e+00 0.00e+00 0.00e+00 2.29e+68 0.00e+00 2.98e+69 
[1] "Modality: GP intensive ambulatory\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 74, number of events= 74 
   (74 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                     NA        NA   0.0000    0.0000    NA
less_90d_tr1.lag                   NA        NA   0.0000    0.0000    NA
log_dias_treat_imp_sin_na.lag      NA        NA   0.0000    0.0000    NA
comp_bpsc_y3_severe.lag            NA        NA   0.0000    0.0000    NA
policonsumo2.lag                   NA        NA   0.0000    0.0000    NA
edad_al_ing_1                  0.0225    1.0228   0.1475    0.1616  0.14
ano_nac_corr                   0.0460    1.0471   0.1395    0.1496  0.31
susinidum_oh                  -0.2291    0.7953   0.2985    0.2714 -0.84
susinidum_coc                  0.8542    2.3495   0.5729    0.5836  1.46
susinidum_pbc                 -0.6890    0.5021   0.5586    0.6669 -1.03
susinidum_mar                      NA        NA   0.0000    0.0000    NA
psycom_dum_with                0.3664    1.4425   0.3078    0.2991  1.22
psycom_dum_study               1.1222    3.0717   0.4851    0.4892  2.29
freq_cons_dum_5day             0.2846    1.3292   0.3179    0.2895  0.98
cond_oc_dum_2inact             0.1720    1.1877   0.4223    0.3660  0.47
cond_oc_dum_3unemp             0.4730    1.6048   0.3933    0.3670  1.29
susprindum_oh                 -0.0812    0.9220   0.6170    0.4583 -0.18
susprindum_coc                -0.0655    0.9366   0.6616    0.5184 -0.13
susprindum_pbc                -0.6944    0.4994   0.5289    0.3637 -1.91
susprindum_mar                     NA        NA   0.0000    0.0000    NA
                              Pr(&gt;|z|)  
tr_outcome.lag                      NA  
less_90d_tr1.lag                    NA  
log_dias_treat_imp_sin_na.lag       NA  
comp_bpsc_y3_severe.lag             NA  
policonsumo2.lag                    NA  
edad_al_ing_1                    0.889  
ano_nac_corr                     0.758  
susinidum_oh                     0.399  
susinidum_coc                    0.143  
susinidum_pbc                    0.302  
susinidum_mar                       NA  
psycom_dum_with                  0.221  
psycom_dum_study                 0.022 *
freq_cons_dum_5day               0.326  
cond_oc_dum_2inact               0.638  
cond_oc_dum_3unemp               0.197  
susprindum_oh                    0.859  
susprindum_coc                   0.900  
susprindum_pbc                   0.056 .
susprindum_mar                      NA  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                     1.023      0.978     0.745      1.40
ano_nac_corr                      1.047      0.955     0.781      1.40
susinidum_oh                      0.795      1.257     0.467      1.35
susinidum_coc                     2.350      0.426     0.749      7.37
susinidum_pbc                     0.502      1.992     0.136      1.86
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                   1.443      0.693     0.803      2.59
psycom_dum_study                  3.072      0.326     1.177      8.01
freq_cons_dum_5day                1.329      0.752     0.754      2.34
cond_oc_dum_2inact                1.188      0.842     0.580      2.43
cond_oc_dum_3unemp                1.605      0.623     0.782      3.29
susprindum_oh                     0.922      1.085     0.375      2.26
susprindum_coc                    0.937      1.068     0.339      2.59
susprindum_pbc                    0.499      2.002     0.245      1.02
susprindum_mar                       NA         NA        NA        NA

Concordance= 0.634  (se = 0.034 )
Likelihood ratio test= 13.9  on 13 df,   p=0.4
Wald test            = 23.4  on 13 df,   p=0.04
Score (logrank) test = 14.5  on 13 df,   p=0.3,   Robust = 16.6  p=0.2

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.198   0.615   0.804   0.936   1.277   2.215 
[1] "Modality: basic ambulatory\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 77, number of events= 77 
   (76 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome.lag                       NA        NA  0.00e+00  0.00e+00     NA
less_90d_tr1.lag                     NA        NA  0.00e+00  0.00e+00     NA
log_dias_treat_imp_sin_na.lag -4.77e-01  6.21e-01  4.43e-01  2.14e-01  -2.23
comp_bpsc_y3_severe.lag              NA        NA  0.00e+00  0.00e+00     NA
policonsumo2.lag                     NA        NA  0.00e+00  0.00e+00     NA
edad_al_ing_1                 -8.12e-02  9.22e-01  1.57e-01  1.39e-01  -0.58
ano_nac_corr                  -1.72e-01  8.42e-01  1.59e-01  1.40e-01  -1.23
susinidum_oh                  -6.05e-01  5.46e-01  6.92e-01  4.73e-01  -1.28
susinidum_coc                 -8.26e-02  9.21e-01  1.05e+00  6.08e-01  -0.14
susinidum_pbc                 -1.81e+00  1.64e-01  8.99e-01  6.97e-01  -2.59
susinidum_mar                 -8.53e-01  4.26e-01  7.36e-01  5.27e-01  -1.62
psycom_dum_with               -3.47e-01  7.07e-01  3.23e-01  2.73e-01  -1.27
psycom_dum_study              -6.93e-01  5.00e-01  3.65e-01  3.41e-01  -2.03
freq_cons_dum_5day            -2.08e-01  8.12e-01  3.02e-01  2.87e-01  -0.73
cond_oc_dum_2inact             7.39e-01  2.09e+00  4.50e-01  4.40e-01   1.68
cond_oc_dum_3unemp             4.68e-01  1.60e+00  3.39e-01  3.44e-01   1.36
susprindum_oh                 -2.10e+01  7.35e-10  3.08e+03  6.52e-01 -32.26
susprindum_coc                -2.08e+01  9.01e-10  3.08e+03  5.09e-01 -40.94
susprindum_pbc                -1.95e+01  3.43e-09  3.08e+03  5.67e-01 -34.39
susprindum_mar                -2.06e+01  1.17e-09  3.08e+03  6.89e-01 -29.86
                              Pr(&gt;|z|)    
tr_outcome.lag                      NA    
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag   0.0258 *  
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                   0.5597    
ano_nac_corr                    0.2186    
susinidum_oh                    0.2008    
susinidum_coc                   0.8919    
susinidum_pbc                   0.0095 ** 
susinidum_mar                   0.1056    
psycom_dum_with                 0.2028    
psycom_dum_study                0.0423 *  
freq_cons_dum_5day              0.4680    
cond_oc_dum_2inact              0.0926 .  
cond_oc_dum_3unemp              0.1732    
susprindum_oh                   &lt;2e-16 ***
susprindum_coc                  &lt;2e-16 ***
susprindum_pbc                  &lt;2e-16 ***
susprindum_mar                  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag  6.21e-01   1.61e+00  4.08e-01  9.44e-01
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                  9.22e-01   1.08e+00  7.02e-01  1.21e+00
ano_nac_corr                   8.42e-01   1.19e+00  6.41e-01  1.11e+00
susinidum_oh                   5.46e-01   1.83e+00  2.16e-01  1.38e+00
susinidum_coc                  9.21e-01   1.09e+00  2.80e-01  3.03e+00
susinidum_pbc                  1.64e-01   6.11e+00  4.17e-02  6.43e-01
susinidum_mar                  4.26e-01   2.35e+00  1.52e-01  1.20e+00
psycom_dum_with                7.07e-01   1.41e+00  4.14e-01  1.21e+00
psycom_dum_study               5.00e-01   2.00e+00  2.56e-01  9.76e-01
freq_cons_dum_5day             8.12e-01   1.23e+00  4.63e-01  1.42e+00
cond_oc_dum_2inact             2.09e+00   4.77e-01  8.85e-01  4.96e+00
cond_oc_dum_3unemp             1.60e+00   6.26e-01  8.14e-01  3.13e+00
susprindum_oh                  7.35e-10   1.36e+09  2.05e-10  2.64e-09
susprindum_coc                 9.01e-10   1.11e+09  3.33e-10  2.44e-09
susprindum_pbc                 3.43e-09   2.91e+08  1.13e-09  1.04e-08
susprindum_mar                 1.17e-09   8.58e+08  3.02e-10  4.50e-09

Concordance= 0.731  (se = 0.03 )
Likelihood ratio test= 44.5  on 16 df,   p=2e-04
Wald test            = 16181  on 16 df,   p=&lt;2e-16
Score (logrank) test = 111  on 16 df,   p=2e-16,   Robust = 37.4  p=0.002

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
1.00e+00 7.19e+08 1.20e+09 1.84e+09 2.58e+09 7.16e+09 
[1] "Modality: GP residential\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 44, number of events= 44 
   (44 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                     NA        NA   0.0000    0.0000    NA
less_90d_tr1.lag                   NA        NA   0.0000    0.0000    NA
log_dias_treat_imp_sin_na.lag      NA        NA   0.0000    0.0000    NA
comp_bpsc_y3_severe.lag            NA        NA   0.0000    0.0000    NA
policonsumo2.lag                   NA        NA   0.0000    0.0000    NA
edad_al_ing_1                 -0.0941    0.9102   0.2559    0.2579 -0.36
ano_nac_corr                  -0.1054    0.9000   0.2603    0.2672 -0.39
susinidum_oh                  -1.3805    0.2515   1.1947    0.7912 -1.74
susinidum_coc                 -2.3484    0.0955   1.7688    1.0683 -2.20
susinidum_pbc                 -1.7372    0.1760   1.2633    0.9136 -1.90
susinidum_mar                 -1.7400    0.1755   1.2540    0.9334 -1.86
psycom_dum_with               -0.5855    0.5568   0.4569    0.4924 -1.19
psycom_dum_study              -0.5570    0.5729   0.7513    0.6086 -0.92
freq_cons_dum_5day             0.2100    1.2337   0.4609    0.4900  0.43
cond_oc_dum_2inact             1.6085    4.9952   0.8868    0.6243  2.58
cond_oc_dum_3unemp             0.6958    2.0053   0.6945    0.7280  0.96
susprindum_oh                 -3.2052    0.0406   1.4883    1.2502 -2.56
susprindum_coc                -2.1759    0.1135   1.4852    1.1353 -1.92
susprindum_pbc                -2.7616    0.0632   1.2925    0.9600 -2.88
susprindum_mar                     NA        NA   0.0000    0.0000    NA
                              Pr(&gt;|z|)   
tr_outcome.lag                      NA   
less_90d_tr1.lag                    NA   
log_dias_treat_imp_sin_na.lag       NA   
comp_bpsc_y3_severe.lag             NA   
policonsumo2.lag                    NA   
edad_al_ing_1                    0.715   
ano_nac_corr                     0.693   
susinidum_oh                     0.081 . 
susinidum_coc                    0.028 * 
susinidum_pbc                    0.057 . 
susinidum_mar                    0.062 . 
psycom_dum_with                  0.234   
psycom_dum_study                 0.360   
freq_cons_dum_5day               0.668   
cond_oc_dum_2inact               0.010 **
cond_oc_dum_3unemp               0.339   
susprindum_oh                    0.010 * 
susprindum_coc                   0.055 . 
susprindum_pbc                   0.004 **
susprindum_mar                      NA   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                    0.9102      1.099   0.54904     1.509
ano_nac_corr                     0.9000      1.111   0.53305     1.520
susinidum_oh                     0.2515      3.977   0.05333     1.186
susinidum_coc                    0.0955     10.469   0.01177     0.775
susinidum_pbc                    0.1760      5.682   0.02937     1.055
susinidum_mar                    0.1755      5.697   0.02817     1.094
psycom_dum_with                  0.5568      1.796   0.21212     1.462
psycom_dum_study                 0.5729      1.745   0.17380     1.889
freq_cons_dum_5day               1.2337      0.811   0.47219     3.223
cond_oc_dum_2inact               4.9952      0.200   1.46948    16.980
cond_oc_dum_3unemp               2.0053      0.499   0.48140     8.353
susprindum_oh                    0.0406     24.660   0.00350     0.470
susprindum_coc                   0.1135      8.810   0.01227     1.050
susprindum_pbc                   0.0632     15.825   0.00963     0.415
susprindum_mar                       NA         NA        NA        NA

Concordance= 0.62  (se = 0.051 )
Likelihood ratio test= 12.3  on 14 df,   p=0.6
Wald test            = 38.5  on 14 df,   p=4e-04
Score (logrank) test = 20  on 14 df,   p=0.1,   Robust = 11.2  p=0.7

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    2.6    34.2    48.9    52.1    70.7    99.9 
[1] "Modality: WO intensive ambulatory\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 10, number of events= 10 
   (10 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome.lag                       NA        NA  0.00e+00  0.00e+00     NA
less_90d_tr1.lag                     NA        NA  0.00e+00  0.00e+00     NA
log_dias_treat_imp_sin_na.lag        NA        NA  0.00e+00  0.00e+00     NA
comp_bpsc_y3_severe.lag              NA        NA  0.00e+00  0.00e+00     NA
policonsumo2.lag                     NA        NA  0.00e+00  0.00e+00     NA
edad_al_ing_1                 -5.34e+01  6.69e-24  6.64e+03  1.45e+00 -36.92
ano_nac_corr                  -4.99e+01  2.05e-22  5.79e+03  1.40e+00 -35.58
susinidum_oh                   5.70e+00  2.99e+02  1.73e+03  1.07e+00   5.31
susinidum_coc                        NA        NA  0.00e+00  0.00e+00     NA
susinidum_pbc                  5.46e+01  5.41e+23  1.65e+04  3.47e+00  15.75
susinidum_mar                        NA        NA  0.00e+00  0.00e+00     NA
psycom_dum_with                2.74e+01  8.14e+11  4.34e+03  1.45e+00  18.95
psycom_dum_study                     NA        NA  0.00e+00  0.00e+00     NA
freq_cons_dum_5day            -1.48e+02  6.27e-65  1.42e+04  3.58e+00 -41.25
cond_oc_dum_2inact            -4.10e+01  1.49e-18  8.48e+03  2.02e+00 -20.30
cond_oc_dum_3unemp                   NA        NA  0.00e+00  0.00e+00     NA
susprindum_oh                  7.39e+01  1.23e+32  6.98e+03  3.27e+00  22.57
susprindum_coc                 1.39e+02  1.89e+60  6.56e+03  3.67e+00  37.84
susprindum_pbc                       NA        NA  0.00e+00  0.00e+00     NA
susprindum_mar                       NA        NA  0.00e+00  0.00e+00     NA
                              Pr(&gt;|z|)    
tr_outcome.lag                      NA    
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag       NA    
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                   1.1e-07 ***
susinidum_coc                       NA    
susinidum_pbc                  &lt; 2e-16 ***
susinidum_mar                       NA    
psycom_dum_with                &lt; 2e-16 ***
psycom_dum_study                    NA    
freq_cons_dum_5day             &lt; 2e-16 ***
cond_oc_dum_2inact             &lt; 2e-16 ***
cond_oc_dum_3unemp                  NA    
susprindum_oh                  &lt; 2e-16 ***
susprindum_coc                 &lt; 2e-16 ***
susprindum_pbc                      NA    
susprindum_mar                      NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                  6.69e-24   1.50e+23  3.94e-25  1.14e-22
ano_nac_corr                   2.05e-22   4.87e+21  1.31e-23  3.21e-21
susinidum_oh                   2.99e+02   3.34e-03  3.64e+01  2.45e+03
susinidum_coc                        NA         NA        NA        NA
susinidum_pbc                  5.41e+23   1.85e-24  6.03e+20  4.86e+26
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                8.14e+11   1.23e-12  4.77e+10  1.39e+13
psycom_dum_study                     NA         NA        NA        NA
freq_cons_dum_5day             6.27e-65   1.59e+64  5.58e-68  7.05e-62
cond_oc_dum_2inact             1.49e-18   6.70e+17  2.84e-20  7.85e-17
cond_oc_dum_3unemp                   NA         NA        NA        NA
susprindum_oh                  1.23e+32   8.13e-33  2.01e+29  7.53e+34
susprindum_coc                 1.89e+60   5.28e-61  1.43e+57  2.51e+63
susprindum_pbc                       NA         NA        NA        NA
susprindum_mar                       NA         NA        NA        NA

Concordance= 1  (se = 0 )
Likelihood ratio test= 30.2  on 9 df,   p=4e-04
Wald test            = 1857  on 9 df,   p=&lt;2e-16
Score (logrank) test = 21.2  on 9 df,   p=0.01,   Robust = 9.99  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.00e+00 0.00e+00 8.00e+01 1.71e+24 2.95e+13 1.71e+25 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb501"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"This model had some problems, not stable (low n in strata)"</span>)</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Did it later, at 2024-05-16"</span>)</span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a>iiws_strat1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a>comb_strata1 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod), </span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3))</span>
<span id="cb501-9"><a href="#cb501-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-10"><a href="#cb501-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (xx <span class="cf">in</span> <span class="fu">seq_along</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comb_strata1))) {</span>
<span id="cb501-11"><a href="#cb501-11" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span> comb_strata1[xx,<span class="st">"Var1"</span>]</span>
<span id="cb501-12"><a href="#cb501-12" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span> comb_strata1[xx,<span class="st">"Var2"</span>]</span>
<span id="cb501-13"><a href="#cb501-13" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_proc2_subset<span class="ot">&lt;-</span></span>
<span id="cb501-14"><a href="#cb501-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(data_mine_miss_restr_proc2, <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span>i <span class="sc">&amp;</span> time_interval3<span class="sc">==</span>j)</span>
<span id="cb501-15"><a href="#cb501-15" aria-hidden="true" tabindex="-1"></a>  maxfu_df_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span> maxfu.id <span class="sc">%in%</span> <span class="fu">unique</span>(data_mine_miss_proc2_subset<span class="sc">$</span>id))</span>
<span id="cb501-16"><a href="#cb501-16" aria-hidden="true" tabindex="-1"></a>  iiw_model_strat1<span class="ot">&lt;-</span></span>
<span id="cb501-17"><a href="#cb501-17" aria-hidden="true" tabindex="-1"></a>    IrregLong<span class="sc">::</span><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb501-18"><a href="#cb501-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="co">#If a frailty model is used, the cluster(id) term should appear before other covariates</span></span>
<span id="cb501-19"><a href="#cb501-19" aria-hidden="true" tabindex="-1"></a>          tr_outcome.lag<span class="sc">+</span></span>
<span id="cb501-20"><a href="#cb501-20" aria-hidden="true" tabindex="-1"></a>          less_90d_tr1.lag<span class="sc">+</span></span>
<span id="cb501-21"><a href="#cb501-21" aria-hidden="true" tabindex="-1"></a>          log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb501-22"><a href="#cb501-22" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe.lag<span class="sc">+</span></span>
<span id="cb501-23"><a href="#cb501-23" aria-hidden="true" tabindex="-1"></a>          policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb501-24"><a href="#cb501-24" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb501-25"><a href="#cb501-25" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr <span class="sc">+</span> </span>
<span id="cb501-26"><a href="#cb501-26" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb501-27"><a href="#cb501-27" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb501-28"><a href="#cb501-28" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb501-29"><a href="#cb501-29" aria-hidden="true" tabindex="-1"></a>          susinidum_mar <span class="sc">+</span></span>
<span id="cb501-30"><a href="#cb501-30" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with <span class="sc">+</span></span>
<span id="cb501-31"><a href="#cb501-31" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study <span class="sc">+</span> </span>
<span id="cb501-32"><a href="#cb501-32" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb501-33"><a href="#cb501-33" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb501-34"><a href="#cb501-34" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb501-35"><a href="#cb501-35" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb501-36"><a href="#cb501-36" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb501-37"><a href="#cb501-37" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb501-38"><a href="#cb501-38" aria-hidden="true" tabindex="-1"></a>          susprindum_mar, </span>
<span id="cb501-39"><a href="#cb501-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc2_subset,</span>
<span id="cb501-40"><a href="#cb501-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb501-41"><a href="#cb501-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb501-42"><a href="#cb501-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb501-43"><a href="#cb501-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df_subset,</span>
<span id="cb501-44"><a href="#cb501-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with"</span>, <span class="st">"psycom_dum_study_rec2"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb501-45"><a href="#cb501-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>,<span class="st">"log_dias_treat_imp_sin_na"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb501-46"><a href="#cb501-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">1</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb501-47"><a href="#cb501-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T</span>
<span id="cb501-48"><a href="#cb501-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb501-49"><a href="#cb501-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb501-50"><a href="#cb501-50" aria-hidden="true" tabindex="-1"></a>  iiws_strat1[[xx]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb501-51"><a href="#cb501-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> iiw_model_strat1,</span>
<span id="cb501-52"><a href="#cb501-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">comb =</span> <span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j,<span class="st">"."</span>),</span>
<span id="cb501-53"><a href="#cb501-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">cox_iiw =</span> <span class="fu">summary</span>(iiw_model_strat1<span class="sc">$</span>m),</span>
<span id="cb501-54"><a href="#cb501-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">iiw =</span> <span class="fu">summary</span>(iiw_model_strat1<span class="sc">$</span>iiw)</span>
<span id="cb501-55"><a href="#cb501-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb501-56"><a href="#cb501-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j))</span>
<span id="cb501-57"><a href="#cb501-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat1<span class="sc">$</span>m))</span>
<span id="cb501-58"><a href="#cb501-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat1<span class="sc">$</span>iiw))</span>
<span id="cb501-59"><a href="#cb501-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-60"><a href="#cb501-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Modality: WO residential\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2106, number of events= 2106 
   (1417 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.20536   1.22796  0.06616   0.05418  3.79
less_90d_tr1.lag               0.80271   2.23158  0.07067   0.07676 10.46
log_dias_treat_imp_sin_na.lag  0.17616   1.19262  0.03140   0.03679  4.79
comp_bpsc_y3_severe.lag        0.17454   1.19070  0.06655   0.07093  2.46
policonsumo2.lag              -0.04576   0.95527  0.07395   0.05745 -0.80
edad_al_ing_1                  0.11274   1.11935  0.01083   0.00973 11.59
ano_nac_corr                   0.11840   1.12569  0.01057   0.00935 12.66
susinidum_oh                   0.03767   1.03839  0.16591   0.14173  0.27
susinidum_coc                  0.08672   1.09060  0.18995   0.16127  0.54
susinidum_pbc                  0.02071   1.02093  0.17193   0.15333  0.14
susinidum_mar                  0.08361   1.08721  0.16692   0.14457  0.58
psycom_dum_with               -0.02497   0.97534  0.06301   0.05548 -0.45
psycom_dum_study              -0.39981   0.67045  0.07750   0.07329 -5.45
freq_cons_dum_5day            -0.04344   0.95749  0.05145   0.05074 -0.86
cond_oc_dum_2inact             0.03819   1.03893  0.08141   0.08997  0.42
cond_oc_dum_3unemp             0.08288   1.08641  0.08212   0.09092  0.91
susprindum_oh                 -0.03090   0.96957  0.15198   0.14127 -0.22
susprindum_coc                -0.10130   0.90367  0.15487   0.14385 -0.70
susprindum_pbc                -0.06907   0.93326  0.14478   0.13566 -0.51
susprindum_mar                -0.25578   0.77432  0.21774   0.20267 -1.26
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.00015 ***
less_90d_tr1.lag               &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag  1.7e-06 ***
comp_bpsc_y3_severe.lag        0.01386 *  
policonsumo2.lag               0.42565    
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                   0.79041    
susinidum_coc                  0.59075    
susinidum_pbc                  0.89254    
susinidum_mar                  0.56304    
psycom_dum_with                0.65264    
psycom_dum_study               4.9e-08 ***
freq_cons_dum_5day             0.39189    
cond_oc_dum_2inact             0.67120    
cond_oc_dum_3unemp             0.36200    
susprindum_oh                  0.82687    
susprindum_coc                 0.48131    
susprindum_pbc                 0.61062    
susprindum_mar                 0.20693    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.228      0.814     1.104     1.366
less_90d_tr1.lag                  2.232      0.448     1.920     2.594
log_dias_treat_imp_sin_na.lag     1.193      0.838     1.110     1.282
comp_bpsc_y3_severe.lag           1.191      0.840     1.036     1.368
policonsumo2.lag                  0.955      1.047     0.854     1.069
edad_al_ing_1                     1.119      0.893     1.098     1.141
ano_nac_corr                      1.126      0.888     1.105     1.147
susinidum_oh                      1.038      0.963     0.787     1.371
susinidum_coc                     1.091      0.917     0.795     1.496
susinidum_pbc                     1.021      0.979     0.756     1.379
susinidum_mar                     1.087      0.920     0.819     1.443
psycom_dum_with                   0.975      1.025     0.875     1.087
psycom_dum_study                  0.670      1.492     0.581     0.774
freq_cons_dum_5day                0.957      1.044     0.867     1.058
cond_oc_dum_2inact                1.039      0.963     0.871     1.239
cond_oc_dum_3unemp                1.086      0.920     0.909     1.298
susprindum_oh                     0.970      1.031     0.735     1.279
susprindum_coc                    0.904      1.107     0.682     1.198
susprindum_pbc                    0.933      1.072     0.715     1.218
susprindum_mar                    0.774      1.291     0.520     1.152

Concordance= 0.626  (se = 0.005 )
Likelihood ratio test= 328  on 20 df,   p=&lt;2e-16
Wald test            = 374  on 20 df,   p=&lt;2e-16
Score (logrank) test = 315  on 20 df,   p=&lt;2e-16,   Robust = 350  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.15    0.36    0.49    0.58    0.70   12.82 
[1] "Modality: GP intensive ambulatory\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 9973, number of events= 9973 
   (6233 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se      z
tr_outcome.lag                 0.20542   1.22804  0.03520   0.03199   6.42
less_90d_tr1.lag               1.03973   2.82845  0.03442   0.03813  27.26
log_dias_treat_imp_sin_na.lag  0.22867   1.25693  0.02066   0.02551   8.97
comp_bpsc_y3_severe.lag        0.36576   1.44161  0.02292   0.02274  16.09
policonsumo2.lag               0.16091   1.17458  0.03411   0.03307   4.87
edad_al_ing_1                  0.13636   1.14609  0.00500   0.00450  30.29
ano_nac_corr                   0.13706   1.14690  0.00492   0.00442  30.99
susinidum_oh                   0.09086   1.09511  0.06911   0.06255   1.45
susinidum_coc                  0.07104   1.07362  0.08273   0.08140   0.87
susinidum_pbc                  0.17770   1.19447  0.07839   0.07475   2.38
susinidum_mar                  0.17350   1.18946  0.07042   0.06400   2.71
psycom_dum_with               -0.03422   0.96636  0.02230   0.02177  -1.57
psycom_dum_study              -0.42746   0.65217  0.03271   0.03794 -11.27
freq_cons_dum_5day            -0.00842   0.99161  0.02065   0.02115  -0.40
cond_oc_dum_2inact             0.00653   1.00655  0.03106   0.02998   0.22
cond_oc_dum_3unemp             0.01222   1.01230  0.02224   0.02276   0.54
susprindum_oh                 -0.06775   0.93449  0.08948   0.09220  -0.73
susprindum_coc                -0.02664   0.97371  0.09056   0.09304  -0.29
susprindum_pbc                -0.01332   0.98677  0.08833   0.09113  -0.15
susprindum_mar                 0.01243   1.01251  0.09711   0.09863   0.13
                              Pr(&gt;|z|)    
tr_outcome.lag                 1.3e-10 ***
less_90d_tr1.lag               &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag  &lt; 2e-16 ***
comp_bpsc_y3_severe.lag        &lt; 2e-16 ***
policonsumo2.lag               1.1e-06 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                    0.1464    
susinidum_coc                   0.3828    
susinidum_pbc                   0.0174 *  
susinidum_mar                   0.0067 ** 
psycom_dum_with                 0.1160    
psycom_dum_study               &lt; 2e-16 ***
freq_cons_dum_5day              0.6904    
cond_oc_dum_2inact              0.8276    
cond_oc_dum_3unemp              0.5913    
susprindum_oh                   0.4624    
susprindum_coc                  0.7746    
susprindum_pbc                  0.8838    
susprindum_mar                  0.8997    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.228      0.814     1.153     1.308
less_90d_tr1.lag                  2.828      0.354     2.625     3.048
log_dias_treat_imp_sin_na.lag     1.257      0.796     1.196     1.321
comp_bpsc_y3_severe.lag           1.442      0.694     1.379     1.507
policonsumo2.lag                  1.175      0.851     1.101     1.253
edad_al_ing_1                     1.146      0.873     1.136     1.156
ano_nac_corr                      1.147      0.872     1.137     1.157
susinidum_oh                      1.095      0.913     0.969     1.238
susinidum_coc                     1.074      0.931     0.915     1.259
susinidum_pbc                     1.194      0.837     1.032     1.383
susinidum_mar                     1.189      0.841     1.049     1.348
psycom_dum_with                   0.966      1.035     0.926     1.008
psycom_dum_study                  0.652      1.533     0.605     0.703
freq_cons_dum_5day                0.992      1.008     0.951     1.034
cond_oc_dum_2inact                1.007      0.993     0.949     1.067
cond_oc_dum_3unemp                1.012      0.988     0.968     1.058
susprindum_oh                     0.934      1.070     0.780     1.120
susprindum_coc                    0.974      1.027     0.811     1.169
susprindum_pbc                    0.987      1.013     0.825     1.180
susprindum_mar                    1.013      0.988     0.835     1.228

Concordance= 0.661  (se = 0.002 )
Likelihood ratio test= 2547  on 20 df,   p=&lt;2e-16
Wald test            = 2470  on 20 df,   p=&lt;2e-16
Score (logrank) test = 2507  on 20 df,   p=&lt;2e-16,   Robust = 2298  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.07    0.18    0.29    0.38    0.50   16.37 
[1] "Modality: basic ambulatory\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 8836, number of events= 8836 
   (5238 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.19144   1.21100  0.03883   0.03485  5.49
less_90d_tr1.lag               0.85480   2.35091  0.03764   0.04065 21.03
log_dias_treat_imp_sin_na.lag  0.15761   1.17071  0.02305   0.02568  6.14
comp_bpsc_y3_severe.lag        0.71607   2.04638  0.02649   0.02951 24.26
policonsumo2.lag               0.05970   1.06152  0.03302   0.02996  1.99
edad_al_ing_1                  0.12723   1.13568  0.00543   0.00497 25.62
ano_nac_corr                   0.12930   1.13803  0.00536   0.00489 26.45
susinidum_oh                   0.06745   1.06978  0.07583   0.06475  1.04
susinidum_coc                  0.10834   1.11443  0.08975   0.08886  1.22
susinidum_pbc                  0.15305   1.16538  0.08700   0.07998  1.91
susinidum_mar                  0.12643   1.13477  0.07701   0.06677  1.89
psycom_dum_with               -0.09434   0.90997  0.02377   0.02360 -4.00
psycom_dum_study              -0.22528   0.79829  0.03267   0.03752 -6.00
freq_cons_dum_5day            -0.05778   0.94386  0.02458   0.02544 -2.27
cond_oc_dum_2inact            -0.03710   0.96358  0.03369   0.03624 -1.02
cond_oc_dum_3unemp            -0.01370   0.98639  0.02594   0.02723 -0.50
susprindum_oh                  0.03720   1.03790  0.10027   0.07352  0.51
susprindum_coc                 0.04959   1.05084  0.10158   0.07538  0.66
susprindum_pbc                 0.04364   1.04461  0.10005   0.07375  0.59
susprindum_mar                 0.08895   1.09303  0.10631   0.08072  1.10
                              Pr(&gt;|z|)    
tr_outcome.lag                 3.9e-08 ***
less_90d_tr1.lag               &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag  8.3e-10 ***
comp_bpsc_y3_severe.lag        &lt; 2e-16 ***
policonsumo2.lag                 0.046 *  
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                     0.298    
susinidum_coc                    0.223    
susinidum_pbc                    0.056 .  
susinidum_mar                    0.058 .  
psycom_dum_with                6.4e-05 ***
psycom_dum_study               1.9e-09 ***
freq_cons_dum_5day               0.023 *  
cond_oc_dum_2inact               0.306    
cond_oc_dum_3unemp               0.615    
susprindum_oh                    0.613    
susprindum_coc                   0.511    
susprindum_pbc                   0.554    
susprindum_mar                   0.270    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.211      0.826     1.131     1.297
less_90d_tr1.lag                  2.351      0.425     2.171     2.546
log_dias_treat_imp_sin_na.lag     1.171      0.854     1.113     1.231
comp_bpsc_y3_severe.lag           2.046      0.489     1.931     2.168
policonsumo2.lag                  1.062      0.942     1.001     1.126
edad_al_ing_1                     1.136      0.881     1.125     1.147
ano_nac_corr                      1.138      0.879     1.127     1.149
susinidum_oh                      1.070      0.935     0.942     1.215
susinidum_coc                     1.114      0.897     0.936     1.326
susinidum_pbc                     1.165      0.858     0.996     1.363
susinidum_mar                     1.135      0.881     0.996     1.293
psycom_dum_with                   0.910      1.099     0.869     0.953
psycom_dum_study                  0.798      1.253     0.742     0.859
freq_cons_dum_5day                0.944      1.059     0.898     0.992
cond_oc_dum_2inact                0.964      1.038     0.898     1.035
cond_oc_dum_3unemp                0.986      1.014     0.935     1.040
susprindum_oh                     1.038      0.963     0.899     1.199
susprindum_coc                    1.051      0.952     0.907     1.218
susprindum_pbc                    1.045      0.957     0.904     1.207
susprindum_mar                    1.093      0.915     0.933     1.280

Concordance= 0.678  (se = 0.003 )
Likelihood ratio test= 2793  on 20 df,   p=&lt;2e-16
Wald test            = 2423  on 20 df,   p=&lt;2e-16
Score (logrank) test = 2875  on 20 df,   p=&lt;2e-16,   Robust = 2414  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.06    0.17    0.29    0.42    0.62    9.17 
[1] "Modality: GP residential\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 4436, number of events= 4436 
   (2815 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.30950   1.36275  0.04465   0.03996  7.75
less_90d_tr1.lag               0.77198   2.16405  0.04672   0.05172 14.93
log_dias_treat_imp_sin_na.lag  0.19686   1.21757  0.02213   0.02760  7.13
comp_bpsc_y3_severe.lag        0.33683   1.40050  0.04277   0.03970  8.49
policonsumo2.lag               0.21234   1.23657  0.05514   0.05263  4.03
edad_al_ing_1                  0.10459   1.11026  0.00769   0.00679 15.41
ano_nac_corr                   0.10628   1.11214  0.00765   0.00667 15.94
susinidum_oh                   0.09816   1.10314  0.10611   0.10080  0.97
susinidum_coc                  0.16421   1.17846  0.12980   0.12460  1.32
susinidum_pbc                  0.23338   1.26286  0.11301   0.11103  2.10
susinidum_mar                  0.24446   1.27694  0.10643   0.10096  2.42
psycom_dum_with               -0.04315   0.95777  0.03427   0.03465 -1.25
psycom_dum_study              -0.31271   0.73146  0.04962   0.05491 -5.69
freq_cons_dum_5day             0.01423   1.01433  0.03482   0.03425  0.42
cond_oc_dum_2inact             0.07737   1.08044  0.05583   0.05164  1.50
cond_oc_dum_3unemp             0.09295   1.09740  0.04599   0.04394  2.12
susprindum_oh                  0.08714   1.09105  0.16038   0.15169  0.57
susprindum_coc                -0.00799   0.99204  0.16159   0.15287 -0.05
susprindum_pbc                -0.06583   0.93629  0.15656   0.14868 -0.44
susprindum_mar                 0.10378   1.10935  0.18041   0.16729  0.62
                              Pr(&gt;|z|)    
tr_outcome.lag                 9.5e-15 ***
less_90d_tr1.lag               &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag  9.9e-13 ***
comp_bpsc_y3_severe.lag        &lt; 2e-16 ***
policonsumo2.lag               5.5e-05 ***
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                     0.330    
susinidum_coc                    0.188    
susinidum_pbc                    0.036 *  
susinidum_mar                    0.015 *  
psycom_dum_with                  0.213    
psycom_dum_study               1.2e-08 ***
freq_cons_dum_5day               0.678    
cond_oc_dum_2inact               0.134    
cond_oc_dum_3unemp               0.034 *  
susprindum_oh                    0.566    
susprindum_coc                   0.958    
susprindum_pbc                   0.658    
susprindum_mar                   0.535    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.363      0.734     1.260     1.474
less_90d_tr1.lag                  2.164      0.462     1.955     2.395
log_dias_treat_imp_sin_na.lag     1.218      0.821     1.153     1.285
comp_bpsc_y3_severe.lag           1.401      0.714     1.296     1.514
policonsumo2.lag                  1.237      0.809     1.115     1.371
edad_al_ing_1                     1.110      0.901     1.096     1.125
ano_nac_corr                      1.112      0.899     1.098     1.127
susinidum_oh                      1.103      0.907     0.905     1.344
susinidum_coc                     1.178      0.849     0.923     1.504
susinidum_pbc                     1.263      0.792     1.016     1.570
susinidum_mar                     1.277      0.783     1.048     1.556
psycom_dum_with                   0.958      1.044     0.895     1.025
psycom_dum_study                  0.731      1.367     0.657     0.815
freq_cons_dum_5day                1.014      0.986     0.948     1.085
cond_oc_dum_2inact                1.080      0.926     0.976     1.196
cond_oc_dum_3unemp                1.097      0.911     1.007     1.196
susprindum_oh                     1.091      0.917     0.810     1.469
susprindum_coc                    0.992      1.008     0.735     1.339
susprindum_pbc                    0.936      1.068     0.700     1.253
susprindum_mar                    1.109      0.901     0.799     1.540

Concordance= 0.642  (se = 0.004 )
Likelihood ratio test= 828  on 20 df,   p=&lt;2e-16
Wald test            = 790  on 20 df,   p=&lt;2e-16
Score (logrank) test = 780  on 20 df,   p=&lt;2e-16,   Robust = 724  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.08    0.18    0.24    0.30    0.37    6.84 
[1] "Modality: WO intensive ambulatory\nTime interval: [0,88]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1546, number of events= 1546 
   (908 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.23134   1.26029  0.09190   0.07725  2.99
less_90d_tr1.lag               0.95955   2.61051  0.08825   0.08096 11.85
log_dias_treat_imp_sin_na.lag  0.09043   1.09465  0.05335   0.04257  2.12
comp_bpsc_y3_severe.lag        0.31352   1.36824  0.06024   0.05549  5.65
policonsumo2.lag              -0.08198   0.92129  0.08184   0.06548 -1.25
edad_al_ing_1                  0.12309   1.13099  0.01311   0.01174 10.49
ano_nac_corr                   0.12241   1.13022  0.01264   0.01153 10.61
susinidum_oh                  -0.19596   0.82204  0.17904   0.17621 -1.11
susinidum_coc                  0.00617   1.00619  0.20987   0.20957  0.03
susinidum_pbc                 -0.06247   0.93945  0.19053   0.18657 -0.33
susinidum_mar                 -0.06877   0.93355  0.18001   0.17810 -0.39
psycom_dum_with               -0.05898   0.94272  0.05788   0.05379 -1.10
psycom_dum_study              -0.47231   0.62356  0.08757   0.09703 -4.87
freq_cons_dum_5day            -0.03117   0.96931  0.05294   0.05513 -0.57
cond_oc_dum_2inact             0.11950   1.12693  0.06683   0.06368  1.88
cond_oc_dum_3unemp             0.02634   1.02669  0.06935   0.07437  0.35
susprindum_oh                 -0.09921   0.90555  0.19340   0.19563 -0.51
susprindum_coc                 0.01020   1.01025  0.19593   0.21054  0.05
susprindum_pbc                -0.07461   0.92811  0.18970   0.20223 -0.37
susprindum_mar                -0.08083   0.92235  0.20716   0.21899 -0.37
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.0027 ** 
less_90d_tr1.lag               &lt; 2e-16 ***
log_dias_treat_imp_sin_na.lag   0.0336 *  
comp_bpsc_y3_severe.lag        1.6e-08 ***
policonsumo2.lag                0.2106    
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                    0.2661    
susinidum_coc                   0.9765    
susinidum_pbc                   0.7378    
susinidum_mar                   0.6994    
psycom_dum_with                 0.2729    
psycom_dum_study               1.1e-06 ***
freq_cons_dum_5day              0.5718    
cond_oc_dum_2inact              0.0606 .  
cond_oc_dum_3unemp              0.7232    
susprindum_oh                   0.6121    
susprindum_coc                  0.9614    
susprindum_pbc                  0.7122    
susprindum_mar                  0.7121    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.260      0.793     1.083     1.466
less_90d_tr1.lag                  2.611      0.383     2.227     3.059
log_dias_treat_imp_sin_na.lag     1.095      0.914     1.007     1.190
comp_bpsc_y3_severe.lag           1.368      0.731     1.227     1.525
policonsumo2.lag                  0.921      1.085     0.810     1.047
edad_al_ing_1                     1.131      0.884     1.105     1.157
ano_nac_corr                      1.130      0.885     1.105     1.156
susinidum_oh                      0.822      1.216     0.582     1.161
susinidum_coc                     1.006      0.994     0.667     1.517
susinidum_pbc                     0.939      1.064     0.652     1.354
susinidum_mar                     0.934      1.071     0.658     1.324
psycom_dum_with                   0.943      1.061     0.848     1.048
psycom_dum_study                  0.624      1.604     0.516     0.754
freq_cons_dum_5day                0.969      1.032     0.870     1.080
cond_oc_dum_2inact                1.127      0.887     0.995     1.277
cond_oc_dum_3unemp                1.027      0.974     0.887     1.188
susprindum_oh                     0.906      1.104     0.617     1.329
susprindum_coc                    1.010      0.990     0.669     1.526
susprindum_pbc                    0.928      1.077     0.624     1.380
susprindum_mar                    0.922      1.084     0.600     1.417

Concordance= 0.659  (se = 0.006 )
Likelihood ratio test= 396  on 20 df,   p=&lt;2e-16
Wald test            = 391  on 20 df,   p=&lt;2e-16
Score (logrank) test = 404  on 20 df,   p=&lt;2e-16,   Robust = 375  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.134   0.312   0.489   0.630   0.868   2.768 
[1] "Modality: WO residential\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 34, number of events= 34 
   (32 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                     NA        NA   0.0000    0.0000    NA
less_90d_tr1.lag               4.4157   82.7386   2.7593    2.7900  1.58
log_dias_treat_imp_sin_na.lag  4.4195   83.0584   2.1191    1.9017  2.32
comp_bpsc_y3_severe.lag            NA        NA   0.0000    0.0000    NA
policonsumo2.lag                   NA        NA   0.0000    0.0000    NA
edad_al_ing_1                  2.4852   12.0039   0.7005    0.8291  3.00
ano_nac_corr                   2.3745   10.7460   0.6782    0.8038  2.95
susinidum_oh                  -4.3298    0.0132   1.6380    1.3810 -3.14
susinidum_coc                      NA        NA   0.0000    0.0000    NA
susinidum_pbc                 -4.5556    0.0105   1.6927    1.5403 -2.96
susinidum_mar                 -4.0816    0.0169   1.5315    1.0705 -3.81
psycom_dum_with                0.3149    1.3702   0.6251    0.5934  0.53
psycom_dum_study               1.8290    6.2277   1.2291    1.1187  1.63
freq_cons_dum_5day            -0.2795    0.7561   0.5600    0.6164 -0.45
cond_oc_dum_2inact             0.6222    1.8630   1.2392    1.7717  0.35
cond_oc_dum_3unemp             1.1566    3.1792   1.1545    1.6923  0.68
susprindum_oh                 -1.6687    0.1885   1.9275    1.7284 -0.97
susprindum_coc                -0.5048    0.6036   1.4589    1.0889 -0.46
susprindum_pbc                -0.5150    0.5975   1.2052    0.7966 -0.65
susprindum_mar                     NA        NA   0.0000    0.0000    NA
                              Pr(&gt;|z|)    
tr_outcome.lag                      NA    
less_90d_tr1.lag               0.11349    
log_dias_treat_imp_sin_na.lag  0.02013 *  
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                  0.00272 ** 
ano_nac_corr                   0.00313 ** 
susinidum_oh                   0.00172 ** 
susinidum_coc                       NA    
susinidum_pbc                  0.00310 ** 
susinidum_mar                  0.00014 ***
psycom_dum_with                0.59557    
psycom_dum_study               0.10206    
freq_cons_dum_5day             0.65023    
cond_oc_dum_2inact             0.72545    
cond_oc_dum_3unemp             0.49430    
susprindum_oh                  0.33431    
susprindum_coc                 0.64295    
susprindum_pbc                 0.51798    
susprindum_mar                      NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                82.7386     0.0121  0.349036  1.96e+04
log_dias_treat_imp_sin_na.lag   83.0584     0.0120  1.998148  3.45e+03
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                   12.0039     0.0833  2.363494  6.10e+01
ano_nac_corr                    10.7460     0.0931  2.223632  5.19e+01
susinidum_oh                     0.0132    75.9321  0.000879  1.97e-01
susinidum_coc                        NA         NA        NA        NA
susinidum_pbc                    0.0105    95.1637  0.000513  2.15e-01
susinidum_mar                    0.0169    59.2412  0.002071  1.38e-01
psycom_dum_with                  1.3702     0.7298  0.428266  4.38e+00
psycom_dum_study                 6.2277     0.1606  0.695181  5.58e+01
freq_cons_dum_5day               0.7561     1.3225  0.225893  2.53e+00
cond_oc_dum_2inact               1.8630     0.5368  0.057826  6.00e+01
cond_oc_dum_3unemp               3.1792     0.3145  0.115310  8.77e+01
susprindum_oh                    0.1885     5.3052  0.006370  5.58e+00
susprindum_coc                   0.6036     1.6566  0.071431  5.10e+00
susprindum_pbc                   0.5975     1.6736  0.125403  2.85e+00
susprindum_mar                       NA         NA        NA        NA

Concordance= 0.777  (se = 0.035 )
Likelihood ratio test= 29.1  on 15 df,   p=0.02
Wald test            = 93.5  on 15 df,   p=2e-13
Score (logrank) test = 36.1  on 15 df,   p=0.002,   Robust = 28.5  p=0.02

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.02    0.19    0.63    1.20    1.94    4.91 
[1] "Modality: GP intensive ambulatory\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 213, number of events= 213 
   (202 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.1420    0.8676   0.9397    0.6795 -0.21
less_90d_tr1.lag               0.1767    1.1933   1.2881    0.9068  0.19
log_dias_treat_imp_sin_na.lag -0.6701    0.5116   0.9782    0.9147 -0.73
comp_bpsc_y3_severe.lag       -0.0543    0.9471   0.6691    0.5533 -0.10
policonsumo2.lag              -0.4395    0.6444   0.8116    0.5030 -0.87
edad_al_ing_1                  0.7008    2.0153   0.1090    0.1087  6.45
ano_nac_corr                   0.6961    2.0059   0.1104    0.1105  6.30
susinidum_oh                  -0.0531    0.9483   0.3644    0.3947 -0.13
susinidum_coc                  0.0278    1.0282   0.5261    0.4879  0.06
susinidum_pbc                  0.0657    1.0679   0.5213    0.6393  0.10
susinidum_mar                 -0.0596    0.9421   0.3790    0.4164 -0.14
psycom_dum_with               -0.1269    0.8808   0.1630    0.1558 -0.81
psycom_dum_study              -0.1664    0.8467   0.2567    0.2651 -0.63
freq_cons_dum_5day             0.2489    1.2826   0.1656    0.1562  1.59
cond_oc_dum_2inact            -0.0389    0.9619   0.2675    0.2474 -0.16
cond_oc_dum_3unemp            -0.0623    0.9396   0.1663    0.1661 -0.38
susprindum_oh                 -0.8567    0.4246   0.6738    0.5892 -1.45
susprindum_coc                -0.9290    0.3950   0.6812    0.6043 -1.54
susprindum_pbc                -0.5742    0.5631   0.6592    0.5839 -0.98
susprindum_mar                -0.7788    0.4590   0.7109    0.6565 -1.19
                              Pr(&gt;|z|)    
tr_outcome.lag                    0.83    
less_90d_tr1.lag                  0.85    
log_dias_treat_imp_sin_na.lag     0.46    
comp_bpsc_y3_severe.lag           0.92    
policonsumo2.lag                  0.38    
edad_al_ing_1                  1.1e-10 ***
ano_nac_corr                   3.0e-10 ***
susinidum_oh                      0.89    
susinidum_coc                     0.95    
susinidum_pbc                     0.92    
susinidum_mar                     0.89    
psycom_dum_with                   0.42    
psycom_dum_study                  0.53    
freq_cons_dum_5day                0.11    
cond_oc_dum_2inact                0.88    
cond_oc_dum_3unemp                0.71    
susprindum_oh                     0.15    
susprindum_coc                    0.12    
susprindum_pbc                    0.33    
susprindum_mar                    0.24    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.868      1.153    0.2290      3.29
less_90d_tr1.lag                  1.193      0.838    0.2018      7.06
log_dias_treat_imp_sin_na.lag     0.512      1.955    0.0852      3.07
comp_bpsc_y3_severe.lag           0.947      1.056    0.3202      2.80
policonsumo2.lag                  0.644      1.552    0.2404      1.73
edad_al_ing_1                     2.015      0.496    1.6287      2.49
ano_nac_corr                      2.006      0.499    1.6152      2.49
susinidum_oh                      0.948      1.054    0.4375      2.06
susinidum_coc                     1.028      0.973    0.3951      2.68
susinidum_pbc                     1.068      0.936    0.3051      3.74
susinidum_mar                     0.942      1.061    0.4165      2.13
psycom_dum_with                   0.881      1.135    0.6490      1.20
psycom_dum_study                  0.847      1.181    0.5036      1.42
freq_cons_dum_5day                1.283      0.780    0.9443      1.74
cond_oc_dum_2inact                0.962      1.040    0.5923      1.56
cond_oc_dum_3unemp                0.940      1.064    0.6785      1.30
susprindum_oh                     0.425      2.355    0.1338      1.35
susprindum_coc                    0.395      2.532    0.1208      1.29
susprindum_pbc                    0.563      1.776    0.1793      1.77
susprindum_mar                    0.459      2.179    0.1268      1.66

Concordance= 0.648  (se = 0.021 )
Likelihood ratio test= 62.5  on 20 df,   p=3e-06
Wald test            = 74.1  on 20 df,   p=4e-08
Score (logrank) test = 58  on 20 df,   p=1e-05,   Robust = 60.1  p=7e-06

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.57    2.31    3.29    4.18    4.76   29.49 
[1] "Modality: basic ambulatory\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 200, number of events= 200 
   (189 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.7197    0.4869   1.2028    0.3990 -1.80
less_90d_tr1.lag              -1.8129    0.1632   1.7882    1.2190 -1.49
log_dias_treat_imp_sin_na.lag -1.8079    0.1640   1.0549    0.8626 -2.10
comp_bpsc_y3_severe.lag        0.0974    1.1023   1.1447    0.4256  0.23
policonsumo2.lag               2.2023    9.0461   1.9113    1.0858  2.03
edad_al_ing_1                  0.7794    2.1801   0.1172    0.1249  6.24
ano_nac_corr                   0.7680    2.1554   0.1169    0.1245  6.17
susinidum_oh                   0.5302    1.6993   0.5270    0.3807  1.39
susinidum_coc                  0.1994    1.2206   0.5865    0.4163  0.48
susinidum_pbc                  0.6580    1.9309   0.5718    0.4256  1.55
susinidum_mar                  0.7490    2.1148   0.5406    0.3995  1.87
psycom_dum_with                0.0195    1.0197   0.1761    0.1662  0.12
psycom_dum_study               0.0389    1.0397   0.2107    0.2057  0.19
freq_cons_dum_5day             0.2773    1.3195   0.1653    0.1702  1.63
cond_oc_dum_2inact             0.2667    1.3057   0.2393    0.2809  0.95
cond_oc_dum_3unemp            -0.0170    0.9831   0.1848    0.1678 -0.10
susprindum_oh                 -0.8348    0.4340   0.5167    0.4450 -1.88
susprindum_coc                -0.8892    0.4110   0.5240    0.4586 -1.94
susprindum_pbc                -0.7822    0.4574   0.5047    0.4376 -1.79
susprindum_mar                -0.3340    0.7161   0.5473    0.5222 -0.64
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.071 .  
less_90d_tr1.lag                 0.137    
log_dias_treat_imp_sin_na.lag    0.036 *  
comp_bpsc_y3_severe.lag          0.819    
policonsumo2.lag                 0.043 *  
edad_al_ing_1                  4.3e-10 ***
ano_nac_corr                   7.0e-10 ***
susinidum_oh                     0.164    
susinidum_coc                    0.632    
susinidum_pbc                    0.122    
susinidum_mar                    0.061 .  
psycom_dum_with                  0.907    
psycom_dum_study                 0.850    
freq_cons_dum_5day               0.103    
cond_oc_dum_2inact               0.342    
cond_oc_dum_3unemp               0.919    
susprindum_oh                    0.061 .  
susprindum_coc                   0.052 .  
susprindum_pbc                   0.074 .  
susprindum_mar                   0.522    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.487      2.054    0.2228     1.064
less_90d_tr1.lag                  0.163      6.128    0.0150     1.779
log_dias_treat_imp_sin_na.lag     0.164      6.098    0.0302     0.889
comp_bpsc_y3_severe.lag           1.102      0.907    0.4787     2.538
policonsumo2.lag                  9.046      0.111    1.0769    75.986
edad_al_ing_1                     2.180      0.459    1.7068     2.785
ano_nac_corr                      2.155      0.464    1.6885     2.751
susinidum_oh                      1.699      0.588    0.8057     3.584
susinidum_coc                     1.221      0.819    0.5398     2.760
susinidum_pbc                     1.931      0.518    0.8384     4.447
susinidum_mar                     2.115      0.473    0.9666     4.627
psycom_dum_with                   1.020      0.981    0.7361     1.412
psycom_dum_study                  1.040      0.962    0.6948     1.556
freq_cons_dum_5day                1.320      0.758    0.9453     1.842
cond_oc_dum_2inact                1.306      0.766    0.7529     2.264
cond_oc_dum_3unemp                0.983      1.017    0.7075     1.366
susprindum_oh                     0.434      2.304    0.1814     1.038
susprindum_coc                    0.411      2.433    0.1673     1.010
susprindum_pbc                    0.457      2.186    0.1940     1.078
susprindum_mar                    0.716      1.397    0.2573     1.993

Concordance= 0.664  (se = 0.022 )
Likelihood ratio test= 68.2  on 20 df,   p=4e-07
Wald test            = 175  on 20 df,   p=&lt;2e-16
Score (logrank) test = 66.3  on 20 df,   p=7e-07,   Robust = 66.8  p=6e-07

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.24    0.70    1.13    1.58    1.96   11.84 
[1] "Modality: GP residential\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 87, number of events= 87 
   (80 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -2.5530    0.0779   2.0164    0.9029 -2.83
less_90d_tr1.lag               2.0565    7.8187   1.0277    0.5534  3.72
log_dias_treat_imp_sin_na.lag  0.5230    1.6871   1.4091    0.6244  0.84
comp_bpsc_y3_severe.lag       -0.0445    0.9565   1.7827    0.8678 -0.05
policonsumo2.lag              -2.8354    0.0587   2.0626    1.3710 -2.07
edad_al_ing_1                  1.0157    2.7612   0.2224    0.1885  5.39
ano_nac_corr                   1.0052    2.7325   0.2221    0.1868  5.38
susinidum_oh                  -0.9494    0.3870   1.0531    0.3347 -2.84
susinidum_coc                 -0.9051    0.4045   1.2157    0.5140 -1.76
susinidum_pbc                 -1.3499    0.2593   1.1023    0.4586 -2.94
susinidum_mar                 -1.1042    0.3315   1.0590    0.3061 -3.61
psycom_dum_with               -0.0621    0.9398   0.2946    0.2650 -0.23
psycom_dum_study               0.2976    1.3466   0.4129    0.3391  0.88
freq_cons_dum_5day            -0.7801    0.4583   0.2954    0.2557 -3.05
cond_oc_dum_2inact            -0.2235    0.7997   0.5043    0.5206 -0.43
cond_oc_dum_3unemp            -0.5810    0.5594   0.4172    0.4796 -1.21
susprindum_oh                 -3.2829    0.0375   1.2809    0.6779 -4.84
susprindum_coc                -2.3737    0.0931   1.2918    0.8134 -2.92
susprindum_pbc                -2.1977    0.1111   1.2660    0.7348 -2.99
susprindum_mar                -1.6220    0.1975   1.5119    0.7975 -2.03
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.00469 ** 
less_90d_tr1.lag               0.00020 ***
log_dias_treat_imp_sin_na.lag  0.40220    
comp_bpsc_y3_severe.lag        0.95912    
policonsumo2.lag               0.03863 *  
edad_al_ing_1                  7.1e-08 ***
ano_nac_corr                   7.4e-08 ***
susinidum_oh                   0.00457 ** 
susinidum_coc                  0.07827 .  
susinidum_pbc                  0.00324 ** 
susinidum_mar                  0.00031 ***
psycom_dum_with                0.81465    
psycom_dum_study               0.38018    
freq_cons_dum_5day             0.00228 ** 
cond_oc_dum_2inact             0.66772    
cond_oc_dum_3unemp             0.22571    
susprindum_oh                  1.3e-06 ***
susprindum_coc                 0.00352 ** 
susprindum_pbc                 0.00278 ** 
susprindum_mar                 0.04197 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                   0.0779     12.845   0.01326     0.457
less_90d_tr1.lag                 7.8187      0.128   2.64266    23.133
log_dias_treat_imp_sin_na.lag    1.6871      0.593   0.49623     5.736
comp_bpsc_y3_severe.lag          0.9565      1.045   0.17460     5.240
policonsumo2.lag                 0.0587     17.037   0.00400     0.862
edad_al_ing_1                    2.7612      0.362   1.90834     3.995
ano_nac_corr                     2.7325      0.366   1.89481     3.941
susinidum_oh                     0.3870      2.584   0.20079     0.746
susinidum_coc                    0.4045      2.472   0.14770     1.108
susinidum_pbc                    0.2593      3.857   0.10554     0.637
susinidum_mar                    0.3315      3.017   0.18192     0.604
psycom_dum_with                  0.9398      1.064   0.55910     1.580
psycom_dum_study                 1.3466      0.743   0.69279     2.617
freq_cons_dum_5day               0.4583      2.182   0.27768     0.757
cond_oc_dum_2inact               0.7997      1.250   0.28831     2.218
cond_oc_dum_3unemp               0.5594      1.788   0.21852     1.432
susprindum_oh                    0.0375     26.654   0.00994     0.142
susprindum_coc                   0.0931     10.737   0.01891     0.459
susprindum_pbc                   0.1111      9.004   0.02631     0.469
susprindum_mar                   0.1975      5.063   0.04138     0.943

Concordance= 0.718  (se = 0.029 )
Likelihood ratio test= 47.9  on 20 df,   p=4e-04
Wald test            = 120  on 20 df,   p=3e-16
Score (logrank) test = 47.1  on 20 df,   p=6e-04,   Robust = 42.4  p=0.002

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    334    1060    1807    3592    3996   25185 
[1] "Modality: WO intensive ambulatory\nTime interval: (93,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 41, number of events= 41 
   (36 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome.lag                 1.20e+01  1.65e+05  4.55e+03  8.85e-01  13.58
less_90d_tr1.lag               2.41e+01  3.00e+10  7.73e+03  2.50e+00   9.64
log_dias_treat_imp_sin_na.lag -2.91e+01  2.33e-13  1.15e+04  2.34e+00 -12.44
comp_bpsc_y3_severe.lag       -3.46e+01  9.18e-16  1.26e+04  2.68e+00 -12.94
policonsumo2.lag              -7.42e+01  5.80e-33  2.82e+04  5.70e+00 -13.02
edad_al_ing_1                  3.98e-01  1.49e+00  3.04e-01  3.27e-01   1.22
ano_nac_corr                   3.63e-01  1.44e+00  2.94e-01  3.20e-01   1.14
susinidum_oh                  -1.29e+00  2.76e-01  6.11e-01  7.17e-01  -1.79
susinidum_coc                 -3.32e+00  3.62e-02  1.39e+00  1.02e+00  -3.25
susinidum_pbc                 -1.46e+00  2.32e-01  7.40e-01  8.96e-01  -1.63
susinidum_mar                        NA        NA  0.00e+00  0.00e+00     NA
psycom_dum_with                4.43e-01  1.56e+00  5.68e-01  5.14e-01   0.86
psycom_dum_study              -3.73e-01  6.88e-01  6.21e-01  6.65e-01  -0.56
freq_cons_dum_5day             1.94e+00  6.93e+00  6.29e-01  6.19e-01   3.13
cond_oc_dum_2inact            -1.71e+00  1.80e-01  9.74e-01  1.08e+00  -1.58
cond_oc_dum_3unemp            -1.81e+00  1.63e-01  1.05e+00  1.06e+00  -1.72
susprindum_oh                 -1.79e+00  1.68e-01  1.55e+00  1.52e+00  -1.18
susprindum_coc                -5.81e-01  5.59e-01  1.26e+00  7.71e-01  -0.75
susprindum_pbc                -5.69e-01  5.66e-01  1.18e+00  7.55e-01  -0.75
susprindum_mar                -1.73e+00  1.77e-01  1.50e+00  1.11e+00  -1.56
                              Pr(&gt;|z|)    
tr_outcome.lag                  &lt;2e-16 ***
less_90d_tr1.lag                &lt;2e-16 ***
log_dias_treat_imp_sin_na.lag   &lt;2e-16 ***
comp_bpsc_y3_severe.lag         &lt;2e-16 ***
policonsumo2.lag                &lt;2e-16 ***
edad_al_ing_1                   0.2238    
ano_nac_corr                    0.2561    
susinidum_oh                    0.0727 .  
susinidum_coc                   0.0012 ** 
susinidum_pbc                   0.1026    
susinidum_mar                       NA    
psycom_dum_with                 0.3892    
psycom_dum_study                0.5745    
freq_cons_dum_5day              0.0018 ** 
cond_oc_dum_2inact              0.1142    
cond_oc_dum_3unemp              0.0862 .  
susprindum_oh                   0.2387    
susprindum_coc                  0.4508    
susprindum_pbc                  0.4510    
susprindum_mar                  0.1199    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                 1.65e+05   6.06e-06  2.92e+04  9.35e+05
less_90d_tr1.lag               3.00e+10   3.34e-11  2.22e+08  4.04e+12
log_dias_treat_imp_sin_na.lag  2.33e-13   4.29e+12  2.38e-15  2.28e-11
comp_bpsc_y3_severe.lag        9.18e-16   1.09e+15  4.85e-18  1.74e-13
policonsumo2.lag               5.80e-33   1.72e+32  8.14e-38  4.13e-28
edad_al_ing_1                  1.49e+00   6.72e-01  7.84e-01  2.83e+00
ano_nac_corr                   1.44e+00   6.96e-01  7.68e-01  2.69e+00
susinidum_oh                   2.76e-01   3.62e+00  6.78e-02  1.13e+00
susinidum_coc                  3.62e-02   2.76e+01  4.90e-03  2.68e-01
susinidum_pbc                  2.32e-01   4.31e+00  4.01e-02  1.34e+00
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                1.56e+00   6.42e-01  5.68e-01  4.27e+00
psycom_dum_study               6.88e-01   1.45e+00  1.87e-01  2.53e+00
freq_cons_dum_5day             6.93e+00   1.44e-01  2.06e+00  2.33e+01
cond_oc_dum_2inact             1.80e-01   5.55e+00  2.15e-02  1.51e+00
cond_oc_dum_3unemp             1.63e-01   6.12e+00  2.06e-02  1.29e+00
susprindum_oh                  1.68e-01   5.96e+00  8.59e-03  3.27e+00
susprindum_coc                 5.59e-01   1.79e+00  1.24e-01  2.53e+00
susprindum_pbc                 5.66e-01   1.77e+00  1.29e-01  2.49e+00
susprindum_mar                 1.77e-01   5.64e+00  2.00e-02  1.57e+00

Concordance= 0.725  (se = 0.05 )
Likelihood ratio test= 24.1  on 19 df,   p=0.2
Wald test            = 941  on 19 df,   p=&lt;2e-16
Score (logrank) test = 26.8  on 19 df,   p=0.1,   Robust = 19.6  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
1.62e+29 1.94e+30 4.51e+30 2.39e+37 9.76e+30 9.82e+38 
[1] "Modality: WO residential\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 13, number of events= 13 
   (13 observations deleted due to missingness)

                                    coef  exp(coef)   se(coef)  robust se     z
tr_outcome.lag                        NA         NA   0.00e+00   0.00e+00    NA
less_90d_tr1.lag                      NA         NA   0.00e+00   0.00e+00    NA
log_dias_treat_imp_sin_na.lag         NA         NA   0.00e+00   0.00e+00    NA
comp_bpsc_y3_severe.lag               NA         NA   0.00e+00   0.00e+00    NA
policonsumo2.lag                      NA         NA   0.00e+00   0.00e+00    NA
edad_al_ing_1                  -5.69e+01   2.01e-25   5.83e+02   2.31e+00 -24.7
ano_nac_corr                   -3.70e+01   8.29e-17   2.42e+04   1.94e+00 -19.1
susinidum_oh                    2.40e+02  1.77e+104   3.87e+05   7.01e+00  34.2
susinidum_coc                         NA         NA   0.00e+00   0.00e+00    NA
susinidum_pbc                   1.68e+02   9.89e+72   1.69e+05   5.26e+00  31.9
susinidum_mar                         NA         NA   0.00e+00   0.00e+00    NA
psycom_dum_with                -2.17e+01   3.76e-10   7.26e+04   1.38e+00 -15.7
psycom_dum_study               -1.21e+02   1.81e-53   4.11e+05   5.48e+00 -22.2
freq_cons_dum_5day             -6.09e+01   3.71e-27   2.42e+04   2.26e+00 -26.9
cond_oc_dum_2inact                    NA         NA   0.00e+00   0.00e+00    NA
cond_oc_dum_3unemp                    NA         NA   0.00e+00   0.00e+00    NA
susprindum_oh                   9.63e+01   6.38e+41   1.21e+05   5.27e+00  18.2
susprindum_coc                  1.21e+02   2.66e+52   7.26e+04   3.47e+00  34.8
susprindum_pbc                  1.14e+02   3.44e+49   2.43e+04   4.27e+00  26.7
susprindum_mar                        NA         NA   0.00e+00   0.00e+00    NA
                              Pr(&gt;|z|)    
tr_outcome.lag                      NA    
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag       NA    
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                   &lt;2e-16 ***
ano_nac_corr                    &lt;2e-16 ***
susinidum_oh                    &lt;2e-16 ***
susinidum_coc                       NA    
susinidum_pbc                   &lt;2e-16 ***
susinidum_mar                       NA    
psycom_dum_with                 &lt;2e-16 ***
psycom_dum_study                &lt;2e-16 ***
freq_cons_dum_5day              &lt;2e-16 ***
cond_oc_dum_2inact                  NA    
cond_oc_dum_3unemp                  NA    
susprindum_oh                   &lt;2e-16 ***
susprindum_coc                  &lt;2e-16 ***
susprindum_pbc                  &lt;2e-16 ***
susprindum_mar                      NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                  2.01e-25   4.98e+24  2.19e-27  1.84e-23
ano_nac_corr                   8.29e-17   1.21e+16  1.84e-18  3.73e-15
susinidum_oh                  1.77e+104  5.64e-105  1.92e+98 1.64e+110
susinidum_coc                        NA         NA        NA        NA
susinidum_pbc                  9.89e+72   1.01e-73  3.30e+68  2.97e+77
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                3.76e-10   2.66e+09  2.52e-11  5.61e-09
psycom_dum_study               1.81e-53   5.53e+52  3.91e-58  8.35e-49
freq_cons_dum_5day             3.71e-27   2.70e+26  4.43e-29  3.11e-25
cond_oc_dum_2inact                   NA         NA        NA        NA
cond_oc_dum_3unemp                   NA         NA        NA        NA
susprindum_oh                  6.38e+41   1.57e-42  2.07e+37  1.97e+46
susprindum_coc                 2.66e+52   3.76e-53  2.98e+49  2.37e+55
susprindum_pbc                 3.44e+49   2.90e-50  7.99e+45  1.48e+53
susprindum_mar                       NA         NA        NA        NA

Concordance= 1  (se = 0 )
Likelihood ratio test= 45.1  on 10 df,   p=2e-06
Wald test            = 1819  on 10 df,   p=&lt;2e-16
Score (logrank) test = 16.9  on 10 df,   p=0.08,   Robust = 12.6  p=0.2

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.00e+00 0.00e+00 0.00e+00 2.29e+68 0.00e+00 2.98e+69 
[1] "Modality: GP intensive ambulatory\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 74, number of events= 74 
   (74 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                     NA        NA   0.0000    0.0000    NA
less_90d_tr1.lag                   NA        NA   0.0000    0.0000    NA
log_dias_treat_imp_sin_na.lag      NA        NA   0.0000    0.0000    NA
comp_bpsc_y3_severe.lag            NA        NA   0.0000    0.0000    NA
policonsumo2.lag                   NA        NA   0.0000    0.0000    NA
edad_al_ing_1                  0.0225    1.0228   0.1475    0.1616  0.14
ano_nac_corr                   0.0460    1.0471   0.1395    0.1496  0.31
susinidum_oh                  -0.2291    0.7953   0.2985    0.2714 -0.84
susinidum_coc                  0.8542    2.3495   0.5729    0.5836  1.46
susinidum_pbc                 -0.6890    0.5021   0.5586    0.6669 -1.03
susinidum_mar                      NA        NA   0.0000    0.0000    NA
psycom_dum_with                0.3664    1.4425   0.3078    0.2991  1.22
psycom_dum_study               1.1222    3.0717   0.4851    0.4892  2.29
freq_cons_dum_5day             0.2846    1.3292   0.3179    0.2895  0.98
cond_oc_dum_2inact             0.1720    1.1877   0.4223    0.3660  0.47
cond_oc_dum_3unemp             0.4730    1.6048   0.3933    0.3670  1.29
susprindum_oh                 -0.0812    0.9220   0.6170    0.4583 -0.18
susprindum_coc                -0.0655    0.9366   0.6616    0.5184 -0.13
susprindum_pbc                -0.6944    0.4994   0.5289    0.3637 -1.91
susprindum_mar                     NA        NA   0.0000    0.0000    NA
                              Pr(&gt;|z|)  
tr_outcome.lag                      NA  
less_90d_tr1.lag                    NA  
log_dias_treat_imp_sin_na.lag       NA  
comp_bpsc_y3_severe.lag             NA  
policonsumo2.lag                    NA  
edad_al_ing_1                    0.889  
ano_nac_corr                     0.758  
susinidum_oh                     0.399  
susinidum_coc                    0.143  
susinidum_pbc                    0.302  
susinidum_mar                       NA  
psycom_dum_with                  0.221  
psycom_dum_study                 0.022 *
freq_cons_dum_5day               0.326  
cond_oc_dum_2inact               0.638  
cond_oc_dum_3unemp               0.197  
susprindum_oh                    0.859  
susprindum_coc                   0.900  
susprindum_pbc                   0.056 .
susprindum_mar                      NA  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                     1.023      0.978     0.745      1.40
ano_nac_corr                      1.047      0.955     0.781      1.40
susinidum_oh                      0.795      1.257     0.467      1.35
susinidum_coc                     2.350      0.426     0.749      7.37
susinidum_pbc                     0.502      1.992     0.136      1.86
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                   1.443      0.693     0.803      2.59
psycom_dum_study                  3.072      0.326     1.177      8.01
freq_cons_dum_5day                1.329      0.752     0.754      2.34
cond_oc_dum_2inact                1.188      0.842     0.580      2.43
cond_oc_dum_3unemp                1.605      0.623     0.782      3.29
susprindum_oh                     0.922      1.085     0.375      2.26
susprindum_coc                    0.937      1.068     0.339      2.59
susprindum_pbc                    0.499      2.002     0.245      1.02
susprindum_mar                       NA         NA        NA        NA

Concordance= 0.634  (se = 0.034 )
Likelihood ratio test= 13.9  on 13 df,   p=0.4
Wald test            = 23.4  on 13 df,   p=0.04
Score (logrank) test = 14.5  on 13 df,   p=0.3,   Robust = 16.6  p=0.2

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.198   0.615   0.804   0.936   1.277   2.215 
[1] "Modality: basic ambulatory\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 77, number of events= 77 
   (76 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome.lag                 1.31e+00  3.70e+00  1.22e+00  5.87e-01   2.23
less_90d_tr1.lag                     NA        NA  0.00e+00  0.00e+00     NA
log_dias_treat_imp_sin_na.lag        NA        NA  0.00e+00  0.00e+00     NA
comp_bpsc_y3_severe.lag              NA        NA  0.00e+00  0.00e+00     NA
policonsumo2.lag                     NA        NA  0.00e+00  0.00e+00     NA
edad_al_ing_1                 -8.12e-02  9.22e-01  1.57e-01  1.39e-01  -0.58
ano_nac_corr                  -1.72e-01  8.42e-01  1.59e-01  1.40e-01  -1.23
susinidum_oh                  -6.05e-01  5.46e-01  6.92e-01  4.73e-01  -1.28
susinidum_coc                 -8.26e-02  9.21e-01  1.05e+00  6.08e-01  -0.14
susinidum_pbc                 -1.81e+00  1.64e-01  8.99e-01  6.97e-01  -2.59
susinidum_mar                 -8.53e-01  4.26e-01  7.36e-01  5.27e-01  -1.62
psycom_dum_with               -3.47e-01  7.07e-01  3.23e-01  2.73e-01  -1.27
psycom_dum_study              -6.93e-01  5.00e-01  3.65e-01  3.41e-01  -2.03
freq_cons_dum_5day            -2.08e-01  8.12e-01  3.02e-01  2.87e-01  -0.73
cond_oc_dum_2inact             7.39e-01  2.09e+00  4.50e-01  4.40e-01   1.68
cond_oc_dum_3unemp             4.68e-01  1.60e+00  3.39e-01  3.44e-01   1.36
susprindum_oh                 -2.10e+01  7.35e-10  3.08e+03  6.52e-01 -32.26
susprindum_coc                -2.08e+01  9.01e-10  3.08e+03  5.09e-01 -40.94
susprindum_pbc                -1.95e+01  3.43e-09  3.08e+03  5.67e-01 -34.39
susprindum_mar                -2.06e+01  1.17e-09  3.08e+03  6.89e-01 -29.86
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.0258 *  
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag       NA    
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                   0.5597    
ano_nac_corr                    0.2186    
susinidum_oh                    0.2008    
susinidum_coc                   0.8919    
susinidum_pbc                   0.0095 ** 
susinidum_mar                   0.1056    
psycom_dum_with                 0.2028    
psycom_dum_study                0.0423 *  
freq_cons_dum_5day              0.4680    
cond_oc_dum_2inact              0.0926 .  
cond_oc_dum_3unemp              0.1732    
susprindum_oh                   &lt;2e-16 ***
susprindum_coc                  &lt;2e-16 ***
susprindum_pbc                  &lt;2e-16 ***
susprindum_mar                  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                 3.70e+00   2.70e-01  1.17e+00  1.17e+01
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                  9.22e-01   1.08e+00  7.02e-01  1.21e+00
ano_nac_corr                   8.42e-01   1.19e+00  6.41e-01  1.11e+00
susinidum_oh                   5.46e-01   1.83e+00  2.16e-01  1.38e+00
susinidum_coc                  9.21e-01   1.09e+00  2.80e-01  3.03e+00
susinidum_pbc                  1.64e-01   6.11e+00  4.17e-02  6.43e-01
susinidum_mar                  4.26e-01   2.35e+00  1.52e-01  1.20e+00
psycom_dum_with                7.07e-01   1.41e+00  4.14e-01  1.21e+00
psycom_dum_study               5.00e-01   2.00e+00  2.56e-01  9.76e-01
freq_cons_dum_5day             8.12e-01   1.23e+00  4.63e-01  1.42e+00
cond_oc_dum_2inact             2.09e+00   4.77e-01  8.85e-01  4.96e+00
cond_oc_dum_3unemp             1.60e+00   6.26e-01  8.14e-01  3.13e+00
susprindum_oh                  7.35e-10   1.36e+09  2.05e-10  2.64e-09
susprindum_coc                 9.01e-10   1.11e+09  3.33e-10  2.44e-09
susprindum_pbc                 3.43e-09   2.91e+08  1.13e-09  1.04e-08
susprindum_mar                 1.17e-09   8.58e+08  3.02e-10  4.50e-09

Concordance= 0.731  (se = 0.03 )
Likelihood ratio test= 44.5  on 16 df,   p=2e-04
Wald test            = 16181  on 16 df,   p=&lt;2e-16
Score (logrank) test = 111  on 16 df,   p=2e-16,   Robust = 37.4  p=0.002

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.00e+00 1.97e+08 3.29e+08 5.05e+08 7.07e+08 1.97e+09 
[1] "Modality: GP residential\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 44, number of events= 44 
   (44 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                     NA        NA   0.0000    0.0000    NA
less_90d_tr1.lag                   NA        NA   0.0000    0.0000    NA
log_dias_treat_imp_sin_na.lag      NA        NA   0.0000    0.0000    NA
comp_bpsc_y3_severe.lag            NA        NA   0.0000    0.0000    NA
policonsumo2.lag                   NA        NA   0.0000    0.0000    NA
edad_al_ing_1                 -0.0941    0.9102   0.2559    0.2579 -0.36
ano_nac_corr                  -0.1054    0.9000   0.2603    0.2672 -0.39
susinidum_oh                  -1.3805    0.2515   1.1947    0.7912 -1.74
susinidum_coc                 -2.3484    0.0955   1.7688    1.0683 -2.20
susinidum_pbc                 -1.7372    0.1760   1.2633    0.9136 -1.90
susinidum_mar                 -1.7400    0.1755   1.2540    0.9334 -1.86
psycom_dum_with               -0.5855    0.5568   0.4569    0.4924 -1.19
psycom_dum_study              -0.5570    0.5729   0.7513    0.6086 -0.92
freq_cons_dum_5day             0.2100    1.2337   0.4609    0.4900  0.43
cond_oc_dum_2inact             1.6085    4.9952   0.8868    0.6243  2.58
cond_oc_dum_3unemp             0.6958    2.0053   0.6945    0.7280  0.96
susprindum_oh                 -3.2052    0.0406   1.4883    1.2502 -2.56
susprindum_coc                -2.1759    0.1135   1.4852    1.1353 -1.92
susprindum_pbc                -2.7616    0.0632   1.2925    0.9600 -2.88
susprindum_mar                     NA        NA   0.0000    0.0000    NA
                              Pr(&gt;|z|)   
tr_outcome.lag                      NA   
less_90d_tr1.lag                    NA   
log_dias_treat_imp_sin_na.lag       NA   
comp_bpsc_y3_severe.lag             NA   
policonsumo2.lag                    NA   
edad_al_ing_1                    0.715   
ano_nac_corr                     0.693   
susinidum_oh                     0.081 . 
susinidum_coc                    0.028 * 
susinidum_pbc                    0.057 . 
susinidum_mar                    0.062 . 
psycom_dum_with                  0.234   
psycom_dum_study                 0.360   
freq_cons_dum_5day               0.668   
cond_oc_dum_2inact               0.010 **
cond_oc_dum_3unemp               0.339   
susprindum_oh                    0.010 * 
susprindum_coc                   0.055 . 
susprindum_pbc                   0.004 **
susprindum_mar                      NA   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                    0.9102      1.099   0.54904     1.509
ano_nac_corr                     0.9000      1.111   0.53305     1.520
susinidum_oh                     0.2515      3.977   0.05333     1.186
susinidum_coc                    0.0955     10.469   0.01177     0.775
susinidum_pbc                    0.1760      5.682   0.02937     1.055
susinidum_mar                    0.1755      5.697   0.02817     1.094
psycom_dum_with                  0.5568      1.796   0.21212     1.462
psycom_dum_study                 0.5729      1.745   0.17380     1.889
freq_cons_dum_5day               1.2337      0.811   0.47219     3.223
cond_oc_dum_2inact               4.9952      0.200   1.46948    16.980
cond_oc_dum_3unemp               2.0053      0.499   0.48140     8.353
susprindum_oh                    0.0406     24.660   0.00350     0.470
susprindum_coc                   0.1135      8.810   0.01227     1.050
susprindum_pbc                   0.0632     15.825   0.00963     0.415
susprindum_mar                       NA         NA        NA        NA

Concordance= 0.62  (se = 0.051 )
Likelihood ratio test= 12.3  on 14 df,   p=0.6
Wald test            = 38.5  on 14 df,   p=4e-04
Score (logrank) test = 20  on 14 df,   p=0.1,   Robust = 11.2  p=0.7

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    2.6    34.2    48.9    52.1    70.7    99.9 
[1] "Modality: WO intensive ambulatory\nTime interval: (88,93]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 10, number of events= 10 
   (10 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se      z
tr_outcome.lag                       NA        NA  0.00e+00  0.00e+00     NA
less_90d_tr1.lag                     NA        NA  0.00e+00  0.00e+00     NA
log_dias_treat_imp_sin_na.lag        NA        NA  0.00e+00  0.00e+00     NA
comp_bpsc_y3_severe.lag              NA        NA  0.00e+00  0.00e+00     NA
policonsumo2.lag                     NA        NA  0.00e+00  0.00e+00     NA
edad_al_ing_1                 -5.34e+01  6.69e-24  6.64e+03  1.45e+00 -36.92
ano_nac_corr                  -4.99e+01  2.05e-22  5.79e+03  1.40e+00 -35.58
susinidum_oh                   5.70e+00  2.99e+02  1.73e+03  1.07e+00   5.31
susinidum_coc                        NA        NA  0.00e+00  0.00e+00     NA
susinidum_pbc                  5.46e+01  5.41e+23  1.65e+04  3.47e+00  15.75
susinidum_mar                        NA        NA  0.00e+00  0.00e+00     NA
psycom_dum_with                2.74e+01  8.14e+11  4.34e+03  1.45e+00  18.95
psycom_dum_study                     NA        NA  0.00e+00  0.00e+00     NA
freq_cons_dum_5day            -1.48e+02  6.27e-65  1.42e+04  3.58e+00 -41.25
cond_oc_dum_2inact            -4.10e+01  1.49e-18  8.48e+03  2.02e+00 -20.30
cond_oc_dum_3unemp                   NA        NA  0.00e+00  0.00e+00     NA
susprindum_oh                  7.39e+01  1.23e+32  6.98e+03  3.27e+00  22.57
susprindum_coc                 1.39e+02  1.89e+60  6.56e+03  3.67e+00  37.84
susprindum_pbc                       NA        NA  0.00e+00  0.00e+00     NA
susprindum_mar                       NA        NA  0.00e+00  0.00e+00     NA
                              Pr(&gt;|z|)    
tr_outcome.lag                      NA    
less_90d_tr1.lag                    NA    
log_dias_treat_imp_sin_na.lag       NA    
comp_bpsc_y3_severe.lag             NA    
policonsumo2.lag                    NA    
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                   1.1e-07 ***
susinidum_coc                       NA    
susinidum_pbc                  &lt; 2e-16 ***
susinidum_mar                       NA    
psycom_dum_with                &lt; 2e-16 ***
psycom_dum_study                    NA    
freq_cons_dum_5day             &lt; 2e-16 ***
cond_oc_dum_2inact             &lt; 2e-16 ***
cond_oc_dum_3unemp                  NA    
susprindum_oh                  &lt; 2e-16 ***
susprindum_coc                 &lt; 2e-16 ***
susprindum_pbc                      NA    
susprindum_mar                      NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                       NA         NA        NA        NA
less_90d_tr1.lag                     NA         NA        NA        NA
log_dias_treat_imp_sin_na.lag        NA         NA        NA        NA
comp_bpsc_y3_severe.lag              NA         NA        NA        NA
policonsumo2.lag                     NA         NA        NA        NA
edad_al_ing_1                  6.69e-24   1.50e+23  3.94e-25  1.14e-22
ano_nac_corr                   2.05e-22   4.87e+21  1.31e-23  3.21e-21
susinidum_oh                   2.99e+02   3.34e-03  3.64e+01  2.45e+03
susinidum_coc                        NA         NA        NA        NA
susinidum_pbc                  5.41e+23   1.85e-24  6.03e+20  4.86e+26
susinidum_mar                        NA         NA        NA        NA
psycom_dum_with                8.14e+11   1.23e-12  4.77e+10  1.39e+13
psycom_dum_study                     NA         NA        NA        NA
freq_cons_dum_5day             6.27e-65   1.59e+64  5.58e-68  7.05e-62
cond_oc_dum_2inact             1.49e-18   6.70e+17  2.84e-20  7.85e-17
cond_oc_dum_3unemp                   NA         NA        NA        NA
susprindum_oh                  1.23e+32   8.13e-33  2.01e+29  7.53e+34
susprindum_coc                 1.89e+60   5.28e-61  1.43e+57  2.51e+63
susprindum_pbc                       NA         NA        NA        NA
susprindum_mar                       NA         NA        NA        NA

Concordance= 1  (se = 0 )
Likelihood ratio test= 30.2  on 9 df,   p=4e-04
Wald test            = 1857  on 9 df,   p=&lt;2e-16
Score (logrank) test = 21.2  on 9 df,   p=0.01,   Robust = 9.99  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.00e+00 0.00e+00 8.00e+01 1.71e+24 2.95e+13 1.71e+25 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning messages:</span></span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1: In Surv(time.lag, time, event) :</span></span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   Stop time must be &gt; start time, NA created</span></span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2: In Surv(time.lag, time, event) :</span></span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   Stop time must be &gt; start time, NA created</span></span>
<span id="cb503-6"><a href="#cb503-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3: In Surv(time.lag, time, event) :</span></span>
<span id="cb503-7"><a href="#cb503-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   Stop time must be &gt; start time, NA created</span></span>
<span id="cb503-8"><a href="#cb503-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 4: In Surv(time.lag, time, event) :</span></span>
<span id="cb503-9"><a href="#cb503-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   Stop time must be &gt; start time, NA created</span></span>
<span id="cb503-10"><a href="#cb503-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 5: In Surv(time.lag, time, event) :</span></span>
<span id="cb503-11"><a href="#cb503-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   Stop time must be &gt; start time, NA created</span></span>
<span id="cb503-12"><a href="#cb503-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 6: In agreg.fit(X, Y, istrat, offset, init, control, weights = weights,  :</span></span>
<span id="cb503-13"><a href="#cb503-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   Loglik converged before variable  1,2,3,4,5 ; beta may be infinite. </span></span>
<span id="cb503-14"><a href="#cb503-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 7: In agreg.fit(X, Y, istrat, offset, init, control, weights = weights,  :</span></span>
<span id="cb503-15"><a href="#cb503-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   Ran out of iterations and did not converge</span></span>
<span id="cb503-16"><a href="#cb503-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 8: In agreg.fit(X, Y, istrat, offset, init, control, weights = weights,  :</span></span>
<span id="cb503-17"><a href="#cb503-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   Loglik converged before variable  17,18,19,20 ; beta may be infinite. </span></span>
<span id="cb503-18"><a href="#cb503-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 9: In agreg.fit(X, Y, istrat, offset, init, control, weights = weights,  :</span></span>
<span id="cb503-19"><a href="#cb503-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   Ran out of iterations and did not converge</span></span>
<span id="cb503-20"><a href="#cb503-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-21"><a href="#cb503-21" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb503-22"><a href="#cb503-22" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb503-23"><a href="#cb503-23" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb503-24"><a href="#cb503-24" aria-hidden="true" tabindex="-1"></a>iiws_strat_alt <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb503-25"><a href="#cb503-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-26"><a href="#cb503-26" aria-hidden="true" tabindex="-1"></a>comb_strata_alt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod), </span>
<span id="cb503-27"><a href="#cb503-27" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3_alt))</span>
<span id="cb503-28"><a href="#cb503-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-29"><a href="#cb503-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ff <span class="cf">in</span> <span class="fu">seq_along</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comb_strata_alt))) {</span>
<span id="cb503-30"><a href="#cb503-30" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span> comb_strata_alt[ff,<span class="st">"Var1"</span>]</span>
<span id="cb503-31"><a href="#cb503-31" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span> comb_strata_alt[ff,<span class="st">"Var2"</span>]</span>
<span id="cb503-32"><a href="#cb503-32" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_proc2_subset<span class="ot">&lt;-</span></span>
<span id="cb503-33"><a href="#cb503-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(data_mine_miss_restr_proc2, <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span>i <span class="sc">&amp;</span> time_interval3_alt<span class="sc">==</span>j)</span>
<span id="cb503-34"><a href="#cb503-34" aria-hidden="true" tabindex="-1"></a>  maxfu_df_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span> maxfu.id <span class="sc">%in%</span> <span class="fu">unique</span>(data_mine_miss_proc2_subset<span class="sc">$</span>id))  </span>
<span id="cb503-35"><a href="#cb503-35" aria-hidden="true" tabindex="-1"></a>  iiw_model_strat_alt<span class="ot">&lt;-</span></span>
<span id="cb503-36"><a href="#cb503-36" aria-hidden="true" tabindex="-1"></a>    IrregLong<span class="sc">::</span><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb503-37"><a href="#cb503-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="co">#If a frailty model is used, the cluster(id) term should appear before other covariates</span></span>
<span id="cb503-38"><a href="#cb503-38" aria-hidden="true" tabindex="-1"></a>          tr_outcome.lag<span class="sc">+</span></span>
<span id="cb503-39"><a href="#cb503-39" aria-hidden="true" tabindex="-1"></a>          less_90d_tr1.lag<span class="sc">+</span></span>
<span id="cb503-40"><a href="#cb503-40" aria-hidden="true" tabindex="-1"></a>          log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb503-41"><a href="#cb503-41" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe.lag<span class="sc">+</span></span>
<span id="cb503-42"><a href="#cb503-42" aria-hidden="true" tabindex="-1"></a>          policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb503-43"><a href="#cb503-43" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb503-44"><a href="#cb503-44" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr <span class="sc">+</span> </span>
<span id="cb503-45"><a href="#cb503-45" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb503-46"><a href="#cb503-46" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb503-47"><a href="#cb503-47" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb503-48"><a href="#cb503-48" aria-hidden="true" tabindex="-1"></a>          susinidum_mar <span class="sc">+</span></span>
<span id="cb503-49"><a href="#cb503-49" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with <span class="sc">+</span></span>
<span id="cb503-50"><a href="#cb503-50" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study <span class="sc">+</span> </span>
<span id="cb503-51"><a href="#cb503-51" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb503-52"><a href="#cb503-52" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb503-53"><a href="#cb503-53" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb503-54"><a href="#cb503-54" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb503-55"><a href="#cb503-55" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb503-56"><a href="#cb503-56" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb503-57"><a href="#cb503-57" aria-hidden="true" tabindex="-1"></a>          susprindum_mar, </span>
<span id="cb503-58"><a href="#cb503-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc2_subset,</span>
<span id="cb503-59"><a href="#cb503-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb503-60"><a href="#cb503-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb503-61"><a href="#cb503-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb503-62"><a href="#cb503-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df_subset,</span>
<span id="cb503-63"><a href="#cb503-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with"</span>, <span class="st">"psycom_dum_study_rec2"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb503-64"><a href="#cb503-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>,<span class="st">"log_dias_treat_imp_sin_na"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb503-65"><a href="#cb503-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">0</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb503-66"><a href="#cb503-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T</span>
<span id="cb503-67"><a href="#cb503-67" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb503-68"><a href="#cb503-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb503-69"><a href="#cb503-69" aria-hidden="true" tabindex="-1"></a>  iiws_strat_alt[[ff]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb503-70"><a href="#cb503-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> iiw_model_strat_alt,</span>
<span id="cb503-71"><a href="#cb503-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">comb =</span> <span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j,<span class="st">"."</span>),</span>
<span id="cb503-72"><a href="#cb503-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">cox_iiw =</span> <span class="fu">summary</span>(iiw_model_strat_alt<span class="sc">$</span>m),</span>
<span id="cb503-73"><a href="#cb503-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">iiw =</span> <span class="fu">summary</span>(iiw_model_strat_alt<span class="sc">$</span>iiw)</span>
<span id="cb503-74"><a href="#cb503-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb503-75"><a href="#cb503-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j))</span>
<span id="cb503-76"><a href="#cb503-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat_alt<span class="sc">$</span>m))</span>
<span id="cb503-77"><a href="#cb503-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat_alt<span class="sc">$</span>iiw))</span>
<span id="cb503-78"><a href="#cb503-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-79"><a href="#cb503-79" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Modality: WO residential\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 613, number of events= 613 
   (1197 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.2763    0.7586   0.2286    0.1902 -1.45
less_90d_tr1.lag              -0.0115    0.9886   0.2375    0.2083 -0.06
log_dias_treat_imp_sin_na.lag -0.2477    0.7806   0.0793    0.0698 -3.55
comp_bpsc_y3_severe.lag        0.3801    1.4625   0.1943    0.1801  2.11
policonsumo2.lag              -0.2659    0.7665   0.1877    0.1779 -1.49
edad_al_ing_1                 -0.0252    0.9751   0.0169    0.0164 -1.54
ano_nac_corr                  -0.0215    0.9788   0.0163    0.0159 -1.35
susinidum_oh                  -0.0912    0.9128   0.2942    0.2869 -0.32
susinidum_coc                 -0.4372    0.6459   0.3413    0.3259 -1.34
susinidum_pbc                  0.2467    1.2797   0.3006    0.3001  0.82
susinidum_mar                  0.1396    1.1498   0.2900    0.2825  0.49
psycom_dum_with               -0.2291    0.7952   0.1183    0.1149 -1.99
psycom_dum_study              -0.0545    0.9469   0.1764    0.1707 -0.32
freq_cons_dum_5day             0.0366    1.0372   0.0990    0.0965  0.38
cond_oc_dum_2inact             0.1879    1.2068   0.1541    0.1460  1.29
cond_oc_dum_3unemp             0.1970    1.2177   0.1536    0.1476  1.33
susprindum_oh                  0.4527    1.5725   0.2877    0.2560  1.77
susprindum_coc                 0.5399    1.7158   0.2897    0.2441  2.21
susprindum_pbc                 0.4500    1.5683   0.2700    0.2291  1.96
susprindum_mar                 0.5777    1.7820   0.4281    0.4151  1.39
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.14636    
less_90d_tr1.lag               0.95610    
log_dias_treat_imp_sin_na.lag  0.00039 ***
comp_bpsc_y3_severe.lag        0.03478 *  
policonsumo2.lag               0.13504    
edad_al_ing_1                  0.12342    
ano_nac_corr                   0.17773    
susinidum_oh                   0.75058    
susinidum_coc                  0.17976    
susinidum_pbc                  0.41111    
susinidum_mar                  0.62121    
psycom_dum_with                0.04608 *  
psycom_dum_study               0.74937    
freq_cons_dum_5day             0.70495    
cond_oc_dum_2inact             0.19799    
cond_oc_dum_3unemp             0.18196    
susprindum_oh                  0.07699 .  
susprindum_coc                 0.02700 *  
susprindum_pbc                 0.04950 *  
susprindum_mar                 0.16393    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.759      1.318     0.522     1.101
less_90d_tr1.lag                  0.989      1.012     0.657     1.487
log_dias_treat_imp_sin_na.lag     0.781      1.281     0.681     0.895
comp_bpsc_y3_severe.lag           1.462      0.684     1.028     2.082
policonsumo2.lag                  0.766      1.305     0.541     1.086
edad_al_ing_1                     0.975      1.026     0.944     1.007
ano_nac_corr                      0.979      1.022     0.949     1.010
susinidum_oh                      0.913      1.095     0.520     1.602
susinidum_coc                     0.646      1.548     0.341     1.223
susinidum_pbc                     1.280      0.781     0.711     2.304
susinidum_mar                     1.150      0.870     0.661     2.000
psycom_dum_with                   0.795      1.257     0.635     0.996
psycom_dum_study                  0.947      1.056     0.678     1.323
freq_cons_dum_5day                1.037      0.964     0.858     1.253
cond_oc_dum_2inact                1.207      0.829     0.906     1.607
cond_oc_dum_3unemp                1.218      0.821     0.912     1.626
susprindum_oh                     1.573      0.636     0.952     2.597
susprindum_coc                    1.716      0.583     1.063     2.769
susprindum_pbc                    1.568      0.638     1.001     2.457
susprindum_mar                    1.782      0.561     0.790     4.020

Concordance= 0.608  (se = 0.012 )
Likelihood ratio test= 72.3  on 20 df,   p=8e-08
Wald test            = 87  on 20 df,   p=2e-10
Score (logrank) test = 67.8  on 20 df,   p=4e-07,   Robust = 76.9  p=1e-08

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.262   0.437   0.516   0.595   0.664   2.194 
[1] "Modality: GP intensive ambulatory\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 3052, number of events= 3052 
   (5099 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.54850   0.57781  0.12658   0.11161 -4.91
less_90d_tr1.lag              -0.17418   0.84015  0.10418   0.08989 -1.94
log_dias_treat_imp_sin_na.lag -0.02676   0.97359  0.03060   0.02464 -1.09
comp_bpsc_y3_severe.lag        0.11310   1.11975  0.09735   0.08271  1.37
policonsumo2.lag              -0.17858   0.83646  0.11209   0.09112 -1.96
edad_al_ing_1                  0.01697   1.01712  0.00806   0.00839  2.02
ano_nac_corr                   0.02121   1.02144  0.00792   0.00832  2.55
susinidum_oh                   0.00619   1.00621  0.13394   0.12706  0.05
susinidum_coc                  0.05436   1.05587  0.15881   0.15167  0.36
susinidum_pbc                  0.22952   1.25800  0.14861   0.14520  1.58
susinidum_mar                  0.06074   1.06262  0.13516   0.12913  0.47
psycom_dum_with               -0.06635   0.93580  0.03944   0.04029 -1.65
psycom_dum_study               0.49221   1.63593  0.06861   0.07433  6.62
freq_cons_dum_5day             0.06258   1.06458  0.03765   0.03859  1.62
cond_oc_dum_2inact             0.01356   1.01365  0.05712   0.05738  0.24
cond_oc_dum_3unemp             0.02065   1.02086  0.04043   0.04053  0.51
susprindum_oh                  0.13495   1.14448  0.18044   0.18571  0.73
susprindum_coc                 0.10853   1.11463  0.18058   0.18762  0.58
susprindum_pbc                 0.18824   1.20712  0.17630   0.18498  1.02
susprindum_mar                 0.11757   1.12476  0.19016   0.20048  0.59
                              Pr(&gt;|z|)    
tr_outcome.lag                 8.9e-07 ***
less_90d_tr1.lag                 0.053 .  
log_dias_treat_imp_sin_na.lag    0.277    
comp_bpsc_y3_severe.lag          0.171    
policonsumo2.lag                 0.050 .  
edad_al_ing_1                    0.043 *  
ano_nac_corr                     0.011 *  
susinidum_oh                     0.961    
susinidum_coc                    0.720    
susinidum_pbc                    0.114    
susinidum_mar                    0.638    
psycom_dum_with                  0.100 .  
psycom_dum_study               3.6e-11 ***
freq_cons_dum_5day               0.105    
cond_oc_dum_2inact               0.813    
cond_oc_dum_3unemp               0.610    
susprindum_oh                    0.467    
susprindum_coc                   0.563    
susprindum_pbc                   0.309    
susprindum_mar                   0.558    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.578      1.731     0.464     0.719
less_90d_tr1.lag                  0.840      1.190     0.704     1.002
log_dias_treat_imp_sin_na.lag     0.974      1.027     0.928     1.022
comp_bpsc_y3_severe.lag           1.120      0.893     0.952     1.317
policonsumo2.lag                  0.836      1.196     0.700     1.000
edad_al_ing_1                     1.017      0.983     1.001     1.034
ano_nac_corr                      1.021      0.979     1.005     1.038
susinidum_oh                      1.006      0.994     0.784     1.291
susinidum_coc                     1.056      0.947     0.784     1.421
susinidum_pbc                     1.258      0.795     0.946     1.672
susinidum_mar                     1.063      0.941     0.825     1.369
psycom_dum_with                   0.936      1.069     0.865     1.013
psycom_dum_study                  1.636      0.611     1.414     1.893
freq_cons_dum_5day                1.065      0.939     0.987     1.148
cond_oc_dum_2inact                1.014      0.987     0.906     1.134
cond_oc_dum_3unemp                1.021      0.980     0.943     1.105
susprindum_oh                     1.144      0.874     0.795     1.647
susprindum_coc                    1.115      0.897     0.772     1.610
susprindum_pbc                    1.207      0.828     0.840     1.735
susprindum_mar                    1.125      0.889     0.759     1.666

Concordance= 0.592  (se = 0.006 )
Likelihood ratio test= 207  on 20 df,   p=&lt;2e-16
Wald test            = 210  on 20 df,   p=&lt;2e-16
Score (logrank) test = 192  on 20 df,   p=&lt;2e-16,   Robust = 186  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.334   0.660   0.799   0.801   0.886   2.476 
[1] "Modality: basic ambulatory\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2876, number of events= 2876 
   (4323 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.49603   0.60894  0.13196   0.14634 -3.39
less_90d_tr1.lag              -0.07117   0.93130  0.11746   0.10758 -0.66
log_dias_treat_imp_sin_na.lag -0.09772   0.90691  0.03669   0.04837 -2.02
comp_bpsc_y3_severe.lag        0.09989   1.10505  0.14866   0.12281  0.81
policonsumo2.lag              -0.22168   0.80117  0.11743   0.10716 -2.07
edad_al_ing_1                  0.04360   1.04456  0.00877   0.00930  4.69
ano_nac_corr                   0.05061   1.05191  0.00855   0.00919  5.51
susinidum_oh                   0.18366   1.20161  0.14648   0.20612  0.89
susinidum_coc                  0.36574   1.44158  0.16677   0.22316  1.64
susinidum_pbc                  0.26939   1.30917  0.16351   0.21714  1.24
susinidum_mar                  0.28065   1.32399  0.14722   0.20772  1.35
psycom_dum_with               -0.05230   0.94904  0.04144   0.04240 -1.23
psycom_dum_study               0.54576   1.72591  0.06099   0.06806  8.02
freq_cons_dum_5day             0.07322   1.07597  0.04307   0.04502  1.63
cond_oc_dum_2inact             0.09844   1.10345  0.06205   0.06203  1.59
cond_oc_dum_3unemp             0.04895   1.05017  0.04549   0.04765  1.03
susprindum_oh                  0.46466   1.59147  0.22518   0.21199  2.19
susprindum_coc                 0.55034   1.73384  0.22608   0.21374  2.57
susprindum_pbc                 0.48029   1.61655  0.22343   0.21187  2.27
susprindum_mar                 0.42294   1.52644  0.23245   0.21795  1.94
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.0007 ***
less_90d_tr1.lag                0.5083    
log_dias_treat_imp_sin_na.lag   0.0434 *  
comp_bpsc_y3_severe.lag         0.4160    
policonsumo2.lag                0.0386 *  
edad_al_ing_1                  2.8e-06 ***
ano_nac_corr                   3.6e-08 ***
susinidum_oh                    0.3729    
susinidum_coc                   0.1012    
susinidum_pbc                   0.2147    
susinidum_mar                   0.1767    
psycom_dum_with                 0.2174    
psycom_dum_study               1.1e-15 ***
freq_cons_dum_5day              0.1039    
cond_oc_dum_2inact              0.1125    
cond_oc_dum_3unemp              0.3043    
susprindum_oh                   0.0284 *  
susprindum_coc                  0.0100 *  
susprindum_pbc                  0.0234 *  
susprindum_mar                  0.0523 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.609      1.642     0.457     0.811
less_90d_tr1.lag                  0.931      1.074     0.754     1.150
log_dias_treat_imp_sin_na.lag     0.907      1.103     0.825     0.997
comp_bpsc_y3_severe.lag           1.105      0.905     0.869     1.406
policonsumo2.lag                  0.801      1.248     0.649     0.988
edad_al_ing_1                     1.045      0.957     1.026     1.064
ano_nac_corr                      1.052      0.951     1.033     1.071
susinidum_oh                      1.202      0.832     0.802     1.800
susinidum_coc                     1.442      0.694     0.931     2.233
susinidum_pbc                     1.309      0.764     0.855     2.004
susinidum_mar                     1.324      0.755     0.881     1.989
psycom_dum_with                   0.949      1.054     0.873     1.031
psycom_dum_study                  1.726      0.579     1.510     1.972
freq_cons_dum_5day                1.076      0.929     0.985     1.175
cond_oc_dum_2inact                1.103      0.906     0.977     1.246
cond_oc_dum_3unemp                1.050      0.952     0.957     1.153
susprindum_oh                     1.591      0.628     1.050     2.411
susprindum_coc                    1.734      0.577     1.140     2.636
susprindum_pbc                    1.617      0.619     1.067     2.449
susprindum_mar                    1.526      0.655     0.996     2.340

Concordance= 0.602  (se = 0.006 )
Likelihood ratio test= 253  on 20 df,   p=&lt;2e-16
Wald test            = 242  on 20 df,   p=&lt;2e-16
Score (logrank) test = 238  on 20 df,   p=&lt;2e-16,   Robust = 223  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.153   0.362   0.456   0.468   0.526   1.746 
[1] "Modality: GP residential\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1378, number of events= 1378 
   (2346 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.02212   0.97812  0.18230   0.14719 -0.15
less_90d_tr1.lag              -0.12076   0.88624  0.14750   0.10850 -1.11
log_dias_treat_imp_sin_na.lag -0.08004   0.92308  0.04426   0.03298 -2.43
comp_bpsc_y3_severe.lag        0.00436   1.00437  0.13899   0.10793  0.04
policonsumo2.lag              -0.22270   0.80035  0.15110   0.12180 -1.83
edad_al_ing_1                  0.01512   1.01523  0.01204   0.01148  1.32
ano_nac_corr                   0.02049   1.02070  0.01183   0.01162  1.76
susinidum_oh                   0.36059   1.43418  0.21840   0.19332  1.87
susinidum_coc                  0.34462   1.41145  0.25671   0.23968  1.44
susinidum_pbc                  0.33183   1.39352  0.23049   0.20635  1.61
susinidum_mar                  0.40104   1.49338  0.21946   0.19405  2.07
psycom_dum_with               -0.07960   0.92349  0.06169   0.06166 -1.29
psycom_dum_study               0.24325   1.27539  0.10323   0.09260  2.63
freq_cons_dum_5day             0.15988   1.17337  0.06363   0.06289  2.54
cond_oc_dum_2inact             0.01093   1.01099  0.10212   0.10164  0.11
cond_oc_dum_3unemp            -0.01225   0.98782  0.08671   0.08836 -0.14
susprindum_oh                  0.23921   1.27025  0.29055   0.17108  1.40
susprindum_coc                 0.16471   1.17905  0.29258   0.17489  0.94
susprindum_pbc                 0.30173   1.35220  0.28413   0.16397  1.84
susprindum_mar                 0.20262   1.22461  0.33503   0.22717  0.89
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.8805   
less_90d_tr1.lag                0.2657   
log_dias_treat_imp_sin_na.lag   0.0152 * 
comp_bpsc_y3_severe.lag         0.9677   
policonsumo2.lag                0.0675 . 
edad_al_ing_1                   0.1880   
ano_nac_corr                    0.0779 . 
susinidum_oh                    0.0621 . 
susinidum_coc                   0.1505   
susinidum_pbc                   0.1078   
susinidum_mar                   0.0388 * 
psycom_dum_with                 0.1967   
psycom_dum_study                0.0086 **
freq_cons_dum_5day              0.0110 * 
cond_oc_dum_2inact              0.9144   
cond_oc_dum_3unemp              0.8897   
susprindum_oh                   0.1620   
susprindum_coc                  0.3463   
susprindum_pbc                  0.0657 . 
susprindum_mar                  0.3724   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.978      1.022     0.733     1.305
less_90d_tr1.lag                  0.886      1.128     0.716     1.096
log_dias_treat_imp_sin_na.lag     0.923      1.083     0.865     0.985
comp_bpsc_y3_severe.lag           1.004      0.996     0.813     1.241
policonsumo2.lag                  0.800      1.249     0.630     1.016
edad_al_ing_1                     1.015      0.985     0.993     1.038
ano_nac_corr                      1.021      0.980     0.998     1.044
susinidum_oh                      1.434      0.697     0.982     2.095
susinidum_coc                     1.411      0.708     0.882     2.258
susinidum_pbc                     1.394      0.718     0.930     2.088
susinidum_mar                     1.493      0.670     1.021     2.184
psycom_dum_with                   0.923      1.083     0.818     1.042
psycom_dum_study                  1.275      0.784     1.064     1.529
freq_cons_dum_5day                1.173      0.852     1.037     1.327
cond_oc_dum_2inact                1.011      0.989     0.828     1.234
cond_oc_dum_3unemp                0.988      1.012     0.831     1.175
susprindum_oh                     1.270      0.787     0.908     1.776
susprindum_coc                    1.179      0.848     0.837     1.661
susprindum_pbc                    1.352      0.740     0.981     1.865
susprindum_mar                    1.225      0.817     0.785     1.911

Concordance= 0.579  (se = 0.009 )
Likelihood ratio test= 56.6  on 20 df,   p=2e-05
Wald test            = 77.2  on 20 df,   p=1e-08
Score (logrank) test = 54.3  on 20 df,   p=5e-05,   Robust = 66.7  p=6e-07

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.190   0.415   0.467   0.486   0.533   1.217 
[1] "Modality: WO intensive ambulatory\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 439, number of events= 439 
   (710 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -1.3012    0.2722   0.6078    0.2630 -4.95
less_90d_tr1.lag               0.2431    1.2752   0.3248    0.2038  1.19
log_dias_treat_imp_sin_na.lag  0.0482    1.0494   0.1964    0.0726  0.66
comp_bpsc_y3_severe.lag       -0.1749    0.8395   0.2902    0.2065 -0.85
policonsumo2.lag               0.4071    1.5024   0.3289    0.2066  1.97
edad_al_ing_1                  0.0314    1.0319   0.0239    0.0235  1.34
ano_nac_corr                   0.0300    1.0304   0.0237    0.0237  1.26
susinidum_oh                  -0.0748    0.9280   0.3364    0.4122 -0.18
susinidum_coc                 -0.1454    0.8647   0.3979    0.4532 -0.32
susinidum_pbc                 -0.3397    0.7120   0.3672    0.4399 -0.77
susinidum_mar                 -0.1898    0.8272   0.3454    0.4156 -0.46
psycom_dum_with                0.2123    1.2365   0.1092    0.1048  2.03
psycom_dum_study               0.7697    2.1591   0.1897    0.1878  4.10
freq_cons_dum_5day             0.0433    1.0442   0.1019    0.1040  0.42
cond_oc_dum_2inact             0.1268    1.1352   0.1298    0.1225  1.03
cond_oc_dum_3unemp             0.1225    1.1304   0.1384    0.1315  0.93
susprindum_oh                  0.3221    1.3800   0.3895    0.2781  1.16
susprindum_coc                 0.6083    1.8374   0.3961    0.2869  2.12
susprindum_pbc                 0.6333    1.8838   0.3803    0.2656  2.38
susprindum_mar                 1.1292    3.0932   0.4219    0.2995  3.77
                              Pr(&gt;|z|)    
tr_outcome.lag                 7.5e-07 ***
less_90d_tr1.lag               0.23300    
log_dias_treat_imp_sin_na.lag  0.50647    
comp_bpsc_y3_severe.lag        0.39697    
policonsumo2.lag               0.04880 *  
edad_al_ing_1                  0.18121    
ano_nac_corr                   0.20670    
susinidum_oh                   0.85608    
susinidum_coc                  0.74838    
susinidum_pbc                  0.44007    
susinidum_mar                  0.64795    
psycom_dum_with                0.04280 *  
psycom_dum_study               4.2e-05 ***
freq_cons_dum_5day             0.67737    
cond_oc_dum_2inact             0.30087    
cond_oc_dum_3unemp             0.35156    
susprindum_oh                  0.24687    
susprindum_coc                 0.03399 *  
susprindum_pbc                 0.01712 *  
susprindum_mar                 0.00016 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.272      3.674     0.163     0.456
less_90d_tr1.lag                  1.275      0.784     0.855     1.901
log_dias_treat_imp_sin_na.lag     1.049      0.953     0.910     1.210
comp_bpsc_y3_severe.lag           0.840      1.191     0.560     1.258
policonsumo2.lag                  1.502      0.666     1.002     2.252
edad_al_ing_1                     1.032      0.969     0.985     1.080
ano_nac_corr                      1.030      0.970     0.984     1.080
susinidum_oh                      0.928      1.078     0.414     2.082
susinidum_coc                     0.865      1.156     0.356     2.102
susinidum_pbc                     0.712      1.404     0.301     1.686
susinidum_mar                     0.827      1.209     0.366     1.868
psycom_dum_with                   1.237      0.809     1.007     1.518
psycom_dum_study                  2.159      0.463     1.494     3.120
freq_cons_dum_5day                1.044      0.958     0.852     1.280
cond_oc_dum_2inact                1.135      0.881     0.893     1.443
cond_oc_dum_3unemp                1.130      0.885     0.873     1.463
susprindum_oh                     1.380      0.725     0.800     2.380
susprindum_coc                    1.837      0.544     1.047     3.224
susprindum_pbc                    1.884      0.531     1.119     3.171
susprindum_mar                    3.093      0.323     1.720     5.563

Concordance= 0.615  (se = 0.015 )
Likelihood ratio test= 46.8  on 20 df,   p=6e-04
Wald test            = 66.7  on 20 df,   p=6e-07
Score (logrank) test = 44.6  on 20 df,   p=0.001,   Robust = 53.9  p=6e-05

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.138   0.362   0.482   0.507   0.590   1.829 
[1] "Modality: WO residential\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 510, number of events= 510 
   (460 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.02037   1.02058  0.32347   0.28663  0.07
less_90d_tr1.lag              -0.05381   0.94761  0.47776   0.33189 -0.16
log_dias_treat_imp_sin_na.lag -0.04359   0.95734  0.13190   0.08040 -0.54
comp_bpsc_y3_severe.lag       -0.22175   0.80112  0.36638   0.27653 -0.80
policonsumo2.lag              -0.27505   0.75953  0.41429   0.24540 -1.12
edad_al_ing_1                 -0.01107   0.98899  0.01968   0.01844 -0.60
ano_nac_corr                  -0.01499   0.98512  0.01893   0.01757 -0.85
susinidum_oh                  -0.28712   0.75043  0.29717   0.42526 -0.68
susinidum_coc                 -0.22276   0.80031  0.34277   0.45219 -0.49
susinidum_pbc                 -0.49527   0.60940  0.30801   0.43812 -1.13
susinidum_mar                 -0.29516   0.74441  0.29779   0.42509 -0.69
psycom_dum_with                0.11958   1.12702  0.14013   0.13615  0.88
psycom_dum_study               0.08277   1.08629  0.16386   0.16597  0.50
freq_cons_dum_5day             0.04525   1.04629  0.10570   0.10638  0.43
cond_oc_dum_2inact             0.09185   1.09620  0.16522   0.14958  0.61
cond_oc_dum_3unemp            -0.05006   0.95117  0.16480   0.15168 -0.33
susprindum_oh                  0.13345   1.14276  0.29473   0.29308  0.46
susprindum_coc                -0.33084   0.71832  0.30710   0.31920 -1.04
susprindum_pbc                 0.00516   1.00517  0.28530   0.29053  0.02
susprindum_mar                -0.88875   0.41117  0.53601   0.39663 -2.24
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.943  
less_90d_tr1.lag                 0.871  
log_dias_treat_imp_sin_na.lag    0.588  
comp_bpsc_y3_severe.lag          0.423  
policonsumo2.lag                 0.262  
edad_al_ing_1                    0.548  
ano_nac_corr                     0.394  
susinidum_oh                     0.500  
susinidum_coc                    0.622  
susinidum_pbc                    0.258  
susinidum_mar                    0.487  
psycom_dum_with                  0.380  
psycom_dum_study                 0.618  
freq_cons_dum_5day               0.671  
cond_oc_dum_2inact               0.539  
cond_oc_dum_3unemp               0.741  
susprindum_oh                    0.649  
susprindum_coc                   0.300  
susprindum_pbc                   0.986  
susprindum_mar                   0.025 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.021      0.980     0.582     1.790
less_90d_tr1.lag                  0.948      1.055     0.494     1.816
log_dias_treat_imp_sin_na.lag     0.957      1.045     0.818     1.121
comp_bpsc_y3_severe.lag           0.801      1.248     0.466     1.377
policonsumo2.lag                  0.760      1.317     0.470     1.229
edad_al_ing_1                     0.989      1.011     0.954     1.025
ano_nac_corr                      0.985      1.015     0.952     1.020
susinidum_oh                      0.750      1.333     0.326     1.727
susinidum_coc                     0.800      1.250     0.330     1.942
susinidum_pbc                     0.609      1.641     0.258     1.438
susinidum_mar                     0.744      1.343     0.324     1.713
psycom_dum_with                   1.127      0.887     0.863     1.472
psycom_dum_study                  1.086      0.921     0.785     1.504
freq_cons_dum_5day                1.046      0.956     0.849     1.289
cond_oc_dum_2inact                1.096      0.912     0.818     1.470
cond_oc_dum_3unemp                0.951      1.051     0.707     1.280
susprindum_oh                     1.143      0.875     0.643     2.030
susprindum_coc                    0.718      1.392     0.384     1.343
susprindum_pbc                    1.005      0.995     0.569     1.776
susprindum_mar                    0.411      2.432     0.189     0.895

Concordance= 0.564  (se = 0.014 )
Likelihood ratio test= 32.3  on 20 df,   p=0.04
Wald test            = 46.8  on 20 df,   p=6e-04
Score (logrank) test = 30.6  on 20 df,   p=0.06,   Robust = 38.2  p=0.008

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.72    1.05    1.21    1.30    1.44    3.24 
[1] "Modality: GP intensive ambulatory\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2228, number of events= 2228 
   (2101 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.22051   0.80211  0.20196   0.15221 -1.45
less_90d_tr1.lag               0.15824   1.17144  0.29932   0.20027  0.79
log_dias_treat_imp_sin_na.lag -0.17581   0.83878  0.06732   0.04711 -3.73
comp_bpsc_y3_severe.lag        0.04739   1.04853  0.18277   0.13092  0.36
policonsumo2.lag               0.02008   1.02029  0.22228   0.14928  0.13
edad_al_ing_1                 -0.00154   0.99847  0.00887   0.00882 -0.17
ano_nac_corr                  -0.00251   0.99749  0.00859   0.00858 -0.29
susinidum_oh                   0.05098   1.05230  0.15531   0.17300  0.29
susinidum_coc                  0.15420   1.16673  0.18054   0.19068  0.81
susinidum_pbc                  0.06130   1.06322  0.17251   0.19134  0.32
susinidum_mar                  0.03883   1.03959  0.15757   0.17637  0.22
psycom_dum_with               -0.01992   0.98028  0.04721   0.04696 -0.42
psycom_dum_study              -0.05966   0.94209  0.06569   0.06467 -0.92
freq_cons_dum_5day            -0.01222   0.98786  0.04390   0.04387 -0.28
cond_oc_dum_2inact             0.06559   1.06779  0.06486   0.06500  1.01
cond_oc_dum_3unemp             0.07510   1.07800  0.04738   0.04737  1.59
susprindum_oh                  0.08632   1.09016  0.17649   0.18533  0.47
susprindum_coc                 0.04682   1.04793  0.17742   0.18631  0.25
susprindum_pbc                 0.07389   1.07668  0.17324   0.18203  0.41
susprindum_mar                 0.13331   1.14260  0.19634   0.20113  0.66
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.14742    
less_90d_tr1.lag               0.42946    
log_dias_treat_imp_sin_na.lag  0.00019 ***
comp_bpsc_y3_severe.lag        0.71735    
policonsumo2.lag               0.89298    
edad_al_ing_1                  0.86174    
ano_nac_corr                   0.76954    
susinidum_oh                   0.76823    
susinidum_coc                  0.41870    
susinidum_pbc                  0.74870    
susinidum_mar                  0.82576    
psycom_dum_with                0.67141    
psycom_dum_study               0.35627    
freq_cons_dum_5day             0.78062    
cond_oc_dum_2inact             0.31295    
cond_oc_dum_3unemp             0.11288    
susprindum_oh                  0.64136    
susprindum_coc                 0.80159    
susprindum_pbc                 0.68481    
susprindum_mar                 0.50745    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.802      1.247     0.595      1.08
less_90d_tr1.lag                  1.171      0.854     0.791      1.73
log_dias_treat_imp_sin_na.lag     0.839      1.192     0.765      0.92
comp_bpsc_y3_severe.lag           1.049      0.954     0.811      1.36
policonsumo2.lag                  1.020      0.980     0.761      1.37
edad_al_ing_1                     0.998      1.002     0.981      1.02
ano_nac_corr                      0.997      1.003     0.981      1.01
susinidum_oh                      1.052      0.950     0.750      1.48
susinidum_coc                     1.167      0.857     0.803      1.70
susinidum_pbc                     1.063      0.941     0.731      1.55
susinidum_mar                     1.040      0.962     0.736      1.47
psycom_dum_with                   0.980      1.020     0.894      1.07
psycom_dum_study                  0.942      1.061     0.830      1.07
freq_cons_dum_5day                0.988      1.012     0.906      1.08
cond_oc_dum_2inact                1.068      0.937     0.940      1.21
cond_oc_dum_3unemp                1.078      0.928     0.982      1.18
susprindum_oh                     1.090      0.917     0.758      1.57
susprindum_coc                    1.048      0.954     0.727      1.51
susprindum_pbc                    1.077      0.929     0.754      1.54
susprindum_mar                    1.143      0.875     0.770      1.69

Concordance= 0.529  (se = 0.007 )
Likelihood ratio test= 68.9  on 20 df,   p=3e-07
Wald test            = 96.2  on 20 df,   p=6e-12
Score (logrank) test = 59.1  on 20 df,   p=1e-05,   Robust = 49.1  p=3e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.589   0.812   0.847   0.886   0.877   2.101 
[1] "Modality: basic ambulatory\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1787, number of events= 1787 
   (1705 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.12932   0.87869  0.25813   0.18571 -0.70
less_90d_tr1.lag              -0.15985   0.85227  0.42237   0.34156 -0.47
log_dias_treat_imp_sin_na.lag -0.12757   0.88023  0.08020   0.06162 -2.07
comp_bpsc_y3_severe.lag       -0.08762   0.91610  0.28847   0.22146 -0.40
policonsumo2.lag               0.21017   1.23388  0.24199   0.20255  1.04
edad_al_ing_1                 -0.00577   0.99424  0.01003   0.01001 -0.58
ano_nac_corr                  -0.00986   0.99019  0.00973   0.00982 -1.00
susinidum_oh                  -0.10656   0.89892  0.17572   0.19057 -0.56
susinidum_coc                 -0.25140   0.77771  0.20950   0.21642 -1.16
susinidum_pbc                 -0.02585   0.97448  0.19592   0.21091 -0.12
susinidum_mar                 -0.07484   0.92789  0.17887   0.19301 -0.39
psycom_dum_with               -0.05706   0.94453  0.05251   0.05189 -1.10
psycom_dum_study              -0.15100   0.85984  0.07230   0.07389 -2.04
freq_cons_dum_5day             0.02770   1.02809  0.05517   0.05588  0.50
cond_oc_dum_2inact            -0.02770   0.97268  0.07139   0.07290 -0.38
cond_oc_dum_3unemp            -0.01719   0.98295  0.05936   0.05787 -0.30
susprindum_oh                  0.04424   1.04523  0.20165   0.17037  0.26
susprindum_coc                 0.06049   1.06235  0.20551   0.17376  0.35
susprindum_pbc                -0.01698   0.98316  0.20146   0.17168 -0.10
susprindum_mar                 0.21749   1.24296  0.21387   0.18526  1.17
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.486  
less_90d_tr1.lag                 0.640  
log_dias_treat_imp_sin_na.lag    0.038 *
comp_bpsc_y3_severe.lag          0.692  
policonsumo2.lag                 0.299  
edad_al_ing_1                    0.564  
ano_nac_corr                     0.316  
susinidum_oh                     0.576  
susinidum_coc                    0.245  
susinidum_pbc                    0.902  
susinidum_mar                    0.698  
psycom_dum_with                  0.271  
psycom_dum_study                 0.041 *
freq_cons_dum_5day               0.620  
cond_oc_dum_2inact               0.704  
cond_oc_dum_3unemp               0.766  
susprindum_oh                    0.795  
susprindum_coc                   0.728  
susprindum_pbc                   0.921  
susprindum_mar                   0.240  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.879      1.138     0.611     1.264
less_90d_tr1.lag                  0.852      1.173     0.436     1.665
log_dias_treat_imp_sin_na.lag     0.880      1.136     0.780     0.993
comp_bpsc_y3_severe.lag           0.916      1.092     0.594     1.414
policonsumo2.lag                  1.234      0.810     0.830     1.835
edad_al_ing_1                     0.994      1.006     0.975     1.014
ano_nac_corr                      0.990      1.010     0.971     1.009
susinidum_oh                      0.899      1.112     0.619     1.306
susinidum_coc                     0.778      1.286     0.509     1.189
susinidum_pbc                     0.974      1.026     0.645     1.473
susinidum_mar                     0.928      1.078     0.636     1.355
psycom_dum_with                   0.945      1.059     0.853     1.046
psycom_dum_study                  0.860      1.163     0.744     0.994
freq_cons_dum_5day                1.028      0.973     0.921     1.147
cond_oc_dum_2inact                0.973      1.028     0.843     1.122
cond_oc_dum_3unemp                0.983      1.017     0.878     1.101
susprindum_oh                     1.045      0.957     0.749     1.460
susprindum_coc                    1.062      0.941     0.756     1.493
susprindum_pbc                    0.983      1.017     0.702     1.376
susprindum_mar                    1.243      0.805     0.864     1.787

Concordance= 0.535  (se = 0.008 )
Likelihood ratio test= 30.9  on 20 df,   p=0.06
Wald test            = 36.3  on 20 df,   p=0.01
Score (logrank) test = 29.6  on 20 df,   p=0.08,   Robust = 30.6  p=0.06

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.746   1.027   1.092   1.115   1.173   2.260 
[1] "Modality: GP residential\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1104, number of events= 1104 
   (1012 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.16084   1.17450  0.22786   0.16977  0.95
less_90d_tr1.lag              -0.49178   0.61154  0.34685   0.23196 -2.12
log_dias_treat_imp_sin_na.lag -0.34202   0.71034  0.10550   0.06216 -5.50
comp_bpsc_y3_severe.lag        0.30136   1.35170  0.25249   0.19164  1.57
policonsumo2.lag               0.30428   1.35564  0.34606   0.18312  1.66
edad_al_ing_1                  0.00602   1.00604  0.01385   0.01406  0.43
ano_nac_corr                   0.00667   1.00669  0.01397   0.01379  0.48
susinidum_oh                  -0.15110   0.85976  0.21234   0.18102 -0.83
susinidum_coc                 -0.03124   0.96925  0.26184   0.22544 -0.14
susinidum_pbc                 -0.28296   0.75355  0.22751   0.19856 -1.43
susinidum_mar                 -0.13798   0.87111  0.21120   0.17930 -0.77
psycom_dum_with               -0.07512   0.92763  0.07035   0.06946 -1.08
psycom_dum_study              -0.19636   0.82172  0.09873   0.09277 -2.12
freq_cons_dum_5day            -0.02582   0.97451  0.06870   0.06894 -0.37
cond_oc_dum_2inact            -0.00504   0.99497  0.11271   0.11272 -0.04
cond_oc_dum_3unemp             0.11897   1.12634  0.09198   0.08874  1.34
susprindum_oh                 -0.03578   0.96485  0.31288   0.27870 -0.13
susprindum_coc                -0.16252   0.85000  0.31542   0.28194 -0.58
susprindum_pbc                -0.15322   0.85794  0.30652   0.27433 -0.56
susprindum_mar                 0.41912   1.52062  0.35401   0.32844  1.28
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.343    
less_90d_tr1.lag                 0.034 *  
log_dias_treat_imp_sin_na.lag  3.8e-08 ***
comp_bpsc_y3_severe.lag          0.116    
policonsumo2.lag                 0.097 .  
edad_al_ing_1                    0.669    
ano_nac_corr                     0.629    
susinidum_oh                     0.404    
susinidum_coc                    0.890    
susinidum_pbc                    0.154    
susinidum_mar                    0.442    
psycom_dum_with                  0.279    
psycom_dum_study                 0.034 *  
freq_cons_dum_5day               0.708    
cond_oc_dum_2inact               0.964    
cond_oc_dum_3unemp               0.180    
susprindum_oh                    0.898    
susprindum_coc                   0.564    
susprindum_pbc                   0.576    
susprindum_mar                   0.202    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.175      0.851     0.842     1.638
less_90d_tr1.lag                  0.612      1.635     0.388     0.964
log_dias_treat_imp_sin_na.lag     0.710      1.408     0.629     0.802
comp_bpsc_y3_severe.lag           1.352      0.740     0.928     1.968
policonsumo2.lag                  1.356      0.738     0.947     1.941
edad_al_ing_1                     1.006      0.994     0.979     1.034
ano_nac_corr                      1.007      0.993     0.980     1.034
susinidum_oh                      0.860      1.163     0.603     1.226
susinidum_coc                     0.969      1.032     0.623     1.508
susinidum_pbc                     0.754      1.327     0.511     1.112
susinidum_mar                     0.871      1.148     0.613     1.238
psycom_dum_with                   0.928      1.078     0.810     1.063
psycom_dum_study                  0.822      1.217     0.685     0.986
freq_cons_dum_5day                0.975      1.026     0.851     1.115
cond_oc_dum_2inact                0.995      1.005     0.798     1.241
cond_oc_dum_3unemp                1.126      0.888     0.947     1.340
susprindum_oh                     0.965      1.036     0.559     1.666
susprindum_coc                    0.850      1.176     0.489     1.477
susprindum_pbc                    0.858      1.166     0.501     1.469
susprindum_mar                    1.521      0.658     0.799     2.895

Concordance= 0.551  (se = 0.01 )
Likelihood ratio test= 53.5  on 20 df,   p=7e-05
Wald test            = 82.3  on 20 df,   p=2e-09
Score (logrank) test = 50.3  on 20 df,   p=2e-04,   Robust = 51.4  p=1e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.59    1.14    1.22    1.30    1.35    4.01 
[1] "Modality: WO intensive ambulatory\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 383, number of events= 383 
   (363 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.0139    1.0140   0.5205    0.2113  0.07
less_90d_tr1.lag              -0.1059    0.8995   0.6503    0.2745 -0.39
log_dias_treat_imp_sin_na.lag -0.2009    0.8180   0.2031    0.0842 -2.38
comp_bpsc_y3_severe.lag        0.2002    1.2216   0.4707    0.2543  0.79
policonsumo2.lag               0.1453    1.1563   0.5554    0.2622  0.55
edad_al_ing_1                  0.0181    1.0183   0.0229    0.0233  0.78
ano_nac_corr                   0.0110    1.0110   0.0226    0.0218  0.50
susinidum_oh                  -0.1997    0.8190   0.3295    0.2298 -0.87
susinidum_coc                 -0.2145    0.8069   0.3881    0.2883 -0.74
susinidum_pbc                 -0.3852    0.6803   0.3518    0.2681 -1.44
susinidum_mar                 -0.2611    0.7702   0.3303    0.2274 -1.15
psycom_dum_with               -0.0695    0.9329   0.1233    0.1172 -0.59
psycom_dum_study              -0.0870    0.9166   0.1661    0.1586 -0.55
freq_cons_dum_5day             0.0223    1.0226   0.1079    0.1065  0.21
cond_oc_dum_2inact            -0.2520    0.7772   0.1402    0.1450 -1.74
cond_oc_dum_3unemp            -0.1516    0.8594   0.1437    0.1478 -1.03
susprindum_oh                 -0.1029    0.9022   0.4157    0.3344 -0.31
susprindum_coc                 0.1311    1.1400   0.4138    0.3210  0.41
susprindum_pbc                 0.0489    1.0501   0.4034    0.3065  0.16
susprindum_mar                 0.3545    1.4254   0.4304    0.3513  1.01
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.948  
less_90d_tr1.lag                 0.700  
log_dias_treat_imp_sin_na.lag    0.017 *
comp_bpsc_y3_severe.lag          0.431  
policonsumo2.lag                 0.580  
edad_al_ing_1                    0.435  
ano_nac_corr                     0.615  
susinidum_oh                     0.385  
susinidum_coc                    0.457  
susinidum_pbc                    0.151  
susinidum_mar                    0.251  
psycom_dum_with                  0.553  
psycom_dum_study                 0.583  
freq_cons_dum_5day               0.834  
cond_oc_dum_2inact               0.082 .
cond_oc_dum_3unemp               0.305  
susprindum_oh                    0.758  
susprindum_coc                   0.683  
susprindum_pbc                   0.873  
susprindum_mar                   0.313  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.014      0.986     0.670     1.534
less_90d_tr1.lag                  0.900      1.112     0.525     1.541
log_dias_treat_imp_sin_na.lag     0.818      1.222     0.694     0.965
comp_bpsc_y3_severe.lag           1.222      0.819     0.742     2.011
policonsumo2.lag                  1.156      0.865     0.692     1.933
edad_al_ing_1                     1.018      0.982     0.973     1.066
ano_nac_corr                      1.011      0.989     0.969     1.055
susinidum_oh                      0.819      1.221     0.522     1.285
susinidum_coc                     0.807      1.239     0.459     1.420
susinidum_pbc                     0.680      1.470     0.402     1.150
susinidum_mar                     0.770      1.298     0.493     1.203
psycom_dum_with                   0.933      1.072     0.741     1.174
psycom_dum_study                  0.917      1.091     0.672     1.251
freq_cons_dum_5day                1.023      0.978     0.830     1.260
cond_oc_dum_2inact                0.777      1.287     0.585     1.033
cond_oc_dum_3unemp                0.859      1.164     0.643     1.148
susprindum_oh                     0.902      1.108     0.468     1.738
susprindum_coc                    1.140      0.877     0.608     2.139
susprindum_pbc                    1.050      0.952     0.576     1.915
susprindum_mar                    1.425      0.702     0.716     2.838

Concordance= 0.56  (se = 0.016 )
Likelihood ratio test= 14.7  on 20 df,   p=0.8
Wald test            = 23.1  on 20 df,   p=0.3
Score (logrank) test = 15  on 20 df,   p=0.8,   Robust = 21.1  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.73    1.28    1.46    1.47    1.65    2.79 
[1] "Modality: WO residential\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 337, number of events= 337 
   (312 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.52775   0.58993  0.59758   0.55588 -0.95
less_90d_tr1.lag               1.28742   3.62343  0.63270   0.69793  1.84
log_dias_treat_imp_sin_na.lag  0.37313   1.45227  0.21591   0.17707  2.11
comp_bpsc_y3_severe.lag       -0.44744   0.63926  0.53809   0.42889 -1.04
policonsumo2.lag              -1.35950   0.25679  0.63831   0.50568 -2.69
edad_al_ing_1                  0.00477   1.00478  0.02813   0.02935  0.16
ano_nac_corr                   0.01147   1.01153  0.02742   0.02843  0.40
susinidum_oh                  -0.90099   0.40617  0.36726   0.34401 -2.62
susinidum_coc                 -0.42751   0.65213  0.44421   0.46878 -0.91
susinidum_pbc                 -0.80738   0.44602  0.38152   0.35273 -2.29
susinidum_mar                 -0.67932   0.50696  0.37085   0.34238 -1.98
psycom_dum_with                0.10540   1.11116  0.16856   0.16076  0.66
psycom_dum_study               0.16165   1.17544  0.19683   0.18720  0.86
freq_cons_dum_5day            -0.11891   0.88789  0.13535   0.12817 -0.93
cond_oc_dum_2inact             0.01787   1.01803  0.21311   0.20359  0.09
cond_oc_dum_3unemp             0.11626   1.12328  0.21418   0.20141  0.58
susprindum_oh                  0.60703   1.83497  0.36513   0.33605  1.81
susprindum_coc                 0.19494   1.21524  0.36571   0.34826  0.56
susprindum_pbc                 0.54841   1.73050  0.34360   0.32407  1.69
susprindum_mar                -0.07329   0.92933  0.49572   0.46633 -0.16
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.3424   
less_90d_tr1.lag                0.0651 . 
log_dias_treat_imp_sin_na.lag   0.0351 * 
comp_bpsc_y3_severe.lag         0.2968   
policonsumo2.lag                0.0072 **
edad_al_ing_1                   0.8709   
ano_nac_corr                    0.6868   
susinidum_oh                    0.0088 **
susinidum_coc                   0.3618   
susinidum_pbc                   0.0221 * 
susinidum_mar                   0.0472 * 
psycom_dum_with                 0.5120   
psycom_dum_study                0.3879   
freq_cons_dum_5day              0.3535   
cond_oc_dum_2inact              0.9301   
cond_oc_dum_3unemp              0.5638   
susprindum_oh                   0.0709 . 
susprindum_coc                  0.5756   
susprindum_pbc                  0.0906 . 
susprindum_mar                  0.8751   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.590      1.695    0.1984     1.754
less_90d_tr1.lag                  3.623      0.276    0.9227    14.230
log_dias_treat_imp_sin_na.lag     1.452      0.689    1.0264     2.055
comp_bpsc_y3_severe.lag           0.639      1.564    0.2758     1.482
policonsumo2.lag                  0.257      3.894    0.0953     0.692
edad_al_ing_1                     1.005      0.995    0.9486     1.064
ano_nac_corr                      1.012      0.989    0.9567     1.070
susinidum_oh                      0.406      2.462    0.2070     0.797
susinidum_coc                     0.652      1.533    0.2602     1.634
susinidum_pbc                     0.446      2.242    0.2234     0.890
susinidum_mar                     0.507      1.973    0.2591     0.992
psycom_dum_with                   1.111      0.900    0.8109     1.523
psycom_dum_study                  1.175      0.851    0.8144     1.696
freq_cons_dum_5day                0.888      1.126    0.6907     1.141
cond_oc_dum_2inact                1.018      0.982    0.6831     1.517
cond_oc_dum_3unemp                1.123      0.890    0.7569     1.667
susprindum_oh                     1.835      0.545    0.9497     3.545
susprindum_coc                    1.215      0.823    0.6141     2.405
susprindum_pbc                    1.731      0.578    0.9169     3.266
susprindum_mar                    0.929      1.076    0.3726     2.318

Concordance= 0.58  (se = 0.019 )
Likelihood ratio test= 34  on 20 df,   p=0.03
Wald test            = 30.1  on 20 df,   p=0.07
Score (logrank) test = 32.6  on 20 df,   p=0.04,   Robust = 30.6  p=0.06

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.49    1.15    1.33    1.46    1.54    5.65 
[1] "Modality: GP intensive ambulatory\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1468, number of events= 1468 
   (1416 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.77020   0.46292  0.32283   0.21267 -3.62
less_90d_tr1.lag               0.75061   2.11829  0.49073   0.32418  2.32
log_dias_treat_imp_sin_na.lag -0.01781   0.98235  0.12088   0.06905 -0.26
comp_bpsc_y3_severe.lag        0.13237   1.14153  0.27442   0.18921  0.70
policonsumo2.lag              -0.09052   0.91346  0.39153   0.19891 -0.46
edad_al_ing_1                  0.00928   1.00932  0.01199   0.01157  0.80
ano_nac_corr                   0.01265   1.01273  0.01185   0.01153  1.10
susinidum_oh                  -0.17332   0.84087  0.17260   0.14459 -1.20
susinidum_coc                 -0.12314   0.88414  0.20924   0.18679 -0.66
susinidum_pbc                 -0.24649   0.78154  0.19359   0.16674 -1.48
susinidum_mar                 -0.14682   0.86345  0.17517   0.14808 -0.99
psycom_dum_with                0.07150   1.07412  0.05853   0.05778  1.24
psycom_dum_study               0.13922   1.14937  0.07958   0.08264  1.68
freq_cons_dum_5day            -0.02035   0.97985  0.05446   0.05442 -0.37
cond_oc_dum_2inact            -0.16760   0.84569  0.08044   0.07567 -2.21
cond_oc_dum_3unemp            -0.07804   0.92492  0.05854   0.05876 -1.33
susprindum_oh                  0.34743   1.41543  0.22476   0.22378  1.55
susprindum_coc                 0.37297   1.45205  0.22768   0.22798  1.64
susprindum_pbc                 0.36533   1.44099  0.21944   0.21990  1.66
susprindum_mar                 0.54446   1.72368  0.24308   0.24195  2.25
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.00029 ***
less_90d_tr1.lag               0.02059 *  
log_dias_treat_imp_sin_na.lag  0.79649    
comp_bpsc_y3_severe.lag        0.48419    
policonsumo2.lag               0.64906    
edad_al_ing_1                  0.42279    
ano_nac_corr                   0.27261    
susinidum_oh                   0.23063    
susinidum_coc                  0.50974    
susinidum_pbc                  0.13932    
susinidum_mar                  0.32145    
psycom_dum_with                0.21597    
psycom_dum_study               0.09206 .  
freq_cons_dum_5day             0.70838    
cond_oc_dum_2inact             0.02676 *  
cond_oc_dum_3unemp             0.18414    
susprindum_oh                  0.12052    
susprindum_coc                 0.10184    
susprindum_pbc                 0.09665 .  
susprindum_mar                 0.02443 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.463      2.160     0.305     0.702
less_90d_tr1.lag                  2.118      0.472     1.122     3.999
log_dias_treat_imp_sin_na.lag     0.982      1.018     0.858     1.125
comp_bpsc_y3_severe.lag           1.142      0.876     0.788     1.654
policonsumo2.lag                  0.913      1.095     0.619     1.349
edad_al_ing_1                     1.009      0.991     0.987     1.032
ano_nac_corr                      1.013      0.987     0.990     1.036
susinidum_oh                      0.841      1.189     0.633     1.116
susinidum_coc                     0.884      1.131     0.613     1.275
susinidum_pbc                     0.782      1.280     0.564     1.084
susinidum_mar                     0.863      1.158     0.646     1.154
psycom_dum_with                   1.074      0.931     0.959     1.203
psycom_dum_study                  1.149      0.870     0.978     1.351
freq_cons_dum_5day                0.980      1.021     0.881     1.090
cond_oc_dum_2inact                0.846      1.182     0.729     0.981
cond_oc_dum_3unemp                0.925      1.081     0.824     1.038
susprindum_oh                     1.415      0.706     0.913     2.195
susprindum_coc                    1.452      0.689     0.929     2.270
susprindum_pbc                    1.441      0.694     0.936     2.217
susprindum_mar                    1.724      0.580     1.073     2.770

Concordance= 0.537  (se = 0.009 )
Likelihood ratio test= 45.9  on 20 df,   p=8e-04
Wald test            = 52  on 20 df,   p=1e-04
Score (logrank) test = 41.3  on 20 df,   p=0.003,   Robust = 34.9  p=0.02

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.513   0.767   0.823   0.850   0.890   2.288 
[1] "Modality: basic ambulatory\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1208, number of events= 1208 
   (1172 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.05575   1.05733  0.41651   0.26438  0.21
less_90d_tr1.lag              -0.45329   0.63554  0.43659   0.35253 -1.29
log_dias_treat_imp_sin_na.lag -0.15252   0.85854  0.14076   0.08064 -1.89
comp_bpsc_y3_severe.lag       -0.55325   0.57508  0.40430   0.31080 -1.78
policonsumo2.lag               0.25287   1.28771  0.43978   0.28250  0.90
edad_al_ing_1                  0.04213   1.04303  0.01381   0.01319  3.19
ano_nac_corr                   0.04128   1.04214  0.01367   0.01295  3.19
susinidum_oh                   0.01952   1.01971  0.21963   0.21984  0.09
susinidum_coc                  0.09272   1.09716  0.25589   0.25100  0.37
susinidum_pbc                  0.21430   1.23900  0.24964   0.24453  0.88
susinidum_mar                  0.05777   1.05947  0.22158   0.22321  0.26
psycom_dum_with               -0.05744   0.94418  0.06662   0.06799 -0.84
psycom_dum_study              -0.10343   0.90174  0.07985   0.07481 -1.38
freq_cons_dum_5day             0.07591   1.07887  0.06736   0.06549  1.16
cond_oc_dum_2inact            -0.00385   0.99616  0.09586   0.09454 -0.04
cond_oc_dum_3unemp            -0.02597   0.97437  0.06951   0.07100 -0.37
susprindum_oh                 -0.44138   0.64315  0.28577   0.22911 -1.93
susprindum_coc                -0.44717   0.63943  0.29004   0.23458 -1.91
susprindum_pbc                -0.47769   0.62021  0.28560   0.22746 -2.10
susprindum_mar                -0.44252   0.64242  0.29882   0.25360 -1.74
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.8330   
less_90d_tr1.lag                0.1985   
log_dias_treat_imp_sin_na.lag   0.0586 . 
comp_bpsc_y3_severe.lag         0.0751 . 
policonsumo2.lag                0.3707   
edad_al_ing_1                   0.0014 **
ano_nac_corr                    0.0014 **
susinidum_oh                    0.9292   
susinidum_coc                   0.7118   
susinidum_pbc                   0.3808   
susinidum_mar                   0.7958   
psycom_dum_with                 0.3983   
psycom_dum_study                0.1668   
freq_cons_dum_5day              0.2464   
cond_oc_dum_2inact              0.9675   
cond_oc_dum_3unemp              0.7146   
susprindum_oh                   0.0540 . 
susprindum_coc                  0.0566 . 
susprindum_pbc                  0.0357 * 
susprindum_mar                  0.0810 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.057      0.946     0.630     1.775
less_90d_tr1.lag                  0.636      1.573     0.318     1.268
log_dias_treat_imp_sin_na.lag     0.859      1.165     0.733     1.006
comp_bpsc_y3_severe.lag           0.575      1.739     0.313     1.057
policonsumo2.lag                  1.288      0.777     0.740     2.240
edad_al_ing_1                     1.043      0.959     1.016     1.070
ano_nac_corr                      1.042      0.960     1.016     1.069
susinidum_oh                      1.020      0.981     0.663     1.569
susinidum_coc                     1.097      0.911     0.671     1.794
susinidum_pbc                     1.239      0.807     0.767     2.001
susinidum_mar                     1.059      0.944     0.684     1.641
psycom_dum_with                   0.944      1.059     0.826     1.079
psycom_dum_study                  0.902      1.109     0.779     1.044
freq_cons_dum_5day                1.079      0.927     0.949     1.227
cond_oc_dum_2inact                0.996      1.004     0.828     1.199
cond_oc_dum_3unemp                0.974      1.026     0.848     1.120
susprindum_oh                     0.643      1.555     0.410     1.008
susprindum_coc                    0.639      1.564     0.404     1.013
susprindum_pbc                    0.620      1.612     0.397     0.969
susprindum_mar                    0.642      1.557     0.391     1.056

Concordance= 0.553  (se = 0.009 )
Likelihood ratio test= 30.9  on 20 df,   p=0.06
Wald test            = 42.6  on 20 df,   p=0.002
Score (logrank) test = 29.1  on 20 df,   p=0.09,   Robust = 31.7  p=0.05

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.89    1.40    1.54    1.56    1.67    4.05 
[1] "Modality: GP residential\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 612, number of events= 612 
   (578 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.1769    0.8378   0.4834    0.2907 -0.61
less_90d_tr1.lag              -0.2906    0.7478   0.5881    0.3684 -0.79
log_dias_treat_imp_sin_na.lag -0.3352    0.7152   0.1787    0.1274 -2.63
comp_bpsc_y3_severe.lag        0.3234    1.3818   0.4523    0.3102  1.04
policonsumo2.lag               0.4513    1.5704   0.5524    0.3767  1.20
edad_al_ing_1                  0.0155    1.0157   0.0203    0.0182  0.85
ano_nac_corr                   0.0204    1.0206   0.0200    0.0183  1.11
susinidum_oh                  -0.4689    0.6257   0.3172    0.2629 -1.78
susinidum_coc                 -0.0629    0.9391   0.3628    0.3023 -0.21
susinidum_pbc                 -0.3090    0.7342   0.3327    0.2733 -1.13
susinidum_mar                 -0.4797    0.6190   0.3174    0.2605 -1.84
psycom_dum_with               -0.1006    0.9043   0.0943    0.0977 -1.03
psycom_dum_study              -0.0192    0.9810   0.1339    0.1244 -0.15
freq_cons_dum_5day             0.1309    1.1398   0.0948    0.0945  1.38
cond_oc_dum_2inact            -0.0699    0.9325   0.1497    0.1480 -0.47
cond_oc_dum_3unemp            -0.0659    0.9363   0.1298    0.1280 -0.51
susprindum_oh                  0.8377    2.3110   0.4654    0.4005  2.09
susprindum_coc                 0.8259    2.2840   0.4701    0.4049  2.04
susprindum_pbc                 0.8141    2.2571   0.4569    0.3882  2.10
susprindum_mar                 0.5328    1.7036   0.5248    0.4425  1.20
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.5428   
less_90d_tr1.lag                0.4302   
log_dias_treat_imp_sin_na.lag   0.0085 **
comp_bpsc_y3_severe.lag         0.2971   
policonsumo2.lag                0.2308   
edad_al_ing_1                   0.3945   
ano_nac_corr                    0.2652   
susinidum_oh                    0.0745 . 
susinidum_coc                   0.8352   
susinidum_pbc                   0.2582   
susinidum_mar                   0.0655 . 
psycom_dum_with                 0.3033   
psycom_dum_study                0.8772   
freq_cons_dum_5day              0.1661   
cond_oc_dum_2inact              0.6369   
cond_oc_dum_3unemp              0.6069   
susprindum_oh                   0.0365 * 
susprindum_coc                  0.0413 * 
susprindum_pbc                  0.0360 * 
susprindum_mar                  0.2286   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.838      1.194     0.474     1.481
less_90d_tr1.lag                  0.748      1.337     0.363     1.540
log_dias_treat_imp_sin_na.lag     0.715      1.398     0.557     0.918
comp_bpsc_y3_severe.lag           1.382      0.724     0.752     2.538
policonsumo2.lag                  1.570      0.637     0.751     3.286
edad_al_ing_1                     1.016      0.985     0.980     1.053
ano_nac_corr                      1.021      0.980     0.985     1.058
susinidum_oh                      0.626      1.598     0.374     1.048
susinidum_coc                     0.939      1.065     0.519     1.698
susinidum_pbc                     0.734      1.362     0.430     1.254
susinidum_mar                     0.619      1.616     0.372     1.031
psycom_dum_with                   0.904      1.106     0.747     1.095
psycom_dum_study                  0.981      1.019     0.769     1.252
freq_cons_dum_5day                1.140      0.877     0.947     1.372
cond_oc_dum_2inact                0.933      1.072     0.698     1.246
cond_oc_dum_3unemp                0.936      1.068     0.729     1.203
susprindum_oh                     2.311      0.433     1.054     5.066
susprindum_coc                    2.284      0.438     1.033     5.051
susprindum_pbc                    2.257      0.443     1.055     4.830
susprindum_mar                    1.704      0.587     0.716     4.055

Concordance= 0.549  (se = 0.013 )
Likelihood ratio test= 30.6  on 20 df,   p=0.06
Wald test            = 49.6  on 20 df,   p=3e-04
Score (logrank) test = 28.9  on 20 df,   p=0.09,   Robust = 32.6  p=0.04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.287   0.618   0.674   0.699   0.734   2.114 
[1] "Modality: WO intensive ambulatory\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 247, number of events= 247 
   (235 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se     z
tr_outcome.lag                -7.22e-02  9.30e-01  8.60e-01  4.46e-01 -0.16
less_90d_tr1.lag              -6.96e-01  4.98e-01  9.59e-01  5.93e-01 -1.17
log_dias_treat_imp_sin_na.lag -4.77e-01  6.21e-01  3.69e-01  2.08e-01 -2.29
comp_bpsc_y3_severe.lag        4.74e-01  1.61e+00  8.48e-01  5.41e-01  0.88
policonsumo2.lag               9.90e-01  2.69e+00  8.05e-01  5.92e-01  1.67
edad_al_ing_1                 -1.56e-02  9.85e-01  3.12e-02  2.97e-02 -0.53
ano_nac_corr                  -1.85e-02  9.82e-01  2.94e-02  2.69e-02 -0.69
susinidum_oh                  -5.46e-01  5.79e-01  5.57e-01  4.73e-01 -1.15
susinidum_coc                 -4.26e-01  6.53e-01  6.33e-01  5.47e-01 -0.78
susinidum_pbc                 -7.19e-01  4.87e-01  5.93e-01  5.02e-01 -1.43
susinidum_mar                 -4.38e-01  6.45e-01  5.65e-01  4.76e-01 -0.92
psycom_dum_with                2.34e-02  1.02e+00  1.46e-01  1.40e-01  0.17
psycom_dum_study               2.92e-01  1.34e+00  2.35e-01  2.58e-01  1.13
freq_cons_dum_5day            -2.47e-01  7.81e-01  1.47e-01  1.42e-01 -1.74
cond_oc_dum_2inact            -6.83e-02  9.34e-01  1.74e-01  1.56e-01 -0.44
cond_oc_dum_3unemp            -2.42e-02  9.76e-01  1.84e-01  1.81e-01 -0.13
susprindum_oh                 -4.26e-01  6.53e-01  4.59e-01  3.61e-01 -1.18
susprindum_coc                 1.33e-01  1.14e+00  4.72e-01  3.97e-01  0.33
susprindum_pbc                 3.51e-05  1.00e+00  4.63e-01  3.79e-01  0.00
susprindum_mar                -1.33e-02  9.87e-01  5.19e-01  4.06e-01 -0.03
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.872  
less_90d_tr1.lag                 0.241  
log_dias_treat_imp_sin_na.lag    0.022 *
comp_bpsc_y3_severe.lag          0.381  
policonsumo2.lag                 0.095 .
edad_al_ing_1                    0.599  
ano_nac_corr                     0.493  
susinidum_oh                     0.248  
susinidum_coc                    0.436  
susinidum_pbc                    0.152  
susinidum_mar                    0.357  
psycom_dum_with                  0.867  
psycom_dum_study                 0.257  
freq_cons_dum_5day               0.082 .
cond_oc_dum_2inact               0.662  
cond_oc_dum_3unemp               0.894  
susprindum_oh                    0.238  
susprindum_coc                   0.739  
susprindum_pbc                   1.000  
susprindum_mar                   0.974  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.930      1.075     0.388     2.232
less_90d_tr1.lag                  0.498      2.006     0.156     1.595
log_dias_treat_imp_sin_na.lag     0.621      1.611     0.413     0.933
comp_bpsc_y3_severe.lag           1.607      0.622     0.556     4.640
policonsumo2.lag                  2.691      0.372     0.843     8.589
edad_al_ing_1                     0.985      1.016     0.929     1.044
ano_nac_corr                      0.982      1.019     0.931     1.035
susinidum_oh                      0.579      1.727     0.229     1.464
susinidum_coc                     0.653      1.532     0.223     1.907
susinidum_pbc                     0.487      2.052     0.182     1.303
susinidum_mar                     0.645      1.550     0.254     1.639
psycom_dum_with                   1.024      0.977     0.778     1.347
psycom_dum_study                  1.339      0.747     0.808     2.219
freq_cons_dum_5day                0.781      1.281     0.591     1.032
cond_oc_dum_2inact                0.934      1.071     0.687     1.269
cond_oc_dum_3unemp                0.976      1.024     0.684     1.392
susprindum_oh                     0.653      1.531     0.322     1.325
susprindum_coc                    1.142      0.876     0.524     2.487
susprindum_pbc                    1.000      1.000     0.476     2.102
susprindum_mar                    0.987      1.013     0.445     2.187

Concordance= 0.587  (se = 0.021 )
Likelihood ratio test= 17.1  on 20 df,   p=0.6
Wald test            = 23.7  on 20 df,   p=0.3
Score (logrank) test = 16.7  on 20 df,   p=0.7,   Robust = 20.1  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.90    1.48    1.79    1.92    2.26    5.41 
[1] "Modality: WO residential\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 374, number of events= 374 
   (332 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se     z
tr_outcome.lag                -0.266240  0.766255  0.333140  0.156403 -1.70
less_90d_tr1.lag              -0.000868  0.999132  0.362284  0.230311  0.00
log_dias_treat_imp_sin_na.lag -0.074266  0.928425  0.072077  0.022583 -3.29
comp_bpsc_y3_severe.lag        0.172606  1.188397  0.384694  0.156994  1.10
policonsumo2.lag              -0.110303  0.895562  0.413318  0.144697 -0.76
edad_al_ing_1                  0.070663  1.073220  0.031269  0.032755  2.16
ano_nac_corr                   0.070856  1.073426  0.030683  0.032237  2.20
susinidum_oh                   1.203067  3.330315  0.559960  0.309989  3.88
susinidum_coc                  1.489861  4.436480  0.605530  0.345834  4.31
susinidum_pbc                  1.161622  3.195112  0.568769  0.322981  3.60
susinidum_mar                  1.193610  3.298968  0.561149  0.308066  3.87
psycom_dum_with               -0.067138  0.935066  0.150896  0.147822 -0.45
psycom_dum_study               0.000160  1.000160  0.172690  0.165963  0.00
freq_cons_dum_5day            -0.025945  0.974389  0.124841  0.121203 -0.21
cond_oc_dum_2inact            -0.166109  0.846954  0.226493  0.176276 -0.94
cond_oc_dum_3unemp            -0.253565  0.776029  0.230443  0.191113 -1.33
susprindum_oh                 -0.862997  0.421896  0.396358  0.251589 -3.43
susprindum_coc                -0.980906  0.374971  0.401764  0.255461 -3.84
susprindum_pbc                -0.844257  0.429877  0.377333  0.219059 -3.85
susprindum_mar                -0.321914  0.724761  0.572188  0.309357 -1.04
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.08871 .  
less_90d_tr1.lag               0.99699    
log_dias_treat_imp_sin_na.lag  0.00101 ** 
comp_bpsc_y3_severe.lag        0.27158    
policonsumo2.lag               0.44588    
edad_al_ing_1                  0.03098 *  
ano_nac_corr                   0.02795 *  
susinidum_oh                   0.00010 ***
susinidum_coc                  1.6e-05 ***
susinidum_pbc                  0.00032 ***
susinidum_mar                  0.00011 ***
psycom_dum_with                0.64970    
psycom_dum_study               0.99923    
freq_cons_dum_5day             0.83050    
cond_oc_dum_2inact             0.34603    
cond_oc_dum_3unemp             0.18458    
susprindum_oh                  0.00060 ***
susprindum_coc                 0.00012 ***
susprindum_pbc                 0.00012 ***
susprindum_mar                 0.29807    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.766      1.305     0.564     1.041
less_90d_tr1.lag                  0.999      1.001     0.636     1.569
log_dias_treat_imp_sin_na.lag     0.928      1.077     0.888     0.970
comp_bpsc_y3_severe.lag           1.188      0.841     0.874     1.617
policonsumo2.lag                  0.896      1.117     0.674     1.189
edad_al_ing_1                     1.073      0.932     1.006     1.144
ano_nac_corr                      1.073      0.932     1.008     1.143
susinidum_oh                      3.330      0.300     1.814     6.114
susinidum_coc                     4.436      0.225     2.252     8.738
susinidum_pbc                     3.195      0.313     1.697     6.017
susinidum_mar                     3.299      0.303     1.804     6.034
psycom_dum_with                   0.935      1.069     0.700     1.249
psycom_dum_study                  1.000      1.000     0.722     1.385
freq_cons_dum_5day                0.974      1.026     0.768     1.236
cond_oc_dum_2inact                0.847      1.181     0.600     1.196
cond_oc_dum_3unemp                0.776      1.289     0.534     1.129
susprindum_oh                     0.422      2.370     0.258     0.691
susprindum_coc                    0.375      2.667     0.227     0.619
susprindum_pbc                    0.430      2.326     0.280     0.660
susprindum_mar                    0.725      1.380     0.395     1.329

Concordance= 0.559  (se = 0.016 )
Likelihood ratio test= 23.1  on 20 df,   p=0.3
Wald test            = 77  on 20 df,   p=1e-08
Score (logrank) test = 22.5  on 20 df,   p=0.3,   Robust = 32.4  p=0.04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.28    0.80    0.91    0.95    1.07    3.45 
[1] "Modality: GP intensive ambulatory\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1813, number of events= 1813 
   (1667 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.06962   1.07210  0.17575   0.12489  0.56
less_90d_tr1.lag              -0.07466   0.92806  0.20374   0.16249 -0.46
log_dias_treat_imp_sin_na.lag -0.09521   0.90918  0.04869   0.02817 -3.38
comp_bpsc_y3_severe.lag        0.13504   1.14459  0.16871   0.13019  1.04
policonsumo2.lag              -0.12920   0.87880  0.18504   0.12763 -1.01
edad_al_ing_1                  0.04836   1.04955  0.01269   0.01237  3.91
ano_nac_corr                   0.05027   1.05156  0.01267   0.01256  4.00
susinidum_oh                  -0.22012   0.80242  0.18666   0.15267 -1.44
susinidum_coc                 -0.10184   0.90318  0.21646   0.18483 -0.55
susinidum_pbc                 -0.28630   0.75104  0.20610   0.18068 -1.58
susinidum_mar                 -0.26504   0.76718  0.18930   0.15669 -1.69
psycom_dum_with                0.03310   1.03365  0.05340   0.05364  0.62
psycom_dum_study              -0.02673   0.97362  0.07087   0.07139 -0.37
freq_cons_dum_5day             0.02375   1.02404  0.04873   0.04830  0.49
cond_oc_dum_2inact            -0.00351   0.99650  0.07187   0.07491 -0.05
cond_oc_dum_3unemp             0.09120   1.09549  0.05233   0.05132  1.78
susprindum_oh                  0.03331   1.03387  0.21842   0.17404  0.19
susprindum_coc                 0.08333   1.08691  0.22243   0.17940  0.46
susprindum_pbc                 0.06182   1.06377  0.21718   0.17311  0.36
susprindum_mar                 0.06484   1.06699  0.24196   0.19651  0.33
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.57722    
less_90d_tr1.lag               0.64589    
log_dias_treat_imp_sin_na.lag  0.00073 ***
comp_bpsc_y3_severe.lag        0.29961    
policonsumo2.lag               0.31140    
edad_al_ing_1                  9.3e-05 ***
ano_nac_corr                   6.2e-05 ***
susinidum_oh                   0.14937    
susinidum_coc                  0.58165    
susinidum_pbc                  0.11306    
susinidum_mar                  0.09074 .  
psycom_dum_with                0.53724    
psycom_dum_study               0.70810    
freq_cons_dum_5day             0.62291    
cond_oc_dum_2inact             0.96262    
cond_oc_dum_3unemp             0.07552 .  
susprindum_oh                  0.84823    
susprindum_coc                 0.64227    
susprindum_pbc                 0.72103    
susprindum_mar                 0.74142    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.072      0.933     0.839     1.369
less_90d_tr1.lag                  0.928      1.078     0.675     1.276
log_dias_treat_imp_sin_na.lag     0.909      1.100     0.860     0.961
comp_bpsc_y3_severe.lag           1.145      0.874     0.887     1.477
policonsumo2.lag                  0.879      1.138     0.684     1.129
edad_al_ing_1                     1.050      0.953     1.024     1.075
ano_nac_corr                      1.052      0.951     1.026     1.078
susinidum_oh                      0.802      1.246     0.595     1.082
susinidum_coc                     0.903      1.107     0.629     1.297
susinidum_pbc                     0.751      1.331     0.527     1.070
susinidum_mar                     0.767      1.303     0.564     1.043
psycom_dum_with                   1.034      0.967     0.930     1.148
psycom_dum_study                  0.974      1.027     0.846     1.120
freq_cons_dum_5day                1.024      0.977     0.932     1.126
cond_oc_dum_2inact                0.996      1.004     0.860     1.154
cond_oc_dum_3unemp                1.095      0.913     0.991     1.211
susprindum_oh                     1.034      0.967     0.735     1.454
susprindum_coc                    1.087      0.920     0.765     1.545
susprindum_pbc                    1.064      0.940     0.758     1.493
susprindum_mar                    1.067      0.937     0.726     1.568

Concordance= 0.541  (se = 0.008 )
Likelihood ratio test= 39.1  on 20 df,   p=0.006
Wald test            = 54.6  on 20 df,   p=5e-05
Score (logrank) test = 38.1  on 20 df,   p=0.009,   Robust = 47.8  p=5e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.54    1.02    1.11    1.14    1.22    2.25 
[1] "Modality: basic ambulatory\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1568, number of events= 1568 
   (1465 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.2806    0.7553   0.2365    0.1623 -1.73
less_90d_tr1.lag              -0.1925    0.8249   0.2784    0.2231 -0.86
log_dias_treat_imp_sin_na.lag -0.0676    0.9347   0.0771    0.0698 -0.97
comp_bpsc_y3_severe.lag        0.0964    1.1012   0.2221    0.1709  0.56
policonsumo2.lag               0.2001    1.2216   0.2863    0.2305  0.87
edad_al_ing_1                  0.0626    1.0646   0.0137    0.0134  4.66
ano_nac_corr                   0.0623    1.0643   0.0134    0.0134  4.63
susinidum_oh                   0.2785    1.3211   0.1894    0.1996  1.40
susinidum_coc                  0.1165    1.1236   0.2247    0.2413  0.48
susinidum_pbc                  0.2363    1.2665   0.2212    0.2252  1.05
susinidum_mar                  0.3165    1.3724   0.1923    0.2039  1.55
psycom_dum_with                0.0814    1.0848   0.0567    0.0577  1.41
psycom_dum_study               0.0763    1.0793   0.0745    0.0721  1.06
freq_cons_dum_5day            -0.0662    0.9359   0.0585    0.0580 -1.14
cond_oc_dum_2inact            -0.0688    0.9335   0.0799    0.0774 -0.89
cond_oc_dum_3unemp             0.0884    1.0924   0.0614    0.0612  1.44
susprindum_oh                 -0.1622    0.8503   0.2267    0.1865 -0.87
susprindum_coc                -0.1144    0.8919   0.2313    0.1933 -0.59
susprindum_pbc                -0.1726    0.8415   0.2259    0.1867 -0.92
susprindum_mar                -0.2593    0.7716   0.2436    0.2006 -1.29
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.084 .  
less_90d_tr1.lag                 0.388    
log_dias_treat_imp_sin_na.lag    0.333    
comp_bpsc_y3_severe.lag          0.573    
policonsumo2.lag                 0.385    
edad_al_ing_1                  3.1e-06 ***
ano_nac_corr                   3.6e-06 ***
susinidum_oh                     0.163    
susinidum_coc                    0.629    
susinidum_pbc                    0.294    
susinidum_mar                    0.121    
psycom_dum_with                  0.159    
psycom_dum_study                 0.290    
freq_cons_dum_5day               0.253    
cond_oc_dum_2inact               0.374    
cond_oc_dum_3unemp               0.149    
susprindum_oh                    0.385    
susprindum_coc                   0.554    
susprindum_pbc                   0.355    
susprindum_mar                   0.196    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.755      1.324     0.550      1.04
less_90d_tr1.lag                  0.825      1.212     0.533      1.28
log_dias_treat_imp_sin_na.lag     0.935      1.070     0.815      1.07
comp_bpsc_y3_severe.lag           1.101      0.908     0.788      1.54
policonsumo2.lag                  1.222      0.819     0.777      1.92
edad_al_ing_1                     1.065      0.939     1.037      1.09
ano_nac_corr                      1.064      0.940     1.037      1.09
susinidum_oh                      1.321      0.757     0.893      1.95
susinidum_coc                     1.124      0.890     0.700      1.80
susinidum_pbc                     1.266      0.790     0.815      1.97
susinidum_mar                     1.372      0.729     0.920      2.05
psycom_dum_with                   1.085      0.922     0.969      1.21
psycom_dum_study                  1.079      0.927     0.937      1.24
freq_cons_dum_5day                0.936      1.068     0.835      1.05
cond_oc_dum_2inact                0.933      1.071     0.802      1.09
cond_oc_dum_3unemp                1.092      0.915     0.969      1.23
susprindum_oh                     0.850      1.176     0.590      1.23
susprindum_coc                    0.892      1.121     0.611      1.30
susprindum_pbc                    0.841      1.188     0.584      1.21
susprindum_mar                    0.772      1.296     0.521      1.14

Concordance= 0.552  (se = 0.008 )
Likelihood ratio test= 46.9  on 20 df,   p=6e-04
Wald test            = 53.5  on 20 df,   p=7e-05
Score (logrank) test = 45.8  on 20 df,   p=9e-04,   Robust = 50.2  p=2e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.564   0.755   0.854   0.876   0.966   1.782 
[1] "Modality: GP residential\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 756, number of events= 756 
   (698 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.11740   1.12457  0.27673   0.16989  0.69
less_90d_tr1.lag              -0.26249   0.76914  0.35839   0.25620 -1.02
log_dias_treat_imp_sin_na.lag -0.03877   0.96197  0.09439   0.06274 -0.62
comp_bpsc_y3_severe.lag        0.83234   2.29869  0.35360   0.25940  3.21
policonsumo2.lag              -0.60054   0.54852  0.33875   0.21316 -2.82
edad_al_ing_1                  0.08079   1.08415  0.02030   0.01879  4.30
ano_nac_corr                   0.08407   1.08771  0.02014   0.01864  4.51
susinidum_oh                  -0.02922   0.97120  0.24781   0.31946 -0.09
susinidum_coc                  0.38760   1.47344  0.32554   0.36779  1.05
susinidum_pbc                  0.10639   1.11225  0.26543   0.32825  0.32
susinidum_mar                  0.00153   1.00153  0.24791   0.31782  0.00
psycom_dum_with               -0.11299   0.89316  0.08404   0.08392 -1.35
psycom_dum_study              -0.12624   0.88141  0.11726   0.11499 -1.10
freq_cons_dum_5day             0.00821   1.00824  0.08711   0.08190  0.10
cond_oc_dum_2inact             0.15730   1.17035  0.13868   0.14540  1.08
cond_oc_dum_3unemp             0.24127   1.27287  0.11430   0.10752  2.24
susprindum_oh                  0.17025   1.18561  0.33711   0.28315  0.60
susprindum_coc                -0.13689   0.87207  0.34443   0.29566 -0.46
susprindum_pbc                -0.01076   0.98930  0.32630   0.27168 -0.04
susprindum_mar                 0.12651   1.13486  0.37918   0.32173  0.39
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.4895    
less_90d_tr1.lag                0.3056    
log_dias_treat_imp_sin_na.lag   0.5366    
comp_bpsc_y3_severe.lag         0.0013 ** 
policonsumo2.lag                0.0048 ** 
edad_al_ing_1                  1.7e-05 ***
ano_nac_corr                   6.5e-06 ***
susinidum_oh                    0.9271    
susinidum_coc                   0.2919    
susinidum_pbc                   0.7459    
susinidum_mar                   0.9962    
psycom_dum_with                 0.1782    
psycom_dum_study                0.2723    
freq_cons_dum_5day              0.9201    
cond_oc_dum_2inact              0.2793    
cond_oc_dum_3unemp              0.0248 *  
susprindum_oh                   0.5476    
susprindum_coc                  0.6434    
susprindum_pbc                  0.9684    
susprindum_mar                  0.6942    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.125      0.889     0.806     1.569
less_90d_tr1.lag                  0.769      1.300     0.466     1.271
log_dias_treat_imp_sin_na.lag     0.962      1.040     0.851     1.088
comp_bpsc_y3_severe.lag           2.299      0.435     1.383     3.822
policonsumo2.lag                  0.549      1.823     0.361     0.833
edad_al_ing_1                     1.084      0.922     1.045     1.125
ano_nac_corr                      1.088      0.919     1.049     1.128
susinidum_oh                      0.971      1.030     0.519     1.817
susinidum_coc                     1.473      0.679     0.717     3.030
susinidum_pbc                     1.112      0.899     0.585     2.116
susinidum_mar                     1.002      0.998     0.537     1.867
psycom_dum_with                   0.893      1.120     0.758     1.053
psycom_dum_study                  0.881      1.135     0.704     1.104
freq_cons_dum_5day                1.008      0.992     0.859     1.184
cond_oc_dum_2inact                1.170      0.854     0.880     1.556
cond_oc_dum_3unemp                1.273      0.786     1.031     1.571
susprindum_oh                     1.186      0.843     0.681     2.065
susprindum_coc                    0.872      1.147     0.489     1.557
susprindum_pbc                    0.989      1.011     0.581     1.685
susprindum_mar                    1.135      0.881     0.604     2.132

Concordance= 0.568  (se = 0.012 )
Likelihood ratio test= 35.3  on 20 df,   p=0.02
Wald test            = 52.5  on 20 df,   p=1e-04
Score (logrank) test = 35.3  on 20 df,   p=0.02,   Robust = 42.6  p=0.002

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.356   0.747   0.864   0.881   0.997   2.334 
[1] "Modality: WO intensive ambulatory\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 272, number of events= 272 
   (247 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.8814    0.4142   0.5441    0.5149 -1.71
less_90d_tr1.lag               1.5933    4.9200   0.6802    0.5705  2.79
log_dias_treat_imp_sin_na.lag  0.1368    1.1466   0.1408    0.0886  1.54
comp_bpsc_y3_severe.lag       -0.8961    0.4082   0.5770    0.4669 -1.92
policonsumo2.lag               0.1904    1.2098   0.6121    0.5494  0.35
edad_al_ing_1                  0.0287    1.0291   0.0334    0.0299  0.96
ano_nac_corr                   0.0249    1.0252   0.0327    0.0303  0.82
susinidum_oh                  -0.5643    0.5688   0.4262    0.4298 -1.31
susinidum_coc                 -0.4115    0.6626   0.5134    0.5474 -0.75
susinidum_pbc                 -0.2852    0.7518   0.4498    0.4534 -0.63
susinidum_mar                 -0.3348    0.7155   0.4343    0.4430 -0.76
psycom_dum_with                0.1404    1.1507   0.1441    0.1395  1.01
psycom_dum_study              -0.2148    0.8067   0.2120    0.1910 -1.12
freq_cons_dum_5day             0.0442    1.0452   0.1350    0.1374  0.32
cond_oc_dum_2inact             0.0642    1.0663   0.1672    0.1630  0.39
cond_oc_dum_3unemp             0.1041    1.1097   0.1727    0.1660  0.63
susprindum_oh                 -0.3823    0.6823   0.4451    0.2921 -1.31
susprindum_coc                -0.1114    0.8946   0.4555    0.2828 -0.39
susprindum_pbc                -0.3088    0.7343   0.4311    0.2677 -1.15
susprindum_mar                -0.1062    0.8993   0.4811    0.3316 -0.32
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.0870 . 
less_90d_tr1.lag                0.0052 **
log_dias_treat_imp_sin_na.lag   0.1225   
comp_bpsc_y3_severe.lag         0.0550 . 
policonsumo2.lag                0.7289   
edad_al_ing_1                   0.3377   
ano_nac_corr                    0.4116   
susinidum_oh                    0.1893   
susinidum_coc                   0.4522   
susinidum_pbc                   0.5293   
susinidum_mar                   0.4498   
psycom_dum_with                 0.3141   
psycom_dum_study                0.2607   
freq_cons_dum_5day              0.7477   
cond_oc_dum_2inact              0.6937   
cond_oc_dum_3unemp              0.5307   
susprindum_oh                   0.1906   
susprindum_coc                  0.6936   
susprindum_pbc                  0.2486   
susprindum_mar                  0.7489   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.414      2.414     0.151      1.14
less_90d_tr1.lag                  4.920      0.203     1.608     15.05
log_dias_treat_imp_sin_na.lag     1.147      0.872     0.964      1.36
comp_bpsc_y3_severe.lag           0.408      2.450     0.163      1.02
policonsumo2.lag                  1.210      0.827     0.412      3.55
edad_al_ing_1                     1.029      0.972     0.971      1.09
ano_nac_corr                      1.025      0.975     0.966      1.09
susinidum_oh                      0.569      1.758     0.245      1.32
susinidum_coc                     0.663      1.509     0.227      1.94
susinidum_pbc                     0.752      1.330     0.309      1.83
susinidum_mar                     0.715      1.398     0.300      1.70
psycom_dum_with                   1.151      0.869     0.875      1.51
psycom_dum_study                  0.807      1.240     0.555      1.17
freq_cons_dum_5day                1.045      0.957     0.798      1.37
cond_oc_dum_2inact                1.066      0.938     0.775      1.47
cond_oc_dum_3unemp                1.110      0.901     0.802      1.54
susprindum_oh                     0.682      1.466     0.385      1.21
susprindum_coc                    0.895      1.118     0.514      1.56
susprindum_pbc                    0.734      1.362     0.435      1.24
susprindum_mar                    0.899      1.112     0.469      1.72

Concordance= 0.565  (se = 0.018 )
Likelihood ratio test= 23.4  on 20 df,   p=0.3
Wald test            = 47.7  on 20 df,   p=5e-04
Score (logrank) test = 21.3  on 20 df,   p=0.4,   Robust = 29  p=0.09

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.95    1.52    1.83    1.96    2.19    8.02 
[1] "Modality: WO residential\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 179, number of events= 179 
   (161 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.34247   0.71001  0.58467   0.53581 -0.64
less_90d_tr1.lag               0.21249   1.23676  0.75809   0.62317  0.34
log_dias_treat_imp_sin_na.lag -0.54691   0.57873  0.34815   0.24568 -2.23
comp_bpsc_y3_severe.lag        0.61124   1.84271  0.82117   0.69060  0.89
policonsumo2.lag               0.37707   1.45801  0.66872   0.38515  0.98
edad_al_ing_1                  0.03296   1.03351  0.05659   0.05666  0.58
ano_nac_corr                   0.04657   1.04767  0.05529   0.05527  0.84
susinidum_oh                  -0.86691   0.42025  0.63994   0.44744 -1.94
susinidum_coc                 -0.57378   0.56339  0.72954   0.51859 -1.11
susinidum_pbc                 -0.76562   0.46504  0.65980   0.46489 -1.65
susinidum_mar                 -0.41579   0.65982  0.63825   0.47410 -0.88
psycom_dum_with               -0.57579   0.56226  0.22564   0.21500 -2.68
psycom_dum_study              -0.64845   0.52285  0.26350   0.27055 -2.40
freq_cons_dum_5day             0.03824   1.03898  0.20734   0.20029  0.19
cond_oc_dum_2inact            -0.10678   0.89872  0.30182   0.23316 -0.46
cond_oc_dum_3unemp            -0.00802   0.99202  0.30611   0.23418 -0.03
susprindum_oh                  0.02049   1.02070  0.52190   0.40816  0.05
susprindum_coc                 0.24730   1.28057  0.53311   0.42121  0.59
susprindum_pbc                 0.05301   1.05444  0.48619   0.38701  0.14
susprindum_mar                -0.01869   0.98148  0.77774   0.59397 -0.03
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.5227   
less_90d_tr1.lag                0.7331   
log_dias_treat_imp_sin_na.lag   0.0260 * 
comp_bpsc_y3_severe.lag         0.3761   
policonsumo2.lag                0.3276   
edad_al_ing_1                   0.5607   
ano_nac_corr                    0.3995   
susinidum_oh                    0.0527 . 
susinidum_coc                   0.2685   
susinidum_pbc                   0.0996 . 
susinidum_mar                   0.3805   
psycom_dum_with                 0.0074 **
psycom_dum_study                0.0165 * 
freq_cons_dum_5day              0.8486   
cond_oc_dum_2inact              0.6470   
cond_oc_dum_3unemp              0.9727   
susprindum_oh                   0.9600   
susprindum_coc                  0.5571   
susprindum_pbc                  0.8910   
susprindum_mar                  0.9749   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.710      1.408     0.248     2.029
less_90d_tr1.lag                  1.237      0.809     0.365     4.195
log_dias_treat_imp_sin_na.lag     0.579      1.728     0.358     0.937
comp_bpsc_y3_severe.lag           1.843      0.543     0.476     7.133
policonsumo2.lag                  1.458      0.686     0.685     3.102
edad_al_ing_1                     1.034      0.968     0.925     1.155
ano_nac_corr                      1.048      0.955     0.940     1.168
susinidum_oh                      0.420      2.380     0.175     1.010
susinidum_coc                     0.563      1.775     0.204     1.557
susinidum_pbc                     0.465      2.150     0.187     1.157
susinidum_mar                     0.660      1.516     0.261     1.671
psycom_dum_with                   0.562      1.779     0.369     0.857
psycom_dum_study                  0.523      1.913     0.308     0.889
freq_cons_dum_5day                1.039      0.962     0.702     1.538
cond_oc_dum_2inact                0.899      1.113     0.569     1.419
cond_oc_dum_3unemp                0.992      1.008     0.627     1.570
susprindum_oh                     1.021      0.980     0.459     2.272
susprindum_coc                    1.281      0.781     0.561     2.924
susprindum_pbc                    1.054      0.948     0.494     2.251
susprindum_mar                    0.981      1.019     0.306     3.144

Concordance= 0.606  (se = 0.025 )
Likelihood ratio test= 31.1  on 20 df,   p=0.05
Wald test            = 49.6  on 20 df,   p=3e-04
Score (logrank) test = 29  on 20 df,   p=0.09,   Robust = 33.7  p=0.03

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    2.17    2.63    3.28    3.73   23.21 
[1] "Modality: GP intensive ambulatory\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 952, number of events= 952 
   (882 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.15073   1.16268  0.35885   0.20378  0.74
less_90d_tr1.lag              -0.12136   0.88571  0.31729   0.20318 -0.60
log_dias_treat_imp_sin_na.lag -0.11381   0.89243  0.12990   0.08126 -1.40
comp_bpsc_y3_severe.lag        0.18725   1.20593  0.24138   0.15731  1.19
policonsumo2.lag              -0.11770   0.88896  0.36364   0.21269 -0.55
edad_al_ing_1                  0.09190   1.09625  0.02330   0.02268  4.05
ano_nac_corr                   0.08750   1.09144  0.02299   0.02209  3.96
susinidum_oh                  -0.17827   0.83671  0.18565   0.18775 -0.95
susinidum_coc                 -0.00593   0.99409  0.23334   0.25203 -0.02
susinidum_pbc                  0.09783   1.10277  0.22926   0.22434  0.44
susinidum_mar                 -0.05800   0.94365  0.19141   0.19611 -0.30
psycom_dum_with                0.11281   1.11942  0.07412   0.07576  1.49
psycom_dum_study               0.07157   1.07419  0.09999   0.09527  0.75
freq_cons_dum_5day             0.03258   1.03312  0.06785   0.06701  0.49
cond_oc_dum_2inact             0.08914   1.09324  0.10393   0.10346  0.86
cond_oc_dum_3unemp            -0.00713   0.99289  0.07171   0.07102 -0.10
susprindum_oh                 -0.33803   0.71318  0.30827   0.26428 -1.28
susprindum_coc                -0.49815   0.60766  0.31335   0.27108 -1.84
susprindum_pbc                -0.35665   0.70002  0.30391   0.26104 -1.37
susprindum_mar                -0.37735   0.68567  0.32531   0.29473 -1.28
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.460    
less_90d_tr1.lag                 0.550    
log_dias_treat_imp_sin_na.lag    0.161    
comp_bpsc_y3_severe.lag          0.234    
policonsumo2.lag                 0.580    
edad_al_ing_1                  5.1e-05 ***
ano_nac_corr                   7.5e-05 ***
susinidum_oh                     0.342    
susinidum_coc                    0.981    
susinidum_pbc                    0.663    
susinidum_mar                    0.767    
psycom_dum_with                  0.137    
psycom_dum_study                 0.453    
freq_cons_dum_5day               0.627    
cond_oc_dum_2inact               0.389    
cond_oc_dum_3unemp               0.920    
susprindum_oh                    0.201    
susprindum_coc                   0.066 .  
susprindum_pbc                   0.172    
susprindum_mar                   0.200    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.163      0.860     0.780      1.73
less_90d_tr1.lag                  0.886      1.129     0.595      1.32
log_dias_treat_imp_sin_na.lag     0.892      1.121     0.761      1.05
comp_bpsc_y3_severe.lag           1.206      0.829     0.886      1.64
policonsumo2.lag                  0.889      1.125     0.586      1.35
edad_al_ing_1                     1.096      0.912     1.049      1.15
ano_nac_corr                      1.091      0.916     1.045      1.14
susinidum_oh                      0.837      1.195     0.579      1.21
susinidum_coc                     0.994      1.006     0.607      1.63
susinidum_pbc                     1.103      0.907     0.710      1.71
susinidum_mar                     0.944      1.060     0.643      1.39
psycom_dum_with                   1.119      0.893     0.965      1.30
psycom_dum_study                  1.074      0.931     0.891      1.29
freq_cons_dum_5day                1.033      0.968     0.906      1.18
cond_oc_dum_2inact                1.093      0.915     0.893      1.34
cond_oc_dum_3unemp                0.993      1.007     0.864      1.14
susprindum_oh                     0.713      1.402     0.425      1.20
susprindum_coc                    0.608      1.646     0.357      1.03
susprindum_pbc                    0.700      1.429     0.420      1.17
susprindum_mar                    0.686      1.458     0.385      1.22

Concordance= 0.563  (se = 0.01 )
Likelihood ratio test= 35.7  on 20 df,   p=0.02
Wald test            = 44.3  on 20 df,   p=0.001
Score (logrank) test = 35.4  on 20 df,   p=0.02,   Robust = 41.4  p=0.003

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.81    1.28    1.46    1.50    1.68    3.37 
[1] "Modality: basic ambulatory\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 975, number of events= 975 
   (912 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.1636    0.8491   0.2844    0.2281 -0.72
less_90d_tr1.lag              -0.4111    0.6629   0.3383    0.2087 -1.97
log_dias_treat_imp_sin_na.lag -0.1009    0.9041   0.0857    0.0621 -1.62
comp_bpsc_y3_severe.lag        0.2623    1.3000   0.2522    0.1943  1.35
policonsumo2.lag               0.0830    1.0866   0.2859    0.2368  0.35
edad_al_ing_1                  0.1263    1.1346   0.0210    0.0197  6.41
ano_nac_corr                   0.1315    1.1406   0.0209    0.0198  6.64
susinidum_oh                  -0.0636    0.9384   0.1742    0.2007 -0.32
susinidum_coc                 -0.3028    0.7387   0.2403    0.2725 -1.11
susinidum_pbc                 -0.1116    0.8944   0.2203    0.2294 -0.49
susinidum_mar                 -0.0607    0.9411   0.1806    0.2032 -0.30
psycom_dum_with               -0.1183    0.8884   0.0739    0.0733 -1.61
psycom_dum_study              -0.0289    0.9715   0.0939    0.0925 -0.31
freq_cons_dum_5day             0.0824    1.0859   0.0754    0.0759  1.09
cond_oc_dum_2inact             0.1289    1.1376   0.1038    0.1014  1.27
cond_oc_dum_3unemp             0.0419    1.0428   0.0784    0.0761  0.55
susprindum_oh                  0.2948    1.3428   0.2325    0.2324  1.27
susprindum_coc                 0.2484    1.2820   0.2364    0.2344  1.06
susprindum_pbc                 0.1830    1.2009   0.2330    0.2318  0.79
susprindum_mar                 0.0408    1.0416   0.2557    0.2599  0.16
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.473    
less_90d_tr1.lag                 0.049 *  
log_dias_treat_imp_sin_na.lag    0.104    
comp_bpsc_y3_severe.lag          0.177    
policonsumo2.lag                 0.726    
edad_al_ing_1                  1.4e-10 ***
ano_nac_corr                   3.1e-11 ***
susinidum_oh                     0.751    
susinidum_coc                    0.267    
susinidum_pbc                    0.627    
susinidum_mar                    0.765    
psycom_dum_with                  0.107    
psycom_dum_study                 0.754    
freq_cons_dum_5day               0.278    
cond_oc_dum_2inact               0.204    
cond_oc_dum_3unemp               0.582    
susprindum_oh                    0.205    
susprindum_coc                   0.289    
susprindum_pbc                   0.430    
susprindum_mar                   0.875    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.849      1.178     0.543     1.328
less_90d_tr1.lag                  0.663      1.508     0.440     0.998
log_dias_treat_imp_sin_na.lag     0.904      1.106     0.800     1.021
comp_bpsc_y3_severe.lag           1.300      0.769     0.888     1.903
policonsumo2.lag                  1.087      0.920     0.683     1.728
edad_al_ing_1                     1.135      0.881     1.092     1.179
ano_nac_corr                      1.141      0.877     1.097     1.186
susinidum_oh                      0.938      1.066     0.633     1.391
susinidum_coc                     0.739      1.354     0.433     1.260
susinidum_pbc                     0.894      1.118     0.570     1.402
susinidum_mar                     0.941      1.063     0.632     1.401
psycom_dum_with                   0.888      1.126     0.770     1.026
psycom_dum_study                  0.971      1.029     0.810     1.164
freq_cons_dum_5day                1.086      0.921     0.936     1.260
cond_oc_dum_2inact                1.138      0.879     0.932     1.388
cond_oc_dum_3unemp                1.043      0.959     0.898     1.211
susprindum_oh                     1.343      0.745     0.852     2.118
susprindum_coc                    1.282      0.780     0.810     2.030
susprindum_pbc                    1.201      0.833     0.762     1.891
susprindum_mar                    1.042      0.960     0.626     1.734

Concordance= 0.578  (se = 0.01 )
Likelihood ratio test= 66  on 20 df,   p=8e-07
Wald test            = 70.7  on 20 df,   p=1e-07
Score (logrank) test = 65.2  on 20 df,   p=1e-06,   Robust = 71  p=1e-07

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.468   0.703   0.866   0.903   1.059   2.559 
[1] "Modality: GP residential\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 392, number of events= 392 
   (361 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se      z
tr_outcome.lag                -0.9365    0.3920   0.4568    0.3123  -3.00
less_90d_tr1.lag               0.4865    1.6266   0.5871    0.4173   1.17
log_dias_treat_imp_sin_na.lag  0.0244    1.0247   0.1835    0.1265   0.19
comp_bpsc_y3_severe.lag       -0.2099    0.8107   0.5023    0.3620  -0.58
policonsumo2.lag               0.2445    1.2769   0.6041    0.4989   0.49
edad_al_ing_1                  0.0888    1.0928   0.0377    0.0376   2.36
ano_nac_corr                   0.1002    1.1053   0.0376    0.0379   2.64
susinidum_oh                   0.3006    1.3507   0.2867    0.2624   1.15
susinidum_coc                  0.2230    1.2498   0.3793    0.3298   0.68
susinidum_pbc                  0.1229    1.1308   0.3167    0.2983   0.41
susinidum_mar                  0.0527    1.0541   0.2870    0.2583   0.20
psycom_dum_with               -0.2135    0.8077   0.1207    0.1185  -1.80
psycom_dum_study              -0.1890    0.8278   0.1750    0.1622  -1.17
freq_cons_dum_5day            -0.1111    0.8948   0.1189    0.1213  -0.92
cond_oc_dum_2inact             0.0119    1.0120   0.2003    0.1955   0.06
cond_oc_dum_3unemp            -0.1085    0.8972   0.1560    0.1579  -0.69
susprindum_oh                 -1.6833    0.1858   0.7330    0.2015  -8.35
susprindum_coc                -2.0533    0.1283   0.7406    0.2254  -9.11
susprindum_pbc                -1.8949    0.1503   0.7271    0.1580 -11.99
susprindum_mar                -1.9872    0.1371   0.8088    0.4221  -4.71
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.0027 ** 
less_90d_tr1.lag                0.2437    
log_dias_treat_imp_sin_na.lag   0.8471    
comp_bpsc_y3_severe.lag         0.5621    
policonsumo2.lag                0.6241    
edad_al_ing_1                   0.0183 *  
ano_nac_corr                    0.0083 ** 
susinidum_oh                    0.2520    
susinidum_coc                   0.4989    
susinidum_pbc                   0.6803    
susinidum_mar                   0.8384    
psycom_dum_with                 0.0715 .  
psycom_dum_study                0.2438    
freq_cons_dum_5day              0.3595    
cond_oc_dum_2inact              0.9514    
cond_oc_dum_3unemp              0.4920    
susprindum_oh                  &lt; 2e-16 ***
susprindum_coc                 &lt; 2e-16 ***
susprindum_pbc                 &lt; 2e-16 ***
susprindum_mar                 2.5e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.392      2.551    0.2125     0.723
less_90d_tr1.lag                  1.627      0.615    0.7179     3.685
log_dias_treat_imp_sin_na.lag     1.025      0.976    0.7997     1.313
comp_bpsc_y3_severe.lag           0.811      1.234    0.3987     1.648
policonsumo2.lag                  1.277      0.783    0.4803     3.395
edad_al_ing_1                     1.093      0.915    1.0152     1.176
ano_nac_corr                      1.105      0.905    1.0261     1.191
susinidum_oh                      1.351      0.740    0.8076     2.259
susinidum_coc                     1.250      0.800    0.6548     2.386
susinidum_pbc                     1.131      0.884    0.6301     2.029
susinidum_mar                     1.054      0.949    0.6353     1.749
psycom_dum_with                   0.808      1.238    0.6404     1.019
psycom_dum_study                  0.828      1.208    0.6024     1.138
freq_cons_dum_5day                0.895      1.118    0.7055     1.135
cond_oc_dum_2inact                1.012      0.988    0.6899     1.484
cond_oc_dum_3unemp                0.897      1.115    0.6583     1.223
susprindum_oh                     0.186      5.384    0.1252     0.276
susprindum_coc                    0.128      7.794    0.0825     0.200
susprindum_pbc                    0.150      6.652    0.1103     0.205
susprindum_mar                    0.137      7.295    0.0599     0.314

Concordance= 0.578  (se = 0.017 )
Likelihood ratio test= 33.6  on 20 df,   p=0.03
Wald test            = 228  on 20 df,   p=&lt;2e-16
Score (logrank) test = 35  on 20 df,   p=0.02,   Robust = 32.5  p=0.04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.40    6.41    7.57    8.01    8.96   24.67 
[1] "Modality: WO intensive ambulatory\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 147, number of events= 147 
   (135 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 2.1717    8.7728   0.9544    0.7971  2.72
less_90d_tr1.lag               1.2465    3.4781   1.2201    0.7444  1.67
log_dias_treat_imp_sin_na.lag -0.2393    0.7872   0.1925    0.1025 -2.33
comp_bpsc_y3_severe.lag        2.0365    7.6639   1.0136    0.6358  3.20
policonsumo2.lag              -2.9230    0.0538   1.2871    0.7707 -3.79
edad_al_ing_1                  0.1148    1.1217   0.0580    0.0543  2.11
ano_nac_corr                   0.1032    1.1087   0.0557    0.0526  1.96
susinidum_oh                  -0.3817    0.6827   0.6662    0.3756 -1.02
susinidum_coc                  0.0769    1.0800   0.8669    0.7215  0.11
susinidum_pbc                 -0.6811    0.5060   0.7061    0.4589 -1.48
susinidum_mar                 -0.3223    0.7245   0.6791    0.4243 -0.76
psycom_dum_with               -0.0156    0.9845   0.2213    0.2287 -0.07
psycom_dum_study               0.2414    1.2730   0.3154    0.3129  0.77
freq_cons_dum_5day            -0.0729    0.9297   0.1940    0.1803 -0.40
cond_oc_dum_2inact             0.1242    1.1323   0.2438    0.2646  0.47
cond_oc_dum_3unemp            -0.0392    0.9615   0.2570    0.2860 -0.14
susprindum_oh                 -0.5190    0.5951   0.7758    0.3672 -1.41
susprindum_coc                -0.7877    0.4549   0.8090    0.5286 -1.49
susprindum_pbc                -0.3925    0.6754   0.7660    0.3953 -0.99
susprindum_mar                -1.0265    0.3583   0.8136    0.4512 -2.28
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.00644 ** 
less_90d_tr1.lag               0.09406 .  
log_dias_treat_imp_sin_na.lag  0.01957 *  
comp_bpsc_y3_severe.lag        0.00136 ** 
policonsumo2.lag               0.00015 ***
edad_al_ing_1                  0.03457 *  
ano_nac_corr                   0.04983 *  
susinidum_oh                   0.30951    
susinidum_coc                  0.91510    
susinidum_pbc                  0.13773    
susinidum_mar                  0.44753    
psycom_dum_with                0.94560    
psycom_dum_study               0.44047    
freq_cons_dum_5day             0.68583    
cond_oc_dum_2inact             0.63867    
cond_oc_dum_3unemp             0.89088    
susprindum_oh                  0.15756    
susprindum_coc                 0.13619    
susprindum_pbc                 0.32072    
susprindum_mar                 0.02290 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                   8.7728      0.114    1.8393    41.844
less_90d_tr1.lag                 3.4781      0.288    0.8085    14.963
log_dias_treat_imp_sin_na.lag    0.7872      1.270    0.6439     0.962
comp_bpsc_y3_severe.lag          7.6639      0.130    2.2042    26.647
policonsumo2.lag                 0.0538     18.597    0.0119     0.244
edad_al_ing_1                    1.1217      0.892    1.0084     1.248
ano_nac_corr                     1.1087      0.902    1.0001     1.229
susinidum_oh                     0.6827      1.465    0.3270     1.425
susinidum_coc                    1.0800      0.926    0.2626     4.441
susinidum_pbc                    0.5060      1.976    0.2059     1.244
susinidum_mar                    0.7245      1.380    0.3154     1.664
psycom_dum_with                  0.9845      1.016    0.6288     1.541
psycom_dum_study                 1.2730      0.786    0.6894     2.351
freq_cons_dum_5day               0.9297      1.076    0.6529     1.324
cond_oc_dum_2inact               1.1323      0.883    0.6742     1.902
cond_oc_dum_3unemp               0.9615      1.040    0.5489     1.684
susprindum_oh                    0.5951      1.680    0.2897     1.222
susprindum_coc                   0.4549      2.198    0.1614     1.282
susprindum_pbc                   0.6754      1.481    0.3112     1.466
susprindum_mar                   0.3583      2.791    0.1480     0.867

Concordance= 0.616  (se = 0.024 )
Likelihood ratio test= 30.5  on 20 df,   p=0.06
Wald test            = 95.8  on 20 df,   p=7e-12
Score (logrank) test = 28.2  on 20 df,   p=0.1,   Robust = 27.9  p=0.1

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.01    1.75    2.26    2.72    2.77   26.75 
[1] "Modality: WO residential\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 140, number of events= 140 
   (114 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.1218    1.1296   0.4994    0.3683  0.33
less_90d_tr1.lag              -0.3431    0.7096   0.6058    0.3729 -0.92
log_dias_treat_imp_sin_na.lag -0.1413    0.8683   0.1374    0.1287 -1.10
comp_bpsc_y3_severe.lag       -0.0120    0.9881   0.5646    0.3978 -0.03
policonsumo2.lag               0.3567    1.4286   0.6815    0.5466  0.65
edad_al_ing_1                  0.7500    2.1170   0.1299    0.1256  5.97
ano_nac_corr                   0.7538    2.1251   0.1269    0.1211  6.22
susinidum_oh                  -0.1588    0.8532   0.7420    0.6603 -0.24
susinidum_coc                  0.2858    1.3308   0.9144    0.8027  0.36
susinidum_pbc                  0.0273    1.0277   0.7797    0.7058  0.04
susinidum_mar                 -0.4422    0.6426   0.7490    0.6758 -0.65
psycom_dum_with                0.2162    1.2413   0.2481    0.2176  0.99
psycom_dum_study               0.3097    1.3631   0.3015    0.2705  1.15
freq_cons_dum_5day            -0.1209    0.8861   0.2272    0.2189 -0.55
cond_oc_dum_2inact             0.3602    1.4335   0.3818    0.2755  1.31
cond_oc_dum_3unemp             0.3172    1.3732   0.3740    0.2661  1.19
susprindum_oh                 -0.8760    0.4165   0.6861    0.5430 -1.61
susprindum_coc                -0.7450    0.4747   0.6871    0.5893 -1.26
susprindum_pbc                -0.8698    0.4190   0.6718    0.5723 -1.52
susprindum_mar                -0.0988    0.9060   0.8162    0.7142 -0.14
                              Pr(&gt;|z|)    
tr_outcome.lag                    0.74    
less_90d_tr1.lag                  0.36    
log_dias_treat_imp_sin_na.lag     0.27    
comp_bpsc_y3_severe.lag           0.98    
policonsumo2.lag                  0.51    
edad_al_ing_1                  2.3e-09 ***
ano_nac_corr                   4.9e-10 ***
susinidum_oh                      0.81    
susinidum_coc                     0.72    
susinidum_pbc                     0.97    
susinidum_mar                     0.51    
psycom_dum_with                   0.32    
psycom_dum_study                  0.25    
freq_cons_dum_5day                0.58    
cond_oc_dum_2inact                0.19    
cond_oc_dum_3unemp                0.23    
susprindum_oh                     0.11    
susprindum_coc                    0.21    
susprindum_pbc                    0.13    
susprindum_mar                    0.89    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.130      0.885     0.549      2.32
less_90d_tr1.lag                  0.710      1.409     0.342      1.47
log_dias_treat_imp_sin_na.lag     0.868      1.152     0.675      1.12
comp_bpsc_y3_severe.lag           0.988      1.012     0.453      2.16
policonsumo2.lag                  1.429      0.700     0.489      4.17
edad_al_ing_1                     2.117      0.472     1.655      2.71
ano_nac_corr                      2.125      0.471     1.676      2.69
susinidum_oh                      0.853      1.172     0.234      3.11
susinidum_coc                     1.331      0.751     0.276      6.42
susinidum_pbc                     1.028      0.973     0.258      4.10
susinidum_mar                     0.643      1.556     0.171      2.42
psycom_dum_with                   1.241      0.806     0.810      1.90
psycom_dum_study                  1.363      0.734     0.802      2.32
freq_cons_dum_5day                0.886      1.129     0.577      1.36
cond_oc_dum_2inact                1.434      0.698     0.835      2.46
cond_oc_dum_3unemp                1.373      0.728     0.815      2.31
susprindum_oh                     0.416      2.401     0.144      1.21
susprindum_coc                    0.475      2.106     0.150      1.51
susprindum_pbc                    0.419      2.386     0.136      1.29
susprindum_mar                    0.906      1.104     0.223      3.67

Concordance= 0.689  (se = 0.021 )
Likelihood ratio test= 59.3  on 20 df,   p=9e-06
Wald test            = 97  on 20 df,   p=4e-12
Score (logrank) test = 66  on 20 df,   p=8e-07,   Robust = 66.5  p=7e-07

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.22    0.97    2.11    2.33    3.15    8.03 
[1] "Modality: GP intensive ambulatory\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 747, number of events= 747 
   (659 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.2388    0.7875   0.2250    0.1650 -1.45
less_90d_tr1.lag               0.0671    1.0694   0.3007    0.2596  0.26
log_dias_treat_imp_sin_na.lag -0.0766    0.9263   0.0842    0.0612 -1.25
comp_bpsc_y3_severe.lag        0.1116    1.1180   0.2199    0.1661  0.67
policonsumo2.lag               0.2374    1.2680   0.2585    0.1697  1.40
edad_al_ing_1                  0.5374    1.7116   0.0388    0.0361 14.88
ano_nac_corr                   0.5364    1.7098   0.0388    0.0359 14.95
susinidum_oh                  -0.0780    0.9250   0.2302    0.2226 -0.35
susinidum_coc                  0.0180    1.0182   0.2923    0.2846  0.06
susinidum_pbc                  0.0170    1.0171   0.2861    0.2684  0.06
susinidum_mar                  0.0206    1.0208   0.2366    0.2294  0.09
psycom_dum_with               -0.1143    0.8920   0.0833    0.0801 -1.43
psycom_dum_study              -0.0224    0.9779   0.1145    0.1047 -0.21
freq_cons_dum_5day            -0.0159    0.9842   0.0788    0.0728 -0.22
cond_oc_dum_2inact             0.0776    1.0807   0.1227    0.1112  0.70
cond_oc_dum_3unemp             0.0321    1.0326   0.0832    0.0774  0.41
susprindum_oh                 -0.0722    0.9304   0.3341    0.1880 -0.38
susprindum_coc                -0.0727    0.9299   0.3364    0.1937 -0.38
susprindum_pbc                -0.1282    0.8797   0.3291    0.1787 -0.72
susprindum_mar                -0.0377    0.9630   0.3534    0.2304 -0.16
                              Pr(&gt;|z|)    
tr_outcome.lag                    0.15    
less_90d_tr1.lag                  0.80    
log_dias_treat_imp_sin_na.lag     0.21    
comp_bpsc_y3_severe.lag           0.50    
policonsumo2.lag                  0.16    
edad_al_ing_1                   &lt;2e-16 ***
ano_nac_corr                    &lt;2e-16 ***
susinidum_oh                      0.73    
susinidum_coc                     0.95    
susinidum_pbc                     0.95    
susinidum_mar                     0.93    
psycom_dum_with                   0.15    
psycom_dum_study                  0.83    
freq_cons_dum_5day                0.83    
cond_oc_dum_2inact                0.49    
cond_oc_dum_3unemp                0.68    
susprindum_oh                     0.70    
susprindum_coc                    0.71    
susprindum_pbc                    0.47    
susprindum_mar                    0.87    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.788      1.270     0.570      1.09
less_90d_tr1.lag                  1.069      0.935     0.643      1.78
log_dias_treat_imp_sin_na.lag     0.926      1.080     0.822      1.04
comp_bpsc_y3_severe.lag           1.118      0.894     0.807      1.55
policonsumo2.lag                  1.268      0.789     0.909      1.77
edad_al_ing_1                     1.712      0.584     1.595      1.84
ano_nac_corr                      1.710      0.585     1.594      1.83
susinidum_oh                      0.925      1.081     0.598      1.43
susinidum_coc                     1.018      0.982     0.583      1.78
susinidum_pbc                     1.017      0.983     0.601      1.72
susinidum_mar                     1.021      0.980     0.651      1.60
psycom_dum_with                   0.892      1.121     0.762      1.04
psycom_dum_study                  0.978      1.023     0.796      1.20
freq_cons_dum_5day                0.984      1.016     0.853      1.14
cond_oc_dum_2inact                1.081      0.925     0.869      1.34
cond_oc_dum_3unemp                1.033      0.968     0.887      1.20
susprindum_oh                     0.930      1.075     0.644      1.34
susprindum_coc                    0.930      1.075     0.636      1.36
susprindum_pbc                    0.880      1.137     0.620      1.25
susprindum_mar                    0.963      1.038     0.613      1.51

Concordance= 0.642  (se = 0.011 )
Likelihood ratio test= 213  on 20 df,   p=&lt;2e-16
Wald test            = 269  on 20 df,   p=&lt;2e-16
Score (logrank) test = 216  on 20 df,   p=&lt;2e-16,   Robust = 195  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.19    0.77    1.29    1.46    1.93    6.42 
[1] "Modality: basic ambulatory\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 699, number of events= 699 
   (617 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.1225    1.1304   0.2986    0.2606  0.47
less_90d_tr1.lag              -0.1555    0.8560   0.3452    0.2417 -0.64
log_dias_treat_imp_sin_na.lag -0.1626    0.8499   0.0931    0.0629 -2.58
comp_bpsc_y3_severe.lag        0.5189    1.6802   0.2279    0.2013  2.58
policonsumo2.lag               0.0739    1.0767   0.3118    0.2749  0.27
edad_al_ing_1                  0.5115    1.6679   0.0417    0.0412 12.41
ano_nac_corr                   0.5102    1.6655   0.0414    0.0410 12.44
susinidum_oh                  -0.1429    0.8668   0.2422    0.2256 -0.63
susinidum_coc                 -0.3566    0.7000   0.2801    0.2538 -1.40
susinidum_pbc                 -0.1280    0.8798   0.2786    0.2567 -0.50
susinidum_mar                 -0.1350    0.8737   0.2499    0.2303 -0.59
psycom_dum_with                0.0772    1.0803   0.0868    0.0828  0.93
psycom_dum_study              -0.0475    0.9536   0.1097    0.0992 -0.48
freq_cons_dum_5day            -0.0150    0.9851   0.0881    0.0823 -0.18
cond_oc_dum_2inact             0.1047    1.1104   0.1201    0.1228  0.85
cond_oc_dum_3unemp            -0.1221    0.8850   0.0954    0.0850 -1.44
susprindum_oh                 -0.2467    0.7814   0.3190    0.2537 -0.97
susprindum_coc                -0.1435    0.8663   0.3174    0.2495 -0.57
susprindum_pbc                -0.1953    0.8226   0.3134    0.2427 -0.80
susprindum_mar                -0.0947    0.9097   0.3344    0.2619 -0.36
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.6382    
less_90d_tr1.lag                0.5201    
log_dias_treat_imp_sin_na.lag   0.0098 ** 
comp_bpsc_y3_severe.lag         0.0100 ** 
policonsumo2.lag                0.7881    
edad_al_ing_1                   &lt;2e-16 ***
ano_nac_corr                    &lt;2e-16 ***
susinidum_oh                    0.5265    
susinidum_coc                   0.1601    
susinidum_pbc                   0.6180    
susinidum_mar                   0.5576    
psycom_dum_with                 0.3511    
psycom_dum_study                0.6320    
freq_cons_dum_5day              0.8557    
cond_oc_dum_2inact              0.3939    
cond_oc_dum_3unemp              0.1507    
susprindum_oh                   0.3310    
susprindum_coc                  0.5653    
susprindum_pbc                  0.4210    
susprindum_mar                  0.7177    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.130      0.885     0.678     1.884
less_90d_tr1.lag                  0.856      1.168     0.533     1.375
log_dias_treat_imp_sin_na.lag     0.850      1.177     0.751     0.962
comp_bpsc_y3_severe.lag           1.680      0.595     1.132     2.493
policonsumo2.lag                  1.077      0.929     0.628     1.845
edad_al_ing_1                     1.668      0.600     1.538     1.808
ano_nac_corr                      1.666      0.600     1.537     1.805
susinidum_oh                      0.867      1.154     0.557     1.349
susinidum_coc                     0.700      1.428     0.426     1.151
susinidum_pbc                     0.880      1.137     0.532     1.455
susinidum_mar                     0.874      1.145     0.556     1.372
psycom_dum_with                   1.080      0.926     0.918     1.271
psycom_dum_study                  0.954      1.049     0.785     1.158
freq_cons_dum_5day                0.985      1.015     0.838     1.158
cond_oc_dum_2inact                1.110      0.901     0.873     1.413
cond_oc_dum_3unemp                0.885      1.130     0.749     1.045
susprindum_oh                     0.781      1.280     0.475     1.285
susprindum_coc                    0.866      1.154     0.531     1.413
susprindum_pbc                    0.823      1.216     0.511     1.324
susprindum_mar                    0.910      1.099     0.544     1.520

Concordance= 0.626  (se = 0.012 )
Likelihood ratio test= 168  on 20 df,   p=&lt;2e-16
Wald test            = 186  on 20 df,   p=&lt;2e-16
Score (logrank) test = 168  on 20 df,   p=&lt;2e-16,   Robust = 154  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.25    0.88    1.42    1.60    2.05    8.41 
[1] "Modality: GP residential\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 325, number of events= 325 
   (273 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.0928    0.9113   0.3333    0.2138 -0.43
less_90d_tr1.lag               0.0753    1.0782   0.3822    0.2800  0.27
log_dias_treat_imp_sin_na.lag -0.0724    0.9302   0.1271    0.1081 -0.67
comp_bpsc_y3_severe.lag        0.2079    1.2311   0.3464    0.2177  0.95
policonsumo2.lag              -0.3087    0.7344   0.3645    0.2956 -1.04
edad_al_ing_1                  0.6032    1.8279   0.0654    0.0575 10.49
ano_nac_corr                   0.6012    1.8243   0.0655    0.0572 10.51
susinidum_oh                  -0.5745    0.5630   0.3975    0.2152 -2.67
susinidum_coc                 -0.5009    0.6060   0.4717    0.2745 -1.82
susinidum_pbc                 -0.6329    0.5310   0.4197    0.2457 -2.58
susinidum_mar                 -0.7080    0.4926   0.4014    0.2244 -3.16
psycom_dum_with                0.0821    1.0856   0.1289    0.1197  0.69
psycom_dum_study               0.1134    1.1201   0.1851    0.1634  0.69
freq_cons_dum_5day            -0.1383    0.8709   0.1261    0.1162 -1.19
cond_oc_dum_2inact            -0.3026    0.7389   0.2316    0.2019 -1.50
cond_oc_dum_3unemp            -0.3872    0.6789   0.1644    0.1483 -2.61
susprindum_oh                  0.1674    1.1822   0.7395    0.3219  0.52
susprindum_coc                 0.2205    1.2467   0.7360    0.3168  0.70
susprindum_pbc                 0.3005    1.3506   0.7227    0.2687  1.12
susprindum_mar                 0.3069    1.3591   0.8012    0.3779  0.81
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.6641    
less_90d_tr1.lag                0.7879    
log_dias_treat_imp_sin_na.lag   0.5032    
comp_bpsc_y3_severe.lag         0.3397    
policonsumo2.lag                0.2964    
edad_al_ing_1                   &lt;2e-16 ***
ano_nac_corr                    &lt;2e-16 ***
susinidum_oh                    0.0076 ** 
susinidum_coc                   0.0681 .  
susinidum_pbc                   0.0100 *  
susinidum_mar                   0.0016 ** 
psycom_dum_with                 0.4926    
psycom_dum_study                0.4876    
freq_cons_dum_5day              0.2340    
cond_oc_dum_2inact              0.1339    
cond_oc_dum_3unemp              0.0090 ** 
susprindum_oh                   0.6031    
susprindum_coc                  0.4865    
susprindum_pbc                  0.2634    
susprindum_mar                  0.4167    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.911      1.097     0.599     1.386
less_90d_tr1.lag                  1.078      0.927     0.623     1.867
log_dias_treat_imp_sin_na.lag     0.930      1.075     0.752     1.150
comp_bpsc_y3_severe.lag           1.231      0.812     0.803     1.886
policonsumo2.lag                  0.734      1.362     0.411     1.311
edad_al_ing_1                     1.828      0.547     1.633     2.046
ano_nac_corr                      1.824      0.548     1.631     2.041
susinidum_oh                      0.563      1.776     0.369     0.858
susinidum_coc                     0.606      1.650     0.354     1.038
susinidum_pbc                     0.531      1.883     0.328     0.860
susinidum_mar                     0.493      2.030     0.317     0.765
psycom_dum_with                   1.086      0.921     0.859     1.373
psycom_dum_study                  1.120      0.893     0.813     1.543
freq_cons_dum_5day                0.871      1.148     0.694     1.094
cond_oc_dum_2inact                0.739      1.353     0.497     1.098
cond_oc_dum_3unemp                0.679      1.473     0.508     0.908
susprindum_oh                     1.182      0.846     0.629     2.222
susprindum_coc                    1.247      0.802     0.670     2.320
susprindum_pbc                    1.351      0.740     0.798     2.287
susprindum_mar                    1.359      0.736     0.648     2.850

Concordance= 0.651  (se = 0.015 )
Likelihood ratio test= 96.8  on 20 df,   p=5e-12
Wald test            = 144  on 20 df,   p=&lt;2e-16
Score (logrank) test = 100  on 20 df,   p=1e-12,   Robust = 103  p=4e-13

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.24    1.32    2.16    2.50    3.33    8.22 
[1] "Modality: WO intensive ambulatory\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 109, number of events= 109 
   (89 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.6955    2.0047   0.6932    0.5721  1.22
less_90d_tr1.lag               0.5006    1.6497   0.9757    0.8386  0.60
log_dias_treat_imp_sin_na.lag -0.0471    0.9540   0.1707    0.1345 -0.35
comp_bpsc_y3_severe.lag       -0.4559    0.6339   0.6622    0.5470 -0.83
policonsumo2.lag              -1.0245    0.3590   0.6121    0.4678 -2.19
edad_al_ing_1                  0.7246    2.0639   0.1274    0.1228  5.90
ano_nac_corr                   0.7012    2.0162   0.1237    0.1211  5.79
susinidum_oh                   0.1961    1.2167   1.1315    0.4793  0.41
susinidum_coc                 -1.3926    0.2484   1.5539    0.5582 -2.49
susinidum_pbc                  0.7068    2.0275   1.1711    0.5871  1.20
susinidum_mar                  0.0357    1.0363   1.1510    0.5916  0.06
psycom_dum_with               -0.0400    0.9608   0.2528    0.2598 -0.15
psycom_dum_study               0.3892    1.4758   0.3255    0.3183  1.22
freq_cons_dum_5day             0.4022    1.4951   0.2703    0.2447  1.64
cond_oc_dum_2inact             0.3064    1.3585   0.3531    0.3455  0.89
cond_oc_dum_3unemp             0.1412    1.1517   0.3483    0.3110  0.45
susprindum_oh                  0.7067    2.0274   0.8058    0.6043  1.17
susprindum_coc                 0.6402    1.8969   0.8214    0.6175  1.04
susprindum_pbc                 0.6564    1.9279   0.7631    0.5779  1.14
susprindum_mar                 1.1354    3.1123   0.8929    0.6353  1.79
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.224    
less_90d_tr1.lag                 0.551    
log_dias_treat_imp_sin_na.lag    0.726    
comp_bpsc_y3_severe.lag          0.405    
policonsumo2.lag                 0.029 *  
edad_al_ing_1                  3.6e-09 ***
ano_nac_corr                   7.1e-09 ***
susinidum_oh                     0.682    
susinidum_coc                    0.013 *  
susinidum_pbc                    0.229    
susinidum_mar                    0.952    
psycom_dum_with                  0.878    
psycom_dum_study                 0.221    
freq_cons_dum_5day               0.100    
cond_oc_dum_2inact               0.375    
cond_oc_dum_3unemp               0.650    
susprindum_oh                    0.242    
susprindum_coc                   0.300    
susprindum_pbc                   0.256    
susprindum_mar                   0.074 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    2.005      0.499    0.6533     6.152
less_90d_tr1.lag                  1.650      0.606    0.3188     8.535
log_dias_treat_imp_sin_na.lag     0.954      1.048    0.7329     1.242
comp_bpsc_y3_severe.lag           0.634      1.578    0.2170     1.852
policonsumo2.lag                  0.359      2.786    0.1435     0.898
edad_al_ing_1                     2.064      0.485    1.6223     2.626
ano_nac_corr                      2.016      0.496    1.5901     2.556
susinidum_oh                      1.217      0.822    0.4755     3.113
susinidum_coc                     0.248      4.025    0.0832     0.742
susinidum_pbc                     2.028      0.493    0.6416     6.408
susinidum_mar                     1.036      0.965    0.3250     3.304
psycom_dum_with                   0.961      1.041    0.5774     1.599
psycom_dum_study                  1.476      0.678    0.7909     2.754
freq_cons_dum_5day                1.495      0.669    0.9255     2.415
cond_oc_dum_2inact                1.358      0.736    0.6901     2.674
cond_oc_dum_3unemp                1.152      0.868    0.6260     2.119
susprindum_oh                     2.027      0.493    0.6202     6.627
susprindum_coc                    1.897      0.527    0.5654     6.363
susprindum_pbc                    1.928      0.519    0.6211     5.985
susprindum_mar                    3.112      0.321    0.8961    10.810

Concordance= 0.691  (se = 0.024 )
Likelihood ratio test= 51.4  on 20 df,   p=1e-04
Wald test            = 286  on 20 df,   p=&lt;2e-16
Score (logrank) test = 49.1  on 20 df,   p=3e-04,   Robust = 44.4  p=0.001

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.01    0.16    0.30    0.55    0.58    9.39 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb505"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a>iiws_strat_alt_alt <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb505-5"><a href="#cb505-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-6"><a href="#cb505-6" aria-hidden="true" tabindex="-1"></a>comb_strata_alt_alt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>tipo_de_plan_2_mod), </span>
<span id="cb505-7"><a href="#cb505-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">unique</span>(data_mine_miss_restr_proc2<span class="sc">$</span>time_interval3_alt))</span>
<span id="cb505-8"><a href="#cb505-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-9"><a href="#cb505-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ff <span class="cf">in</span> <span class="fu">seq_along</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comb_strata_alt_alt))) {</span>
<span id="cb505-10"><a href="#cb505-10" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span> comb_strata_alt_alt[ff,<span class="st">"Var1"</span>]</span>
<span id="cb505-11"><a href="#cb505-11" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span> comb_strata_alt_alt[ff,<span class="st">"Var2"</span>]</span>
<span id="cb505-12"><a href="#cb505-12" aria-hidden="true" tabindex="-1"></a>  data_mine_miss_proc2_subset<span class="ot">&lt;-</span></span>
<span id="cb505-13"><a href="#cb505-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(data_mine_miss_restr_proc2, <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span>i <span class="sc">&amp;</span> time_interval3_alt<span class="sc">==</span>j)</span>
<span id="cb505-14"><a href="#cb505-14" aria-hidden="true" tabindex="-1"></a>  maxfu_df_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(maxfu_restr_df, <span class="at">subset=</span> maxfu.id <span class="sc">%in%</span> <span class="fu">unique</span>(data_mine_miss_proc2_subset<span class="sc">$</span>id))  </span>
<span id="cb505-15"><a href="#cb505-15" aria-hidden="true" tabindex="-1"></a>  iiw_model_strat_alt_alt<span class="ot">&lt;-</span></span>
<span id="cb505-16"><a href="#cb505-16" aria-hidden="true" tabindex="-1"></a>    IrregLong<span class="sc">::</span><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb505-17"><a href="#cb505-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cluster</span>(id)<span class="sc">+</span> <span class="co">#If a frailty model is used, the cluster(id) term should appear before other covariates</span></span>
<span id="cb505-18"><a href="#cb505-18" aria-hidden="true" tabindex="-1"></a>          tr_outcome.lag<span class="sc">+</span></span>
<span id="cb505-19"><a href="#cb505-19" aria-hidden="true" tabindex="-1"></a>          less_90d_tr1.lag<span class="sc">+</span></span>
<span id="cb505-20"><a href="#cb505-20" aria-hidden="true" tabindex="-1"></a>          log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb505-21"><a href="#cb505-21" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe.lag<span class="sc">+</span></span>
<span id="cb505-22"><a href="#cb505-22" aria-hidden="true" tabindex="-1"></a>          policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb505-23"><a href="#cb505-23" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb505-24"><a href="#cb505-24" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr <span class="sc">+</span> </span>
<span id="cb505-25"><a href="#cb505-25" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb505-26"><a href="#cb505-26" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb505-27"><a href="#cb505-27" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb505-28"><a href="#cb505-28" aria-hidden="true" tabindex="-1"></a>          susinidum_mar <span class="sc">+</span></span>
<span id="cb505-29"><a href="#cb505-29" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with <span class="sc">+</span></span>
<span id="cb505-30"><a href="#cb505-30" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study <span class="sc">+</span> </span>
<span id="cb505-31"><a href="#cb505-31" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb505-32"><a href="#cb505-32" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb505-33"><a href="#cb505-33" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb505-34"><a href="#cb505-34" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb505-35"><a href="#cb505-35" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb505-36"><a href="#cb505-36" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb505-37"><a href="#cb505-37" aria-hidden="true" tabindex="-1"></a>          susprindum_mar, </span>
<span id="cb505-38"><a href="#cb505-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span> data_mine_miss_proc2_subset,</span>
<span id="cb505-39"><a href="#cb505-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb505-40"><a href="#cb505-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb505-41"><a href="#cb505-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb505-42"><a href="#cb505-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">maxfu=</span> maxfu_df_subset,</span>
<span id="cb505-43"><a href="#cb505-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with"</span>, <span class="st">"psycom_dum_study_rec2"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb505-44"><a href="#cb505-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"tr_outcome"</span>,<span class="st">"log_dias_treat_imp_sin_na"</span>, <span class="st">"less_90d_tr1"</span>,<span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb505-45"><a href="#cb505-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="dv">1</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb505-46"><a href="#cb505-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">first=</span> T</span>
<span id="cb505-47"><a href="#cb505-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb505-48"><a href="#cb505-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb505-49"><a href="#cb505-49" aria-hidden="true" tabindex="-1"></a>  iiws_strat_alt_alt[[ff]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb505-50"><a href="#cb505-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> iiw_model_strat_alt_alt,</span>
<span id="cb505-51"><a href="#cb505-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">comb =</span> <span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j,<span class="st">"."</span>),</span>
<span id="cb505-52"><a href="#cb505-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">cox_iiw =</span> <span class="fu">summary</span>(iiw_model_strat_alt_alt<span class="sc">$</span>m),</span>
<span id="cb505-53"><a href="#cb505-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">iiw =</span> <span class="fu">summary</span>(iiw_model_strat_alt_alt<span class="sc">$</span>iiw)</span>
<span id="cb505-54"><a href="#cb505-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb505-55"><a href="#cb505-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Modality: "</span>,i,<span class="st">"</span><span class="sc">\n</span><span class="st">Time interval: "</span>, j))</span>
<span id="cb505-56"><a href="#cb505-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat_alt_alt<span class="sc">$</span>m))</span>
<span id="cb505-57"><a href="#cb505-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(iiw_model_strat_alt_alt<span class="sc">$</span>iiw))</span>
<span id="cb505-58"><a href="#cb505-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-59"><a href="#cb505-59" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Modality: WO residential\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 613, number of events= 613 
   (1197 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.0900    0.9140   0.2501    0.1810 -0.50
less_90d_tr1.lag               0.7064    2.0268   0.1946    0.1616  4.37
log_dias_treat_imp_sin_na.lag  0.0461    1.0472   0.0939    0.0916  0.50
comp_bpsc_y3_severe.lag        0.5370    1.7108   0.1989    0.1883  2.85
policonsumo2.lag              -0.0548    0.9467   0.2159    0.2080 -0.26
edad_al_ing_1                 -0.0295    0.9710   0.0169    0.0169 -1.74
ano_nac_corr                  -0.0248    0.9755   0.0162    0.0164 -1.51
susinidum_oh                  -0.0586    0.9430   0.2951    0.2920 -0.20
susinidum_coc                 -0.3375    0.7136   0.3417    0.3291 -1.03
susinidum_pbc                  0.2985    1.3479   0.3018    0.3066  0.97
susinidum_mar                  0.1756    1.1920   0.2911    0.2907  0.60
psycom_dum_with               -0.2274    0.7966   0.1182    0.1159 -1.96
psycom_dum_study              -0.2578    0.7728   0.1608    0.1667 -1.55
freq_cons_dum_5day             0.0151    1.0152   0.0988    0.0946  0.16
cond_oc_dum_2inact             0.2079    1.2311   0.1547    0.1475  1.41
cond_oc_dum_3unemp             0.1580    1.1712   0.1547    0.1502  1.05
susprindum_oh                  0.3181    1.3746   0.2850    0.2514  1.27
susprindum_coc                 0.4414    1.5549   0.2868    0.2377  1.86
susprindum_pbc                 0.3105    1.3640   0.2662    0.2213  1.40
susprindum_mar                 0.4231    1.5267   0.4242    0.3693  1.15
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.6192    
less_90d_tr1.lag               1.2e-05 ***
log_dias_treat_imp_sin_na.lag   0.6147    
comp_bpsc_y3_severe.lag         0.0044 ** 
policonsumo2.lag                0.7921    
edad_al_ing_1                   0.0815 .  
ano_nac_corr                    0.1308    
susinidum_oh                    0.8409    
susinidum_coc                   0.3052    
susinidum_pbc                   0.3302    
susinidum_mar                   0.5457    
psycom_dum_with                 0.0497 *  
psycom_dum_study                0.1219    
freq_cons_dum_5day              0.8730    
cond_oc_dum_2inact              0.1588    
cond_oc_dum_3unemp              0.2928    
susprindum_oh                   0.2057    
susprindum_coc                  0.0633 .  
susprindum_pbc                  0.1607    
susprindum_mar                  0.2519    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.914      1.094     0.641      1.30
less_90d_tr1.lag                  2.027      0.493     1.477      2.78
log_dias_treat_imp_sin_na.lag     1.047      0.955     0.875      1.25
comp_bpsc_y3_severe.lag           1.711      0.585     1.183      2.47
policonsumo2.lag                  0.947      1.056     0.630      1.42
edad_al_ing_1                     0.971      1.030     0.939      1.00
ano_nac_corr                      0.976      1.025     0.945      1.01
susinidum_oh                      0.943      1.060     0.532      1.67
susinidum_coc                     0.714      1.401     0.374      1.36
susinidum_pbc                     1.348      0.742     0.739      2.46
susinidum_mar                     1.192      0.839     0.674      2.11
psycom_dum_with                   0.797      1.255     0.635      1.00
psycom_dum_study                  0.773      1.294     0.557      1.07
freq_cons_dum_5day                1.015      0.985     0.843      1.22
cond_oc_dum_2inact                1.231      0.812     0.922      1.64
cond_oc_dum_3unemp                1.171      0.854     0.873      1.57
susprindum_oh                     1.375      0.727     0.840      2.25
susprindum_coc                    1.555      0.643     0.976      2.48
susprindum_pbc                    1.364      0.733     0.884      2.10
susprindum_mar                    1.527      0.655     0.740      3.15

Concordance= 0.603  (se = 0.012 )
Likelihood ratio test= 62.1  on 20 df,   p=3e-06
Wald test            = 79.2  on 20 df,   p=5e-09
Score (logrank) test = 57.3  on 20 df,   p=2e-05,   Robust = 63.2  p=2e-06

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.125   0.197   0.226   0.251   0.280   1.222 
[1] "Modality: GP intensive ambulatory\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 3052, number of events= 3052 
   (5099 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.04944   0.95177  0.19147   0.14628 -0.34
less_90d_tr1.lag               0.37121   1.44949  0.09331   0.08001  4.64
log_dias_treat_imp_sin_na.lag  0.12986   1.13867  0.05504   0.05510  2.36
comp_bpsc_y3_severe.lag        0.58095   1.78773  0.07941   0.07147  8.13
policonsumo2.lag               0.09846   1.10347  0.12622   0.09638  1.02
edad_al_ing_1                  0.01296   1.01304  0.00803   0.00836  1.55
ano_nac_corr                   0.01642   1.01655  0.00788   0.00829  1.98
susinidum_oh                   0.04711   1.04824  0.13295   0.12352  0.38
susinidum_coc                  0.08476   1.08845  0.15803   0.14920  0.57
susinidum_pbc                  0.24050   1.27188  0.14782   0.14249  1.69
susinidum_mar                  0.09664   1.10146  0.13417   0.12551  0.77
psycom_dum_with               -0.06549   0.93661  0.03946   0.03958 -1.65
psycom_dum_study               0.30426   1.35562  0.06520   0.07476  4.07
freq_cons_dum_5day             0.03776   1.03848  0.03760   0.03824  0.99
cond_oc_dum_2inact            -0.00650   0.99353  0.05709   0.05742 -0.11
cond_oc_dum_3unemp             0.00356   1.00356  0.04041   0.04027  0.09
susprindum_oh                  0.08893   1.09301  0.17883   0.17307  0.51
susprindum_coc                 0.05586   1.05745  0.17922   0.17480  0.32
susprindum_pbc                 0.13574   1.14539  0.17488   0.17189  0.79
susprindum_mar                 0.07097   1.07355  0.18876   0.18724  0.38
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.735    
less_90d_tr1.lag               3.5e-06 ***
log_dias_treat_imp_sin_na.lag    0.018 *  
comp_bpsc_y3_severe.lag        4.4e-16 ***
policonsumo2.lag                 0.307    
edad_al_ing_1                    0.121    
ano_nac_corr                     0.048 *  
susinidum_oh                     0.703    
susinidum_coc                    0.570    
susinidum_pbc                    0.091 .  
susinidum_mar                    0.441    
psycom_dum_with                  0.098 .  
psycom_dum_study               4.7e-05 ***
freq_cons_dum_5day               0.323    
cond_oc_dum_2inact               0.910    
cond_oc_dum_3unemp               0.930    
susprindum_oh                    0.607    
susprindum_coc                   0.749    
susprindum_pbc                   0.430    
susprindum_mar                   0.705    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.952      1.051     0.715      1.27
less_90d_tr1.lag                  1.449      0.690     1.239      1.70
log_dias_treat_imp_sin_na.lag     1.139      0.878     1.022      1.27
comp_bpsc_y3_severe.lag           1.788      0.559     1.554      2.06
policonsumo2.lag                  1.103      0.906     0.914      1.33
edad_al_ing_1                     1.013      0.987     0.997      1.03
ano_nac_corr                      1.017      0.984     1.000      1.03
susinidum_oh                      1.048      0.954     0.823      1.34
susinidum_coc                     1.088      0.919     0.812      1.46
susinidum_pbc                     1.272      0.786     0.962      1.68
susinidum_mar                     1.101      0.908     0.861      1.41
psycom_dum_with                   0.937      1.068     0.867      1.01
psycom_dum_study                  1.356      0.738     1.171      1.57
freq_cons_dum_5day                1.038      0.963     0.963      1.12
cond_oc_dum_2inact                0.994      1.007     0.888      1.11
cond_oc_dum_3unemp                1.004      0.996     0.927      1.09
susprindum_oh                     1.093      0.915     0.779      1.53
susprindum_coc                    1.057      0.946     0.751      1.49
susprindum_pbc                    1.145      0.873     0.818      1.60
susprindum_mar                    1.074      0.931     0.744      1.55

Concordance= 0.585  (se = 0.006 )
Likelihood ratio test= 156  on 20 df,   p=&lt;2e-16
Wald test            = 154  on 20 df,   p=&lt;2e-16
Score (logrank) test = 141  on 20 df,   p=&lt;2e-16,   Robust = 139  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.164   0.255   0.304   0.308   0.331   1.985 
[1] "Modality: basic ambulatory\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2876, number of events= 2876 
   (4323 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.05522   1.05677  0.25750   0.21420  0.26
less_90d_tr1.lag               0.30335   1.35439  0.11227   0.10746  2.82
log_dias_treat_imp_sin_na.lag  0.01684   1.01699  0.06516   0.05205  0.32
comp_bpsc_y3_severe.lag        0.70747   2.02885  0.08855   0.08420  8.40
policonsumo2.lag              -0.01761   0.98254  0.12635   0.10821 -0.16
edad_al_ing_1                  0.04075   1.04159  0.00875   0.00923  4.42
ano_nac_corr                   0.04753   1.04867  0.00853   0.00912  5.21
susinidum_oh                   0.17495   1.19119  0.14627   0.19430  0.90
susinidum_coc                  0.38052   1.46304  0.16633   0.21181  1.80
susinidum_pbc                  0.22510   1.25244  0.16317   0.20567  1.09
susinidum_mar                  0.26295   1.30076  0.14697   0.19576  1.34
psycom_dum_with               -0.05866   0.94303  0.04148   0.04207 -1.39
psycom_dum_study               0.46136   1.58624  0.05948   0.06699  6.89
freq_cons_dum_5day             0.05859   1.06034  0.04306   0.04442  1.32
cond_oc_dum_2inact             0.09190   1.09626  0.06201   0.06085  1.51
cond_oc_dum_3unemp             0.03188   1.03239  0.04548   0.04753  0.67
susprindum_oh                  0.48317   1.62121  0.22515   0.20340  2.38
susprindum_coc                 0.56258   1.75519  0.22597   0.20514  2.74
susprindum_pbc                 0.48472   1.62372  0.22336   0.20300  2.39
susprindum_mar                 0.44114   1.55448  0.23236   0.20939  2.11
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.7966    
less_90d_tr1.lag                0.0048 ** 
log_dias_treat_imp_sin_na.lag   0.7462    
comp_bpsc_y3_severe.lag        &lt; 2e-16 ***
policonsumo2.lag                0.8707    
edad_al_ing_1                  1.0e-05 ***
ano_nac_corr                   1.8e-07 ***
susinidum_oh                    0.3679    
susinidum_coc                   0.0724 .  
susinidum_pbc                   0.2738    
susinidum_mar                   0.1792    
psycom_dum_with                 0.1632    
psycom_dum_study               5.7e-12 ***
freq_cons_dum_5day              0.1871    
cond_oc_dum_2inact              0.1310    
cond_oc_dum_3unemp              0.5024    
susprindum_oh                   0.0175 *  
susprindum_coc                  0.0061 ** 
susprindum_pbc                  0.0169 *  
susprindum_mar                  0.0351 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.057      0.946     0.694      1.61
less_90d_tr1.lag                  1.354      0.738     1.097      1.67
log_dias_treat_imp_sin_na.lag     1.017      0.983     0.918      1.13
comp_bpsc_y3_severe.lag           2.029      0.493     1.720      2.39
policonsumo2.lag                  0.983      1.018     0.795      1.21
edad_al_ing_1                     1.042      0.960     1.023      1.06
ano_nac_corr                      1.049      0.954     1.030      1.07
susinidum_oh                      1.191      0.839     0.814      1.74
susinidum_coc                     1.463      0.684     0.966      2.22
susinidum_pbc                     1.252      0.798     0.837      1.87
susinidum_mar                     1.301      0.769     0.886      1.91
psycom_dum_with                   0.943      1.060     0.868      1.02
psycom_dum_study                  1.586      0.630     1.391      1.81
freq_cons_dum_5day                1.060      0.943     0.972      1.16
cond_oc_dum_2inact                1.096      0.912     0.973      1.24
cond_oc_dum_3unemp                1.032      0.969     0.941      1.13
susprindum_oh                     1.621      0.617     1.088      2.42
susprindum_coc                    1.755      0.570     1.174      2.62
susprindum_pbc                    1.624      0.616     1.091      2.42
susprindum_mar                    1.554      0.643     1.031      2.34

Concordance= 0.598  (se = 0.006 )
Likelihood ratio test= 222  on 20 df,   p=&lt;2e-16
Wald test            = 212  on 20 df,   p=&lt;2e-16
Score (logrank) test = 208  on 20 df,   p=&lt;2e-16,   Robust = 200  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.060   0.132   0.165   0.170   0.188   1.000 
[1] "Modality: GP residential\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1378, number of events= 1378 
   (2346 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.15244   1.16468  0.22389   0.19303  0.79
less_90d_tr1.lag               0.33669   1.40030  0.12075   0.09077  3.71
log_dias_treat_imp_sin_na.lag  0.05576   1.05735  0.05762   0.06101  0.91
comp_bpsc_y3_severe.lag        0.23214   1.26129  0.14637   0.09912  2.34
policonsumo2.lag               0.00257   1.00258  0.17348   0.14029  0.02
edad_al_ing_1                  0.01254   1.01262  0.01203   0.01134  1.11
ano_nac_corr                   0.01722   1.01737  0.01179   0.01141  1.51
susinidum_oh                   0.32715   1.38701  0.21824   0.18145  1.80
susinidum_coc                  0.31906   1.37584  0.25651   0.22809  1.40
susinidum_pbc                  0.28383   1.32820  0.23008   0.19598  1.45
susinidum_mar                  0.36668   1.44294  0.21914   0.18275  2.01
psycom_dum_with               -0.08436   0.91910  0.06180   0.06083 -1.39
psycom_dum_study               0.05554   1.05712  0.09488   0.10204  0.54
freq_cons_dum_5day             0.14407   1.15497  0.06361   0.06306  2.28
cond_oc_dum_2inact             0.00969   1.00974  0.10245   0.10074  0.10
cond_oc_dum_3unemp            -0.01209   0.98799  0.08698   0.08737 -0.14
susprindum_oh                  0.22130   1.24769  0.29117   0.17490  1.27
susprindum_coc                 0.12158   1.12928  0.29393   0.18007  0.68
susprindum_pbc                 0.25572   1.29139  0.28565   0.16995  1.50
susprindum_mar                 0.10095   1.10622  0.33636   0.23222  0.43
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.42968    
less_90d_tr1.lag               0.00021 ***
log_dias_treat_imp_sin_na.lag  0.36073    
comp_bpsc_y3_severe.lag        0.01919 *  
policonsumo2.lag               0.98537    
edad_al_ing_1                  0.26872    
ano_nac_corr                   0.13110    
susinidum_oh                   0.07139 .  
susinidum_coc                  0.16185    
susinidum_pbc                  0.14755    
susinidum_mar                  0.04480 *  
psycom_dum_with                0.16553    
psycom_dum_study               0.58621    
freq_cons_dum_5day             0.02232 *  
cond_oc_dum_2inact             0.92334    
cond_oc_dum_3unemp             0.88998    
susprindum_oh                  0.20577    
susprindum_coc                 0.49955    
susprindum_pbc                 0.13240    
susprindum_mar                 0.66377    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.165      0.859     0.798      1.70
less_90d_tr1.lag                  1.400      0.714     1.172      1.67
log_dias_treat_imp_sin_na.lag     1.057      0.946     0.938      1.19
comp_bpsc_y3_severe.lag           1.261      0.793     1.039      1.53
policonsumo2.lag                  1.003      0.997     0.762      1.32
edad_al_ing_1                     1.013      0.988     0.990      1.04
ano_nac_corr                      1.017      0.983     0.995      1.04
susinidum_oh                      1.387      0.721     0.972      1.98
susinidum_coc                     1.376      0.727     0.880      2.15
susinidum_pbc                     1.328      0.753     0.905      1.95
susinidum_mar                     1.443      0.693     1.009      2.06
psycom_dum_with                   0.919      1.088     0.816      1.04
psycom_dum_study                  1.057      0.946     0.865      1.29
freq_cons_dum_5day                1.155      0.866     1.021      1.31
cond_oc_dum_2inact                1.010      0.990     0.829      1.23
cond_oc_dum_3unemp                0.988      1.012     0.832      1.17
susprindum_oh                     1.248      0.801     0.886      1.76
susprindum_coc                    1.129      0.886     0.793      1.61
susprindum_pbc                    1.291      0.774     0.926      1.80
susprindum_mar                    1.106      0.904     0.702      1.74

Concordance= 0.567  (se = 0.009 )
Likelihood ratio test= 40.4  on 20 df,   p=0.004
Wald test            = 49.6  on 20 df,   p=3e-04
Score (logrank) test = 38.5  on 20 df,   p=0.008,   Robust = 42.4  p=0.002

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.184   0.233   0.256   0.265   0.284   0.584 
[1] "Modality: WO intensive ambulatory\nTime interval: [0,10]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 439, number of events= 439 
   (710 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.7998    0.4494   1.0298    0.2328 -3.44
less_90d_tr1.lag               0.8186    2.2672   0.2904    0.2384  3.43
log_dias_treat_imp_sin_na.lag  0.3638    1.4389   0.2272    0.1822  2.00
comp_bpsc_y3_severe.lag        0.1953    1.2157   0.2301    0.1749  1.12
policonsumo2.lag               0.6427    1.9016   0.3232    0.2527  2.54
edad_al_ing_1                  0.0258    1.0261   0.0237    0.0230  1.12
ano_nac_corr                   0.0237    1.0239   0.0235    0.0231  1.02
susinidum_oh                  -0.0563    0.9453   0.3381    0.4084 -0.14
susinidum_coc                 -0.1008    0.9042   0.3994    0.4504 -0.22
susinidum_pbc                 -0.2883    0.7496   0.3687    0.4356 -0.66
susinidum_mar                 -0.1510    0.8598   0.3476    0.4131 -0.37
psycom_dum_with                0.2137    1.2383   0.1094    0.1041  2.05
psycom_dum_study               0.6845    1.9827   0.1883    0.1839  3.72
freq_cons_dum_5day             0.0397    1.0405   0.1021    0.1033  0.38
cond_oc_dum_2inact             0.1214    1.1291   0.1298    0.1209  1.00
cond_oc_dum_3unemp             0.1248    1.1329   0.1386    0.1308  0.95
susprindum_oh                  0.3577    1.4300   0.3910    0.2730  1.31
susprindum_coc                 0.6496    1.9149   0.3979    0.2808  2.31
susprindum_pbc                 0.6304    1.8784   0.3826    0.2603  2.42
susprindum_mar                 1.1684    3.2168   0.4236    0.2973  3.93
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.00059 ***
less_90d_tr1.lag               0.00060 ***
log_dias_treat_imp_sin_na.lag  0.04584 *  
comp_bpsc_y3_severe.lag        0.26411    
policonsumo2.lag               0.01098 *  
edad_al_ing_1                  0.26148    
ano_nac_corr                   0.30580    
susinidum_oh                   0.89044    
susinidum_coc                  0.82298    
susinidum_pbc                  0.50811    
susinidum_mar                  0.71473    
psycom_dum_with                0.04000 *  
psycom_dum_study               0.00020 ***
freq_cons_dum_5day             0.70098    
cond_oc_dum_2inact             0.31526    
cond_oc_dum_3unemp             0.34005    
susprindum_oh                  0.19007    
susprindum_coc                 0.02069 *  
susprindum_pbc                 0.01542 *  
susprindum_mar                 8.5e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.449      2.225     0.285     0.709
less_90d_tr1.lag                  2.267      0.441     1.421     3.617
log_dias_treat_imp_sin_na.lag     1.439      0.695     1.007     2.056
comp_bpsc_y3_severe.lag           1.216      0.823     0.863     1.713
policonsumo2.lag                  1.902      0.526     1.159     3.121
edad_al_ing_1                     1.026      0.975     0.981     1.073
ano_nac_corr                      1.024      0.977     0.979     1.071
susinidum_oh                      0.945      1.058     0.425     2.105
susinidum_coc                     0.904      1.106     0.374     2.186
susinidum_pbc                     0.750      1.334     0.319     1.760
susinidum_mar                     0.860      1.163     0.383     1.932
psycom_dum_with                   1.238      0.808     1.010     1.519
psycom_dum_study                  1.983      0.504     1.383     2.843
freq_cons_dum_5day                1.040      0.961     0.850     1.274
cond_oc_dum_2inact                1.129      0.886     0.891     1.431
cond_oc_dum_3unemp                1.133      0.883     0.877     1.464
susprindum_oh                     1.430      0.699     0.838     2.442
susprindum_coc                    1.915      0.522     1.104     3.320
susprindum_pbc                    1.878      0.532     1.128     3.128
susprindum_mar                    3.217      0.311     1.796     5.761

Concordance= 0.612  (se = 0.015 )
Likelihood ratio test= 42.4  on 20 df,   p=0.002
Wald test            = 83.1  on 20 df,   p=1e-09
Score (logrank) test = 39.6  on 20 df,   p=0.006,   Robust = 52.3  p=1e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.059   0.145   0.190   0.201   0.230   1.315 
[1] "Modality: WO residential\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 510, number of events= 510 
   (460 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.21592   1.24101  0.34608   0.31001  0.70
less_90d_tr1.lag               0.89083   2.43714  0.41911   0.35694  2.50
log_dias_treat_imp_sin_na.lag  0.34591   1.41328  0.31806   0.22707  1.52
comp_bpsc_y3_severe.lag       -0.11404   0.89222  0.34659   0.28279 -0.40
policonsumo2.lag              -0.09157   0.91250  0.45600   0.21426 -0.43
edad_al_ing_1                 -0.01132   0.98874  0.01971   0.01840 -0.62
ano_nac_corr                  -0.01574   0.98439  0.01894   0.01751 -0.90
susinidum_oh                  -0.30205   0.73930  0.29743   0.42830 -0.71
susinidum_coc                 -0.26431   0.76773  0.34479   0.45702 -0.58
susinidum_pbc                 -0.51114   0.59981  0.30812   0.44117 -1.16
susinidum_mar                 -0.31219   0.73184  0.29812   0.42846 -0.73
psycom_dum_with                0.09827   1.10326  0.13967   0.13716  0.72
psycom_dum_study               0.06058   1.06245  0.16328   0.16532  0.37
freq_cons_dum_5day             0.04197   1.04286  0.10563   0.10603  0.40
cond_oc_dum_2inact             0.09249   1.09690  0.16558   0.15013  0.62
cond_oc_dum_3unemp            -0.04958   0.95162  0.16511   0.15264 -0.32
susprindum_oh                  0.13041   1.13929  0.29484   0.29199  0.45
susprindum_coc                -0.31573   0.72926  0.30716   0.31845 -0.99
susprindum_pbc                 0.00569   1.00571  0.28545   0.28959  0.02
susprindum_mar                -0.87667   0.41617  0.53610   0.39618 -2.21
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.486  
less_90d_tr1.lag                 0.013 *
log_dias_treat_imp_sin_na.lag    0.128  
comp_bpsc_y3_severe.lag          0.687  
policonsumo2.lag                 0.669  
edad_al_ing_1                    0.538  
ano_nac_corr                     0.369  
susinidum_oh                     0.481  
susinidum_coc                    0.563  
susinidum_pbc                    0.247  
susinidum_mar                    0.466  
psycom_dum_with                  0.474  
psycom_dum_study                 0.714  
freq_cons_dum_5day               0.692  
cond_oc_dum_2inact               0.538  
cond_oc_dum_3unemp               0.745  
susprindum_oh                    0.655  
susprindum_coc                   0.321  
susprindum_pbc                   0.984  
susprindum_mar                   0.027 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.241      0.806     0.676     2.279
less_90d_tr1.lag                  2.437      0.410     1.211     4.906
log_dias_treat_imp_sin_na.lag     1.413      0.708     0.906     2.205
comp_bpsc_y3_severe.lag           0.892      1.121     0.513     1.553
policonsumo2.lag                  0.913      1.096     0.600     1.389
edad_al_ing_1                     0.989      1.011     0.954     1.025
ano_nac_corr                      0.984      1.016     0.951     1.019
susinidum_oh                      0.739      1.353     0.319     1.712
susinidum_coc                     0.768      1.303     0.313     1.880
susinidum_pbc                     0.600      1.667     0.253     1.424
susinidum_mar                     0.732      1.366     0.316     1.695
psycom_dum_with                   1.103      0.906     0.843     1.444
psycom_dum_study                  1.062      0.941     0.768     1.469
freq_cons_dum_5day                1.043      0.959     0.847     1.284
cond_oc_dum_2inact                1.097      0.912     0.817     1.472
cond_oc_dum_3unemp                0.952      1.051     0.706     1.283
susprindum_oh                     1.139      0.878     0.643     2.019
susprindum_coc                    0.729      1.371     0.391     1.361
susprindum_pbc                    1.006      0.994     0.570     1.774
susprindum_mar                    0.416      2.403     0.191     0.905

Concordance= 0.563  (se = 0.014 )
Likelihood ratio test= 31.6  on 20 df,   p=0.05
Wald test            = 48.2  on 20 df,   p=4e-04
Score (logrank) test = 29.6  on 20 df,   p=0.08,   Robust = 36.9  p=0.01

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.318   0.466   0.529   0.571   0.630   1.853 
[1] "Modality: GP intensive ambulatory\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 2228, number of events= 2228 
   (2101 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.21836   0.80384  0.20606   0.15412 -1.42
less_90d_tr1.lag               0.75859   2.13527  0.26008   0.22146  3.43
log_dias_treat_imp_sin_na.lag  0.01313   1.01322  0.14279   0.12222  0.11
comp_bpsc_y3_severe.lag        0.10611   1.11194  0.17834   0.12291  0.86
policonsumo2.lag               0.02144   1.02167  0.22376   0.14550  0.15
edad_al_ing_1                 -0.00175   0.99826  0.00887   0.00879 -0.20
ano_nac_corr                  -0.00275   0.99726  0.00859   0.00856 -0.32
susinidum_oh                   0.05307   1.05451  0.15536   0.17220  0.31
susinidum_coc                  0.15066   1.16261  0.18055   0.18971  0.79
susinidum_pbc                  0.06123   1.06314  0.17256   0.19045  0.32
susinidum_mar                  0.03864   1.03939  0.15764   0.17564  0.22
psycom_dum_with               -0.02080   0.97941  0.04721   0.04682 -0.44
psycom_dum_study              -0.06091   0.94091  0.06572   0.06445 -0.95
freq_cons_dum_5day            -0.01579   0.98433  0.04386   0.04367 -0.36
cond_oc_dum_2inact             0.06525   1.06743  0.06486   0.06484  1.01
cond_oc_dum_3unemp             0.07212   1.07479  0.04734   0.04719  1.53
susprindum_oh                  0.08099   1.08436  0.17644   0.18468  0.44
susprindum_coc                 0.04766   1.04881  0.17743   0.18575  0.26
susprindum_pbc                 0.07136   1.07397  0.17324   0.18145  0.39
susprindum_mar                 0.13351   1.14283  0.19634   0.20052  0.67
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.15655    
less_90d_tr1.lag               0.00061 ***
log_dias_treat_imp_sin_na.lag  0.91444    
comp_bpsc_y3_severe.lag        0.38798    
policonsumo2.lag               0.88285    
edad_al_ing_1                  0.84261    
ano_nac_corr                   0.74832    
susinidum_oh                   0.75792    
susinidum_coc                  0.42708    
susinidum_pbc                  0.74785    
susinidum_mar                  0.82589    
psycom_dum_with                0.65677    
psycom_dum_study               0.34465    
freq_cons_dum_5day             0.71767    
cond_oc_dum_2inact             0.31424    
cond_oc_dum_3unemp             0.12643    
susprindum_oh                  0.66098    
susprindum_coc                 0.79751    
susprindum_pbc                 0.69410    
susprindum_mar                 0.50555    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.804      1.244     0.594      1.09
less_90d_tr1.lag                  2.135      0.468     1.383      3.30
log_dias_treat_imp_sin_na.lag     1.013      0.987     0.797      1.29
comp_bpsc_y3_severe.lag           1.112      0.899     0.874      1.41
policonsumo2.lag                  1.022      0.979     0.768      1.36
edad_al_ing_1                     0.998      1.002     0.981      1.02
ano_nac_corr                      0.997      1.003     0.981      1.01
susinidum_oh                      1.055      0.948     0.752      1.48
susinidum_coc                     1.163      0.860     0.802      1.69
susinidum_pbc                     1.063      0.941     0.732      1.54
susinidum_mar                     1.039      0.962     0.737      1.47
psycom_dum_with                   0.979      1.021     0.894      1.07
psycom_dum_study                  0.941      1.063     0.829      1.07
freq_cons_dum_5day                0.984      1.016     0.904      1.07
cond_oc_dum_2inact                1.067      0.937     0.940      1.21
cond_oc_dum_3unemp                1.075      0.930     0.980      1.18
susprindum_oh                     1.084      0.922     0.755      1.56
susprindum_coc                    1.049      0.953     0.729      1.51
susprindum_pbc                    1.074      0.931     0.753      1.53
susprindum_mar                    1.143      0.875     0.771      1.69

Concordance= 0.528  (se = 0.007 )
Likelihood ratio test= 67.3  on 20 df,   p=5e-07
Wald test            = 93.3  on 20 df,   p=2e-11
Score (logrank) test = 57.5  on 20 df,   p=2e-05,   Robust = 47.3  p=5e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.365   0.433   0.450   0.471   0.466   1.154 
[1] "Modality: basic ambulatory\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1787, number of events= 1787 
   (1705 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.11289   0.89325  0.26499   0.19738 -0.57
less_90d_tr1.lag               0.30966   1.36296  0.42422   0.33394  0.93
log_dias_treat_imp_sin_na.lag -0.03569   0.96494  0.22487   0.17960 -0.20
comp_bpsc_y3_severe.lag       -0.01927   0.98091  0.27409   0.21820 -0.09
policonsumo2.lag               0.30523   1.35693  0.23823   0.21449  1.42
edad_al_ing_1                 -0.00444   0.99557  0.01000   0.00997 -0.45
ano_nac_corr                  -0.00873   0.99130  0.00971   0.00979 -0.89
susinidum_oh                  -0.10940   0.89637  0.17579   0.19112 -0.57
susinidum_coc                 -0.25157   0.77758  0.20960   0.21688 -1.16
susinidum_pbc                 -0.03937   0.96140  0.19588   0.21149 -0.19
susinidum_mar                 -0.07741   0.92551  0.17892   0.19344 -0.40
psycom_dum_with               -0.05845   0.94322  0.05253   0.05173 -1.13
psycom_dum_study              -0.14794   0.86249  0.07226   0.07361 -2.01
freq_cons_dum_5day             0.02945   1.02989  0.05516   0.05564  0.53
cond_oc_dum_2inact            -0.02692   0.97344  0.07140   0.07258 -0.37
cond_oc_dum_3unemp            -0.02013   0.98007  0.05935   0.05786 -0.35
susprindum_oh                  0.04298   1.04392  0.20176   0.16993  0.25
susprindum_coc                 0.05952   1.06133  0.20562   0.17324  0.34
susprindum_pbc                -0.01571   0.98442  0.20156   0.17115 -0.09
susprindum_mar                 0.22047   1.24666  0.21393   0.18470  1.19
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.567  
less_90d_tr1.lag                 0.354  
log_dias_treat_imp_sin_na.lag    0.842  
comp_bpsc_y3_severe.lag          0.930  
policonsumo2.lag                 0.155  
edad_al_ing_1                    0.656  
ano_nac_corr                     0.372  
susinidum_oh                     0.567  
susinidum_coc                    0.246  
susinidum_pbc                    0.852  
susinidum_mar                    0.689  
psycom_dum_with                  0.258  
psycom_dum_study                 0.044 *
freq_cons_dum_5day               0.597  
cond_oc_dum_2inact               0.711  
cond_oc_dum_3unemp               0.728  
susprindum_oh                    0.800  
susprindum_coc                   0.731  
susprindum_pbc                   0.927  
susprindum_mar                   0.233  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.893      1.120     0.607     1.315
less_90d_tr1.lag                  1.363      0.734     0.708     2.623
log_dias_treat_imp_sin_na.lag     0.965      1.036     0.679     1.372
comp_bpsc_y3_severe.lag           0.981      1.019     0.640     1.504
policonsumo2.lag                  1.357      0.737     0.891     2.066
edad_al_ing_1                     0.996      1.004     0.976     1.015
ano_nac_corr                      0.991      1.009     0.972     1.011
susinidum_oh                      0.896      1.116     0.616     1.304
susinidum_coc                     0.778      1.286     0.508     1.189
susinidum_pbc                     0.961      1.040     0.635     1.455
susinidum_mar                     0.926      1.080     0.633     1.352
psycom_dum_with                   0.943      1.060     0.852     1.044
psycom_dum_study                  0.862      1.159     0.747     0.996
freq_cons_dum_5day                1.030      0.971     0.923     1.149
cond_oc_dum_2inact                0.973      1.027     0.844     1.122
cond_oc_dum_3unemp                0.980      1.020     0.875     1.098
susprindum_oh                     1.044      0.958     0.748     1.456
susprindum_coc                    1.061      0.942     0.756     1.490
susprindum_pbc                    0.984      1.016     0.704     1.377
susprindum_mar                    1.247      0.802     0.868     1.790

Concordance= 0.535  (se = 0.008 )
Likelihood ratio test= 28.9  on 20 df,   p=0.09
Wald test            = 34.3  on 20 df,   p=0.02
Score (logrank) test = 27.8  on 20 df,   p=0.1,   Robust = 29.2  p=0.08

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.473   0.647   0.688   0.701   0.737   1.481 
[1] "Modality: GP residential\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1104, number of events= 1104 
   (1012 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.20849   1.23182  0.22524   0.16977  1.23
less_90d_tr1.lag               0.18363   1.20157  0.28968   0.20840  0.88
log_dias_treat_imp_sin_na.lag -0.15939   0.85267  0.15317   0.09437 -1.69
comp_bpsc_y3_severe.lag        0.41048   1.50754  0.24543   0.19143  2.14
policonsumo2.lag               0.32097   1.37847  0.35877   0.20629  1.56
edad_al_ing_1                  0.00535   1.00537  0.01386   0.01396  0.38
ano_nac_corr                   0.00559   1.00561  0.01396   0.01365  0.41
susinidum_oh                  -0.15489   0.85651  0.21234   0.18000 -0.86
susinidum_coc                 -0.02269   0.97757  0.26191   0.22529 -0.10
susinidum_pbc                 -0.29053   0.74786  0.22752   0.19736 -1.47
susinidum_mar                 -0.14415   0.86575  0.21119   0.17822 -0.81
psycom_dum_with               -0.07780   0.92515  0.07047   0.06905 -1.13
psycom_dum_study              -0.18985   0.82708  0.09881   0.09247 -2.05
freq_cons_dum_5day            -0.02728   0.97309  0.06870   0.06836 -0.40
cond_oc_dum_2inact            -0.00107   0.99893  0.11269   0.11224 -0.01
cond_oc_dum_3unemp             0.11521   1.12211  0.09200   0.08840  1.30
susprindum_oh                 -0.04029   0.96051  0.31288   0.27695 -0.15
susprindum_coc                -0.16429   0.84849  0.31546   0.28015 -0.59
susprindum_pbc                -0.15457   0.85678  0.30654   0.27261 -0.57
susprindum_mar                 0.41564   1.51533  0.35411   0.32712  1.27
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.219  
less_90d_tr1.lag                 0.378  
log_dias_treat_imp_sin_na.lag    0.091 .
comp_bpsc_y3_severe.lag          0.032 *
policonsumo2.lag                 0.120  
edad_al_ing_1                    0.701  
ano_nac_corr                     0.682  
susinidum_oh                     0.390  
susinidum_coc                    0.920  
susinidum_pbc                    0.141  
susinidum_mar                    0.419  
psycom_dum_with                  0.260  
psycom_dum_study                 0.040 *
freq_cons_dum_5day               0.690  
cond_oc_dum_2inact               0.992  
cond_oc_dum_3unemp               0.192  
susprindum_oh                    0.884  
susprindum_coc                   0.558  
susprindum_pbc                   0.571  
susprindum_mar                   0.204  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.232      0.812     0.883     1.718
less_90d_tr1.lag                  1.202      0.832     0.799     1.808
log_dias_treat_imp_sin_na.lag     0.853      1.173     0.709     1.026
comp_bpsc_y3_severe.lag           1.508      0.663     1.036     2.194
policonsumo2.lag                  1.378      0.725     0.920     2.065
edad_al_ing_1                     1.005      0.995     0.978     1.033
ano_nac_corr                      1.006      0.994     0.979     1.033
susinidum_oh                      0.857      1.168     0.602     1.219
susinidum_coc                     0.978      1.023     0.629     1.520
susinidum_pbc                     0.748      1.337     0.508     1.101
susinidum_mar                     0.866      1.155     0.611     1.228
psycom_dum_with                   0.925      1.081     0.808     1.059
psycom_dum_study                  0.827      1.209     0.690     0.991
freq_cons_dum_5day                0.973      1.028     0.851     1.113
cond_oc_dum_2inact                0.999      1.001     0.802     1.245
cond_oc_dum_3unemp                1.122      0.891     0.944     1.334
susprindum_oh                     0.961      1.041     0.558     1.653
susprindum_coc                    0.848      1.179     0.490     1.469
susprindum_pbc                    0.857      1.167     0.502     1.462
susprindum_mar                    1.515      0.660     0.798     2.877

Concordance= 0.549  (se = 0.01 )
Likelihood ratio test= 50.8  on 20 df,   p=2e-04
Wald test            = 69.5  on 20 df,   p=2e-07
Score (logrank) test = 47.6  on 20 df,   p=5e-04,   Robust = 46.6  p=7e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.194   0.403   0.432   0.459   0.478   1.500 
[1] "Modality: WO intensive ambulatory\nTime interval: (10,20]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 383, number of events= 383 
   (363 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.0634    1.0654   0.5857    0.2750  0.23
less_90d_tr1.lag               0.1451    1.1562   0.6219    0.2496  0.58
log_dias_treat_imp_sin_na.lag -0.0925    0.9116   0.4925    0.2183 -0.42
comp_bpsc_y3_severe.lag        0.2509    1.2852   0.4928    0.2624  0.96
policonsumo2.lag               0.1765    1.1931   0.5414    0.2508  0.70
edad_al_ing_1                  0.0183    1.0185   0.0229    0.0233  0.79
ano_nac_corr                   0.0113    1.0113   0.0226    0.0217  0.52
susinidum_oh                  -0.2012    0.8178   0.3296    0.2297 -0.88
susinidum_coc                 -0.2162    0.8055   0.3882    0.2877 -0.75
susinidum_pbc                 -0.3864    0.6795   0.3519    0.2679 -1.44
susinidum_mar                 -0.2634    0.7684   0.3302    0.2266 -1.16
psycom_dum_with               -0.0683    0.9340   0.1235    0.1174 -0.58
psycom_dum_study              -0.0856    0.9179   0.1662    0.1586 -0.54
freq_cons_dum_5day             0.0226    1.0229   0.1079    0.1064  0.21
cond_oc_dum_2inact            -0.2520    0.7773   0.1403    0.1450 -1.74
cond_oc_dum_3unemp            -0.1483    0.8621   0.1438    0.1474 -1.01
susprindum_oh                 -0.1126    0.8935   0.4137    0.3334 -0.34
susprindum_coc                 0.1187    1.1260   0.4111    0.3188  0.37
susprindum_pbc                 0.0363    1.0370   0.4006    0.3042  0.12
susprindum_mar                 0.3433    1.4095   0.4282    0.3499  0.98
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.818  
less_90d_tr1.lag                 0.561  
log_dias_treat_imp_sin_na.lag    0.672  
comp_bpsc_y3_severe.lag          0.339  
policonsumo2.lag                 0.482  
edad_al_ing_1                    0.431  
ano_nac_corr                     0.604  
susinidum_oh                     0.381  
susinidum_coc                    0.452  
susinidum_pbc                    0.149  
susinidum_mar                    0.245  
psycom_dum_with                  0.561  
psycom_dum_study                 0.589  
freq_cons_dum_5day               0.832  
cond_oc_dum_2inact               0.082 .
cond_oc_dum_3unemp               0.314  
susprindum_oh                    0.736  
susprindum_coc                   0.710  
susprindum_pbc                   0.905  
susprindum_mar                   0.327  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.065      0.939     0.622      1.83
less_90d_tr1.lag                  1.156      0.865     0.709      1.89
log_dias_treat_imp_sin_na.lag     0.912      1.097     0.594      1.40
comp_bpsc_y3_severe.lag           1.285      0.778     0.768      2.15
policonsumo2.lag                  1.193      0.838     0.730      1.95
edad_al_ing_1                     1.018      0.982     0.973      1.07
ano_nac_corr                      1.011      0.989     0.969      1.06
susinidum_oh                      0.818      1.223     0.521      1.28
susinidum_coc                     0.806      1.241     0.458      1.42
susinidum_pbc                     0.680      1.472     0.402      1.15
susinidum_mar                     0.768      1.301     0.493      1.20
psycom_dum_with                   0.934      1.071     0.742      1.18
psycom_dum_study                  0.918      1.089     0.673      1.25
freq_cons_dum_5day                1.023      0.978     0.830      1.26
cond_oc_dum_2inact                0.777      1.287     0.585      1.03
cond_oc_dum_3unemp                0.862      1.160     0.646      1.15
susprindum_oh                     0.894      1.119     0.465      1.72
susprindum_coc                    1.126      0.888     0.603      2.10
susprindum_pbc                    1.037      0.964     0.571      1.88
susprindum_mar                    1.410      0.709     0.710      2.80

Concordance= 0.558  (se = 0.016 )
Likelihood ratio test= 14.6  on 20 df,   p=0.8
Wald test            = 22.8  on 20 df,   p=0.3
Score (logrank) test = 14.9  on 20 df,   p=0.8,   Robust = 21.6  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.401   0.701   0.802   0.808   0.907   1.542 
[1] "Modality: WO residential\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 337, number of events= 337 
   (312 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.54805   0.57808  0.63302   0.56170 -0.98
less_90d_tr1.lag               1.55245   4.72302  0.44287   0.48428  3.21
log_dias_treat_imp_sin_na.lag  0.44260   1.55674  0.23419   0.18393  2.41
comp_bpsc_y3_severe.lag       -0.33788   0.71328  0.54061   0.46918 -0.72
policonsumo2.lag              -1.38744   0.24971  0.65732   0.48749 -2.85
edad_al_ing_1                  0.00518   1.00520  0.02817   0.02923  0.18
ano_nac_corr                   0.01173   1.01180  0.02745   0.02832  0.41
susinidum_oh                  -0.89518   0.40854  0.36761   0.34203 -2.62
susinidum_coc                 -0.42191   0.65579  0.44454   0.46681 -0.90
susinidum_pbc                 -0.80592   0.44668  0.38239   0.35110 -2.30
susinidum_mar                 -0.67735   0.50796  0.37139   0.34057 -1.99
psycom_dum_with                0.11314   1.11979  0.16892   0.16214  0.70
psycom_dum_study               0.17197   1.18764  0.19648   0.18875  0.91
freq_cons_dum_5day            -0.12210   0.88506  0.13524   0.12778 -0.96
cond_oc_dum_2inact             0.01466   1.01477  0.21303   0.20392  0.07
cond_oc_dum_3unemp             0.11172   1.11820  0.21404   0.20170  0.55
susprindum_oh                  0.60878   1.83818  0.36597   0.33412  1.82
susprindum_coc                 0.20307   1.22516  0.36591   0.34566  0.59
susprindum_pbc                 0.55324   1.73888  0.34393   0.32150  1.72
susprindum_mar                -0.06475   0.93731  0.49574   0.46418 -0.14
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.3292   
less_90d_tr1.lag                0.0013 **
log_dias_treat_imp_sin_na.lag   0.0161 * 
comp_bpsc_y3_severe.lag         0.4714   
policonsumo2.lag                0.0044 **
edad_al_ing_1                   0.8593   
ano_nac_corr                    0.6788   
susinidum_oh                    0.0089 **
susinidum_coc                   0.3661   
susinidum_pbc                   0.0217 * 
susinidum_mar                   0.0467 * 
psycom_dum_with                 0.4853   
psycom_dum_study                0.3622   
freq_cons_dum_5day              0.3393   
cond_oc_dum_2inact              0.9427   
cond_oc_dum_3unemp              0.5796   
susprindum_oh                   0.0685 . 
susprindum_coc                  0.5569   
susprindum_pbc                  0.0853 . 
susprindum_mar                  0.8891   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.578      1.730     0.192     1.738
less_90d_tr1.lag                  4.723      0.212     1.828    12.202
log_dias_treat_imp_sin_na.lag     1.557      0.642     1.086     2.232
comp_bpsc_y3_severe.lag           0.713      1.402     0.284     1.789
policonsumo2.lag                  0.250      4.005     0.096     0.649
edad_al_ing_1                     1.005      0.995     0.949     1.064
ano_nac_corr                      1.012      0.988     0.957     1.070
susinidum_oh                      0.409      2.448     0.209     0.799
susinidum_coc                     0.656      1.525     0.263     1.637
susinidum_pbc                     0.447      2.239     0.224     0.889
susinidum_mar                     0.508      1.969     0.261     0.990
psycom_dum_with                   1.120      0.893     0.815     1.539
psycom_dum_study                  1.188      0.842     0.820     1.719
freq_cons_dum_5day                0.885      1.130     0.689     1.137
cond_oc_dum_2inact                1.015      0.985     0.680     1.513
cond_oc_dum_3unemp                1.118      0.894     0.753     1.660
susprindum_oh                     1.838      0.544     0.955     3.538
susprindum_coc                    1.225      0.816     0.622     2.412
susprindum_pbc                    1.739      0.575     0.926     3.265
susprindum_mar                    0.937      1.067     0.377     2.328

Concordance= 0.58  (se = 0.019 )
Likelihood ratio test= 33.7  on 20 df,   p=0.03
Wald test            = 30.1  on 20 df,   p=0.07
Score (logrank) test = 32.4  on 20 df,   p=0.04,   Robust = 29.8  p=0.07

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.94    2.20    2.54    2.79    2.96   11.34 
[1] "Modality: GP intensive ambulatory\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1468, number of events= 1468 
   (1416 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.88258   0.41371  0.34605   0.23629 -3.74
less_90d_tr1.lag               0.69646   2.00664  0.30727   0.18314  3.80
log_dias_treat_imp_sin_na.lag -0.11098   0.89496  0.17582   0.11884 -0.93
comp_bpsc_y3_severe.lag        0.09737   1.10227  0.26731   0.19971  0.49
policonsumo2.lag              -0.16274   0.84981  0.37994   0.19389 -0.84
edad_al_ing_1                  0.00906   1.00911  0.01199   0.01156  0.78
ano_nac_corr                   0.01241   1.01249  0.01185   0.01152  1.08
susinidum_oh                  -0.17156   0.84235  0.17261   0.14429 -1.19
susinidum_coc                 -0.12936   0.87865  0.20917   0.18547 -0.70
susinidum_pbc                 -0.24760   0.78068  0.19361   0.16656 -1.49
susinidum_mar                 -0.14856   0.86195  0.17518   0.14781 -1.01
psycom_dum_with                0.07155   1.07417  0.05849   0.05756  1.24
psycom_dum_study               0.13765   1.14757  0.07960   0.08249  1.67
freq_cons_dum_5day            -0.02325   0.97702  0.05463   0.05461 -0.43
cond_oc_dum_2inact            -0.16820   0.84519  0.08031   0.07533 -2.23
cond_oc_dum_3unemp            -0.07700   0.92589  0.05856   0.05873 -1.31
susprindum_oh                  0.34467   1.41152  0.22480   0.22376  1.54
susprindum_coc                 0.37247   1.45131  0.22768   0.22788  1.63
susprindum_pbc                 0.36381   1.43880  0.21944   0.21983  1.65
susprindum_mar                 0.54116   1.71799  0.24309   0.24170  2.24
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.00019 ***
less_90d_tr1.lag               0.00014 ***
log_dias_treat_imp_sin_na.lag  0.35037    
comp_bpsc_y3_severe.lag        0.62586    
policonsumo2.lag               0.40130    
edad_al_ing_1                  0.43300    
ano_nac_corr                   0.28143    
susinidum_oh                   0.23445    
susinidum_coc                  0.48548    
susinidum_pbc                  0.13714    
susinidum_mar                  0.31485    
psycom_dum_with                0.21384    
psycom_dum_study               0.09516 .  
freq_cons_dum_5day             0.67023    
cond_oc_dum_2inact             0.02556 *  
cond_oc_dum_3unemp             0.18983    
susprindum_oh                  0.12347    
susprindum_coc                 0.10216    
susprindum_pbc                 0.09793 .  
susprindum_mar                 0.02516 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.414      2.417     0.260     0.657
less_90d_tr1.lag                  2.007      0.498     1.401     2.873
log_dias_treat_imp_sin_na.lag     0.895      1.117     0.709     1.130
comp_bpsc_y3_severe.lag           1.102      0.907     0.745     1.630
policonsumo2.lag                  0.850      1.177     0.581     1.243
edad_al_ing_1                     1.009      0.991     0.986     1.032
ano_nac_corr                      1.012      0.988     0.990     1.036
susinidum_oh                      0.842      1.187     0.635     1.118
susinidum_coc                     0.879      1.138     0.611     1.264
susinidum_pbc                     0.781      1.281     0.563     1.082
susinidum_mar                     0.862      1.160     0.645     1.152
psycom_dum_with                   1.074      0.931     0.960     1.202
psycom_dum_study                  1.148      0.871     0.976     1.349
freq_cons_dum_5day                0.977      1.024     0.878     1.087
cond_oc_dum_2inact                0.845      1.183     0.729     0.980
cond_oc_dum_3unemp                0.926      1.080     0.825     1.039
susprindum_oh                     1.412      0.708     0.910     2.189
susprindum_coc                    1.451      0.689     0.929     2.268
susprindum_pbc                    1.439      0.695     0.935     2.214
susprindum_mar                    1.718      0.582     1.070     2.759

Concordance= 0.536  (se = 0.009 )
Likelihood ratio test= 46.4  on 20 df,   p=7e-04
Wald test            = 54  on 20 df,   p=6e-05
Score (logrank) test = 41.5  on 20 df,   p=0.003,   Robust = 35.7  p=0.02

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.662   0.987   1.058   1.093   1.145   3.159 
[1] "Modality: basic ambulatory\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1208, number of events= 1208 
   (1172 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.2222    1.2488   0.4500    0.3032  0.73
less_90d_tr1.lag               0.8375    2.3106   0.5200    0.4845  1.73
log_dias_treat_imp_sin_na.lag  0.4142    1.5132   0.3048    0.2076  1.99
comp_bpsc_y3_severe.lag        0.0768    1.0799   0.3167    0.3050  0.25
policonsumo2.lag               0.3782    1.4596   0.4335    0.3065  1.23
edad_al_ing_1                  0.0414    1.0422   0.0138    0.0132  3.14
ano_nac_corr                   0.0402    1.0410   0.0136    0.0129  3.12
susinidum_oh                   0.0310    1.0315   0.2196    0.2160  0.14
susinidum_coc                  0.0954    1.1001   0.2557    0.2466  0.39
susinidum_pbc                  0.2317    1.2608   0.2497    0.2416  0.96
susinidum_mar                  0.0550    1.0566   0.2215    0.2192  0.25
psycom_dum_with               -0.0615    0.9403   0.0666    0.0678 -0.91
psycom_dum_study              -0.1058    0.8996   0.0799    0.0743 -1.42
freq_cons_dum_5day             0.0800    1.0832   0.0674    0.0653  1.22
cond_oc_dum_2inact            -0.0123    0.9878   0.0959    0.0935 -0.13
cond_oc_dum_3unemp            -0.0226    0.9777   0.0695    0.0705 -0.32
susprindum_oh                 -0.4384    0.6451   0.2856    0.2298 -1.91
susprindum_coc                -0.4450    0.6408   0.2898    0.2350 -1.89
susprindum_pbc                -0.4805    0.6185   0.2855    0.2282 -2.11
susprindum_mar                -0.4434    0.6418   0.2988    0.2540 -1.75
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.4637   
less_90d_tr1.lag                0.0839 . 
log_dias_treat_imp_sin_na.lag   0.0460 * 
comp_bpsc_y3_severe.lag         0.8011   
policonsumo2.lag                0.2172   
edad_al_ing_1                   0.0017 **
ano_nac_corr                    0.0018 **
susinidum_oh                    0.8859   
susinidum_coc                   0.6989   
susinidum_pbc                   0.3374   
susinidum_mar                   0.8018   
psycom_dum_with                 0.3641   
psycom_dum_study                0.1543   
freq_cons_dum_5day              0.2208   
cond_oc_dum_2inact              0.8957   
cond_oc_dum_3unemp              0.7489   
susprindum_oh                   0.0564 . 
susprindum_coc                  0.0582 . 
susprindum_pbc                  0.0352 * 
susprindum_mar                  0.0809 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.249      0.801     0.689     2.263
less_90d_tr1.lag                  2.311      0.433     0.894     5.972
log_dias_treat_imp_sin_na.lag     1.513      0.661     1.007     2.273
comp_bpsc_y3_severe.lag           1.080      0.926     0.594     1.963
policonsumo2.lag                  1.460      0.685     0.800     2.661
edad_al_ing_1                     1.042      0.959     1.016     1.069
ano_nac_corr                      1.041      0.961     1.015     1.068
susinidum_oh                      1.031      0.969     0.675     1.575
susinidum_coc                     1.100      0.909     0.678     1.784
susinidum_pbc                     1.261      0.793     0.785     2.024
susinidum_mar                     1.057      0.946     0.688     1.623
psycom_dum_with                   0.940      1.063     0.823     1.074
psycom_dum_study                  0.900      1.112     0.778     1.041
freq_cons_dum_5day                1.083      0.923     0.953     1.231
cond_oc_dum_2inact                0.988      1.012     0.822     1.187
cond_oc_dum_3unemp                0.978      1.023     0.851     1.123
susprindum_oh                     0.645      1.550     0.411     1.012
susprindum_coc                    0.641      1.561     0.404     1.016
susprindum_pbc                    0.618      1.617     0.395     0.967
susprindum_mar                    0.642      1.558     0.390     1.056

Concordance= 0.552  (se = 0.009 )
Likelihood ratio test= 29  on 20 df,   p=0.09
Wald test            = 43.1  on 20 df,   p=0.002
Score (logrank) test = 27.6  on 20 df,   p=0.1,   Robust = 32  p=0.04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.201   0.314   0.343   0.349   0.374   1.062 
[1] "Modality: GP residential\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 612, number of events= 612 
   (578 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.0126    1.0127   0.5116    0.2984  0.04
less_90d_tr1.lag               0.3437    1.4102   0.4858    0.3058  1.12
log_dias_treat_imp_sin_na.lag -0.1050    0.9003   0.2077    0.1210 -0.87
comp_bpsc_y3_severe.lag        0.4596    1.5835   0.4627    0.2917  1.58
policonsumo2.lag               0.5207    1.6832   0.5941    0.3723  1.40
edad_al_ing_1                  0.0165    1.0167   0.0203    0.0182  0.91
ano_nac_corr                   0.0213    1.0215   0.0200    0.0183  1.16
susinidum_oh                  -0.4668    0.6270   0.3163    0.2554 -1.83
susinidum_coc                 -0.0377    0.9630   0.3617    0.2968 -0.13
susinidum_pbc                 -0.2989    0.7416   0.3315    0.2661 -1.12
susinidum_mar                 -0.4887    0.6134   0.3163    0.2526 -1.94
psycom_dum_with               -0.1009    0.9040   0.0943    0.0976 -1.03
psycom_dum_study              -0.0178    0.9824   0.1338    0.1232 -0.14
freq_cons_dum_5day             0.1393    1.1494   0.0949    0.0940  1.48
cond_oc_dum_2inact            -0.0755    0.9272   0.1501    0.1472 -0.51
cond_oc_dum_3unemp            -0.0611    0.9407   0.1294    0.1260 -0.49
susprindum_oh                  0.8357    2.3065   0.4654    0.4046  2.07
susprindum_coc                 0.8076    2.2426   0.4702    0.4086  1.98
susprindum_pbc                 0.8110    2.2503   0.4570    0.3925  2.07
susprindum_mar                 0.5686    1.7657   0.5253    0.4503  1.26
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.966  
less_90d_tr1.lag                 0.261  
log_dias_treat_imp_sin_na.lag    0.386  
comp_bpsc_y3_severe.lag          0.115  
policonsumo2.lag                 0.162  
edad_al_ing_1                    0.365  
ano_nac_corr                     0.246  
susinidum_oh                     0.068 .
susinidum_coc                    0.899  
susinidum_pbc                    0.261  
susinidum_mar                    0.053 .
psycom_dum_with                  0.301  
psycom_dum_study                 0.885  
freq_cons_dum_5day               0.138  
cond_oc_dum_2inact               0.608  
cond_oc_dum_3unemp               0.628  
susprindum_oh                    0.039 *
susprindum_coc                   0.048 *
susprindum_pbc                   0.039 *
susprindum_mar                   0.207  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.013      0.987     0.564      1.82
less_90d_tr1.lag                  1.410      0.709     0.774      2.57
log_dias_treat_imp_sin_na.lag     0.900      1.111     0.710      1.14
comp_bpsc_y3_severe.lag           1.583      0.632     0.894      2.81
policonsumo2.lag                  1.683      0.594     0.811      3.49
edad_al_ing_1                     1.017      0.984     0.981      1.05
ano_nac_corr                      1.022      0.979     0.985      1.06
susinidum_oh                      0.627      1.595     0.380      1.03
susinidum_coc                     0.963      1.038     0.538      1.72
susinidum_pbc                     0.742      1.348     0.440      1.25
susinidum_mar                     0.613      1.630     0.374      1.01
psycom_dum_with                   0.904      1.106     0.747      1.09
psycom_dum_study                  0.982      1.018     0.772      1.25
freq_cons_dum_5day                1.149      0.870     0.956      1.38
cond_oc_dum_2inact                0.927      1.078     0.695      1.24
cond_oc_dum_3unemp                0.941      1.063     0.735      1.20
susprindum_oh                     2.307      0.434     1.044      5.10
susprindum_coc                    2.243      0.446     1.007      5.00
susprindum_pbc                    2.250      0.444     1.043      4.86
susprindum_mar                    1.766      0.566     0.730      4.27

Concordance= 0.549  (se = 0.013 )
Likelihood ratio test= 30.4  on 20 df,   p=0.06
Wald test            = 47.8  on 20 df,   p=5e-04
Score (logrank) test = 28.6  on 20 df,   p=0.1,   Robust = 28.3  p=0.1

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.089   0.169   0.184   0.191   0.201   0.559 
[1] "Modality: WO intensive ambulatory\nTime interval: (20,30]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 247, number of events= 247 
   (235 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.40479   1.49898  1.04300   0.48419  0.84
less_90d_tr1.lag               0.08277   1.08629  0.91450   0.49716  0.17
log_dias_treat_imp_sin_na.lag  0.19472   1.21497  0.76258   0.39201  0.50
comp_bpsc_y3_severe.lag        0.43809   1.54974  0.87445   0.57240  0.77
policonsumo2.lag               0.97602   2.65387  0.77855   0.63265  1.54
edad_al_ing_1                 -0.01578   0.98434  0.03117   0.02972 -0.53
ano_nac_corr                  -0.01833   0.98184  0.02929   0.02678 -0.68
susinidum_oh                  -0.54823   0.57797  0.55667   0.47227 -1.16
susinidum_coc                 -0.41163   0.66257  0.63174   0.54671 -0.75
susinidum_pbc                 -0.72558   0.48404  0.59230   0.50021 -1.45
susinidum_mar                 -0.44927   0.63809  0.56526   0.47497 -0.95
psycom_dum_with                0.02344   1.02371  0.14638   0.14068  0.17
psycom_dum_study               0.30425   1.35561  0.23596   0.25941  1.17
freq_cons_dum_5day            -0.25259   0.77679  0.14603   0.13977 -1.81
cond_oc_dum_2inact            -0.05708   0.94452  0.17429   0.15677 -0.36
cond_oc_dum_3unemp            -0.00650   0.99352  0.18484   0.18418 -0.04
susprindum_oh                 -0.43071   0.65005  0.45904   0.35991 -1.20
susprindum_coc                 0.12234   1.13014  0.47224   0.39638  0.31
susprindum_pbc                -0.00815   0.99189  0.46215   0.37515 -0.02
susprindum_mar                -0.01805   0.98211  0.51912   0.40588 -0.04
                              Pr(&gt;|z|)  
tr_outcome.lag                   0.403  
less_90d_tr1.lag                 0.868  
log_dias_treat_imp_sin_na.lag    0.619  
comp_bpsc_y3_severe.lag          0.444  
policonsumo2.lag                 0.123  
edad_al_ing_1                    0.595  
ano_nac_corr                     0.494  
susinidum_oh                     0.246  
susinidum_coc                    0.452  
susinidum_pbc                    0.147  
susinidum_mar                    0.344  
psycom_dum_with                  0.868  
psycom_dum_study                 0.241  
freq_cons_dum_5day               0.071 .
cond_oc_dum_2inact               0.716  
cond_oc_dum_3unemp               0.972  
susprindum_oh                    0.231  
susprindum_coc                   0.758  
susprindum_pbc                   0.983  
susprindum_mar                   0.965  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.499      0.667     0.580      3.87
less_90d_tr1.lag                  1.086      0.921     0.410      2.88
log_dias_treat_imp_sin_na.lag     1.215      0.823     0.563      2.62
comp_bpsc_y3_severe.lag           1.550      0.645     0.505      4.76
policonsumo2.lag                  2.654      0.377     0.768      9.17
edad_al_ing_1                     0.984      1.016     0.929      1.04
ano_nac_corr                      0.982      1.018     0.932      1.03
susinidum_oh                      0.578      1.730     0.229      1.46
susinidum_coc                     0.663      1.509     0.227      1.93
susinidum_pbc                     0.484      2.066     0.182      1.29
susinidum_mar                     0.638      1.567     0.252      1.62
psycom_dum_with                   1.024      0.977     0.777      1.35
psycom_dum_study                  1.356      0.738     0.815      2.25
freq_cons_dum_5day                0.777      1.287     0.591      1.02
cond_oc_dum_2inact                0.945      1.059     0.695      1.28
cond_oc_dum_3unemp                0.994      1.007     0.692      1.43
susprindum_oh                     0.650      1.538     0.321      1.32
susprindum_coc                    1.130      0.885     0.520      2.46
susprindum_pbc                    0.992      1.008     0.475      2.07
susprindum_mar                    0.982      1.018     0.443      2.18

Concordance= 0.589  (se = 0.021 )
Likelihood ratio test= 17.7  on 20 df,   p=0.6
Wald test            = 28.8  on 20 df,   p=0.09
Score (logrank) test = 17.2  on 20 df,   p=0.6,   Robust = 21  p=0.4

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.143   0.236   0.286   0.305   0.360   1.005 
[1] "Modality: WO residential\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 374, number of events= 374 
   (332 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.1910    0.8261   0.3716    0.1834 -1.04
less_90d_tr1.lag               0.3183    1.3749   0.2421    0.1323  2.41
log_dias_treat_imp_sin_na.lag -0.0582    0.9434   0.0852    0.0303 -1.92
comp_bpsc_y3_severe.lag        0.2192    1.2451   0.4037    0.1521  1.44
policonsumo2.lag              -0.1290    0.8789   0.5011    0.1685 -0.77
edad_al_ing_1                  0.0669    1.0692   0.0311    0.0320  2.09
ano_nac_corr                   0.0667    1.0689   0.0305    0.0315  2.12
susinidum_oh                   1.1813    3.2587   0.5603    0.3102  3.81
susinidum_coc                  1.4419    4.2287   0.6052    0.3416  4.22
susinidum_pbc                  1.1537    3.1698   0.5694    0.3223  3.58
susinidum_mar                  1.1777    3.2468   0.5616    0.3072  3.83
psycom_dum_with               -0.0454    0.9557   0.1506    0.1451 -0.31
psycom_dum_study               0.0300    1.0305   0.1714    0.1609  0.19
freq_cons_dum_5day            -0.0269    0.9734   0.1255    0.1198 -0.22
cond_oc_dum_2inact            -0.1698    0.8439   0.2263    0.1750 -0.97
cond_oc_dum_3unemp            -0.2563    0.7739   0.2304    0.1896 -1.35
susprindum_oh                 -0.8702    0.4189   0.3963    0.2483 -3.50
susprindum_coc                -0.9727    0.3781   0.4019    0.2531 -3.84
susprindum_pbc                -0.8575    0.4242   0.3773    0.2169 -3.95
susprindum_mar                -0.4442    0.6413   0.5670    0.3156 -1.41
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.29773    
less_90d_tr1.lag               0.01615 *  
log_dias_treat_imp_sin_na.lag  0.05447 .  
comp_bpsc_y3_severe.lag        0.14948    
policonsumo2.lag               0.44375    
edad_al_ing_1                  0.03654 *  
ano_nac_corr                   0.03411 *  
susinidum_oh                   0.00014 ***
susinidum_coc                  2.4e-05 ***
susinidum_pbc                  0.00034 ***
susinidum_mar                  0.00013 ***
psycom_dum_with                0.75448    
psycom_dum_study               0.85194    
freq_cons_dum_5day             0.82209    
cond_oc_dum_2inact             0.33203    
cond_oc_dum_3unemp             0.17642    
susprindum_oh                  0.00046 ***
susprindum_coc                 0.00012 ***
susprindum_pbc                 7.7e-05 ***
susprindum_mar                 0.15934    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.826      1.210     0.577     1.184
less_90d_tr1.lag                  1.375      0.727     1.061     1.782
log_dias_treat_imp_sin_na.lag     0.943      1.060     0.889     1.001
comp_bpsc_y3_severe.lag           1.245      0.803     0.924     1.677
policonsumo2.lag                  0.879      1.138     0.632     1.223
edad_al_ing_1                     1.069      0.935     1.004     1.138
ano_nac_corr                      1.069      0.935     1.005     1.137
susinidum_oh                      3.259      0.307     1.774     5.985
susinidum_coc                     4.229      0.236     2.165     8.261
susinidum_pbc                     3.170      0.315     1.685     5.962
susinidum_mar                     3.247      0.308     1.778     5.928
psycom_dum_with                   0.956      1.046     0.719     1.270
psycom_dum_study                  1.030      0.970     0.752     1.413
freq_cons_dum_5day                0.973      1.027     0.770     1.231
cond_oc_dum_2inact                0.844      1.185     0.599     1.189
cond_oc_dum_3unemp                0.774      1.292     0.534     1.122
susprindum_oh                     0.419      2.387     0.257     0.681
susprindum_coc                    0.378      2.645     0.230     0.621
susprindum_pbc                    0.424      2.357     0.277     0.649
susprindum_mar                    0.641      1.559     0.345     1.191

Concordance= 0.558  (se = 0.016 )
Likelihood ratio test= 21.5  on 20 df,   p=0.4
Wald test            = 72.6  on 20 df,   p=7e-08
Score (logrank) test = 20.9  on 20 df,   p=0.4,   Robust = 31.6  p=0.05

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.245   0.662   0.747   0.776   0.873   2.800 
[1] "Modality: GP intensive ambulatory\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1813, number of events= 1813 
   (1667 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.14332   1.15409  0.22733   0.15475  0.93
less_90d_tr1.lag               0.07829   1.08144  0.15134   0.13201  0.59
log_dias_treat_imp_sin_na.lag -0.07846   0.92454  0.06789   0.02680 -2.93
comp_bpsc_y3_severe.lag        0.22928   1.25770  0.14756   0.12873  1.78
policonsumo2.lag              -0.04683   0.95425  0.22188   0.15928 -0.29
edad_al_ing_1                  0.04965   1.05091  0.01264   0.01231  4.03
ano_nac_corr                   0.05133   1.05267  0.01264   0.01252  4.10
susinidum_oh                  -0.22128   0.80149  0.18650   0.15174 -1.46
susinidum_coc                 -0.10405   0.90118  0.21627   0.18393 -0.57
susinidum_pbc                 -0.29351   0.74564  0.20573   0.17919 -1.64
susinidum_mar                 -0.26823   0.76473  0.18907   0.15569 -1.72
psycom_dum_with                0.03134   1.03183  0.05337   0.05347  0.59
psycom_dum_study              -0.02588   0.97445  0.07087   0.07111 -0.36
freq_cons_dum_5day             0.02118   1.02141  0.04865   0.04795  0.44
cond_oc_dum_2inact            -0.00426   0.99575  0.07192   0.07471 -0.06
cond_oc_dum_3unemp             0.09166   1.09600  0.05231   0.05118  1.79
susprindum_oh                  0.02147   1.02171  0.21852   0.17270  0.12
susprindum_coc                 0.07592   1.07887  0.22263   0.17813  0.43
susprindum_pbc                 0.05355   1.05501  0.21734   0.17184  0.31
susprindum_mar                 0.05373   1.05520  0.24219   0.19594  0.27
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.3544    
less_90d_tr1.lag                0.5531    
log_dias_treat_imp_sin_na.lag   0.0034 ** 
comp_bpsc_y3_severe.lag         0.0749 .  
policonsumo2.lag                0.7687    
edad_al_ing_1                  5.5e-05 ***
ano_nac_corr                   4.1e-05 ***
susinidum_oh                    0.1448    
susinidum_coc                   0.5716    
susinidum_pbc                   0.1014    
susinidum_mar                   0.0849 .  
psycom_dum_with                 0.5579    
psycom_dum_study                0.7159    
freq_cons_dum_5day              0.6586    
cond_oc_dum_2inact              0.9545    
cond_oc_dum_3unemp              0.0733 .  
susprindum_oh                   0.9011    
susprindum_coc                  0.6700    
susprindum_pbc                  0.7553    
susprindum_mar                  0.7839    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.154      0.866     0.852     1.563
less_90d_tr1.lag                  1.081      0.925     0.835     1.401
log_dias_treat_imp_sin_na.lag     0.925      1.082     0.877     0.974
comp_bpsc_y3_severe.lag           1.258      0.795     0.977     1.619
policonsumo2.lag                  0.954      1.048     0.698     1.304
edad_al_ing_1                     1.051      0.952     1.026     1.077
ano_nac_corr                      1.053      0.950     1.027     1.079
susinidum_oh                      0.801      1.248     0.595     1.079
susinidum_coc                     0.901      1.110     0.628     1.292
susinidum_pbc                     0.746      1.341     0.525     1.059
susinidum_mar                     0.765      1.308     0.564     1.038
psycom_dum_with                   1.032      0.969     0.929     1.146
psycom_dum_study                  0.974      1.026     0.848     1.120
freq_cons_dum_5day                1.021      0.979     0.930     1.122
cond_oc_dum_2inact                0.996      1.004     0.860     1.153
cond_oc_dum_3unemp                1.096      0.912     0.991     1.212
susprindum_oh                     1.022      0.979     0.728     1.433
susprindum_coc                    1.079      0.927     0.761     1.530
susprindum_pbc                    1.055      0.948     0.753     1.478
susprindum_mar                    1.055      0.948     0.719     1.549

Concordance= 0.541  (se = 0.008 )
Likelihood ratio test= 38.2  on 20 df,   p=0.008
Wald test            = 52.9  on 20 df,   p=8e-05
Score (logrank) test = 37.1  on 20 df,   p=0.01,   Robust = 47.9  p=4e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.467   0.699   0.763   0.780   0.840   1.641 
[1] "Modality: basic ambulatory\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 1568, number of events= 1568 
   (1465 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.2396    0.7869   0.2605    0.1952 -1.23
less_90d_tr1.lag               0.1666    1.1813   0.2345    0.2055  0.81
log_dias_treat_imp_sin_na.lag  0.0305    1.0310   0.1362    0.1365  0.22
comp_bpsc_y3_severe.lag        0.1990    1.2201   0.2024    0.1578  1.26
policonsumo2.lag               0.2099    1.2336   0.2926    0.2411  0.87
edad_al_ing_1                  0.0621    1.0640   0.0137    0.0134  4.64
ano_nac_corr                   0.0617    1.0636   0.0134    0.0134  4.60
susinidum_oh                   0.2714    1.3117   0.1894    0.1984  1.37
susinidum_coc                  0.1121    1.1186   0.2247    0.2401  0.47
susinidum_pbc                  0.2334    1.2629   0.2212    0.2241  1.04
susinidum_mar                  0.3088    1.3618   0.1922    0.2027  1.52
psycom_dum_with                0.0789    1.0821   0.0567    0.0574  1.38
psycom_dum_study               0.0741    1.0769   0.0745    0.0720  1.03
freq_cons_dum_5day            -0.0672    0.9350   0.0585    0.0580 -1.16
cond_oc_dum_2inact            -0.0729    0.9297   0.0799    0.0772 -0.94
cond_oc_dum_3unemp             0.0917    1.0960   0.0615    0.0612  1.50
susprindum_oh                 -0.1605    0.8517   0.2267    0.1864 -0.86
susprindum_coc                -0.1131    0.8930   0.2313    0.1932 -0.59
susprindum_pbc                -0.1756    0.8390   0.2260    0.1865 -0.94
susprindum_mar                -0.2675    0.7653   0.2436    0.2004 -1.33
                              Pr(&gt;|z|)    
tr_outcome.lag                    0.22    
less_90d_tr1.lag                  0.42    
log_dias_treat_imp_sin_na.lag     0.82    
comp_bpsc_y3_severe.lag           0.21    
policonsumo2.lag                  0.38    
edad_al_ing_1                  3.5e-06 ***
ano_nac_corr                   4.1e-06 ***
susinidum_oh                      0.17    
susinidum_coc                     0.64    
susinidum_pbc                     0.30    
susinidum_mar                     0.13    
psycom_dum_with                   0.17    
psycom_dum_study                  0.30    
freq_cons_dum_5day                0.25    
cond_oc_dum_2inact                0.34    
cond_oc_dum_3unemp                0.13    
susprindum_oh                     0.39    
susprindum_coc                    0.56    
susprindum_pbc                    0.35    
susprindum_mar                    0.18    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.787      1.271     0.537      1.15
less_90d_tr1.lag                  1.181      0.847     0.790      1.77
log_dias_treat_imp_sin_na.lag     1.031      0.970     0.789      1.35
comp_bpsc_y3_severe.lag           1.220      0.820     0.896      1.66
policonsumo2.lag                  1.234      0.811     0.769      1.98
edad_al_ing_1                     1.064      0.940     1.036      1.09
ano_nac_corr                      1.064      0.940     1.036      1.09
susinidum_oh                      1.312      0.762     0.889      1.94
susinidum_coc                     1.119      0.894     0.699      1.79
susinidum_pbc                     1.263      0.792     0.814      1.96
susinidum_mar                     1.362      0.734     0.915      2.03
psycom_dum_with                   1.082      0.924     0.967      1.21
psycom_dum_study                  1.077      0.929     0.935      1.24
freq_cons_dum_5day                0.935      1.070     0.835      1.05
cond_oc_dum_2inact                0.930      1.076     0.799      1.08
cond_oc_dum_3unemp                1.096      0.912     0.972      1.24
susprindum_oh                     0.852      1.174     0.591      1.23
susprindum_coc                    0.893      1.120     0.612      1.30
susprindum_pbc                    0.839      1.192     0.582      1.21
susprindum_mar                    0.765      1.307     0.517      1.13

Concordance= 0.552  (se = 0.008 )
Likelihood ratio test= 45.3  on 20 df,   p=0.001
Wald test            = 52  on 20 df,   p=1e-04
Score (logrank) test = 44.3  on 20 df,   p=0.001,   Robust = 50  p=2e-04

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.412   0.552   0.624   0.638   0.705   1.289 
[1] "Modality: GP residential\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 756, number of events= 756 
   (698 observations deleted due to missingness)

                                   coef exp(coef)  se(coef) robust se     z
tr_outcome.lag                 0.070705  1.073265  0.311271  0.180516  0.39
less_90d_tr1.lag              -0.260209  0.770890  0.245527  0.187185 -1.39
log_dias_treat_imp_sin_na.lag -0.055768  0.945758  0.100114  0.081450 -0.68
comp_bpsc_y3_severe.lag        0.785267  2.192992  0.372942  0.268580  2.92
policonsumo2.lag              -0.642543  0.525953  0.355505  0.222510 -2.89
edad_al_ing_1                  0.081089  1.084468  0.020322  0.018749  4.33
ano_nac_corr                   0.084354  1.088014  0.020160  0.018604  4.53
susinidum_oh                  -0.029896  0.970547  0.247800  0.318855 -0.09
susinidum_coc                  0.388930  1.475401  0.325541  0.367282  1.06
susinidum_pbc                  0.104636  1.110306  0.265472  0.327583  0.32
susinidum_mar                 -0.000313  0.999687  0.247905  0.317410  0.00
psycom_dum_with               -0.113781  0.892453  0.084083  0.083715 -1.36
psycom_dum_study              -0.126070  0.881553  0.117167  0.114303 -1.10
freq_cons_dum_5day             0.007669  1.007698  0.086974  0.081765  0.09
cond_oc_dum_2inact             0.155831  1.168629  0.138600  0.144992  1.07
cond_oc_dum_3unemp             0.239732  1.270908  0.114408  0.107619  2.23
susprindum_oh                  0.168151  1.183116  0.337103  0.282967  0.59
susprindum_coc                -0.137028  0.871946  0.344384  0.295404 -0.46
susprindum_pbc                -0.012679  0.987401  0.326303  0.271486 -0.05
susprindum_mar                 0.122759  1.130612  0.377851  0.322122  0.38
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.6953    
less_90d_tr1.lag                0.1645    
log_dias_treat_imp_sin_na.lag   0.4935    
comp_bpsc_y3_severe.lag         0.0035 ** 
policonsumo2.lag                0.0039 ** 
edad_al_ing_1                  1.5e-05 ***
ano_nac_corr                   5.8e-06 ***
susinidum_oh                    0.9253    
susinidum_coc                   0.2896    
susinidum_pbc                   0.7494    
susinidum_mar                   0.9992    
psycom_dum_with                 0.1741    
psycom_dum_study                0.2700    
freq_cons_dum_5day              0.9253    
cond_oc_dum_2inact              0.2825    
cond_oc_dum_3unemp              0.0259 *  
susprindum_oh                   0.5523    
susprindum_coc                  0.6427    
susprindum_pbc                  0.9628    
susprindum_mar                  0.7031    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.073      0.932     0.753     1.529
less_90d_tr1.lag                  0.771      1.297     0.534     1.113
log_dias_treat_imp_sin_na.lag     0.946      1.057     0.806     1.109
comp_bpsc_y3_severe.lag           2.193      0.456     1.295     3.712
policonsumo2.lag                  0.526      1.901     0.340     0.813
edad_al_ing_1                     1.084      0.922     1.045     1.125
ano_nac_corr                      1.088      0.919     1.049     1.128
susinidum_oh                      0.971      1.030     0.520     1.813
susinidum_coc                     1.475      0.678     0.718     3.031
susinidum_pbc                     1.110      0.901     0.584     2.110
susinidum_mar                     1.000      1.000     0.537     1.862
psycom_dum_with                   0.892      1.121     0.757     1.052
psycom_dum_study                  0.882      1.134     0.705     1.103
freq_cons_dum_5day                1.008      0.992     0.858     1.183
cond_oc_dum_2inact                1.169      0.856     0.880     1.553
cond_oc_dum_3unemp                1.271      0.787     1.029     1.569
susprindum_oh                     1.183      0.845     0.679     2.060
susprindum_coc                    0.872      1.147     0.489     1.556
susprindum_pbc                    0.987      1.013     0.580     1.681
susprindum_mar                    1.131      0.884     0.601     2.126

Concordance= 0.567  (se = 0.012 )
Likelihood ratio test= 35.4  on 20 df,   p=0.02
Wald test            = 54.3  on 20 df,   p=5e-05
Score (logrank) test = 35.7  on 20 df,   p=0.02,   Robust = 43.4  p=0.002

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.356   0.790   0.915   0.932   1.057   2.345 
[1] "Modality: WO intensive ambulatory\nTime interval: (30,50]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 272, number of events= 272 
   (247 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.5814    0.5591   0.6865    0.4366 -1.33
less_90d_tr1.lag               1.2589    3.5215   0.4292    0.3305  3.81
log_dias_treat_imp_sin_na.lag  0.1274    1.1358   0.1779    0.0937  1.36
comp_bpsc_y3_severe.lag       -0.8336    0.4345   0.6234    0.4921 -1.69
policonsumo2.lag               0.1199    1.1274   0.6456    0.5892  0.20
edad_al_ing_1                  0.0296    1.0301   0.0335    0.0305  0.97
ano_nac_corr                   0.0270    1.0274   0.0327    0.0309  0.87
susinidum_oh                  -0.6095    0.5436   0.4208    0.4329 -1.41
susinidum_coc                 -0.4464    0.6399   0.5109    0.5645 -0.79
susinidum_pbc                 -0.3263    0.7216   0.4432    0.4572 -0.71
susinidum_mar                 -0.3963    0.6728   0.4257    0.4399 -0.90
psycom_dum_with                0.1430    1.1537   0.1442    0.1415  1.01
psycom_dum_study              -0.2141    0.8073   0.2120    0.1933 -1.11
freq_cons_dum_5day             0.0414    1.0423   0.1349    0.1394  0.30
cond_oc_dum_2inact             0.0616    1.0635   0.1674    0.1655  0.37
cond_oc_dum_3unemp             0.1078    1.1138   0.1722    0.1674  0.64
susprindum_oh                 -0.4157    0.6599   0.4391    0.2908 -1.43
susprindum_coc                -0.1702    0.8435   0.4485    0.2815 -0.60
susprindum_pbc                -0.3561    0.7004   0.4249    0.2678 -1.33
susprindum_mar                -0.1563    0.8553   0.4773    0.3353 -0.47
                              Pr(&gt;|z|)    
tr_outcome.lag                 0.18298    
less_90d_tr1.lag               0.00014 ***
log_dias_treat_imp_sin_na.lag  0.17413    
comp_bpsc_y3_severe.lag        0.09030 .  
policonsumo2.lag               0.83876    
edad_al_ing_1                  0.33056    
ano_nac_corr                   0.38200    
susinidum_oh                   0.15914    
susinidum_coc                  0.42909    
susinidum_pbc                  0.47550    
susinidum_mar                  0.36775    
psycom_dum_with                0.31218    
psycom_dum_study               0.26805    
freq_cons_dum_5day             0.76662    
cond_oc_dum_2inact             0.70979    
cond_oc_dum_3unemp             0.51948    
susprindum_oh                  0.15284    
susprindum_coc                 0.54539    
susprindum_pbc                 0.18369    
susprindum_mar                 0.64124    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.559      1.788     0.238      1.32
less_90d_tr1.lag                  3.522      0.284     1.842      6.73
log_dias_treat_imp_sin_na.lag     1.136      0.880     0.945      1.36
comp_bpsc_y3_severe.lag           0.434      2.302     0.166      1.14
policonsumo2.lag                  1.127      0.887     0.355      3.58
edad_al_ing_1                     1.030      0.971     0.970      1.09
ano_nac_corr                      1.027      0.973     0.967      1.09
susinidum_oh                      0.544      1.839     0.233      1.27
susinidum_coc                     0.640      1.563     0.212      1.93
susinidum_pbc                     0.722      1.386     0.295      1.77
susinidum_mar                     0.673      1.486     0.284      1.59
psycom_dum_with                   1.154      0.867     0.874      1.52
psycom_dum_study                  0.807      1.239     0.553      1.18
freq_cons_dum_5day                1.042      0.959     0.793      1.37
cond_oc_dum_2inact                1.064      0.940     0.769      1.47
cond_oc_dum_3unemp                1.114      0.898     0.802      1.55
susprindum_oh                     0.660      1.515     0.373      1.17
susprindum_coc                    0.843      1.186     0.486      1.46
susprindum_pbc                    0.700      1.428     0.414      1.18
susprindum_mar                    0.855      1.169     0.443      1.65

Concordance= 0.564  (se = 0.018 )
Likelihood ratio test= 23.1  on 20 df,   p=0.3
Wald test            = 48.5  on 20 df,   p=4e-04
Score (logrank) test = 21.2  on 20 df,   p=0.4,   Robust = 29.2  p=0.08

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.01    1.69    2.07    2.19    2.44    8.87 
[1] "Modality: WO residential\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 179, number of events= 179 
   (161 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.11718   1.12432  0.61305   0.54534  0.21
less_90d_tr1.lag               1.02457   2.78591  1.06311   0.67874  1.51
log_dias_treat_imp_sin_na.lag  0.11300   1.11963  0.72792   0.40985  0.28
comp_bpsc_y3_severe.lag        0.42784   1.53394  0.84312   0.62478  0.68
policonsumo2.lag               0.64360   1.90332  0.56869   0.31440  2.05
edad_al_ing_1                  0.03070   1.03118  0.05649   0.05622  0.55
ano_nac_corr                   0.04493   1.04596  0.05520   0.05505  0.82
susinidum_oh                  -0.87341   0.41752  0.63993   0.44994 -1.94
susinidum_coc                 -0.55173   0.57595  0.72746   0.52218 -1.06
susinidum_pbc                 -0.76520   0.46524  0.65960   0.46848 -1.63
susinidum_mar                 -0.42396   0.65445  0.63809   0.47701 -0.89
psycom_dum_with               -0.57471   0.56287  0.22561   0.21753 -2.64
psycom_dum_study              -0.65671   0.51856  0.26267   0.27317 -2.40
freq_cons_dum_5day             0.01414   1.01425  0.20775   0.20475  0.07
cond_oc_dum_2inact            -0.12188   0.88525  0.30041   0.23571 -0.52
cond_oc_dum_3unemp            -0.01956   0.98063  0.30449   0.23485 -0.08
susprindum_oh                  0.05359   1.05505  0.52266   0.41524  0.13
susprindum_coc                 0.24811   1.28159  0.53273   0.42393  0.59
susprindum_pbc                 0.05261   1.05402  0.48620   0.39046  0.13
susprindum_mar                -0.00979   0.99026  0.77683   0.59414 -0.02
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.8299   
less_90d_tr1.lag                0.1312   
log_dias_treat_imp_sin_na.lag   0.7828   
comp_bpsc_y3_severe.lag         0.4935   
policonsumo2.lag                0.0406 * 
edad_al_ing_1                   0.5850   
ano_nac_corr                    0.4143   
susinidum_oh                    0.0522 . 
susinidum_coc                   0.2907   
susinidum_pbc                   0.1024   
susinidum_mar                   0.3741   
psycom_dum_with                 0.0082 **
psycom_dum_study                0.0162 * 
freq_cons_dum_5day              0.9449   
cond_oc_dum_2inact              0.6051   
cond_oc_dum_3unemp              0.9336   
susprindum_oh                   0.8973   
susprindum_coc                  0.5584   
susprindum_pbc                  0.8928   
susprindum_mar                  0.9869   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.124      0.889     0.386     3.274
less_90d_tr1.lag                  2.786      0.359     0.737    10.537
log_dias_treat_imp_sin_na.lag     1.120      0.893     0.501     2.500
comp_bpsc_y3_severe.lag           1.534      0.652     0.451     5.219
policonsumo2.lag                  1.903      0.525     1.028     3.525
edad_al_ing_1                     1.031      0.970     0.924     1.151
ano_nac_corr                      1.046      0.956     0.939     1.165
susinidum_oh                      0.418      2.395     0.173     1.008
susinidum_coc                     0.576      1.736     0.207     1.603
susinidum_pbc                     0.465      2.149     0.186     1.165
susinidum_mar                     0.654      1.528     0.257     1.667
psycom_dum_with                   0.563      1.777     0.367     0.862
psycom_dum_study                  0.519      1.928     0.304     0.886
freq_cons_dum_5day                1.014      0.986     0.679     1.515
cond_oc_dum_2inact                0.885      1.130     0.558     1.405
cond_oc_dum_3unemp                0.981      1.020     0.619     1.554
susprindum_oh                     1.055      0.948     0.468     2.381
susprindum_coc                    1.282      0.780     0.558     2.942
susprindum_pbc                    1.054      0.949     0.490     2.266
susprindum_mar                    0.990      1.010     0.309     3.173

Concordance= 0.606  (se = 0.024 )
Likelihood ratio test= 31.8  on 20 df,   p=0.05
Wald test            = 53.7  on 20 df,   p=6e-05
Score (logrank) test = 29.4  on 20 df,   p=0.08,   Robust = 34  p=0.03

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.131   0.283   0.343   0.426   0.481   2.311 
[1] "Modality: GP intensive ambulatory\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 952, number of events= 952 
   (882 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.14373   1.15457  0.40208   0.23848  0.60
less_90d_tr1.lag               0.04075   1.04160  0.26896   0.18882  0.22
log_dias_treat_imp_sin_na.lag -0.06494   0.93712  0.18076   0.14215 -0.46
comp_bpsc_y3_severe.lag        0.24369   1.27594  0.22375   0.15107  1.61
policonsumo2.lag              -0.08624   0.91737  0.37665   0.22091 -0.39
edad_al_ing_1                  0.09182   1.09616  0.02331   0.02261  4.06
ano_nac_corr                   0.08735   1.09128  0.02300   0.02202  3.97
susinidum_oh                  -0.18020   0.83511  0.18632   0.18875 -0.95
susinidum_coc                 -0.00580   0.99422  0.23382   0.25265 -0.02
susinidum_pbc                  0.09401   1.09857  0.22961   0.22434  0.42
susinidum_mar                 -0.06294   0.93900  0.19177   0.19659 -0.32
psycom_dum_with                0.11019   1.11649  0.07414   0.07566  1.46
psycom_dum_study               0.07103   1.07361  0.10012   0.09529  0.75
freq_cons_dum_5day             0.03120   1.03170  0.06792   0.06685  0.47
cond_oc_dum_2inact             0.08752   1.09146  0.10398   0.10352  0.85
cond_oc_dum_3unemp            -0.00759   0.99244  0.07182   0.07088 -0.11
susprindum_oh                 -0.33860   0.71277  0.30834   0.26303 -1.29
susprindum_coc                -0.49853   0.60742  0.31331   0.26966 -1.85
susprindum_pbc                -0.35718   0.69965  0.30406   0.26011 -1.37
susprindum_mar                -0.37937   0.68429  0.32550   0.29400 -1.29
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.547    
less_90d_tr1.lag                 0.829    
log_dias_treat_imp_sin_na.lag    0.648    
comp_bpsc_y3_severe.lag          0.107    
policonsumo2.lag                 0.696    
edad_al_ing_1                  4.9e-05 ***
ano_nac_corr                   7.3e-05 ***
susinidum_oh                     0.340    
susinidum_coc                    0.982    
susinidum_pbc                    0.675    
susinidum_mar                    0.749    
psycom_dum_with                  0.145    
psycom_dum_study                 0.456    
freq_cons_dum_5day               0.641    
cond_oc_dum_2inact               0.398    
cond_oc_dum_3unemp               0.915    
susprindum_oh                    0.198    
susprindum_coc                   0.064 .  
susprindum_pbc                   0.170    
susprindum_mar                   0.197    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.155      0.866     0.723      1.84
less_90d_tr1.lag                  1.042      0.960     0.719      1.51
log_dias_treat_imp_sin_na.lag     0.937      1.067     0.709      1.24
comp_bpsc_y3_severe.lag           1.276      0.784     0.949      1.72
policonsumo2.lag                  0.917      1.090     0.595      1.41
edad_al_ing_1                     1.096      0.912     1.049      1.15
ano_nac_corr                      1.091      0.916     1.045      1.14
susinidum_oh                      0.835      1.197     0.577      1.21
susinidum_coc                     0.994      1.006     0.606      1.63
susinidum_pbc                     1.099      0.910     0.708      1.71
susinidum_mar                     0.939      1.065     0.639      1.38
psycom_dum_with                   1.116      0.896     0.963      1.29
psycom_dum_study                  1.074      0.931     0.891      1.29
freq_cons_dum_5day                1.032      0.969     0.905      1.18
cond_oc_dum_2inact                1.091      0.916     0.891      1.34
cond_oc_dum_3unemp                0.992      1.008     0.864      1.14
susprindum_oh                     0.713      1.403     0.426      1.19
susprindum_coc                    0.607      1.646     0.358      1.03
susprindum_pbc                    0.700      1.429     0.420      1.16
susprindum_mar                    0.684      1.461     0.385      1.22

Concordance= 0.563  (se = 0.01 )
Likelihood ratio test= 35.3  on 20 df,   p=0.02
Wald test            = 43.2  on 20 df,   p=0.002
Score (logrank) test = 35  on 20 df,   p=0.02,   Robust = 41.4  p=0.003

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.592   0.927   1.061   1.091   1.220   2.472 
[1] "Modality: basic ambulatory\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 975, number of events= 975 
   (912 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.0925    0.9117   0.3173    0.2442 -0.38
less_90d_tr1.lag               0.0706    1.0731   0.2769    0.1839  0.38
log_dias_treat_imp_sin_na.lag  0.0404    1.0412   0.1784    0.1286  0.31
comp_bpsc_y3_severe.lag        0.4059    1.5007   0.2303    0.1791  2.27
policonsumo2.lag               0.1346    1.1441   0.2812    0.2287  0.59
edad_al_ing_1                  0.1269    1.1353   0.0210    0.0197  6.45
ano_nac_corr                   0.1320    1.1412   0.0210    0.0198  6.67
susinidum_oh                  -0.0679    0.9344   0.1746    0.2017 -0.34
susinidum_coc                 -0.3007    0.7403   0.2407    0.2727 -1.10
susinidum_pbc                 -0.1127    0.8935   0.2201    0.2293 -0.49
susinidum_mar                 -0.0690    0.9334   0.1813    0.2049 -0.34
psycom_dum_with               -0.1255    0.8820   0.0738    0.0725 -1.73
psycom_dum_study              -0.0329    0.9677   0.0939    0.0917 -0.36
freq_cons_dum_5day             0.0826    1.0861   0.0754    0.0753  1.10
cond_oc_dum_2inact             0.1227    1.1306   0.1038    0.1018  1.21
cond_oc_dum_3unemp             0.0404    1.0412   0.0784    0.0754  0.54
susprindum_oh                  0.2790    1.3218   0.2321    0.2324  1.20
susprindum_coc                 0.2343    1.2640   0.2361    0.2345  1.00
susprindum_pbc                 0.1675    1.1824   0.2326    0.2319  0.72
susprindum_mar                 0.0313    1.0318   0.2554    0.2589  0.12
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.705    
less_90d_tr1.lag                 0.701    
log_dias_treat_imp_sin_na.lag    0.753    
comp_bpsc_y3_severe.lag          0.023 *  
policonsumo2.lag                 0.556    
edad_al_ing_1                  1.1e-10 ***
ano_nac_corr                   2.5e-11 ***
susinidum_oh                     0.737    
susinidum_coc                    0.270    
susinidum_pbc                    0.623    
susinidum_mar                    0.736    
psycom_dum_with                  0.083 .  
psycom_dum_study                 0.720    
freq_cons_dum_5day               0.273    
cond_oc_dum_2inact               0.228    
cond_oc_dum_3unemp               0.592    
susprindum_oh                    0.230    
susprindum_coc                   0.318    
susprindum_pbc                   0.470    
susprindum_mar                   0.904    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.912      1.097     0.565      1.47
less_90d_tr1.lag                  1.073      0.932     0.748      1.54
log_dias_treat_imp_sin_na.lag     1.041      0.960     0.809      1.34
comp_bpsc_y3_severe.lag           1.501      0.666     1.056      2.13
policonsumo2.lag                  1.144      0.874     0.731      1.79
edad_al_ing_1                     1.135      0.881     1.092      1.18
ano_nac_corr                      1.141      0.876     1.098      1.19
susinidum_oh                      0.934      1.070     0.629      1.39
susinidum_coc                     0.740      1.351     0.434      1.26
susinidum_pbc                     0.893      1.119     0.570      1.40
susinidum_mar                     0.933      1.071     0.625      1.39
psycom_dum_with                   0.882      1.134     0.765      1.02
psycom_dum_study                  0.968      1.033     0.808      1.16
freq_cons_dum_5day                1.086      0.921     0.937      1.26
cond_oc_dum_2inact                1.131      0.884     0.926      1.38
cond_oc_dum_3unemp                1.041      0.960     0.898      1.21
susprindum_oh                     1.322      0.757     0.838      2.08
susprindum_coc                    1.264      0.791     0.798      2.00
susprindum_pbc                    1.182      0.846     0.750      1.86
susprindum_mar                    1.032      0.969     0.621      1.71

Concordance= 0.577  (se = 0.01 )
Likelihood ratio test= 64.2  on 20 df,   p=2e-06
Wald test            = 66.3  on 20 df,   p=7e-07
Score (logrank) test = 63.6  on 20 df,   p=2e-06,   Robust = 69.5  p=2e-07

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.290   0.436   0.539   0.559   0.655   1.455 
[1] "Modality: GP residential\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 392, number of events= 392 
   (361 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se      z
tr_outcome.lag                -0.98955   0.37174  0.45799   0.31909  -3.10
less_90d_tr1.lag               0.83212   2.29819  0.54609   0.48760   1.71
log_dias_treat_imp_sin_na.lag  0.01531   1.01542  0.43790   0.46770   0.03
comp_bpsc_y3_severe.lag       -0.20089   0.81800  0.49058   0.31748  -0.63
policonsumo2.lag               0.18496   1.20317  0.60446   0.43474   0.43
edad_al_ing_1                  0.09172   1.09606  0.03762   0.03716   2.47
ano_nac_corr                   0.10229   1.10770  0.03758   0.03768   2.71
susinidum_oh                   0.29856   1.34792  0.28694   0.25281   1.18
susinidum_coc                  0.23353   1.26305  0.37920   0.32510   0.72
susinidum_pbc                  0.11437   1.12116  0.31636   0.29190   0.39
susinidum_mar                  0.05158   1.05293  0.28712   0.25138   0.21
psycom_dum_with               -0.20375   0.81567  0.12050   0.11684  -1.74
psycom_dum_study              -0.18978   0.82714  0.17528   0.16004  -1.19
freq_cons_dum_5day            -0.10802   0.89761  0.11907   0.12143  -0.89
cond_oc_dum_2inact             0.00394   1.00395  0.20053   0.19286   0.02
cond_oc_dum_3unemp            -0.10783   0.89778  0.15618   0.15639  -0.69
susprindum_oh                 -1.69453   0.18369  0.73308   0.20093  -8.43
susprindum_coc                -2.05429   0.12818  0.74059   0.22332  -9.20
susprindum_pbc                -1.88226   0.15225  0.72721   0.15822 -11.90
susprindum_mar                -1.96932   0.13955  0.80891   0.42217  -4.66
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.0019 ** 
less_90d_tr1.lag                0.0879 .  
log_dias_treat_imp_sin_na.lag   0.9739    
comp_bpsc_y3_severe.lag         0.5269    
policonsumo2.lag                0.6705    
edad_al_ing_1                   0.0136 *  
ano_nac_corr                    0.0066 ** 
susinidum_oh                    0.2376    
susinidum_coc                   0.4725    
susinidum_pbc                   0.6952    
susinidum_mar                   0.8374    
psycom_dum_with                 0.0812 .  
psycom_dum_study                0.2357    
freq_cons_dum_5day              0.3737    
cond_oc_dum_2inact              0.9837    
cond_oc_dum_3unemp              0.4905    
susprindum_oh                  &lt; 2e-16 ***
susprindum_coc                 &lt; 2e-16 ***
susprindum_pbc                 &lt; 2e-16 ***
susprindum_mar                 3.1e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.372      2.690    0.1989     0.695
less_90d_tr1.lag                  2.298      0.435    0.8838     5.976
log_dias_treat_imp_sin_na.lag     1.015      0.985    0.4060     2.540
comp_bpsc_y3_severe.lag           0.818      1.222    0.4391     1.524
policonsumo2.lag                  1.203      0.831    0.5132     2.821
edad_al_ing_1                     1.096      0.912    1.0191     1.179
ano_nac_corr                      1.108      0.903    1.0288     1.193
susinidum_oh                      1.348      0.742    0.8212     2.212
susinidum_coc                     1.263      0.792    0.6679     2.389
susinidum_pbc                     1.121      0.892    0.6327     1.987
susinidum_mar                     1.053      0.950    0.6433     1.723
psycom_dum_with                   0.816      1.226    0.6487     1.026
psycom_dum_study                  0.827      1.209    0.6044     1.132
freq_cons_dum_5day                0.898      1.114    0.7075     1.139
cond_oc_dum_2inact                1.004      0.996    0.6879     1.465
cond_oc_dum_3unemp                0.898      1.114    0.6608     1.220
susprindum_oh                     0.184      5.444    0.1239     0.272
susprindum_coc                    0.128      7.801    0.0827     0.199
susprindum_pbc                    0.152      6.568    0.1117     0.208
susprindum_mar                    0.140      7.166    0.0610     0.319

Concordance= 0.575  (se = 0.017 )
Likelihood ratio test= 32.7  on 20 df,   p=0.04
Wald test            = 228  on 20 df,   p=&lt;2e-16
Score (logrank) test = 34.1  on 20 df,   p=0.03,   Robust = 31  p=0.06

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.64    7.43    8.78    9.27   10.39   28.37 
[1] "Modality: WO intensive ambulatory\nTime interval: (50,70]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 147, number of events= 147 
   (135 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 2.24572   9.44720  0.97612   0.84362  2.66
less_90d_tr1.lag              -1.48459   0.22660  0.79164   0.59000 -2.52
log_dias_treat_imp_sin_na.lag -1.00834   0.36482  0.56973   0.38515 -2.62
comp_bpsc_y3_severe.lag        0.80894   2.24553  0.83762   0.33900  2.39
policonsumo2.lag              -1.70058   0.18258  1.35294   0.91105 -1.87
edad_al_ing_1                  0.12532   1.13351  0.05847   0.05535  2.26
ano_nac_corr                   0.11522   1.12212  0.05606   0.05292  2.18
susinidum_oh                  -0.39560   0.67327  0.67106   0.38664 -1.02
susinidum_coc                  0.06768   1.07002  0.86967   0.72300  0.09
susinidum_pbc                 -0.74257   0.47589  0.71302   0.48039 -1.55
susinidum_mar                 -0.35549   0.70083  0.68367   0.43209 -0.82
psycom_dum_with                0.00121   1.00121  0.22120   0.23127  0.01
psycom_dum_study               0.25008   1.28413  0.31634   0.32202  0.78
freq_cons_dum_5day            -0.07136   0.93113  0.19453   0.18559 -0.38
cond_oc_dum_2inact             0.13726   1.14713  0.24366   0.26884  0.51
cond_oc_dum_3unemp            -0.03216   0.96835  0.25678   0.28903 -0.11
susprindum_oh                 -0.51243   0.59904  0.78028   0.37638 -1.36
susprindum_coc                -0.79785   0.45029  0.81330   0.53602 -1.49
susprindum_pbc                -0.39730   0.67213  0.77006   0.40286 -0.99
susprindum_mar                -1.05249   0.34907  0.81911   0.46387 -2.27
                              Pr(&gt;|z|)   
tr_outcome.lag                  0.0078 **
less_90d_tr1.lag                0.0119 * 
log_dias_treat_imp_sin_na.lag   0.0088 **
comp_bpsc_y3_severe.lag         0.0170 * 
policonsumo2.lag                0.0620 . 
edad_al_ing_1                   0.0236 * 
ano_nac_corr                    0.0295 * 
susinidum_oh                    0.3062   
susinidum_coc                   0.9254   
susinidum_pbc                   0.1222   
susinidum_mar                   0.4107   
psycom_dum_with                 0.9958   
psycom_dum_study                0.4374   
freq_cons_dum_5day              0.7006   
cond_oc_dum_2inact              0.6097   
cond_oc_dum_3unemp              0.9114   
susprindum_oh                   0.1734   
susprindum_coc                  0.1366   
susprindum_pbc                  0.3240   
susprindum_mar                  0.0233 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    9.447      0.106    1.8081    49.362
less_90d_tr1.lag                  0.227      4.413    0.0713     0.720
log_dias_treat_imp_sin_na.lag     0.365      2.741    0.1715     0.776
comp_bpsc_y3_severe.lag           2.246      0.445    1.1555     4.364
policonsumo2.lag                  0.183      5.477    0.0306     1.089
edad_al_ing_1                     1.134      0.882    1.0170     1.263
ano_nac_corr                      1.122      0.891    1.0116     1.245
susinidum_oh                      0.673      1.485    0.3156     1.436
susinidum_coc                     1.070      0.935    0.2594     4.414
susinidum_pbc                     0.476      2.101    0.1856     1.220
susinidum_mar                     0.701      1.427    0.3005     1.635
psycom_dum_with                   1.001      0.999    0.6363     1.575
psycom_dum_study                  1.284      0.779    0.6831     2.414
freq_cons_dum_5day                0.931      1.074    0.6472     1.340
cond_oc_dum_2inact                1.147      0.872    0.6773     1.943
cond_oc_dum_3unemp                0.968      1.033    0.5496     1.706
susprindum_oh                     0.599      1.669    0.2865     1.253
susprindum_coc                    0.450      2.221    0.1575     1.288
susprindum_pbc                    0.672      1.488    0.3052     1.480
susprindum_mar                    0.349      2.865    0.1406     0.866

Concordance= 0.614  (se = 0.025 )
Likelihood ratio test= 29.4  on 20 df,   p=0.08
Wald test            = 77.1  on 20 df,   p=1e-08
Score (logrank) test = 25.8  on 20 df,   p=0.2,   Robust = 28.5  p=0.1

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     2.0     2.6     3.2     3.3    42.1 
[1] "Modality: WO residential\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 140, number of events= 140 
   (114 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.2111    1.2351   0.5133    0.3758  0.56
less_90d_tr1.lag               0.1271    1.1356   0.4777    0.3623  0.35
log_dias_treat_imp_sin_na.lag  0.0950    1.0997   0.2702    0.1604  0.59
comp_bpsc_y3_severe.lag       -0.0265    0.9738   0.5683    0.4003 -0.07
policonsumo2.lag               0.4960    1.6421   0.7126    0.5910  0.84
edad_al_ing_1                  0.7531    2.1235   0.1295    0.1259  5.98
ano_nac_corr                   0.7581    2.1342   0.1267    0.1213  6.25
susinidum_oh                  -0.1409    0.8686   0.7396    0.6574 -0.21
susinidum_coc                  0.2827    1.3267   0.9117    0.8001  0.35
susinidum_pbc                  0.0692    1.0716   0.7778    0.7062  0.10
susinidum_mar                 -0.4544    0.6348   0.7461    0.6705 -0.68
psycom_dum_with                0.2074    1.2304   0.2479    0.2219  0.93
psycom_dum_study               0.3116    1.3656   0.3006    0.2733  1.14
freq_cons_dum_5day            -0.1393    0.8700   0.2268    0.2203 -0.63
cond_oc_dum_2inact             0.3615    1.4355   0.3814    0.2760  1.31
cond_oc_dum_3unemp             0.3359    1.3992   0.3732    0.2670  1.26
susprindum_oh                 -0.8623    0.4222   0.6834    0.5388 -1.60
susprindum_coc                -0.7442    0.4751   0.6847    0.5885 -1.26
susprindum_pbc                -0.8763    0.4163   0.6689    0.5671 -1.55
susprindum_mar                -0.1224    0.8848   0.8132    0.7029 -0.17
                              Pr(&gt;|z|)    
tr_outcome.lag                    0.57    
less_90d_tr1.lag                  0.73    
log_dias_treat_imp_sin_na.lag     0.55    
comp_bpsc_y3_severe.lag           0.95    
policonsumo2.lag                  0.40    
edad_al_ing_1                  2.2e-09 ***
ano_nac_corr                   4.1e-10 ***
susinidum_oh                      0.83    
susinidum_coc                     0.72    
susinidum_pbc                     0.92    
susinidum_mar                     0.50    
psycom_dum_with                   0.35    
psycom_dum_study                  0.25    
freq_cons_dum_5day                0.53    
cond_oc_dum_2inact                0.19    
cond_oc_dum_3unemp                0.21    
susprindum_oh                     0.11    
susprindum_coc                    0.21    
susprindum_pbc                    0.12    
susprindum_mar                    0.86    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.235      0.810     0.591      2.58
less_90d_tr1.lag                  1.136      0.881     0.558      2.31
log_dias_treat_imp_sin_na.lag     1.100      0.909     0.803      1.51
comp_bpsc_y3_severe.lag           0.974      1.027     0.444      2.13
policonsumo2.lag                  1.642      0.609     0.516      5.23
edad_al_ing_1                     2.123      0.471     1.659      2.72
ano_nac_corr                      2.134      0.469     1.683      2.71
susinidum_oh                      0.869      1.151     0.239      3.15
susinidum_coc                     1.327      0.754     0.277      6.37
susinidum_pbc                     1.072      0.933     0.268      4.28
susinidum_mar                     0.635      1.575     0.171      2.36
psycom_dum_with                   1.230      0.813     0.797      1.90
psycom_dum_study                  1.366      0.732     0.799      2.33
freq_cons_dum_5day                0.870      1.149     0.565      1.34
cond_oc_dum_2inact                1.436      0.697     0.836      2.47
cond_oc_dum_3unemp                1.399      0.715     0.829      2.36
susprindum_oh                     0.422      2.368     0.147      1.21
susprindum_coc                    0.475      2.105     0.150      1.51
susprindum_pbc                    0.416      2.402     0.137      1.27
susprindum_mar                    0.885      1.130     0.223      3.51

Concordance= 0.692  (se = 0.021 )
Likelihood ratio test= 60.2  on 20 df,   p=7e-06
Wald test            = 101  on 20 df,   p=8e-13
Score (logrank) test = 66.8  on 20 df,   p=6e-07,   Robust = 63.5  p=2e-06

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.11    0.47    1.03    1.17    1.55    4.14 
[1] "Modality: GP intensive ambulatory\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 747, number of events= 747 
   (659 observations deleted due to missingness)

                                  coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.10065   0.90425  0.27513   0.19992 -0.50
less_90d_tr1.lag               0.22444   1.25162  0.28593   0.20305  1.11
log_dias_treat_imp_sin_na.lag  0.08647   1.09032  0.20200   0.14347  0.60
comp_bpsc_y3_severe.lag        0.08014   1.08344  0.21268   0.15931  0.50
policonsumo2.lag               0.28875   1.33476  0.26990   0.18411  1.57
edad_al_ing_1                  0.53755   1.71182  0.03877   0.03623 14.84
ano_nac_corr                   0.53650   1.71001  0.03879   0.03598 14.91
susinidum_oh                  -0.08569   0.91788  0.23039   0.22759 -0.38
susinidum_coc                  0.01008   1.01013  0.29231   0.28871  0.03
susinidum_pbc                  0.00295   1.00295  0.28632   0.27217  0.01
susinidum_mar                  0.01616   1.01629  0.23648   0.23409  0.07
psycom_dum_with               -0.11452   0.89179  0.08329   0.08055 -1.42
psycom_dum_study              -0.01216   0.98792  0.11479   0.10612 -0.11
freq_cons_dum_5day            -0.01605   0.98408  0.07879   0.07317 -0.22
cond_oc_dum_2inact             0.07352   1.07629  0.12276   0.11230  0.65
cond_oc_dum_3unemp             0.02951   1.02995  0.08323   0.07784  0.38
susprindum_oh                 -0.06372   0.93827  0.33425   0.18919 -0.34
susprindum_coc                -0.06906   0.93327  0.33636   0.19413 -0.36
susprindum_pbc                -0.11980   0.88709  0.32915   0.17929 -0.67
susprindum_mar                -0.04056   0.96025  0.35340   0.22979 -0.18
                              Pr(&gt;|z|)    
tr_outcome.lag                    0.61    
less_90d_tr1.lag                  0.27    
log_dias_treat_imp_sin_na.lag     0.55    
comp_bpsc_y3_severe.lag           0.61    
policonsumo2.lag                  0.12    
edad_al_ing_1                   &lt;2e-16 ***
ano_nac_corr                    &lt;2e-16 ***
susinidum_oh                      0.71    
susinidum_coc                     0.97    
susinidum_pbc                     0.99    
susinidum_mar                     0.94    
psycom_dum_with                   0.16    
psycom_dum_study                  0.91    
freq_cons_dum_5day                0.83    
cond_oc_dum_2inact                0.51    
cond_oc_dum_3unemp                0.70    
susprindum_oh                     0.74    
susprindum_coc                    0.72    
susprindum_pbc                    0.50    
susprindum_mar                    0.86    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.904      1.106     0.611      1.34
less_90d_tr1.lag                  1.252      0.799     0.841      1.86
log_dias_treat_imp_sin_na.lag     1.090      0.917     0.823      1.44
comp_bpsc_y3_severe.lag           1.083      0.923     0.793      1.48
policonsumo2.lag                  1.335      0.749     0.930      1.91
edad_al_ing_1                     1.712      0.584     1.594      1.84
ano_nac_corr                      1.710      0.585     1.594      1.83
susinidum_oh                      0.918      1.089     0.588      1.43
susinidum_coc                     1.010      0.990     0.574      1.78
susinidum_pbc                     1.003      0.997     0.588      1.71
susinidum_mar                     1.016      0.984     0.642      1.61
psycom_dum_with                   0.892      1.121     0.762      1.04
psycom_dum_study                  0.988      1.012     0.802      1.22
freq_cons_dum_5day                0.984      1.016     0.853      1.14
cond_oc_dum_2inact                1.076      0.929     0.864      1.34
cond_oc_dum_3unemp                1.030      0.971     0.884      1.20
susprindum_oh                     0.938      1.066     0.648      1.36
susprindum_coc                    0.933      1.072     0.638      1.37
susprindum_pbc                    0.887      1.127     0.624      1.26
susprindum_mar                    0.960      1.041     0.612      1.51

Concordance= 0.643  (se = 0.011 )
Likelihood ratio test= 214  on 20 df,   p=&lt;2e-16
Wald test            = 271  on 20 df,   p=&lt;2e-16
Score (logrank) test = 217  on 20 df,   p=&lt;2e-16,   Robust = 197  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.12    0.48    0.82    0.93    1.24    3.75 
[1] "Modality: basic ambulatory\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 699, number of events= 699 
   (617 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.1665    0.8466   0.2975    0.2632 -0.63
less_90d_tr1.lag              -0.4788    0.6195   0.2536    0.2275 -2.10
log_dias_treat_imp_sin_na.lag -0.3879    0.6785   0.1119    0.0973 -3.99
comp_bpsc_y3_severe.lag        0.3991    1.4905   0.2041    0.1726  2.31
policonsumo2.lag              -0.0987    0.9060   0.2908    0.2904 -0.34
edad_al_ing_1                  0.5149    1.6735   0.0418    0.0407 12.64
ano_nac_corr                   0.5131    1.6704   0.0414    0.0406 12.65
susinidum_oh                  -0.1703    0.8434   0.2424    0.2253 -0.76
susinidum_coc                 -0.3957    0.6732   0.2808    0.2530 -1.56
susinidum_pbc                 -0.1599    0.8523   0.2782    0.2542 -0.63
susinidum_mar                 -0.1832    0.8326   0.2505    0.2308 -0.79
psycom_dum_with                0.0881    1.0921   0.0869    0.0819  1.08
psycom_dum_study              -0.0535    0.9479   0.1099    0.0978 -0.55
freq_cons_dum_5day            -0.0173    0.9829   0.0880    0.0812 -0.21
cond_oc_dum_2inact             0.1352    1.1448   0.1208    0.1225  1.10
cond_oc_dum_3unemp            -0.1115    0.8945   0.0954    0.0841 -1.32
susprindum_oh                 -0.2414    0.7855   0.3180    0.2378 -1.02
susprindum_coc                -0.1284    0.8795   0.3166    0.2318 -0.55
susprindum_pbc                -0.1876    0.8290   0.3126    0.2252 -0.83
susprindum_mar                -0.0853    0.9183   0.3332    0.2448 -0.35
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.527    
less_90d_tr1.lag                 0.035 *  
log_dias_treat_imp_sin_na.lag  6.7e-05 ***
comp_bpsc_y3_severe.lag          0.021 *  
policonsumo2.lag                 0.734    
edad_al_ing_1                  &lt; 2e-16 ***
ano_nac_corr                   &lt; 2e-16 ***
susinidum_oh                     0.450    
susinidum_coc                    0.118    
susinidum_pbc                    0.529    
susinidum_mar                    0.427    
psycom_dum_with                  0.282    
psycom_dum_study                 0.585    
freq_cons_dum_5day               0.832    
cond_oc_dum_2inact               0.270    
cond_oc_dum_3unemp               0.185    
susprindum_oh                    0.310    
susprindum_coc                   0.580    
susprindum_pbc                   0.405    
susprindum_mar                   0.728    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.847      1.181     0.505     1.418
less_90d_tr1.lag                  0.620      1.614     0.397     0.968
log_dias_treat_imp_sin_na.lag     0.679      1.474     0.561     0.821
comp_bpsc_y3_severe.lag           1.491      0.671     1.063     2.091
policonsumo2.lag                  0.906      1.104     0.513     1.601
edad_al_ing_1                     1.674      0.598     1.545     1.813
ano_nac_corr                      1.670      0.599     1.543     1.809
susinidum_oh                      0.843      1.186     0.542     1.312
susinidum_coc                     0.673      1.485     0.410     1.105
susinidum_pbc                     0.852      1.173     0.518     1.403
susinidum_mar                     0.833      1.201     0.530     1.309
psycom_dum_with                   1.092      0.916     0.930     1.282
psycom_dum_study                  0.948      1.055     0.783     1.148
freq_cons_dum_5day                0.983      1.017     0.838     1.152
cond_oc_dum_2inact                1.145      0.874     0.900     1.455
cond_oc_dum_3unemp                0.895      1.118     0.759     1.055
susprindum_oh                     0.785      1.273     0.493     1.252
susprindum_coc                    0.880      1.137     0.558     1.385
susprindum_pbc                    0.829      1.206     0.533     1.289
susprindum_mar                    0.918      1.089     0.568     1.484

Concordance= 0.628  (se = 0.012 )
Likelihood ratio test= 173  on 20 df,   p=&lt;2e-16
Wald test            = 198  on 20 df,   p=&lt;2e-16
Score (logrank) test = 174  on 20 df,   p=&lt;2e-16,   Robust = 151  p=&lt;2e-16

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.37    1.31    2.03    2.33    3.02   12.32 
[1] "Modality: GP residential\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 325, number of events= 325 
   (273 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                -0.1283    0.8796   0.3809    0.2124 -0.60
less_90d_tr1.lag               0.2810    1.3244   0.3371    0.2433  1.15
log_dias_treat_imp_sin_na.lag -0.0898    0.9141   0.2532    0.1974 -0.45
comp_bpsc_y3_severe.lag        0.3132    1.3678   0.3254    0.1937  1.62
policonsumo2.lag              -0.2731    0.7610   0.3553    0.2857 -0.96
edad_al_ing_1                  0.6022    1.8261   0.0657    0.0567 10.61
ano_nac_corr                   0.6002    1.8225   0.0658    0.0564 10.64
susinidum_oh                  -0.5709    0.5650   0.3978    0.2116 -2.70
susinidum_coc                 -0.4843    0.6162   0.4715    0.2666 -1.82
susinidum_pbc                 -0.6679    0.5128   0.4202    0.2403 -2.78
susinidum_mar                 -0.7051    0.4941   0.4015    0.2205 -3.20
psycom_dum_with                0.0729    1.0756   0.1290    0.1183  0.62
psycom_dum_study               0.1026    1.1081   0.1852    0.1607  0.64
freq_cons_dum_5day            -0.1321    0.8762   0.1262    0.1142 -1.16
cond_oc_dum_2inact            -0.3295    0.7193   0.2323    0.1969 -1.67
cond_oc_dum_3unemp            -0.3918    0.6758   0.1649    0.1471 -2.66
susprindum_oh                  0.1714    1.1869   0.7397    0.3254  0.53
susprindum_coc                 0.1972    1.2179   0.7364    0.3188  0.62
susprindum_pbc                 0.2918    1.3389   0.7228    0.2736  1.07
susprindum_mar                 0.2866    1.3319   0.8015    0.3709  0.77
                              Pr(&gt;|z|)    
tr_outcome.lag                  0.5457    
less_90d_tr1.lag                0.2483    
log_dias_treat_imp_sin_na.lag   0.6492    
comp_bpsc_y3_severe.lag         0.1059    
policonsumo2.lag                0.3391    
edad_al_ing_1                   &lt;2e-16 ***
ano_nac_corr                    &lt;2e-16 ***
susinidum_oh                    0.0070 ** 
susinidum_coc                   0.0693 .  
susinidum_pbc                   0.0054 ** 
susinidum_mar                   0.0014 ** 
psycom_dum_with                 0.5378    
psycom_dum_study                0.5231    
freq_cons_dum_5day              0.2475    
cond_oc_dum_2inact              0.0943 .  
cond_oc_dum_3unemp              0.0077 ** 
susprindum_oh                   0.5985    
susprindum_coc                  0.5363    
susprindum_pbc                  0.2861    
susprindum_mar                  0.4397    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    0.880      1.137     0.580     1.334
less_90d_tr1.lag                  1.324      0.755     0.822     2.134
log_dias_treat_imp_sin_na.lag     0.914      1.094     0.621     1.346
comp_bpsc_y3_severe.lag           1.368      0.731     0.936     1.999
policonsumo2.lag                  0.761      1.314     0.435     1.332
edad_al_ing_1                     1.826      0.548     1.634     2.041
ano_nac_corr                      1.822      0.549     1.632     2.036
susinidum_oh                      0.565      1.770     0.373     0.855
susinidum_coc                     0.616      1.623     0.365     1.039
susinidum_pbc                     0.513      1.950     0.320     0.821
susinidum_mar                     0.494      2.024     0.321     0.761
psycom_dum_with                   1.076      0.930     0.853     1.356
psycom_dum_study                  1.108      0.902     0.809     1.518
freq_cons_dum_5day                0.876      1.141     0.700     1.096
cond_oc_dum_2inact                0.719      1.390     0.489     1.058
cond_oc_dum_3unemp                0.676      1.480     0.507     0.902
susprindum_oh                     1.187      0.843     0.627     2.246
susprindum_coc                    1.218      0.821     0.652     2.275
susprindum_pbc                    1.339      0.747     0.783     2.289
susprindum_mar                    1.332      0.751     0.644     2.755

Concordance= 0.652  (se = 0.015 )
Likelihood ratio test= 96  on 20 df,   p=7e-12
Wald test            = 144  on 20 df,   p=&lt;2e-16
Score (logrank) test = 99.3  on 20 df,   p=2e-12,   Robust = 100  p=1e-12

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.21    1.13    1.84    2.11    2.79    6.63 
[1] "Modality: WO intensive ambulatory\nTime interval: (70,135]"
Call:
coxph(formula = Surv(time.lag, time, event) ~ tr_outcome.lag + 
    less_90d_tr1.lag + log_dias_treat_imp_sin_na.lag + comp_bpsc_y3_severe.lag + 
    policonsumo2.lag + edad_al_ing_1 + ano_nac_corr + susinidum_oh + 
    susinidum_coc + susinidum_pbc + susinidum_mar + psycom_dum_with + 
    psycom_dum_study + freq_cons_dum_5day + cond_oc_dum_2inact + 
    cond_oc_dum_3unemp + susprindum_oh + susprindum_coc + susprindum_pbc + 
    susprindum_mar, data = datacox, cluster = id)

  n= 109, number of events= 109 
   (89 observations deleted due to missingness)

                                 coef exp(coef) se(coef) robust se     z
tr_outcome.lag                 0.6069    1.8347   0.6968    0.5730  1.06
less_90d_tr1.lag               0.9729    2.6457   0.7169    0.4316  2.25
log_dias_treat_imp_sin_na.lag -0.0350    0.9656   0.2175    0.0989 -0.35
comp_bpsc_y3_severe.lag       -0.5660    0.5678   0.6461    0.4651 -1.22
policonsumo2.lag              -1.1665    0.3114   0.7091    0.4960 -2.35
edad_al_ing_1                  0.7256    2.0660   0.1272    0.1194  6.08
ano_nac_corr                   0.7006    2.0149   0.1234    0.1180  5.94
susinidum_oh                   0.1262    1.1345   1.1294    0.4389  0.29
susinidum_coc                 -1.3507    0.2591   1.5526    0.5259 -2.57
susinidum_pbc                  0.6761    1.9662   1.1723    0.5557  1.22
susinidum_mar                  0.0301    1.0305   1.1478    0.5383  0.06
psycom_dum_with               -0.0459    0.9552   0.2525    0.2479 -0.19
psycom_dum_study               0.3213    1.3789   0.3185    0.2964  1.08
freq_cons_dum_5day             0.3997    1.4914   0.2730    0.2428  1.65
cond_oc_dum_2inact             0.3015    1.3519   0.3518    0.3294  0.92
cond_oc_dum_3unemp             0.1458    1.1570   0.3493    0.3020  0.48
susprindum_oh                  0.7995    2.2245   0.8200    0.5875  1.36
susprindum_coc                 0.6280    1.8739   0.8374    0.5909  1.06
susprindum_pbc                 0.7274    2.0697   0.7852    0.5697  1.28
susprindum_mar                 1.1757    3.2405   0.9061    0.6070  1.94
                              Pr(&gt;|z|)    
tr_outcome.lag                   0.289    
less_90d_tr1.lag                 0.024 *  
log_dias_treat_imp_sin_na.lag    0.723    
comp_bpsc_y3_severe.lag          0.224    
policonsumo2.lag                 0.019 *  
edad_al_ing_1                  1.2e-09 ***
ano_nac_corr                   2.9e-09 ***
susinidum_oh                     0.774    
susinidum_coc                    0.010 *  
susinidum_pbc                    0.224    
susinidum_mar                    0.955    
psycom_dum_with                  0.853    
psycom_dum_study                 0.278    
freq_cons_dum_5day               0.100 .  
cond_oc_dum_2inact               0.360    
cond_oc_dum_3unemp               0.629    
susprindum_oh                    0.174    
susprindum_coc                   0.288    
susprindum_pbc                   0.202    
susprindum_mar                   0.053 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                              exp(coef) exp(-coef) lower .95 upper .95
tr_outcome.lag                    1.835      0.545    0.5968     5.640
less_90d_tr1.lag                  2.646      0.378    1.1354     6.165
log_dias_treat_imp_sin_na.lag     0.966      1.036    0.7954     1.172
comp_bpsc_y3_severe.lag           0.568      1.761    0.2282     1.413
policonsumo2.lag                  0.311      3.211    0.1178     0.823
edad_al_ing_1                     2.066      0.484    1.6348     2.611
ano_nac_corr                      2.015      0.496    1.5988     2.539
susinidum_oh                      1.135      0.881    0.4800     2.682
susinidum_coc                     0.259      3.860    0.0924     0.726
susinidum_pbc                     1.966      0.509    0.6616     5.844
susinidum_mar                     1.031      0.970    0.3588     2.960
psycom_dum_with                   0.955      1.047    0.5876     1.553
psycom_dum_study                  1.379      0.725    0.7714     2.465
freq_cons_dum_5day                1.491      0.671    0.9267     2.400
cond_oc_dum_2inact                1.352      0.740    0.7089     2.578
cond_oc_dum_3unemp                1.157      0.864    0.6401     2.091
susprindum_oh                     2.225      0.450    0.7033     7.036
susprindum_coc                    1.874      0.534    0.5886     5.966
susprindum_pbc                    2.070      0.483    0.6777     6.321
susprindum_mar                    3.241      0.309    0.9861    10.649

Concordance= 0.692  (se = 0.025 )
Likelihood ratio test= 50.8  on 20 df,   p=2e-04
Wald test            = 237  on 20 df,   p=&lt;2e-16
Score (logrank) test = 48.5  on 20 df,   p=4e-04,   Robust = 40.6  p=0.004

  (Note: the likelihood ratio and score tests assume independence of
     observations within a cluster, the Wald and robust score tests do not).
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.01    0.19    0.35    0.62    0.65    9.87 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Initialize empty result</span></span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comb_strata)) {</span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(dplyr<span class="sc">::</span><span class="fu">mutate</span>(data_mine_miss_restr_proc2, <span class="at">rn=</span>dplyr<span class="sc">::</span><span class="fu">row_number</span>()), <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span>comb_strata[i,<span class="st">"Var1"</span>] <span class="sc">&amp;</span> time_interval3<span class="sc">==</span> comb_strata[i,<span class="st">"Var2"</span>])</span>
<span id="cb507-5"><a href="#cb507-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb507-6"><a href="#cb507-6" aria-hidden="true" tabindex="-1"></a>    subset_data2<span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(subset_data, <span class="at">iiw_strata=</span> iiws_strat[[i]][[<span class="dv">1</span>]][[<span class="dv">1</span>]])</span>
<span id="cb507-7"><a href="#cb507-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb507-8"><a href="#cb507-8" aria-hidden="true" tabindex="-1"></a>    data_mine_miss_proc2_iiw_strata <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(data_mine_miss_proc2_iiw_strata, subset_data2)</span>
<span id="cb507-9"><a href="#cb507-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb507-10"><a href="#cb507-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-11"><a href="#cb507-11" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-12"><a href="#cb507-12" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-13"><a href="#cb507-13" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-14"><a href="#cb507-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-15"><a href="#cb507-15" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Initialize empty result</span></span>
<span id="cb507-16"><a href="#cb507-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-17"><a href="#cb507-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comb_strata_alt)) {</span>
<span id="cb507-18"><a href="#cb507-18" aria-hidden="true" tabindex="-1"></a>    subset_data_alt <span class="ot">&lt;-</span> <span class="fu">subset</span>(dplyr<span class="sc">::</span><span class="fu">mutate</span>(data_mine_miss_restr_proc2, <span class="at">rn=</span>dplyr<span class="sc">::</span><span class="fu">row_number</span>()), <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span>comb_strata_alt[i,<span class="st">"Var1"</span>] <span class="sc">&amp;</span> time_interval3_alt<span class="sc">==</span> comb_strata_alt[i,<span class="st">"Var2"</span>])</span>
<span id="cb507-19"><a href="#cb507-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb507-20"><a href="#cb507-20" aria-hidden="true" tabindex="-1"></a>    subset_data2_alt<span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(subset_data_alt, <span class="at">iiw_strata=</span> iiws_strat_alt[[i]][[<span class="dv">1</span>]][[<span class="dv">1</span>]])</span>
<span id="cb507-21"><a href="#cb507-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb507-22"><a href="#cb507-22" aria-hidden="true" tabindex="-1"></a>    data_mine_miss_proc2_iiw_strata_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(data_mine_miss_proc2_iiw_strata_alt, subset_data2_alt)</span>
<span id="cb507-23"><a href="#cb507-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb507-24"><a href="#cb507-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-25"><a href="#cb507-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-26"><a href="#cb507-26" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-27"><a href="#cb507-27" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-28"><a href="#cb507-28" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-29"><a href="#cb507-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-30"><a href="#cb507-30" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt_alt <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Initialize empty result</span></span>
<span id="cb507-31"><a href="#cb507-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-32"><a href="#cb507-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(comb_strata_alt_alt)) {</span>
<span id="cb507-33"><a href="#cb507-33" aria-hidden="true" tabindex="-1"></a>    subset_data_alt <span class="ot">&lt;-</span> <span class="fu">subset</span>(dplyr<span class="sc">::</span><span class="fu">mutate</span>(data_mine_miss_restr_proc2, <span class="at">rn=</span>dplyr<span class="sc">::</span><span class="fu">row_number</span>()), <span class="at">subset=</span> tipo_de_plan_2_mod<span class="sc">==</span>comb_strata_alt_alt[i,<span class="st">"Var1"</span>] <span class="sc">&amp;</span> time_interval3_alt<span class="sc">==</span> comb_strata_alt_alt[i,<span class="st">"Var2"</span>])</span>
<span id="cb507-34"><a href="#cb507-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb507-35"><a href="#cb507-35" aria-hidden="true" tabindex="-1"></a>    subset_data2_alt_alt<span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(subset_data_alt, <span class="at">iiw_strata=</span> iiws_strat_alt_alt[[i]][[<span class="dv">1</span>]][[<span class="dv">1</span>]])</span>
<span id="cb507-36"><a href="#cb507-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb507-37"><a href="#cb507-37" aria-hidden="true" tabindex="-1"></a>    data_mine_miss_proc2_iiw_strata_alt_alt <span class="ot">&lt;-</span> <span class="fu">rbind.data.frame</span>(data_mine_miss_proc2_iiw_strata_alt_alt, subset_data2_alt_alt)</span>
<span id="cb507-38"><a href="#cb507-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb507-39"><a href="#cb507-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-40"><a href="#cb507-40" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-41"><a href="#cb507-41" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-42"><a href="#cb507-42" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#</span></span>
<span id="cb507-43"><a href="#cb507-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-44"><a href="#cb507-44" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.00e+00 1.00e+00 1.00e+00 9.60e+64 3.00e+00 2.98e+69 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb509"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.18    0.77    0.91    0.91    1.04   10.94 </span></span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.01    0.60    0.86    1.07    1.18   26.75 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># 0.01    0.61    0.87    1.08    1.20   29.96 </span></span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     0.3     0.4     0.7     0.8    42.1 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb513"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   0.0     0.3     0.4     0.7     0.8    42.1 </span></span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Más confiable el 2do por LEJOS"</span>)</span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb513-7"><a href="#cb513-7" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb513-8"><a href="#cb513-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb513-9"><a href="#cb513-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Stabilize weights"</span>)</span>
<span id="cb513-10"><a href="#cb513-10" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata_st<span class="ot">&lt;-</span>data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata</span>
<span id="cb513-11"><a href="#cb513-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-12"><a href="#cb513-12" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata_st[data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata<span class="sc">&gt;</span><span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata,<span class="fl">0.975</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata,<span class="fl">0.975</span>)</span>
<span id="cb513-13"><a href="#cb513-13" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata_st[data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_after_ph<span class="sc">&lt;</span><span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata,<span class="fl">0.025</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata,<span class="fl">0.025</span>)</span>
<span id="cb513-14"><a href="#cb513-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-15"><a href="#cb513-15" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"stabilize alternative weights"</span>)</span>
<span id="cb513-16"><a href="#cb513-16" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata_st<span class="ot">&lt;-</span>data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata</span>
<span id="cb513-17"><a href="#cb513-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-18"><a href="#cb513-18" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata_st[data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata<span class="sc">&gt;</span><span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.975</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.975</span>)</span>
<span id="cb513-19"><a href="#cb513-19" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata_st[data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata<span class="sc">&lt;</span><span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.025</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.025</span>)</span>
<span id="cb513-20"><a href="#cb513-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-21"><a href="#cb513-21" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata_st<span class="ot">&lt;-</span>data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata</span>
<span id="cb513-22"><a href="#cb513-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-23"><a href="#cb513-23" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata_st[data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata<span class="sc">&gt;</span><span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.975</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.975</span>)</span>
<span id="cb513-24"><a href="#cb513-24" aria-hidden="true" tabindex="-1"></a>data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata_st[data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata<span class="sc">&lt;</span><span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.025</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata,<span class="fl">0.025</span>)</span>
<span id="cb513-25"><a href="#cb513-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-26"><a href="#cb513-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-27"><a href="#cb513-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    0.60    1.32    1.73    2.56    5.45 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb515"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 0.00    0.78    1.37    1.88    2.67    5.68 </span></span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.288   0.599   0.863   0.987   1.184   3.018 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.292   0.614   0.873   1.003   1.196   3.121 </span></span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt_alt<span class="sc">$</span>iiw_strata_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.116   0.116   0.439   0.605   0.761   3.069 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 0.116   0.116   0.439   0.603   0.761   3.118 </span></span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-4"><a href="#cb519-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb519-5"><a href="#cb519-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Primary (strata, lag=0)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata_st)))),</span>
<span id="cb519-6"><a href="#cb519-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Alternative (strata, lag=1)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata_st)))),</span>
<span id="cb519-7"><a href="#cb519-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Alternative (2nd strata intervals, lag=1)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata_alt<span class="sc">$</span>iiw_strata_st)))))<span class="sc">%&gt;%</span> </span>
<span id="cb519-8"><a href="#cb519-8" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb519-9"><a href="#cb519-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/iiw_strat_240503.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb519-10"><a href="#cb519-10" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Weights (stratifying)"</span>, <span class="at">col.names=</span> <span class="fu">c</span>(<span class="st">"Weight"</span>,<span class="fu">attr</span>(<span class="fu">summary</span>(data_mine_miss_proc2_iiw_strata<span class="sc">$</span>iiw_strata_st),<span class="st">"names"</span>)) ) </span>
<span id="cb519-11"><a href="#cb519-11" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Weights (stratifying)</caption>
<colgroup>
<col style="width: 51%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Weight</th>
<th style="text-align: right;">Min.</th>
<th style="text-align: right;">1st Qu.</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">3rd Qu.</th>
<th style="text-align: right;">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Primary (strata, lag=0)</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">1.324</td>
<td style="text-align: right;">1.734</td>
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">5.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alternative (strata, lag=1)</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">0.863</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">3.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alternative (2nd strata intervals, lag=1)</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">0.863</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">3.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="gee-1" class="level5">
<h5 class="anchored" data-anchor-id="gee-1">GEE</h5>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The id= option is where we specify the clusters within which we have repeated observations that may be correlated, and tehe scale.fix=T option is to avoid R's default approach of introducing an overdispersion scale parameter.</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a><span class="co">#However, caution is advised when employing QIC and its use should not be routine, see Wang et al. (2015). growing use of quasi-likelihood-based information criteria for longitudinal data to select a working correlation structure in a generalized estimating equation framework. [https://onlinelibrary.wiley.com/doi/full/10.1002/sta4.95]</span></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-4"><a href="#cb520-4" aria-hidden="true" tabindex="-1"></a><span class="co">#poisson(link = "log"),</span></span>
<span id="cb520-5"><a href="#cb520-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-6"><a href="#cb520-6" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.thelancet.com/cms/10.1016/S2468-2667(22)00042-1/attachment/eb69ffc4-cb6c-4a47-9524-94e1ba9302b2/mmc1.pdf</span></span>
<span id="cb520-7"><a href="#cb520-7" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.thelancet.com/cms/10.1016/S2468-2667(22)00201-8/attachment/05a17ae1-1e31-4ffd-a727-78ec915dc03b/mmc1.pdf</span></span>
<span id="cb520-8"><a href="#cb520-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-9"><a href="#cb520-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb520-10"><a href="#cb520-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb520-11"><a href="#cb520-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-12"><a href="#cb520-12" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Must be independence structure"</span>)</span>
<span id="cb520-13"><a href="#cb520-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-14"><a href="#cb520-14" aria-hidden="true" tabindex="-1"></a>m_strata <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb520-15"><a href="#cb520-15" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb520-16"><a href="#cb520-16" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb520-17"><a href="#cb520-17" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb520-18"><a href="#cb520-18" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb520-19"><a href="#cb520-19" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb520-20"><a href="#cb520-20" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb520-21"><a href="#cb520-21" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb520-22"><a href="#cb520-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb520-23"><a href="#cb520-23" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb520-24"><a href="#cb520-24" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb520-25"><a href="#cb520-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb520-26"><a href="#cb520-26" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb520-27"><a href="#cb520-27" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb520-28"><a href="#cb520-28" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb520-29"><a href="#cb520-29" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata, <span class="at">family=</span>binomial, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb520-30"><a href="#cb520-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = binomial, data = data_mine_miss_restr_proc2_iiw_after_ph, 
    id = id, corstr = "independence")

 Coefficients:
                    Estimate   Std.err   Wald Pr(&gt;|W|)    
(Intercept)        -43.33863  13.16878  10.83  0.00100 ***
policonsumo2         0.05760   0.03597   2.56  0.10927    
edad_al_ing_1       -0.00669   0.00668   1.01  0.31608    
ano_nac_corr         0.02251   0.00654  11.83  0.00058 ***
susinidum_oh        -0.07388   0.09434   0.61  0.43356    
susinidum_coc       -0.01507   0.11807   0.02  0.89845    
susinidum_pbc        0.14542   0.10781   1.82  0.17737    
susinidum_mar        0.04749   0.09658   0.24  0.62290    
psycom_dum_study     0.86346   0.04632 347.54  &lt; 2e-16 ***
psycom_dum_with      0.06046   0.03263   3.43  0.06392 .  
freq_cons_dum_5day  -0.02979   0.03089   0.93  0.33480    
cond_oc_dum_2inact  -0.25843   0.04290  36.29  1.7e-09 ***
cond_oc_dum_3unemp  -0.19282   0.03449  31.25  2.3e-08 ***
susprindum_coc       0.02959   0.04840   0.37  0.54105    
susprindum_pbc       0.23707   0.04089  33.61  6.7e-09 ***
susprindum_mar       0.06276   0.07496   0.70  0.40244    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)        1  0.0162
Number of clusters:   13317  Maximum cluster size: 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a>m_strata_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb522-6"><a href="#cb522-6" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb522-7"><a href="#cb522-7" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb522-8"><a href="#cb522-8" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb522-9"><a href="#cb522-9" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb522-10"><a href="#cb522-10" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb522-11"><a href="#cb522-11" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb522-12"><a href="#cb522-12" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb522-13"><a href="#cb522-13" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb522-14"><a href="#cb522-14" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb522-15"><a href="#cb522-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb522-16"><a href="#cb522-16" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb522-17"><a href="#cb522-17" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb522-18"><a href="#cb522-18" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb522-19"><a href="#cb522-19" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb522-20"><a href="#cb522-20" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb522-21"><a href="#cb522-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb522-22"><a href="#cb522-22" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb522-23"><a href="#cb522-23" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb522-24"><a href="#cb522-24" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb522-25"><a href="#cb522-25" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb522-26"><a href="#cb522-26" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb522-27"><a href="#cb522-27" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb522-28"><a href="#cb522-28" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb522-29"><a href="#cb522-29" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb522-30"><a href="#cb522-30" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb522-31"><a href="#cb522-31" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata, <span class="at">family=</span>binomial, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb522-32"><a href="#cb522-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-33"><a href="#cb522-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-34"><a href="#cb522-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(m_strata, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(m_strata_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb522-35"><a href="#cb522-35" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb522-36"><a href="#cb522-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/gee_strata_240503.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb522-37"><a href="#cb522-37" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models (Stratifying)"</span>) </span>
<span id="cb522-38"><a href="#cb522-38" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models (Stratifying)</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.1095</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0080</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = poisson(link = "log"), 
    data = data_mine_miss_proc2_iiw_strata, weights = iiw_strata_st, 
    id = id, corstr = "independence")

 Coefficients:
                    Estimate   Std.err  Wald Pr(&gt;|W|)    
(Intercept)        -5.66e+00  3.86e+00  2.15  0.14247    
policonsumo2        2.83e-02  1.18e-02  5.74  0.01660 *  
edad_al_ing_1      -5.53e-03  1.96e-03  7.98  0.00473 ** 
ano_nac_corr        2.77e-03  1.92e-03  2.09  0.14849    
susinidum_oh        3.19e-03  3.21e-02  0.01  0.92074    
susinidum_coc       1.84e-02  3.77e-02  0.24  0.62594    
susinidum_pbc       4.83e-02  3.43e-02  1.98  0.15958    
susinidum_mar       2.61e-02  3.22e-02  0.66  0.41722    
psycom_dum_study    9.76e-02  1.09e-02 80.24  &lt; 2e-16 ***
psycom_dum_with    -2.87e-05  1.03e-02  0.00  0.99776    
freq_cons_dum_5day  1.17e-03  9.13e-03  0.02  0.89794    
cond_oc_dum_2inact -5.28e-02  1.32e-02 15.94  6.5e-05 ***
cond_oc_dum_3unemp -3.80e-02  9.94e-03 14.64  0.00013 ***
susprindum_coc      1.99e-02  1.57e-02  1.60  0.20597    
susprindum_pbc      6.08e-02  1.31e-02 21.54  3.5e-06 ***
susprindum_mar      2.28e-02  2.21e-02  1.06  0.30356    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.253 0.00356
Number of clusters:   14073  Maximum cluster size: 8 </code></pre>
</div>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models, weighted (Stratifying)</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0363</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.13</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0067</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0166</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0036</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.06</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can use to fit a weighted GEE</span></span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true" tabindex="-1"></a>mw_alt2 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb524-4"><a href="#cb524-4" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb524-5"><a href="#cb524-5" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb524-6"><a href="#cb524-6" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb524-7"><a href="#cb524-7" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb524-8"><a href="#cb524-8" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb524-9"><a href="#cb524-9" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb524-10"><a href="#cb524-10" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb524-11"><a href="#cb524-11" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb524-12"><a href="#cb524-12" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb524-13"><a href="#cb524-13" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb524-14"><a href="#cb524-14" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb524-15"><a href="#cb524-15" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb524-16"><a href="#cb524-16" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb524-17"><a href="#cb524-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata_alt_alt, <span class="at">family=</span> binomial, <span class="at">weights=</span>iiw_strata_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb525"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mw)</span></span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-4"><a href="#cb525-4" aria-hidden="true" tabindex="-1"></a>mwpois_alt2 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb525-5"><a href="#cb525-5" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb525-6"><a href="#cb525-6" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb525-7"><a href="#cb525-7" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb525-8"><a href="#cb525-8" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb525-9"><a href="#cb525-9" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb525-10"><a href="#cb525-10" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb525-11"><a href="#cb525-11" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb525-12"><a href="#cb525-12" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb525-13"><a href="#cb525-13" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb525-14"><a href="#cb525-14" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb525-15"><a href="#cb525-15" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb525-16"><a href="#cb525-16" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb525-17"><a href="#cb525-17" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb525-18"><a href="#cb525-18" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb525-19"><a href="#cb525-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata_alt_alt, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_strata_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb525-20"><a href="#cb525-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-21"><a href="#cb525-21" aria-hidden="true" tabindex="-1"></a>mwpois_alt2 <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb525-22"><a href="#cb525-22" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb525-23"><a href="#cb525-23" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb525-24"><a href="#cb525-24" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb525-25"><a href="#cb525-25" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb525-26"><a href="#cb525-26" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb525-27"><a href="#cb525-27" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb525-28"><a href="#cb525-28" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb525-29"><a href="#cb525-29" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb525-30"><a href="#cb525-30" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb525-31"><a href="#cb525-31" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb525-32"><a href="#cb525-32" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb525-33"><a href="#cb525-33" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb525-34"><a href="#cb525-34" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb525-35"><a href="#cb525-35" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb525-36"><a href="#cb525-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata_alt_alt, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_strata_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb525-37"><a href="#cb525-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-38"><a href="#cb525-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-39"><a href="#cb525-39" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb525-40"><a href="#cb525-40" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb525-41"><a href="#cb525-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-42"><a href="#cb525-42" aria-hidden="true" tabindex="-1"></a>mw_alt_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb525-43"><a href="#cb525-43" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb525-44"><a href="#cb525-44" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb525-45"><a href="#cb525-45" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb525-46"><a href="#cb525-46" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb525-47"><a href="#cb525-47" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb525-48"><a href="#cb525-48" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb525-49"><a href="#cb525-49" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb525-50"><a href="#cb525-50" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb525-51"><a href="#cb525-51" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb525-52"><a href="#cb525-52" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb525-53"><a href="#cb525-53" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb525-54"><a href="#cb525-54" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb525-55"><a href="#cb525-55" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb525-56"><a href="#cb525-56" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb525-57"><a href="#cb525-57" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb525-58"><a href="#cb525-58" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb525-59"><a href="#cb525-59" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb525-60"><a href="#cb525-60" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb525-61"><a href="#cb525-61" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb525-62"><a href="#cb525-62" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb525-63"><a href="#cb525-63" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb525-64"><a href="#cb525-64" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb525-65"><a href="#cb525-65" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb525-66"><a href="#cb525-66" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb525-67"><a href="#cb525-67" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb525-68"><a href="#cb525-68" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb525-69"><a href="#cb525-69" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb525-70"><a href="#cb525-70" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb525-71"><a href="#cb525-71" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb525-72"><a href="#cb525-72" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata_alt, <span class="at">family=</span>binomial, <span class="at">weights=</span>iiw_strata_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a>mw_alt2_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb526-8"><a href="#cb526-8" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb526-9"><a href="#cb526-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb526-10"><a href="#cb526-10" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb526-11"><a href="#cb526-11" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb526-12"><a href="#cb526-12" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb526-13"><a href="#cb526-13" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb526-14"><a href="#cb526-14" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb526-15"><a href="#cb526-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb526-16"><a href="#cb526-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb526-17"><a href="#cb526-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb526-18"><a href="#cb526-18" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb526-19"><a href="#cb526-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb526-20"><a href="#cb526-20" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb526-21"><a href="#cb526-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb526-22"><a href="#cb526-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb526-23"><a href="#cb526-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb526-24"><a href="#cb526-24" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb526-25"><a href="#cb526-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb526-26"><a href="#cb526-26" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb526-27"><a href="#cb526-27" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb526-28"><a href="#cb526-28" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb526-29"><a href="#cb526-29" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb526-30"><a href="#cb526-30" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb526-31"><a href="#cb526-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb526-32"><a href="#cb526-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb526-33"><a href="#cb526-33" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata_alt_alt, <span class="at">family=</span>binomial, <span class="at">weights=</span>iiw_strata_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb527"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a>mwpois_alt_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb527-4"><a href="#cb527-4" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb527-5"><a href="#cb527-5" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb527-6"><a href="#cb527-6" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb527-7"><a href="#cb527-7" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb527-8"><a href="#cb527-8" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb527-9"><a href="#cb527-9" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb527-10"><a href="#cb527-10" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb527-11"><a href="#cb527-11" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb527-12"><a href="#cb527-12" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb527-13"><a href="#cb527-13" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb527-14"><a href="#cb527-14" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb527-15"><a href="#cb527-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb527-16"><a href="#cb527-16" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb527-17"><a href="#cb527-17" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb527-18"><a href="#cb527-18" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb527-19"><a href="#cb527-19" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb527-20"><a href="#cb527-20" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb527-21"><a href="#cb527-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb527-22"><a href="#cb527-22" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb527-23"><a href="#cb527-23" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb527-24"><a href="#cb527-24" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb527-25"><a href="#cb527-25" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb527-26"><a href="#cb527-26" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb527-27"><a href="#cb527-27" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb527-28"><a href="#cb527-28" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb527-29"><a href="#cb527-29" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb527-30"><a href="#cb527-30" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb527-31"><a href="#cb527-31" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata_alt, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_strata_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb527-32"><a href="#cb527-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-33"><a href="#cb527-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-34"><a href="#cb527-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-35"><a href="#cb527-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-36"><a href="#cb527-36" aria-hidden="true" tabindex="-1"></a>mwpois_alt2_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb527-37"><a href="#cb527-37" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb527-38"><a href="#cb527-38" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb527-39"><a href="#cb527-39" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb527-40"><a href="#cb527-40" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb527-41"><a href="#cb527-41" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb527-42"><a href="#cb527-42" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb527-43"><a href="#cb527-43" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb527-44"><a href="#cb527-44" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb527-45"><a href="#cb527-45" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb527-46"><a href="#cb527-46" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb527-47"><a href="#cb527-47" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb527-48"><a href="#cb527-48" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb527-49"><a href="#cb527-49" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb527-50"><a href="#cb527-50" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb527-51"><a href="#cb527-51" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb527-52"><a href="#cb527-52" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb527-53"><a href="#cb527-53" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb527-54"><a href="#cb527-54" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb527-55"><a href="#cb527-55" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb527-56"><a href="#cb527-56" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb527-57"><a href="#cb527-57" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb527-58"><a href="#cb527-58" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb527-59"><a href="#cb527-59" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb527-60"><a href="#cb527-60" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb527-61"><a href="#cb527-61" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb527-62"><a href="#cb527-62" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb527-63"><a href="#cb527-63" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb527-64"><a href="#cb527-64" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb527-65"><a href="#cb527-65" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb527-66"><a href="#cb527-66" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_proc2_iiw_strata_alt_alt, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_strata_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb527-67"><a href="#cb527-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-68"><a href="#cb527-68" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Model fit"</span>)</span>
<span id="cb527-69"><a href="#cb527-69" aria-hidden="true" tabindex="-1"></a><span class="co">#broom::glance(mwpois_full)</span></span>
<span id="cb527-70"><a href="#cb527-70" aria-hidden="true" tabindex="-1"></a><span class="co">#QIC(mw)</span></span>
<span id="cb527-71"><a href="#cb527-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-72"><a href="#cb527-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-73"><a href="#cb527-73" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb527-74"><a href="#cb527-74" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb527-75"><a href="#cb527-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-76"><a href="#cb527-76" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_alt, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_alt_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois_alt, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois_alt_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),</span>
<span id="cb527-77"><a href="#cb527-77" aria-hidden="true" tabindex="-1"></a>                <span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, binomial (alt)"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_alt2, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, binomial (alt)"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_alt2_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, poisson (alt)"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois_alt2, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, poisson (alt)"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mwpois_alt2_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))</span>
<span id="cb527-78"><a href="#cb527-78" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb527-79"><a href="#cb527-79" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb527-80"><a href="#cb527-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/geew_strata_alt_240503.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb527-81"><a href="#cb527-81" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models, alternative weighting (Stratifying)"</span>) </span>
<span id="cb527-82"><a href="#cb527-82" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models, alternative weighting (Stratifying)</caption>
<colgroup>
<col style="width: 29%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.0457</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.1576</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0184</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.1014</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, binomial (alt)</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.4846</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, binomial (alt)</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.05</td>
<td style="text-align: left;">0.1612</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">1.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, poisson (alt)</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.3140</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, poisson (alt)</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.1078</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.05</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="no-corrections" class="level4">
<h4 class="anchored" data-anchor-id="no-corrections">No corrections</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load("E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/20240503_avance_iiw.RData")</span></span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a>iiw_nocorr<span class="ot">&lt;-</span></span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true" tabindex="-1"></a>            tr_outcome.lag <span class="sc">+</span></span>
<span id="cb528-6"><a href="#cb528-6" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb528-7"><a href="#cb528-7" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1.lag<span class="sc">+</span></span>
<span id="cb528-8"><a href="#cb528-8" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe.lag <span class="sc">+</span> </span>
<span id="cb528-9"><a href="#cb528-9" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb528-10"><a href="#cb528-10" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb528-11"><a href="#cb528-11" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb528-12"><a href="#cb528-12" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb528-13"><a href="#cb528-13" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb528-14"><a href="#cb528-14" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb528-15"><a href="#cb528-15" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb528-16"><a href="#cb528-16" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb528-17"><a href="#cb528-17" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb528-18"><a href="#cb528-18" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb528-19"><a href="#cb528-19" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb528-20"><a href="#cb528-20" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb528-21"><a href="#cb528-21" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb528-22"><a href="#cb528-22" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb528-23"><a href="#cb528-23" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb528-24"><a href="#cb528-24" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb528-25"><a href="#cb528-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb528-26"><a href="#cb528-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb528-27"><a href="#cb528-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb528-28"><a href="#cb528-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb528-29"><a href="#cb528-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> maxfu_restr_df <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb528-30"><a href="#cb528-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb528-31"><a href="#cb528-31" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb528-32"><a href="#cb528-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb528-33"><a href="#cb528-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb528-34"><a href="#cb528-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co">#90/30.5 4.499811 es 90 días</span></span>
<span id="cb528-35"><a href="#cb528-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb528-36"><a href="#cb528-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in Surv(time.lag, time, event): Stop time must be &gt; start time, NA created</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb529"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a>iiw_nocorr_alt<span class="ot">&lt;-</span></span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true" tabindex="-1"></a><span class="fu">iiw.weights</span>(<span class="fu">Surv</span>(time.lag,time,event)<span class="sc">~</span> </span>
<span id="cb529-3"><a href="#cb529-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster</span>(id)<span class="sc">+</span> </span>
<span id="cb529-4"><a href="#cb529-4" aria-hidden="true" tabindex="-1"></a>            tr_outcome.lag <span class="sc">+</span></span>
<span id="cb529-5"><a href="#cb529-5" aria-hidden="true" tabindex="-1"></a>            log_dias_treat_imp_sin_na.lag <span class="sc">+</span></span>
<span id="cb529-6"><a href="#cb529-6" aria-hidden="true" tabindex="-1"></a>            less_90d_tr1.lag<span class="sc">+</span></span>
<span id="cb529-7"><a href="#cb529-7" aria-hidden="true" tabindex="-1"></a>            comp_bpsc_y3_severe.lag <span class="sc">+</span> </span>
<span id="cb529-8"><a href="#cb529-8" aria-hidden="true" tabindex="-1"></a>            policonsumo2.lag <span class="sc">+</span> </span>
<span id="cb529-9"><a href="#cb529-9" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb529-10"><a href="#cb529-10" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb529-11"><a href="#cb529-11" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb529-12"><a href="#cb529-12" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb529-13"><a href="#cb529-13" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb529-14"><a href="#cb529-14" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb529-15"><a href="#cb529-15" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb529-16"><a href="#cb529-16" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span> </span>
<span id="cb529-17"><a href="#cb529-17" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb529-18"><a href="#cb529-18" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb529-19"><a href="#cb529-19" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb529-20"><a href="#cb529-20" aria-hidden="true" tabindex="-1"></a>            susprindum_oh <span class="sc">+</span></span>
<span id="cb529-21"><a href="#cb529-21" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb529-22"><a href="#cb529-22" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb529-23"><a href="#cb529-23" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb529-24"><a href="#cb529-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> data_mine_miss_restr_proc2 <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb529-25"><a href="#cb529-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span> <span class="st">"id"</span>,</span>
<span id="cb529-26"><a href="#cb529-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">time=</span> <span class="st">"time"</span>,</span>
<span id="cb529-27"><a href="#cb529-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">event=</span> <span class="st">"event"</span>, <span class="co">#character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</span></span>
<span id="cb529-28"><a href="#cb529-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">maxfu=</span> maxfu_restr_df <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb529-29"><a href="#cb529-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># formulanull = Surv(time.lag,time,event)~ edad_al_ing_1 + </span></span>
<span id="cb529-30"><a href="#cb529-30" aria-hidden="true" tabindex="-1"></a>            <span class="co">#       ano_nac_corr,</span></span>
<span id="cb529-31"><a href="#cb529-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">invariant=</span> <span class="fu">c</span>(<span class="st">"edad_al_ing_1"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"susinidum_coc"</span>, <span class="st">"susinidum_oh"</span>, <span class="st">"susinidum_pbc"</span>, <span class="st">"susinidum_mar"</span>,  <span class="st">"psycom_dum_with"</span>, <span class="st">"psycom_dum_study"</span>, <span class="st">"freq_cons_dum_5day"</span>, <span class="st">"cond_oc_dum_2inact"</span>, <span class="st">"cond_oc_dum_3unemp"</span>, <span class="st">"susprindum_oh"</span>, <span class="st">"susprindum_coc"</span>, <span class="st">"susprindum_pbc"</span>, <span class="st">"susprindum_mar"</span>),</span>
<span id="cb529-32"><a href="#cb529-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagvars=</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"log_dias_treat_imp_sin_na"</span>,<span class="st">"tr_outcome"</span>, <span class="st">"comp_bpsc_y3_severe"</span>, <span class="st">"less_90d_tr1"</span>, <span class="st">"policonsumo2"</span>),</span>
<span id="cb529-33"><a href="#cb529-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">lagfirst=</span> <span class="fu">c</span>(<span class="fl">2.95082</span>,<span class="fl">4.499811</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),  <span class="co">#90/30.5 2.95082 ; 4.499811 es 90 días</span></span>
<span id="cb529-34"><a href="#cb529-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">first=</span> T</span>
<span id="cb529-35"><a href="#cb529-35" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in Surv(time.lag, time, event): Stop time must be &gt; start time, NA created</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb531"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_nocorr<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.21    1.00    1.62    1.84    2.56    5.99 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb533"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_nocorr_alt<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.1     0.4     0.7     0.8     1.0   102.3 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb535"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr<span class="ot">&lt;-</span>iiw_nocorr<span class="sc">$</span>iiw</span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt<span class="ot">&lt;-</span>iiw_nocorr_alt<span class="sc">$</span>iiw</span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st<span class="ot">&lt;-</span>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr</span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st[data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr<span class="sc">&gt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr,<span class="fl">0.975</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr,<span class="fl">0.975</span>)</span>
<span id="cb535-6"><a href="#cb535-6" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st[data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_nocorr<span class="sc">&lt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr,<span class="fl">0.025</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr,<span class="fl">0.025</span>)</span>
<span id="cb535-7"><a href="#cb535-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-8"><a href="#cb535-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-9"><a href="#cb535-9" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt_st<span class="ot">&lt;-</span>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt</span>
<span id="cb535-10"><a href="#cb535-10" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt_st[data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt<span class="sc">&gt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt,<span class="fl">0.975</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt,<span class="fl">0.975</span>)</span>
<span id="cb535-11"><a href="#cb535-11" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st[data_mine_miss_restr_proc2_iiw_after_ph<span class="sc">$</span>iiw_iiw_nocorr_altnocorr<span class="sc">&lt;</span><span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt,<span class="fl">0.025</span>)] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt,<span class="fl">0.025</span>)</span>
<span id="cb535-12"><a href="#cb535-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-13"><a href="#cb535-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_nocorr<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.21    1.00    1.62    1.84    2.56    5.99 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb537"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 0.53    1.00    1.54    1.87    2.67    6.03 </span></span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iiw_nocorr_alt<span class="sc">$</span>iiw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.1     0.4     0.7     0.8     1.0   102.3 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb539"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a>   <span class="co">#  0.1     0.4     0.7     0.8     1.0   102.3 </span></span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.21    1.00    1.62    1.84    2.56    5.99 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb541"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 0.53    1.00    1.54    1.87    2.67    6.03 </span></span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.21    1.00    1.62    1.83    2.56    3.79 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb543"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># 0.53    1.00    1.54    1.86    2.67    3.89 </span></span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.129   0.418   0.676   0.697   1.000   1.000 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb545"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 0.129   0.418   0.676   0.697   1.000   1.000 </span></span>
<span id="cb545-3"><a href="#cb545-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb545-4"><a href="#cb545-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(</span>
<span id="cb545-5"><a href="#cb545-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Primary (no corrections, lag=0)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st)))),</span>
<span id="cb545-6"><a href="#cb545-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="at">model=</span> <span class="st">"Alternative (no corrections, lag=1)"</span>, <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_alt_st)))))<span class="sc">%&gt;%</span> </span>
<span id="cb545-7"><a href="#cb545-7" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb545-8"><a href="#cb545-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/iiw_nocorr_240503.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb545-9"><a href="#cb545-9" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Weights (No corrections)"</span>, <span class="at">col.names=</span> <span class="fu">c</span>(<span class="st">"Weight"</span>,<span class="fu">attr</span>(<span class="fu">summary</span>(data_mine_miss_restr_proc2<span class="sc">$</span>iiw_nocorr_st),<span class="st">"names"</span>)) ) </span>
<span id="cb545-10"><a href="#cb545-10" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Weights (No corrections)</caption>
<colgroup>
<col style="width: 47%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Weight</th>
<th style="text-align: right;">Min.</th>
<th style="text-align: right;">1st Qu.</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">3rd Qu.</th>
<th style="text-align: right;">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Primary (no corrections, lag=0)</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">1.617</td>
<td style="text-align: right;">1.834</td>
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">3.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alternative (no corrections, lag=1)</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">0.418</td>
<td style="text-align: right;">0.676</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="gee-2" class="level5">
<h5 class="anchored" data-anchor-id="gee-2">GEE</h5>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The id= option is where we specify the clusters within which we have repeated observations that may be correlated, and tehe scale.fix=T option is to avoid R's default approach of introducing an overdispersion scale parameter.</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a><span class="co">#However, caution is advised when employing QIC and its use should not be routine, see Wang et al. (2015). growing use of quasi-likelihood-based information criteria for longitudinal data to select a working correlation structure in a generalized estimating equation framework. [https://onlinelibrary.wiley.com/doi/full/10.1002/sta4.95]</span></span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a><span class="co">#poisson(link = "log"),</span></span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-6"><a href="#cb546-6" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.thelancet.com/cms/10.1016/S2468-2667(22)00042-1/attachment/eb69ffc4-cb6c-4a47-9524-94e1ba9302b2/mmc1.pdf</span></span>
<span id="cb546-7"><a href="#cb546-7" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.thelancet.com/cms/10.1016/S2468-2667(22)00201-8/attachment/05a17ae1-1e31-4ffd-a727-78ec915dc03b/mmc1.pdf</span></span>
<span id="cb546-8"><a href="#cb546-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-9"><a href="#cb546-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb546-10"><a href="#cb546-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb546-11"><a href="#cb546-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-12"><a href="#cb546-12" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Must be independence structure"</span>)</span>
<span id="cb546-13"><a href="#cb546-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-14"><a href="#cb546-14" aria-hidden="true" tabindex="-1"></a>m_nocorr <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb546-15"><a href="#cb546-15" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb546-16"><a href="#cb546-16" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb546-17"><a href="#cb546-17" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb546-18"><a href="#cb546-18" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb546-19"><a href="#cb546-19" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb546-20"><a href="#cb546-20" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb546-21"><a href="#cb546-21" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb546-22"><a href="#cb546-22" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb546-23"><a href="#cb546-23" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb546-24"><a href="#cb546-24" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb546-25"><a href="#cb546-25" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb546-26"><a href="#cb546-26" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb546-27"><a href="#cb546-27" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb546-28"><a href="#cb546-28" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb546-29"><a href="#cb546-29" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span>binomial, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb546-30"><a href="#cb546-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_nocorr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = binomial, data = data_mine_miss_restr_proc2, 
    id = id, corstr = "independence")

 Coefficients:
                    Estimate   Std.err   Wald Pr(&gt;|W|)    
(Intercept)        -43.33863  13.16878  10.83  0.00100 ***
policonsumo2         0.05760   0.03597   2.56  0.10927    
edad_al_ing_1       -0.00669   0.00668   1.01  0.31608    
ano_nac_corr         0.02251   0.00654  11.83  0.00058 ***
susinidum_oh        -0.07388   0.09434   0.61  0.43356    
susinidum_coc       -0.01507   0.11807   0.02  0.89845    
susinidum_pbc        0.14542   0.10781   1.82  0.17737    
susinidum_mar        0.04749   0.09658   0.24  0.62290    
psycom_dum_study     0.86346   0.04632 347.54  &lt; 2e-16 ***
psycom_dum_with      0.06046   0.03263   3.43  0.06392 .  
freq_cons_dum_5day  -0.02979   0.03089   0.93  0.33480    
cond_oc_dum_2inact  -0.25843   0.04290  36.29  1.7e-09 ***
cond_oc_dum_3unemp  -0.19282   0.03449  31.25  2.3e-08 ***
susprindum_coc       0.02959   0.04840   0.37  0.54105    
susprindum_pbc       0.23707   0.04089  33.61  6.7e-09 ***
susprindum_mar       0.06276   0.07496   0.70  0.40244    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)        1  0.0162
Number of clusters:   13317  Maximum cluster size: 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a>m_nocorr_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb548-4"><a href="#cb548-4" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb548-5"><a href="#cb548-5" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb548-6"><a href="#cb548-6" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb548-7"><a href="#cb548-7" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb548-8"><a href="#cb548-8" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb548-9"><a href="#cb548-9" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb548-10"><a href="#cb548-10" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb548-11"><a href="#cb548-11" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb548-12"><a href="#cb548-12" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb548-13"><a href="#cb548-13" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb548-14"><a href="#cb548-14" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb548-15"><a href="#cb548-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb548-16"><a href="#cb548-16" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb548-17"><a href="#cb548-17" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb548-18"><a href="#cb548-18" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb548-19"><a href="#cb548-19" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb548-20"><a href="#cb548-20" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb548-21"><a href="#cb548-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb548-22"><a href="#cb548-22" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb548-23"><a href="#cb548-23" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb548-24"><a href="#cb548-24" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb548-25"><a href="#cb548-25" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb548-26"><a href="#cb548-26" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb548-27"><a href="#cb548-27" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb548-28"><a href="#cb548-28" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb548-29"><a href="#cb548-29" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb548-30"><a href="#cb548-30" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb548-31"><a href="#cb548-31" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span>binomial, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb548-32"><a href="#cb548-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-33"><a href="#cb548-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-34"><a href="#cb548-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(m_nocorr, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(m_nocorr_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb548-35"><a href="#cb548-35" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb548-36"><a href="#cb548-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/gee_nocorr_240503.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb548-37"><a href="#cb548-37" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models (no correction)"</span>) </span>
<span id="cb548-38"><a href="#cb548-38" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models (no correction)</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.06</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.1093</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.10</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0079</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a>data_mine_miss_restr_proc2<span class="sc">$</span>edad_al_ing_1_st <span class="ot">=</span> data_mine_miss_restr_proc2<span class="sc">$</span>edad_al_ing_1 <span class="sc">-</span> <span class="fu">mean</span>(data_mine_miss_restr_proc2<span class="sc">$</span>edad_al_ing_1)</span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a><span class="co"># can use to fit a weighted GEE</span></span>
<span id="cb549-4"><a href="#cb549-4" aria-hidden="true" tabindex="-1"></a>mw_nocorr <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb549-5"><a href="#cb549-5" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb549-6"><a href="#cb549-6" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb549-7"><a href="#cb549-7" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb549-8"><a href="#cb549-8" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb549-9"><a href="#cb549-9" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb549-10"><a href="#cb549-10" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb549-11"><a href="#cb549-11" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb549-12"><a href="#cb549-12" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb549-13"><a href="#cb549-13" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb549-14"><a href="#cb549-14" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb549-15"><a href="#cb549-15" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb549-16"><a href="#cb549-16" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb549-17"><a href="#cb549-17" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb549-18"><a href="#cb549-18" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb549-19"><a href="#cb549-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span> binomial, <span class="at">weights=</span>iiw_nocorr_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb550"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mw)</span></span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true" tabindex="-1"></a>mw_nocorr_pois <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb550-5"><a href="#cb550-5" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb550-6"><a href="#cb550-6" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb550-7"><a href="#cb550-7" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb550-8"><a href="#cb550-8" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb550-9"><a href="#cb550-9" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb550-10"><a href="#cb550-10" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb550-11"><a href="#cb550-11" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb550-12"><a href="#cb550-12" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb550-13"><a href="#cb550-13" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb550-14"><a href="#cb550-14" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb550-15"><a href="#cb550-15" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb550-16"><a href="#cb550-16" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb550-17"><a href="#cb550-17" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb550-18"><a href="#cb550-18" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb550-19"><a href="#cb550-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_nocorr_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb550-20"><a href="#cb550-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mwpois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = poisson(link = "log"), 
    data = data_mine_miss_restr_proc2_iiw_after_ph, weights = iiw_after_ph_st, 
    id = id, corstr = "independence")

 Coefficients:
                   Estimate  Std.err   Wald Pr(&gt;|W|)    
(Intercept)        -6.48845  3.56281   3.32   0.0686 .  
policonsumo2        0.02903  0.01098   6.99   0.0082 ** 
edad_al_ing_1      -0.00520  0.00182   8.13   0.0044 ** 
ano_nac_corr        0.00318  0.00177   3.23   0.0724 .  
susinidum_oh       -0.01208  0.02868   0.18   0.6736    
susinidum_coc       0.00578  0.03446   0.03   0.8668    
susinidum_pbc       0.03984  0.03091   1.66   0.1975    
susinidum_mar       0.01794  0.02878   0.39   0.5331    
psycom_dum_study    0.13012  0.01024 161.40  &lt; 2e-16 ***
psycom_dum_with     0.00609  0.01002   0.37   0.5436    
freq_cons_dum_5day  0.00429  0.00860   0.25   0.6179    
cond_oc_dum_2inact -0.05450  0.01246  19.14  1.2e-05 ***
cond_oc_dum_3unemp -0.03855  0.00943  16.71  4.4e-05 ***
susprindum_coc      0.01730  0.01487   1.35   0.2447    
susprindum_pbc      0.05929  0.01247  22.60  2.0e-06 ***
susprindum_mar      0.01361  0.02142   0.40   0.5252    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.256 0.00339
Number of clusters:   13317  Maximum cluster size: 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb552"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-4"><a href="#cb552-4" aria-hidden="true" tabindex="-1"></a>mw_nocorr_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb552-5"><a href="#cb552-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb552-6"><a href="#cb552-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb552-7"><a href="#cb552-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb552-8"><a href="#cb552-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb552-9"><a href="#cb552-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb552-10"><a href="#cb552-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb552-11"><a href="#cb552-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb552-12"><a href="#cb552-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb552-13"><a href="#cb552-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb552-14"><a href="#cb552-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb552-15"><a href="#cb552-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb552-16"><a href="#cb552-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb552-17"><a href="#cb552-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb552-18"><a href="#cb552-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb552-19"><a href="#cb552-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb552-20"><a href="#cb552-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb552-21"><a href="#cb552-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb552-22"><a href="#cb552-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb552-23"><a href="#cb552-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb552-24"><a href="#cb552-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb552-25"><a href="#cb552-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb552-26"><a href="#cb552-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb552-27"><a href="#cb552-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb552-28"><a href="#cb552-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb552-29"><a href="#cb552-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb552-30"><a href="#cb552-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb552-31"><a href="#cb552-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb552-32"><a href="#cb552-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb552-33"><a href="#cb552-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb552-34"><a href="#cb552-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span>binomial, <span class="at">weights=</span>iiw_nocorr_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb553"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-4"><a href="#cb553-4" aria-hidden="true" tabindex="-1"></a>mw_nocorr_pois_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb553-5"><a href="#cb553-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb553-6"><a href="#cb553-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb553-7"><a href="#cb553-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb553-8"><a href="#cb553-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb553-9"><a href="#cb553-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb553-10"><a href="#cb553-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb553-11"><a href="#cb553-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb553-12"><a href="#cb553-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb553-13"><a href="#cb553-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb553-14"><a href="#cb553-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb553-15"><a href="#cb553-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb553-16"><a href="#cb553-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb553-17"><a href="#cb553-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb553-18"><a href="#cb553-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb553-19"><a href="#cb553-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb553-20"><a href="#cb553-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb553-21"><a href="#cb553-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb553-22"><a href="#cb553-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb553-23"><a href="#cb553-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb553-24"><a href="#cb553-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb553-25"><a href="#cb553-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb553-26"><a href="#cb553-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb553-27"><a href="#cb553-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb553-28"><a href="#cb553-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb553-29"><a href="#cb553-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb553-30"><a href="#cb553-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb553-31"><a href="#cb553-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb553-32"><a href="#cb553-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb553-33"><a href="#cb553-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb553-34"><a href="#cb553-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_nocorr_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb553-35"><a href="#cb553-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-36"><a href="#cb553-36" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Model fit"</span>)</span>
<span id="cb553-37"><a href="#cb553-37" aria-hidden="true" tabindex="-1"></a><span class="co">#broom::glance(mwpois_full)</span></span>
<span id="cb553-38"><a href="#cb553-38" aria-hidden="true" tabindex="-1"></a><span class="co">#QIC(mw)</span></span>
<span id="cb553-39"><a href="#cb553-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-40"><a href="#cb553-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-41"><a href="#cb553-41" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb553-42"><a href="#cb553-42" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb553-43"><a href="#cb553-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-44"><a href="#cb553-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr_pois, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr_pois_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb553-45"><a href="#cb553-45" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb553-46"><a href="#cb553-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/geew_nocorr_240503.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb553-47"><a href="#cb553-47" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models, weighted (no correction)"</span>) </span>
<span id="cb553-48"><a href="#cb553-48" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models, weighted (no correction)</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0548</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.11</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0063</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0215</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0029</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.05</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can use to fit a weighted GEE</span></span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a>mw_nocorr_alt <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb554-4"><a href="#cb554-4" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb554-5"><a href="#cb554-5" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb554-6"><a href="#cb554-6" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb554-7"><a href="#cb554-7" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb554-8"><a href="#cb554-8" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb554-9"><a href="#cb554-9" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb554-10"><a href="#cb554-10" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb554-11"><a href="#cb554-11" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb554-12"><a href="#cb554-12" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb554-13"><a href="#cb554-13" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb554-14"><a href="#cb554-14" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb554-15"><a href="#cb554-15" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb554-16"><a href="#cb554-16" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb554-17"><a href="#cb554-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span> binomial, <span class="at">weights=</span>iiw_nocorr_alt_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb555"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mw)</span></span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-4"><a href="#cb555-4" aria-hidden="true" tabindex="-1"></a>mw_nocorr_pois_alt <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb555-5"><a href="#cb555-5" aria-hidden="true" tabindex="-1"></a>            edad_al_ing_1 <span class="sc">+</span> </span>
<span id="cb555-6"><a href="#cb555-6" aria-hidden="true" tabindex="-1"></a>            ano_nac_corr <span class="sc">+</span> </span>
<span id="cb555-7"><a href="#cb555-7" aria-hidden="true" tabindex="-1"></a>            susinidum_oh <span class="sc">+</span></span>
<span id="cb555-8"><a href="#cb555-8" aria-hidden="true" tabindex="-1"></a>            susinidum_coc <span class="sc">+</span></span>
<span id="cb555-9"><a href="#cb555-9" aria-hidden="true" tabindex="-1"></a>            susinidum_pbc <span class="sc">+</span></span>
<span id="cb555-10"><a href="#cb555-10" aria-hidden="true" tabindex="-1"></a>            susinidum_mar <span class="sc">+</span></span>
<span id="cb555-11"><a href="#cb555-11" aria-hidden="true" tabindex="-1"></a>            psycom_dum_study <span class="sc">+</span></span>
<span id="cb555-12"><a href="#cb555-12" aria-hidden="true" tabindex="-1"></a>            psycom_dum_with <span class="sc">+</span></span>
<span id="cb555-13"><a href="#cb555-13" aria-hidden="true" tabindex="-1"></a>            freq_cons_dum_5day <span class="sc">+</span></span>
<span id="cb555-14"><a href="#cb555-14" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_2inact <span class="sc">+</span></span>
<span id="cb555-15"><a href="#cb555-15" aria-hidden="true" tabindex="-1"></a>            cond_oc_dum_3unemp <span class="sc">+</span></span>
<span id="cb555-16"><a href="#cb555-16" aria-hidden="true" tabindex="-1"></a>            susprindum_coc <span class="sc">+</span></span>
<span id="cb555-17"><a href="#cb555-17" aria-hidden="true" tabindex="-1"></a>            susprindum_pbc <span class="sc">+</span></span>
<span id="cb555-18"><a href="#cb555-18" aria-hidden="true" tabindex="-1"></a>            susprindum_mar, </span>
<span id="cb555-19"><a href="#cb555-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_nocorr_alt_st, <span class="at">corstr=</span><span class="st">"independence"</span>)</span>
<span id="cb555-20"><a href="#cb555-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mwpois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
geeglm(formula = tr_outcome ~ policonsumo2 + edad_al_ing_1 + 
    ano_nac_corr + susinidum_oh + susinidum_coc + susinidum_pbc + 
    susinidum_mar + psycom_dum_study + psycom_dum_with + freq_cons_dum_5day + 
    cond_oc_dum_2inact + cond_oc_dum_3unemp + susprindum_coc + 
    susprindum_pbc + susprindum_mar, family = poisson(link = "log"), 
    data = data_mine_miss_restr_proc2_iiw_after_ph, weights = iiw_after_ph_st, 
    id = id, corstr = "independence")

 Coefficients:
                   Estimate  Std.err   Wald Pr(&gt;|W|)    
(Intercept)        -6.48845  3.56281   3.32   0.0686 .  
policonsumo2        0.02903  0.01098   6.99   0.0082 ** 
edad_al_ing_1      -0.00520  0.00182   8.13   0.0044 ** 
ano_nac_corr        0.00318  0.00177   3.23   0.0724 .  
susinidum_oh       -0.01208  0.02868   0.18   0.6736    
susinidum_coc       0.00578  0.03446   0.03   0.8668    
susinidum_pbc       0.03984  0.03091   1.66   0.1975    
susinidum_mar       0.01794  0.02878   0.39   0.5331    
psycom_dum_study    0.13012  0.01024 161.40  &lt; 2e-16 ***
psycom_dum_with     0.00609  0.01002   0.37   0.5436    
freq_cons_dum_5day  0.00429  0.00860   0.25   0.6179    
cond_oc_dum_2inact -0.05450  0.01246  19.14  1.2e-05 ***
cond_oc_dum_3unemp -0.03855  0.00943  16.71  4.4e-05 ***
susprindum_coc      0.01730  0.01487   1.35   0.2447    
susprindum_pbc      0.05929  0.01247  22.60  2.0e-06 ***
susprindum_mar      0.01361  0.02142   0.40   0.5252    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation structure = independence 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.256 0.00339
Number of clusters:   13317  Maximum cluster size: 10 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb557"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-4"><a href="#cb557-4" aria-hidden="true" tabindex="-1"></a>mw_nocorr_alt_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb557-5"><a href="#cb557-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb557-6"><a href="#cb557-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb557-7"><a href="#cb557-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb557-8"><a href="#cb557-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb557-9"><a href="#cb557-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb557-10"><a href="#cb557-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb557-11"><a href="#cb557-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb557-12"><a href="#cb557-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb557-13"><a href="#cb557-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb557-14"><a href="#cb557-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb557-15"><a href="#cb557-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb557-16"><a href="#cb557-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb557-17"><a href="#cb557-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb557-18"><a href="#cb557-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb557-19"><a href="#cb557-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb557-20"><a href="#cb557-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb557-21"><a href="#cb557-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb557-22"><a href="#cb557-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb557-23"><a href="#cb557-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb557-24"><a href="#cb557-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb557-25"><a href="#cb557-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb557-26"><a href="#cb557-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb557-27"><a href="#cb557-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb557-28"><a href="#cb557-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb557-29"><a href="#cb557-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb557-30"><a href="#cb557-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb557-31"><a href="#cb557-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb557-32"><a href="#cb557-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb557-33"><a href="#cb557-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb557-34"><a href="#cb557-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span>binomial, <span class="at">weights=</span>iiw_nocorr_alt_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb558"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In eval(family$initialize) : non-integer #successes in a binomial glm!</span></span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-4"><a href="#cb558-4" aria-hidden="true" tabindex="-1"></a>mw_nocorr_pois_alt_full <span class="ot">&lt;-</span> <span class="fu">geeglm</span>( tr_outcome  <span class="sc">~</span> policonsumo2 <span class="sc">+</span></span>
<span id="cb558-5"><a href="#cb558-5" aria-hidden="true" tabindex="-1"></a>           comp_bpsc_y2_moderate<span class="sc">+</span> </span>
<span id="cb558-6"><a href="#cb558-6" aria-hidden="true" tabindex="-1"></a>          comp_bpsc_y3_severe<span class="sc">+</span> </span>
<span id="cb558-7"><a href="#cb558-7" aria-hidden="true" tabindex="-1"></a>          edad_al_ing_1<span class="sc">+</span> </span>
<span id="cb558-8"><a href="#cb558-8" aria-hidden="true" tabindex="-1"></a>          ano_nac_corr<span class="sc">+</span> </span>
<span id="cb558-9"><a href="#cb558-9" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_3prim<span class="sc">+</span> </span>
<span id="cb558-10"><a href="#cb558-10" aria-hidden="true" tabindex="-1"></a>          esc_dum_rec_2high <span class="sc">+</span></span>
<span id="cb558-11"><a href="#cb558-11" aria-hidden="true" tabindex="-1"></a>          susprindum_oh <span class="sc">+</span></span>
<span id="cb558-12"><a href="#cb558-12" aria-hidden="true" tabindex="-1"></a>          susprindum_coc <span class="sc">+</span></span>
<span id="cb558-13"><a href="#cb558-13" aria-hidden="true" tabindex="-1"></a>          susprindum_pbc <span class="sc">+</span></span>
<span id="cb558-14"><a href="#cb558-14" aria-hidden="true" tabindex="-1"></a>          susprindum_mar<span class="sc">+</span></span>
<span id="cb558-15"><a href="#cb558-15" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_5day<span class="sc">+</span></span>
<span id="cb558-16"><a href="#cb558-16" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_44to6wk<span class="sc">+</span></span>
<span id="cb558-17"><a href="#cb558-17" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_32to3wk<span class="sc">+</span></span>
<span id="cb558-18"><a href="#cb558-18" aria-hidden="true" tabindex="-1"></a>          freq_cons_dum_21wkmore<span class="sc">+</span></span>
<span id="cb558-19"><a href="#cb558-19" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_3unemp<span class="sc">+</span></span>
<span id="cb558-20"><a href="#cb558-20" aria-hidden="true" tabindex="-1"></a>          cond_oc_dum_2inact<span class="sc">+</span></span>
<span id="cb558-21"><a href="#cb558-21" aria-hidden="true" tabindex="-1"></a>          viv_dum_illegal<span class="sc">+</span></span>
<span id="cb558-22"><a href="#cb558-22" aria-hidden="true" tabindex="-1"></a>          viv_dum_own<span class="sc">+</span></span>
<span id="cb558-23"><a href="#cb558-23" aria-hidden="true" tabindex="-1"></a>          viv_dum_rent<span class="sc">+</span></span>
<span id="cb558-24"><a href="#cb558-24" aria-hidden="true" tabindex="-1"></a>          viv_dum_temp<span class="sc">+</span></span>
<span id="cb558-25"><a href="#cb558-25" aria-hidden="true" tabindex="-1"></a>          psycom_dum_with<span class="sc">+</span></span>
<span id="cb558-26"><a href="#cb558-26" aria-hidden="true" tabindex="-1"></a>          psycom_dum_study<span class="sc">+</span></span>
<span id="cb558-27"><a href="#cb558-27" aria-hidden="true" tabindex="-1"></a>          susinidum_oh <span class="sc">+</span></span>
<span id="cb558-28"><a href="#cb558-28" aria-hidden="true" tabindex="-1"></a>          susinidum_coc <span class="sc">+</span></span>
<span id="cb558-29"><a href="#cb558-29" aria-hidden="true" tabindex="-1"></a>          susinidum_pbc <span class="sc">+</span></span>
<span id="cb558-30"><a href="#cb558-30" aria-hidden="true" tabindex="-1"></a>          susinidum_mar<span class="sc">+</span></span>
<span id="cb558-31"><a href="#cb558-31" aria-hidden="true" tabindex="-1"></a>          cohab_dum_alone<span class="sc">+</span></span>
<span id="cb558-32"><a href="#cb558-32" aria-hidden="true" tabindex="-1"></a>          cohab_dum_fam_or<span class="sc">+</span></span>
<span id="cb558-33"><a href="#cb558-33" aria-hidden="true" tabindex="-1"></a>          cohab_dum_cpl_child, </span>
<span id="cb558-34"><a href="#cb558-34" aria-hidden="true" tabindex="-1"></a><span class="at">id=</span>id, <span class="at">data=</span>data_mine_miss_restr_proc2, <span class="at">family=</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">weights=</span>iiw_nocorr_alt_st, <span class="at">corstr=</span><span class="st">"independence"</span>) </span>
<span id="cb558-35"><a href="#cb558-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-36"><a href="#cb558-36" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Model fit"</span>)</span>
<span id="cb558-37"><a href="#cb558-37" aria-hidden="true" tabindex="-1"></a><span class="co">#broom::glance(mwpois_full)</span></span>
<span id="cb558-38"><a href="#cb558-38" aria-hidden="true" tabindex="-1"></a><span class="co">#QIC(mw)</span></span>
<span id="cb558-39"><a href="#cb558-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-40"><a href="#cb558-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-41"><a href="#cb558-41" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb558-42"><a href="#cb558-42" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb558-43"><a href="#cb558-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb558-44"><a href="#cb558-44" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr_alt, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)), <span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, binomial"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr_alt_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)), <span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"simplest, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr_pois_alt, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T)),<span class="fu">cbind.data.frame</span>(<span class="at">model=</span><span class="st">"full, poisson"</span>, broom<span class="sc">::</span><span class="fu">tidy</span>(mw_nocorr_pois_alt_full, <span class="at">exponentiate =</span> T, <span class="at">conf.int=</span>T))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.2f"</span>,.))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>), <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">"%1.4f"</span>,.)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb558-45"><a href="#cb558-45" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb558-46"><a href="#cb558-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write.table</span>(., <span class="at">file =</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">"/_proposal_grant/2023/geew_nocorr_alt_240503.csv"</span>), <span class="at">dec=</span><span class="st">","</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb558-47"><a href="#cb558-47" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,term<span class="sc">==</span><span class="st">"policonsumo2"</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"GEE Models, alternative weighting (no correction)"</span>) </span>
<span id="cb558-48"><a href="#cb558-48" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>GEE Models, alternative weighting (no correction)</caption>
<colgroup>
<col style="width: 24%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">std.error</th>
<th style="text-align: left;">p.value</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simplest, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.04</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.2923</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">1.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, binomial</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">0.04</td>
<td style="text-align: left;">0.0321</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simplest, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.1631</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: left;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">full, poisson</td>
<td style="text-align: left;">policonsumo2</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.0206</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">1.04</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
</section>
</section>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb559"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"R library: "</span>, <span class="fu">Sys.getenv</span>(<span class="st">"R_LIBS_USER"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>R library: E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/renv/library/R-4.1/x86_64-w64-mingw32</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Date: "</span>,withr<span class="sc">::</span><span class="fu">with_locale</span>(<span class="at">new =</span> <span class="fu">c</span>(<span class="st">'LC_TIME'</span> <span class="ot">=</span> <span class="st">'C'</span>), <span class="at">code =</span><span class="fu">Sys.time</span>())))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Date: 2024-05-17 19:32:37</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb561"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Editor context: "</span>, path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Editor context: C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/env</p>
</div>
</div>
<div class="center-table">
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a>sesion_info <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb562-3"><a href="#cb562-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(sesion_info<span class="sc">$</span>packages),</span>
<span id="cb562-4"><a href="#cb562-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(package, loadedversion, source)</span>
<span id="cb562-5"><a href="#cb562-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb562-6"><a href="#cb562-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"R packages"</span>, <span class="at">format =</span> <span class="st">"markdown"</span>,</span>
<span id="cb562-7"><a href="#cb562-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Row number"</span>, <span class="st">"Package"</span>, <span class="st">"Version"</span>),</span>
<span id="cb562-8"><a href="#cb562-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb562-9"><a href="#cb562-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>R packages</caption>
<thead>
<tr class="header">
<th style="text-align: center;">Row number</th>
<th style="text-align: left;">Package</th>
<th style="text-align: right;">Version</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">abind</td>
<td style="text-align: left;">1.4-5</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">arrow</td>
<td style="text-align: left;">15.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">assertthat</td>
<td style="text-align: left;">0.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">backports</td>
<td style="text-align: left;">1.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">base64enc</td>
<td style="text-align: left;">0.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">BiocManager</td>
<td style="text-align: left;">1.30.18</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">bit</td>
<td style="text-align: left;">4.0.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">bit64</td>
<td style="text-align: left;">4.0.5</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">blob</td>
<td style="text-align: left;">1.2.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">boot</td>
<td style="text-align: left;">1.3-28.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">broom</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cachem</td>
<td style="text-align: left;">1.0.6</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">callr</td>
<td style="text-align: left;">3.7.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">car</td>
<td style="text-align: left;">3.1-0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">carData</td>
<td style="text-align: left;">3.0-5</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cellranger</td>
<td style="text-align: left;">1.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">checkmate</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">chron</td>
<td style="text-align: left;">2.3-58</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">class</td>
<td style="text-align: left;">7.3-20</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cli</td>
<td style="text-align: left;">3.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">clisymbols</td>
<td style="text-align: left;">1.2.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cluster</td>
<td style="text-align: left;">2.1.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">codetools</td>
<td style="text-align: left;">0.2-19</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">colorspace</td>
<td style="text-align: left;">2.0-3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">compareGroups</td>
<td style="text-align: left;">4.5.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">cowplot</td>
<td style="text-align: left;">1.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">crayon</td>
<td style="text-align: left;">1.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">curl</td>
<td style="text-align: left;">4.3.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DALEX</td>
<td style="text-align: left;">2.4.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">data.table</td>
<td style="text-align: left;">1.14.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">data.tree</td>
<td style="text-align: left;">1.0.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">DBI</td>
<td style="text-align: left;">1.1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dbplyr</td>
<td style="text-align: left;">2.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">deldir</td>
<td style="text-align: left;">1.0-6</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">devtools</td>
<td style="text-align: left;">2.4.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">DiagrammeR</td>
<td style="text-align: left;">1.0.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiagrammeRsvg</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">digest</td>
<td style="text-align: left;">0.6.29</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">doRNG</td>
<td style="text-align: left;">1.8.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">dplyr</td>
<td style="text-align: left;">1.0.10</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DT</td>
<td style="text-align: left;">0.26</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">e1071</td>
<td style="text-align: left;">1.7-11</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">easyalluvial</td>
<td style="text-align: left;">0.3.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ellipsis</td>
<td style="text-align: left;">0.3.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">evaluate</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">fansi</td>
<td style="text-align: left;">1.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">farver</td>
<td style="text-align: left;">2.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">fastDummies</td>
<td style="text-align: left;">1.7.3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fastmap</td>
<td style="text-align: left;">1.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">flextable</td>
<td style="text-align: left;">0.8.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">FNN</td>
<td style="text-align: left;">1.1.3.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">forcats</td>
<td style="text-align: left;">0.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">foreach</td>
<td style="text-align: left;">1.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">foreign</td>
<td style="text-align: left;">0.8-83</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Formula</td>
<td style="text-align: left;">1.2-4</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">fs</td>
<td style="text-align: left;">1.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">future</td>
<td style="text-align: left;">1.28.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">future.apply</td>
<td style="text-align: left;">1.9.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gargle</td>
<td style="text-align: left;">1.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">gdtools</td>
<td style="text-align: left;">0.2.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gee</td>
<td style="text-align: left;">4.13-26</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">geepack</td>
<td style="text-align: left;">1.3.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">geesmv</td>
<td style="text-align: left;">1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">generics</td>
<td style="text-align: left;">0.1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ggalluvial</td>
<td style="text-align: left;">0.12.5</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ggplot2</td>
<td style="text-align: left;">3.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ggpubr</td>
<td style="text-align: left;">0.4.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ggridges</td>
<td style="text-align: left;">0.5.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ggsignif</td>
<td style="text-align: left;">0.6.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">globals</td>
<td style="text-align: left;">0.16.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">glue</td>
<td style="text-align: left;">1.6.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">googledrive</td>
<td style="text-align: left;">2.0.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">googlesheets4</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">gower</td>
<td style="text-align: left;">1.0.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gridExtra</td>
<td style="text-align: left;">2.3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">gsubfn</td>
<td style="text-align: left;">0.7</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gtable</td>
<td style="text-align: left;">0.3.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">hardhat</td>
<td style="text-align: left;">1.2.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">HardyWeinberg</td>
<td style="text-align: left;">1.7.5</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">haven</td>
<td style="text-align: left;">2.5.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">highr</td>
<td style="text-align: left;">0.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Hmisc</td>
<td style="text-align: left;">4.7-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">hms</td>
<td style="text-align: left;">1.1.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">htmlTable</td>
<td style="text-align: left;">2.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">htmltools</td>
<td style="text-align: left;">0.5.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">htmlwidgets</td>
<td style="text-align: left;">1.5.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">httpuv</td>
<td style="text-align: left;">1.6.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">httr</td>
<td style="text-align: left;">1.4.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">interp</td>
<td style="text-align: left;">1.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ipred</td>
<td style="text-align: left;">0.9-13</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">IrregLong</td>
<td style="text-align: left;">0.3.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">iterators</td>
<td style="text-align: left;">1.0.14</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">itertools</td>
<td style="text-align: left;">0.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">janitor</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">jpeg</td>
<td style="text-align: left;">0.1-9</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">jsonlite</td>
<td style="text-align: left;">1.8.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">jtools</td>
<td style="text-align: left;">2.2.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">kableExtra</td>
<td style="text-align: left;">1.3.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">km.ci</td>
<td style="text-align: left;">0.5-6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">KMsurv</td>
<td style="text-align: left;">0.1-5</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">knitr</td>
<td style="text-align: left;">1.40</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">labeling</td>
<td style="text-align: left;">0.4.2</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">labelled</td>
<td style="text-align: left;">2.10.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">later</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lattice</td>
<td style="text-align: left;">0.20-45</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">latticeExtra</td>
<td style="text-align: left;">0.6-30</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lava</td>
<td style="text-align: left;">1.6.10</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">lazyeval</td>
<td style="text-align: left;">0.2.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lifecycle</td>
<td style="text-align: left;">1.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">listenv</td>
<td style="text-align: left;">0.8.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lme4</td>
<td style="text-align: left;">1.1-30</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">lubridate</td>
<td style="text-align: left;">1.8.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">magrittr</td>
<td style="text-align: left;">2.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">MASS</td>
<td style="text-align: left;">7.3-58.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Matrix</td>
<td style="text-align: left;">1.5-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">matrixcalc</td>
<td style="text-align: left;">1.0-6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">MatrixModels</td>
<td style="text-align: left;">0.5-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">memoise</td>
<td style="text-align: left;">2.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">MEMSS</td>
<td style="text-align: left;">0.9-3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">mice</td>
<td style="text-align: left;">3.14.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mime</td>
<td style="text-align: left;">0.12</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">miniUI</td>
<td style="text-align: left;">0.1.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">minqa</td>
<td style="text-align: left;">1.2.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">missForest</td>
<td style="text-align: left;">1.5</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">missRanger</td>
<td style="text-align: left;">2.1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">mitools</td>
<td style="text-align: left;">2.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mnormt</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">modelr</td>
<td style="text-align: left;">0.1.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mstate</td>
<td style="text-align: left;">0.3.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">multcomp</td>
<td style="text-align: left;">1.4-20</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">munsell</td>
<td style="text-align: left;">0.5.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">mvtnorm</td>
<td style="text-align: left;">1.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">nlme</td>
<td style="text-align: left;">3.1-159</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">nloptr</td>
<td style="text-align: left;">2.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">nnet</td>
<td style="text-align: left;">7.3-18</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">officer</td>
<td style="text-align: left;">0.4.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">openxlsx</td>
<td style="text-align: left;">4.2.5</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">pacman</td>
<td style="text-align: left;">0.5.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pander</td>
<td style="text-align: left;">0.6.5</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">parallelly</td>
<td style="text-align: left;">1.32.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">parcats</td>
<td style="text-align: left;">0.0.5</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">patchwork</td>
<td style="text-align: left;">1.1.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pillar</td>
<td style="text-align: left;">1.8.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">pkgbuild</td>
<td style="text-align: left;">1.3.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pkgconfig</td>
<td style="text-align: left;">2.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">pkgload</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">plotly</td>
<td style="text-align: left;">4.10.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">plyr</td>
<td style="text-align: left;">1.8.7</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">png</td>
<td style="text-align: left;">0.1-7</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">polspline</td>
<td style="text-align: left;">1.1.20</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">prettyunits</td>
<td style="text-align: left;">1.1.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">processx</td>
<td style="text-align: left;">3.7.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">prodlim</td>
<td style="text-align: left;">2019.11.13</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">profvis</td>
<td style="text-align: left;">0.3.7</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">progressr</td>
<td style="text-align: left;">0.11.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">promises</td>
<td style="text-align: left;">1.2.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">proto</td>
<td style="text-align: left;">1.0.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">proxy</td>
<td style="text-align: left;">0.4-27</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ps</td>
<td style="text-align: left;">1.7.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">psych</td>
<td style="text-align: left;">2.2.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">purrr</td>
<td style="text-align: left;">0.3.5</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">quantreg</td>
<td style="text-align: left;">5.94</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R6</td>
<td style="text-align: left;">2.5.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ragg</td>
<td style="text-align: left;">1.2.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">randomForest</td>
<td style="text-align: left;">4.7-1.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">ranger</td>
<td style="text-align: left;">0.14.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">RColorBrewer</td>
<td style="text-align: left;">1.1-3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Rcpp</td>
<td style="text-align: left;">1.0.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">readr</td>
<td style="text-align: left;">2.1.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">readxl</td>
<td style="text-align: left;">1.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">recipes</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">remotes</td>
<td style="text-align: left;">2.4.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">renv</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">reprex</td>
<td style="text-align: left;">2.0.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">reshape2</td>
<td style="text-align: left;">1.4.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">reticulate</td>
<td style="text-align: left;">1.26</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rio</td>
<td style="text-align: left;">0.5.29</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">rlang</td>
<td style="text-align: left;">1.0.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rmarkdown</td>
<td style="text-align: left;">2.16</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">rms</td>
<td style="text-align: left;">6.3-0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rngtools</td>
<td style="text-align: left;">1.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">rpart</td>
<td style="text-align: left;">4.1.16</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Rsolnp</td>
<td style="text-align: left;">1.16</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">RSQLite</td>
<td style="text-align: left;">2.2.18</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rstatix</td>
<td style="text-align: left;">0.7.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">rstudioapi</td>
<td style="text-align: left;">0.14</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rvest</td>
<td style="text-align: left;">1.0.3</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">sandwich</td>
<td style="text-align: left;">3.0-2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">scales</td>
<td style="text-align: left;">1.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">sessioninfo</td>
<td style="text-align: left;">1.2.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">shiny</td>
<td style="text-align: left;">1.7.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">snakecase</td>
<td style="text-align: left;">0.11.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SparseM</td>
<td style="text-align: left;">1.81</td>
<td style="text-align: right;">CRAN (R 4.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">sqldf</td>
<td style="text-align: left;">0.4-11</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">stringi</td>
<td style="text-align: left;">1.7.6</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">stringr</td>
<td style="text-align: left;">1.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">survex</td>
<td style="text-align: left;">0.2.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">survey</td>
<td style="text-align: left;">4.1-1</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">survival</td>
<td style="text-align: left;">3.4-0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">survminer</td>
<td style="text-align: left;">0.4.9</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">survMisc</td>
<td style="text-align: left;">0.5.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">svglite</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">systemfonts</td>
<td style="text-align: left;">1.0.4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">tableone</td>
<td style="text-align: left;">0.13.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">textshaping</td>
<td style="text-align: left;">0.3.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">TH.data</td>
<td style="text-align: left;">1.1-1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tibble</td>
<td style="text-align: left;">3.1.8</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">tidylog</td>
<td style="text-align: left;">1.0.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tidyr</td>
<td style="text-align: left;">1.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">tidyselect</td>
<td style="text-align: left;">1.2.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tidyverse</td>
<td style="text-align: left;">1.3.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">timeDate</td>
<td style="text-align: left;">4021.106</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">truncnorm</td>
<td style="text-align: left;">1.0-8</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">tzdb</td>
<td style="text-align: left;">0.3.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">urlchecker</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">usethis</td>
<td style="text-align: left;">2.1.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">utf8</td>
<td style="text-align: left;">1.2.2</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">uuid</td>
<td style="text-align: left;">1.1-0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">V8</td>
<td style="text-align: left;">4.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">vctrs</td>
<td style="text-align: left;">0.5.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">viridisLite</td>
<td style="text-align: left;">0.4.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">visNetwork</td>
<td style="text-align: left;">2.1.2</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">webshot</td>
<td style="text-align: left;">0.5.4</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">withr</td>
<td style="text-align: left;">2.5.0</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">writexl</td>
<td style="text-align: left;">1.4.0</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">xfun</td>
<td style="text-align: left;">0.33</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xml2</td>
<td style="text-align: left;">1.3.3</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">xtable</td>
<td style="text-align: left;">1.8-4</td>
<td style="text-align: right;">CRAN (R 4.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">yaml</td>
<td style="text-align: left;">2.3.6</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: center;">zip</td>
<td style="text-align: left;">2.2.1</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">zoo</td>
<td style="text-align: left;">1.8-11</td>
<td style="text-align: right;">CRAN (R 4.1.3)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="center-table">
<div class="cell" data-paged.print="true">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb563"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a>reticulate<span class="sc">::</span><span class="fu">py_list_packages</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Python packages"</span>, <span class="at">format =</span> <span class="st">"markdown"</span>,</span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Package"</span>, <span class="st">"Version"</span>, <span class="st">"Requirement"</span>),</span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Python packages</caption>
<colgroup>
<col style="width: 36%">
<col style="width: 18%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Package</th>
<th style="text-align: left;">Version</th>
<th style="text-align: right;">Requirement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">asttokens</td>
<td style="text-align: left;">2.4.1</td>
<td style="text-align: right;">asttokens==2.4.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">autograd</td>
<td style="text-align: left;">1.6.2</td>
<td style="text-align: right;">autograd==1.6.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">autograd-gamma</td>
<td style="text-align: left;">0.5.0</td>
<td style="text-align: right;">autograd-gamma==0.5.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">certifi</td>
<td style="text-align: left;">2023.11.17</td>
<td style="text-align: right;">certifi==2023.11.17</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cffi</td>
<td style="text-align: left;">1.16.0</td>
<td style="text-align: right;">cffi==1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">charset-normalizer</td>
<td style="text-align: left;">3.3.2</td>
<td style="text-align: right;">charset-normalizer==3.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cloudpickle</td>
<td style="text-align: left;">3.0.0</td>
<td style="text-align: right;">cloudpickle==3.0.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">colorama</td>
<td style="text-align: left;">0.4.6</td>
<td style="text-align: right;">colorama==0.4.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">comm</td>
<td style="text-align: left;">0.2.1</td>
<td style="text-align: right;">comm==0.2.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">contourpy</td>
<td style="text-align: left;">1.2.0</td>
<td style="text-align: right;">contourpy==1.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cycler</td>
<td style="text-align: left;">0.12.1</td>
<td style="text-align: right;">cycler==0.12.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">debugpy</td>
<td style="text-align: left;">1.8.0</td>
<td style="text-align: right;">debugpy==1.8.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">decorator</td>
<td style="text-align: left;">5.1.1</td>
<td style="text-align: right;">decorator==5.1.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">delete-chrome-history-py</td>
<td style="text-align: left;">0.1.8</td>
<td style="text-align: right;">delete-chrome-history-py==0.1.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ecos</td>
<td style="text-align: left;">2.0.13</td>
<td style="text-align: right;">ecos==2.0.13</td>
</tr>
<tr class="even">
<td style="text-align: center;">executing</td>
<td style="text-align: left;">2.0.1</td>
<td style="text-align: right;">executing==2.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ffmpeg</td>
<td style="text-align: left;">1.4</td>
<td style="text-align: right;">ffmpeg==1.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">ffmpeg-python</td>
<td style="text-align: left;">0.2.0</td>
<td style="text-align: right;">ffmpeg-python==0.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">filedir</td>
<td style="text-align: left;">0.0.3</td>
<td style="text-align: right;">filedir==0.0.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">filelock</td>
<td style="text-align: left;">3.13.1</td>
<td style="text-align: right;">filelock==3.13.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fonttools</td>
<td style="text-align: left;">4.47.2</td>
<td style="text-align: right;">fonttools==4.47.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">formulaic</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: right;">formulaic==1.0.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fsspec</td>
<td style="text-align: left;">2023.12.2</td>
<td style="text-align: right;">fsspec==2023.12.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">future</td>
<td style="text-align: left;">0.18.3</td>
<td style="text-align: right;">future==0.18.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">idna</td>
<td style="text-align: left;">3.6</td>
<td style="text-align: right;">idna==3.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">interface-meta</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">interface-meta==1.3.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ipykernel</td>
<td style="text-align: left;">6.29.0</td>
<td style="text-align: right;">ipykernel==6.29.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">ipython</td>
<td style="text-align: left;">8.20.0</td>
<td style="text-align: right;">ipython==8.20.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">jedi</td>
<td style="text-align: left;">0.19.1</td>
<td style="text-align: right;">jedi==0.19.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Jinja2</td>
<td style="text-align: left;">3.1.3</td>
<td style="text-align: right;">Jinja2==3.1.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">joblib</td>
<td style="text-align: left;">1.4.0</td>
<td style="text-align: right;">joblib==1.4.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">jupyter_client</td>
<td style="text-align: left;">8.6.0</td>
<td style="text-align: right;">jupyter_client==8.6.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">jupyter_core</td>
<td style="text-align: left;">5.7.1</td>
<td style="text-align: right;">jupyter_core==5.7.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">kiwisolver</td>
<td style="text-align: left;">1.4.5</td>
<td style="text-align: right;">kiwisolver==1.4.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lifelines</td>
<td style="text-align: left;">0.28.0</td>
<td style="text-align: right;">lifelines==0.28.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">llvmlite</td>
<td style="text-align: left;">0.41.1</td>
<td style="text-align: right;">llvmlite==0.41.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">MarkupSafe</td>
<td style="text-align: left;">2.1.4</td>
<td style="text-align: right;">MarkupSafe==2.1.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">matplotlib</td>
<td style="text-align: left;">3.8.2</td>
<td style="text-align: right;">matplotlib==3.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">matplotlib-inline</td>
<td style="text-align: left;">0.1.6</td>
<td style="text-align: right;">matplotlib-inline==0.1.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">more-itertools</td>
<td style="text-align: left;">10.2.0</td>
<td style="text-align: right;">more-itertools==10.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">mpmath</td>
<td style="text-align: left;">1.3.0</td>
<td style="text-align: right;">mpmath==1.3.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">multipledispatch</td>
<td style="text-align: left;">1.0.0</td>
<td style="text-align: right;">multipledispatch==1.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">natsort</td>
<td style="text-align: left;">8.4.0</td>
<td style="text-align: right;">natsort==8.4.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">nest-asyncio</td>
<td style="text-align: left;">1.5.9</td>
<td style="text-align: right;">nest-asyncio==1.5.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">networkx</td>
<td style="text-align: left;">3.2.1</td>
<td style="text-align: right;">networkx==3.2.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">numba</td>
<td style="text-align: left;">0.58.1</td>
<td style="text-align: right;">numba==0.58.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">numexpr</td>
<td style="text-align: left;">2.10.0</td>
<td style="text-align: right;">numexpr==2.10.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">numpy</td>
<td style="text-align: left;">1.26.3</td>
<td style="text-align: right;">numpy==1.26.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">openai-whisper</td>
<td style="text-align: left;">20231117</td>
<td style="text-align: right;">openai-whisper==20231117</td>
</tr>
<tr class="even">
<td style="text-align: center;">osqp</td>
<td style="text-align: left;">0.6.5</td>
<td style="text-align: right;">osqp==0.6.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">packaging</td>
<td style="text-align: left;">23.2</td>
<td style="text-align: right;">packaging==23.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">pandas</td>
<td style="text-align: left;">2.2.0</td>
<td style="text-align: right;">pandas==2.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pandas-flavor</td>
<td style="text-align: left;">0.6.0</td>
<td style="text-align: right;">pandas-flavor==0.6.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">parso</td>
<td style="text-align: left;">0.8.3</td>
<td style="text-align: right;">parso==0.8.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">patsy</td>
<td style="text-align: left;">0.5.6</td>
<td style="text-align: right;">patsy==0.5.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">pillow</td>
<td style="text-align: left;">10.2.0</td>
<td style="text-align: right;">pillow==10.2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">platformdirs</td>
<td style="text-align: left;">4.1.0</td>
<td style="text-align: right;">platformdirs==4.1.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">prompt-toolkit</td>
<td style="text-align: left;">3.0.43</td>
<td style="text-align: right;">prompt-toolkit==3.0.43</td>
</tr>
<tr class="odd">
<td style="text-align: center;">psutil</td>
<td style="text-align: left;">5.9.8</td>
<td style="text-align: right;">psutil==5.9.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">pure-eval</td>
<td style="text-align: left;">0.2.2</td>
<td style="text-align: right;">pure-eval==0.2.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyarrow</td>
<td style="text-align: left;">15.0.0</td>
<td style="text-align: right;">pyarrow==15.0.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">pycparser</td>
<td style="text-align: left;">2.22</td>
<td style="text-align: right;">pycparser==2.22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pydub</td>
<td style="text-align: left;">0.25.1</td>
<td style="text-align: right;">pydub==0.25.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Pygments</td>
<td style="text-align: left;">2.17.2</td>
<td style="text-align: right;">Pygments==2.17.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyjanitor</td>
<td style="text-align: left;">0.26.0</td>
<td style="text-align: right;">pyjanitor==0.26.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">pyparsing</td>
<td style="text-align: left;">3.1.1</td>
<td style="text-align: right;">pyparsing==3.1.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyreadr</td>
<td style="text-align: left;">0.5.0</td>
<td style="text-align: right;">pyreadr==0.5.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">python-dateutil</td>
<td style="text-align: left;">2.8.2</td>
<td style="text-align: right;">python-dateutil==2.8.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pytz</td>
<td style="text-align: left;">2023.3.post1</td>
<td style="text-align: right;">pytz==2023.3.post1</td>
</tr>
<tr class="even">
<td style="text-align: center;">pywin32</td>
<td style="text-align: left;">306</td>
<td style="text-align: right;">pywin32==306</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pyzmq</td>
<td style="text-align: left;">25.1.2</td>
<td style="text-align: right;">pyzmq==25.1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">qdldl</td>
<td style="text-align: left;">0.1.7.post1</td>
<td style="text-align: right;">qdldl==0.1.7.post1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">regex</td>
<td style="text-align: left;">2023.12.25</td>
<td style="text-align: right;">regex==2023.12.25</td>
</tr>
<tr class="even">
<td style="text-align: center;">requests</td>
<td style="text-align: left;">2.31.0</td>
<td style="text-align: right;">requests==2.31.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">rpy2</td>
<td style="text-align: left;">3.5.16</td>
<td style="text-align: right;">rpy2==3.5.16</td>
</tr>
<tr class="even">
<td style="text-align: center;">scikit-learn</td>
<td style="text-align: left;">1.3.2</td>
<td style="text-align: right;">scikit-learn==1.3.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">scikit-survival</td>
<td style="text-align: left;">0.22.2</td>
<td style="text-align: right;">scikit-survival==0.22.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">scipy</td>
<td style="text-align: left;">1.11.4</td>
<td style="text-align: right;">scipy==1.11.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">semantic-version</td>
<td style="text-align: left;">2.10.0</td>
<td style="text-align: right;">semantic-version==2.10.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">setuptools-rust</td>
<td style="text-align: left;">1.8.1</td>
<td style="text-align: right;">setuptools-rust==1.8.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">six</td>
<td style="text-align: left;">1.16.0</td>
<td style="text-align: right;">six==1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">SpeechRecognition</td>
<td style="text-align: left;">3.10.1</td>
<td style="text-align: right;">SpeechRecognition==3.10.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">spyder-kernels</td>
<td style="text-align: left;">2.5.0</td>
<td style="text-align: right;">spyder-kernels==2.5.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">stack-data</td>
<td style="text-align: left;">0.6.3</td>
<td style="text-align: right;">stack-data==0.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">statsmodels</td>
<td style="text-align: left;">0.14.1</td>
<td style="text-align: right;">statsmodels==0.14.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">sympy</td>
<td style="text-align: left;">1.12</td>
<td style="text-align: right;">sympy==1.12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">target</td>
<td style="text-align: left;">0.0.11</td>
<td style="text-align: right;">target==0.0.11</td>
</tr>
<tr class="even">
<td style="text-align: center;">threadpoolctl</td>
<td style="text-align: left;">3.4.0</td>
<td style="text-align: right;">threadpoolctl==3.4.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tiktoken</td>
<td style="text-align: left;">0.5.2</td>
<td style="text-align: right;">tiktoken==0.5.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">torch</td>
<td style="text-align: left;">2.1.2</td>
<td style="text-align: right;">torch==2.1.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tornado</td>
<td style="text-align: left;">6.4</td>
<td style="text-align: right;">tornado==6.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">tqdm</td>
<td style="text-align: left;">4.66.1</td>
<td style="text-align: right;">tqdm==4.66.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">traitlets</td>
<td style="text-align: left;">5.14.1</td>
<td style="text-align: right;">traitlets==5.14.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">typing_extensions</td>
<td style="text-align: left;">4.9.0</td>
<td style="text-align: right;">typing_extensions==4.9.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">tzdata</td>
<td style="text-align: left;">2023.4</td>
<td style="text-align: right;">tzdata==2023.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">tzlocal</td>
<td style="text-align: left;">5.2</td>
<td style="text-align: right;">tzlocal==5.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">urllib3</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: right;">urllib3==2.1.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">watchdog</td>
<td style="text-align: left;">3.0.0</td>
<td style="text-align: right;">watchdog==3.0.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">wcwidth</td>
<td style="text-align: left;">0.2.13</td>
<td style="text-align: right;">wcwidth==0.2.13</td>
</tr>
<tr class="even">
<td style="text-align: center;">whisper</td>
<td style="text-align: left;">1.1.10</td>
<td style="text-align: right;">whisper==1.1.10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">wrapt</td>
<td style="text-align: left;">1.16.0</td>
<td style="text-align: right;">wrapt==1.16.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">xarray</td>
<td style="text-align: left;">2024.1.1</td>
<td style="text-align: right;">xarray==2024.1.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Save</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">dir.exists</span>(<span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>),</span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"E:/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>,</span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/_proposal_grant/2023/"</span>)</span>
<span id="cb564-4"><a href="#cb564-4" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="fu">paste0</span>(folder_path,<span class="st">"an_grant_23_24_3.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!--
#https://quarto.org/docs/get-started/
#https://stackoverflow.com/questions/76542517/r-studio-quarto-markdown-error-os-error-2-the-system-cannot-find-the-file-s
-->
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>