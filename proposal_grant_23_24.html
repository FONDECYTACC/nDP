<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés González Santa Cruz">
<meta name="description" content="Explore and construct data, descriptives, several tests of patterns of polysubstance use, and imputation of missing variables">

<title>Data explore &amp; construction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="proposal_grant_23_24_files/libs/clipboard/clipboard.min.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/quarto.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/popper.min.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/anchor.min.js"></script>
<link href="proposal_grant_23_24_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="proposal_grant_23_24_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="proposal_grant_23_24_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="proposal_grant_23_24_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="proposal_grant_23_24_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="proposal_grant_23_24_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="proposal_grant_23_24_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="proposal_grant_23_24_files/libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="proposal_grant_23_24_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="proposal_grant_23_24_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="proposal_grant_23_24_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="proposal_grant_23_24_files/libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="proposal_grant_23_24_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/datatables-binding-0.26/datatables.js"></script>
<link href="proposal_grant_23_24_files/libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="proposal_grant_23_24_files/libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="proposal_grant_23_24_files/libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="proposal_grant_23_24_files/libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/selectize-0.12.0/selectize.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data explore &amp; construction</h1>
</div>

<div>
  <div class="description">
    <p>Explore and construct data, descriptives, several tests of patterns of polysubstance use, and imputation of missing variables</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés González Santa Cruz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"

</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

$('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');

// onClick function for all plots (img's)

$('img:not(.zoomImg)').click(function() {
$('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
$('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
});

// onClick function for zoomImg

$('img.zoomImg').click(function() {
$('.zoomDiv').css({opacity: '0', width: '0%'});
});
});
</script>
</div>
<div class="cell">
<style type="text/css">
<script src="https://github.com/AGSCL/gine_brechas_pandemia/blob/main/hideOutput.js"></script>
</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

\$chunks = \$('.fold');

\$chunks.each(function () { // add button to source code chunks
if ( \$(this).hasClass('s') ) {
    \$('pre.r', this).prepend("\<div class=\\"showopt\\"\>Show Source\</div\>\<br style=\\"line-height:22px;\\"/\>");
    \$('pre.r', this).children('code').attr('class', 'folded');
    } // add button to output chunks

    if ( \$(this).hasClass('o') ) {
        \$('pre:not(.r)', this).has('code').prepend("\<div class=\\"showopt\\"\>Show Output\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre:not(.r)', this).children('code:not(r)').addClass('folded'); // add button to plots
        \$(this).find('img').wrap('\<pre class=\\"plot\\"\>\</pre\>');
        \$('pre.plot', this).prepend("\<div class=\\"showopt\\"\>Show Plot\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre.plot', this).children('img').addClass('folded');
        }
}); // hide all chunks when document is loaded

\$('.folded').css('display', 'none') // function to toggle the visibility
\$('.showopt').click(function() {
        var label = \$(this).html();
        if (label.indexOf("Show") \>= 0) {
            \$(this).html(label.replace("Show", "Hide"));
        } else {
        \$(this).html(label.replace("Hide", "Show"));
        }

\$(this).siblings('code, img').slideToggle('fast', 'swing');
});
});
</script>
</div>

<style type="text/css">

.showopt {

background-color: #004c93; color: #FFFFFF; width: 100px; height: 20px; text-align: center; vertical-align: middle !important; float: right; font-family: sans-serif; border-radius: 8px;

}

.showopt:hover {
background-color: #dfe4f2;
color: #004c93;

}

pre.plot {
background-color: white !important;
}

.tablelines table, .tablelines td, .tablelines th {
border: 1px solid black;
}

.centrado {
text-align: center;
}

.table.center {
margin-left:auto;
margin-right:auto;
}

/* https://vivekjaiskumar.medium.com/css-is-and-not-selector-17c942ec83f :is()*/

/* Applies to outputs that are not code other than R*/

pre {
overflow-x: auto !important;
}

pre code {
word-wrap: normal !important;
white-space: pre !important;
}

/*
pre:not(.sourceCode) {
white-space: nowrap !important;
}
*/
.sourceCode { /* Important gives precedence */
font-size: 10px !important;
line-height: 50% !important;
}
body{ /* Normal */
text-align: justify;
}
.superbigimage{
overflow-y:scroll;
height:350px;
white-space: nowrap;
overflow-x: auto;
width:100%;
}
.superbigimage img{
overflow-y: scroll;
overflow-x: hidden;
}
.message { color:#446C6E; font-family: monospace;font-size: 10px; line-height: 110%; font-weight: bold;}
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 5px; text-align: justify;}
div.red { background-color:#e6bab1; border-radius: 5px; padding: 5px; text-align: justify;}
.pandoc-table { /* Should add !important; but it seems no necessary */
margin-left:auto; /* To center */
margin-right:auto;
border-collapse: collapse;
table-layout: auto;
font-size: 11px;
overflow-y: auto;
max-height:450px !important;
white-space: nowrap;
overflow-x: auto;
width:450px;
}
.pandoc-table th {/* header */
text-align: center !important;
font-size: 10px;
padding: 0px;
}
.pandoc-table td {
text-align: left !important;
font-size: 9px;
padding: 0px;
}
.pandoc-table caption {
text-align: left !important;
font-size: 11px !important;
}

.center-table {
text-align: left !important;
font-size: 9px;
padding: 0px;
overflow-y:scroll;
height:400px;
overflow-x: scroll;
}

.controlly{
overflow-y:scroll;
height:350px;
overflow-x: scroll;

}
</style>
<!-- We gotta do each function to hide code and outputs per section, by every ID, we gotta create a different function -->

<script>
function myFunction1() {
var x = document.getElementById("myDIV");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>

<script>
function myFunction2() {
var x = document.getElementById("myDIV2");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"proposal_grant_23_24_files"</span>, <span class="at">recursive=</span>T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fuentes: </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rpubs.com/georgy_makarov/897844</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>path<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">'/env'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  "")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  Sys.which("python"))</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#reticulate::py_config()</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#use_python(paste0(path,"/Scripts/python.exe"))</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH =  paste0(path,"/Lib"))</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH_64 =  paste0(path,"/Lib"))</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#instalar paquetes de funcionalidades básicas para tener ubicaciones relativas y acceso a python (reticulate)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(reticulate)){<span class="fu">install.packages</span>(<span class="st">"reticulate"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: reticulate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'reticulate' was built under R version 4.1.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(rstudioapi)){<span class="fu">install.packages</span>(<span class="st">"rstudioapi"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rstudioapi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rstudioapi' was built under R version 4.1.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Create env"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/54043607/how-to-set-pyenv-python-for-reticulate</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Directory H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env is not a Python virtualenv</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#virtualenv_create(envname  = path, packages = c("pip", "statsmodels", "matplotlib", "numpy", "pandas", "scipy"))</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># "C:/Users/andre/anaconda3/python.exe" -m venv "H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/9_Computacion_Estadistica/env"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#FUENTES:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/articles/versions.html</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Virtual environment functions are not supported on Windows (the use of conda environments is recommended on Windows).</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Use environment"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#https://ugoproto.github.io/ugo_r_doc/pdf/reticulate.pdf</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># tx  &lt;- readLines(paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[1]] &lt;- paste0("home = ",gsub('/', '\\', paste0(path,"/Scripts/python.exe"), fixed=T))</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[3]] &lt;- "version = 3.8.0"</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#writeLines(tx, con=paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env/Scripts/python.exe"</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#use_virtualenv(path)</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#usar entorno virtual ya creado</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#información sobre entorno virtual</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#py_discover_config()</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#conda_python(envname =  "r-scrublet")</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># FUENTES</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#https://akrabat.com/creating-virtual-environments-with-pyenv/</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/reference/install_python.html</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/wiki#suggested-build-environment</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/56755156/reticulate-not-setting-python-path</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/rstudio/reticulate/issues/291#issuecomment-437143751</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv-win/pyenv-win#installation</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/52060867/how-to-use-pip-for-pyenv</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/issues/2417</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv install <span class="op">-</span>l <span class="op">|</span> findstr <span class="fl">3.8</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>upgrade pyenv<span class="op">-</span>win</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install <span class="fl">3.7.5</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv build</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># `r format(Sys.time(),'%B %d, %Y')`</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data import</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the data from Mariel Fiscalia Merge 4, created on 2023-05-26</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#load("14.Rdata", data_mariel_fisc_merge4 &lt;- new.env() )</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data_acc_ser_23.RData"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># List all of the objects names in RData:</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(.GlobalEnv)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(new_environment)</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(new_environment)</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p><br></p>
</section>
<section id="explore-and-construct-database" class="level1">
<h1>Explore and construct database</h1>
<p>We checked and resolved the inconsistencies in male users receiving women-only treatments after imputation. We selected the variables of interest, compared the date births and ages at several events and corrected these values.</p>
<p><br></p>
<p>Once the standardization and correction of values and labels was complete, we <strong>joined</strong> the databases <code>CONS_C1_df_dup_SEP_2020_22_d</code> and <code>Base_fiscalia_v9</code> into a single one. The master database was SENDAs treatments, and we only used records of POs database which had an age of offending equal or posterior to the age of admission to treatment. If there were no records of PO, the age of offense were replaced with the age at censorship (2019-11-13). However, we excluded Referrals, Deaths and Censored cases because of missing data.</p>
<p><br></p>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># invisible("La edad está bien definida en términos relativos (entre ingresos), pero no absolutos (manualmente no llego a la misma edad calculando manualmente ), tiene una diferencia de 0,5 años")</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Age at admission for each treatment: if the date of birth (PO) is not empty and the date of birth of senda is different of date of birth, for each age at admission (for different admissions), we compute the difference of the date of admission (at each admission) with the date of birth (PO) and divided by years; if the date of birth (PO) is not empty but SENDA is empty, we compute the difference of the date of admission (at each admission) with the date of birth (PO) and divided by years; else will be taken from the date at admission from the date of birth of SENDA.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#The same for age at discharge</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#WHERE rn_id = 1</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"This chunk is modified from Fiscalia_merge4"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#joined with edad_al_ing instead of edad_al_egres</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v10_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM CONS_C1_df_dup_SEP_2020_22_d AS x  </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM Base_fiscalia_v9</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.id AND </span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_ing_1 &lt;= y.age_offending_imp AND x.dup = 1"</span>) <span class="co">#2022-11-25  added dup</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#183307</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Observations of SENDA database: "</span>,<span class="fu">nrow</span>(CONS_C1_df_dup_SEP_2020_22_d))<span class="co">#109756)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Observations of SENDA database: 85048"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Observations of PO database: "</span>, <span class="fu">nrow</span>(Base_fiscalia_v10_grant_23_24))<span class="co">#204,115 nrow</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Observations of PO database: 138349"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#clean names, select the first event (whatever the crime comitted, we selected the first)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v10_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#discrepancies in names of variables</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span>   <span class="co">#janitor::tabyl(!is.na(dob_imp_num))</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#previously recoded, </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>sex_2, <span class="sc">-</span>dateofbirth_imp, <span class="sc">-</span>country, <span class="sc">-</span>victim, <span class="sc">-</span>id_victim, <span class="sc">-</span>crime_code_c , <span class="sc">-</span>reg_c, <span class="sc">-</span>end_type_2c, <span class="sc">-</span>cod_comunadelito, <span class="sc">-</span>cod_lugarocurrencia, <span class="sc">-</span>sex_imp, <span class="sc">-</span>region_delito, <span class="sc">-</span>filter, <span class="sc">-</span>id)<span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  plyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"dateofbirth_imp_2"</span><span class="ot">=</span><span class="st">"dateofbirth_imp"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#generates errors with survival setting</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#make censorship date of age of comission</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">when</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(., <span class="fu">is.na</span>(fech_nac_rec)) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">7</span> <span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"Missing values in the age"</span>), <span class="sc">~</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_offending_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">is.na</span>(age_offending_imp)<span class="sc">~</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_offending_imp)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#KEY STEP: select the first and with ties (more than  one) --&gt; 2023-04-14, was discussed, but did not had consequences (See https://docs.google.com/document/d/1UvtQFM3ToazUyA6G9C7pBYMgk98n31zQSY2-M9d1nEo/edit#)</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_min</span>(age_offending_imp, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">when</span>(<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,age_offending_imp<span class="sc">-</span>edad_al_ing_1<span class="sc">&lt;</span><span class="dv">0</span>))<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"Cases with negative time after admission to commission of crime"</span>), <span class="sc">~</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">motivodeegreso_mod_imp_rec=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">grepl</span>(<span class="st">"Therapeutic"</span>,motivodeegreso_mod_imp)<span class="sc">~</span> <span class="st">"Treatment completion"</span>, <span class="fu">grepl</span>(<span class="st">"Early|Late|Administrative"</span>, motivodeegreso_mod_imp) <span class="sc">&amp;</span> (fech_egres_num_1<span class="sc">-</span>fech_ing_num_1 <span class="sc">&lt;</span><span class="dv">90</span>) <span class="sc">~</span>  <span class="st">"Treatment non-completion"</span>, <span class="fu">grepl</span>(<span class="st">"Early|Late|Administrative"</span>, motivodeegreso_mod_imp) <span class="sc">&amp;</span> (fech_egres_num_1<span class="sc">-</span>fech_ing_num_1 <span class="sc">&gt;=</span><span class="dv">90</span>) <span class="sc">~</span> <span class="st">"Treatment non-completion"</span>, <span class="fu">grepl</span>(<span class="st">"Referral|Death|Ongoing"</span>, motivodeegreso_mod_imp)<span class="sc">~</span> <span class="st">"Censored"</span>, T<span class="sc">~</span><span class="cn">NA_character_</span>))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"There are "</span>,<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">group_by</span>(Base_fiscalia_v11_grant_23_24, hash_key) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rn_hash=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rn_hash<span class="sc">&gt;</span><span class="dv">1</span>)),<span class="st">" records with more than one offense commited at the youngest age (p= "</span>,dplyr<span class="sc">::</span><span class="fu">group_by</span>(Base_fiscalia_v11_grant_23_24, hash_key) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rn_hash=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rn_hash<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(hash_key) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>(),<span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: There are 0 records with more than one offense commited at the youngest age (p= 0)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"There are "</span>,<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(Base_fiscalia_v11_grant_23_24,<span class="fu">is.na</span>(fech_nac_rec))),<span class="st">" missing records in date of birth (were "</span>,<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v10_grant_23_24),<span class="fu">is.na</span>(fech_nac_rec))),<span class="st">" in step v10)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: There are 7 missing records in date of birth (were 7 in step v10)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"There are "</span>, scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">as.numeric</span>(<span class="fu">table</span>(<span class="fu">is.na</span>(Base_fiscalia_v11_grant_23_24<span class="sc">$</span>crime_code_group_rec))[[<span class="dv">2</span>]])<span class="sc">/</span><span class="fu">nrow</span>(Base_fiscalia_v11_grant_23_24)), <span class="st">" records with events of contacts with justice"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: There are 67% records with events of contacts with justice</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="st">"2023-07-17, omitted in this step (filtering for censored, ongoing treatments, etc.),because we are measuring from admission. Restricting the database for that happened later would be a selection bias. Instead, I replaced the value 'Referral and Ongoing with 'Non-completion' status'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 2023-07-17, omitted in this step (filtering for censored, ongoing treatments, etc.),because we are measuring from admission. Restricting the database for that happened later would be a selection bias. Instead, I replaced the value ‘Referral and Ongoing with ’Non-completion’ status’</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2022-11-01, filter</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v11_grant_23_24&lt;-</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::filter(Base_fiscalia_v11_grant_23_24, !grepl("Referral|Death|Censored|Ongoing",motivodeegreso_mod_imp))</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec[<span class="fu">grepl</span>(<span class="st">"Censored"</span>,Base_fiscalia_v11_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)]<span class="ot">&lt;-</span> <span class="st">"Treatment non-completion"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07_17, </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v11_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()){<span class="fu">warning</span>(<span class="st">"Patients with more than one record"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 85,048 rows and 2 columns, one group variable remaining (hash_key)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07_17, case that have more than one row</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v11_grant_23_24 %&gt;% dplyr::filter(hash_key=="001b0ff241cd0d95828b86b4bdab8c19") %&gt;%   dplyr::select(hash_key, fech_nac, fech_nac_rec, motivodeegreso_mod_imp_rec, age_tr_comp_imp, edad_al_ing_1, edad_al_egres_1, edad_comision, fec_comision_simple, caseid, crime_code_group_rec_prof, end_type_2, gls_proctermino, s_sentence_1, s_restorative_3, s_kindprison_1) %&gt;% View()</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Ver por qué los valores negativos-R: por que entre la admisión y terminar el tratamiento hay casos que registraron un delito"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, fech_nac, fech_nac_rec, motivodeegreso_mod_imp_rec, age_offending_imp, edad_al_ing_1, edad_al_egres_1, edad_comision, fec_comision_simple, caseid, crime_code_group_rec_prof, end_type_2, gls_proctermino, s_sentence_1, s_restorative_3, s_kindprison_1) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key<span class="sc">==</span><span class="st">"1951c4d080cda8b68759d638a840d82f"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Example of database"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Example of database</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">hash_key</th>
<th style="text-align: left;">fech_nac</th>
<th style="text-align: left;">fech_nac_rec</th>
<th style="text-align: left;">motivodeegreso_mod_imp_rec</th>
<th style="text-align: right;">age_offending_imp</th>
<th style="text-align: right;">edad_al_ing_1</th>
<th style="text-align: right;">edad_al_egres_1</th>
<th style="text-align: right;">edad_comision</th>
<th style="text-align: left;">fec_comision_simple</th>
<th style="text-align: left;">caseid</th>
<th style="text-align: left;">crime_code_group_rec_prof</th>
<th style="text-align: left;">end_type_2</th>
<th style="text-align: left;">gls_proctermino</th>
<th style="text-align: left;">s_sentence_1</th>
<th style="text-align: left;">s_restorative_3</th>
<th style="text-align: left;">s_kindprison_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1951c4d080cda8b68759d638a840d82f</td>
<td style="text-align: left;">1985-12-14</td>
<td style="text-align: left;">1986-12-11</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: right;">27.61092</td>
<td style="text-align: right;">25.25956</td>
<td style="text-align: right;">25.56831</td>
<td style="text-align: right;">27.60301</td>
<td style="text-align: left;">2014-07-22</td>
<td style="text-align: left;">1400700113-5</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Sentencia definitiva condenatoria</td>
<td style="text-align: left;">ABREVIADO</td>
<td style="text-align: left;">SI</td>
<td style="text-align: left;">Remisión Condicional</td>
<td style="text-align: left;">Minor Prison medium grade</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#b24908c527faa1b7bd5a267d5dcabd45</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#23d88c2b8c6da2d8abf3f88b7ce8a4c0 anomalus case</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># FROM PATIENTS (p=85,048), WE JOINED THE PO DATA (n= 174,961, p=49,970) by HASHs and where offense date is equal or lower to the age at discharge from treatment, and restricted the first treatment from SENDA in v10</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#v11: erased missing cases in date of birth; thus, missing age at discharge, filtered the first offense by each HASH (going from n= 132,530 to n=87,770) (n=87,770 p= 85,041)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#length(unique(Base_fiscalia_v11$hash_key))</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#v12: discarded patients where the first treatment corresponded to ongoing treatments (p &amp; n=5,521), external referral (p &amp; n=8,948) == 14,469 users were discarded.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p>We did not drop censored treatments (never ended), referrals and deaths, so we got 85,048 users (n= 85,048). Next, we joined the pre-treatment criminality records. <strong>These algorithms only capture the presence/absence of offenses by type (not the count of offenses)</strong>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the variables of pretreatment criminality</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v10b_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM CONS_C1_df_dup_SEP_2020_22_d AS x  </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM Base_fiscalia_v9</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.id AND </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_ing_1 &gt; y.age_offending_imp AND x.dup = 1"</span>) <span class="co">#2022-11-25  added dup // #changed the direction to past events, where age at discharge is greater than the age of commission</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Count pre-treatment offenses</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11b_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v10b_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#discrepancies in names of variables</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span>   <span class="co">#janitor::tabyl(!is.na(dob_imp_num))</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#previously recoded, </span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>dateofbirth_imp, <span class="sc">-</span>country, <span class="sc">-</span>victim, <span class="sc">-</span>id_victim, <span class="sc">-</span>crime_code_c , <span class="sc">-</span>reg_c, <span class="sc">-</span>end_type_2c, <span class="sc">-</span>cod_comunadelito, <span class="sc">-</span>cod_lugarocurrencia, <span class="sc">-</span>sex_imp, <span class="sc">-</span>region_delito, <span class="sc">-</span>filter, <span class="sc">-</span>id)<span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  plyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"dateofbirth_imp_2"</span><span class="ot">=</span><span class="st">"dateofbirth_imp"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#selected the first row with distinct information regarding patient ID, case ID, crime code.</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key, caseid, crime_code_group_rec_prof) <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_off_acq=</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span><span class="st">"Acquisitive"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>), <span class="at">n_off_vio=</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span><span class="st">"Violent"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>), <span class="at">n_off_sud=</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span> <span class="st">"Substance-related"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>), <span class="at">n_off_oth=</span>  <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span> <span class="st">"Other"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n_prev_off=</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"n_"</span>)))) </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Users in the database of previous crimes: "</span>,<span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(Base_fiscalia_v11b_grant_23_24<span class="sc">$</span>hash_key)), <span class="at">big.mark=</span><span class="st">","</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Users in the database of previous crimes: 85,048</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Users in the merged database (after filtering for observations coded as referrals, deaths, censored at baseline treatment or with ongoing treatments) : "</span>,<span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(Base_fiscalia_v11_grant_23_24<span class="sc">$</span>hash_key)), <span class="at">big.mark=</span><span class="st">","</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Users in the merged database (after filtering for observations coded as referrals, deaths, censored at baseline treatment or with ongoing treatments) : 85,048</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Join pre-treatment criminality</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-treatment Criminality </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v11_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17: we made it in the previous chunk</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::group_by(hash_key) %&gt;% </span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># #select the first and without ties (only one)</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::slice_min(age_offending_imp, n = 1, with_ties = F) %&gt;% </span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::ungroup() %&gt;% </span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join database with the pre-treatment criminality counts</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(Base_fiscalia_v11b_grant_23_24, <span class="at">by=</span><span class="st">"hash_key"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">policonsumo=</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus1_mod),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NO SE SI SIRVE, 2023-07-17 lo saqué</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(cut_fec_nac=cut2(fech_nac_rec, cuts=as.Date(attr(dlookr::binning(as.numeric(fech_nac_rec)),"breaks"))),cut_com_del=cut2(fec_comision_simple, cuts=as.Date(attr(dlookr::binning(as.numeric(fec_comision_simple)),"breaks")))) %&gt;%</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(tr_modality=dplyr::case_when(grepl("PR", as.character(tipo_de_plan_2_1))~  "Residential", grepl("PAI|PAB", as.character(tipo_de_plan_2_1))~ "Ambulatory", T~ NA_character_))%&gt;% </span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">when</span>(<span class="fu">nrow</span>(.)<span class="sc">&gt;</span><span class="fu">nrow</span>(Base_fiscalia_v11_grant_23_24)<span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"More cases in the new database"</span>), <span class="sc">~</span>.) </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Number of cases that are different by at least 0,02 years between 'edad_al_egres_imp' &amp; 'edad_al_egres_1'= "</span>, <span class="fu">nrow</span>(<span class="fu">cbind.data.frame</span>(<span class="fu">round</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>edad_al_ing_1,<span class="dv">4</span>), <span class="fu">round</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>edad_al_ing_fmt,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.[[<span class="dv">1</span>]]<span class="sc">-</span>.[[<span class="dv">2</span>]])<span class="sc">&gt;</span><span class="fl">0.02</span>)),<span class="st">" probably due to the discrepancies in getting the differences of dates"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Number of cases that are different by at least 0,02 years between ‘edad_al_egres_imp’ &amp; ‘edad_al_egres_1’= 2751 probably due to the discrepancies in getting the differences of dates</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Recode in 0/1 for more than one treatment, numeric"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>dup_filt<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>duplicates_filtered<span class="sc">&gt;</span><span class="dv">1</span>,<span class="st">"&gt;1 treatment"</span>,<span class="st">"only one treatment"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>dup_filt_num<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>duplicates_filtered<span class="sc">&gt;</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"offender after admission (event), numeric"</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>offense_after_adm<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>offender_d),<span class="st">"offender after adm"</span>,<span class="st">"no offense after admission"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>off_aft_adm<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>offender_d), <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"treatment outcome status, numeric"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>mot_egres_mod_imp_rec2<span class="ot">&lt;-</span>  dplyr<span class="sc">::</span><span class="fu">case_when</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec<span class="sc">==</span> <span class="st">"Treatment completion"</span><span class="sc">~</span> <span class="st">"Tr.Completion"</span>, <span class="fu">grepl</span>(<span class="st">"non"</span>, Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)<span class="sc">~</span> <span class="st">"Non-completion"</span>, T<span class="sc">~</span><span class="st">"Censored"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>mot_egres_mod_imp_rec_num<span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec<span class="sc">==</span><span class="st">"Treatment completion"</span><span class="sc">~</span><span class="dv">1</span>, <span class="fu">grepl</span>(<span class="st">"non"</span>,Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)<span class="sc">~</span><span class="dv">0</span>, T<span class="sc">~</span><span class="dv">0</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>mot_egres_mod_imp_rec2<span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec<span class="sc">==</span><span class="st">"Treatment completion"</span><span class="sc">~</span><span class="st">"Tr.Completion"</span>, <span class="fu">grepl</span>(<span class="st">"non"</span>, Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)<span class="sc">~</span> <span class="st">"Non-completion"</span>, T<span class="sc">~</span><span class="st">"Censored"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"treatment setting, binary, numeric"</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>tr_mod <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>tr_modality<span class="sc">==</span><span class="st">"Residential"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<section id="post-treatment-criminality" class="level3">
<h3 class="anchored" data-anchor-id="post-treatment-criminality">Post treatment criminality</h3>
<p>Selected offenses after discharge/dropout. We counted distinct patient ID, crime code and age of commission of the offense.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v10c_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM CONS_C1_df_dup_SEP_2020_22_d AS x  </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM Base_fiscalia_v9</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.id AND </span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_egres_1 &lt; y.age_offending_imp AND x.dup = 1"</span>) </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2023-08-15</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Count post-treatment offenses</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11c_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v10c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#discrepancies in names of variables</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span>   <span class="co">#janitor::tabyl(!is.na(dob_imp_num))</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#previously recoded, </span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>dateofbirth_imp, <span class="sc">-</span>country, <span class="sc">-</span>victim, <span class="sc">-</span>id_victim,  <span class="sc">-</span>reg_c, <span class="sc">-</span>end_type_2c, <span class="sc">-</span>cod_comunadelito, <span class="sc">-</span>cod_lugarocurrencia, <span class="sc">-</span>sex_imp, <span class="sc">-</span>region_delito, <span class="sc">-</span>filter, <span class="sc">-</span>id)<span class="sc">%&gt;%</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  plyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"dateofbirth_imp_2"</span><span class="ot">=</span><span class="st">"dateofbirth_imp"</span>)) <span class="sc">%&gt;%</span> <span class="co">#2023-08-15, omitted -crime_code_c</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-08-15: added the age of commission of the crime, we omitted caseid. Then i backed down, because it was a different offense</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key, crime_code_group_rec_prof, caseid, edad_comision) <span class="sc">%&gt;%</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-08-15: test</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a> <span class="co"># dplyr::filter(hash_key=="20f6876567ebaf145aed0b1913f05337") %&gt;% dplyr::select(hash_key, ano_bd_first, fech_nac, fech_ing, fech_egres_imp, motivodeegreso_mod_imp, fec_comision_simple, edad_comision, edad_al_egres_1, region_delito_rec, crime_code_c, crime_code_group_rec_prof, end_type, end_type_2 ) %&gt;% rio::export("_particular_case_with_post_off2.xlsx")</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-08-15: test with only violent crimes</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>      <span class="co">#dplyr::filter(hash_key=="4e92f1e4b4fec715adb252aea4af2579") %&gt;% dplyr::select(hash_key, ano_bd_first, fech_nac, fech_ing, fech_egres_imp, motivodeegreso_mod_imp, fec_comision_simple, edad_comision, edad_al_egres_1, region_delito_rec, crime_code_c, crime_code_group_rec_prof, end_type, end_type_2 ) %&gt;% View() %&gt;% rio::export("_particular_case_with_post_off_violent.xlsx")</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#selected the first row with distinct information regarding patient ID, crime code.</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_post_off_acq=</span> <span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span><span class="st">"Acquisitive"</span>, <span class="at">na.rm=</span>T), <span class="at">n_post_off_vio=</span> <span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span><span class="st">"Violent"</span>, <span class="at">na.rm=</span>T), <span class="at">n_post_off_sud=</span> <span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span> <span class="st">"Substance-related"</span>, <span class="at">na.rm=</span>T), <span class="at">n_post_off_oth=</span>  <span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span> <span class="st">"Other"</span>, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n_post_off=</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"n_post_"</span>)))) </span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Users in the database of previous crimes: "</span>,<span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(Base_fiscalia_v11c_grant_23_24<span class="sc">$</span>hash_key)), <span class="at">big.mark=</span><span class="st">","</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Users in the database of previous crimes: 85,048</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-08-15 - count</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#arrange(Base_fiscalia_v11c_grant_23_24,desc(n_post_off))</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Join post-treatment criminality</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-treatment Criminality </span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13c_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v13_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17: we made it in the previous chunk</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::group_by(hash_key) %&gt;% </span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># #select the first and without ties (only one)</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::slice_min(age_offending_imp, n = 1, with_ties = F) %&gt;% </span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::ungroup() %&gt;% </span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join database with the pre-treatment criminality counts</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(Base_fiscalia_v11c_grant_23_24, <span class="at">by=</span><span class="st">"hash_key"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NO SE SI SIRVE, 2023-07-17 lo saqué</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(cut_fec_nac=cut2(fech_nac_rec, cuts=as.Date(attr(dlookr::binning(as.numeric(fech_nac_rec)),"breaks"))),cut_com_del=cut2(fec_comision_simple, cuts=as.Date(attr(dlookr::binning(as.numeric(fec_comision_simple)),"breaks")))) %&gt;%</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(tr_modality=dplyr::case_when(grepl("PR", as.character(tipo_de_plan_2_1))~  "Residential", grepl("PAI|PAB", as.character(tipo_de_plan_2_1))~ "Ambulatory", T~ NA_character_))%&gt;% </span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">when</span>(<span class="fu">nrow</span>(.)<span class="sc">&gt;</span><span class="fu">nrow</span>(Base_fiscalia_v13_grant_23_24)<span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"More cases in the new database"</span>), <span class="sc">~</span>.) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="discard-deaths" class="level3">
<h3 class="anchored" data-anchor-id="discard-deaths">Discard deaths</h3>
<p>In the analysis, a critical step involved processing the treatment database to extract only relevant data while ignoring the entries of individuals who passed away.</p>
<ul>
<li><p>Loaded the treatment data from <code>2_ndp_2023_07_05_20_00_00.RData</code> (data of SENDA Treatments retrieved in 2023), and extracted and cleaned the date of discharge column (<code>fecha_egreso_de_tratamiento</code>) and the reason for administrative discharge (<code>motivo_de_egreso_alta_administrativa</code>).</p></li>
<li><p>Renamed and formatted the columns for ease of understanding and analysis using <code>janitor::clean_names</code>.</p></li>
<li><p>Converted the date of discharge into a numerical value using unclass.</p></li>
<li><p>Identified dates that failed parsing and stored them in the parsing_failures data frame. This is a precaution to ensure all date values are consistent and no incorrect dates are processed further.</p></li>
<li><p>The data had multiple date formats. They were converted to a consistent format using a series of conditional operations. Errors in the dates, such as 307203, 01707/2010, 30520011, and 30/08/20011, were manually corrected.</p></li>
<li><p>Entries with “Fallecimiento” (death) as the reason for administrative discharge were extracted and stored in <code>cause_of_adm_discharge_ndp_23_2_filt</code>.</p></li>
<li><p>The core objective was to ensure that there were no inconsistencies in the data, especially concerning deceased individuals.</p></li>
<li><p>Checks were made to: Ensure no person was admitted to treatment after their recorded death date; Ensure no person was discharged from treatment after their recorded death date; Ensure no person committed an offense after their recorded death date; If any of these inconsistencies were found, an error message would be triggered. This acted as a fail-safe to avoid the propagation of incorrect data or conclusions.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"2_ndp_2023_07_05_20_00_00.RData"</span>, ndp_2023_step2 <span class="ot">&lt;-</span> <span class="fu">new.env</span>() )</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23 <span class="ot">&lt;-</span> ndp_2023_step2<span class="sc">$</span>CONS_C1_2010_19[,<span class="fu">c</span>(<span class="st">"hash_key"</span>,<span class="st">"fecha_egreso_de_tratamiento"</span>, <span class="st">"motivo_de_egreso_alta_administrativa"</span>)] <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fecha_egreso_de_tratamiento2=</span>  readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento,<span class="st">"%d/%m/%Y"</span>)) <span class="sc">%&gt;%</span>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fech_egres_num=</span> <span class="fu">unclass</span>(fecha_egreso_de_tratamiento)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 80 parsing failures. row col expected actual 194 – date like %d/%m/%Y 15<br>
1294 – date like %d/%m/%Y 30/12/09 1650 – date like %d/%m/%Y 20/01/10 1859 – date like %d/%m/%Y 23/03/09 1934 – date like %d/%m/%Y 13/05/09 …. … ……………… …….. See problems(…) for more details.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>parsing_failures <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(ndp_2023_step2<span class="sc">$</span>CONS_C1_2010_19[,<span class="fu">c</span>(<span class="st">"hash_key"</span>,<span class="st">"fecha_egreso_de_tratamiento"</span>)], <span class="at">fecha_egreso_de_tratamiento2=</span>  readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento,<span class="st">"%d/%m/%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(fecha_egreso_de_tratamiento))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 80 parsing failures. row col expected actual 194 – date like %d/%m/%Y 15<br>
1294 – date like %d/%m/%Y 30/12/09 1650 – date like %d/%m/%Y 20/01/10 1859 – date like %d/%m/%Y 23/03/09 1934 – date like %d/%m/%Y 13/05/09 …. … ……………… …….. See problems(…) for more details.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#delete environment of NDP 2023 Step 2</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ndp_2023_step2)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="ot">&lt;-</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23 <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fecha_egreso_de_tratamiento3=</span><span class="fu">as.character</span>(fecha_egreso_de_tratamiento)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fecha_egreso_de_tratamiento3=</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#1. format %d/%m/%y in minusc y</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"30/12/09"</span>, <span class="st">"20/01/10"</span>, <span class="st">"23/03/09"</span>, <span class="st">"13/05/09"</span>, <span class="st">"14/04/09"</span>, <span class="st">"15/09/09"</span>, <span class="st">"02/06/09"</span>, <span class="st">"09/06/09"</span>, <span class="st">"01/10/09"</span>, <span class="st">"09/03/09"</span>, <span class="st">"01/06/10"</span>, <span class="st">"03/04/10"</span>, <span class="st">"01/10/10"</span>, <span class="st">"14/01/11"</span>, <span class="st">"04/08/11"</span>, <span class="st">"08/07/13"</span>) <span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span> <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%d/%m/%y"</span>)),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2. format %d/%m/%y in minusc y without leading zeros </span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"4102010"</span>,  <span class="st">"3052011"</span>, <span class="st">"4102010"</span>, <span class="st">"13012011"</span>, <span class="st">"31012011"</span>, <span class="st">"3052011"</span>, <span class="st">"13012011"</span>, <span class="st">"13082013"</span>, <span class="st">"17072013"</span>, <span class="st">"12082013"</span>, <span class="st">"2082013"</span>, <span class="st">"1072013"</span>, <span class="st">"31072013"</span>, <span class="st">"17062013"</span>, <span class="st">"27072013"</span>, <span class="st">"25072013"</span>, <span class="st">"14072013"</span>, <span class="st">"2072013"</span>, <span class="st">"2082013"</span>, <span class="st">"7082013"</span>, <span class="st">"31072013"</span>, <span class="st">"27062013"</span>, <span class="st">"16082013"</span>, <span class="st">"9072013"</span>, <span class="st">"2082013"</span>, <span class="st">"20082013"</span>, <span class="st">"16082013"</span>, <span class="st">"22082013"</span>) <span class="sc">&amp;</span> <span class="fu">nchar</span>(fecha_egreso_de_tratamiento3) <span class="sc">&lt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span> <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(<span class="fu">sprintf</span>(<span class="st">"%08d"</span>, readr<span class="sc">::</span><span class="fu">parse_integer</span>(fecha_egreso_de_tratamiento3)),<span class="st">"%d%m%Y"</span>)), </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#3. format in "%d-%m-%Y"</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"01-02-2011"</span>, <span class="st">"06-09-2011"</span>, <span class="st">"27-11-2012"</span>, <span class="st">"01-03-2013"</span>)<span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span>  <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%d-%m-%Y"</span>)),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#4. format "%d/%m/%y"</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"10/6/11"</span>, <span class="st">"20/6/11"</span>, <span class="st">"10/6/11"</span>, <span class="st">"10/6/11"</span>, <span class="st">"20/6/11"</span>, <span class="st">"10/6/11"</span>, <span class="st">"10/7/11"</span>, <span class="st">"31/7/11"</span>, <span class="st">"12/6/11"</span>, <span class="st">"1/6/11"</span>, <span class="st">"5/6/11"</span>, <span class="st">"4/7/11"</span>, <span class="st">"31/7/11"</span>, <span class="st">"7/7/11"</span>, <span class="st">"2/8/11"</span>)<span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span>  <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%d/%m/%y"</span>)),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>     <span class="co">#5. format "%d/%m/%y"</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2013/04/02"</span>)<span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span>  <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%Y/%m/%d"</span>)),</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Others: keep as character fecha_egreso_de_tratamiento2 </span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    T<span class="sc">~</span> <span class="fu">as.character</span>(fecha_egreso_de_tratamiento2))) <span class="co">#%&gt;% </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 153371 parsing failures. row col expected actual 1 – date like %d/%m/%y 01/03/2010 2 – date like %d/%m/%y 01/05/2010 3 – date like %d/%m/%y 13/04/2010 4 – date like %d/%m/%y 21/01/2010 5 – date like %d/%m/%y 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153364 parsing failures. row col expected actual 1 – no trailing characters 01/03/2010 2 – no trailing characters 01/05/2010 3 – no trailing characters 13/04/2010 4 – no trailing characters 21/01/2010 5 – no trailing characters 15/04/2011 … … …………………. ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 10 parsing failures. row col expected actual 194 – valid date 00000015 8239 – valid date 00000015 9042 – valid date 00000005 9043 – valid date 00000005 9353 – valid date 00000025 …. … ………. …….. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153398 parsing failures. row col expected actual 1 – date like %d-%m-%Y 01/03/2010 2 – date like %d-%m-%Y 01/05/2010 3 – date like %d-%m-%Y 13/04/2010 4 – date like %d-%m-%Y 21/01/2010 5 – date like %d-%m-%Y 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153371 parsing failures. row col expected actual 1 – date like %d/%m/%y 01/03/2010 2 – date like %d/%m/%y 01/05/2010 3 – date like %d/%m/%y 13/04/2010 4 – date like %d/%m/%y 21/01/2010 5 – date like %d/%m/%y 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153402 parsing failures. row col expected actual 1 – date like %Y/%m/%d 01/03/2010 2 – date like %Y/%m/%d 01/05/2010 3 – date like %Y/%m/%d 13/04/2010 4 – date like %Y/%m/%d 21/01/2010 5 – date like %Y/%m/%d 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::filter(hash_key %in% parsing_failures$hash_key)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#impute discharge dates arbitrarely</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3<span class="sc">==</span><span class="st">"307203"</span>)] <span class="ot">&lt;-</span> <span class="st">"2013-07-30"</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento<span class="sc">==</span><span class="st">"01707/2010"</span>)] <span class="ot">&lt;-</span> <span class="st">"2010-07-17"</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento<span class="sc">==</span><span class="st">"30520011"</span>)] <span class="ot">&lt;-</span> <span class="st">"2011-05-30"</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento<span class="sc">==</span><span class="st">"30/08/20011"</span>)] <span class="ot">&lt;-</span> <span class="st">"2011-08-30"</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># format dates</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento_fmt<span class="ot">&lt;-</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">parse_date</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3,<span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># format dates to numeric</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento_num<span class="ot">&lt;-</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">unclass</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento_fmt)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co">#rare: 01707/2010, 30/08/20011, 30520011, 307203</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co">#ambiguous: 2082013, 1072013, 2072013, 2082013, 7082013, 2082013, "10/6/11", "20/6/11", "10/6/11"</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17, </span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Select the cases with death as the motive of administrative discharge</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2_filt<span class="ot">&lt;-</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2 <span class="sc">%&gt;%</span> </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(motivo_de_egreso_alta_administrativa<span class="sc">==</span><span class="st">"Fallecimiento"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we discard censorship due to deaths from the original database.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v13c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(cause_of_adm_discharge_ndp_23_2_filt[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_num"</span>,<span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="st">"hash_key"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(fech_ing_num_1 <span class="sc">&gt;</span> fecha_egreso_de_tratamiento_num) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">0</span>){<span class="fu">error</span>(<span class="st">"There are cases in which people were admitted to treatment after their death"</span>)}</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v13c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(cause_of_adm_discharge_ndp_23_2_filt[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_num"</span>,<span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="st">"hash_key"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(fech_egres_num_1 <span class="sc">&gt;</span> fecha_egreso_de_tratamiento_num) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">0</span>){<span class="fu">error</span>(<span class="st">"There are cases in which people were discharged of treatment after their death"</span>)}</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v13c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(cause_of_adm_discharge_ndp_23_2_filt[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_num"</span>,<span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="st">"hash_key"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fec_comision_simple_num=</span><span class="fu">unclass</span>(fec_comision_simple)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(fec_comision_simple_num <span class="sc">&gt;</span> fecha_egreso_de_tratamiento_num) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">0</span>){<span class="fu">error</span>(<span class="st">"There are cases in which people comitted an offense after their death"</span>)}</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v13_grant_23_24 %&gt;% </span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    dplyr::left_join(cause_of_adm_discharge_ndp_23_2_filt[,c("hash_key", "fecha_egreso_de_tratamiento_num","fecha_egreso_de_tratamiento_fmt")], by=c("hash_key")) %&gt;% </span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    dplyr::mutate(fec_comision_simple_num=unclass(fec_comision_simple)) %&gt;% </span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    #dplyr::filter(fec_comision_simple_num &gt; fecha_egreso_de_tratamiento_num) %&gt;% </span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::select(hash_key, fec_comision_simple, fecha_egreso_de_tratamiento_fmt, fec_comision_simple_num, fecha_egreso_de_tratamiento_num) %&gt;% dplyr::filter(!is.na(fecha_egreso_de_tratamiento_fmt)) %&gt;% View()</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It is probable that many SENDA dates are bad, and due to to the process of cleaning made in Fiscalia merge 2 and 3, the correct dates may have been already corrected. However, these databases are not available"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="bring-other-databases" class="level3">
<h3 class="anchored" data-anchor-id="bring-other-databases">Bring other databases</h3>
</section>
<section id="municipallity" class="level3">
<h3 class="anchored" data-anchor-id="municipallity">Municipallity</h3>
<p>Given that we found no cases with censorship due to deaths, we brought the classification of rurality (from the Census of 2017 in this <a href="https://www.masvidarural.gob.cl/wp-content/uploads/2021/04/Clasificacion-comunas-PNDR.xlsx">link</a>) and poverty index of communes between 2007-2020 (<a href="https://observatorio.ministeriodesarrollosocial.gob.cl/pobreza-comunal">link</a>).</p>
<ul>
<li><p>The dataset <code>Clasificacion-comunas-PNDR.xlsx</code>, had a variable named <code>cod_com</code>. This variable represents codes for different communes in Chile, but it appears these codes need to be transformed or standardized for some communes.</p></li>
<li><p>For instance, the commune with code “16101” needs to be changed to “8401”, “16102” to “8402”, and so forth. This transformation is achieved using dplyr’s case_when function, and the transformed data is stored back into <code>Comunas_PNDR</code> with an additional column, cod, holding the standardized commune codes.</p></li>
<li><p>The next section reads multiple Excel files containing poverty data estimates for Chilean communes across different years (from 2007 to 2020). Each year’s data is read into its own data frame (e.g., pobr_mult_2020 for the year 2020).</p></li>
<li><p>During this reading process: The year is added as a new column (<code>anio</code>). Then, the relevant columns were selected and renamed for consistency. Any additional transformations, like renaming variables, were done to ensure that the datasets had a consistent structure.</p></li>
<li><p>Once all the annual datasets are loaded and transformed, they are aggregated into a single data frame, <code>pobr_mult_2007_2020</code>, using the rbind.data.frame function. This dataset now has all commune-level poverty estimates from 2007 to 2020. Similar to the transformation done with <code>Comunas_PNDR</code>, this aggregated dataset also undergoes a transformation where the commune codes (<code>Código</code>) were standardized, resulting in a new <code>cod</code> column.</p></li>
<li><p>Finally, to keep the workspace clean and optimize memory usage, individual annual data frames (like <code>pobr_mult_2020</code>) were deleted. This is achieved using a loop that checks if each data frame exists and, if so, removes it.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#http://observatorio.ministeriodesarrollosocial.gob.cl/pobreza-comunal-2020</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.masvidarural.gob.cl/wp-content/uploads/2021/04/Clasificacion-comunas-PNDR.xlsx</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>Comunas_PNDR <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Clasificacion-comunas-PNDR.xlsx"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16101"</span><span class="sc">~</span><span class="st">"8401"</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16102"</span><span class="sc">~</span><span class="st">"8402"</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16103"</span><span class="sc">~</span><span class="st">"8406"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16104"</span><span class="sc">~</span><span class="st">"8407"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16105"</span><span class="sc">~</span><span class="st">"8410"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16106"</span><span class="sc">~</span><span class="st">"8411"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16107"</span><span class="sc">~</span><span class="st">"8413"</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16108"</span><span class="sc">~</span><span class="st">"8418"</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16109"</span><span class="sc">~</span><span class="st">"8421"</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16201"</span><span class="sc">~</span><span class="st">"8414"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16202"</span><span class="sc">~</span><span class="st">"8403"</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16203"</span><span class="sc">~</span><span class="st">"8404"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16204"</span><span class="sc">~</span><span class="st">"8408"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16205"</span><span class="sc">~</span><span class="st">"8412"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16206"</span><span class="sc">~</span><span class="st">"8415"</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16207"</span><span class="sc">~</span><span class="st">"8420"</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16301"</span><span class="sc">~</span><span class="st">"8416"</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16302"</span><span class="sc">~</span><span class="st">"8405"</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16303"</span><span class="sc">~</span><span class="st">"8409"</span>,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16304"</span><span class="sc">~</span><span class="st">"8417"</span>,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16305"</span><span class="sc">~</span><span class="st">"8419"</span>,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>                                      T<span class="sc">~</span> <span class="fu">as.character</span>(cod_com)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co">#http://observatorio.ministeriodesarrollosocial.gob.cl/pobreza-comunal-2011</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>pobr_mult_2020<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimaciones_de_Tasa_de_Pobreza_por_Ingresos_por_Comunas_2020_revisada2022_09.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>pobr_mult_2019<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimaciones_de_Tasa_de_Pobreza_por_Ingresos_por_Comunas_2020_revisada2022_09.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2019</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>pobr_mult_2018<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2017.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2018</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>pobr_mult_2017<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2017.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2017</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>pobr_mult_2016<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2015.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2016</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>pobr_mult_2015<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2015.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2015</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>pobr_mult_2014<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_2013.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2014</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>pobr_mult_2013<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_2013.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2013</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>pobr_mult_2012<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimacion_tasa_de_pobreza_comunal_2011_(nueva _metodologia).xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2012</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>pobr_mult_2011<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimacion_tasa_de_pobreza_comunal_2011_(nueva _metodologia).xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2011</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>pobr_mult_2010<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimacion_tasa_de_pobreza_comunal_2011_(nueva _metodologia).xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2010</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>pobr_mult_2009<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PobrezaporComunas_SAE_20092011.xlsx"</span>, <span class="at">skip=</span><span class="dv">3</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2009</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(anio, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Incidencia pobreza"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Código"</span><span class="ot">=</span><span class="dv">2</span>, <span class="st">"Nombre comuna"</span><span class="ot">=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Región<span class="ot">=</span><span class="fu">rep</span>(<span class="st">""</span>)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>New names: * <code>-&gt; `...1` *</code> -&gt; <code>...2</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...3</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...4</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...5</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...6</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...7</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...8</code> * <code>-&gt; `...9` *</code> -&gt; <code>...10</code></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pobr_mult_2008<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PobrezaporComunas_SAE_20092011.xlsx"</span>, <span class="at">skip=</span><span class="dv">3</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2008</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(anio, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>    dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Incidencia pobreza"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Código"</span><span class="ot">=</span><span class="dv">2</span>, <span class="st">"Nombre comuna"</span><span class="ot">=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Región<span class="ot">=</span><span class="fu">rep</span>(<span class="st">""</span>)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>New names: * <code>-&gt; `...1` *</code> -&gt; <code>...2</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...3</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...4</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...5</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...6</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...7</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...8</code> * <code>-&gt; `...9` *</code> -&gt; <code>...10</code></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pobr_mult_2007<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PobrezaporComunas_SAE_20092011.xlsx"</span>, <span class="at">skip=</span><span class="dv">3</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2007</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(anio, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Incidencia pobreza"</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Código"</span><span class="ot">=</span><span class="dv">2</span>, <span class="st">"Nombre comuna"</span><span class="ot">=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Región<span class="ot">=</span><span class="fu">rep</span>(<span class="st">""</span>)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>New names: * <code>-&gt; `...1` *</code> -&gt; <code>...2</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...3</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...4</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...5</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...6</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...7</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...8</code> * <code>-&gt; `...9` *</code> -&gt; <code>...10</code></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pobr_mult_2007_2020<span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(pobr_mult_2007, pobr_mult_2008, pobr_mult_2009, pobr_mult_2010, pobr_mult_2011, pobr_mult_2012, pobr_mult_2013, pobr_mult_2014, pobr_mult_2015, pobr_mult_2016, pobr_mult_2017, pobr_mult_2018, pobr_mult_2019, pobr_mult_2020) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(Código<span class="sc">==</span><span class="st">"16101"</span><span class="sc">~</span><span class="st">"8401"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16102"</span><span class="sc">~</span><span class="st">"8402"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16103"</span><span class="sc">~</span><span class="st">"8406"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16104"</span><span class="sc">~</span><span class="st">"8407"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16105"</span><span class="sc">~</span><span class="st">"8410"</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16106"</span><span class="sc">~</span><span class="st">"8411"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16107"</span><span class="sc">~</span><span class="st">"8413"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16108"</span><span class="sc">~</span><span class="st">"8418"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16109"</span><span class="sc">~</span><span class="st">"8421"</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16201"</span><span class="sc">~</span><span class="st">"8414"</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16202"</span><span class="sc">~</span><span class="st">"8403"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16203"</span><span class="sc">~</span><span class="st">"8404"</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16204"</span><span class="sc">~</span><span class="st">"8408"</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16205"</span><span class="sc">~</span><span class="st">"8412"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16206"</span><span class="sc">~</span><span class="st">"8415"</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16207"</span><span class="sc">~</span><span class="st">"8420"</span>,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16301"</span><span class="sc">~</span><span class="st">"8416"</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16302"</span><span class="sc">~</span><span class="st">"8405"</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16303"</span><span class="sc">~</span><span class="st">"8409"</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16304"</span><span class="sc">~</span><span class="st">"8417"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16305"</span><span class="sc">~</span><span class="st">"8419"</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>                                      T<span class="sc">~</span> Código</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete `pobr_mult_` object </span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>object_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"pobr_mult_"</span>, <span class="dv">2007</span><span class="sc">:</span><span class="dv">2020</span>)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> object_names) {</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">exists</span>(name)) {  <span class="co"># Check if object exists</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(<span class="at">list =</span> name)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="senda-september-2020" class="level3">
<h3 class="anchored" data-anchor-id="senda-september-2020">SENDA September 2020</h3>
<p><strong>Analyzing and Cleaning the Data from the Fondecyt 1191282 Project</strong></p>
<p>The Fondecyt 1191282 project (SENDA treatments 2010-2019) contained information about various aspects, including demographic details, the reasons for admission and discharge from a program, and data related to the occurrence of certain events post-admission. We used the original (not filtered/selected) data from a previously saved R session 8.RData. This was specifically the <code>CONS_C1_df_dup_SEP_2020</code> dataset.</p>
<ul>
<li><p>We merged and transformed the data to create a new database named <code>Base_fiscalia_v14_grant_23_24</code> by updating it from the previous version <code>Base_fiscalia_v13c_grant_23_24</code>.</p></li>
<li><p>Demographic Information: The code started with deriving new variables like the year of admission (anio_ing_tr) and residence code (comuna_residencia_cod_rec).</p></li>
<li><p>Linking to External Datasets: External datasets like <code>pobr_mult_2007_2020</code> (poverty index) and <code>Comunas_PNDR</code> (classification of rurality) were joined to the base data on municipality codes and admission year.</p></li>
<li><p>Data Quality Checks: Warnings were generated when inconsistencies were found, such as when the age at offense was lower than the age at discharge or admission. This allowed for timely identification and rectification of data issues.</p></li>
<li><p>Deriving New Variables: The age at the time of an offense or at the time of a program’s completion was computed, along with the time to these events from the date of admission. This would be pivotal in survival analyses or any time-to-event analysis.</p></li>
<li><p>Cleaning and Transforming Variables: Numerous variables like substance use frequency, education levels, and others were transformed into factors or ordered factors for easier analysis. Special care was given to ensure consistency and meaningful categories in these variables. For instance, entries where the frequency of substance use was logged as “Did not use” were recoded as “Less than 1 day a week”.</p></li>
<li><p>Feature Engineering: Variables like <code>con_quien_vive_joel</code>, which indicates with whom an individual lives, were derived from existing data. Using string matching functions, detailed living arrangements were bucketed into broader categories such as “Family of origin”, “Alone”, “With couple/children”, and “Others”.</p></li>
<li><p>Integrating External Information: The data was further augmented by joining with the <code>CONS_C1_df_dup_SEP_2020</code> dataset to integrate information about pregnancies. This influenced the computation of a new variable indicating the number of children (<code>numero_de_hijos_mod_joel</code>).</p></li>
<li><p>Creating Health Metrics: Various health metrics were calculated. For instance, a composite physical health score (<code>dg_fis_total</code>) was computed as the sum of binary flags indicating different health conditions.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Retrieve CONS_C1_df_dup_SEP_2020 from previous 8.RData (Fondecyt 1191282)"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"13.RData"</span>, fiscalia_merge3 <span class="ot">&lt;-</span> <span class="fu">new.env</span>() )</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>CONS_C1_df_dup_SEP_2020<span class="ot">&lt;-</span> fiscalia_merge3<span class="sc">$</span>CONS_C1_df_dup_SEP_2020</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fiscalia_merge3)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Make the database"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13c_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">comuna_residencia_cod_rec=</span> <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_number</span>(comuna_residencia_cod)), <span class="at">anio_ing_tr=</span> lubridate<span class="sc">::</span><span class="fu">epiyear</span>(fech_ing)) <span class="sc">%&gt;%</span> <span class="co">#glimpse()</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(pobr_mult_2007_2020[,<span class="fu">c</span>(<span class="st">"anio"</span>, <span class="st">"cod"</span>,<span class="st">"porc_pobr"</span>)], <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"comuna_residencia_cod_rec"</span><span class="ot">=</span><span class="st">"cod"</span>, <span class="st">"anio_ing_tr"</span><span class="ot">=</span><span class="st">"anio"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(Comunas_PNDR[,<span class="fu">c</span>(<span class="st">"cod"</span>, <span class="st">"Clasificación"</span>)], <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"comuna_residencia_cod_rec"</span><span class="ot">=</span><span class="st">"cod"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-07-17: we eliminated class_centros</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-02-01</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::left_join(class_centros[,c("id_centro", "nombre_centro_1", "classification")], by= "id_centro")%&gt;%</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">when</span>(<span class="fu">nrow</span>(.)<span class="sc">&gt;</span><span class="fu">nrow</span>(Base_fiscalia_v13c_grant_23_24) <span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"More cases in the new database"</span>), <span class="sc">~</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-07-17: create the event and time to event</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ages at offense vs. ages at discharge</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">warning_needed =</span> age_offending_imp <span class="sc">-</span> edad_al_egres_1 <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(<span class="fu">any</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Cases with offense ages lower than age at discharge: "</span>, <span class="fu">format</span>(<span class="fu">sum</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm=</span>T), <span class="at">big.mark=</span><span class="st">","</span>))); .} <span class="sc">%&gt;%</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>warning_needed) <span class="sc">%&gt;%</span> </span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ages at offense vs. ages at discharge</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#    dplyr::filter(dplyr::case_when(edad_al_egres_1 - edad_al_ing_1 &lt; 0~F,T~T))</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">warning_needed =</span> edad_al_egres_1 <span class="sc">-</span> edad_al_ing_1 <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(<span class="fu">any</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Cases with ages at discharge lower than age at admission: "</span>, <span class="fu">format</span>(<span class="fu">sum</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm=</span>T), <span class="at">big.mark=</span><span class="st">","</span>))); .} <span class="sc">%&gt;%</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>warning_needed) <span class="sc">%&gt;%</span> </span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ages at offense vs. ages at admission</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">warning_needed =</span> age_offending_imp <span class="sc">-</span> edad_al_ing_1 <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(<span class="fu">any</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Cases with offense ages lower than age at admission: "</span>, <span class="fu">format</span>(<span class="fu">sum</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm=</span>T), <span class="at">big.mark=</span><span class="st">","</span>))); .} <span class="sc">%&gt;%</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>warning_needed) <span class="sc">%&gt;%</span> </span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17: modify ages to event and event. Get dichotomous variables created earlier</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_  </span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_offending_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(age_offending_imp<span class="sc">-</span>edad_al_egres_1<span class="sc">&lt;=</span><span class="dv">0</span><span class="sc">~</span> age_offending_imp<span class="sc">+</span> <span class="fl">0.0001</span>,T<span class="sc">~</span>age_offending_imp), <span class="at">event_offense=</span> off_aft_adm)<span class="sc">%&gt;%</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_tr_comp_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(edad_al_egres_1<span class="sc">-</span>edad_al_ing_1<span class="sc">&lt;=</span><span class="dv">0</span><span class="sc">~</span> edad_al_egres_1<span class="sc">+</span> <span class="fl">0.0001</span>,T<span class="sc">~</span>edad_al_egres_1), <span class="at">event_comp=</span> mot_egres_mod_imp_rec_num)<span class="sc">%&gt;%</span>  </span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17: modify ages according to age at censorship if the event is not observed in the time frame</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_  </span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_offending_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_offense<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_offending_imp)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_tr_comp_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_comp<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_tr_comp_imp)) <span class="sc">%&gt;%</span>   </span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_at_censor_date=</span>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time_to_off_from_adm=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_offense<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span> age_at_censor_date<span class="sc">-</span> edad_al_ing_1, T<span class="sc">~</span> age_offending_imp<span class="sc">-</span>edad_al_ing_1)) <span class="sc">%&gt;%</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time_to_drop_from_adm=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_offense<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span> age_at_censor_date<span class="sc">-</span> edad_al_ing_1, T<span class="sc">~</span> age_tr_comp_imp<span class="sc">-</span>edad_al_ing_1)) <span class="sc">%&gt;%</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">freq_cons_sus_prin=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">as.character</span>(freq_cons_sus_prin)<span class="sc">==</span><span class="st">"Did not use"</span><span class="sc">~</span><span class="st">"Less than 1 day a week"</span>, T<span class="sc">~</span> <span class="fu">as.character</span>(freq_cons_sus_prin)))<span class="sc">%&gt;%</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">escolaridad_rec=</span><span class="fu">parse_factor</span>(<span class="fu">as.character</span>(escolaridad_rec),<span class="at">levels=</span><span class="fu">c</span>(<span class="st">'3-Completed primary school or less'</span>, <span class="st">'2-Completed high school or less'</span>, <span class="st">'1-More than high school'</span>), <span class="at">ordered =</span>T,<span class="at">trim_ws=</span>T,<span class="at">include_na =</span>F, <span class="at">locale=</span><span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"Latin1"</span>))) <span class="sc">%&gt;%</span>  </span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">freq_cons_sus_prin=</span><span class="fu">parse_factor</span>(<span class="fu">as.character</span>(freq_cons_sus_prin),<span class="at">levels=</span><span class="fu">c</span>(<span class="st">'Less than 1 day a week'</span>,<span class="st">'2 to 3 days a week'</span>,<span class="st">'4 to 6 days a week'</span>,<span class="st">'1 day a week or more'</span>,<span class="st">'Daily'</span>), <span class="at">ordered =</span>T,<span class="at">trim_ws=</span>F,<span class="at">include_na =</span>F)) <span class="sc">%&gt;%</span> <span class="co">#, locale=locale(encoding = "Latin1")</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"sus_principal_mod"</span>, <span class="st">"origen_ingreso_mod"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, <span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>),<span class="sc">~</span><span class="fu">as.factor</span>(.)))<span class="sc">%&gt;%</span> </span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">via_adm_sus_prin_act=</span> <span class="fu">factor</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(via_adm_sus_prin_act<span class="sc">==</span><span class="st">"Injected Intravenously or Intramuscularly"</span><span class="sc">~</span> <span class="st">"Other"</span>,T<span class="sc">~</span>via_adm_sus_prin_act))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a><span class="co">#TO CHECK IF SOME MUNICIPALLITIES DID NOT JOIN</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::filter(is.na(porc_pobr)) %&gt;% dplyr::select(comuna_residencia_cod, anio_ing_tr)</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">con_quien_vive_joel=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Solo$"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Alone"</span>,</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con abuelos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con hermanos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con la madre </span><span class="sc">\\</span><span class="st">(sola</span><span class="sc">\\</span><span class="st">)"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con otro pariente"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>,</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"con hijos y padres o familia"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"con la pareja y padres o familia de origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"con padres o familia de origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2021-10-01</span></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Únicamente con hijos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Únicamente con pareja"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2021-10-01</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con la Pareja, Hijos y Padres o Familia de Origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Hijos y Padres o Familia de Origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2021-10-01</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Únicamente con la pareja e hijos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con amigos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>,</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con otro NO pariente"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>,</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"*Otros$"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">subset</span>(CONS_C1_df_dup_SEP_2020, dup<span class="sc">==</span><span class="dv">1</span>, <span class="fu">c</span>(<span class="st">"hash_key"</span>,<span class="st">"embarazo"</span>)), <span class="at">by=</span> <span class="st">"hash_key"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">numero_de_hijos_mod_joel=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">grepl</span>(<span class="st">"Si$"</span>,embarazo, <span class="at">ignore.case=</span>T)<span class="sc">~</span> <span class="fu">as.integer</span>(numero_de_hijos_mod<span class="sc">+</span><span class="dv">1</span>),T<span class="sc">~</span><span class="fu">as.integer</span>(numero_de_hijos_mod)))  <span class="sc">%&gt;%</span> </span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ano_nac_corr=</span> <span class="fu">as.numeric</span>(stringr<span class="sc">::</span><span class="fu">str_sub</span>(<span class="fu">as.character</span>(fech_nac_rec),<span class="dv">1</span>,<span class="dv">4</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">num_hijos_mod_joel_bin=</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(numero_de_hijos_mod_joel<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"dg_fis_otr_cond_fis_ries_vit"</span>, <span class="st">"dg_fis_pat_ges_intrau"</span>, <span class="st">"dg_fis_hep_cro"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_enf_som"</span>, <span class="st">"dg_fis_otr_cond_fis"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_ets"</span>, <span class="st">"dg_fis_card"</span>), <span class="sc">~</span><span class="fu">as.numeric</span>(.)<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dg_fis_total =</span> <span class="fu">rowSums</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(., <span class="fu">c</span>(<span class="st">"dg_fis_otr_cond_fis_ries_vit"</span>, <span class="st">"dg_fis_pat_ges_intrau"</span>, <span class="st">"dg_fis_hep_cro"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_enf_som"</span>, <span class="st">"dg_fis_otr_cond_fis"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_ets"</span>, <span class="st">"dg_fis_card"</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cnt_dg_trs_fis=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(dg_fis_total<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">~</span> <span class="st">"One or more"</span>, <span class="fu">as.character</span>(dg_fis_in_study)<span class="sc">==</span> <span class="st">"Presence"</span> <span class="sc">&amp;</span> dg_fis_total<span class="sc">==</span> <span class="dv">0</span><span class="sc">~</span><span class="st">"Diagnosis unknown (under study)"</span>, dg_fis_total<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span><span class="st">"Without physical comorbidity"</span>)) <span class="sc">%&gt;%</span> <span class="co">#janitor::tabyl(cnt_dg_trs_fis)</span></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fis_comorbidity_icd_10=</span> <span class="fu">parse_factor</span>(<span class="fu">as.character</span>(cnt_dg_trs_fis),<span class="at">levels=</span><span class="fu">c</span>(<span class="st">'Without physical comorbidity'</span>, <span class="st">'Diagnosis unknown (under study)'</span>,<span class="st">'One or more'</span>), <span class="at">ordered =</span>T,<span class="at">trim_ws=</span>F,<span class="at">include_na =</span>F)) <span class="sc">%&gt;%</span> <span class="co">#, locale=locale(encoding = "Latin1") </span></span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-31</span></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(dplyr<span class="sc">::</span><span class="fu">distinct</span>(cause_of_adm_discharge_ndp_23_2_filt,hash_key,<span class="at">.keep_all =</span> T)[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="st">"hash_key"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"date_death"</span><span class="ot">=</span><span class="st">"fecha_egreso_de_tratamiento_fmt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_at_death=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(date_death)<span class="sc">~</span></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, date_death),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_at_censor_date)) <span class="sc">%&gt;%</span></span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">event_death=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(date_death),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_  </span></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">paste0</span>(<span class="st">"otras_sus"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="st">"_mod"</span>),<span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(.<span class="sc">==</span><span class="st">"Cocaína"</span><span class="sc">~</span> <span class="st">"Cocaine hydrochloride"</span>, .<span class="sc">==</span><span class="st">"Marihuana"</span><span class="sc">~</span> <span class="st">"Marijuana"</span>, .<span class="sc">==</span><span class="st">"Otros"</span><span class="sc">~</span><span class="st">"Other"</span>, .<span class="sc">==</span><span class="st">"Pasta Base"</span><span class="sc">~</span> <span class="st">"Cocaine paste"</span>, T<span class="sc">~</span>.)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sus_principal_mod=</span> <span class="fu">as.character</span>(sus_principal_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Empty substances were replaced with the previous</span></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus3_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(otras_sus2_mod)<span class="sc">~</span> otras_sus3_mod, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus2_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(otras_sus1_mod)<span class="sc">~</span> otras_sus2_mod, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sus_principal_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus1_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(sus_principal_mod)<span class="sc">~</span> otras_sus1_mod, T<span class="sc">~</span> sus_principal_mod)) <span class="sc">%&gt;%</span>  </span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span>   </span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span>  </span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in dplyr::select(., -warning_needed): Cases with offense ages lower than age at discharge: 5,793</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Add the last variable"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-17: Rurality classification</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24<span class="sc">$</span>clas_r <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(Base_fiscalia_v14_grant_23_24<span class="sc">$</span>Clasificación), <span class="at">ref =</span> <span class="st">"Urbana"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-17: we bring Fiscalia merge5 classification</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24<span class="sc">$</span>via_adm_sus_prin_act <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(Base_fiscalia_v14_grant_23_24<span class="sc">$</span>via_adm_sus_prin_act), <span class="at">ref =</span> <span class="st">"Oral (drunk or eaten)"</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="victim-data" class="level3">
<h3 class="anchored" data-anchor-id="victim-data">Victim data</h3>
<p>We knew that our quest began with the retrieval of the <code>CONS_C1_df_dup_SEP_2020</code> (Total SENDA treatments 2010-2019) dataset from the old 8.RData. As it’s a part of the Fondecyt 1191282 project, this dataset might contain secrets we needed for our analyses. But before we could start our analysis, a new dataset named <code>data_mariel_fisc_merge4</code> emerged from the depth of the 14.RData, giving us the <code>CONS_TOP</code> (Original TOP) to proceed.</p>
<p>We made a list of crimes that threatened psychosexual integrity. The list contained grave offenses such as “ABANDONO DE NIÑOS”, “FEMICIDIO INTIMO ART. 390 BIS”, and “VIOLACIÓN CON HOMICIDIO O FEMICIDIO ART. 372 BIS.”. The classification was made considering a <a href="https://amparoyjusticia.cl/wp-content/uploads/2023/04/Estudio-Fundacion-amparo-y-Justicia.pdf">categorization</a> sourced from the Fundación Amparo y Justicia.</p>
<p>Drawing data from <code>data_mariel_fisc_merge4</code> (PO data), we zeroed in on those who had been victims to these offenses. To ensure we had a unique list of offenses, we sought distinct matters that related to the victims. The data was exported to an excel file named “offenses_victims.xlsx”.</p>
<p>The merger with <code>Base_fiscalia_v14_grant_23_24</code> left us with more revelations, especially on how many new rows had been added.</p>
<p>The objective was to get the first offense per user and count any distinct previous offenses in terms of the date and type. This was a strategic move to gauge the extent of repeat offenses against a single individual. We decided to count records of patients as victims of crimes. Finally, the dataset <code>Base_fiscalia_v15c_grant_23_24</code> would reveal some truths. How many cases dropped out? Was there a link between the events of offenses and deaths? The answers lay within the statistical tables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Retrieve CONS_C1_df_dup_SEP_2020 from previous 8.RData (Fondecyt 1191282)"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"14.Rdata"</span>, data_mariel_fisc_merge4 <span class="ot">&lt;-</span> <span class="fu">new.env</span>() )</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>CONS_TOP <span class="ot">&lt;-</span> data_mariel_fisc_merge4<span class="sc">$</span>CONS_TOP</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#offenses that threatens psychosexual integrity</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#https://amparoyjusticia.cl/wp-content/uploads/2023/04/Estudio-Fundacion-amparo-y-Justicia.pdf</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>delitos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ABANDONO DE NIÑOS"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABORTO SIN CONSENTIMIENTO"</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX C/CONTACTO CORP. A MENOR DE 14 AÑOS ART 366 BIS"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX MAYOR 14/MENOR 18 CON CIRCUNS ESTUPRO ART 366 INC2"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX MAYOR DE 14 AÑOS POR SORPRESA Y/O S/CONSENTIM. ART"</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX. S/CONTAC MAYOR 14 MENOR 18 ART 366 QUAT INC 3,4,5"</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX. S/CONTACTO CORP. MENOR 14 ART 366 QUAT. INC 1 Y 2"</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEXUAL CALIFICADO (CON OBJETOS O ANIMALES)ART.365 BIS"</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEXUAL DE MAYOR DE 14 (CON CIRC. DE VIOLACIÓN) ART 366"</span>,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ADQ. O ALMACENAMIENTO MAT.PORNOGRÁFICO INF.ART.374 BIS INC 2"</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>             <span class="st">"CASTRACIÓN Y MUTILACIÓN"</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>             <span class="st">"COMERCIALIZACIÓN MAT. PORNOGRÁFICO ELAB.UTIL. MEN.DE 18 AÑOS"</span>,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ESTUPRO"</span>,</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">"FEMICIDIO INTIMO ART. 390 BIS"</span>,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">"INDUCIR A UN MENOR A ABANDONAR EL HOGAR"</span>,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>             <span class="st">"INFANTICIDIO"</span>,</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>             <span class="st">"MALTRATO CORPORAL A PERSONAS VULNERABLES ART 403 BIS INC 1°"</span>,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OBTENCIÓN DE SERVICIOS SEXUALES DE MENORES. ART. 367 TER."</span>,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OFENSAS AL PUDOR (495 Nº 5 Código Penal)"</span>,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OTROS ABUSOS CONTRA PARTICULARES.ART. 256,257,258,259"</span>,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OTROS DEL C/ ORDEN FAMILIA, MORALIDAD Pº, INTEGRIDAD SEXUAL"</span>,</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>             <span class="st">"PRESUNTA DESGRACIA INFANTIL"</span>,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>             <span class="st">"PRODUCCIÓN MATERIAL PORNOGRÁFICO UTILIZANDO MENOR.DE 18 AÑOS"</span>,</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ROBO CON VIOLACIÓN. ART. 433 Nº1."</span>,</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SECUESTRO CON HOMICIDIO, VIOLACIÓN O LES. ART.141 INC. FINAL"</span>,</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SECUESTRO CON VIOLACIÓN"</span>,</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SODOMIA. ART. 365."</span>,</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SUSTRACCIÓN DE MENORES. ART. 142"</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TRATA DE PERSONAS PARA LA EXPLOTACIÓN SEXUAL ART 411 QUATER"</span>,</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ULTRAJE PÚBLICO A LAS BUENAS COSTUMBRES POR MED.COM.SOCIAL"</span>,</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ULTRAJE PÚBLICO A LAS BUENAS COSTUMBRES. ART. 373."</span>,</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>             <span class="st">"VIOLACIÓN DE MAYOR DE 14 AÑOS. ART. 361."</span>,</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>             <span class="st">"VIOLACIÓN DE MENOR DE 14 AÑOS. ART. 362."</span>,</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>             <span class="st">"INCESTO"</span>,</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TORTURAS COMETIDAS POR FUNCIONARIOS PÚBLICOS (150 A INC 1)"</span>,</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TORTURAS POR PARTICULARES AGENTES DEL ESTADO (150 A INC. 2)"</span>,</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TRATA PARA TRABAJOS FORZADOS Y OTROS ART411 QUATER INC1°"</span>,</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TRATOS DEGRADANTES A PERSONAS VULNERABLES. ART. 403 TER."</span>,</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>             <span class="st">"VIOLACIÓN CON HOMICIDIO O FEMICIDIO ART. 372 BIS."</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic<span class="ot">&lt;-</span> data_mariel_fisc_merge4<span class="sc">$</span>Base_fiscalia_v8 <span class="sc">%&gt;%</span> </span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(encontrado_como_victima<span class="sc">==</span><span class="st">"SI"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gls_materia <span class="sc">%in%</span> delitos)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic_distinct<span class="ot">&lt;-</span> </span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>data_mariel_fisc_merge4<span class="sc">$</span>Base_fiscalia_v8 <span class="sc">%&gt;%</span> </span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(encontrado_como_victima<span class="sc">==</span><span class="st">"SI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(gls_materia)</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic_distinct <span class="sc">%&gt;%</span> </span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"offenses_victims.xlsx"</span>)</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(data_mariel_fisc_merge4)</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a><span class="co">#cod_delito, gls_materia fec_comision_simple, relacion_vifsaf edad_comision_imp</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v9 %&gt;% </span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a><span class="co"># +     dplyr::filter(relacion_vifsaf=="SI") %&gt;% </span></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a><span class="co"># +     dplyr::distinct(crime_code_c)</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic2<span class="ot">&lt;-</span> Base_fiscalia_v8_vic <span class="sc">%&gt;%</span> </span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(rut_enc_saf, cod_delito, gls_materia, edad_comision_imp, fec_comision_simple, relacion_vifsaf, edad_comision_imp) <span class="sc">%&gt;%</span> </span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>gls_materia<span class="sc">==</span> <span class="st">"PRESUNTA DESGRACIA INFANTIL"</span>)</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a><span class="co">#1,906 individuals</span></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>  sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM Base_fiscalia_v14_grant_23_24 AS x  </span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM Base_fiscalia_v8_vic2</span></span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.rut_enc_saf AND </span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_ing_1 &gt; y.edad_comision_imp AND x.dup = 1"</span>) <span class="co">#2022-11-25  added dup // #changed the direction to past events, where age at discharge is greater than the age of commission</span></span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(</span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Rows added: "</span>, </span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nrow</span>(Base_fiscalia_v15_grant_23_24)<span class="sc">-</span> <span class="fu">nrow</span>(Base_fiscalia_v14_grant_23_24)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Rows added: 250</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"no_mostrar"</span>)){</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v15_grant_23_24) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>rut_enc_saf) <span class="sc">%&gt;%</span> </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, edad_al_ing_1,gls_materia, edad_comision_imp, fec_comision_simple_2, relacion_vifsaf_2,n) <span class="sc">%&gt;%</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">View</span>()</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">#edad_comision_imp, fec_comision_simple_2, relacion_vifsaf_2</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the first offense by user</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15b_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v15_grant_23_24) <span class="sc">%&gt;%</span> </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">with_ties=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>rut_enc_saf) <span class="sc">%&gt;%</span> </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    data.table<span class="sc">::</span><span class="fu">as.data.table</span>()</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co"># count distinct previous offenses in terms of date and type of offense</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>more_than_one_offense_as_victim<span class="ot">&lt;-</span>  </span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v15_grant_23_24) <span class="sc">%&gt;%</span> </span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">comb_prueba=</span> <span class="fu">paste0</span>(edad_comision_imp,<span class="st">"_"</span>, gls_materia)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(comb_prueba) <span class="sc">%&gt;%</span> </span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">with_ties=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>rut_enc_saf) <span class="sc">%&gt;%</span>  </span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, edad_comision_imp, gls_materia) <span class="sc">%&gt;%</span> </span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="co">#integrate the count of records as victim of patietns</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15b_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(more_than_one_offense_as_victim, <span class="at">by=</span><span class="st">"hash_key"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"n_off_vict"</span><span class="ot">=</span><span class="st">"n"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n_off_vict=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">is.na</span>(n_off_vict)<span class="sc">~</span><span class="dv">0</span>, T<span class="sc">~</span> <span class="fu">as.numeric</span>(n_off_vict))) <span class="sc">%&gt;%</span> </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>()</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cases that dropped out"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cases that dropped out</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>     janitor<span class="sc">::</span><span class="fu">tabyl</span>(event_comp, event_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> event_comp     0   1
          0 65612 158
          1 19255  23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>     janitor<span class="sc">::</span><span class="fu">tabyl</span>(event_offense, event_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> event_offense     0   1
             0 57165 158
             1 27702  23</code></pre>
</div>
</div>
</section>
<section id="top" class="level3">
<h3 class="anchored" data-anchor-id="top">TOP</h3>
<p>We divided what was done into 2 actions</p>
<p><strong>Data Processing and Standardization for Self-reported Transgression to norms</strong></p>
<p>We started by analyzing the data regarding the self-reported transgression to norms. Our objective was to standardize various variables in the Treatment Outcome Profile (TOP) dataset, particularly the dates. This involved the following steps:</p>
<ul>
<li><p>Joining the Datasets: We merged the primary dataset of TOP (<code>CONS_TOP</code>) with a subset (<code>Base_fiscalia_v15c_grant_23_24</code>) that contained unique hash keys and corrected birth dates with PO data (<code>fech_nac_rec</code>). This provided us with additional context for each entry based on their date of birth.</p></li>
<li><p>Date Parsing: We converted the <code>Fecha.Aplicación.TOP</code> field into a numeric format, ensuring there were no parsing failures.</p></li>
<li><p>Data Transformation: For transgression to norms (like Hurto, Robo, etc.), we converted the ‘S’ values to 1 and others to 0. We also calculated the total number of transgression to norms reported in the TOP for each row and then calculated the age of the individual at the time they answered the TOP questionnaire.</p></li>
<li><p>Grouping and Filtering: The data was grouped by hash key and age at application of TOP, then filtered to ensure non-missing age values. We selected the observations that had the less amount of missing values if more than one observation with the same date of TOP application and patient ID.</p></li>
</ul>
<p>The final standardized dataset, <code>CONS_TOP_2022</code>, consisted of various applications dates for different patients. This process allowed us to better understand the self-reported transgression to norms and the demographics of the individuals reporting them.</p>
<p><strong>Looking for transgression to norms Post-treatment</strong></p>
<p>Next, we focused on identifying the transgression to norms that occurred within a specific window post-treatment:</p>
<ul>
<li><p>SQL Join: We aimed to identify records where transgression to norms were reported within thirty days one month (1/12 years) to 7 months from the application of the TOP after treatment dropout. This was achieved using an SQL left join.</p></li>
<li><p>Removing Duplicate Keys: We identified and addressed cases with more than one application, ensuring that each hash key was unique and referred to a single individual. If a patient had more than one application, we discarded the application with more missing data, and then we selected the first TOP application</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Recording theft, robberies/ burglary, domestic violence and other actions committed in the last 4 weeks</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Domestic violence (physical or psychological)</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#By each TOP, thefts are reported presence/absence committed last 4 weeks ("yes"/"no"), not by quantity</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Missing dates of birth:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Missing dates of birth:</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>dateofbirth_imp))[[<span class="dv">2</span>]]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Missing dates of birth. Corrrected 2023-08-21: This field was complete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Missing dates of birth. Corrrected 2023-08-21: This field was complete</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>fech_nac_rec))[[<span class="dv">2</span>]]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>CONS_TOP_2022<span class="ot">&lt;-</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 107307</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  CONS_TOP<span class="sc">%&gt;%</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#obtain date of birth from PO database</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">subset</span>(Base_fiscalia_v15c_grant_23_24, <span class="at">select=</span><span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fech_nac_rec"</span>)), <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"HASH_KEY"</span> <span class="ot">=</span> <span class="st">"hash_key"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Format the date of top application</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fech_ap_top_num=</span> <span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(<span class="fu">str_sub</span>(<span class="fu">as.character</span>(lubridate<span class="sc">::</span><span class="fu">parse_date_time</span>(Fecha.Aplicación.TOP, <span class="fu">c</span>(<span class="st">"%Y-%m-%d"</span>),<span class="at">exact=</span>T)),<span class="dv">1</span>,<span class="dv">10</span>))))<span class="sc">%&gt;%</span> <span class="co">#No parse failures</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fech_ap_top=</span> lubridate<span class="sc">::</span><span class="fu">parse_date_time</span>(Fecha.Aplicación.TOP, <span class="fu">c</span>(<span class="st">"%Y-%m-%d"</span>),<span class="at">exact=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Select variables</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(HASH_KEY, fech_ap_top, fech_ap_top_num, Fecha.Aplicación.TOP, fech_nac_rec, Hurto, Robo, Venta.Drogas, Riña, Total.VIF, Otro) <span class="sc">%&gt;%</span> </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#transform into numeric the presence of any transgressions to norms reported</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">"Hurto"</span>, <span class="st">"Robo"</span>, <span class="st">"Venta.Drogas"</span>, <span class="st">"Riña"</span>, <span class="st">"Otro"</span>), <span class="sc">~</span><span class="fu">ifelse</span>(.<span class="sc">==</span><span class="st">"S"</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Total.VIF=</span> <span class="fu">ifelse</span>(Total.VIF<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#make a total (not a count, indicates the diversity of transgressions to the norm)</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tot_off_top =</span> base<span class="sc">::</span><span class="fu">rowSums</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(.,<span class="fu">c</span>(Hurto, Robo, Venta.Drogas, Riña, Total.VIF, Otro)), <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use PO data to transform dates of birth and age at application</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dateofbirth_imp_num=</span> <span class="fu">as.numeric</span>(fech_nac_rec),</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">edad_a_ap_top_num=</span> lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, fech_ap_top),<span class="at">unit=</span><span class="st">"years"</span>),</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">edad_b_ap_top_num=</span> (fech_ap_top_num<span class="sc">-</span>dateofbirth_imp_num)<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>fech_nac_rec, <span class="sc">-</span>dateofbirth_imp_num) <span class="sc">%&gt;%</span> </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(edad_a_ap_top_num)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2020-08-21= 24,859 applications with a valid date</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(HASH_KEY, edad_b_ap_top_num) <span class="sc">%&gt;%</span> </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">na_top_count =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(Hurto), <span class="fu">is.na</span>(Robo), <span class="fu">is.na</span>(Venta.Drogas), <span class="fu">is.na</span>(Riña), <span class="fu">is.na</span>(Total.VIF), <span class="fu">is.na</span>(Otro), <span class="at">na.rm=</span>T))<span class="sc">%&gt;%</span> </span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(HASH_KEY, edad_b_ap_top_num) <span class="sc">%&gt;%</span> </span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::slice(1) %&gt;% </span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2020-08-21= we decided now to count the row with less missing data</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(na_top_count, <span class="at">with_ties=</span>F) <span class="sc">%&gt;%</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>slice_min (grouped): removed 6,733 rows (6%), 99,364 rows remaining</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Then, we standardized the varibles in TOP (e.g., dates format) and counted self-reported transgression to norms, and also we standardized data with PO records (dates of birth) to get the age when the patient have answered TOP and the age previous [ (1/12)*365.25 ]="</span>,<span class="fu">round</span>((<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)<span class="sc">*</span><span class="fl">365.25</span>,<span class="dv">0</span>),<span class="st">" days before TOP application. This resulted in "</span>, <span class="fu">format</span>(<span class="fu">nrow</span>(CONS_TOP_2022), <span class="at">big.mark=</span><span class="st">","</span>), <span class="st">" rows (combination of different application dates and patients) of "</span>, <span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(CONS_TOP_2022<span class="sc">$</span>HASH_KEY)), <span class="at">big.mark=</span><span class="st">","</span>), <span class="st">" patients."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Then, we standardized the varibles in TOP (e.g., dates format) and counted self-reported transgression to norms, and also we standardized data with PO records (dates of birth) to get the age when the patient have answered TOP and the age previous [ (1/12)*365.25 ]=30 days before TOP application. This resulted in 99,364 rows (combination of different application dates and patients) of 36,856 patients.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-08-21= 24,798 rows (combination of different application dates and patients) of 8,698 patients.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-08-21 (after date of birth correction)=  99,364 rows (combination of different application dates and patients) of 36,856 patients.</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Given that transgression to norms are reported for the last four weeks, we added 1/12= 0.08333333 years to the event of application to have"</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15d_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT * FROM Base_fiscalia_v15c_grant_23_24 AS x  </span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM CONS_TOP_2022</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.HASH_KEY AND </span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_egres_1 + 0.08333333 &lt; y.edad_b_ap_top_num AND </span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_egres_1 + 0.58333333 &gt; y.edad_b_ap_top_num"</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15e_grant_23_24 <span class="ot">&lt;-</span> </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v15d_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>HASH_KEY)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Of the total of TOP applications (p= "</span>, <span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(CONS_TOP_2022<span class="sc">$</span>HASH_KEY)), <span class="at">big.mark=</span><span class="st">","</span>), <span class="st">"; n= "</span>,<span class="fu">format</span>(<span class="fu">nrow</span>(CONS_TOP_2022), <span class="at">big.mark=</span><span class="st">","</span>),<span class="st">"), we looked for transgression to norms reported in the period of thirty days to 7 months from the application of TOP (p= "</span>, <span class="fu">format</span>(<span class="fu">table</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v15e_grant_23_24<span class="sc">$</span>fech_ap_top))[[<span class="dv">2</span>]], <span class="at">big.mark=</span><span class="st">","</span>), <span class="st">"; "</span>, scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">table</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v15e_grant_23_24<span class="sc">$</span>fech_ap_top))[[<span class="dv">2</span>]]<span class="sc">/</span><span class="fu">nrow</span>(<span class="fu">subset</span>(Base_fiscalia_v15e_grant_23_24,anio_ing_tr <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"20"</span>,<span class="dv">15</span><span class="sc">:</span><span class="dv">19</span>) <span class="sc">&amp;</span> <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>))), <span class="at">accuracy=</span>.<span class="dv">1</span>),<span class="st">" of the database of cases between 2015-2019 and with finished treatments, n= "</span>,<span class="fu">format</span>(<span class="fu">nrow</span>(<span class="fu">subset</span>(Base_fiscalia_v15e_grant_23_24,anio_ing_tr <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"20"</span>,<span class="dv">15</span><span class="sc">:</span><span class="dv">19</span>) <span class="sc">&amp;</span> <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>))), <span class="at">big.mark=</span><span class="st">","</span>),<span class="st">"). If this database contains more records, is beacause there may be some patients that had more than one record as a result of more than one application of TOP. This will be resolved in the next step"</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Of the total of TOP applications (p= 36,856; n= 99,364), we looked for transgression to norms reported in the period of thirty days to 7 months from the application of TOP (p= 3,155; 9.0% of the database of cases between 2015-2019 and with finished treatments, n= 35,231). If this database contains more records, is beacause there may be some patients that had more than one record as a result of more than one application of TOP. This will be resolved in the next step</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Cases with more than one application (n= times)"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15e_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 85,048 rows and 2 columns, one group variable remaining (hash_key)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"HASHs with more than one application"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>HASHs with more than one application</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>vector_more_one_top_app<span class="ot">&lt;-</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v15e_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 85,048 rows and 2 columns, one group variable remaining (hash_key)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"To compare with the summarised dataset"</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15e_grant_23_24_filt<span class="ot">&lt;-</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15e_grant_23_24<span class="sc">%&gt;%</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key <span class="sc">%in%</span> vector_more_one_top_app) <span class="sc">%&gt;%</span> </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, fech_nac_rec, edad_al_egres_1, fech_egres_imp_1, <span class="st">`</span><span class="at">Fecha.Aplicación.TOP</span><span class="st">`</span>, Hurto, Robo, Venta.Drogas, Riña, Total.VIF, Otro, fech_ap_top, edad_a_ap_top_num)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15f_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15e_grant_23_24<span class="sc">%&gt;%</span> </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dplyr::filter(hash_key %in% vector_more_one_top_app) %&gt;% </span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dplyr::select(hash_key, fech_nac_rec, motivodeegreso_mod_imp, edad_al_egres_1, fech_egres_imp_1, `Fecha.Aplicación.TOP`, Hurto, Robo, Venta.Drogas, Riña, Total.VIF, Otro, fech_ap_top, edad_a_ap_top_num) %&gt;% #431</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">na_top_count =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(Hurto), <span class="fu">is.na</span>(Robo), <span class="fu">is.na</span>(Venta.Drogas), <span class="fu">is.na</span>(Riña), <span class="fu">is.na</span>(Total.VIF), <span class="fu">is.na</span>(Otro)))<span class="sc">%&gt;%</span> </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  <span class="co">#2023-08-23: 85,865</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-08-18, no longer i will use this, because we want to obtain as much as information possible</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-08-23, I rather have most pure cases, i revived the following instruction:</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#eliminate applications with less information (greater na count)</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n_top_records=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(na_top_count) <span class="sc">%&gt;%</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="co">#before 2023-08-23: 417 #before 2023-08-23: 362 after adding one month (0,83333)</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-08-23: 85,814</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-08-23: </span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dplyr::mutate(Hurto = max(Hurto, na.rm=T), Robo = max(Robo, na.rm=T), Venta.Drogas = max(Venta.Drogas, na.rm=T), Riña = max(Riña, na.rm=T), Total.VIF = sum(Total.VIF, na.rm=T), Otro = sum(Otro, na.rm=T), min_fech_ap_top= min(fech_ap_top), max_fech_ap_top= max(fech_ap_top), min_edad_a_ap_top_num= min(edad_a_ap_top_num), max_edad_a_ap_top_num= max(edad_a_ap_top_num), n_top_records=n()) %&gt;% </span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(fech_ap_top, <span class="at">with_ties=</span>F) <span class="sc">%&gt;%</span> <span class="co">#  2023-08-18: 85242 - 85048</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Fecha.Aplicación<span class="at">.TOP=</span> <span class="fu">as.Date</span>(Fecha.Aplicación.TOP)) <span class="sc">%&gt;%</span>  </span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#min_fech_ap_top= as.Date(stringi::stri_sub(as.character(min_fech_ap_top),1,10))+1, </span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#max_fech_ap_top= as.Date(stringi::stri_sub(as.character(max_fech_ap_top),1,10))+1) %&gt;% </span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::ungroup() %&gt;%  dplyr::filter(is.na(edad_al_egres_1)) %&gt;%</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To test the summarization</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::select(any_of(c("hash_key", "fech_nac_rec", "motivodeegreso_mod_imp", "edad_al_egres_1", "fech_egres_imp_1","min_fech_egres_imp_1", "min_fech_ap_top", "max_fech_ap_top", "min_edad_a_ap_top_num", "max_edad_a_ap_top_num", "n_top_records", "Fecha.Aplicación.TOP", "Hurto", "Robo", "Venta.Drogas", "Riña", "Total.VIF", "Otro", "fech_ap_top", "edad_a_ap_top_num") ))</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>fech_ap_top) <span class="sc">%&gt;%</span> </span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"date_ap_top"</span><span class="ot">=</span><span class="st">"Fecha.Aplicación.TOP"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>slice_min (grouped): removed 51 rows (&lt;1%), 85,814 rows remaining</p>
</div>
<div class="message">
<p>slice_min (grouped): removed 766 rows (1%), 85,048 rows remaining</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It is admissible that a patient could have reported one crime the last month, but after 2 months, it can be anohter crime (e.g., 6a1efd68b0f4c15706f760b215b9c1fc"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"How many birth dates were missing?, 5,528, possibly ongoing treatments. Only two were not"</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 026f81b4ffbcfe9c2fccab83cf270885</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1257b2d7deca5d747569d13ee288aaca</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 4c7781ef7fdf301ebff0b016367c4df4</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Why the delicts dont sum?"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 0a1d3531b6f494c7e075f36f09dc079c     4</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  2 2a143662d1a390c6b41d4268fbfe6113     4</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  3 6a1efd68b0f4c15706f760b215b9c1fc</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Of the total of TOP applications (p= "</span>, <span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(CONS_TOP_2022<span class="sc">$</span>HASH_KEY)), <span class="at">big.mark=</span><span class="st">","</span>), <span class="st">"; n= "</span>,<span class="fu">format</span>(<span class="fu">nrow</span>(CONS_TOP_2022), <span class="at">big.mark=</span><span class="st">","</span>),<span class="st">"), we looked for transgression to norms reported in the period of thirty days to 7 months from the application of TOP (p= "</span>, <span class="fu">format</span>(<span class="fu">table</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>date_ap_top))[[<span class="dv">2</span>]], <span class="at">big.mark=</span><span class="st">","</span>), <span class="st">"; "</span>, scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">table</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>date_ap_top))[[<span class="dv">2</span>]]<span class="sc">/</span><span class="fu">nrow</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24,ano_bd_first <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"20"</span>,<span class="dv">15</span><span class="sc">:</span><span class="dv">19</span>) <span class="sc">&amp;</span> <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>))), <span class="at">accuracy=</span>.<span class="dv">1</span>),<span class="st">" of the database of cases between 2015-2019 and with finished treatments, n= "</span>,<span class="fu">format</span>(<span class="fu">nrow</span>(<span class="fu">subset</span>(Base_fiscalia_v15f_grant_23_24,anio_ing_tr <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"20"</span>,<span class="dv">15</span><span class="sc">:</span><span class="dv">19</span>) <span class="sc">&amp;</span> <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>))), <span class="at">big.mark=</span><span class="st">","</span>),<span class="st">"). For each baseline treatment after dropout, count the number of posterior reported transgression to  norms in TOP records (those with 0s are people that did not report an offense in the period posterior to the application of TOP, from one month and 7 months after dropout)"</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Of the total of TOP applications (p= 36,856; n= 99,364), we looked for transgression to norms reported in the period of thirty days to 7 months from the application of TOP (p= 2,338; 6.1% of the database of cases between 2015-2019 and with finished treatments, n= 34,644). For each baseline treatment after dropout, count the number of posterior reported transgression to norms in TOP records (those with 0s are people that did not report an offense in the period posterior to the application of TOP, from one month and 7 months after dropout)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-08-22: changed anio_ing_tr for the previous ano_bd_first, because it gave some aberrant treatments</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ano_bd_first 6.1% of the database (...) finished treatments, n= 38,637)</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># anio_ing_tr 6.7% of the database (...) finished treatments, n= 34,644)</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2023-08-23: 6.1% of the database (...) finished treatments, n= 34,644)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 57323
[1] 7
[1] "Cases with more than one application (n= times)"
# A tibble: 3 x 1
      n
  &lt;int&gt;
1   670
2    72
3     1</code></pre>
</div>
</div>
<p>Some patients reported different crimes across multiple applications, indicating the evolving nature of their circumstances. We noticed missing birth dates in some records, possibly suggesting ongoing treatments or data entry issues. There were some inconsistencies in the reported transgression to norms. It’s crucial to further explore and understand the reasons behind these discrepancies.</p>
<p><br></p>
</section>
<section id="descriptives" class="level2">
<h2 class="anchored" data-anchor-id="descriptives">Descriptives</h2>
<p>We generated the event dates and time to events. As of August 20, 2023, we decided to discard observations of patients admitted to treatment before 2015 (TOP applications)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v16_grant_23_24<span class="ot">&lt;-</span>Base_fiscalia_v15f_grant_23_24[<span class="fu">which</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Base_fiscalia_v15f_grant_23_24<span class="sc">$</span>anio_ing_tr))<span class="sc">&gt;=</span><span class="dv">2015</span>),] <span class="co">#2022-08-22: changed anio_ing_tr for the previous ano_bd_first, because it gave some aberrant treatments</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We ended with 44,913 individuals.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Label variables"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-19</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Complete status of treatment (binary)"</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>offense_after_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Committing an offense after admission (binary)"</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>age_at_censor_date,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at censorship"</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>age_offending_imp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at offending"</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>age_tr_comp_imp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at completing tr."</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">#attr(Base_fiscalia_v16_grant_23_24$tr_modality,"label") &lt;- "Treatment Modality"</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>time_to_off_from_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to offense from admission"</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>time_to_drop_from_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to dropout from admission"</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-31</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>age_at_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at death"</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>date_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to death from admission"</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>event_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Death from admission"</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>event_comp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Event: tr.completion"</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>event_offense,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Event: offense"</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>edad_al_ing_1,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age (admission to treatment)"</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>sex,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Sex"</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>edad_ini_cons,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age of Onset of Substance Use"</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>escolaridad_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Educational Attainment"</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>sus_principal_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary Substance (admission to treatment)"</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>freq_cons_sus_prin,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Frequency of Substance Use (Primary Substance)"</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Corrected Occupational Status (f)"</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>policonsumo,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Co-occurring Substance Use Disorders (Polysubstance use)"</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="co">#20203-07-17</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>otras_sus1_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"First additional substance at admission"</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>otras_sus2_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Second additional substance at admission"</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>otras_sus3_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Third additional substance at admission"</span></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>num_hijos_mod_joel_bin,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Number of Children (dichotomized)"</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>tenencia_de_la_vivienda_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Housing Situation (Tenure Status)"</span></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>macrozona,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Macro Administrative Zone in Chile"</span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_off_vio,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Violent Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_off_acq,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Acquisitive Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_off_sud,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Substance-Related Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_off_oth,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Other Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>dg_cie_10_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Psychiatric Comorbidity (ICD-10)"</span></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>dg_trs_cons_sus_or,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"SUD Severity (Dependence status)"</span></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>clas_r,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Urbanicity"</span></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>porc_pobr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Percentage of people in poverty"</span></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>sus_ini_mod_mvv,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary Substance (initial diagnosis)"</span></span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>ano_nac_corr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Corrected birth year"</span></span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>con_quien_vive_joel,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Cohabitation status (Recoded) (f)"</span></span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>fis_comorbidity_icd_10,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Physical Comorbidity (ICD-10)"</span></span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_post_off_vio,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Violent Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_post_off_acq,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Acquisitive Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_post_off_sud,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Substance-Related Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_post_off_oth,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Other Criminal Offenses (Post-Treatment)"</span></span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_post_off,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of Post-treatment Offenses"</span></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a><span class="co"># n_post_off_vio, n_post_off_acq, n_post_off_sud, n_post_off_oth, n_post_off</span></span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Paper ACC: The items of the TOP referring to transgression to norms were adjusted to reflect the Chilean context. Shoplifting and drug selling were kept; theft from or of a vehicle, other property theft or burglary, fraud, forgery and handling stolen goods and committing assault or violence were removed; and theft, fights, number of domestic violence incidents during the last 28 days were included. with the exception of the last item (number of domestic violence incidents during the last 28 days), the other items were simplified to report any participation (yes/no) within the past 4 weeks"</span>)</span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>date_ap_top,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"TOP applicaton date"</span></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>hurto,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of TOP transgression to norms reports: theft"</span></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>robo,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of TOP transgression to norms reports: robbery"</span></span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>venta_drogas,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of TOP transgression to norms reports: drug selling"</span></span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>rina,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of TOP transgression to norms reports: fights"</span></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>total_vif,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of TOP transgression to norms reports: domestic violence"</span></span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>otro,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of TOP transgression to norms reports: other"</span></span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>tot_off_top,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of TOP transgression to norms reports: any"</span></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>edad_a_ap_top_num,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at TOP application (a)"</span></span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>edad_b_ap_top_num,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at TOP application (b)"</span></span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>na_top_count,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Count of missing TOP transgression to norms report"</span></span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-08-23</span></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a><span class="co">#attr(Base_fiscalia_v16_grant_23_24$min_fech_ap_top,"label") &lt;- "Minimum TOP applicaton date"</span></span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a><span class="co">#attr(Base_fiscalia_v16_grant_23_24$max_fech_ap_top,"label") &lt;- "Maximum TOP applicaton date"</span></span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a><span class="co">#attr(Base_fiscalia_v16_grant_23_24$min_edad_a_ap_top_num,"label") &lt;- "Minimum age at TOP application"</span></span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a><span class="co">#attr(Base_fiscalia_v16_grant_23_24$max_edad_a_ap_top_num,"label") &lt;- "Maximum age at TOP application"</span></span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v16_grant_23_24<span class="sc">$</span>n_top_records,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"TOP records between 1-7 months after dropout"</span></span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a><span class="co">#variable_names &lt;- c(  "Hurto", "Robo", "Venta.Drogas", "Riña",   "Total.VIF", "Otro", "tot_off_top", "edad_a_ap_top_num",   "edad_b_ap_top_num", "na_top_count", "min_fech_ap_top",   "max_fech_ap_top", "min_edad_a_ap_top_num",   "max_edad_a_ap_top_num", "n_top_records" )</span></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a>vars_cov <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, <span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin"</span>, <span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"policonsumo"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, <span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, <span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, <span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, <span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"age_at_death"</span>,<span class="st">"event_death"</span>, <span class="st">"n_post_off_vio"</span>, <span class="st">"n_post_off_acq"</span>, <span class="st">"n_post_off_sud"</span>, <span class="st">"n_post_off_oth"</span>, <span class="st">"n_post_off"</span>,<span class="st">"hurto"</span>, <span class="st">"robo"</span>, <span class="st">"venta_drogas"</span>, <span class="st">"rina"</span>, <span class="st">"total_vif"</span>, <span class="st">"otro"</span>, <span class="st">"tot_off_top"</span>, <span class="st">"edad_a_ap_top_num"</span>,   <span class="st">"edad_b_ap_top_num"</span>, <span class="st">"na_top_count"</span>, <span class="st">"n_top_records"</span>) <span class="co">#"min_fech_ap_top", "max_fech_ap_top", "min_edad_a_ap_top_num",   "max_edad_a_ap_top_num", </span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Function to format CreateTableOne into a database"</span>)</span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a>as.data.frame.TableOne <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {<span class="fu">capture.output</span>(<span class="fu">print</span>(x,</span>
<span id="cb58-92"><a href="#cb58-92" aria-hidden="true" tabindex="-1"></a>                          <span class="at">showAllLevels =</span> <span class="cn">TRUE</span>, <span class="at">varLabels =</span> T,...) <span class="ot">-&gt;</span> x)</span>
<span id="cb58-93"><a href="#cb58-93" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true" tabindex="-1"></a>  y<span class="sc">$</span>characteristic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="fu">rownames</span>(x), <span class="st">""</span>)</span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span></span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(characteristic, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(characteristic, <span class="fu">everything</span>())</span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(y) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true" tabindex="-1"></a>  y}</span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true" tabindex="-1"></a>tbone_desc_merge5_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb58-103"><a href="#cb58-103" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span><span class="fu">c</span>(<span class="fu">setdiff</span>(vars_cov, <span class="st">"policonsumo"</span>), <span class="st">"offense_after_adm"</span>), <span class="at">data=</span>  Base_fiscalia_v16_grant_23_24[,<span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, </span>
<span id="cb58-104"><a href="#cb58-104" aria-hidden="true" tabindex="-1"></a><span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin"</span>, </span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true" tabindex="-1"></a><span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"policonsumo"</span>, <span class="st">"otras_sus1_mod"</span>, </span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true" tabindex="-1"></a><span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, </span>
<span id="cb58-107"><a href="#cb58-107" aria-hidden="true" tabindex="-1"></a><span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, </span>
<span id="cb58-108"><a href="#cb58-108" aria-hidden="true" tabindex="-1"></a><span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, </span>
<span id="cb58-109"><a href="#cb58-109" aria-hidden="true" tabindex="-1"></a><span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, </span>
<span id="cb58-110"><a href="#cb58-110" aria-hidden="true" tabindex="-1"></a><span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, </span>
<span id="cb58-111"><a href="#cb58-111" aria-hidden="true" tabindex="-1"></a><span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"offense_after_adm"</span>,<span class="st">"age_at_death"</span>, <span class="st">"event_death"</span>,<span class="st">"n_post_off_vio"</span>, <span class="st">"n_post_off_acq"</span>, <span class="st">"n_post_off_sud"</span>, <span class="st">"n_post_off_oth"</span>, <span class="st">"n_post_off"</span>, <span class="st">"hurto"</span>, <span class="st">"robo"</span>, <span class="st">"venta_drogas"</span>, <span class="st">"rina"</span>, <span class="st">"total_vif"</span>, <span class="st">"otro"</span>, <span class="st">"tot_off_top"</span>, <span class="st">"edad_a_ap_top_num"</span>, <span class="st">"edad_b_ap_top_num"</span>, <span class="st">"na_top_count"</span>)], <span class="at">factorVars =</span> <span class="fu">setdiff</span>(vars_cov, <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"edad_al_ing_1"</span>, <span class="st">"edad_ini_cons"</span>,<span class="st">"ano_nac_corr"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, <span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"age_at_death"</span>, <span class="st">"n_post_off_vio"</span>, <span class="st">"n_post_off_acq"</span>, <span class="st">"n_post_off_sud"</span>, <span class="st">"n_post_off_oth"</span>, <span class="st">"n_post_off"</span>, <span class="st">"edad_a_ap_top_num"</span>, <span class="st">"edad_b_ap_top_num"</span>, <span class="st">"min_edad_a_ap_top_num"</span>, <span class="st">"max_edad_a_ap_top_num"</span>)), <span class="at">smd=</span>T, <span class="at">strata=</span><span class="st">"policonsumo"</span>, <span class="at">addOverall =</span> T, <span class="at">includeNA=</span>T, <span class="at">test=</span>T)</span>
<span id="cb58-112"><a href="#cb58-112" aria-hidden="true" tabindex="-1"></a><span class="co">#"min_edad_a_ap_top_num", "max_edad_a_ap_top_num"</span></span>
<span id="cb58-113"><a href="#cb58-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-114"><a href="#cb58-114" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb58-115"><a href="#cb58-115" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb58-116"><a href="#cb58-116" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Contrast people in and out of study"</span>)</span>
<span id="cb58-117"><a href="#cb58-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-118"><a href="#cb58-118" aria-hidden="true" tabindex="-1"></a>tbone_desc_merge52_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb58-119"><a href="#cb58-119" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span><span class="fu">c</span>(<span class="fu">setdiff</span>(vars_cov, <span class="st">"policonsumo"</span>), <span class="st">"offense_after_adm"</span>), <span class="at">data=</span>  Base_fiscalia_v16_grant_23_24[,<span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, </span>
<span id="cb58-120"><a href="#cb58-120" aria-hidden="true" tabindex="-1"></a><span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin"</span>, </span>
<span id="cb58-121"><a href="#cb58-121" aria-hidden="true" tabindex="-1"></a><span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"policonsumo"</span>, <span class="st">"otras_sus1_mod"</span>, </span>
<span id="cb58-122"><a href="#cb58-122" aria-hidden="true" tabindex="-1"></a><span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, </span>
<span id="cb58-123"><a href="#cb58-123" aria-hidden="true" tabindex="-1"></a><span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, </span>
<span id="cb58-124"><a href="#cb58-124" aria-hidden="true" tabindex="-1"></a><span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, </span>
<span id="cb58-125"><a href="#cb58-125" aria-hidden="true" tabindex="-1"></a><span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, </span>
<span id="cb58-126"><a href="#cb58-126" aria-hidden="true" tabindex="-1"></a><span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, </span>
<span id="cb58-127"><a href="#cb58-127" aria-hidden="true" tabindex="-1"></a><span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"offense_after_adm"</span>,<span class="st">"age_at_death"</span>, <span class="st">"event_death"</span>,<span class="st">"n_post_off_vio"</span>, <span class="st">"n_post_off_acq"</span>, <span class="st">"n_post_off_sud"</span>, <span class="st">"n_post_off_oth"</span>, <span class="st">"n_post_off"</span>, <span class="st">"hurto"</span>, <span class="st">"robo"</span>, <span class="st">"venta_drogas"</span>, <span class="st">"rina"</span>, <span class="st">"total_vif"</span>, <span class="st">"otro"</span>, <span class="st">"tot_off_top"</span>, <span class="st">"edad_a_ap_top_num"</span>, <span class="st">"edad_b_ap_top_num"</span>, <span class="st">"na_top_count"</span>, <span class="st">"motivodeegreso_mod_imp_1"</span>, <span class="st">"date_ap_top"</span>)] <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">in_study=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>( <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(date_ap_top)<span class="sc">~</span><span class="dv">1</span>,T<span class="sc">~</span><span class="dv">0</span>)), <span class="at">factorVars =</span> <span class="fu">setdiff</span>(vars_cov, <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"edad_al_ing_1"</span>, <span class="st">"edad_ini_cons"</span>,<span class="st">"ano_nac_corr"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, <span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"age_at_death"</span>, <span class="st">"n_post_off_vio"</span>, <span class="st">"n_post_off_acq"</span>, <span class="st">"n_post_off_sud"</span>, <span class="st">"n_post_off_oth"</span>, <span class="st">"n_post_off"</span>, <span class="st">"edad_a_ap_top_num"</span>, <span class="st">"edad_b_ap_top_num"</span>)), <span class="at">smd=</span>T, <span class="at">strata=</span><span class="st">"in_study"</span>, <span class="at">addOverall =</span> T, <span class="at">includeNA=</span>T, <span class="at">test=</span>T)</span>
<span id="cb58-128"><a href="#cb58-128" aria-hidden="true" tabindex="-1"></a><span class="co">#, "min_edad_a_ap_top_num", "max_edad_a_ap_top_num"</span></span>
<span id="cb58-129"><a href="#cb58-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-130"><a href="#cb58-130" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb58-131"><a href="#cb58-131" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb58-132"><a href="#cb58-132" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Restrict comparison to only people in study"</span>)</span>
<span id="cb58-133"><a href="#cb58-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-134"><a href="#cb58-134" aria-hidden="true" tabindex="-1"></a>tbone_desc_merge5_grant_23_24_in_study<span class="ot">&lt;-</span></span>
<span id="cb58-135"><a href="#cb58-135" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span><span class="fu">c</span>(<span class="fu">setdiff</span>(vars_cov, <span class="st">"policonsumo"</span>), <span class="st">"offense_after_adm"</span>), <span class="at">data=</span>  Base_fiscalia_v16_grant_23_24[,<span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, </span>
<span id="cb58-136"><a href="#cb58-136" aria-hidden="true" tabindex="-1"></a><span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin"</span>, </span>
<span id="cb58-137"><a href="#cb58-137" aria-hidden="true" tabindex="-1"></a><span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"policonsumo"</span>, <span class="st">"otras_sus1_mod"</span>, </span>
<span id="cb58-138"><a href="#cb58-138" aria-hidden="true" tabindex="-1"></a><span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, </span>
<span id="cb58-139"><a href="#cb58-139" aria-hidden="true" tabindex="-1"></a><span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, </span>
<span id="cb58-140"><a href="#cb58-140" aria-hidden="true" tabindex="-1"></a><span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, </span>
<span id="cb58-141"><a href="#cb58-141" aria-hidden="true" tabindex="-1"></a><span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, </span>
<span id="cb58-142"><a href="#cb58-142" aria-hidden="true" tabindex="-1"></a><span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, </span>
<span id="cb58-143"><a href="#cb58-143" aria-hidden="true" tabindex="-1"></a><span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"offense_after_adm"</span>,<span class="st">"age_at_death"</span>, <span class="st">"event_death"</span>,<span class="st">"n_post_off_vio"</span>, <span class="st">"n_post_off_acq"</span>, <span class="st">"n_post_off_sud"</span>, <span class="st">"n_post_off_oth"</span>, <span class="st">"n_post_off"</span>, <span class="st">"hurto"</span>, <span class="st">"robo"</span>, <span class="st">"venta_drogas"</span>, <span class="st">"rina"</span>, <span class="st">"total_vif"</span>, <span class="st">"otro"</span>, <span class="st">"tot_off_top"</span>, <span class="st">"edad_a_ap_top_num"</span>, <span class="st">"edad_b_ap_top_num"</span>, <span class="st">"na_top_count"</span>, <span class="st">"motivodeegreso_mod_imp_1"</span>, <span class="st">"date_ap_top"</span>)] <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">in_study=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>( <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(date_ap_top)<span class="sc">~</span><span class="dv">1</span>,T<span class="sc">~</span><span class="dv">0</span>))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(in_study<span class="sc">==</span><span class="dv">1</span>), <span class="at">factorVars =</span> <span class="fu">setdiff</span>(vars_cov, <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"edad_al_ing_1"</span>, <span class="st">"edad_ini_cons"</span>,<span class="st">"ano_nac_corr"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, <span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"age_at_death"</span>, <span class="st">"n_post_off_vio"</span>, <span class="st">"n_post_off_acq"</span>, <span class="st">"n_post_off_sud"</span>, <span class="st">"n_post_off_oth"</span>, <span class="st">"n_post_off"</span>, <span class="st">"edad_a_ap_top_num"</span>, <span class="st">"edad_b_ap_top_num"</span>)), <span class="at">smd=</span>T, <span class="at">strata=</span><span class="st">"policonsumo"</span>, <span class="at">addOverall =</span> T, <span class="at">includeNA=</span>T, <span class="at">test=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>We compared the characteristics of people who used multiple substances and those who did not in the total database between 2015 and 2019.</li>
</ul>
<div class="center-table">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge5_grant_23_24, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,T<span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance(1) and no Polysubstance use (0)"</span>, <span class="at">escape=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 87 values (64%) of ‘characteristic’ (87 fewer NA)</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Summary descriptives, Polysubstance(1) and no Polysubstance use (0)</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">characteristic</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>n</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>44913</strong></td>
<td style="text-align: left;"><strong>15111</strong></td>
<td style="text-align: left;"><strong>29802</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment completion</td>
<td style="text-align: left;">10114 (22.5)</td>
<td style="text-align: left;">4373 ( 28.9)</td>
<td style="text-align: left;">5741 (19.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.228</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: left;">34798 (77.5)</td>
<td style="text-align: left;">10738 ( 71.1)</td>
<td style="text-align: left;">24060 (80.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age (admission to treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">35.14 [27.84, 44.73]</td>
<td style="text-align: left;">43.03 [33.35, 52.30]</td>
<td style="text-align: left;">32.59 [26.48, 39.98]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.817</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Men</td>
<td style="text-align: left;">33852 (75.4)</td>
<td style="text-align: left;">11179 ( 74.0)</td>
<td style="text-align: left;">22673 (76.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.049</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Women</td>
<td style="text-align: left;">11061 (24.6)</td>
<td style="text-align: left;">3932 ( 26.0)</td>
<td style="text-align: left;">7129 (23.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Age of Onset of Substance Use (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">15.00 [14.00, 18.00]</td>
<td style="text-align: left;">16.00 [14.00, 20.00]</td>
<td style="text-align: left;">15.00 [13.00, 17.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.443</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">1-More than high school</td>
<td style="text-align: left;">8046 (17.9)</td>
<td style="text-align: left;">2331 ( 15.4)</td>
<td style="text-align: left;">5715 (19.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.258</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">2-Completed high school or less</td>
<td style="text-align: left;">24390 (54.3)</td>
<td style="text-align: left;">7416 ( 49.1)</td>
<td style="text-align: left;">16974 (57.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">3-Completed primary school or less</td>
<td style="text-align: left;">12276 (27.3)</td>
<td style="text-align: left;">5268 ( 34.9)</td>
<td style="text-align: left;">7008 (23.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">201 ( 0.4)</td>
<td style="text-align: left;">96 ( 0.6)</td>
<td style="text-align: left;">105 ( 0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">17284 (38.5)</td>
<td style="text-align: left;">10375 ( 68.7)</td>
<td style="text-align: left;">6909 (23.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.042</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">9630 (21.4)</td>
<td style="text-align: left;">1613 ( 10.7)</td>
<td style="text-align: left;">8017 (26.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">14699 (32.7)</td>
<td style="text-align: left;">2258 ( 14.9)</td>
<td style="text-align: left;">12441 (41.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">2590 ( 5.8)</td>
<td style="text-align: left;">635 ( 4.2)</td>
<td style="text-align: left;">1955 ( 6.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">709 ( 1.6)</td>
<td style="text-align: left;">229 ( 1.5)</td>
<td style="text-align: left;">480 ( 1.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">1 day a week or more</td>
<td style="text-align: left;">3091 ( 6.9)</td>
<td style="text-align: left;">1246 ( 8.2)</td>
<td style="text-align: left;">1845 ( 6.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.171</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">2 to 3 days a week</td>
<td style="text-align: left;">12480 (27.8)</td>
<td style="text-align: left;">4544 ( 30.1)</td>
<td style="text-align: left;">7936 (26.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">4 to 6 days a week</td>
<td style="text-align: left;">7367 (16.4)</td>
<td style="text-align: left;">2442 ( 16.2)</td>
<td style="text-align: left;">4925 (16.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Daily</td>
<td style="text-align: left;">19467 (43.3)</td>
<td style="text-align: left;">5835 ( 38.6)</td>
<td style="text-align: left;">13632 (45.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Less than 1 day a week</td>
<td style="text-align: left;">2324 ( 5.2)</td>
<td style="text-align: left;">978 ( 6.5)</td>
<td style="text-align: left;">1346 ( 4.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">184 ( 0.4)</td>
<td style="text-align: left;">66 ( 0.4)</td>
<td style="text-align: left;">118 ( 0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Employed</td>
<td style="text-align: left;">22549 (50.2)</td>
<td style="text-align: left;">8725 ( 57.7)</td>
<td style="text-align: left;">13824 (46.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.340</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Inactive</td>
<td style="text-align: left;">4361 ( 9.7)</td>
<td style="text-align: left;">1924 ( 12.7)</td>
<td style="text-align: left;">2437 ( 8.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Looking for a job for the first time</td>
<td style="text-align: left;">86 ( 0.2)</td>
<td style="text-align: left;">23 ( 0.2)</td>
<td style="text-align: left;">63 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">No activity</td>
<td style="text-align: left;">2805 ( 6.2)</td>
<td style="text-align: left;">671 ( 4.4)</td>
<td style="text-align: left;">2134 ( 7.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Not seeking for work</td>
<td style="text-align: left;">375 ( 0.8)</td>
<td style="text-align: left;">87 ( 0.6)</td>
<td style="text-align: left;">288 ( 1.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Unemployed</td>
<td style="text-align: left;">14736 (32.8)</td>
<td style="text-align: left;">3680 ( 24.4)</td>
<td style="text-align: left;">11056 (37.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">11983 (26.7)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">11982 (40.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">31.004</td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">5415 (12.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">5415 (18.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">2128 ( 4.7)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">2127 ( 7.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">9280 (20.7)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">9279 (31.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">949 ( 2.1)</td>
<td style="text-align: left;">2 ( 0.0)</td>
<td style="text-align: left;">947 ( 3.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">15158 (33.7)</td>
<td style="text-align: left;">15106 (100.0)</td>
<td style="text-align: left;">52 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">4809 (10.7)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">4809 (16.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.468</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">2839 ( 6.3)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">2839 ( 9.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">1078 ( 2.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1078 ( 3.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">5833 (13.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">5833 (19.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">900 ( 2.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">900 ( 3.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">29454 (65.6)</td>
<td style="text-align: left;">15111 (100.0)</td>
<td style="text-align: left;">14343 (48.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">10488 (23.4)</td>
<td style="text-align: left;">2824 ( 18.7)</td>
<td style="text-align: left;">7664 (25.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.170</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">33994 (75.7)</td>
<td style="text-align: left;">12140 ( 80.3)</td>
<td style="text-align: left;">21854 (73.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">431 ( 1.0)</td>
<td style="text-align: left;">147 ( 1.0)</td>
<td style="text-align: left;">284 ( 1.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Illegal Settlement</td>
<td style="text-align: left;">532 ( 1.2)</td>
<td style="text-align: left;">145 ( 1.0)</td>
<td style="text-align: left;">387 ( 1.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.291</td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">1118 ( 2.5)</td>
<td style="text-align: left;">396 ( 2.6)</td>
<td style="text-align: left;">722 ( 2.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Owner/Transferred dwellings/Pays Dividends</td>
<td style="text-align: left;">16200 (36.1)</td>
<td style="text-align: left;">6716 ( 44.4)</td>
<td style="text-align: left;">9484 (31.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Renting</td>
<td style="text-align: left;">7595 (16.9)</td>
<td style="text-align: left;">2581 ( 17.1)</td>
<td style="text-align: left;">5014 (16.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Stays temporarily with a relative</td>
<td style="text-align: left;">17697 (39.4)</td>
<td style="text-align: left;">4740 ( 31.4)</td>
<td style="text-align: left;">12957 (43.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1771 ( 3.9)</td>
<td style="text-align: left;">533 ( 3.5)</td>
<td style="text-align: left;">1238 ( 4.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">Center</td>
<td style="text-align: left;">33673 (75.0)</td>
<td style="text-align: left;">10899 ( 72.1)</td>
<td style="text-align: left;">22774 (76.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.295</td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">North</td>
<td style="text-align: left;">6259 (13.9)</td>
<td style="text-align: left;">1628 ( 10.8)</td>
<td style="text-align: left;">4631 (15.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">4981 (11.1)</td>
<td style="text-align: left;">2584 ( 17.1)</td>
<td style="text-align: left;">2397 ( 8.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35914 (80.0)</td>
<td style="text-align: left;">12555 ( 83.1)</td>
<td style="text-align: left;">23359 (78.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.119</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">8999 (20.0)</td>
<td style="text-align: left;">2556 ( 16.9)</td>
<td style="text-align: left;">6443 (21.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35791 (79.7)</td>
<td style="text-align: left;">13283 ( 87.9)</td>
<td style="text-align: left;">22508 (75.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.324</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">9122 (20.3)</td>
<td style="text-align: left;">1828 ( 12.1)</td>
<td style="text-align: left;">7294 (24.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35870 (79.9)</td>
<td style="text-align: left;">12990 ( 86.0)</td>
<td style="text-align: left;">22880 (76.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.238</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">9043 (20.1)</td>
<td style="text-align: left;">2121 ( 14.0)</td>
<td style="text-align: left;">6922 (23.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35875 (79.9)</td>
<td style="text-align: left;">12680 ( 83.9)</td>
<td style="text-align: left;">23195 (77.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.155</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">9038 (20.1)</td>
<td style="text-align: left;">2431 ( 16.1)</td>
<td style="text-align: left;">6607 (22.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without psychiatric comorbidity</td>
<td style="text-align: left;">16999 (37.8)</td>
<td style="text-align: left;">6729 ( 44.5)</td>
<td style="text-align: left;">10270 (34.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.216</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">8563 (19.1)</td>
<td style="text-align: left;">2362 ( 15.6)</td>
<td style="text-align: left;">6201 (20.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">With psychiatric comorbidity</td>
<td style="text-align: left;">19351 (43.1)</td>
<td style="text-align: left;">6020 ( 39.8)</td>
<td style="text-align: left;">13331 (44.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Drug dependence</td>
<td style="text-align: left;">31459 (70.0)</td>
<td style="text-align: left;">9108 ( 60.3)</td>
<td style="text-align: left;">22351 (75.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.319</td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Hazardous consumption</td>
<td style="text-align: left;">13453 (30.0)</td>
<td style="text-align: left;">6002 ( 39.7)</td>
<td style="text-align: left;">7451 (25.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Mixta</td>
<td style="text-align: left;">5232 (11.6)</td>
<td style="text-align: left;">2130 ( 14.1)</td>
<td style="text-align: left;">3102 (10.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.262</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">4723 (10.5)</td>
<td style="text-align: left;">2286 ( 15.1)</td>
<td style="text-align: left;">2437 ( 8.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Urbana</td>
<td style="text-align: left;">34958 (77.8)</td>
<td style="text-align: left;">10695 ( 70.8)</td>
<td style="text-align: left;">24263 (81.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Percentage of people in poverty (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.09 [0.06, 0.12]</td>
<td style="text-align: left;">0.09 [0.06, 0.13]</td>
<td style="text-align: left;">0.09 [0.06, 0.12]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.187</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">27611 (61.5)</td>
<td style="text-align: left;">11325 ( 74.9)</td>
<td style="text-align: left;">16286 (54.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.549</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">1886 ( 4.2)</td>
<td style="text-align: left;">654 ( 4.3)</td>
<td style="text-align: left;">1232 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">1866 ( 4.2)</td>
<td style="text-align: left;">704 ( 4.7)</td>
<td style="text-align: left;">1162 ( 3.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">12219 (27.2)</td>
<td style="text-align: left;">1913 ( 12.7)</td>
<td style="text-align: left;">10306 (34.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1046 ( 2.3)</td>
<td style="text-align: left;">322 ( 2.1)</td>
<td style="text-align: left;">724 ( 2.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">285 ( 0.6)</td>
<td style="text-align: left;">193 ( 1.3)</td>
<td style="text-align: left;">92 ( 0.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected birth year (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1982.00 [1972.00, 1989.00]</td>
<td style="text-align: left;">1974.00 [1964.00, 1983.00]</td>
<td style="text-align: left;">1984.00 [1977.00, 1990.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.813</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Alone</td>
<td style="text-align: left;">4532 (10.1)</td>
<td style="text-align: left;">1996 ( 13.2)</td>
<td style="text-align: left;">2536 ( 8.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.365</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Family of origin</td>
<td style="text-align: left;">18386 (40.9)</td>
<td style="text-align: left;">4540 ( 30.0)</td>
<td style="text-align: left;">13846 (46.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">3863 ( 8.6)</td>
<td style="text-align: left;">1213 ( 8.0)</td>
<td style="text-align: left;">2650 ( 8.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">With couple/children</td>
<td style="text-align: left;">18131 (40.4)</td>
<td style="text-align: left;">7361 ( 48.7)</td>
<td style="text-align: left;">10770 (36.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without physical comorbidity</td>
<td style="text-align: left;">16198 (36.1)</td>
<td style="text-align: left;">5103 ( 33.8)</td>
<td style="text-align: left;">11095 (37.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.107</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">25785 (57.4)</td>
<td style="text-align: left;">8789 ( 58.2)</td>
<td style="text-align: left;">16996 (57.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">One or more</td>
<td style="text-align: left;">2930 ( 6.5)</td>
<td style="text-align: left;">1219 ( 8.1)</td>
<td style="text-align: left;">1711 ( 5.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Time to offense from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.99 [0.90, 3.30]</td>
<td style="text-align: left;">2.22 [1.05, 3.49]</td>
<td style="text-align: left;">1.85 [0.83, 3.20]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.168</td>
</tr>
<tr class="even">
<td style="text-align: left;">Time to dropout from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.45 [1.26, 3.68]</td>
<td style="text-align: left;">2.52 [1.30, 3.72]</td>
<td style="text-align: left;">2.41 [1.23, 3.67]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.044</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at censorship (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.79 [30.45, 47.31]</td>
<td style="text-align: left;">45.66 [35.92, 54.92]</td>
<td style="text-align: left;">35.19 [29.04, 42.59]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.814</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at completing tr. (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.40 [30.07, 46.87]</td>
<td style="text-align: left;">45.14 [35.51, 54.28]</td>
<td style="text-align: left;">34.85 [28.69, 42.17]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.803</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at offending (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.34 [29.91, 47.03]</td>
<td style="text-align: left;">45.38 [35.55, 54.77]</td>
<td style="text-align: left;">34.70 [28.45, 42.19]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.821</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at death (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.79 [30.45, 47.31]</td>
<td style="text-align: left;">45.64 [35.92, 54.91]</td>
<td style="text-align: left;">35.19 [29.04, 42.59]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.813</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">44769 (99.7)</td>
<td style="text-align: left;">15022 ( 99.4)</td>
<td style="text-align: left;">29747 (99.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.065</td>
</tr>
<tr class="even">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">144 ( 0.3)</td>
<td style="text-align: left;">89 ( 0.6)</td>
<td style="text-align: left;">55 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Violent Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.110</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of Acquisitive Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.144</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Substance-Related Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.088</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of Other Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.114</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Post-treatment Offenses (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.190</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1802 ( 4.0)</td>
<td style="text-align: left;">536 ( 3.5)</td>
<td style="text-align: left;">1266 ( 4.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.070</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">195 ( 0.4)</td>
<td style="text-align: left;">29 ( 0.2)</td>
<td style="text-align: left;">166 ( 0.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42916 (95.6)</td>
<td style="text-align: left;">14546 ( 96.3)</td>
<td style="text-align: left;">28370 (95.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1883 ( 4.2)</td>
<td style="text-align: left;">549 ( 3.6)</td>
<td style="text-align: left;">1334 ( 4.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.065</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">114 ( 0.3)</td>
<td style="text-align: left;">16 ( 0.1)</td>
<td style="text-align: left;">98 ( 0.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42916 (95.6)</td>
<td style="text-align: left;">14546 ( 96.3)</td>
<td style="text-align: left;">28370 (95.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1926 ( 4.3)</td>
<td style="text-align: left;">558 ( 3.7)</td>
<td style="text-align: left;">1368 ( 4.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">71 ( 0.2)</td>
<td style="text-align: left;">7 ( 0.0)</td>
<td style="text-align: left;">64 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42916 (95.6)</td>
<td style="text-align: left;">14546 ( 96.3)</td>
<td style="text-align: left;">28370 (95.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1808 ( 4.0)</td>
<td style="text-align: left;">541 ( 3.6)</td>
<td style="text-align: left;">1267 ( 4.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">190 ( 0.4)</td>
<td style="text-align: left;">24 ( 0.2)</td>
<td style="text-align: left;">166 ( 0.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42915 (95.6)</td>
<td style="text-align: left;">14546 ( 96.3)</td>
<td style="text-align: left;">28369 (95.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1769 ( 3.9)</td>
<td style="text-align: left;">519 ( 3.4)</td>
<td style="text-align: left;">1250 ( 4.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.057</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">301 ( 0.7)</td>
<td style="text-align: left;">70 ( 0.5)</td>
<td style="text-align: left;">231 ( 0.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42843 (95.4)</td>
<td style="text-align: left;">14522 ( 96.1)</td>
<td style="text-align: left;">28321 (95.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1905 ( 4.2)</td>
<td style="text-align: left;">542 ( 3.6)</td>
<td style="text-align: left;">1363 ( 4.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.053</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">79 ( 0.2)</td>
<td style="text-align: left;">20 ( 0.1)</td>
<td style="text-align: left;">59 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42929 (95.6)</td>
<td style="text-align: left;">14549 ( 96.3)</td>
<td style="text-align: left;">28380 (95.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1499 ( 3.3)</td>
<td style="text-align: left;">468 ( 3.1)</td>
<td style="text-align: left;">1031 ( 3.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">359 ( 0.8)</td>
<td style="text-align: left;">99 ( 0.7)</td>
<td style="text-align: left;">260 ( 0.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">132 ( 0.3)</td>
<td style="text-align: left;">20 ( 0.1)</td>
<td style="text-align: left;">112 ( 0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">59 ( 0.1)</td>
<td style="text-align: left;">6 ( 0.0)</td>
<td style="text-align: left;">53 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">25 ( 0.1)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">24 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">10 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">9 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42829 (95.4)</td>
<td style="text-align: left;">14516 ( 96.1)</td>
<td style="text-align: left;">28313 (95.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at TOP application (a) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.74 [28.28, 43.59]</td>
<td style="text-align: left;">42.55 [34.09, 52.10]</td>
<td style="text-align: left;">32.78 [26.75, 39.24]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.893</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at TOP application (b) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.74 [28.28, 43.59]</td>
<td style="text-align: left;">42.55 [34.09, 52.10]</td>
<td style="text-align: left;">32.78 [26.75, 39.24]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.893</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1979 ( 4.4)</td>
<td style="text-align: left;">560 ( 3.7)</td>
<td style="text-align: left;">1419 ( 4.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.054</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">17 ( 0.0)</td>
<td style="text-align: left;">5 ( 0.0)</td>
<td style="text-align: left;">12 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">5 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">4 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">70 ( 0.2)</td>
<td style="text-align: left;">24 ( 0.2)</td>
<td style="text-align: left;">46 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">42841 (95.4)</td>
<td style="text-align: left;">14521 ( 96.1)</td>
<td style="text-align: left;">28320 (95.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">no offense after admission</td>
<td style="text-align: left;">36236 (80.7)</td>
<td style="text-align: left;">13073 ( 86.5)</td>
<td style="text-align: left;">23163 (77.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.231</td>
</tr>
<tr class="even">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">offender after adm</td>
<td style="text-align: left;">8677 (19.3)</td>
<td style="text-align: left;">2038 ( 13.5)</td>
<td style="text-align: left;">6639 (22.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(size=10, format="html",caption= "Summary descriptives, by Baseline Treatment Status") %&gt;%     kableExtra::kable_classic()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<ul>
<li>Contrasting patients in study (no ongoing or referred treatments outside SENDAs network [n= 34,644] and with TOP applications after treatment [n= 1,730]) vs.&nbsp;all people in SENDA between 2015-2019 (n= 44913).</li>
</ul>
<div class="center-table">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge52_grant_23_24, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,T<span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Inside study(1) outside study (0)"</span>, <span class="at">escape=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 87 values (64%) of ‘characteristic’ (87 fewer NA)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(size=10, format="html",caption= "Summary descriptives, by Baseline Treatment Status") %&gt;%     kableExtra::kable_classic()</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SMD&gt;0.20</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Primary Substance (admission to treatment) </span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Count of TOP transgression to norms reports: any # --&gt; is too high but not infinite because the rest of the database still contains a few cases with ongoing treatments of referrals</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Count of missing TOP transgression to norms report # --&gt; is too high but not infinite because the rest of the database still contains a few cases with ongoing treatments of referrals</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Corrected Occupational Status</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Primary Substance (initial diagnosis)</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Time to dropout from admission (median [IQR])</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#SMD&gt;0.15</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co">#treatment completion</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#sex</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Frequency of Substance Use (Primary Substance) </span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Committing an offense after admission (binary) # it not longer can be used</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co">#SMD &gt;0.2</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co">#sus_ini_mod_mvv</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co">#sus_principal_mod </span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="co">#condicion_ocupacional_corr </span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co">#tot_off_top</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co">#SMD 0.11-0.19</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="co">#motivodeegreso_mod_imp_rec </span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="co">#escolaridad_rec  </span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="co">#freq_cons_sus_prin </span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="co">#dg_cie_10_rec </span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co">#dg_trs_cons_sus_or </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Summary descriptives, Inside study(1) outside study (0)</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">characteristic</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>n</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>44913</strong></td>
<td style="text-align: left;"><strong>43183</strong></td>
<td style="text-align: left;"><strong>1730</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment completion</td>
<td style="text-align: left;">10114 (22.5)</td>
<td style="text-align: left;">9615 (22.3)</td>
<td style="text-align: left;">499 (28.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: left;">34798 (77.5)</td>
<td style="text-align: left;">33567 (77.7)</td>
<td style="text-align: left;">1231 (71.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age (admission to treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">35.14 [27.84, 44.73]</td>
<td style="text-align: left;">35.19 [27.86, 44.79]</td>
<td style="text-align: left;">33.92 [27.50, 42.80]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.111</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Men</td>
<td style="text-align: left;">33852 (75.4)</td>
<td style="text-align: left;">32667 (75.6)</td>
<td style="text-align: left;">1185 (68.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.160</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Women</td>
<td style="text-align: left;">11061 (24.6)</td>
<td style="text-align: left;">10516 (24.4)</td>
<td style="text-align: left;">545 (31.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Age of Onset of Substance Use (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">15.00 [14.00, 18.00]</td>
<td style="text-align: left;">15.00 [14.00, 18.00]</td>
<td style="text-align: left;">15.00 [14.00, 17.00]</td>
<td style="text-align: left;">0.094</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">1-More than high school</td>
<td style="text-align: left;">8046 (17.9)</td>
<td style="text-align: left;">7805 (18.1)</td>
<td style="text-align: left;">241 (13.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.134</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">2-Completed high school or less</td>
<td style="text-align: left;">24390 (54.3)</td>
<td style="text-align: left;">23436 (54.3)</td>
<td style="text-align: left;">954 (55.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">3-Completed primary school or less</td>
<td style="text-align: left;">12276 (27.3)</td>
<td style="text-align: left;">11744 (27.2)</td>
<td style="text-align: left;">532 (30.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">201 ( 0.4)</td>
<td style="text-align: left;">198 ( 0.5)</td>
<td style="text-align: left;">3 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">17284 (38.5)</td>
<td style="text-align: left;">16759 (38.8)</td>
<td style="text-align: left;">525 (30.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.243</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">9630 (21.4)</td>
<td style="text-align: left;">9246 (21.4)</td>
<td style="text-align: left;">384 (22.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">14699 (32.7)</td>
<td style="text-align: left;">13968 (32.3)</td>
<td style="text-align: left;">731 (42.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">2590 ( 5.8)</td>
<td style="text-align: left;">2528 ( 5.9)</td>
<td style="text-align: left;">62 ( 3.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">709 ( 1.6)</td>
<td style="text-align: left;">681 ( 1.6)</td>
<td style="text-align: left;">28 ( 1.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">1 day a week or more</td>
<td style="text-align: left;">3091 ( 6.9)</td>
<td style="text-align: left;">2985 ( 6.9)</td>
<td style="text-align: left;">106 ( 6.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.159</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">2 to 3 days a week</td>
<td style="text-align: left;">12480 (27.8)</td>
<td style="text-align: left;">12089 (28.0)</td>
<td style="text-align: left;">391 (22.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">4 to 6 days a week</td>
<td style="text-align: left;">7367 (16.4)</td>
<td style="text-align: left;">7092 (16.4)</td>
<td style="text-align: left;">275 (15.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Daily</td>
<td style="text-align: left;">19467 (43.3)</td>
<td style="text-align: left;">18595 (43.1)</td>
<td style="text-align: left;">872 (50.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Less than 1 day a week</td>
<td style="text-align: left;">2324 ( 5.2)</td>
<td style="text-align: left;">2246 ( 5.2)</td>
<td style="text-align: left;">78 ( 4.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">184 ( 0.4)</td>
<td style="text-align: left;">176 ( 0.4)</td>
<td style="text-align: left;">8 ( 0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Employed</td>
<td style="text-align: left;">22549 (50.2)</td>
<td style="text-align: left;">21833 (50.6)</td>
<td style="text-align: left;">716 (41.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.213</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Inactive</td>
<td style="text-align: left;">4361 ( 9.7)</td>
<td style="text-align: left;">4190 ( 9.7)</td>
<td style="text-align: left;">171 ( 9.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Looking for a job for the first time</td>
<td style="text-align: left;">86 ( 0.2)</td>
<td style="text-align: left;">85 ( 0.2)</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">No activity</td>
<td style="text-align: left;">2805 ( 6.2)</td>
<td style="text-align: left;">2643 ( 6.1)</td>
<td style="text-align: left;">162 ( 9.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Not seeking for work</td>
<td style="text-align: left;">375 ( 0.8)</td>
<td style="text-align: left;">350 ( 0.8)</td>
<td style="text-align: left;">25 ( 1.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Unemployed</td>
<td style="text-align: left;">14736 (32.8)</td>
<td style="text-align: left;">14081 (32.6)</td>
<td style="text-align: left;">655 (37.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">11983 (26.7)</td>
<td style="text-align: left;">11484 (26.6)</td>
<td style="text-align: left;">499 (28.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.116</td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">5415 (12.1)</td>
<td style="text-align: left;">5209 (12.1)</td>
<td style="text-align: left;">206 (11.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">2128 ( 4.7)</td>
<td style="text-align: left;">2047 ( 4.7)</td>
<td style="text-align: left;">81 ( 4.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">9280 (20.7)</td>
<td style="text-align: left;">8887 (20.6)</td>
<td style="text-align: left;">393 (22.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">949 ( 2.1)</td>
<td style="text-align: left;">901 ( 2.1)</td>
<td style="text-align: left;">48 ( 2.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">15158 (33.7)</td>
<td style="text-align: left;">14655 (33.9)</td>
<td style="text-align: left;">503 (29.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">4809 (10.7)</td>
<td style="text-align: left;">4583 (10.6)</td>
<td style="text-align: left;">226 (13.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">2839 ( 6.3)</td>
<td style="text-align: left;">2711 ( 6.3)</td>
<td style="text-align: left;">128 ( 7.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">1078 ( 2.4)</td>
<td style="text-align: left;">1037 ( 2.4)</td>
<td style="text-align: left;">41 ( 2.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">5833 (13.0)</td>
<td style="text-align: left;">5562 (12.9)</td>
<td style="text-align: left;">271 (15.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">900 ( 2.0)</td>
<td style="text-align: left;">859 ( 2.0)</td>
<td style="text-align: left;">41 ( 2.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">29454 (65.6)</td>
<td style="text-align: left;">28431 (65.8)</td>
<td style="text-align: left;">1023 (59.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">10488 (23.4)</td>
<td style="text-align: left;">10103 (23.4)</td>
<td style="text-align: left;">385 (22.3)</td>
<td style="text-align: left;">0.046</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">33994 (75.7)</td>
<td style="text-align: left;">32657 (75.6)</td>
<td style="text-align: left;">1337 (77.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">431 ( 1.0)</td>
<td style="text-align: left;">423 ( 1.0)</td>
<td style="text-align: left;">8 ( 0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Illegal Settlement</td>
<td style="text-align: left;">532 ( 1.2)</td>
<td style="text-align: left;">507 ( 1.2)</td>
<td style="text-align: left;">25 ( 1.4)</td>
<td style="text-align: left;">0.072</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.080</td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">1118 ( 2.5)</td>
<td style="text-align: left;">1072 ( 2.5)</td>
<td style="text-align: left;">46 ( 2.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Owner/Transferred dwellings/Pays Dividends</td>
<td style="text-align: left;">16200 (36.1)</td>
<td style="text-align: left;">15570 (36.1)</td>
<td style="text-align: left;">630 (36.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Renting</td>
<td style="text-align: left;">7595 (16.9)</td>
<td style="text-align: left;">7348 (17.0)</td>
<td style="text-align: left;">247 (14.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Stays temporarily with a relative</td>
<td style="text-align: left;">17697 (39.4)</td>
<td style="text-align: left;">16985 (39.3)</td>
<td style="text-align: left;">712 (41.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1771 ( 3.9)</td>
<td style="text-align: left;">1701 ( 3.9)</td>
<td style="text-align: left;">70 ( 4.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">Center</td>
<td style="text-align: left;">33673 (75.0)</td>
<td style="text-align: left;">32378 (75.0)</td>
<td style="text-align: left;">1295 (74.9)</td>
<td style="text-align: left;">0.030</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.065</td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">North</td>
<td style="text-align: left;">6259 (13.9)</td>
<td style="text-align: left;">5990 (13.9)</td>
<td style="text-align: left;">269 (15.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">4981 (11.1)</td>
<td style="text-align: left;">4815 (11.2)</td>
<td style="text-align: left;">166 ( 9.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35914 (80.0)</td>
<td style="text-align: left;">34520 (79.9)</td>
<td style="text-align: left;">1394 (80.6)</td>
<td style="text-align: left;">0.535</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.016</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">8999 (20.0)</td>
<td style="text-align: left;">8663 (20.1)</td>
<td style="text-align: left;">336 (19.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35791 (79.7)</td>
<td style="text-align: left;">34433 (79.7)</td>
<td style="text-align: left;">1358 (78.5)</td>
<td style="text-align: left;">0.220</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">9122 (20.3)</td>
<td style="text-align: left;">8750 (20.3)</td>
<td style="text-align: left;">372 (21.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35870 (79.9)</td>
<td style="text-align: left;">34520 (79.9)</td>
<td style="text-align: left;">1350 (78.0)</td>
<td style="text-align: left;">0.057</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.047</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">9043 (20.1)</td>
<td style="text-align: left;">8663 (20.1)</td>
<td style="text-align: left;">380 (22.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">35875 (79.9)</td>
<td style="text-align: left;">34489 (79.9)</td>
<td style="text-align: left;">1386 (80.1)</td>
<td style="text-align: left;">0.824</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">9038 (20.1)</td>
<td style="text-align: left;">8694 (20.1)</td>
<td style="text-align: left;">344 (19.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without psychiatric comorbidity</td>
<td style="text-align: left;">16999 (37.8)</td>
<td style="text-align: left;">16451 (38.1)</td>
<td style="text-align: left;">548 (31.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.139</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">8563 (19.1)</td>
<td style="text-align: left;">8221 (19.0)</td>
<td style="text-align: left;">342 (19.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">With psychiatric comorbidity</td>
<td style="text-align: left;">19351 (43.1)</td>
<td style="text-align: left;">18511 (42.9)</td>
<td style="text-align: left;">840 (48.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Drug dependence</td>
<td style="text-align: left;">31459 (70.0)</td>
<td style="text-align: left;">30149 (69.8)</td>
<td style="text-align: left;">1310 (75.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.133</td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Hazardous consumption</td>
<td style="text-align: left;">13453 (30.0)</td>
<td style="text-align: left;">13033 (30.2)</td>
<td style="text-align: left;">420 (24.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Mixta</td>
<td style="text-align: left;">5232 (11.6)</td>
<td style="text-align: left;">5026 (11.6)</td>
<td style="text-align: left;">206 (11.9)</td>
<td style="text-align: left;">0.025</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">4723 (10.5)</td>
<td style="text-align: left;">4575 (10.6)</td>
<td style="text-align: left;">148 ( 8.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Urbana</td>
<td style="text-align: left;">34958 (77.8)</td>
<td style="text-align: left;">33582 (77.8)</td>
<td style="text-align: left;">1376 (79.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Percentage of people in poverty (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.09 [0.06, 0.12]</td>
<td style="text-align: left;">0.09 [0.06, 0.12]</td>
<td style="text-align: left;">0.09 [0.06, 0.12]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.070</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">27611 (61.5)</td>
<td style="text-align: left;">26685 (61.8)</td>
<td style="text-align: left;">926 (53.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.222</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">1886 ( 4.2)</td>
<td style="text-align: left;">1793 ( 4.2)</td>
<td style="text-align: left;">93 ( 5.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">1866 ( 4.2)</td>
<td style="text-align: left;">1743 ( 4.0)</td>
<td style="text-align: left;">123 ( 7.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">12219 (27.2)</td>
<td style="text-align: left;">11674 (27.0)</td>
<td style="text-align: left;">545 (31.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1046 ( 2.3)</td>
<td style="text-align: left;">1004 ( 2.3)</td>
<td style="text-align: left;">42 ( 2.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">285 ( 0.6)</td>
<td style="text-align: left;">284 ( 0.7)</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected birth year (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1982.00 [1972.00, 1989.00]</td>
<td style="text-align: left;">1982.00 [1972.00, 1989.00]</td>
<td style="text-align: left;">1982.00 [1973.00, 1989.00]</td>
<td style="text-align: left;">0.024</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.070</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Alone</td>
<td style="text-align: left;">4532 (10.1)</td>
<td style="text-align: left;">4352 (10.1)</td>
<td style="text-align: left;">180 (10.4)</td>
<td style="text-align: left;">0.305</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.054</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Family of origin</td>
<td style="text-align: left;">18386 (40.9)</td>
<td style="text-align: left;">17653 (40.9)</td>
<td style="text-align: left;">733 (42.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">3863 ( 8.6)</td>
<td style="text-align: left;">3702 ( 8.6)</td>
<td style="text-align: left;">161 ( 9.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">With couple/children</td>
<td style="text-align: left;">18131 (40.4)</td>
<td style="text-align: left;">17475 (40.5)</td>
<td style="text-align: left;">656 (37.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without physical comorbidity</td>
<td style="text-align: left;">16198 (36.1)</td>
<td style="text-align: left;">15604 (36.1)</td>
<td style="text-align: left;">594 (34.3)</td>
<td style="text-align: left;">0.286</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">25785 (57.4)</td>
<td style="text-align: left;">24769 (57.4)</td>
<td style="text-align: left;">1016 (58.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">One or more</td>
<td style="text-align: left;">2930 ( 6.5)</td>
<td style="text-align: left;">2810 ( 6.5)</td>
<td style="text-align: left;">120 ( 6.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Time to offense from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.99 [0.90, 3.30]</td>
<td style="text-align: left;">1.97 [0.87, 3.29]</td>
<td style="text-align: left;">2.41 [1.35, 3.52]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.215</td>
</tr>
<tr class="even">
<td style="text-align: left;">Time to dropout from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.45 [1.26, 3.68]</td>
<td style="text-align: left;">2.42 [1.23, 3.67]</td>
<td style="text-align: left;">2.86 [1.82, 3.93]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.293</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at censorship (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.79 [30.45, 47.31]</td>
<td style="text-align: left;">37.83 [30.44, 47.37]</td>
<td style="text-align: left;">37.09 [30.67, 45.95]</td>
<td style="text-align: left;">0.024</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.071</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at completing tr. (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.40 [30.07, 46.87]</td>
<td style="text-align: left;">37.43 [30.07, 46.93]</td>
<td style="text-align: left;">36.65 [29.89, 45.25]</td>
<td style="text-align: left;">0.004</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.087</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at offending (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.34 [29.91, 47.03]</td>
<td style="text-align: left;">37.38 [29.91, 47.09]</td>
<td style="text-align: left;">36.58 [29.85, 45.39]</td>
<td style="text-align: left;">0.006</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.083</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at death (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.79 [30.45, 47.31]</td>
<td style="text-align: left;">37.83 [30.44, 47.37]</td>
<td style="text-align: left;">37.09 [30.67, 45.95]</td>
<td style="text-align: left;">0.025</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.071</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">44769 (99.7)</td>
<td style="text-align: left;">43041 (99.7)</td>
<td style="text-align: left;">1728 (99.9)</td>
<td style="text-align: left;">0.186</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.045</td>
</tr>
<tr class="even">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">144 ( 0.3)</td>
<td style="text-align: left;">142 ( 0.3)</td>
<td style="text-align: left;">2 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Violent Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.090</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of Acquisitive Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.080</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Substance-Related Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.067</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of Other Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.037</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Post-treatment Offenses (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.115</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1802 ( 4.0)</td>
<td style="text-align: left;">298 ( 0.7)</td>
<td style="text-align: left;">1504 (86.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">5.861</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">195 ( 0.4)</td>
<td style="text-align: left;">49 ( 0.1)</td>
<td style="text-align: left;">146 ( 8.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42916 (95.6)</td>
<td style="text-align: left;">42836 (99.2)</td>
<td style="text-align: left;">80 ( 4.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1883 ( 4.2)</td>
<td style="text-align: left;">317 ( 0.7)</td>
<td style="text-align: left;">1566 (90.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">5.861</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">114 ( 0.3)</td>
<td style="text-align: left;">30 ( 0.1)</td>
<td style="text-align: left;">84 ( 4.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42916 (95.6)</td>
<td style="text-align: left;">42836 (99.2)</td>
<td style="text-align: left;">80 ( 4.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1926 ( 4.3)</td>
<td style="text-align: left;">333 ( 0.8)</td>
<td style="text-align: left;">1593 (92.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">5.861</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">71 ( 0.2)</td>
<td style="text-align: left;">14 ( 0.0)</td>
<td style="text-align: left;">57 ( 3.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42916 (95.6)</td>
<td style="text-align: left;">42836 (99.2)</td>
<td style="text-align: left;">80 ( 4.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1808 ( 4.0)</td>
<td style="text-align: left;">309 ( 0.7)</td>
<td style="text-align: left;">1499 (86.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">5.894</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">190 ( 0.4)</td>
<td style="text-align: left;">38 ( 0.1)</td>
<td style="text-align: left;">152 ( 8.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42915 (95.6)</td>
<td style="text-align: left;">42836 (99.2)</td>
<td style="text-align: left;">79 ( 4.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1769 ( 3.9)</td>
<td style="text-align: left;">308 ( 0.7)</td>
<td style="text-align: left;">1461 (84.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">11.383</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">301 ( 0.7)</td>
<td style="text-align: left;">44 ( 0.1)</td>
<td style="text-align: left;">257 (14.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42843 (95.4)</td>
<td style="text-align: left;">42831 (99.2)</td>
<td style="text-align: left;">12 ( 0.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1905 ( 4.2)</td>
<td style="text-align: left;">333 ( 0.8)</td>
<td style="text-align: left;">1572 (90.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">5.557</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">79 ( 0.2)</td>
<td style="text-align: left;">11 ( 0.0)</td>
<td style="text-align: left;">68 ( 3.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42929 (95.6)</td>
<td style="text-align: left;">42839 (99.2)</td>
<td style="text-align: left;">90 ( 5.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1499 ( 3.3)</td>
<td style="text-align: left;">248 ( 0.6)</td>
<td style="text-align: left;">1251 (72.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">15.558</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">359 ( 0.8)</td>
<td style="text-align: left;">56 ( 0.1)</td>
<td style="text-align: left;">303 (17.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">132 ( 0.3)</td>
<td style="text-align: left;">27 ( 0.1)</td>
<td style="text-align: left;">105 ( 6.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">59 ( 0.1)</td>
<td style="text-align: left;">18 ( 0.0)</td>
<td style="text-align: left;">41 ( 2.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">25 ( 0.1)</td>
<td style="text-align: left;">3 ( 0.0)</td>
<td style="text-align: left;">22 ( 1.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">10 ( 0.0)</td>
<td style="text-align: left;">2 ( 0.0)</td>
<td style="text-align: left;">8 ( 0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">42829 (95.4)</td>
<td style="text-align: left;">42829 (99.2)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at TOP application (a) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.74 [28.28, 43.59]</td>
<td style="text-align: left;">34.35 [27.89, 43.30]</td>
<td style="text-align: left;">34.86 [28.37, 43.79]</td>
<td style="text-align: left;">0.552</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.024</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at TOP application (b) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.74 [28.28, 43.59]</td>
<td style="text-align: left;">34.34 [27.89, 43.30]</td>
<td style="text-align: left;">34.86 [28.37, 43.79]</td>
<td style="text-align: left;">0.552</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1979 ( 4.4)</td>
<td style="text-align: left;">344 ( 0.8)</td>
<td style="text-align: left;">1635 (94.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">11.858</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">17 ( 0.0)</td>
<td style="text-align: left;">3 ( 0.0)</td>
<td style="text-align: left;">14 ( 0.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">5 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">5 ( 0.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">70 ( 0.2)</td>
<td style="text-align: left;">5 ( 0.0)</td>
<td style="text-align: left;">65 ( 3.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">42841 (95.4)</td>
<td style="text-align: left;">42831 (99.2)</td>
<td style="text-align: left;">10 ( 0.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">no offense after admission</td>
<td style="text-align: left;">36236 (80.7)</td>
<td style="text-align: left;">34944 (80.9)</td>
<td style="text-align: left;">1292 (74.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.151</td>
</tr>
<tr class="even">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">offender after adm</td>
<td style="text-align: left;">8677 (19.3)</td>
<td style="text-align: left;">8239 (19.1)</td>
<td style="text-align: left;">438 (25.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ul>
<li>Selected patients in study and contrasted those patients with and without polysubstance use at admission.</li>
</ul>
<div class="center-table">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge5_grant_23_24_in_study, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,T<span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance use(1) no polysubstance use (0)"</span>, <span class="at">escape=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 81 values (62%) of ‘characteristic’ (81 fewer NA)</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Summary descriptives, Polysubstance use(1) no polysubstance use (0)</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">characteristic</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>n</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>1730</strong></td>
<td style="text-align: left;"><strong>500</strong></td>
<td style="text-align: left;"><strong>1230</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment completion</td>
<td style="text-align: left;">499 (28.8)</td>
<td style="text-align: left;">178 ( 35.6)</td>
<td style="text-align: left;">321 ( 26.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.207</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: left;">1231 (71.2)</td>
<td style="text-align: left;">322 ( 64.4)</td>
<td style="text-align: left;">909 ( 73.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Age (admission to treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">33.92 [27.50, 42.80]</td>
<td style="text-align: left;">41.81 [33.61, 51.28]</td>
<td style="text-align: left;">31.92 [26.10, 38.25]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.909</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Men</td>
<td style="text-align: left;">1185 (68.5)</td>
<td style="text-align: left;">331 ( 66.2)</td>
<td style="text-align: left;">854 ( 69.4)</td>
<td style="text-align: left;">0.210</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Women</td>
<td style="text-align: left;">545 (31.5)</td>
<td style="text-align: left;">169 ( 33.8)</td>
<td style="text-align: left;">376 ( 30.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age of Onset of Substance Use (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">15.00 [14.00, 17.00]</td>
<td style="text-align: left;">16.00 [14.00, 20.00]</td>
<td style="text-align: left;">15.00 [13.00, 16.25]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.424</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">1-More than high school</td>
<td style="text-align: left;">241 (13.9)</td>
<td style="text-align: left;">64 ( 12.8)</td>
<td style="text-align: left;">177 ( 14.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.255</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">2-Completed high school or less</td>
<td style="text-align: left;">954 (55.1)</td>
<td style="text-align: left;">240 ( 48.0)</td>
<td style="text-align: left;">714 ( 58.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">3-Completed primary school or less</td>
<td style="text-align: left;">532 (30.8)</td>
<td style="text-align: left;">194 ( 38.8)</td>
<td style="text-align: left;">338 ( 27.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">3 ( 0.2)</td>
<td style="text-align: left;">2 ( 0.4)</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">525 (30.3)</td>
<td style="text-align: left;">305 ( 61.0)</td>
<td style="text-align: left;">220 ( 17.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.999</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">384 (22.2)</td>
<td style="text-align: left;">56 ( 11.2)</td>
<td style="text-align: left;">328 ( 26.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">731 (42.3)</td>
<td style="text-align: left;">117 ( 23.4)</td>
<td style="text-align: left;">614 ( 49.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">62 ( 3.6)</td>
<td style="text-align: left;">18 ( 3.6)</td>
<td style="text-align: left;">44 ( 3.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">28 ( 1.6)</td>
<td style="text-align: left;">4 ( 0.8)</td>
<td style="text-align: left;">24 ( 2.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">1 day a week or more</td>
<td style="text-align: left;">106 ( 6.1)</td>
<td style="text-align: left;">42 ( 8.4)</td>
<td style="text-align: left;">64 ( 5.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.280</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">2 to 3 days a week</td>
<td style="text-align: left;">391 (22.6)</td>
<td style="text-align: left;">128 ( 25.6)</td>
<td style="text-align: left;">263 ( 21.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">4 to 6 days a week</td>
<td style="text-align: left;">275 (15.9)</td>
<td style="text-align: left;">85 ( 17.0)</td>
<td style="text-align: left;">190 ( 15.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Daily</td>
<td style="text-align: left;">872 (50.4)</td>
<td style="text-align: left;">208 ( 41.6)</td>
<td style="text-align: left;">664 ( 54.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Less than 1 day a week</td>
<td style="text-align: left;">78 ( 4.5)</td>
<td style="text-align: left;">34 ( 6.8)</td>
<td style="text-align: left;">44 ( 3.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">8 ( 0.5)</td>
<td style="text-align: left;">3 ( 0.6)</td>
<td style="text-align: left;">5 ( 0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Employed</td>
<td style="text-align: left;">716 (41.4)</td>
<td style="text-align: left;">245 ( 49.0)</td>
<td style="text-align: left;">471 ( 38.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.426</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Inactive</td>
<td style="text-align: left;">171 ( 9.9)</td>
<td style="text-align: left;">78 ( 15.6)</td>
<td style="text-align: left;">93 ( 7.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Looking for a job for the first time</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">No activity</td>
<td style="text-align: left;">162 ( 9.4)</td>
<td style="text-align: left;">30 ( 6.0)</td>
<td style="text-align: left;">132 ( 10.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Not seeking for work</td>
<td style="text-align: left;">25 ( 1.4)</td>
<td style="text-align: left;">2 ( 0.4)</td>
<td style="text-align: left;">23 ( 1.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Unemployed</td>
<td style="text-align: left;">655 (37.9)</td>
<td style="text-align: left;">145 ( 29.0)</td>
<td style="text-align: left;">510 ( 41.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">499 (28.8)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">499 ( 40.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">28.601</td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">206 (11.9)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">206 ( 16.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">81 ( 4.7)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">81 ( 6.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">393 (22.7)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">393 ( 32.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">48 ( 2.8)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">48 ( 3.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">503 (29.1)</td>
<td style="text-align: left;">500 (100.0)</td>
<td style="text-align: left;">3 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">226 (13.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">226 ( 18.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.644</td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">128 ( 7.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">128 ( 10.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">41 ( 2.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">41 ( 3.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">271 (15.7)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">271 ( 22.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">41 ( 2.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">41 ( 3.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1023 (59.1)</td>
<td style="text-align: left;">500 (100.0)</td>
<td style="text-align: left;">523 ( 42.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">385 (22.3)</td>
<td style="text-align: left;">96 ( 19.2)</td>
<td style="text-align: left;">289 ( 23.5)</td>
<td style="text-align: left;">0.143</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.106</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1337 (77.3)</td>
<td style="text-align: left;">402 ( 80.4)</td>
<td style="text-align: left;">935 ( 76.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">8 ( 0.5)</td>
<td style="text-align: left;">2 ( 0.4)</td>
<td style="text-align: left;">6 ( 0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Illegal Settlement</td>
<td style="text-align: left;">25 ( 1.4)</td>
<td style="text-align: left;">5 ( 1.0)</td>
<td style="text-align: left;">20 ( 1.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.301</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">46 ( 2.7)</td>
<td style="text-align: left;">13 ( 2.6)</td>
<td style="text-align: left;">33 ( 2.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Owner/Transferred dwellings/Pays Dividends</td>
<td style="text-align: left;">630 (36.4)</td>
<td style="text-align: left;">226 ( 45.2)</td>
<td style="text-align: left;">404 ( 32.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Renting</td>
<td style="text-align: left;">247 (14.3)</td>
<td style="text-align: left;">76 ( 15.2)</td>
<td style="text-align: left;">171 ( 13.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Stays temporarily with a relative</td>
<td style="text-align: left;">712 (41.2)</td>
<td style="text-align: left;">159 ( 31.8)</td>
<td style="text-align: left;">553 ( 45.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">70 ( 4.0)</td>
<td style="text-align: left;">21 ( 4.2)</td>
<td style="text-align: left;">49 ( 4.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">Center</td>
<td style="text-align: left;">1295 (74.9)</td>
<td style="text-align: left;">350 ( 70.0)</td>
<td style="text-align: left;">945 ( 76.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.286</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">North</td>
<td style="text-align: left;">269 (15.5)</td>
<td style="text-align: left;">70 ( 14.0)</td>
<td style="text-align: left;">199 ( 16.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">166 ( 9.6)</td>
<td style="text-align: left;">80 ( 16.0)</td>
<td style="text-align: left;">86 ( 7.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1394 (80.6)</td>
<td style="text-align: left;">424 ( 84.8)</td>
<td style="text-align: left;">970 ( 78.9)</td>
<td style="text-align: left;">0.006</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.154</td>
</tr>
<tr class="even">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">336 (19.4)</td>
<td style="text-align: left;">76 ( 15.2)</td>
<td style="text-align: left;">260 ( 21.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1358 (78.5)</td>
<td style="text-align: left;">434 ( 86.8)</td>
<td style="text-align: left;">924 ( 75.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.301</td>
</tr>
<tr class="even">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">372 (21.5)</td>
<td style="text-align: left;">66 ( 13.2)</td>
<td style="text-align: left;">306 ( 24.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1350 (78.0)</td>
<td style="text-align: left;">422 ( 84.4)</td>
<td style="text-align: left;">928 ( 75.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.225</td>
</tr>
<tr class="even">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">380 (22.0)</td>
<td style="text-align: left;">78 ( 15.6)</td>
<td style="text-align: left;">302 ( 24.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1386 (80.1)</td>
<td style="text-align: left;">413 ( 82.6)</td>
<td style="text-align: left;">973 ( 79.1)</td>
<td style="text-align: left;">0.113</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.089</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">344 (19.9)</td>
<td style="text-align: left;">87 ( 17.4)</td>
<td style="text-align: left;">257 ( 20.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without psychiatric comorbidity</td>
<td style="text-align: left;">548 (31.7)</td>
<td style="text-align: left;">203 ( 40.6)</td>
<td style="text-align: left;">345 ( 28.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.277</td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">342 (19.8)</td>
<td style="text-align: left;">77 ( 15.4)</td>
<td style="text-align: left;">265 ( 21.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">With psychiatric comorbidity</td>
<td style="text-align: left;">840 (48.6)</td>
<td style="text-align: left;">220 ( 44.0)</td>
<td style="text-align: left;">620 ( 50.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Drug dependence</td>
<td style="text-align: left;">1310 (75.7)</td>
<td style="text-align: left;">331 ( 66.2)</td>
<td style="text-align: left;">979 ( 79.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.305</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Hazardous consumption</td>
<td style="text-align: left;">420 (24.3)</td>
<td style="text-align: left;">169 ( 33.8)</td>
<td style="text-align: left;">251 ( 20.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Mixta</td>
<td style="text-align: left;">206 (11.9)</td>
<td style="text-align: left;">58 ( 11.6)</td>
<td style="text-align: left;">148 ( 12.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.202</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">148 ( 8.6)</td>
<td style="text-align: left;">64 ( 12.8)</td>
<td style="text-align: left;">84 ( 6.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Urbana</td>
<td style="text-align: left;">1376 (79.5)</td>
<td style="text-align: left;">378 ( 75.6)</td>
<td style="text-align: left;">998 ( 81.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Percentage of people in poverty (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.09 [0.06, 0.12]</td>
<td style="text-align: left;">0.08 [0.05, 0.13]</td>
<td style="text-align: left;">0.09 [0.06, 0.12]</td>
<td style="text-align: left;">0.760</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.081</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">926 (53.5)</td>
<td style="text-align: left;">360 ( 72.0)</td>
<td style="text-align: left;">566 ( 46.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.650</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">93 ( 5.4)</td>
<td style="text-align: left;">17 ( 3.4)</td>
<td style="text-align: left;">76 ( 6.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">123 ( 7.1)</td>
<td style="text-align: left;">44 ( 8.8)</td>
<td style="text-align: left;">79 ( 6.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">545 (31.5)</td>
<td style="text-align: left;">68 ( 13.6)</td>
<td style="text-align: left;">477 ( 38.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">42 ( 2.4)</td>
<td style="text-align: left;">11 ( 2.2)</td>
<td style="text-align: left;">31 ( 2.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected birth year (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1982.00 [1973.00, 1989.00]</td>
<td style="text-align: left;">1974.00 [1965.00, 1983.00]</td>
<td style="text-align: left;">1984.00 [1978.00, 1990.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.907</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Alone</td>
<td style="text-align: left;">180 (10.4)</td>
<td style="text-align: left;">68 ( 13.6)</td>
<td style="text-align: left;">112 ( 9.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.353</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Family of origin</td>
<td style="text-align: left;">733 (42.4)</td>
<td style="text-align: left;">155 ( 31.0)</td>
<td style="text-align: left;">578 ( 47.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">161 ( 9.3)</td>
<td style="text-align: left;">44 ( 8.8)</td>
<td style="text-align: left;">117 ( 9.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">With couple/children</td>
<td style="text-align: left;">656 (37.9)</td>
<td style="text-align: left;">233 ( 46.6)</td>
<td style="text-align: left;">423 ( 34.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without physical comorbidity</td>
<td style="text-align: left;">594 (34.3)</td>
<td style="text-align: left;">159 ( 31.8)</td>
<td style="text-align: left;">435 ( 35.4)</td>
<td style="text-align: left;">0.038</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.131</td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">1016 (58.7)</td>
<td style="text-align: left;">295 ( 59.0)</td>
<td style="text-align: left;">721 ( 58.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">One or more</td>
<td style="text-align: left;">120 ( 6.9)</td>
<td style="text-align: left;">46 ( 9.2)</td>
<td style="text-align: left;">74 ( 6.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Time to offense from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.41 [1.35, 3.52]</td>
<td style="text-align: left;">2.61 [1.58, 3.76]</td>
<td style="text-align: left;">2.32 [1.24, 3.40]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.208</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Time to dropout from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.86 [1.82, 3.93]</td>
<td style="text-align: left;">3.01 [1.94, 3.99]</td>
<td style="text-align: left;">2.82 [1.80, 3.91]</td>
<td style="text-align: left;">0.136</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.088</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at censorship (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.09 [30.67, 45.95]</td>
<td style="text-align: left;">45.04 [36.77, 54.11]</td>
<td style="text-align: left;">34.98 [29.06, 41.24]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.908</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at completing tr. (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">36.65 [29.89, 45.25]</td>
<td style="text-align: left;">44.39 [36.31, 53.13]</td>
<td style="text-align: left;">34.39 [28.65, 40.47]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.904</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at offending (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">36.58 [29.85, 45.39]</td>
<td style="text-align: left;">44.58 [36.40, 54.09]</td>
<td style="text-align: left;">34.26 [28.40, 40.59]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at death (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.09 [30.67, 45.95]</td>
<td style="text-align: left;">45.04 [36.77, 54.11]</td>
<td style="text-align: left;">34.98 [29.06, 41.24]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.907</td>
</tr>
<tr class="even">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1728 (99.9)</td>
<td style="text-align: left;">498 ( 99.6)</td>
<td style="text-align: left;">1230 (100.0)</td>
<td style="text-align: left;">0.150</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.090</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2 ( 0.1)</td>
<td style="text-align: left;">2 ( 0.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of Violent Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.186</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Acquisitive Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.137</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of Substance-Related Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.130</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.090</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of Other Criminal Offenses (Post-Treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.588</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.034</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of Post-treatment Offenses (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">0.00 [0.00, 0.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.178</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1504 (86.9)</td>
<td style="text-align: left;">450 ( 90.0)</td>
<td style="text-align: left;">1054 ( 85.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.241</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">146 ( 8.4)</td>
<td style="text-align: left;">21 ( 4.2)</td>
<td style="text-align: left;">125 ( 10.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: theft (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">80 ( 4.6)</td>
<td style="text-align: left;">29 ( 5.8)</td>
<td style="text-align: left;">51 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1566 (90.5)</td>
<td style="text-align: left;">460 ( 92.0)</td>
<td style="text-align: left;">1106 ( 89.9)</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.202</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">84 ( 4.9)</td>
<td style="text-align: left;">11 ( 2.2)</td>
<td style="text-align: left;">73 ( 5.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: robbery (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">80 ( 4.6)</td>
<td style="text-align: left;">29 ( 5.8)</td>
<td style="text-align: left;">51 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1593 (92.1)</td>
<td style="text-align: left;">465 ( 93.0)</td>
<td style="text-align: left;">1128 ( 91.7)</td>
<td style="text-align: left;">0.003</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.196</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">57 ( 3.3)</td>
<td style="text-align: left;">6 ( 1.2)</td>
<td style="text-align: left;">51 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: drug selling (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">80 ( 4.6)</td>
<td style="text-align: left;">29 ( 5.8)</td>
<td style="text-align: left;">51 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1499 (86.6)</td>
<td style="text-align: left;">452 ( 90.4)</td>
<td style="text-align: left;">1047 ( 85.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.279</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">152 ( 8.8)</td>
<td style="text-align: left;">19 ( 3.8)</td>
<td style="text-align: left;">133 ( 10.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: fights (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">79 ( 4.6)</td>
<td style="text-align: left;">29 ( 5.8)</td>
<td style="text-align: left;">50 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1461 (84.5)</td>
<td style="text-align: left;">433 ( 86.6)</td>
<td style="text-align: left;">1028 ( 83.6)</td>
<td style="text-align: left;">0.042</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.131</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">257 (14.9)</td>
<td style="text-align: left;">61 ( 12.2)</td>
<td style="text-align: left;">196 ( 15.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: domestic violence (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">12 ( 0.7)</td>
<td style="text-align: left;">6 ( 1.2)</td>
<td style="text-align: left;">6 ( 0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1572 (90.9)</td>
<td style="text-align: left;">449 ( 89.8)</td>
<td style="text-align: left;">1123 ( 91.3)</td>
<td style="text-align: left;">0.357</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.074</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">68 ( 3.9)</td>
<td style="text-align: left;">19 ( 3.8)</td>
<td style="text-align: left;">49 ( 4.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: other (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">90 ( 5.2)</td>
<td style="text-align: left;">32 ( 6.4)</td>
<td style="text-align: left;">58 ( 4.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1251 (72.3)</td>
<td style="text-align: left;">393 ( 78.6)</td>
<td style="text-align: left;">858 ( 69.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.321</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">303 (17.5)</td>
<td style="text-align: left;">85 ( 17.0)</td>
<td style="text-align: left;">218 ( 17.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">105 ( 6.1)</td>
<td style="text-align: left;">16 ( 3.2)</td>
<td style="text-align: left;">89 ( 7.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">41 ( 2.4)</td>
<td style="text-align: left;">5 ( 1.0)</td>
<td style="text-align: left;">36 ( 2.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">22 ( 1.3)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">22 ( 1.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of TOP transgression to norms reports: any (%)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">8 ( 0.5)</td>
<td style="text-align: left;">1 ( 0.2)</td>
<td style="text-align: left;">7 ( 0.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at TOP application (a) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.86 [28.37, 43.79]</td>
<td style="text-align: left;">42.59 [34.17, 52.43]</td>
<td style="text-align: left;">32.81 [27.06, 39.17]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.909</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at TOP application (b) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.86 [28.37, 43.79]</td>
<td style="text-align: left;">42.59 [34.17, 52.43]</td>
<td style="text-align: left;">32.81 [27.06, 39.17]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.909</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1635 (94.5)</td>
<td style="text-align: left;">466 ( 93.2)</td>
<td style="text-align: left;">1169 ( 95.0)</td>
<td style="text-align: left;">0.475</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.109</td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">14 ( 0.8)</td>
<td style="text-align: left;">5 ( 1.0)</td>
<td style="text-align: left;">9 ( 0.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">5 ( 0.3)</td>
<td style="text-align: left;">1 ( 0.2)</td>
<td style="text-align: left;">4 ( 0.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">65 ( 3.8)</td>
<td style="text-align: left;">23 ( 4.6)</td>
<td style="text-align: left;">42 ( 3.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Count of missing TOP transgression to norms report (%)</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">10 ( 0.6)</td>
<td style="text-align: left;">5 ( 1.0)</td>
<td style="text-align: left;">5 ( 0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">no offense after admission</td>
<td style="text-align: left;">1292 (74.7)</td>
<td style="text-align: left;">402 ( 80.4)</td>
<td style="text-align: left;">890 ( 72.4)</td>
<td style="text-align: left;">0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.190</td>
</tr>
<tr class="even">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">offender after adm</td>
<td style="text-align: left;">438 (25.3)</td>
<td style="text-align: left;">98 ( 19.6)</td>
<td style="text-align: left;">340 ( 27.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(size=10, format="html",caption= "Summary descriptives, by Baseline Treatment Status") %&gt;%     kableExtra::kable_classic()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<section id="dates" class="level3">
<h3 class="anchored" data-anchor-id="dates">Dates</h3>
<ul>
<li>We show the distribution of dates of all the observations between 2015-2019.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of admission to baseline treatment"</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_ing_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_ing_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of discharge of baseline treatment"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of commission of offense after admission"</span>,</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of death after admission"</span>,</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(date_death), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(date_death), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of TOP application"</span>,</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(date_ap_top), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(date_ap_top), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of birth (corrected)"</span>,</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_nac_rec), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_nac_rec), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format=</span><span class="st">"html"</span>,<span class="at">caption=</span> <span class="st">"Summary of Dates (after correcting dates)"</span>) <span class="sc">%&gt;%</span> <span class="co">#,col.names=c("Variables","Residential", "Ambulatory", "p-value")) %&gt;% </span></span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>,<span class="st">"condensed"</span>),<span class="at">font_size=</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-size: 12px; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Summary of Dates (after correcting dates)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> cat </th>
   <th style="text-align:left;"> min </th>
   <th style="text-align:left;"> p025 </th>
   <th style="text-align:left;"> p25 </th>
   <th style="text-align:left;"> p50 </th>
   <th style="text-align:left;"> p75 </th>
   <th style="text-align:left;"> p975 </th>
   <th style="text-align:left;"> max </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Date of admission to baseline treatment </td>
   <td style="text-align:left;"> 2015-01-05 </td>
   <td style="text-align:left;"> 2015-02-13 </td>
   <td style="text-align:left;"> 2016-02-12 </td>
   <td style="text-align:left;"> 2017-04-27 </td>
   <td style="text-align:left;"> 2018-06-28 </td>
   <td style="text-align:left;"> 2019-08-23 </td>
   <td style="text-align:left;"> 2019-10-30 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of discharge of baseline treatment </td>
   <td style="text-align:left;"> 2015-01-07 </td>
   <td style="text-align:left;"> 2015-06-30 </td>
   <td style="text-align:left;"> 2016-09-28 </td>
   <td style="text-align:left;"> 2017-11-30 </td>
   <td style="text-align:left;"> 2019-02-13 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of commission of offense after admission </td>
   <td style="text-align:left;"> 2015-01-07 </td>
   <td style="text-align:left;"> 2015-06-30 </td>
   <td style="text-align:left;"> 2016-09-28 </td>
   <td style="text-align:left;"> 2017-11-30 </td>
   <td style="text-align:left;"> 2019-02-13 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of death after admission </td>
   <td style="text-align:left;"> 2016-08-01 </td>
   <td style="text-align:left;"> 2016-10-25 </td>
   <td style="text-align:left;"> 2017-08-31 </td>
   <td style="text-align:left;"> 2018-05-18 </td>
   <td style="text-align:left;"> 2019-03-02 </td>
   <td style="text-align:left;"> 2019-10-01 </td>
   <td style="text-align:left;"> 2019-11-02 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of TOP application </td>
   <td style="text-align:left;"> 2015-05-28 </td>
   <td style="text-align:left;"> 2015-09-28 </td>
   <td style="text-align:left;"> 2016-11-14 </td>
   <td style="text-align:left;"> 2017-10-07 </td>
   <td style="text-align:left;"> 2018-10-03 </td>
   <td style="text-align:left;"> 2019-09-22 </td>
   <td style="text-align:left;"> 2019-11-07 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of birth (corrected) </td>
   <td style="text-align:left;"> 1929-03-20 </td>
   <td style="text-align:left;"> 1954-09-03 </td>
   <td style="text-align:left;"> 1972-07-21 </td>
   <td style="text-align:left;"> 1982-01-27 </td>
   <td style="text-align:left;"> 1989-06-02 </td>
   <td style="text-align:left;"> 1997-11-14 </td>
   <td style="text-align:left;"> 2004-11-20 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<ul>
<li>We selected only the observations in study and explored the dates</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of admission to baseline treatment"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_ing_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_ing_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of discharge of baseline treatment"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of commission of offense after admission"</span>,</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of death after admission"</span>,</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(date_death), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(date_death), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of TOP application"</span>,</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(date_ap_top), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_ap_top), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(date_ap_top), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of birth (corrected)"</span>,</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_nac_rec), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_nac_rec), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format=</span><span class="st">"html"</span>,<span class="at">caption=</span> <span class="st">"Summary of Dates (after correcting dates)"</span>) <span class="sc">%&gt;%</span> <span class="co">#,col.names=c("Variables","Residential", "Ambulatory", "p-value")) %&gt;% </span></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>,<span class="st">"condensed"</span>),<span class="at">font_size=</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-size: 12px; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Summary of Dates (after correcting dates)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> cat </th>
   <th style="text-align:left;"> min </th>
   <th style="text-align:left;"> p025 </th>
   <th style="text-align:left;"> p25 </th>
   <th style="text-align:left;"> p50 </th>
   <th style="text-align:left;"> p75 </th>
   <th style="text-align:left;"> p975 </th>
   <th style="text-align:left;"> max </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Date of admission to baseline treatment </td>
   <td style="text-align:left;"> 2015-01-05 </td>
   <td style="text-align:left;"> 2015-02-17 </td>
   <td style="text-align:left;"> 2015-11-10 </td>
   <td style="text-align:left;"> 2016-10-26 </td>
   <td style="text-align:left;"> 2017-10-24 </td>
   <td style="text-align:left;"> 2019-01-20 </td>
   <td style="text-align:left;"> 2019-07-04 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of discharge of baseline treatment </td>
   <td style="text-align:left;"> 2015-03-03 </td>
   <td style="text-align:left;"> 2015-06-10 </td>
   <td style="text-align:left;"> 2016-07-05 </td>
   <td style="text-align:left;"> 2017-05-31 </td>
   <td style="text-align:left;"> 2018-05-10 </td>
   <td style="text-align:left;"> 2019-05-31 </td>
   <td style="text-align:left;"> 2019-09-10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of commission of offense after admission </td>
   <td style="text-align:left;"> 2015-03-03 </td>
   <td style="text-align:left;"> 2015-06-10 </td>
   <td style="text-align:left;"> 2016-07-05 </td>
   <td style="text-align:left;"> 2017-05-31 </td>
   <td style="text-align:left;"> 2018-05-10 </td>
   <td style="text-align:left;"> 2019-05-31 </td>
   <td style="text-align:left;"> 2019-09-10 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of death after admission </td>
   <td style="text-align:left;"> 2017-03-01 </td>
   <td style="text-align:left;"> 2017-03-19 </td>
   <td style="text-align:left;"> 2017-08-31 </td>
   <td style="text-align:left;"> 2018-03-03 </td>
   <td style="text-align:left;"> 2018-09-02 </td>
   <td style="text-align:left;"> 2019-02-14 </td>
   <td style="text-align:left;"> 2019-03-05 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of TOP application </td>
   <td style="text-align:left;"> 2015-05-28 </td>
   <td style="text-align:left;"> 2015-09-25 </td>
   <td style="text-align:left;"> 2016-11-08 </td>
   <td style="text-align:left;"> 2017-09-17 </td>
   <td style="text-align:left;"> 2018-09-05 </td>
   <td style="text-align:left;"> 2019-09-05 </td>
   <td style="text-align:left;"> 2019-11-07 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of birth (corrected) </td>
   <td style="text-align:left;"> 1939-10-06 </td>
   <td style="text-align:left;"> 1957-01-04 </td>
   <td style="text-align:left;"> 1973-11-30 </td>
   <td style="text-align:left;"> 1982-10-11 </td>
   <td style="text-align:left;"> 1989-03-11 </td>
   <td style="text-align:left;"> 1997-03-17 </td>
   <td style="text-align:left;"> 2000-11-02 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="registered-deaths" class="level3">
<h3 class="anchored" data-anchor-id="registered-deaths">Registered deaths</h3>
<p>We checked whether there were any deaths before the application of TOP.</p>
<div class="center-table">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#restrict to cases in study</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#explore patients that had recorded deaths</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key <span class="sc">%in%</span> <span class="fu">unlist</span>(cause_of_adm_discharge_ndp_23_2_filt<span class="sc">$</span>hash_key)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select dates</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, fech_egres_imp_1, date_ap_top) <span class="sc">%&gt;%</span>  </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#linked with data of deceased patients to contrast deaths when decease was notified</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">distinct</span>(cause_of_adm_discharge_ndp_23_2_filt, hash_key, fecha_egreso_de_tratamiento_fmt)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Inside study(1) outside study (0)"</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"Date of discharge/dropout"</span>, <span class="st">"Date of TOP aplication"</span>, <span class="st">"Date of administrative termination (due to death)"</span>) , <span class="at">escape=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Joining, by = “hash_key”</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Summary descriptives, Inside study(1) outside study (0)</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 19%">
<col style="width: 17%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Date of discharge/dropout</th>
<th style="text-align: left;">Date of TOP aplication</th>
<th style="text-align: left;">Date of administrative termination (due to death)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">41b15c5f8dfa662dedf91822306a9ba2</td>
<td style="text-align: left;">2015-09-29</td>
<td style="text-align: left;">2015-11-03</td>
<td style="text-align: left;">2017-03-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">55265f24b77c043d32c815f3d6593c9e</td>
<td style="text-align: left;">2018-10-01</td>
<td style="text-align: left;">2018-11-05</td>
<td style="text-align: left;">2019-03-05</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Every case had a death reported after treatment.</p>
<p><br></p>
</section>
</section>
</section>
<section id="glca" class="level1">
<h1>GLCA</h1>
<ul>
<li><p>We discarded people with unfinished treatments and without TOP after treatment</p></li>
<li><p>We replaced NA values in multiple columns of <code>mydata_preds1</code> with the string “none”</p></li>
<li><p>We grouped by three substance-related columns and then counted the number of rows for each group</p></li>
</ul>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(glca)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>mydata_preds1<span class="ot">&lt;-</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Base_fiscalia_v16_grant_23_24 %&gt;% </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sus_principal_mod,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>      dg_trs_cons_sus_or,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>      freq_cons_sus_prin,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>      otras_sus1_mod,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>      otras_sus2_mod) <span class="sc">%&gt;%</span>  </span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>mydata_preds2 <span class="ot">&lt;-</span> mydata_preds1<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>,<span class="st">"dg_trs_cons_sus_or"</span>,<span class="st">"freq_cons_sus_prin"</span>), <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">is.na</span>(.)<span class="sc">~</span> <span class="st">"none"</span>, T<span class="sc">~</span> .)))</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Count of substances</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">group_by</span>(mydata_preds2,sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">%&gt;%</span>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc=</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">round</span>(n<span class="sc">/</span><span class="fu">sum</span>(n),<span class="dv">2</span>))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Combinations of substances"</span>, <span class="at">col.names=</span> <span class="fu">c</span>(<span class="st">"Primary substance"</span>, <span class="st">"Other substances (1)"</span>, <span class="st">"Other substances (2)"</span>,<span class="st">"n"</span>, <span class="st">"%"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 72 rows and 4 columns, 3 group variables remaining (sus_principal_mod, otras_sus1_mod, otras_sus2_mod)</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Combinations of substances</caption>
<colgroup>
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Primary substance</th>
<th style="text-align: left;">Other substances (1)</th>
<th style="text-align: left;">Other substances (2)</th>
<th style="text-align: right;">n</th>
<th style="text-align: left;">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">306</td>
<td style="text-align: left;">18%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">117</td>
<td style="text-align: left;">7%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">113</td>
<td style="text-align: left;">7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">106</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">79</td>
<td style="text-align: left;">5%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">62</td>
<td style="text-align: left;">4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">57</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">50</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">28</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>first_five<span class="ot">&lt;-</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">group_by</span>(mydata_preds2,sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">%&gt;%</span>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">0</span>, <span class="sc">!</span><span class="st">"none"</span><span class="sc">==</span>otras_sus1_mod) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(n))<span class="sc">/</span><span class="fu">nrow</span>(mydata_preds2) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 72 rows and 4 columns, 3 group variables remaining (sus_principal_mod, otras_sus1_mod, otras_sus2_mod)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"The first four (there is one that is exchangeable) make the "</span>, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">as.character</span>(scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">unlist</span>(first_five))),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">" of the sample"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The first four (there is one that is exchangeable) make the 29% of the sample"</code></pre>
</div>
</div>
<ul>
<li>We made a latent class analysis with only substances. Then we added other drug patterns (frequency of use and drug dependence status). Now, we dropped missing values in drug dependence diagnosis and substance use frequency (~250 patients) (2023-08-20).</li>
</ul>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">group_by</span>(mydata_preds2,sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">%&gt;%</span>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc=</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">round</span>(n<span class="sc">/</span><span class="fu">sum</span>(n),<span class="dv">2</span>))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Combinations of substances"</span>, <span class="at">col.names=</span> <span class="fu">c</span>(<span class="st">"Primary substance"</span>, <span class="st">"Other substances (1)"</span>, <span class="st">"Other substances (2)"</span>, <span class="st">"n"</span>, <span class="st">"%"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 72 rows and 4 columns, 3 group variables remaining (sus_principal_mod, otras_sus1_mod, otras_sus2_mod)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#, dg_trs_cons_sus_or, freq_cons_sus_prin</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#"ICD 10 SUD Dg", "Subs.Use.Freq.",</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>mydata_preds3 <span class="ot">&lt;-</span> mydata_preds2<span class="sc">%&gt;%</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(.<span class="sc">==</span><span class="st">"none"</span><span class="sc">~</span> <span class="st">"__none"</span>, T<span class="sc">~</span> .)))<span class="sc">%&gt;%</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(.))))<span class="sc">%&gt;%</span> </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-08-20. We cannot discard none categories for drug use patterns, but we can do it for drug dependence diagnosis and drug use frequency</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>dg_trs_cons_sus_or<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>freq_cons_sus_prin<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co">#,"dg_trs_cons_sus_or","freq_cons_sus_prin"</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co">#,"dg_trs_cons_sus_or","freq_cons_sus_prin"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Combinations of substances</caption>
<colgroup>
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Primary substance</th>
<th style="text-align: left;">Other substances (1)</th>
<th style="text-align: left;">Other substances (2)</th>
<th style="text-align: right;">n</th>
<th style="text-align: left;">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">306</td>
<td style="text-align: left;">18%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">117</td>
<td style="text-align: left;">7%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">113</td>
<td style="text-align: left;">7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">106</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">79</td>
<td style="text-align: left;">5%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">62</td>
<td style="text-align: left;">4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">57</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">50</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">47</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">42</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">38</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">28</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">23</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">17</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"glca format"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We excluded otras_sus3_mod because it had only one value</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>f_preds2<span class="ot">&lt;-</span> <span class="fu">item</span>(sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">~</span> <span class="dv">1</span> <span class="co">#, dg_trs_cons_sus_or, freq_cons_sus_prin</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># f &lt;- cbind(sus_principal_mod, otras_sus1_mod, otras_sus2_mod, otras_sus3_mod)~1</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co"># gss.lc2 &lt;- poLCA(f,mydata_preds3,nclass=2)</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># lca203 &lt;- glca(f_preds2, data = mydata_preds3, nclass = 3, seed = seed, verbose = FALSE, n.init = 5e1, decreasing=T, maxiter = 1e4,testiter = 500)</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">2125</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>testiter <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>n_bootstrap  <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>old <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-25 00:55:45 -04"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>lca202 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">2</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#43 minutes each more or less</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>lca203 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">3</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>lca204 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">4</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>lca205 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">5</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>lca206 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">6</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>lca207 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">7</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>lca208 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">8</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>lca209 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">9</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>lca210 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">10</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>lca211 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">11</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>lca212 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">12</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>lca213 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">13</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>lca214 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">14</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>gof2<span class="ot">&lt;-</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gofglca</span>(lca202, lca203, lca204, lca205, lca206, lca207, lca208, lca209, lca210, lca211, lca212, lca213, lca214, <span class="at">test =</span> <span class="st">"chisq"</span>)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>bootlrt2<span class="ot">&lt;-</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="fu">gofglca</span>(lca202, lca203, lca204, lca205, lca206, lca207, lca208, lca209, <span class="at">test =</span> <span class="st">"boot"</span>, <span class="at">nboot=</span> n_bootstrap, <span class="at">seed=</span><span class="dv">2125</span>)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>best_model_lca<span class="ot">&lt;-</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">cbind.data.frame</span>(<span class="at">rn=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>,gof2<span class="sc">$</span>gtable) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">which.min</span>(BIC)<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>new_med<span class="ot">&lt;-</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"The model took "</span>,<span class="fu">round</span>(new_med<span class="sc">-</span>old,<span class="dv">2</span>),<span class="st">" until every LCA was computed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The model took 22.7 until every LCA was computed"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(new_med)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-25 01:18:27 -04"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://agscl.github.io/IVE/</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>sabic<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">14</span>)){</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  sabic<span class="ot">&lt;-</span><span class="fu">c</span>(sabic,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"lca2"</span>,<span class="fu">sprintf</span>(<span class="st">"%02.f"</span>, i)))<span class="sc">$</span>gof<span class="sc">$</span>loglik)<span class="sc">+</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"lca2"</span>,<span class="fu">sprintf</span>(<span class="st">"%02.f"</span>, i)))<span class="sc">$</span>gof<span class="sc">$</span>df <span class="sc">*</span><span class="fu">log</span>(  (<span class="fu">nrow</span>(mydata_preds3) <span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">24</span>    )</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>manualcolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'indianred1'</span>, <span class="st">'cornflowerblue'</span>, <span class="st">'gray50'</span>, <span class="st">'darkolivegreen4'</span>, <span class="st">'slateblue2'</span>, </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'firebrick4'</span>, <span class="st">'goldenrod4'</span>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>levels4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"logLik"</span>, <span class="st">"AIC"</span>, <span class="st">"CAIC"</span>, <span class="st">"BIC"</span>, <span class="st">"entropy"</span>, <span class="st">"Res.Df"</span>, <span class="st">"Gsq"</span>, <span class="st">"SABIC"</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>labels4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Log-Likelihood'</span>, <span class="st">'Akaike Information</span><span class="sc">\n</span><span class="st">Criteria(AIC)'</span>,<span class="st">'Corrected AIC'</span>,<span class="st">'Bayesian Information</span><span class="sc">\n</span><span class="st">Criteria (BIC)'</span>, <span class="st">'Entropy'</span>, <span class="st">'Residual degrees of freedom'</span>, <span class="st">'Deviance'</span>, <span class="st">"SABIC"</span>)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>fig_lca_fit1<span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="at">rn=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>,gof2<span class="sc">$</span>gtable,<span class="at">SABIC=</span>sabic) <span class="sc">%&gt;%</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, as.numeric) <span class="sc">%&gt;%</span>  <span class="co"># convert character columns to numeric</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>rn,<span class="at">names_to =</span> <span class="st">"indices"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>, <span class="at">values_drop_na =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">factor</span>(indices, <span class="at">levels =</span> levels4, <span class="at">labels =</span> labels4)) <span class="sc">%&gt;%</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"(AIC|BIC)"</span>,indices, <span class="at">ignore.case=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ModelIndex=</span> <span class="fu">factor</span>(rn, <span class="at">levels=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ModelIndex, <span class="at">y =</span> value, <span class="at">group =</span> indices, <span class="at">color =</span> indices, <span class="at">linetype =</span> indices)) <span class="sc">+</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> manualcolors) <span class="sc">+</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_linetype_manual(values = c("solid", "dashed", "dotted")) +</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of classes"</span>, <span class="at">y=</span><span class="st">"Value"</span>, <span class="at">color=</span><span class="st">"Measure"</span>, <span class="at">linetype=</span><span class="st">"Measure"</span>)<span class="sc">+</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(.~indices, scales = "free_y", nrow = 4, ncol = 1) +</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>fig_lca_fit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/glca2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Elbow plot of the information criteria</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The best fit was obtained by the 6 class solution</p>
<div class="controlly">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glca(formula = f_preds2, data = mydata_preds3, nclass = 6, n.init = 50, 
    decreasing = T, testiter = testiter, maxiter = 10000, seed = seed, 
    verbose = FALSE)

Manifest items : sus_principal_mod otras_sus1_mod otras_sus2_mod 

Categories for manifest items :
                  Y = 1 Y = 2 Y = 3 Y = 4 Y = 5 Y = 6
sus_principal_mod     1     2     3     4     5      
otras_sus1_mod        1     2     3     4     5     6
otras_sus2_mod        1     2     3     4     5     6

Model : Latent class analysis 

Number of latent classes : 6 
Number of observations : 1730 
Number of parameters : 89 

log-likelihood : -5849.847 
     G-squared : 264.8366 
           AIC : 11877.69 
           BIC : 12363.27 

Marginal prevalences for latent classes :
Class 1 Class 2 Class 3 Class 4 Class 5 Class 6 
0.10856 0.32688 0.16687 0.06269 0.19662 0.13839 

Class prevalences by group :
    Class 1 Class 2 Class 3 Class 4 Class 5 Class 6
ALL 0.10856 0.32688 0.16687 0.06269 0.19662 0.13839

Item-response probabilities :
sus_principal_mod 
         Y = 1  Y = 2  Y = 3  Y = 4  Y = 5
Class 1 0.9551 0.0000 0.0000 0.0449 0.0000
Class 2 0.6112 0.1136 0.2317 0.0341 0.0094
Class 3 0.0000 0.0000 0.9542 0.0122 0.0335
Class 4 0.0000 0.9617 0.0000 0.0383 0.0000
Class 5 0.0000 0.0000 0.9540 0.0233 0.0226
Class 6 0.0000 0.8999 0.0000 0.0779 0.0221
otras_sus1_mod 
         Y = 1  Y = 2  Y = 3  Y = 4  Y = 5  Y = 6
Class 1 0.0000 0.0000 0.4740 0.2123 0.2385 0.0752
Class 2 0.8895 0.0000 0.0000 0.0000 0.0725 0.0380
Class 3 0.0000 0.0000 0.2024 0.0000 0.7816 0.0160
Class 4 0.0000 0.0000 0.0000 0.1915 0.7521 0.0564
Class 5 0.0000 0.8230 0.1721 0.0000 0.0000 0.0049
Class 6 0.0000 0.9149 0.0000 0.0851 0.0000 0.0000
otras_sus2_mod 
         Y = 1  Y = 2  Y = 3  Y = 4  Y = 5  Y = 6
Class 1 0.4792 0.0000 0.1651 0.0958 0.2076 0.0523
Class 2 1.0000 0.0000 0.0000 0.0000 0.0000 0.0000
Class 3 0.2710 0.5479 0.1445 0.0000 0.0000 0.0365
Class 4 0.2687 0.6254 0.0000 0.0645 0.0000 0.0414
Class 5 0.3651 0.0000 0.1625 0.0000 0.4585 0.0139
Class 6 0.5679 0.0000 0.0000 0.0668 0.3176 0.0477</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Medidas de ajuste (dividir por 1000 gsq_2)</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">rn</th>
<th style="text-align: right;">log_lik</th>
<th style="text-align: right;">aic</th>
<th style="text-align: right;">caic</th>
<th style="text-align: right;">bic</th>
<th style="text-align: right;">entropy</th>
<th style="text-align: right;">res_df</th>
<th style="text-align: right;">gsq</th>
<th style="text-align: right;">sabic</th>
<th style="text-align: right;">boot_p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-6431.56</td>
<td style="text-align: right;">12921.12</td>
<td style="text-align: right;">13108.34</td>
<td style="text-align: right;">13079.34</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1428.26</td>
<td style="text-align: right;">13504.97</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-6158.97</td>
<td style="text-align: right;">12405.94</td>
<td style="text-align: right;">12690.00</td>
<td style="text-align: right;">12646.00</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">883.08</td>
<td style="text-align: right;">12895.60</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-5996.00</td>
<td style="text-align: right;">12110.00</td>
<td style="text-align: right;">12490.90</td>
<td style="text-align: right;">12431.90</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">557.14</td>
<td style="text-align: right;">12505.48</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-5912.16</td>
<td style="text-align: right;">11972.32</td>
<td style="text-align: right;">12450.06</td>
<td style="text-align: right;">12376.06</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">389.46</td>
<td style="text-align: right;">12273.62</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">-5849.85</td>
<td style="text-align: right;">11877.69</td>
<td style="text-align: right;">12452.27</td>
<td style="text-align: right;">12363.27</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">264.84</td>
<td style="text-align: right;">12084.80</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-5803.82</td>
<td style="text-align: right;">11815.64</td>
<td style="text-align: right;">12487.05</td>
<td style="text-align: right;">12383.05</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">172.78</td>
<td style="text-align: right;">11928.57</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">-5772.56</td>
<td style="text-align: right;">11783.13</td>
<td style="text-align: right;">12551.38</td>
<td style="text-align: right;">12432.38</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">110.27</td>
<td style="text-align: right;">11801.87</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">-5756.46</td>
<td style="text-align: right;">11780.92</td>
<td style="text-align: right;">12646.00</td>
<td style="text-align: right;">12512.00</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">78.06</td>
<td style="text-align: right;">11705.47</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">-5745.39</td>
<td style="text-align: right;">11788.78</td>
<td style="text-align: right;">12750.70</td>
<td style="text-align: right;">12601.70</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">55.92</td>
<td style="text-align: right;">11619.15</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">-5741.74</td>
<td style="text-align: right;">11811.47</td>
<td style="text-align: right;">12870.23</td>
<td style="text-align: right;">12706.23</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">48.61</td>
<td style="text-align: right;">11547.66</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">-5731.55</td>
<td style="text-align: right;">11821.09</td>
<td style="text-align: right;">12976.69</td>
<td style="text-align: right;">12797.69</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28.23</td>
<td style="text-align: right;">11463.09</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-5730.24</td>
<td style="text-align: right;">11848.48</td>
<td style="text-align: right;">13100.92</td>
<td style="text-align: right;">12906.92</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">-15</td>
<td style="text-align: right;">25.62</td>
<td style="text-align: right;">11396.29</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">-5725.05</td>
<td style="text-align: right;">11868.09</td>
<td style="text-align: right;">13217.37</td>
<td style="text-align: right;">13008.37</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">-30</td>
<td style="text-align: right;">15.23</td>
<td style="text-align: right;">11321.72</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rdrr.io/cran/glca/src/R/plot.glca.R</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"lca20"</span>,best_model_lca))), <span class="at">ask=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/fig1-details-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Selected Model</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/fig1-details-2.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Selected Model</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/fig1-details-3.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Selected Model</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/fig1-details-4.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Selected Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>The following steps were involved in the following code:</p>
<ul>
<li>Analysis of the best LCA model’s parameter estimates.</li>
<li>Visualization of the probabilities of different responses across categories.</li>
<li>Extract the parameter ‘rho’ from the best model.</li>
<li>Transform and format the extracted data for visualization.</li>
<li>Read a correction table (<code>tabla12_corr.xlsx</code>) for categories.</li>
<li>Merge the model data with the correction table.</li>
<li>The data is visualized using a ggplot2 stacked bar chart.</li>
<li>Categories are represented with varying shades of grey.</li>
<li>Each bar represents a variable from the model, and the sections of the bar represent the probability of each category for that variable.</li>
<li>The bars are split by ‘class’ with the use of facets.</li>
<li>The processed data (<code>lcmodel_glca</code>) containing variables and their probabilities across different categories is saved to an Excel file named <code>variables_probabilities_in_category_glca_sin_po.xlsx.</code></li>
<li>The model’s parameters allow a deeper understanding of the probabilities across categories for different variables. The visualization provides a holistic view of the data for quick insights. The processed data is readily available for any further analysis or sharing.</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rho_glca<span class="ot">&lt;-</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">"bind_rows"</span>,best_model_glca<span class="sc">$</span>param<span class="sc">$</span>rho<span class="sc">$</span>ALL) <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">keep.rownames =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">set_colnames</span>(<span class="fu">c</span>(<span class="st">"variables"</span>, <span class="fu">paste0</span>(<span class="st">"Class"</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(best_model_glca<span class="sc">$</span>param<span class="sc">$</span>gamma)))) <span class="sc">%&gt;%</span> </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(variables, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"prob"</span>), <span class="at">sep=</span><span class="st">".Y ="</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>lcmodel_glca <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(rho_glca, <span class="at">level=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"class"</span><span class="ot">=</span><span class="st">"variable"</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>traductor_cats <span class="ot">&lt;-</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="at">var=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"sus_principal_mod"</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"otras_sus1_mod"</span>,<span class="dv">6</span>), <span class="fu">rep</span>(<span class="st">"otras_sus2_mod"</span>,<span class="dv">6</span>)),</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="at">lvl=</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),<span class="dv">2</span>)),</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="at">label=</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="st">"Alcohol"</span>, <span class="st">"Cocaine hydrochloride"</span>, <span class="st">"Cocaine paste"</span>, <span class="st">"Marijuana"</span>, <span class="st">"Other"</span>), <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"Alcohol"</span>, <span class="st">"Cocaine hydrochloride"</span>, <span class="st">"Cocaine paste"</span>, <span class="st">"Marijuana"</span>, <span class="st">"Other"</span>),<span class="dv">2</span>))</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>lcmodel_glca<span class="ot">&lt;-</span> lcmodel_glca <span class="sc">%&gt;%</span> </span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr=</span><span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"[^0-9.]+"</span>, <span class="st">""</span>, prob))) <span class="sc">%&gt;%</span> </span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(traductor_cats[,<span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"lvl"</span>, <span class="st">"label"</span>)], <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"var"</span><span class="ot">=</span><span class="st">"var"</span>, <span class="st">"pr"</span><span class="ot">=</span><span class="st">"lvl"</span>))  </span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::mutate(CATEGORIA= dplyr::case_when(var=="AÑO" &amp; prob==" 1"~"Perdidos", T~CATEGORIA))</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>lcmodel_glca<span class="sc">$</span>text_label<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">""</span>,lcmodel_glca<span class="sc">$</span>label,<span class="st">"&lt;br&gt;%: "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_glca<span class="sc">$</span>value))</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>lcmodel_glca<span class="sc">$</span>text_label2<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">""</span>,lcmodel_glca<span class="sc">$</span>label,<span class="st">"</span><span class="sc">\n</span><span class="st"> "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_glca<span class="sc">$</span>value))</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_glca,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(var, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Primary</span><span class="sc">\n</span><span class="st">substance"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(1)"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(2)"</span>)), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(pr), <span class="at">label=</span>text_label))</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> zp3 <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> zp3 <span class="sc">+</span> <span class="fu">facet_grid</span>(class <span class="sc">~</span> .) </span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> zp3 <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> zp3 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Response probabilities"</span>, </span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Respone/ncategories"</span>)</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> zp3 <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> zp3 <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a>zp3 <span class="ot">&lt;-</span> zp3 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>)</span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(zp3, <span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"text_label"</span>))<span class="sc">%&gt;%</span> plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">xaxis=</span> <span class="fu">list</span>(<span class="at">showticklabels =</span> T),<span class="at">height=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Specifying width/height in layout() is now deprecated. Please specify in ggplotly() or plot_ly()</p>
</div>
<div class="cell-output-display">
<div id="htmlwidget-f9d01c14b72e4f0c0a1b" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f9d01c14b72e4f0c0a1b">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.53],"x":[1,2,3],"y":[0.96,0,0.48],"text":["text_label: Alcohol<br>%: 96.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 48.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.38,0.11,0],"x":[1,2,3],"y":[0.61,0.89,1],"text":["text_label: Alcohol<br>%: 61.0%","text_label: none<br>%: 89.0%","text_label: none<br>%: 100.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,1,0.73],"x":[1,2,3],"y":[0,0,0.27],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 27.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,1,0.73],"x":[1,2,3],"y":[0,0,0.27],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 27.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,0.99,0.63],"x":[1,2,3],"y":[0,0,0.37],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 37.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,1,0.44],"x":[1,2,3],"y":[0,0,0.57],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 57.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.53],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.27,0.11,0],"x":[1,2,3],"y":[0.11,0,0],"text":["text_label: Cocaine hydrochloride<br>%: 11.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,1,0.18],"x":[1,2,3],"y":[0,0,0.55],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 55.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.1],"x":[1,2,3],"y":[0.96,0,0.63],"text":["text_label: Cocaine hydrochloride<br>%: 96.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 63.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,0.17,0.63],"x":[1,2,3],"y":[0,0.82,0],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 82.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.1,0.09,0.44],"x":[1,2,3],"y":[0.9,0.91,0],"text":["text_label: Cocaine hydrochloride<br>%: 90.0%","text_label: Alcohol<br>%: 91.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.53,0.36],"x":[1,2,3],"y":[0,0.47,0.17],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 47.0%","text_label: Cocaine hydrochloride<br>%: 17.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.11,0],"x":[1,2,3],"y":[0.23,0,0],"text":["text_label: Cocaine paste<br>%: 23.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.8,0.04],"x":[1,2,3],"y":[0.95,0.2,0.14],"text":["text_label: Cocaine paste<br>%: 95.0%","text_label: Cocaine hydrochloride<br>%: 20.0%","text_label: Cocaine hydrochloride<br>%: 14.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.1],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0,0.47],"x":[1,2,3],"y":[0.95,0.17,0.16],"text":["text_label: Cocaine paste<br>%: 95.0%","text_label: Cocaine hydrochloride<br>%: 17.0%","text_label: Cocaine hydrochloride<br>%: 16.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.1,0.09,0.44],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.32,0.26],"x":[1,2,3],"y":[0.04,0.21,0.1],"text":["text_label: Marijuana<br>%: 4.0%","text_label: Cocaine paste<br>%: 21.0%","text_label: Cocaine paste<br>%: 10.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.01,0.11,0],"x":[1,2,3],"y":[0.03,0,0],"text":["text_label: Marijuana<br>%: 3.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.03,0.8,0.04],"x":[1,2,3],"y":[0.01,0,0],"text":["text_label: Marijuana<br>%: 1.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.81,0.04],"x":[1,2,3],"y":[0.04,0.19,0.06],"text":["text_label: Marijuana<br>%: 4.0%","text_label: Cocaine paste<br>%: 19.0%","text_label: Cocaine paste<br>%: 6.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.02,0,0.47],"x":[1,2,3],"y":[0.02,0,0],"text":["text_label: Marijuana<br>%: 2.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.02,0,0.37],"x":[1,2,3],"y":[0.08,0.09,0.07],"text":["text_label: Marijuana<br>%: 8.0%","text_label: Cocaine paste<br>%: 9.0%","text_label: Cocaine paste<br>%: 7.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.08,0.05],"x":[1,2,3],"y":[0,0.24,0.21],"text":["text_label: Other<br>%: 0.0%","text_label: Marijuana<br>%: 24.0%","text_label: Marijuana<br>%: 21.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.04,0],"x":[1,2,3],"y":[0.01,0.07,0],"text":["text_label: Other<br>%: 1.0%","text_label: Marijuana<br>%: 7.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.02,0.04],"x":[1,2,3],"y":[0.03,0.78,0],"text":["text_label: Other<br>%: 3.0%","text_label: Marijuana<br>%: 78.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.06,0.04],"x":[1,2,3],"y":[0,0.75,0],"text":["text_label: Other<br>%: 0.0%","text_label: Marijuana<br>%: 75.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0,0.01],"x":[1,2,3],"y":[0.02,0,0.46],"text":["text_label: Other<br>%: 2.0%","text_label: Marijuana<br>%: 0.0%","text_label: Marijuana<br>%: 46.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0,0.05],"x":[1,2,3],"y":[0.02,0,0.32],"text":["text_label: Other<br>%: 2.0%","text_label: Marijuana<br>%: 0.0%","text_label: Marijuana<br>%: 32.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.08,0.05],"text":["text_label: Other<br>%: 8.0%","text_label: Other<br>%: 5.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.04,0],"text":["text_label: Other<br>%: 4.0%","text_label: Other<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.02,0.04],"text":["text_label: Other<br>%: 2.0%","text_label: Other<br>%: 4.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.06,0.04],"text":["text_label: Other<br>%: 6.0%","text_label: Other<br>%: 4.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0,0.01],"text":["text_label: Other<br>%: 0.0%","text_label: Other<br>%: 1.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0,0.05],"text":["text_label: Other<br>%: 0.0%","text_label: Other<br>%: 5.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.9178082191781,"r":18.9954337899543,"b":25.5707762557078,"l":25.5707762557078},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["Primary<br />substance","Other<br />subs(1)","Other<br />subs(2)"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["Primary<br />substance","Other<br />subs(1)","Other<br />subs(2)"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-30,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y6","title":"","hoverformat":".2f"},"yaxis":{"domain":[0.839041095890411,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"Response probabilities","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-7.30593607305936},{"text":"Class1","x":1,"y":0.919520547945206,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class2","x":1,"y":0.75,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class3","x":1,"y":0.583333333333333,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class4","x":1,"y":0.416666666666667,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class5","x":1,"y":0.25,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class6","x":1,"y":0.0804794520547946,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.839041095890411,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.839041095890411,"y1":1,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.672374429223744,"y1":0.827625570776256},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.672374429223744,"y1":0.827625570776256,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.505707762557078,"y1":0.660958904109589},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.505707762557078,"y1":0.660958904109589,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.339041095890411,"y1":0.494292237442922},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.339041095890411,"y1":0.494292237442922,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.172374429223744,"y1":0.327625570776256},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.172374429223744,"y1":0.327625570776256,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.160958904109589},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.160958904109589,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.672374429223744,0.827625570776256],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.505707762557078,0.660958904109589],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.339041095890411,0.494292237442922],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.172374429223744,0.327625570776256],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis6":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,0.160958904109589],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative","height":600,"width":800},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"769056a77830":{"x":{},"y":{},"fill":{},"label":{},"type":"bar"}},"cur_data":"769056a77830","visdat":{"769056a77830":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Selected Model</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"_fig3_LCA_distribuciones_glca_sin_po.png"</span>,zp3, <span class="at">dpi=</span> <span class="dv">600</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>lcmodel_glca <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"variables_probabilities_in_category_glca_sin_po.xlsx"</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_glca,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(var, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Primary</span><span class="sc">\n</span><span class="st">substance"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(1)"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(2)"</span>)), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(pr), <span class="at">label=</span>text_label2))</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">facet_grid</span>(class <span class="sc">~</span> .) </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Response probabilities"</span>, </span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Respone/ncategories"</span>)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">paste0</span>(<span class="st">"grey"</span>,<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>, <span class="at">by=</span><span class="dv">60</span><span class="sc">/</span><span class="dv">6</span>))) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>zp3b <span class="ot">&lt;-</span> zp3b <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"zp3.png"</span>, </span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>       zp3b<span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="co">#aes(#y=half, label=lab),</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">max.iter =</span> <span class="fl">1e6</span>,</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>), </span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">height=</span><span class="dv">13</span>)<span class="co">#, fill = "white" --&gt; dentro de label repel</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>lcmodel_glca <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>( var, label, class, value) <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"tab_cond_pr.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For ease of interpretation, let’s summarize the main characteristics of each class based on the probabilities provided:</p>
<p>Class1: “Alcohol Primary, Diverse Secondary” - Primary Substance: Primarily Alcohol users (96% probability). - Secondary Substance 1: Cocaine hydrochloride (47% probability) and Marijuana (24% probability). - Secondary Substance 2: None (48% probability) and Cocaine hydrochloride (17% probability).</p>
<p>Class2: “Alcohol Exclusive” - Primary Substance: Mainly Alcohol users (61% probability). - Secondary Substance 1: Primarily none (89% probability). - Secondary Substance 2: Exclusively none (100% probability).</p>
<p>Class3: “Cocaine Paste Primary, Marijuana-Alcohol Mix” - Primary Substance: Mostly Cocaine paste users (95% probability). - Secondary Substance 1: Marijuana (78% probability). - Secondary Substance 2: Alcohol (55% probability).</p>
<p>Class4: “Cocaine Hydrochloride Primary, Marijuana-Alcohol Mix” - Primary Substance: Primarily Cocaine hydrochloride users (96% probability). - Secondary Substance 1: Marijuana (75% probability). - Secondary Substance 2: Alcohol (63% probability).</p>
<p>Class5: “Cocaine Paste Dominant, Alcohol Secondary” - Primary Substance: Primarily Cocaine paste users (95% probability). - Secondary Substance 1: Alcohol (82% probability). - Secondary Substance 2: None (37% probability) and Marijuana (46% probability).</p>
<p>Class6: “Cocaine Hydrochloride Primary, Alcohol-Marijuana Mix” - Primary Substance: Mostly Cocaine hydrochloride users (90% probability). - Secondary Substance 1: Alcohol (91% probability). - Secondary Substance 2: None (57% probability) and Marijuana (32% probability).</p>
<p>(For more info, see this <a href="https://chat.openai.com/share/ca7a6658-7bbc-4d43-972a-1fc0a20179b3">link</a>)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Classifying by posterior probs.</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>posterior_glca_05_final<span class="ot">&lt;-</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>best_model_glca<span class="sc">$</span>posterior<span class="sc">$</span>ALL <span class="sc">%&gt;%</span> </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(.<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_05=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="st">`</span><span class="at">Class 1</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">1</span>,<span class="st">`</span><span class="at">Class 2</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">2</span>, <span class="st">`</span><span class="at">Class 3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>,<span class="st">`</span><span class="at">Class 4</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, <span class="st">`</span><span class="at">Class 5</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">5</span>, <span class="st">`</span><span class="at">Class 6</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">6</span>))</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>posterior_glca_07_final<span class="ot">&lt;-</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>best_model_glca<span class="sc">$</span>posterior<span class="sc">$</span>ALL <span class="sc">%&gt;%</span> </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(.<span class="sc">&gt;</span>.<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_07=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="st">`</span><span class="at">Class 1</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">1</span>,<span class="st">`</span><span class="at">Class 2</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">2</span>, <span class="st">`</span><span class="at">Class 3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>,<span class="st">`</span><span class="at">Class 4</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, <span class="st">`</span><span class="at">Class 5</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">5</span>, <span class="st">`</span><span class="at">Class 6</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">6</span>))</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Unite the posterior probabilities with the original database</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>bd_mydata_preds3_posterior<span class="ot">&lt;-</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(mydata_preds3,<span class="at">final_07=</span>posterior_glca_07_final<span class="sc">$</span>final_07,<span class="at">final_05=</span>posterior_glca_05_final<span class="sc">$</span>final_05)</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Determining misclassification</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bd_mydata_preds3_posterior<span class="sc">$</span>final_05, </span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>      bd_mydata_preds3_posterior<span class="sc">$</span>final_07,<span class="at">exclude=</span><span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Freq<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Perc=</span> scales<span class="sc">::</span><span class="fu">percent</span>(Freq<span class="sc">/</span><span class="fu">sum</span>(Freq))) <span class="sc">%&gt;%</span> </span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(Freq)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Posterior probabilities of Classification"</span>, </span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names=</span> <span class="fu">c</span>(<span class="st">"Classifying w/ .5"</span>, <span class="st">"Classifying w/ .7"</span>, <span class="st">"Frequency"</span>, <span class="st">"%"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Posterior probabilities of Classification</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Classifying w/ .5</th>
<th style="text-align: left;">Classifying w/ .7</th>
<th style="text-align: right;">Frequency</th>
<th style="text-align: left;">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">507</td>
<td style="text-align: left;">29.31%</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">320</td>
<td style="text-align: left;">18.50%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">292</td>
<td style="text-align: left;">16.88%</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">231</td>
<td style="text-align: left;">13.35%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">160</td>
<td style="text-align: left;">9.25%</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">109</td>
<td style="text-align: left;">6.30%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">72</td>
<td style="text-align: left;">4.16%</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">1.21%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">0.92%</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0.12%</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When using classification criteria based on the model output, if at least 50% of an observation’s posterior probability is accounted for by a particular class, only 0.12% of the patients remain unclassified. However, if we raise this threshold to 70%, then 5% of the patients would not be assigned to any latent class. This observation aligns with relative entropy principles.</p>
<div class="cell" data-paged.print="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(easyalluvial)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(parcats)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>p_alluvial<span class="ot">&lt;-</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)), <span class="at">final_07=</span>posterior_glca_07_final<span class="sc">$</span>final_07, <span class="at">final_05=</span>posterior_glca_05_final<span class="sc">$</span>final_05) <span class="sc">%&gt;%</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tot_off_top_bin=</span> <span class="fu">ifelse</span>(tot_off_top<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">event_comp=</span> <span class="fu">factor</span>(event_comp, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Completion"</span>, <span class="st">"Non-completion"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tot_off_top_bin=</span> <span class="fu">factor</span>(tot_off_top_bin, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Reported offenses"</span>, <span class="st">"No reported offenses"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_05=</span><span class="fu">factor</span>(final_05, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Class1: Alcohol Primary,</span><span class="sc">\n</span><span class="st">Diverse Secondary"</span> , <span class="st">"Class2:</span><span class="sc">\n</span><span class="st">Alcohol Exclusive"</span> , <span class="st">"Class3: Cocaine Paste</span><span class="sc">\n</span><span class="st">Primary, Marijuana-Alcohol Mix"</span>, <span class="st">"Class4: Cocaine Hydrochloride</span><span class="sc">\n</span><span class="st">Primary, Marijuana-Alcohol Mix"</span>, <span class="st">"Class5: Cocaine</span><span class="sc">\n</span><span class="st">Paste Dominant,</span><span class="sc">\n</span><span class="st">Alcohol Secondary"</span>, <span class="st">"Class6: Cocaine</span><span class="sc">\n</span><span class="st">Hydrochloride Primary,</span><span class="sc">\n</span><span class="st">Alcohol-Marijuana Mix"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#sus_principal_mod,</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  otras_sus1_mod,</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  otras_sus2_mod,</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    final_05,</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>      event_comp,</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>      tot_off_top_bin) <span class="sc">%&gt;%</span>  </span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>      easyalluvial<span class="sc">::</span><span class="fu">alluvial_wide</span>(</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bin=</span><span class="dv">2</span>,</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bin_labels =</span> <span class="fu">c</span>(<span class="st">"ambulatory"</span>, <span class="st">"residential"</span>),</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order_levels=</span> <span class="fu">c</span>(<span class="st">"ambulatory"</span>, <span class="st">"residential"</span>,<span class="st">"censored"</span>),</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_by =</span> <span class="st">'first_variable'</span>,</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">NA_label =</span> <span class="st">"non-classified"</span>,</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">auto_rotate_xlabs =</span> T,</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">stratum_label_size =</span> <span class="dv">3</span>,</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colorful_fill_variable_stratum =</span> F)<span class="sc">+</span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>p_alluvial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/alluvial-1.png" class="img-fluid figure-img" width="3500"></p>
<p></p><figcaption class="figure-caption">Figure 2. Sankey Plot of Transitions by Treatment Modality</figcaption><p></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"glca_res_comp_off.png"</span>, </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>       p_alluvial, </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">height=</span><span class="dv">13</span>)<span class="co">#, fill = "white" --&gt; dentro de label repel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Saving 7 x 13 in image</p>
</div>
</div>
<section id="covariate-tr.-completion" class="level4">
<h4 class="anchored" data-anchor-id="covariate-tr.-completion">Covariate: Tr. completion</h4>
<ul>
<li>Adjusting by treatment completion status</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>mydata_preds32<span class="ot">&lt;-</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  mydata_preds3,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(event_comp)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>f_preds2_adj<span class="ot">&lt;-</span> <span class="fu">item</span>(sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">~</span> event_comp <span class="co">#, dg_trs_cons_sus_or,</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>lca2062 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2_adj, <span class="at">data =</span> mydata_preds32, <span class="at">nclass =</span> <span class="dv">6</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>gof_lca_adj<span class="ot">&lt;-</span> <span class="fu">gofglca</span>(lca2062, <span class="at">test=</span><span class="st">"boot"</span>, <span class="at">nboot=</span>n_bootstrap, <span class="at">seed=</span><span class="dv">2125</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lca2062)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Class 1 / 6 :
            Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)    1.62322     0.48441     0.09711    4.988   1.1e-06 ***
event_comp     1.91571     0.65009     0.17532    3.708  0.000254 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Class 2 / 6 :
            Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)    0.36605    -1.00499     0.13647   -7.364  2.26e-12 ***
event_comp     1.07576     0.07303     0.28457    0.257     0.798    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Class 3 / 6 :
            Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)  
(Intercept)     0.7614     -0.2726      0.1060   -2.573    0.0106 *
event_comp      1.3944      0.3325      0.2071    1.606    0.1096  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Class 4 / 6 :
            Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)
(Intercept)    1.14223     0.13298     0.09673    1.375     0.170
event_comp     1.12449     0.11733     0.19637    0.597     0.551

Class 5 / 6 :
            Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)     0.6035     -0.5050      0.1191   -4.239  3.11e-05 ***
event_comp      1.3194      0.2771      0.2293    1.209     0.228    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>rho_glca_adj<span class="ot">&lt;-</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">"bind_rows"</span>,lca2062<span class="sc">$</span>param<span class="sc">$</span>rho<span class="sc">$</span>ALL) <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">keep.rownames =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">set_colnames</span>(<span class="fu">c</span>(<span class="st">"variables"</span>, <span class="fu">paste0</span>(<span class="st">"Class"</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(lca2062<span class="sc">$</span>param<span class="sc">$</span>gamma[[<span class="dv">1</span>]])[[<span class="dv">2</span>]]))) <span class="sc">%&gt;%</span> </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(variables, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"prob"</span>), <span class="at">sep=</span><span class="st">".Y ="</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(rho_glca_adj, <span class="at">level=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"class"</span><span class="ot">=</span><span class="st">"variable"</span>)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj<span class="ot">&lt;-</span> lcmodel_glca_adj <span class="sc">%&gt;%</span> </span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr=</span><span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"[^0-9.]+"</span>, <span class="st">""</span>, prob))) <span class="sc">%&gt;%</span> </span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(traductor_cats[,<span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"lvl"</span>, <span class="st">"label"</span>)], <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"var"</span><span class="ot">=</span><span class="st">"var"</span>, <span class="st">"pr"</span><span class="ot">=</span><span class="st">"lvl"</span>))  </span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::mutate(CATEGORIA= dplyr::case_when(var=="AÑO" &amp; prob==" 1"~"Perdidos", T~CATEGORIA))</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj<span class="sc">$</span>text_label<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">""</span>,lcmodel_glca_adj<span class="sc">$</span>label,<span class="st">"&lt;br&gt;%: "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_glca_adj<span class="sc">$</span>value))</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj<span class="sc">$</span>text_label2<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">""</span>,lcmodel_glca_adj<span class="sc">$</span>label,<span class="st">"</span><span class="sc">\n</span><span class="st"> "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_glca_adj<span class="sc">$</span>value))</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_glca_adj,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(var, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Primary</span><span class="sc">\n</span><span class="st">substance"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(1)"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(2)"</span>)), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(pr), <span class="at">label=</span>text_label))</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> zp32 <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> zp32 <span class="sc">+</span> <span class="fu">facet_grid</span>(class <span class="sc">~</span> .) </span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> zp32 <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> zp32 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Response probabilities"</span>, </span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Respone/ncategories"</span>)</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> zp32 <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> zp32 <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a>zp32 <span class="ot">&lt;-</span> zp32 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>)</span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(zp32, <span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"text_label"</span>))<span class="sc">%&gt;%</span> plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">xaxis=</span> <span class="fu">list</span>(<span class="at">showticklabels =</span> T),<span class="at">height=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Specifying width/height in layout() is now deprecated. Please specify in ggplotly() or plot_ly()</p>
</div>
<div class="cell-output-display">
<div id="htmlwidget-bee350944491d563820f" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-bee350944491d563820f">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.53],"x":[1,2,3],"y":[0.96,0,0.48],"text":["text_label: Alcohol<br>%: 96.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 48.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.38,0.11,0],"x":[1,2,3],"y":[0.61,0.89,1],"text":["text_label: Alcohol<br>%: 61.0%","text_label: none<br>%: 89.0%","text_label: none<br>%: 100.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,1,0.73],"x":[1,2,3],"y":[0,0,0.27],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 27.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,1,0.74],"x":[1,2,3],"y":[0,0,0.26],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 26.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,0.99,0.63],"x":[1,2,3],"y":[0,0,0.36],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 36.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,1,0.44],"x":[1,2,3],"y":[0,0,0.57],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 57.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.53],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.27,0.11,0],"x":[1,2,3],"y":[0.11,0,0],"text":["text_label: Cocaine hydrochloride<br>%: 11.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,1,0.18],"x":[1,2,3],"y":[0,0,0.55],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 55.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.11],"x":[1,2,3],"y":[0.96,0,0.63],"text":["text_label: Cocaine hydrochloride<br>%: 96.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 63.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,0.17,0.63],"x":[1,2,3],"y":[0,0.82,0],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 82.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.1,0.08,0.44],"x":[1,2,3],"y":[0.9,0.92,0],"text":["text_label: Cocaine hydrochloride<br>%: 90.0%","text_label: Alcohol<br>%: 92.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.52,0.36],"x":[1,2,3],"y":[0,0.48,0.17],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 48.0%","text_label: Cocaine hydrochloride<br>%: 17.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.11,0],"x":[1,2,3],"y":[0.23,0,0],"text":["text_label: Cocaine paste<br>%: 23.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.8,0.04],"x":[1,2,3],"y":[0.95,0.2,0.14],"text":["text_label: Cocaine paste<br>%: 95.0%","text_label: Cocaine hydrochloride<br>%: 20.0%","text_label: Cocaine hydrochloride<br>%: 14.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.11],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0,0.47],"x":[1,2,3],"y":[0.96,0.17,0.16],"text":["text_label: Cocaine paste<br>%: 96.0%","text_label: Cocaine hydrochloride<br>%: 17.0%","text_label: Cocaine hydrochloride<br>%: 16.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.1,0.08,0.44],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.31,0.26],"x":[1,2,3],"y":[0.04,0.21,0.1],"text":["text_label: Marijuana<br>%: 4.0%","text_label: Cocaine paste<br>%: 21.0%","text_label: Cocaine paste<br>%: 10.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.01,0.11,0],"x":[1,2,3],"y":[0.03,0,0],"text":["text_label: Marijuana<br>%: 3.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.03,0.8,0.04],"x":[1,2,3],"y":[0.01,0,0],"text":["text_label: Marijuana<br>%: 1.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.81,0.04],"x":[1,2,3],"y":[0.04,0.19,0.07],"text":["text_label: Marijuana<br>%: 4.0%","text_label: Cocaine paste<br>%: 19.0%","text_label: Cocaine paste<br>%: 7.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.02,0,0.47],"x":[1,2,3],"y":[0.02,0,0],"text":["text_label: Marijuana<br>%: 2.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.02,0,0.37],"x":[1,2,3],"y":[0.08,0.08,0.07],"text":["text_label: Marijuana<br>%: 8.0%","text_label: Cocaine paste<br>%: 8.0%","text_label: Cocaine paste<br>%: 7.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.07,0.05],"x":[1,2,3],"y":[0,0.24,0.21],"text":["text_label: Other<br>%: 0.0%","text_label: Marijuana<br>%: 24.0%","text_label: Marijuana<br>%: 21.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.04,0],"x":[1,2,3],"y":[0.01,0.07,0],"text":["text_label: Other<br>%: 1.0%","text_label: Marijuana<br>%: 7.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.02,0.04],"x":[1,2,3],"y":[0.03,0.78,0],"text":["text_label: Other<br>%: 3.0%","text_label: Marijuana<br>%: 78.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.06,0.04],"x":[1,2,3],"y":[0,0.75,0],"text":["text_label: Other<br>%: 0.0%","text_label: Marijuana<br>%: 75.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0,0.01],"x":[1,2,3],"y":[0.02,0,0.46],"text":["text_label: Other<br>%: 2.0%","text_label: Marijuana<br>%: 0.0%","text_label: Marijuana<br>%: 46.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0,0.05],"x":[1,2,3],"y":[0.02,0,0.32],"text":["text_label: Other<br>%: 2.0%","text_label: Marijuana<br>%: 0.0%","text_label: Marijuana<br>%: 32.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.07,0.05],"text":["text_label: Other<br>%: 7.0%","text_label: Other<br>%: 5.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.04,0],"text":["text_label: Other<br>%: 4.0%","text_label: Other<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.02,0.04],"text":["text_label: Other<br>%: 2.0%","text_label: Other<br>%: 4.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.06,0.04],"text":["text_label: Other<br>%: 6.0%","text_label: Other<br>%: 4.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0,0.01],"text":["text_label: Other<br>%: 0.0%","text_label: Other<br>%: 1.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0,0.05],"text":["text_label: Other<br>%: 0.0%","text_label: Other<br>%: 5.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.9178082191781,"r":18.9954337899543,"b":25.5707762557078,"l":25.5707762557078},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["Primary<br />substance","Other<br />subs(1)","Other<br />subs(2)"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["Primary<br />substance","Other<br />subs(1)","Other<br />subs(2)"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-30,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y6","title":"","hoverformat":".2f"},"yaxis":{"domain":[0.839041095890411,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"Response probabilities","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-7.30593607305936},{"text":"Class1","x":1,"y":0.919520547945206,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class2","x":1,"y":0.75,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class3","x":1,"y":0.583333333333333,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class4","x":1,"y":0.416666666666667,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class5","x":1,"y":0.25,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class6","x":1,"y":0.0804794520547946,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.839041095890411,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.839041095890411,"y1":1,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.672374429223744,"y1":0.827625570776256},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.672374429223744,"y1":0.827625570776256,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.505707762557078,"y1":0.660958904109589},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.505707762557078,"y1":0.660958904109589,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.339041095890411,"y1":0.494292237442922},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.339041095890411,"y1":0.494292237442922,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.172374429223744,"y1":0.327625570776256},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.172374429223744,"y1":0.327625570776256,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.160958904109589},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.160958904109589,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.672374429223744,0.827625570776256],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.505707762557078,0.660958904109589],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.339041095890411,0.494292237442922],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.172374429223744,0.327625570776256],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis6":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,0.160958904109589],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative","height":600,"width":800},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"76907c1d6bd7":{"x":{},"y":{},"fill":{},"label":{},"type":"bar"}},"cur_data":"76907c1d6bd7","visdat":{"76907c1d6bd7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Selected Model (adjusted)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"_fig3_adj_LCA_distribuciones_glca_sin_po.png"</span>,zp32, <span class="at">dpi=</span> <span class="dv">600</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>lcmodel_glca <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"variables_probabilities_in_category_glca_sin_po_adj.xlsx"</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_glca_adj,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(var, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Primary</span><span class="sc">\n</span><span class="st">substance"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(1)"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(2)"</span>)), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(pr), <span class="at">label=</span>text_label2))</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">facet_grid</span>(class <span class="sc">~</span> .) </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Response probabilities"</span>, </span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Respone/ncategories"</span>)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">paste0</span>(<span class="st">"grey"</span>,<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>, <span class="at">by=</span><span class="dv">60</span><span class="sc">/</span><span class="dv">6</span>))) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>zp32b <span class="ot">&lt;-</span> zp32b <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"zp23.png"</span>, </span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>       zp32b<span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="co">#aes(#y=half, label=lab),</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">max.iter =</span> <span class="fl">1e6</span>,</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>), </span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">height=</span><span class="dv">13</span>)<span class="co">#, fill = "white" --&gt; dentro de label repel</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>( var, label, class, value) <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"tab_cond_pr_adj.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Practically the same latent classes</p>
</section>
<section id="covariate-top" class="level4">
<h4 class="anchored" data-anchor-id="covariate-top">Covariate: TOP</h4>
<ul>
<li>Adjusting by report status of TOP offenses</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>mydata_preds33<span class="ot">&lt;-</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  mydata_preds3,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tot_off_top_bin=</span> <span class="fu">ifelse</span>(tot_off_top<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(tot_off_top_bin)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>f_preds2_adj2<span class="ot">&lt;-</span> <span class="fu">item</span>(sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">~</span> tot_off_top_bin <span class="co">#, dg_trs_cons_sus_or,</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>lca2063 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2_adj2, <span class="at">data =</span> mydata_preds33, <span class="at">nclass =</span> <span class="dv">6</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> testiter)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>gof_lca_adj3<span class="ot">&lt;-</span> <span class="fu">gofglca</span>(lca2063, <span class="at">test=</span><span class="st">"boot"</span>, <span class="at">nboot=</span>n_bootstrap, <span class="at">seed=</span><span class="dv">2125</span>)</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lca2063)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Class 1 / 6 :
                Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)         2.3356      0.8483      0.1004    8.452  1.93e-15 ***
tot_off_top_bin     0.5274     -0.6397      0.1701   -3.761  0.000209 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Class 2 / 6 :
                Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)    
(Intercept)         0.4065     -0.9001      0.1431   -6.290   1.3e-09 ***
tot_off_top_bin     0.7839     -0.2435      0.2632   -0.925     0.356    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Class 3 / 6 :
                Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)  
(Intercept)        0.94594    -0.05557     0.10900    -0.51    0.6106  
tot_off_top_bin    0.64276    -0.44198     0.20090    -2.20    0.0287 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Class 4 / 6 :
                Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)
(Intercept)        1.18558     0.17023     0.10468    1.626     0.105
tot_off_top_bin    0.97456    -0.02577     0.17662   -0.146     0.884

Class 5 / 6 :
                Odds Ratio Coefficient  Std. Error  t value  Pr(&gt;|t|)   
(Intercept)         0.6802     -0.3853      0.1236   -3.118   0.00202 **
tot_off_top_bin     0.8569     -0.1545      0.2151   -0.718   0.47338   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>rho_glca_adj2<span class="ot">&lt;-</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(<span class="st">"bind_rows"</span>,lca2063<span class="sc">$</span>param<span class="sc">$</span>rho<span class="sc">$</span>ALL) <span class="sc">%&gt;%</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">keep.rownames =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">set_colnames</span>(<span class="fu">c</span>(<span class="st">"variables"</span>, <span class="fu">paste0</span>(<span class="st">"Class"</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(lca2063<span class="sc">$</span>param<span class="sc">$</span>gamma[[<span class="dv">1</span>]])[[<span class="dv">2</span>]]))) <span class="sc">%&gt;%</span> </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(variables, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"prob"</span>), <span class="at">sep=</span><span class="st">".Y ="</span>)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj2 <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(rho_glca_adj2, <span class="at">level=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"class"</span><span class="ot">=</span><span class="st">"variable"</span>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj2<span class="ot">&lt;-</span> lcmodel_glca_adj2 <span class="sc">%&gt;%</span> </span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pr=</span><span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"[^0-9.]+"</span>, <span class="st">""</span>, prob))) <span class="sc">%&gt;%</span> </span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(traductor_cats[,<span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"lvl"</span>, <span class="st">"label"</span>)], <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"var"</span><span class="ot">=</span><span class="st">"var"</span>, <span class="st">"pr"</span><span class="ot">=</span><span class="st">"lvl"</span>))  </span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::mutate(CATEGORIA= dplyr::case_when(var=="AÑO" &amp; prob==" 1"~"Perdidos", T~CATEGORIA))</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj2<span class="sc">$</span>text_label<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">""</span>,lcmodel_glca_adj2<span class="sc">$</span>label,<span class="st">"&lt;br&gt;%: "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_glca_adj2<span class="sc">$</span>value))</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj2<span class="sc">$</span>text_label2<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">""</span>,lcmodel_glca_adj2<span class="sc">$</span>label,<span class="st">"</span><span class="sc">\n</span><span class="st"> "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_glca_adj2<span class="sc">$</span>value))</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_glca_adj2,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(var, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Primary</span><span class="sc">\n</span><span class="st">substance"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(1)"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(2)"</span>)), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(pr), <span class="at">label=</span>text_label))</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> zp33 <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> zp33 <span class="sc">+</span> <span class="fu">facet_grid</span>(class <span class="sc">~</span> .) </span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> zp33 <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> zp33 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Response probabilities"</span>, </span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Respone/ncategories"</span>)</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> zp33 <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> zp33 <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>zp33 <span class="ot">&lt;-</span> zp33 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>)</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(zp33, <span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"text_label"</span>))<span class="sc">%&gt;%</span> plotly<span class="sc">::</span><span class="fu">layout</span>(<span class="at">xaxis=</span> <span class="fu">list</span>(<span class="at">showticklabels =</span> T),<span class="at">height=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Specifying width/height in layout() is now deprecated. Please specify in ggplotly() or plot_ly()</p>
</div>
<div class="cell-output-display">
<div id="htmlwidget-b9500d5665fe4fd0d38e" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b9500d5665fe4fd0d38e">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.53],"x":[1,2,3],"y":[0.96,0,0.48],"text":["text_label: Alcohol<br>%: 96.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 48.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.38,0.11,0],"x":[1,2,3],"y":[0.61,0.89,1],"text":["text_label: Alcohol<br>%: 61.0%","text_label: none<br>%: 89.0%","text_label: none<br>%: 100.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,1,0.73],"x":[1,2,3],"y":[0,0,0.27],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 27.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,1,0.72],"x":[1,2,3],"y":[0,0,0.27],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 27.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,0.99,0.63],"x":[1,2,3],"y":[0,0,0.36],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 36.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,1,0.44],"x":[1,2,3],"y":[0,0,0.57],"text":["text_label: Alcohol<br>%: 0.0%","text_label: none<br>%: 0.0%","text_label: none<br>%: 57.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":null,"color":"transparent"}},"name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.53],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.27,0.11,0],"x":[1,2,3],"y":[0.11,0,0],"text":["text_label: Cocaine hydrochloride<br>%: 11.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.99,1,0.18],"x":[1,2,3],"y":[0,0,0.55],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 55.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.1],"x":[1,2,3],"y":[0.96,0,0.62],"text":["text_label: Cocaine hydrochloride<br>%: 96.0%","text_label: Alcohol<br>%: 0.0%","text_label: Alcohol<br>%: 62.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[1,0.17,0.63],"x":[1,2,3],"y":[0,0.82,0],"text":["text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Alcohol<br>%: 82.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.1,0.08,0.44],"x":[1,2,3],"y":[0.9,0.92,0],"text":["text_label: Cocaine hydrochloride<br>%: 90.0%","text_label: Alcohol<br>%: 92.0%","text_label: Alcohol<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":null,"color":"transparent"}},"name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.52,0.36],"x":[1,2,3],"y":[0,0.48,0.17],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 48.0%","text_label: Cocaine hydrochloride<br>%: 17.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.11,0],"x":[1,2,3],"y":[0.23,0,0],"text":["text_label: Cocaine paste<br>%: 23.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0.8,0.04],"x":[1,2,3],"y":[0.95,0.2,0.14],"text":["text_label: Cocaine paste<br>%: 95.0%","text_label: Cocaine hydrochloride<br>%: 20.0%","text_label: Cocaine hydrochloride<br>%: 14.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,1,0.1],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.04,0,0.47],"x":[1,2,3],"y":[0.96,0.17,0.16],"text":["text_label: Cocaine paste<br>%: 96.0%","text_label: Cocaine hydrochloride<br>%: 17.0%","text_label: Cocaine hydrochloride<br>%: 16.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.1,0.08,0.44],"x":[1,2,3],"y":[0,0,0],"text":["text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%","text_label: Cocaine hydrochloride<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":null,"color":"transparent"}},"name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.31,0.26],"x":[1,2,3],"y":[0.04,0.21,0.1],"text":["text_label: Marijuana<br>%: 4.0%","text_label: Cocaine paste<br>%: 21.0%","text_label: Cocaine paste<br>%: 10.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.01,0.11,0],"x":[1,2,3],"y":[0.03,0,0],"text":["text_label: Marijuana<br>%: 3.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.03,0.8,0.04],"x":[1,2,3],"y":[0.01,0,0],"text":["text_label: Marijuana<br>%: 1.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.81,0.04],"x":[1,2,3],"y":[0.04,0.19,0.06],"text":["text_label: Marijuana<br>%: 4.0%","text_label: Cocaine paste<br>%: 19.0%","text_label: Cocaine paste<br>%: 6.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.02,0,0.47],"x":[1,2,3],"y":[0.02,0,0],"text":["text_label: Marijuana<br>%: 2.0%","text_label: Cocaine paste<br>%: 0.0%","text_label: Cocaine paste<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0.02,0,0.37],"x":[1,2,3],"y":[0.08,0.08,0.07],"text":["text_label: Marijuana<br>%: 8.0%","text_label: Cocaine paste<br>%: 8.0%","text_label: Cocaine paste<br>%: 7.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":null,"color":"transparent"}},"name":"4","legendgroup":"4","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.07,0.05],"x":[1,2,3],"y":[0,0.24,0.21],"text":["text_label: Other<br>%: 0.0%","text_label: Marijuana<br>%: 24.0%","text_label: Marijuana<br>%: 21.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.04,0],"x":[1,2,3],"y":[0.01,0.07,0],"text":["text_label: Other<br>%: 1.0%","text_label: Marijuana<br>%: 7.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.02,0.04],"x":[1,2,3],"y":[0.03,0.78,0],"text":["text_label: Other<br>%: 3.0%","text_label: Marijuana<br>%: 78.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0.06,0.04],"x":[1,2,3],"y":[0,0.75,0],"text":["text_label: Other<br>%: 0.0%","text_label: Marijuana<br>%: 75.0%","text_label: Marijuana<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0,0.01],"x":[1,2,3],"y":[0.02,0,0.46],"text":["text_label: Other<br>%: 2.0%","text_label: Marijuana<br>%: 0.0%","text_label: Marijuana<br>%: 46.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[0,0,0.05],"x":[1,2,3],"y":[0.02,0,0.32],"text":["text_label: Other<br>%: 2.0%","text_label: Marijuana<br>%: 0.0%","text_label: Marijuana<br>%: 32.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":null,"color":"transparent"}},"name":"5","legendgroup":"5","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.07,0.05],"text":["text_label: Other<br>%: 7.0%","text_label: Other<br>%: 5.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.04,0],"text":["text_label: Other<br>%: 4.0%","text_label: Other<br>%: 0.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.02,0.04],"text":["text_label: Other<br>%: 2.0%","text_label: Other<br>%: 4.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0.06,0.04],"text":["text_label: Other<br>%: 6.0%","text_label: Other<br>%: 4.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0,0.01],"text":["text_label: Other<br>%: 0.0%","text_label: Other<br>%: 1.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[0,0],"x":[2,3],"y":[0,0.05],"text":["text_label: Other<br>%: 0.0%","text_label: Other<br>%: 5.0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":null,"color":"transparent"}},"name":"6","legendgroup":"6","showlegend":false,"xaxis":"x","yaxis":"y6","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.9178082191781,"r":18.9954337899543,"b":25.5707762557078,"l":25.5707762557078},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["Primary<br />substance","Other<br />subs(1)","Other<br />subs(2)"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["Primary<br />substance","Other<br />subs(1)","Other<br />subs(2)"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-30,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y6","title":"","hoverformat":".2f"},"yaxis":{"domain":[0.839041095890411,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"Response probabilities","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-7.30593607305936},{"text":"Class1","x":1,"y":0.919520547945206,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class2","x":1,"y":0.75,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class3","x":1,"y":0.583333333333333,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class4","x":1,"y":0.416666666666667,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class5","x":1,"y":0.25,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Class6","x":1,"y":0.0804794520547946,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.839041095890411,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.839041095890411,"y1":1,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.672374429223744,"y1":0.827625570776256},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.672374429223744,"y1":0.827625570776256,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.505707762557078,"y1":0.660958904109589},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.505707762557078,"y1":0.660958904109589,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.339041095890411,"y1":0.494292237442922},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.339041095890411,"y1":0.494292237442922,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.172374429223744,"y1":0.327625570776256},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.172374429223744,"y1":0.327625570776256,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.160958904109589},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.160958904109589,"x0":0,"x1":23.37899543379,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.672374429223744,0.827625570776256],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.505707762557078,0.660958904109589],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.339041095890411,0.494292237442922],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.172374429223744,0.327625570776256],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis6":{"type":"linear","autorange":false,"range":[-0.0505,1.0605],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,0.160958904109589],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative","height":600,"width":800},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"7690348c62b7":{"x":{},"y":{},"fill":{},"label":{},"type":"bar"}},"cur_data":"7690348c62b7","visdat":{"7690348c62b7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Selected Model (adjusted for TOP offenses)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"_fig3_adj_LCA_distribuciones_glca_sin_po.png"</span>,zp32, <span class="at">dpi=</span> <span class="dv">600</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>lcmodel_glca <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"variables_probabilities_in_category_glca_sin_po_adj2.xlsx"</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_glca_adj2,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(var, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"Primary</span><span class="sc">\n</span><span class="st">substance"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(1)"</span>, <span class="st">"Other</span><span class="sc">\n</span><span class="st">subs(2)"</span>)), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(pr), <span class="at">label=</span>text_label2))</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">facet_grid</span>(class <span class="sc">~</span> .) </span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Response probabilities"</span>, </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Respone/ncategories"</span>)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">paste0</span>(<span class="st">"grey"</span>,<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>, <span class="at">by=</span><span class="dv">60</span><span class="sc">/</span><span class="dv">6</span>))) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>zp33b <span class="ot">&lt;-</span> zp33b <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"zp24.png"</span>, </span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>       zp33b<span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="co">#aes(#y=half, label=lab),</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">max.iter =</span> <span class="fl">1e6</span>,</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>), </span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">height=</span><span class="dv">13</span>)<span class="co">#, fill = "white" --&gt; dentro de label repel</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>lcmodel_glca_adj2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>( var, label, class, value) <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"tab_cond_pr_adj2.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Practically the same latent classes</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.stata.com/meeting/uk22/slides/UK22_Tompsett.pdf</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>f_preds<span class="ot">&lt;-</span><span class="fu">cbind</span>(sus_principal_mod, otras_sus1_mod, otras_sus2_mod)<span class="sc">~</span><span class="dv">1</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#testiter &lt;- 5000</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#n_bootstrap  &lt;- 500</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(poLCA)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>polca6<span class="ot">&lt;-</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="fu">poLCA</span>(</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>        f_preds, </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>        mydata_preds3,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">nclass =</span> <span class="dv">6</span>, </span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrep =</span> testiter<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxiter =</span> <span class="fl">1e4</span>,</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/396843/how-can-you-implement-latent-class-analysis-with-distal-outcomes-in-r</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="co">#lca210 &lt;- glca(f_preds2, data = mydata_preds3, nclass = 10, seed = seed, verbose = FALSE, n.init = 5e1, decreasing=T, maxiter = 1e4,testiter = testiter)</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a><span class="co">#We obtain W as</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>probs<span class="ot">&lt;-</span>data.table<span class="sc">::</span><span class="fu">as.data.table</span>(polca6<span class="sc">$</span>posterior)</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>W<span class="ot">&lt;-</span>modclass<span class="ot">&lt;-</span><span class="fu">apply</span>(probs,<span class="dv">1</span>,which.max)</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimating Q is more involved we first obtain P(C = j|W = i)</span></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>nclass<span class="ot">=</span><span class="dv">6</span></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>Ptable<span class="ot">&lt;-</span><span class="fu">cbind</span>(probs,modclass)</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>Pmatrix<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,nclass,nclass)</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>Npmatrix<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,nclass,nclass)</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nclass){</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nclass){</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>Pmatrix[i,j]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">subset</span>(Ptable,modclass<span class="sc">==</span>i)[,..j])</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>Npmatrix[i,j]<span class="ot">&lt;-</span>Pmatrix[i,j]<span class="sc">*</span><span class="fu">table</span>(modclass)[i]</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>}}</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a><span class="co">#The Q matrix is then calculated as</span></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>denom<span class="ot">&lt;-</span><span class="fu">colSums</span>(Npmatrix)</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>Qmatrix<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,nclass,nclass)</span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nclass){</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nclass){</span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>Qmatrix[j,i]<span class="ot">&lt;-</span>Npmatrix[i,j]<span class="sc">/</span>denom[j]</span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>}}</span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a><span class="co">#One quirk, as we are fitting a multinomial logistic regression</span></span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a><span class="co">#model, (with reference class 1 say), the probabilities in Q must</span></span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a><span class="co">#be in the same format.</span></span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"I dont know how to pass it through Stata (step 3) after these matrices"</span>)</span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>lQ<span class="ot">&lt;-</span><span class="fu">log</span>(Qmatrix<span class="sc">/</span>Qmatrix[,<span class="dv">1</span>])</span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>lQ</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>lq<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">as.vector</span>(<span class="fu">t</span>(lQ[,<span class="sc">-</span><span class="dv">1</span>])),<span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="dv">-6</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/flexmix/vignettes/regression-examples.pdf</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/flexmix/vignettes/mixture-regressions.pdf</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/flexmix/vignettes/bootstrapping.pdf</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v16_grant_23_24_reg<span class="ot">&lt;-</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(<span class="fu">subset</span>(Base_fiscalia_v16_grant_23_24, <span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)), <span class="at">final_07=</span>posterior_glca_07_final<span class="sc">$</span>final_07, <span class="at">final_05=</span>posterior_glca_05_final<span class="sc">$</span>final_05, <span class="at">sus_prin=</span> mydata_preds2<span class="sc">$</span>sus_principal_mod, <span class="at">otr_sus1=</span> mydata_preds2<span class="sc">$</span>otras_sus1_mod, <span class="at">otr_sus2=</span> mydata_preds2<span class="sc">$</span>otras_sus2_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">success=</span> <span class="fu">ifelse</span>(tot_off_top<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(sus_prin, otr_sus1, otr_sus2) <span class="sc">%&gt;%</span> </span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">success=</span><span class="fu">sum</span>(success, <span class="at">na.rm=</span>T),<span class="at">total=</span><span class="fu">n</span>(),<span class="at">failure=</span>total<span class="sc">-</span>success) <span class="sc">%&gt;%</span> </span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>        data.table<span class="sc">::</span><span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(flexmix)</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="co">#t. The general form is y~x|g where y is the response, x the set of predictors and g an optional grouping factor for repeated measurements.</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="co"># k= Number of clusters (not needed if cluster is specified).</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>flexmix_fit <span class="ot">&lt;-</span> <span class="fu">stepFlexmix</span>(<span class="fu">cbind</span>(success, failure) <span class="sc">~</span> sus_prin<span class="sc">+</span> otr_sus1<span class="sc">+</span> otr_sus2, </span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span>  Base_fiscalia_v16_grant_23_24_reg,</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="fu">FLXMRglmfix</span>(<span class="at">family =</span> <span class="st">"binomial"</span>),</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrep =</span> <span class="fl">5e3</span>, </span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">iter =</span> <span class="fl">5e5</span>, <span class="at">tol =</span> <span class="fl">1e-8</span>) <span class="co">#, minprior = 0.2 not recommended</span></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">getModel</span>(ArtEx.fit, <span class="st">"BIC"</span>))</span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a><span class="fu">getModel</span>(flexmix_fit, <span class="st">"BIC"</span>)</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="co">#predict latent class membership</span></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">clusters</span>(fit)</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(predictions)</span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a><span class="co">#posterior probabilities</span></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>posterior_probs <span class="ot">&lt;-</span> <span class="fu">posterior</span>(fit)</span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior_probs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="bivariate" class="level4">
<h4 class="anchored" data-anchor-id="bivariate">Bivariate</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>variables_comp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"clas_r"</span>,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"fis_comorbidity_icd_10"</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"edad_b_ap_top_num"</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"comorbidity_icd_10"</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"dg_trs_cons_sus_or"</span>,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"con_quien_vive_joel"</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"sus_ini_mod"</span>,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"freq_cons_sus_prin"</span>,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"estado_conyugal_2"</span>,</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">"compromiso_biopsicosocial"</span>,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">"macrozona"</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">"escolaridad_rec"</span>,</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">"event_comp"</span>,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tot_off_top_bin"</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>               )     </span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>tbone_desc_merge_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span> variables_comp, </span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span> Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)) <span class="sc">%&gt;%</span> </span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>                 tibble<span class="sc">::</span><span class="fu">add_column</span>(<span class="at">final_07=</span>posterior_glca_07_final<span class="sc">$</span>final_07,<span class="at">final_05=</span>posterior_glca_05_final<span class="sc">$</span>final_05) <span class="sc">%&gt;%</span> </span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">tot_off_top_bin=</span> <span class="fu">ifelse</span>(tot_off_top<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)), </span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">factorVars =</span> <span class="fu">setdiff</span>(variables_comp, <span class="fu">c</span>(<span class="st">"edad_b_ap_top_num"</span>)), </span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">smd=</span>T, </span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">strata=</span><span class="st">"final_07"</span>, </span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">addOverall =</span> T, </span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">includeNA=</span>T, </span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">test=</span>T)<span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="center-table">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge_grant_23_24, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,T<span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance(1) and no Polysubstance use (0)"</span>, <span class="at">escape=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 35 values (70%) of ‘characteristic’ (35 fewer NA)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(size=10, format="html",caption= "Summary descriptives, by Baseline Treatment Status") %&gt;%     kableExtra::kable_classic()</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge_grant_23_24, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,T<span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"tab_car.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 35 values (70%) of ‘characteristic’ (35 fewer NA)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Urbanicity**: class 6, less in rural; class 2, more in rural; class 1, more in mixta</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Age at TOP application**: class 4, younger; class 2, older; class 1, a bit older</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Psychiatric comorbidity** class 5 &amp; 3, Less wihtout diagnosis; class 2 &amp; 4, more without diagnosis</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Drug dependence** Class 2 &amp; 4, less drug dependence status</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Initial substance** class 1 &amp; 2, more alcohol; class 3 &amp; 4, less alcohol; Class 3 &amp;4, more marijuana, class 2, less marijuana; Class 5, more paste base; Class 1 &amp; 4, less paste base;</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Substance use frequency (primary substance)**: Class 2: less daily; Class 3 &amp; 5, more Less than 1 day a week; Class 3 &amp; 4, less Less than 1 day a week</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Marital status**: Class 2 mre married; Class 3 less married</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Biopsychosocial compromise**: Class 3 &amp; 5 more Severe and less Mild; Class 2 &amp; 6 more Moderate</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Macrozone**: Class 3 &amp; 5, more North; Class 4 &amp; 6, less North; Class 3 &amp; 5, less South; Class 2, more South; </span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Educational Attainment**: Class 2, more completed primary school or less; Class 4, less completed primary school or less; Class 1 &amp; 4, more More than high school</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Tr. completion**: Class 2 completed more; Class 3 completed less</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="co"># - **Reported offenses (TOP)**: Less, Class 2; More, Class 3 &amp; 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Summary descriptives, Polysubstance(1) and no Polysubstance use (0)</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">characteristic</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;">3</th>
<th style="text-align: left;">4</th>
<th style="text-align: left;">5</th>
<th style="text-align: left;">6</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>n</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>1730</strong></td>
<td style="text-align: left;"><strong>160</strong></td>
<td style="text-align: left;"><strong>507</strong></td>
<td style="text-align: left;"><strong>292</strong></td>
<td style="text-align: left;"><strong>109</strong></td>
<td style="text-align: left;"><strong>320</strong></td>
<td style="text-align: left;"><strong>231</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Mixta</td>
<td style="text-align: left;">206 (11.9)</td>
<td style="text-align: left;">23 (14.4)</td>
<td style="text-align: left;">59 (11.6)</td>
<td style="text-align: left;">29 ( 9.9)</td>
<td style="text-align: left;">9 ( 8.3)</td>
<td style="text-align: left;">38 (11.9)</td>
<td style="text-align: left;">30 (13.0)</td>
<td style="text-align: left;">0.004</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">148 ( 8.6)</td>
<td style="text-align: left;">13 ( 8.1)</td>
<td style="text-align: left;">65 (12.8)</td>
<td style="text-align: left;">21 ( 7.2)</td>
<td style="text-align: left;">8 ( 7.3)</td>
<td style="text-align: left;">22 ( 6.9)</td>
<td style="text-align: left;">8 ( 3.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Urbanicity (%)</td>
<td style="text-align: left;">Urbana</td>
<td style="text-align: left;">1376 (79.5)</td>
<td style="text-align: left;">124 (77.5)</td>
<td style="text-align: left;">383 (75.5)</td>
<td style="text-align: left;">242 (82.9)</td>
<td style="text-align: left;">92 (84.4)</td>
<td style="text-align: left;">260 (81.2)</td>
<td style="text-align: left;">193 (83.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without physical comorbidity</td>
<td style="text-align: left;">594 (34.3)</td>
<td style="text-align: left;">46 (28.7)</td>
<td style="text-align: left;">162 (32.0)</td>
<td style="text-align: left;">105 (36.0)</td>
<td style="text-align: left;">34 (31.2)</td>
<td style="text-align: left;">117 (36.6)</td>
<td style="text-align: left;">93 (40.3)</td>
<td style="text-align: left;">0.065</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.153</td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">1016 (58.7)</td>
<td style="text-align: left;">103 (64.4)</td>
<td style="text-align: left;">299 (59.0)</td>
<td style="text-align: left;">175 (59.9)</td>
<td style="text-align: left;">65 (59.6)</td>
<td style="text-align: left;">187 (58.4)</td>
<td style="text-align: left;">125 (54.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">One or more</td>
<td style="text-align: left;">120 ( 6.9)</td>
<td style="text-align: left;">11 ( 6.9)</td>
<td style="text-align: left;">46 ( 9.1)</td>
<td style="text-align: left;">12 ( 4.1)</td>
<td style="text-align: left;">10 ( 9.2)</td>
<td style="text-align: left;">16 ( 5.0)</td>
<td style="text-align: left;">13 ( 5.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at TOP application (b) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.86 [28.37, 43.79]</td>
<td style="text-align: left;">36.00 [29.32, 44.40]</td>
<td style="text-align: left;">42.55 [33.99, 52.21]</td>
<td style="text-align: left;">30.05 [25.12, 35.64]</td>
<td style="text-align: left;">29.95 [24.97, 35.82]</td>
<td style="text-align: left;">33.95 [28.25, 39.63]</td>
<td style="text-align: left;">32.07 [27.42, 37.46]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.546</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comorbidity_icd_10 (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">342 (19.8)</td>
<td style="text-align: left;">37 (23.1)</td>
<td style="text-align: left;">77 (15.2)</td>
<td style="text-align: left;">80 (27.4)</td>
<td style="text-align: left;">20 (18.3)</td>
<td style="text-align: left;">75 (23.4)</td>
<td style="text-align: left;">36 (15.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.241</td>
</tr>
<tr class="even">
<td style="text-align: left;">comorbidity_icd_10 (%)</td>
<td style="text-align: left;">One</td>
<td style="text-align: left;">799 (46.2)</td>
<td style="text-align: left;">75 (46.9)</td>
<td style="text-align: left;">215 (42.4)</td>
<td style="text-align: left;">133 (45.5)</td>
<td style="text-align: left;">42 (38.5)</td>
<td style="text-align: left;">155 (48.4)</td>
<td style="text-align: left;">119 (51.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">comorbidity_icd_10 (%)</td>
<td style="text-align: left;">Two or more</td>
<td style="text-align: left;">41 ( 2.4)</td>
<td style="text-align: left;">4 ( 2.5)</td>
<td style="text-align: left;">9 ( 1.8)</td>
<td style="text-align: left;">6 ( 2.1)</td>
<td style="text-align: left;">3 ( 2.8)</td>
<td style="text-align: left;">10 ( 3.1)</td>
<td style="text-align: left;">5 ( 2.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">comorbidity_icd_10 (%)</td>
<td style="text-align: left;">Without psychiatric comorbidity</td>
<td style="text-align: left;">548 (31.7)</td>
<td style="text-align: left;">44 (27.5)</td>
<td style="text-align: left;">206 (40.6)</td>
<td style="text-align: left;">73 (25.0)</td>
<td style="text-align: left;">44 (40.4)</td>
<td style="text-align: left;">80 (25.0)</td>
<td style="text-align: left;">71 (30.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Drug dependence</td>
<td style="text-align: left;">1310 (75.7)</td>
<td style="text-align: left;">122 (76.2)</td>
<td style="text-align: left;">337 (66.5)</td>
<td style="text-align: left;">250 (85.6)</td>
<td style="text-align: left;">75 (68.8)</td>
<td style="text-align: left;">269 (84.1)</td>
<td style="text-align: left;">181 (78.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.229</td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Hazardous consumption</td>
<td style="text-align: left;">420 (24.3)</td>
<td style="text-align: left;">38 (23.8)</td>
<td style="text-align: left;">170 (33.5)</td>
<td style="text-align: left;">42 (14.4)</td>
<td style="text-align: left;">34 (31.2)</td>
<td style="text-align: left;">51 (15.9)</td>
<td style="text-align: left;">50 (21.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Alone</td>
<td style="text-align: left;">180 (10.4)</td>
<td style="text-align: left;">17 (10.6)</td>
<td style="text-align: left;">68 (13.4)</td>
<td style="text-align: left;">21 ( 7.2)</td>
<td style="text-align: left;">8 ( 7.3)</td>
<td style="text-align: left;">33 (10.3)</td>
<td style="text-align: left;">22 ( 9.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.309</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Family of origin</td>
<td style="text-align: left;">733 (42.4)</td>
<td style="text-align: left;">59 (36.9)</td>
<td style="text-align: left;">156 (30.8)</td>
<td style="text-align: left;">156 (53.4)</td>
<td style="text-align: left;">57 (52.3)</td>
<td style="text-align: left;">141 (44.1)</td>
<td style="text-align: left;">109 (47.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">161 ( 9.3)</td>
<td style="text-align: left;">19 (11.9)</td>
<td style="text-align: left;">47 ( 9.3)</td>
<td style="text-align: left;">28 ( 9.6)</td>
<td style="text-align: left;">3 ( 2.8)</td>
<td style="text-align: left;">38 (11.9)</td>
<td style="text-align: left;">12 ( 5.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">With couple/children</td>
<td style="text-align: left;">656 (37.9)</td>
<td style="text-align: left;">65 (40.6)</td>
<td style="text-align: left;">236 (46.5)</td>
<td style="text-align: left;">87 (29.8)</td>
<td style="text-align: left;">41 (37.6)</td>
<td style="text-align: left;">108 (33.8)</td>
<td style="text-align: left;">88 (38.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sus_ini_mod (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">981 (56.7)</td>
<td style="text-align: left;">120 (75.0)</td>
<td style="text-align: left;">370 (73.0)</td>
<td style="text-align: left;">93 (31.8)</td>
<td style="text-align: left;">33 (30.3)</td>
<td style="text-align: left;">166 (51.9)</td>
<td style="text-align: left;">133 (57.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.690</td>
</tr>
<tr class="even">
<td style="text-align: left;">sus_ini_mod (%)</td>
<td style="text-align: left;">Cocaína</td>
<td style="text-align: left;">81 ( 4.7)</td>
<td style="text-align: left;">4 ( 2.5)</td>
<td style="text-align: left;">16 ( 3.2)</td>
<td style="text-align: left;">8 ( 2.7)</td>
<td style="text-align: left;">14 (12.8)</td>
<td style="text-align: left;">4 ( 1.2)</td>
<td style="text-align: left;">25 (10.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sus_ini_mod (%)</td>
<td style="text-align: left;">Marihuana</td>
<td style="text-align: left;">512 (29.6)</td>
<td style="text-align: left;">25 (15.6)</td>
<td style="text-align: left;">68 (13.4)</td>
<td style="text-align: left;">159 (54.5)</td>
<td style="text-align: left;">57 (52.3)</td>
<td style="text-align: left;">112 (35.0)</td>
<td style="text-align: left;">66 (28.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sus_ini_mod (%)</td>
<td style="text-align: left;">Otros</td>
<td style="text-align: left;">47 ( 2.7)</td>
<td style="text-align: left;">6 ( 3.8)</td>
<td style="text-align: left;">13 ( 2.6)</td>
<td style="text-align: left;">9 ( 3.1)</td>
<td style="text-align: left;">2 ( 1.8)</td>
<td style="text-align: left;">6 ( 1.9)</td>
<td style="text-align: left;">4 ( 1.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">sus_ini_mod (%)</td>
<td style="text-align: left;">Pasta Base</td>
<td style="text-align: left;">108 ( 6.2)</td>
<td style="text-align: left;">5 ( 3.1)</td>
<td style="text-align: left;">40 ( 7.9)</td>
<td style="text-align: left;">22 ( 7.5)</td>
<td style="text-align: left;">3 ( 2.8)</td>
<td style="text-align: left;">32 (10.0)</td>
<td style="text-align: left;">3 ( 1.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">sus_ini_mod (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.3)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">1 day a week or more</td>
<td style="text-align: left;">106 ( 6.1)</td>
<td style="text-align: left;">6 ( 3.8)</td>
<td style="text-align: left;">43 ( 8.5)</td>
<td style="text-align: left;">11 ( 3.8)</td>
<td style="text-align: left;">9 ( 8.3)</td>
<td style="text-align: left;">8 ( 2.5)</td>
<td style="text-align: left;">19 ( 8.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.326</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">2 to 3 days a week</td>
<td style="text-align: left;">391 (22.6)</td>
<td style="text-align: left;">45 (28.1)</td>
<td style="text-align: left;">128 (25.2)</td>
<td style="text-align: left;">43 (14.7)</td>
<td style="text-align: left;">27 (24.8)</td>
<td style="text-align: left;">58 (18.1)</td>
<td style="text-align: left;">55 (23.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">4 to 6 days a week</td>
<td style="text-align: left;">275 (15.9)</td>
<td style="text-align: left;">28 (17.5)</td>
<td style="text-align: left;">86 (17.0)</td>
<td style="text-align: left;">49 (16.8)</td>
<td style="text-align: left;">12 (11.0)</td>
<td style="text-align: left;">51 (15.9)</td>
<td style="text-align: left;">38 (16.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Daily</td>
<td style="text-align: left;">872 (50.4)</td>
<td style="text-align: left;">74 (46.2)</td>
<td style="text-align: left;">212 (41.8)</td>
<td style="text-align: left;">180 (61.6)</td>
<td style="text-align: left;">59 (54.1)</td>
<td style="text-align: left;">191 (59.7)</td>
<td style="text-align: left;">106 (45.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Less than 1 day a week</td>
<td style="text-align: left;">78 ( 4.5)</td>
<td style="text-align: left;">7 ( 4.4)</td>
<td style="text-align: left;">35 ( 6.9)</td>
<td style="text-align: left;">8 ( 2.7)</td>
<td style="text-align: left;">1 ( 0.9)</td>
<td style="text-align: left;">11 ( 3.4)</td>
<td style="text-align: left;">12 ( 5.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">8 ( 0.5)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">3 ( 0.6)</td>
<td style="text-align: left;">1 ( 0.3)</td>
<td style="text-align: left;">1 ( 0.9)</td>
<td style="text-align: left;">1 ( 0.3)</td>
<td style="text-align: left;">1 ( 0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">estado_conyugal_2 (%)</td>
<td style="text-align: left;">Married/Shared living arrangements</td>
<td style="text-align: left;">544 (31.4)</td>
<td style="text-align: left;">45 (28.1)</td>
<td style="text-align: left;">210 (41.4)</td>
<td style="text-align: left;">63 (21.6)</td>
<td style="text-align: left;">32 (29.4)</td>
<td style="text-align: left;">91 (28.4)</td>
<td style="text-align: left;">76 (32.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.273</td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_conyugal_2 (%)</td>
<td style="text-align: left;">Separated/Divorced</td>
<td style="text-align: left;">186 (10.8)</td>
<td style="text-align: left;">17 (10.6)</td>
<td style="text-align: left;">76 (15.0)</td>
<td style="text-align: left;">23 ( 7.9)</td>
<td style="text-align: left;">6 ( 5.5)</td>
<td style="text-align: left;">29 ( 9.1)</td>
<td style="text-align: left;">20 ( 8.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">estado_conyugal_2 (%)</td>
<td style="text-align: left;">Single</td>
<td style="text-align: left;">975 (56.4)</td>
<td style="text-align: left;">97 (60.6)</td>
<td style="text-align: left;">205 (40.4)</td>
<td style="text-align: left;">205 (70.2)</td>
<td style="text-align: left;">70 (64.2)</td>
<td style="text-align: left;">197 (61.6)</td>
<td style="text-align: left;">133 (57.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">estado_conyugal_2 (%)</td>
<td style="text-align: left;">Widower</td>
<td style="text-align: left;">23 ( 1.3)</td>
<td style="text-align: left;">1 ( 0.6)</td>
<td style="text-align: left;">14 ( 2.8)</td>
<td style="text-align: left;">1 ( 0.3)</td>
<td style="text-align: left;">1 ( 0.9)</td>
<td style="text-align: left;">3 ( 0.9)</td>
<td style="text-align: left;">2 ( 0.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">estado_conyugal_2 (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">2 ( 0.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">2 ( 0.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">compromiso_biopsicosocial (%)</td>
<td style="text-align: left;">1-Mild</td>
<td style="text-align: left;">137 ( 7.9)</td>
<td style="text-align: left;">13 ( 8.1)</td>
<td style="text-align: left;">72 (14.2)</td>
<td style="text-align: left;">9 ( 3.1)</td>
<td style="text-align: left;">7 ( 6.4)</td>
<td style="text-align: left;">10 ( 3.1)</td>
<td style="text-align: left;">18 ( 7.8)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">compromiso_biopsicosocial (%)</td>
<td style="text-align: left;">2-Moderate</td>
<td style="text-align: left;">857 (49.5)</td>
<td style="text-align: left;">87 (54.4)</td>
<td style="text-align: left;">286 (56.4)</td>
<td style="text-align: left;">122 (41.8)</td>
<td style="text-align: left;">56 (51.4)</td>
<td style="text-align: left;">124 (38.8)</td>
<td style="text-align: left;">136 (58.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">compromiso_biopsicosocial (%)</td>
<td style="text-align: left;">3-Severe</td>
<td style="text-align: left;">697 (40.3)</td>
<td style="text-align: left;">59 (36.9)</td>
<td style="text-align: left;">137 (27.0)</td>
<td style="text-align: left;">154 (52.7)</td>
<td style="text-align: left;">43 (39.4)</td>
<td style="text-align: left;">178 (55.6)</td>
<td style="text-align: left;">74 (32.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">compromiso_biopsicosocial (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">39 ( 2.3)</td>
<td style="text-align: left;">1 ( 0.6)</td>
<td style="text-align: left;">12 ( 2.4)</td>
<td style="text-align: left;">7 ( 2.4)</td>
<td style="text-align: left;">3 ( 2.8)</td>
<td style="text-align: left;">8 ( 2.5)</td>
<td style="text-align: left;">3 ( 1.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">Center</td>
<td style="text-align: left;">1295 (74.9)</td>
<td style="text-align: left;">123 (76.9)</td>
<td style="text-align: left;">355 (70.0)</td>
<td style="text-align: left;">216 (74.0)</td>
<td style="text-align: left;">96 (88.1)</td>
<td style="text-align: left;">221 (69.1)</td>
<td style="text-align: left;">207 (89.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">North</td>
<td style="text-align: left;">269 (15.5)</td>
<td style="text-align: left;">21 (13.1)</td>
<td style="text-align: left;">71 (14.0)</td>
<td style="text-align: left;">65 (22.3)</td>
<td style="text-align: left;">6 ( 5.5)</td>
<td style="text-align: left;">84 (26.2)</td>
<td style="text-align: left;">5 ( 2.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">166 ( 9.6)</td>
<td style="text-align: left;">16 (10.0)</td>
<td style="text-align: left;">81 (16.0)</td>
<td style="text-align: left;">11 ( 3.8)</td>
<td style="text-align: left;">7 ( 6.4)</td>
<td style="text-align: left;">15 ( 4.7)</td>
<td style="text-align: left;">19 ( 8.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">1-More than high school</td>
<td style="text-align: left;">241 (13.9)</td>
<td style="text-align: left;">30 (18.8)</td>
<td style="text-align: left;">64 (12.6)</td>
<td style="text-align: left;">30 (10.3)</td>
<td style="text-align: left;">24 (22.0)</td>
<td style="text-align: left;">34 (10.6)</td>
<td style="text-align: left;">41 (17.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.268</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">2-Completed high school or less</td>
<td style="text-align: left;">954 (55.1)</td>
<td style="text-align: left;">85 (53.1)</td>
<td style="text-align: left;">244 (48.1)</td>
<td style="text-align: left;">171 (58.6)</td>
<td style="text-align: left;">65 (59.6)</td>
<td style="text-align: left;">184 (57.5)</td>
<td style="text-align: left;">142 (61.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">3-Completed primary school or less</td>
<td style="text-align: left;">532 (30.8)</td>
<td style="text-align: left;">45 (28.1)</td>
<td style="text-align: left;">197 (38.9)</td>
<td style="text-align: left;">91 (31.2)</td>
<td style="text-align: left;">20 (18.3)</td>
<td style="text-align: left;">102 (31.9)</td>
<td style="text-align: left;">48 (20.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">3 ( 0.2)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">2 ( 0.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Event: tr.completion (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1231 (71.2)</td>
<td style="text-align: left;">116 (72.5)</td>
<td style="text-align: left;">327 (64.5)</td>
<td style="text-align: left;">225 (77.1)</td>
<td style="text-align: left;">81 (74.3)</td>
<td style="text-align: left;">241 (75.3)</td>
<td style="text-align: left;">164 (71.0)</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.115</td>
</tr>
<tr class="even">
<td style="text-align: left;">Event: tr.completion (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">499 (28.8)</td>
<td style="text-align: left;">44 (27.5)</td>
<td style="text-align: left;">180 (35.5)</td>
<td style="text-align: left;">67 (22.9)</td>
<td style="text-align: left;">28 (25.7)</td>
<td style="text-align: left;">79 (24.7)</td>
<td style="text-align: left;">67 (29.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">tot_off_top_bin (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1251 (72.3)</td>
<td style="text-align: left;">110 (68.8)</td>
<td style="text-align: left;">398 (78.5)</td>
<td style="text-align: left;">195 (66.8)</td>
<td style="text-align: left;">79 (72.5)</td>
<td style="text-align: left;">213 (66.6)</td>
<td style="text-align: left;">175 (75.8)</td>
<td style="text-align: left;">0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.135</td>
</tr>
<tr class="even">
<td style="text-align: left;">tot_off_top_bin (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">479 (27.7)</td>
<td style="text-align: left;">50 (31.2)</td>
<td style="text-align: left;">109 (21.5)</td>
<td style="text-align: left;">97 (33.2)</td>
<td style="text-align: left;">30 (27.5)</td>
<td style="text-align: left;">107 (33.4)</td>
<td style="text-align: left;">56 (24.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>1. Class 1 Alcohol Primary, Diverse Secondary (n=160):</strong> Primarily urban (77.5%), with a mixed representation (urban-rural setting) at 14.4%. Physical Comorbidity (ICD-10): The majority (64.4%) have a diagnosis that is under study, while 28.7% have no physical comorbidity. Age: Median age at TOP application is 36.00 years. Slightly older than the rest of groups. Substance Use Disorder (SUD) Severity: Most (76.2%) show drug dependence. Cohabitation Status: Most live with their couple or children (40.6%) or with their family of origin (36.9%). Substance Initiated With: The majority started with Alcohol (75.0%), which is higher than the rest. Also, less patients initiated with paste base. Frequency of Substance Use: Most (46.2%) use the primary substance daily. Marital Status: The majority are single (60.6%). Edducational attainment: Higher educational attainment (more than highschool).</p>
<p><strong>2. Class 2 Alcohol Exclusive (n=507):</strong> Predominantly urban (75.5%), but with more people in rural settings. Majority’s physical comorbidity diagnosis is unknown (59%). Median age at TOP application is 42.55 years, with older individuals than the rest of classes. 66.5% show drug dependence. Most live with their couple or children (46.5%). Majority started with Alcohol (73%). 41.8% use the primary substance daily. Most are single (40.4%).</p>
<p><strong>3. Class 3 Cocaine Paste Primary, Marijuana-Alcohol Mix (n=292):</strong> Predominantly urban (82.9%). More concentrated in urban settings. 59.9% have an unknown physical comorbidity diagnosis. Less individuals with psychiatric diagnosis. Younger median age at TOP application: 30.05 years. High drug dependence (85.6%). Majority live with their family of origin (53.4%). A significant proportion started with Marijuana (54.5%). Less started with Alcohol. A majority (61.6%) use the primary substance daily. But more use less than 1 day a week. Most are single (70.2%). More had a</p>
<p><strong>4. Class 4 Cocaine Paste Primary, Marijuana-Alcohol Mix (n=109):</strong> Urban-centric (84.4%), less in rural settings. 59.6% have an unknown physical comorbidity diagnosis. Young age group with a median age at TOP application of 29.95 years. Is one of the youngest groups. 68.8% show drug dependence. Less drug dependence status than the rest of classes. Most live with their family of origin (52.3%). Many initiated with Marijuana (52.3%). The class with lower initiations with alcohol and paste base. 54.1% use the primary substance daily, lower Less than 1 day a week. Majority are single (64.2%). Less lived in the North, than the rest of classes</p>
<p><strong>5. Class 5 Cocaine Paste Dominant, Alcohol Secondary (n=320):</strong> Mostly urban (81.2%). The majority’s physical comorbidity diagnosis is unknown (58.4%), with more people without a psychiatric diagnosis than the rest. Median age at TOP application is 33.95 years. High drug dependence (84.1%). Majority live with their family of origin (44.1%). Many initiated with Alcohol (51.9%) and is the group with higher initiation with paste base. Most (59.7%) use the primary substance daily, but with a higher percentage of less than 1 day a week. Majority are single (61.6%). More were from the north and less from the south. More reported offenses in TOP.</p>
<p><strong>6. Class 6 Cocaine Hydrochloride Primary, Alcohol-Marijuana Mix (n=231):</strong> Urban dominated (83.5%), with less in urban settings. 54.1% have an unknown physical comorbidity diagnosis. Median age at TOP application is 32.07 years. 78.4% have drug dependence. More had a moderate biopsychosocial compromise. Less lived in the North macrozones. Majority live with their family of origin (47.2%). Majority initiated with Alcohol (57.6%). 45.9% use the primary substance daily. Most are single (57.6%).</p>
<p><br></p>
</section>
</section>
<section id="mca" class="level1">
<h1>MCA</h1>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/factoextra/factoextra.pdf</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># http://www.sthda.com/english/wiki/factoextra-r-package-easy-multivariate-data-analyses-and-elegant-visualization</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"FactoMineR"</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"factoextra"</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>res.mca <span class="ot">&lt;-</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">MCA</span>(mydata_preds2[,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(mydata_preds2)<span class="sc">-</span><span class="dv">1</span>)], </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncp =</span> <span class="dv">5</span>, <span class="co">#number of dimensions kept in the results default=5</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">graph =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(res.mca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>cats <span class="ot">=</span> <span class="fu">apply</span>(mydata_preds2[,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(mydata_preds2)<span class="sc">-</span><span class="dv">1</span>)], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(x)))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>mca1_vars_df <span class="ot">=</span> <span class="fu">data.frame</span>(res.mca<span class="sc">$</span>var<span class="sc">$</span>coord, <span class="at">Variable =</span> <span class="fu">rep</span>(<span class="fu">names</span>(cats), </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    cats))</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>mca1_obs_df <span class="ot">=</span> <span class="fu">data.frame</span>(res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of variable categories</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mca1_vars_df, <span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>, <span class="at">label =</span> <span class="fu">rownames</span>(mca1_vars_df))) <span class="sc">+</span> </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Variable)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"MCA plot of variables using R package FactoMineR"</span>)<span class="sc">+</span> <span class="fu">geom_density2d</span>(<span class="at">colour =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: The following aesthetics were dropped during statistical transformation: label i This can happen when ggplot fails to infer the correct grouping structure in the data. i Did you forget to specify a <code>group</code> aesthetic or to convert a numerical variable into a factor?</p>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Another analysis of heterogeneity</p>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(homals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Loading required package: homals</p>
</div>
<div class="alert alert-warning">
<p>Warning: package ‘homals’ was built under R version 4.1.3</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>mca5 <span class="ot">=</span> <span class="fu">homals</span>(mydata_preds2[,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(mydata_preds2)<span class="sc">-</span><span class="dv">1</span>)], <span class="at">ndim =</span> <span class="dv">5</span>, <span class="at">level =</span> <span class="st">"nominal"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>mca5<span class="sc">$</span>eigenvalues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05388169 0.04315900 0.03568733 0.03546626 0.03273872</code></pre>
</div>
</div>
</div>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># homogeneity analysis, aka a multiple correspondence analysis, but with many additional options.</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame for ggplot</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>D1 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">1</span>]))</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>D2 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">2</span>]))</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>mca5_vars_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">D1 =</span> D1, <span class="at">D2 =</span> D2, <span class="at">Variable =</span> <span class="fu">rep</span>(<span class="fu">names</span>(cats), </span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    cats))</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mca5_vars_df)<span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">rownames</span>(mca5_vars_df),<span class="st">"sus_principal_mod"</span>,<span class="st">"s_pr"</span>),<span class="st">"otras_sus"</span>,<span class="st">"otr_"</span>),<span class="st">"_mod"</span>,<span class="st">""</span>)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>D3 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">3</span>]))</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>D4 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">4</span>]))</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>mca5_vars_df2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">D3 =</span> D3, <span class="at">D4 =</span> D4, <span class="at">Variable =</span> <span class="fu">rep</span>(<span class="fu">names</span>(cats), </span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    cats))</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>ct<span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">sapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) <span class="fu">rownames</span>(x)))</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mca5_vars_df2)<span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">rownames</span>(mca5_vars_df2),<span class="st">"sus_principal_mod"</span>,<span class="st">"s_pr"</span>),<span class="st">"otras_sus"</span>,<span class="st">"otr_"</span>),<span class="st">"_mod"</span>,<span class="st">""</span>)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mca5_vars_df, <span class="fu">aes</span>(<span class="at">x =</span> D1, <span class="at">y =</span> D2, <span class="at">label =</span> <span class="fu">rownames</span>(mca5_vars_df))) <span class="sc">+</span> </span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Variable)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"MCA plot of variables using R package homals"</span>)<span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-251-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Homals Dimensiones 1 y 2</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA plot of variable categories</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mca5_vars_df2, <span class="fu">aes</span>(<span class="at">x =</span> D3, <span class="at">y =</span> D4, <span class="at">label =</span> <span class="fu">rownames</span>(mca5_vars_df2))) <span class="sc">+</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Variable)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"MCA plot of variables using R package homals"</span>)<span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-252-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Homals Dimensiones 3 y 4</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="imputation-and-export" class="level1">
<h1>Imputation and export</h1>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(missRanger)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v16_grant_23_24_miss <span class="ot">&lt;-</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)<span class="sc">~</span>T,T<span class="sc">~</span>F))</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"no_mostrar"</span>)){</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(hash_key, edad_al_ing_1) <span class="sc">%&gt;%</span> </span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>     missRanger<span class="sc">::</span><span class="fu">missRanger</span>(</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> .  <span class="sc">-</span>offender_d <span class="sc">-</span> age_tr_comp_imp <span class="sc">~</span> . <span class="sc">-</span> hash_key <span class="sc">-</span>offender_d <span class="sc">-</span> age_tr_comp_imp,</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">num.trees =</span> <span class="dv">200</span>, </span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">pmm.k =</span> <span class="dv">3</span>,                </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">returnOOB=</span>T,</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">maxiter=</span> <span class="dv">50</span>,</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="dv">2</span>, </span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">seed =</span> <span class="dv">2125</span>)</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#should drop:</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># event_offense age_dropout_imp event_comp age_at_censor_date time_to_off_from_adm time_to_drop_from_adm edad_comision_imp fec_comision_simple_2 relacion_vifsaf_2</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>  values_pris<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0013</span>, <span class="fl">0.0053</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0158</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">6e-04</span>, <span class="fl">0.0024</span>, <span class="fl">0.0024</span>, <span class="fl">5e-04</span>, <span class="fl">0.0285</span>)</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"Mdn= "</span>,<span class="fu">median</span>(values_pris),<span class="st">" Q1= "</span>,<span class="fu">quantile</span>(values_pris,.<span class="dv">25</span>),<span class="st">", Q3= "</span>, <span class="fu">quantile</span>(values_pris, .<span class="dv">75</span>))</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="export" class="level1">
<h1>Export</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-01-01 we had a problem with edad_al_ing_fmt. This variable predict better (it had lower amount of missing data and was in wide format)</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#cont_vars_desc[1]&lt;-ifelse(cont_vars_desc[1]=="edad_al_ing_fmt","edad_al_ing_1",cont_vars_desc[1])</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> </span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(hash_key, fech_ing_num_1)  <span class="sc">%&gt;%</span> </span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"an_grant_23_24.dta"</span>))</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPUTATION</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v16_grant_23_24_miss <span class="sc">%&gt;%</span> </span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(hash_key, fech_ing_num_1)  <span class="sc">%&gt;%</span> </span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"an_grant_23_24_miss.dta"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="explore-trajectories" class="level1">
<h1>Explore trajectories</h1>
</section>
<section id="adjusted-logistic-regression" class="level1">
<h1>Adjusted Logistic regression</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Our simulation-based approach to the estimation of mediation effects enables users to deal with missing data via standard multiple imputation procedures in a straightforward fashion. The mediation package includes a pair of utility functions – mediations and amelidiate– to facilitate such analysis. First, users simulate multiple data sets using their preferredimputation software. Next, run mediate on each data set by simply passing the data setsthrough mediations. Next, pass the output of mediations to the amelidiate function, which combines the components of the output from mediations into a format that can be analyzed with the standard summary and plot commands.5 Alternatively, users can manually run mediate on their imputed data sets and simply stack the vectors of quantities they are interested in, and use basic functions like quantile to calculate confidence intervals.</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co">#, sims = 100        Simulations: 100</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"MatchIt"</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Base_fiscalia_v16_grant_23_24 %&gt;%</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  dplyr::filter(dplyr::case_when(!motivodeegreso_mod_imp_1 %in% c("Derivación","En curso") &amp; !is.na(tot_off_top)~T,T~F))</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>variables_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, <span class="st">"escolaridad_rec"</span>, <span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, <span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, <span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, <span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"n_off_vict"</span>)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co">#edad_ini_cons macrozona estado_conyugal_2  con_quien_vive   numero_de_hijos_mod origen_ingreso_mod  tenencia_de_la_vivienda_mod rubro_trabaja_mod  condicion_ocupacional_corr     </span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">#mot_egres_mod_imp_rec_num     </span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co">#clasificacion                 </span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co">#porc_pobr</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co">#numero_de_hijos_mod_joel</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="co">#ano_nac_corr </span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a><span class="co">#num_hijos_mod_joel_bin</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a><span class="co">#fis_comorbidity_icd_10</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="co">#clas_r</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="co">#tot_off_top</span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="co">#get a matched cohort of people by polysubstance use</span></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>m.out3 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(policonsumo <span class="sc">~</span> <span class="fu">rcs</span>(edad_al_ing_1, <span class="dv">4</span>) <span class="sc">+</span> sex <span class="sc">+</span> edad_ini_cons <span class="sc">+</span> escolaridad_rec <span class="sc">+</span> condicion_ocupacional_corr <span class="sc">+</span> num_hijos_mod_joel_bin <span class="sc">+</span> tenencia_de_la_vivienda_mod <span class="sc">+</span> macrozona <span class="sc">+</span> n_off_vio <span class="sc">+</span> n_off_acq <span class="sc">+</span> n_off_sud <span class="sc">+</span> n_off_oth <span class="sc">+</span> dg_cie_10_rec <span class="sc">+</span> dg_trs_cons_sus_or <span class="sc">+</span> clas_r <span class="sc">+</span> porc_pobr <span class="sc">+</span> sus_ini_mod_mvv <span class="sc">+</span> ano_nac_corr <span class="sc">+</span> con_quien_vive_joel <span class="sc">+</span> fis_comorbidity_icd_10<span class="sc">+</span> n_off_vict, </span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Base_fiscalia_v16_grant_23_24 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span>motivodeegreso_mod_imp_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Derivación"</span>,<span class="st">"En curso"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tot_off_top)<span class="sc">~</span>T,T<span class="sc">~</span>F)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(variables_vector),</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#Base_fiscalia_v16_grant_23_24[complete.cases(Base_fiscalia_v16_grant_23_24[,..variables_vector]),], </span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"nearest"</span>, </span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">discard =</span> <span class="st">"both"</span>,</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">caliper =</span> .<span class="dv">05</span>, </span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">standardize =</span> T)</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>cobalt<span class="sc">::</span><span class="fu">bal.tab</span>(m.out3, <span class="at">un =</span> <span class="cn">TRUE</span>, <span class="at">m.threshold =</span> .<span class="dv">1</span>, </span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">v.threshold =</span> <span class="dv">2</span>))</span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("MatchThem")</span></span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a><span class="co"># require(MatchThem)</span></span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/MatchThem/MatchThem.pdf</span></span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a>imputed.datasets <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(Base_fiscalia_v15f_grant_23_24,<span class="fu">c</span>(variables_vector,<span class="st">"edad_al_ing_1"</span>,<span class="st">"policonsumo"</span>,<span class="st">"time_to_off_from_adm"</span>,<span class="st">"time_to_drop_from_adm"</span>,<span class="st">"event_death"</span>,<span class="st">"event_comp"</span>,<span class="st">"event_offense"</span>)), <span class="at">m =</span> <span class="dv">5</span>)</span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Currently, "within" (performing matching within each dataset) and "across" (estimating propensity scores within each dataset, averaging them across datasets, and performing matching using the averaged propensity scores in each dataset) approaches are available. The default is "within", which has been shown to have superior performance in most cases</span></span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Matching the multiply imputed datasets</span></span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a>matched.datasets <span class="ot">&lt;-</span> <span class="fu">matchthem</span>(policonsumo <span class="sc">~</span>  sex <span class="sc">+</span> edad_ini_cons <span class="sc">+</span> escolaridad_rec <span class="sc">+</span> condicion_ocupacional_corr <span class="sc">+</span> num_hijos_mod_joel_bin <span class="sc">+</span> tenencia_de_la_vivienda_mod <span class="sc">+</span> macrozona <span class="sc">+</span> n_off_vio <span class="sc">+</span> n_off_acq <span class="sc">+</span> n_off_sud <span class="sc">+</span> n_off_oth <span class="sc">+</span> dg_cie_10_rec <span class="sc">+</span> dg_trs_cons_sus_or <span class="sc">+</span> clas_r <span class="sc">+</span> porc_pobr <span class="sc">+</span> sus_ini_mod_mvv <span class="sc">+</span> ano_nac_corr <span class="sc">+</span> con_quien_vive_joel <span class="sc">+</span> fis_comorbidity_icd_10<span class="sc">+</span> n_off_vict,</span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a>imputed.datasets, <span class="at">approach =</span> <span class="st">'within'</span>, <span class="at">method =</span> <span class="st">'nearest'</span>)</span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Matching Observations  | dataset: #1Error: Missing values are not allowed in the covariates.</span></span>
<span id="cb112-46"><a href="#cb112-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-47"><a href="#cb112-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-48"><a href="#cb112-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Multiply imputing the missing values</span></span>
<span id="cb112-49"><a href="#cb112-49" aria-hidden="true" tabindex="-1"></a>imputed.datasets <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(osteoarthritis, <span class="at">m =</span> <span class="dv">5</span>)</span>
<span id="cb112-50"><a href="#cb112-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Matching the multiply imputed datasets</span></span>
<span id="cb112-51"><a href="#cb112-51" aria-hidden="true" tabindex="-1"></a>matched.datasets <span class="ot">&lt;-</span> <span class="fu">matchthem</span>(OSP <span class="sc">~</span> AGE <span class="sc">+</span> SEX <span class="sc">+</span> BMI <span class="sc">+</span> RAC <span class="sc">+</span> SMK,</span>
<span id="cb112-52"><a href="#cb112-52" aria-hidden="true" tabindex="-1"></a>                              imputed.datasets,</span>
<span id="cb112-53"><a href="#cb112-53" aria-hidden="true" tabindex="-1"></a>                              <span class="at">approach =</span> <span class="st">'within'</span>,</span>
<span id="cb112-54"><a href="#cb112-54" aria-hidden="true" tabindex="-1"></a>                              <span class="at">method =</span> <span class="st">'nearest'</span>)</span>
<span id="cb112-55"><a href="#cb112-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-56"><a href="#cb112-56" aria-hidden="true" tabindex="-1"></a><span class="co">#Multiply imputing the missing values</span></span>
<span id="cb112-57"><a href="#cb112-57" aria-hidden="true" tabindex="-1"></a>imputed.datasets <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(osteoarthritis, <span class="at">m =</span> <span class="dv">5</span>)</span>
<span id="cb112-58"><a href="#cb112-58" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimating weights of observations in the multiply imputed datasets</span></span>
<span id="cb112-59"><a href="#cb112-59" aria-hidden="true" tabindex="-1"></a>weighted.datasets <span class="ot">&lt;-</span> <span class="fu">weightthem</span>(OSP <span class="sc">~</span> AGE <span class="sc">+</span> SEX <span class="sc">+</span> BMI <span class="sc">+</span> RAC <span class="sc">+</span> SMK,</span>
<span id="cb112-60"><a href="#cb112-60" aria-hidden="true" tabindex="-1"></a>                              imputed.datasets,</span>
<span id="cb112-61"><a href="#cb112-61" aria-hidden="true" tabindex="-1"></a>                              <span class="at">approach =</span> <span class="st">'within'</span>,</span>
<span id="cb112-62"><a href="#cb112-62" aria-hidden="true" tabindex="-1"></a>                              <span class="at">method =</span> <span class="st">'ps'</span>,</span>
<span id="cb112-63"><a href="#cb112-63" aria-hidden="true" tabindex="-1"></a>                              <span class="at">estimand =</span> <span class="st">"ATT"</span>)</span>
<span id="cb112-64"><a href="#cb112-64" aria-hidden="true" tabindex="-1"></a><span class="co">#Analyzing the weighted datasets</span></span>
<span id="cb112-65"><a href="#cb112-65" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> weighted.datasets,</span>
<span id="cb112-66"><a href="#cb112-66" aria-hidden="true" tabindex="-1"></a><span class="at">exp =</span> <span class="fu">svyglm</span>(KOA <span class="sc">~</span> OSP, <span class="at">family =</span> binomial))</span>
<span id="cb112-67"><a href="#cb112-67" aria-hidden="true" tabindex="-1"></a><span class="co">#Pooling results obtained from analysing the datasets</span></span>
<span id="cb112-68"><a href="#cb112-68" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">pool</span>(models)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-paged.print="true">

</div>
<p><br></p>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell" data-paged.print="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"R library: "</span>, <span class="fu">Sys.getenv</span>(<span class="st">"R_LIBS_USER"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>R library: C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/renv/library/R-4.1/x86_64-w64-mingw32</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Date: "</span>,<span class="fu">Sys.Date</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Date: 2023-08-25</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Editor: "</span>, path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Editor: C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/env</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>sesion_info <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(sesion_info<span class="sc">$</span>packages),</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(package, loadedversion, source)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">filter =</span> <span class="st">'top'</span>, <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">'Row number'</span> <span class="ot">=</span><span class="dv">1</span>,<span class="st">'Package'</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">'Version'</span><span class="ot">=</span> <span class="dv">3</span>),</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left;'</span>,</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">''</span>, htmltools<span class="sc">::</span><span class="fu">em</span>(<span class="st">'R packages'</span>)),</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="at">initComplete =</span> htmlwidgets<span class="sc">::</span><span class="fu">JS</span>(</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$(this.api().tables().body()).css({</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-family': 'Helvetica Neue',</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-size': '50%', </span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="st">            'code-inline-font-size': '15%', </span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="st">            'white-space': 'nowrap',</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="st">            'line-height': '0.75em',</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="st">            'min-height': '0.5em'</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="st">            });"</span>,<span class="co">#;</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"}"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-3f83d25f23092657c32f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f83d25f23092657c32f">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption style=\"caption-side: top; text-align: left;\">\n  \n  <em>R packages<\/em>\n<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241"],["abind","admisc","ape","assertthat","backports","base64enc","BiocManager","bit","bit64","blob","bootstrap","broom","cachem","callr","car","carData","cellranger","checkmate","chron","class","cli","clisymbols","cluster","coda","codetools","colorspace","compareGroups","corrplot","cowplot","crayon","crosstalk","curl","data.table","DBI","dbplyr","deldir","deSolve","devtools","digest","doRNG","dplyr","DT","e1071","easyalluvial","ellipsis","emmeans","estimability","evaluate","factoextra","FactoMineR","fansi","farver","fastmap","flashClust","flexsurv","flextable","FNN","forcats","foreach","foreign","Formula","fs","future","future.apply","gargle","gdtools","generics","ggalluvial","ggiraph","ggplot2","ggpubr","ggrepel","ggridges","ggsignif","glca","globals","glue","googledrive","googlesheets4","gower","gridExtra","gsubfn","gtable","hardhat","HardyWeinberg","haven","highr","Hmisc","hms","homals","htmlTable","htmltools","htmlwidgets","httpuv","httr","interp","ipred","isoband","iterators","itertools","janitor","jpeg","jsonlite","jtools","kableExtra","KernSmooth","km.ci","KMsurv","knitr","labeling","labelled","later","lattice","latticeExtra","lava","lazyeval","leaps","lifecycle","listenv","lubridate","magrittr","MASS","Matrix","MatrixModels","memoise","mice","mime","miniUI","missForest","missRanger","mitools","modelr","mstate","muhaz","multcomp","multcompView","munsell","mvtnorm","nlme","nnet","numDeriv","officer","openxlsx","pacman","pander","parallelly","parcats","pillar","pkgbuild","pkgconfig","pkgload","plotly","plyr","png","polspline","polycor","prettyunits","processx","prodlim","profvis","progressr","promises","proto","proxy","ps","purrr","quadprog","quantreg","R6","ragg","randomForest","ranger","RColorBrewer","Rcpp","readr","readxl","recipes","remotes","renv","reprex","reshape2","reticulate","rio","rlang","rmarkdown","rmeta","rms","rngtools","rpart","Rsolnp","RSQLite","rstatix","rstudioapi","rvest","sandwich","scales","scatterplot3d","sessioninfo","shiny","snakecase","SparseM","sqldf","statmod","stringi","stringr","SuppDists","survcomp","survey","survival","survivalROC","survminer","survMisc","survRM2","svglite","systemfonts","tableone","textshaping","TH.data","tibble","tidylog","tidyr","tidyselect","tidyverse","timeDate","truncnorm","tzdb","urlchecker","usethis","utf8","uuid","vctrs","viridisLite","webshot","withr","writexl","xfun","xml2","xtable","yaml","zip","zoo"],["1.4-5","0.30","5.6-2","0.2.1","1.4.1","0.1-3","1.30.18","4.0.4","4.0.5","1.2.3","2019.6","1.0.1","1.0.6","3.7.2","3.1-1","3.0-5","1.1.0","2.1.0","2.3-58","7.3-20","3.4.1","1.2.0","2.1.4","0.19-4","0.2-19","2.0-3","4.5.1","0.92","1.1.1","1.5.2","1.2.0","4.3.3","1.14.2","1.1.3","2.2.1","1.0-6","1.34","2.4.5","0.6.29","1.8.2","1.0.10","0.26","1.7-11","0.3.1","0.3.2","1.8.1-1","1.4.1","0.17","1.0.7","2.8","1.0.3","2.1.1","1.1.0","1.01-2","2.2","0.8.2","1.1.3.1","0.5.2","1.5.2","0.8-83","1.2-4","1.5.2","1.28.0","1.10.0","1.2.1","0.2.4","0.1.3","0.12.3","0.8.3","3.4.1","0.4.0","0.9.1","0.5.4","0.6.4","1.3.3","0.16.1","1.6.2","2.0.0","1.0.1","1.0.0","2.3","0.7","0.3.1","1.2.0","1.7.5","2.5.1","0.9","4.7-1","1.1.2","1.0-10","2.4.1","0.5.3","1.5.4","1.6.6","1.4.4","1.1-3","0.9-13","0.2.6","1.0.14","0.1-3","2.1.0","0.1-9","1.8.2","2.2.0","1.3.4","2.23-20","0.5-6","0.1-5","1.40","0.4.2","2.10.0","1.3.0","0.20-45","0.6-30","1.6.10","0.2.2","3.1","1.0.3","0.8.0","1.8.0","2.0.3","7.3-58.1","1.5-1","0.5-1","2.0.1","3.14.0","0.12","0.1.1.1","1.5","2.1.3","2.4","0.1.9","0.3.2","1.2.6.4","1.4-20","0.1-9","0.5.0","1.1-3","3.1-159","7.3-18","2016.8-1.1","0.4.4","4.2.5","0.5.1","0.6.5","1.32.1","0.0.4","1.8.1","1.3.1","2.0.3","1.3.0","4.10.0","1.8.7","0.1-7","1.1.20","0.8-1","1.1.1","3.7.0","2019.11.13","0.3.7","0.11.0","1.2.0.1","1.0.0","0.4-27","1.7.1","0.3.5","1.5-8","5.94","2.5.1","1.2.3","4.7-1.1","0.14.1","1.1-3","1.0.9","2.1.3","1.4.1","1.0.2","2.4.2","1.0.1","2.0.2","1.4.4","1.26","0.5.29","1.0.6","2.17","3.0","6.3-0","1.5.2","4.1.16","1.16","2.2.18","0.7.0","0.14","1.0.3","3.0-2","1.2.1","0.3-42","1.2.2","1.7.2","0.11.0","1.81","0.4-11","1.4.37","1.7.6","1.4.1","1.1-9.7","1.44.1","4.1-1","3.4-0","1.0.3","0.4.9","0.5.6","1.0-4","2.1.0","1.0.4","0.13.2","0.3.6","1.1-1","3.1.8","1.0.2","1.2.1","1.2.0","1.3.2","4021.106","1.0-8","0.3.0","1.0.1","2.1.6","1.2.2","1.1-0","0.5.2","0.4.1","0.5.4","2.5.0","1.4.0","0.33","1.3.3","1.8-4","2.3.6","2.2.1","1.8-11"],["CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","Bioconductor","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Row number<\/th>\n      <th>Package<\/th>\n      <th>Version<\/th>\n      <th>source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"initComplete":"function(settings, json) {\n$(this.api().tables().body()).css({\n            'font-family': 'Helvetica Neue',\n            'font-size': '50%', \n            'code-inline-font-size': '15%', \n            'white-space': 'nowrap',\n            'line-height': '0.75em',\n            'min-height': '0.5em'\n            });\n}","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":["options.initComplete"],"jsHooks":[]}</script>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">py_list_packages</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">filter =</span> <span class="st">'top'</span>, <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">'Row number'</span> <span class="ot">=</span><span class="dv">1</span>,<span class="st">'Package'</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">'Version'</span><span class="ot">=</span> <span class="dv">3</span>),</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left;'</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">''</span>, htmltools<span class="sc">::</span><span class="fu">em</span>(<span class="st">'Python packages'</span>)),</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="at">initComplete =</span> htmlwidgets<span class="sc">::</span><span class="fu">JS</span>(</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$(this.api().tables().body()).css({</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-family': 'Helvetica Neue',</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-size': '50%', </span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="st">            'code-inline-font-size': '15%', </span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="st">            'white-space': 'nowrap',</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="st">            'line-height': '0.75em',</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="st">            'min-height': '0.5em'</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="st">            });"</span>,<span class="co">#;</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"}"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-a7fe3345249bd367c4ad" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a7fe3345249bd367c4ad">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption style=\"caption-side: top; text-align: left;\">\n  \n  <em>Python packages<\/em>\n<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427"],["alabaster","anaconda-client","anaconda-navigator","anaconda-project","anyio","appdirs","argon2-cffi","argon2-cffi-bindings","arrow","astor","astroid","astropy","asttokens","atomicwrites","attrs","autograd","autograd-gamma","automat","autopep8","babel","backcall","backports","backports.functools_lru_cache","backports.tempfile","backports.weakref","bcrypt","beautifulsoup4","binaryornot","black","blas","bleach","blosc","bokeh","boltons","bottleneck","brotli","brotli-bin","brotlipy","bzip2","ca-certificates","certifi","cffi","cfitsio","chardet","charls","charset-normalizer","click","cloudpickle","clyent","colorama","colorcet","comm","conda","conda-build","conda-content-trust","conda-pack","conda-package-handling","conda-package-streaming","conda-repo-cli","conda-token","conda-verify","console_shortcut","constantly","contourpy","cookiecutter","cryptography","cssselect","curl","cycler","cytoolz","daal4py","dal","dask","dask-core","datashader","datashape","debugpy","decorator","defusedxml","diff-match-patch","dill","distributed","docstring-to-markdown","docutils","entrypoints","et_xmlfile","executing","filelock","flake8","flask","flit-core","fonttools","formulaic","freetype","fsspec","future","gensim","giflib","glib","glob2","greenlet","gst-plugins-base","gstreamer","h5py","hdf5","heapdict","holoviews","huggingface_hub","hvplot","hyperlink","icc_rt","icu","idna","imagecodecs","imageio","imagesize","imbalanced-learn","importlib-metadata","importlib_metadata","incremental","inflection","iniconfig","intake","intel-openmp","interface-meta","intervaltree","ipykernel","ipython","ipython_genutils","ipywidgets","isort","itemadapter","itemloaders","itsdangerous","jedi","jellyfish","jinja2","jinja2-time","jmespath","joblib","jpeg","jq","json5","jsonpatch","jsonpointer","jsonschema","jupyter","jupyter_client","jupyter_console","jupyter_core","jupyter_server","jupyterlab","jupyterlab_pygments","jupyterlab_server","jupyterlab_widgets","jxrlib","keyring","kiwisolver","lazy-object-proxy","lcms2","lerc","libaec","libarchive","libbrotlicommon","libbrotlidec","libbrotlienc","libclang","libcurl","libdeflate","libffi","libiconv","liblief","libogg","libpng","libsodium","libspatialindex","libssh2","libtiff","libuv","libvorbis","libwebp","libwebp-base","libxml2","libxslt","libzopfli","lifelines","llvmlite","locket","lxml","lz4","lz4-c","lzo","m2-msys2-runtime","m2-patch","m2w64-libwinpthread-git","markdown","markupsafe","matplotlib","matplotlib-base","matplotlib-inline","mccabe","menuinst","mistune","mkl","mkl-service","mkl_fft","mkl_random","mock","mpmath","msgpack-python","msys2-conda-epoch","multipledispatch","munkres","mypy_extensions","navigator-updater","nbclassic","nbclient","nbconvert","nbformat","nest-asyncio","networkx","ninja","ninja-base","nltk","notebook","notebook-shim","numba","numexpr","numpy","numpy-base","numpydoc","openjpeg","openpyxl","openssl","packaging","pandas","pandocfilters","panel","param","paramiko","parsel","parso","partd","pathlib","pathspec","patsy","pcre","pep8","pexpect","pickleshare","pillow","pip","pkginfo","platformdirs","plotly","pluggy","ply","pooch","powershell_shortcut","poyo","prometheus_client","prompt-toolkit","prompt_toolkit","protego","psutil","ptyprocess","pure_eval","py","py-lief","pyasn1","pyasn1-modules","pycodestyle","pycosat","pycparser","pyct","pycurl","pydispatcher","pydocstyle","pyenv-win","pyerfa","pyflakes","pygments","pyhamcrest","pyjwt","pylint","pylint-venv","pyls-spyder","pynacl","pyodbc","pyopenssl","pyparsing","pyqt","pyqt5-sip","pyqtwebengine","pyrsistent","pysocks","pytables","pytest","python","python-dateutil","python-fastjsonschema","python-libarchive-c","python-lsp-black","python-lsp-jsonrpc","python-lsp-server","python-slugify","python-snappy","pytoolconfig","pytorch","pytz","pyviz_comms","pywavelets","pywin32","pywin32-ctypes","pywinpty","pyyaml","pyzmq","qdarkstyle","qstylizer","qt-main","qt-webengine","qtawesome","qtconsole","qtpy","qtwebkit","queuelib","regex","requests","requests-file","requests-toolbelt","rope","rtree","ruamel.yaml","ruamel.yaml.clib","ruamel_yaml","scikit-image","scikit-learn","scikit-learn-intelex","scipy","scrapy","seaborn","send2trash","service_identity","setuptools","sip","six","smart_open","snappy","sniffio","snowballstemmer","sortedcontainers","soupsieve","speechrecognition","sphinx","sphinxcontrib-applehelp","sphinxcontrib-devhelp","sphinxcontrib-htmlhelp","sphinxcontrib-jsmath","sphinxcontrib-qthelp","sphinxcontrib-serializinghtml","spyder","spyder-kernels","sqlalchemy","sqlite","stack_data","statsmodels","sympy","tabulate","tbb","tbb4py","tblib","tenacity","terminado","text-unidecode","textdistance","threadpoolctl","three-merge","tifffile","tinycss2","tk","tldextract","tokenizers","toml","tomli","tomlkit","toolz","tornado","tqdm","traitlets","transformers","twisted","twisted-iocpsupport","typing-extensions","typing_extensions","tzdata","ujson","unidecode","urllib3","vc","vs2015_runtime","w3lib","watchdog","wcwidth","webencodings","websocket-client","werkzeug","whatthepatch","wheel","widgetsnbextension","win_inet_pton","wincertstore","winpty","wrapt","xarray","xlwings","xz","yaml","yapf","zeromq","zfp","zict","zipp","zlib","zope","zope.interface","zstandard","zstd"],["0.7.12","1.11.2","2.4.0","0.11.1","3.5.0","1.4.4","21.3.0","21.2.0","1.2.3","0.8.1","2.14.2","5.1","2.0.5","1.4.0","22.1.0","1.5","0.5.0","20.2.0","1.6.0","2.11.0","0.2.0","1.1","1.6.4","1.0","1.0.post1","3.2.0","4.11.1","0.4.4","22.6.0","1.0","4.1.0","1.21.3","2.4.3","23.0.0","1.3.5","1.0.9","1.0.9","0.7.0","1.0.8","2023.01.10","2022.12.7","1.15.1","3.470","4.0.0","2.2.0","2.0.4","8.0.4","2.0.0","1.2.2","0.4.6","3.0.1","0.1.2","23.3.1","3.24.0","0.1.3","0.6.0","2.0.2","0.7.0","1.0.41","0.4.0","3.4.2","0.1.1","15.1.0","1.0.5","1.7.3","39.0.1","1.1.0","7.87.0","0.11.0","0.12.0","2023.0.2","2023.0.1","2022.7.0","2022.7.0","0.14.4","0.5.4","1.5.1","5.1.1","0.7.1","20200713","0.3.6","2022.7.0","0.11","0.18.1","0.4","1.1.0","0.8.3","3.9.0","6.0.0","2.2.2","3.6.0","4.25.0","0.6.1","2.12.1","2022.11.0","0.18.3","4.3.0","5.2.1","2.69.1","0.7","2.0.1","1.18.5","1.18.5","3.7.0","1.10.6","1.0.1","1.15.4","0.10.1","0.8.2","21.0.0","2022.1.0","58.2","3.4","2021.8.26","2.26.0","1.4.1","0.10.1","4.11.3","4.11.3","21.3.0","0.5.1","1.1.1","0.6.7","2021.4.0","1.3.0","3.1.0","6.19.2","8.10.0","0.2.0","7.6.5","5.9.3","0.3.0","1.0.4","2.0.1","0.18.1","0.9.0","3.1.2","0.2.0","0.10.0","1.1.1","9e","1.6","0.9.6","1.32","2.1","4.17.3","1.0.0","7.3.4","6.6.2","5.2.0","1.23.4","3.5.3","0.1.2","2.19.0","1.0.0","1.1","23.4.0","1.4.4","1.6.0","2.12","3.0","1.0.4","3.6.2","1.0.9","1.0.9","1.0.9","12.0.0","7.87.0","1.17","3.4.2","1.16","0.12.3","1.3.5","1.6.39","1.0.18","1.9.3","1.10.0","4.5.0","1.44.2","1.3.7","1.2.4","1.2.4","2.9.14","1.1.35","1.0.3","0.27.7","0.39.1","1.0.0","4.9.1","3.1.3","1.9.4","2.10","2.5.0.17080.65c939c","2.7.5","5.0.0.4634.697f757","3.4.1","2.1.1","3.7.0","3.7.0","0.1.6","0.7.0","1.4.19","0.8.4","2021.4.0","2.4.0","1.3.1","1.2.2","4.0.3","1.2.1","1.0.3","20160418","0.6.0","1.1.4","0.4.3","0.3.0","0.5.2","0.5.13","6.5.4","5.7.0","1.5.6","2.8.4","1.10.2","1.10.2","3.7","6.5.2","0.2.2","0.56.4","2.8.4","1.23.5","1.23.5","1.5.0","2.4.0","3.0.10","1.1.1t","22.0","1.5.3","1.5.0","0.14.3","1.12.3","2.8.1","1.6.0","0.8.3","1.2.0","1.0.1","0.10.3","0.5.3","8.45","1.7.1","4.8.0","0.7.5","9.4.0","22.3.1","1.9.6","2.5.2","5.9.0","1.0.0","3.11","1.4.0","0.0.1","0.5.0","0.14.1","3.0.36","3.0.36","0.1.16","5.9.0","0.7.0","0.2.2","1.11.0","0.12.3","0.4.8","0.2.8","2.10.0","0.6.4","2.21","0.5.0","7.45.1","2.0.5","6.3.0","3.1.1","2.0.0","3.0.1","2.11.2","2.0.2","2.4.0","2.16.2","2.3.0","0.4.0","1.5.0","4.0.34","23.0.0","3.0.9","5.15.7","12.11.0","5.15.7","0.18.0","1.7.1","3.7.0","7.1.2","3.10.9","2.8.2","2.16.2","2.9","1.2.1","1.0.0","1.7.1","5.0.2","0.6.1","1.2.5","1.12.1","2022.7","2.0.2","1.4.1","305","0.2.0","2.0.10","6.0","23.2.0","3.0.2","0.2.2","5.15.2","5.15.9","1.2.2","5.4.0","2.2.0","5.212","1.5.0","2022.7.9","2.28.1","1.5.1","0.9.1","1.7.0","1.0.1","0.17.21","0.2.6","0.17.21","0.19.3","1.2.1","2023.0.2","1.10.0","2.8.0","0.12.2","1.8.0","18.1.0","65.6.3","6.6.2","1.16.0","5.2.1","1.1.9","1.2.0","2.2.0","2.4.0","2.3.2.post1","3.10.0","5.0.2","1.0.2","1.0.2","2.0.0","1.0.1","1.0.3","1.1.5","5.4.1","2.4.1","1.4.39","3.40.1","0.2.0","0.13.5","1.11.1","0.8.10","2021.7.0","2021.7.0","1.7.0","8.0.1","0.17.1","1.3","4.2.1","2.2.0","0.1.1","2021.7.2","1.2.1","8.6.12","3.2.0","0.11.4","0.10.2","2.0.1","0.11.1","0.12.0","6.1","4.64.1","5.7.1","4.24.0","22.2.0","1.0.2","4.4.0","4.4.0","2022g","5.4.0","1.2.0","1.26.14","14.2","14.27.29016","1.21.0","2.1.6","0.2.5","0.5.1","0.58.0","2.2.2","1.0.2","0.38.4","3.5.2","1.1.0","0.2","0.4.3","1.14.1","2022.11.0","0.29.1","5.2.10","0.2.5","0.31.0","4.3.4","0.5.5","2.1.0","3.11.0","1.2.13","1.0","5.4.0","0.19.0","1.5.2"],["alabaster=0.7.12","anaconda-client=1.11.2","anaconda-navigator=2.4.0","anaconda-project=0.11.1","anyio=3.5.0","appdirs=1.4.4","argon2-cffi=21.3.0","argon2-cffi-bindings=21.2.0","arrow=1.2.3","astor=0.8.1","astroid=2.14.2","astropy=5.1","asttokens=2.0.5","atomicwrites=1.4.0","attrs=22.1.0","autograd=1.5","autograd-gamma=0.5.0","automat=20.2.0","autopep8=1.6.0","babel=2.11.0","backcall=0.2.0","backports=1.1","backports.functools_lru_cache=1.6.4","backports.tempfile=1.0","backports.weakref=1.0.post1","bcrypt=3.2.0","beautifulsoup4=4.11.1","binaryornot=0.4.4","black=22.6.0","blas=1.0","bleach=4.1.0","blosc=1.21.3","bokeh=2.4.3","boltons=23.0.0","bottleneck=1.3.5","brotli=1.0.9","brotli-bin=1.0.9","brotlipy=0.7.0","bzip2=1.0.8","ca-certificates=2023.01.10","certifi=2022.12.7","cffi=1.15.1","cfitsio=3.470","chardet=4.0.0","charls=2.2.0","charset-normalizer=2.0.4","click=8.0.4","cloudpickle=2.0.0","clyent=1.2.2","colorama=0.4.6","colorcet=3.0.1","comm=0.1.2","conda=23.3.1","conda-build=3.24.0","conda-content-trust=0.1.3","conda-pack=0.6.0","conda-package-handling=2.0.2","conda-package-streaming=0.7.0","conda-repo-cli=1.0.41","conda-token=0.4.0","conda-verify=3.4.2","console_shortcut=0.1.1","constantly=15.1.0","contourpy=1.0.5","cookiecutter=1.7.3","cryptography=39.0.1","cssselect=1.1.0","curl=7.87.0","cycler=0.11.0","cytoolz=0.12.0","daal4py=2023.0.2","dal=2023.0.1","dask=2022.7.0","dask-core=2022.7.0","datashader=0.14.4","datashape=0.5.4","debugpy=1.5.1","decorator=5.1.1","defusedxml=0.7.1","diff-match-patch=20200713","dill=0.3.6","distributed=2022.7.0","docstring-to-markdown=0.11","docutils=0.18.1","entrypoints=0.4","et_xmlfile=1.1.0","executing=0.8.3","filelock=3.9.0","flake8=6.0.0","flask=2.2.2","flit-core=3.6.0","fonttools=4.25.0","formulaic=0.6.1","freetype=2.12.1","fsspec=2022.11.0","future=0.18.3","gensim=4.3.0","giflib=5.2.1","glib=2.69.1","glob2=0.7","greenlet=2.0.1","gst-plugins-base=1.18.5","gstreamer=1.18.5","h5py=3.7.0","hdf5=1.10.6","heapdict=1.0.1","holoviews=1.15.4","huggingface_hub=0.10.1","hvplot=0.8.2","hyperlink=21.0.0","icc_rt=2022.1.0","icu=58.2","idna=3.4","imagecodecs=2021.8.26","imageio=2.26.0","imagesize=1.4.1","imbalanced-learn=0.10.1","importlib-metadata=4.11.3","importlib_metadata=4.11.3","incremental=21.3.0","inflection=0.5.1","iniconfig=1.1.1","intake=0.6.7","intel-openmp=2021.4.0","interface-meta=1.3.0","intervaltree=3.1.0","ipykernel=6.19.2","ipython=8.10.0","ipython_genutils=0.2.0","ipywidgets=7.6.5","isort=5.9.3","itemadapter=0.3.0","itemloaders=1.0.4","itsdangerous=2.0.1","jedi=0.18.1","jellyfish=0.9.0","jinja2=3.1.2","jinja2-time=0.2.0","jmespath=0.10.0","joblib=1.1.1","jpeg=9e","jq=1.6","json5=0.9.6","jsonpatch=1.32","jsonpointer=2.1","jsonschema=4.17.3","jupyter=1.0.0","jupyter_client=7.3.4","jupyter_console=6.6.2","jupyter_core=5.2.0","jupyter_server=1.23.4","jupyterlab=3.5.3","jupyterlab_pygments=0.1.2","jupyterlab_server=2.19.0","jupyterlab_widgets=1.0.0","jxrlib=1.1","keyring=23.4.0","kiwisolver=1.4.4","lazy-object-proxy=1.6.0","lcms2=2.12","lerc=3.0","libaec=1.0.4","libarchive=3.6.2","libbrotlicommon=1.0.9","libbrotlidec=1.0.9","libbrotlienc=1.0.9","libclang=12.0.0","libcurl=7.87.0","libdeflate=1.17","libffi=3.4.2","libiconv=1.16","liblief=0.12.3","libogg=1.3.5","libpng=1.6.39","libsodium=1.0.18","libspatialindex=1.9.3","libssh2=1.10.0","libtiff=4.5.0","libuv=1.44.2","libvorbis=1.3.7","libwebp=1.2.4","libwebp-base=1.2.4","libxml2=2.9.14","libxslt=1.1.35","libzopfli=1.0.3","lifelines=0.27.7","llvmlite=0.39.1","locket=1.0.0","lxml=4.9.1","lz4=3.1.3","lz4-c=1.9.4","lzo=2.10","m2-msys2-runtime=2.5.0.17080.65c939c","m2-patch=2.7.5","m2w64-libwinpthread-git=5.0.0.4634.697f757","markdown=3.4.1","markupsafe=2.1.1","matplotlib=3.7.0","matplotlib-base=3.7.0","matplotlib-inline=0.1.6","mccabe=0.7.0","menuinst=1.4.19","mistune=0.8.4","mkl=2021.4.0","mkl-service=2.4.0","mkl_fft=1.3.1","mkl_random=1.2.2","mock=4.0.3","mpmath=1.2.1","msgpack-python=1.0.3","msys2-conda-epoch=20160418","multipledispatch=0.6.0","munkres=1.1.4","mypy_extensions=0.4.3","navigator-updater=0.3.0","nbclassic=0.5.2","nbclient=0.5.13","nbconvert=6.5.4","nbformat=5.7.0","nest-asyncio=1.5.6","networkx=2.8.4","ninja=1.10.2","ninja-base=1.10.2","nltk=3.7","notebook=6.5.2","notebook-shim=0.2.2","numba=0.56.4","numexpr=2.8.4","numpy=1.23.5","numpy-base=1.23.5","numpydoc=1.5.0","openjpeg=2.4.0","openpyxl=3.0.10","openssl=1.1.1t","packaging=22.0","pandas=1.5.3","pandocfilters=1.5.0","panel=0.14.3","param=1.12.3","paramiko=2.8.1","parsel=1.6.0","parso=0.8.3","partd=1.2.0","pathlib=1.0.1","pathspec=0.10.3","patsy=0.5.3","pcre=8.45","pep8=1.7.1","pexpect=4.8.0","pickleshare=0.7.5","pillow=9.4.0","pip=22.3.1","pkginfo=1.9.6","platformdirs=2.5.2","plotly=5.9.0","pluggy=1.0.0","ply=3.11","pooch=1.4.0","powershell_shortcut=0.0.1","poyo=0.5.0","prometheus_client=0.14.1","prompt-toolkit=3.0.36","prompt_toolkit=3.0.36","protego=0.1.16","psutil=5.9.0","ptyprocess=0.7.0","pure_eval=0.2.2","py=1.11.0","py-lief=0.12.3","pyasn1=0.4.8","pyasn1-modules=0.2.8","pycodestyle=2.10.0","pycosat=0.6.4","pycparser=2.21","pyct=0.5.0","pycurl=7.45.1","pydispatcher=2.0.5","pydocstyle=6.3.0","pyenv-win=3.1.1","pyerfa=2.0.0","pyflakes=3.0.1","pygments=2.11.2","pyhamcrest=2.0.2","pyjwt=2.4.0","pylint=2.16.2","pylint-venv=2.3.0","pyls-spyder=0.4.0","pynacl=1.5.0","pyodbc=4.0.34","pyopenssl=23.0.0","pyparsing=3.0.9","pyqt=5.15.7","pyqt5-sip=12.11.0","pyqtwebengine=5.15.7","pyrsistent=0.18.0","pysocks=1.7.1","pytables=3.7.0","pytest=7.1.2","python=3.10.9","python-dateutil=2.8.2","python-fastjsonschema=2.16.2","python-libarchive-c=2.9","python-lsp-black=1.2.1","python-lsp-jsonrpc=1.0.0","python-lsp-server=1.7.1","python-slugify=5.0.2","python-snappy=0.6.1","pytoolconfig=1.2.5","pytorch=1.12.1","pytz=2022.7","pyviz_comms=2.0.2","pywavelets=1.4.1","pywin32=305","pywin32-ctypes=0.2.0","pywinpty=2.0.10","pyyaml=6.0","pyzmq=23.2.0","qdarkstyle=3.0.2","qstylizer=0.2.2","qt-main=5.15.2","qt-webengine=5.15.9","qtawesome=1.2.2","qtconsole=5.4.0","qtpy=2.2.0","qtwebkit=5.212","queuelib=1.5.0","regex=2022.7.9","requests=2.28.1","requests-file=1.5.1","requests-toolbelt=0.9.1","rope=1.7.0","rtree=1.0.1","ruamel.yaml=0.17.21","ruamel.yaml.clib=0.2.6","ruamel_yaml=0.17.21","scikit-image=0.19.3","scikit-learn=1.2.1","scikit-learn-intelex=2023.0.2","scipy=1.10.0","scrapy=2.8.0","seaborn=0.12.2","send2trash=1.8.0","service_identity=18.1.0","setuptools=65.6.3","sip=6.6.2","six=1.16.0","smart_open=5.2.1","snappy=1.1.9","sniffio=1.2.0","snowballstemmer=2.2.0","sortedcontainers=2.4.0","soupsieve=2.3.2.post1","speechrecognition=3.10.0","sphinx=5.0.2","sphinxcontrib-applehelp=1.0.2","sphinxcontrib-devhelp=1.0.2","sphinxcontrib-htmlhelp=2.0.0","sphinxcontrib-jsmath=1.0.1","sphinxcontrib-qthelp=1.0.3","sphinxcontrib-serializinghtml=1.1.5","spyder=5.4.1","spyder-kernels=2.4.1","sqlalchemy=1.4.39","sqlite=3.40.1","stack_data=0.2.0","statsmodels=0.13.5","sympy=1.11.1","tabulate=0.8.10","tbb=2021.7.0","tbb4py=2021.7.0","tblib=1.7.0","tenacity=8.0.1","terminado=0.17.1","text-unidecode=1.3","textdistance=4.2.1","threadpoolctl=2.2.0","three-merge=0.1.1","tifffile=2021.7.2","tinycss2=1.2.1","tk=8.6.12","tldextract=3.2.0","tokenizers=0.11.4","toml=0.10.2","tomli=2.0.1","tomlkit=0.11.1","toolz=0.12.0","tornado=6.1","tqdm=4.64.1","traitlets=5.7.1","transformers=4.24.0","twisted=22.2.0","twisted-iocpsupport=1.0.2","typing-extensions=4.4.0","typing_extensions=4.4.0","tzdata=2022g","ujson=5.4.0","unidecode=1.2.0","urllib3=1.26.14","vc=14.2","vs2015_runtime=14.27.29016","w3lib=1.21.0","watchdog=2.1.6","wcwidth=0.2.5","webencodings=0.5.1","websocket-client=0.58.0","werkzeug=2.2.2","whatthepatch=1.0.2","wheel=0.38.4","widgetsnbextension=3.5.2","win_inet_pton=1.1.0","wincertstore=0.2","winpty=0.4.3","wrapt=1.14.1","xarray=2022.11.0","xlwings=0.29.1","xz=5.2.10","yaml=0.2.5","yapf=0.31.0","zeromq=4.3.4","zfp=0.5.5","zict=2.1.0","zipp=3.11.0","zlib=1.2.13","zope=1.0","zope.interface=5.4.0","zstandard=0.19.0","zstd=1.5.2"],["pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/msys2","pkgs/msys2","pkgs/msys2","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/msys2","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pypi","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Row number<\/th>\n      <th>Package<\/th>\n      <th>Version<\/th>\n      <th>requirement<\/th>\n      <th>channel<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"initComplete":"function(settings, json) {\n$(this.api().tables().body()).css({\n            'font-family': 'Helvetica Neue',\n            'font-size': '50%', \n            'code-inline-font-size': '15%', \n            'white-space': 'nowrap',\n            'line-height': '0.75em',\n            'min-height': '0.5em'\n            });\n}","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":["options.initComplete"],"jsHooks":[]}</script>
</div>
</div>
<p>Guardar avances</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"an_grant_23_24.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>