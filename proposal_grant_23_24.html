<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés González Santa Cruz">
<meta name="description" content="Cargar una base de datos de tiempo al evento a cometer un delito que deriva en sentencia definitiva condenatoria, pero pasando por completar/abandonar tratamiento por uso de sustancias.">

<title>Trabajo 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="proposal_grant_23_24_files/libs/clipboard/clipboard.min.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/quarto.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/popper.min.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="proposal_grant_23_24_files/libs/quarto-html/anchor.min.js"></script>
<link href="proposal_grant_23_24_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="proposal_grant_23_24_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="proposal_grant_23_24_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="proposal_grant_23_24_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="proposal_grant_23_24_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="proposal_grant_23_24_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="proposal_grant_23_24_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="proposal_grant_23_24_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/datatables-binding-0.26/datatables.js"></script>
<script src="proposal_grant_23_24_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="proposal_grant_23_24_files/libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="proposal_grant_23_24_files/libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="proposal_grant_23_24_files/libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="proposal_grant_23_24_files/libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/selectize-0.12.0/selectize.min.js"></script>
<link href="proposal_grant_23_24_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="proposal_grant_23_24_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Trabajo 1</h1>
</div>

<div>
  <div class="description">
    <p>Cargar una base de datos de tiempo al evento a cometer un delito que deriva en sentencia definitiva condenatoria, pero pasando por completar/abandonar tratamiento por uso de sustancias.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés González Santa Cruz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"

</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

$('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');

// onClick function for all plots (img's)

$('img:not(.zoomImg)').click(function() {
$('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
$('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
});

// onClick function for zoomImg

$('img.zoomImg').click(function() {
$('.zoomDiv').css({opacity: '0', width: '0%'});
});
});
</script>
</div>
<div class="cell">
<style type="text/css">
<script src="https://github.com/AGSCL/gine_brechas_pandemia/blob/main/hideOutput.js"></script>
</style>
</div>
<div class="cell">
<script type="text/javascript">
$(document).ready(function() {

\$chunks = \$('.fold');

\$chunks.each(function () { // add button to source code chunks
if ( \$(this).hasClass('s') ) {
    \$('pre.r', this).prepend("\<div class=\\"showopt\\"\>Show Source\</div\>\<br style=\\"line-height:22px;\\"/\>");
    \$('pre.r', this).children('code').attr('class', 'folded');
    } // add button to output chunks

    if ( \$(this).hasClass('o') ) {
        \$('pre:not(.r)', this).has('code').prepend("\<div class=\\"showopt\\"\>Show Output\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre:not(.r)', this).children('code:not(r)').addClass('folded'); // add button to plots
        \$(this).find('img').wrap('\<pre class=\\"plot\\"\>\</pre\>');
        \$('pre.plot', this).prepend("\<div class=\\"showopt\\"\>Show Plot\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre.plot', this).children('img').addClass('folded');
        }
}); // hide all chunks when document is loaded

\$('.folded').css('display', 'none') // function to toggle the visibility
\$('.showopt').click(function() {
        var label = \$(this).html();
        if (label.indexOf("Show") \>= 0) {
            \$(this).html(label.replace("Show", "Hide"));
        } else {
        \$(this).html(label.replace("Hide", "Show"));
        }

\$(this).siblings('code, img').slideToggle('fast', 'swing');
});
});
</script>
</div>

<style type="text/css">

.showopt {

background-color: #004c93; color: #FFFFFF; width: 100px; height: 20px; text-align: center; vertical-align: middle !important; float: right; font-family: sans-serif; border-radius: 8px;

}

.showopt:hover {
background-color: #dfe4f2;
color: #004c93;

}

pre.plot {
background-color: white !important;
}

.tablelines table, .tablelines td, .tablelines th {
border: 1px solid black;
}

.centrado {
text-align: center;
}

.table.center {
margin-left:auto;
margin-right:auto;
}

/* https://vivekjaiskumar.medium.com/css-is-and-not-selector-17c942ec83f :is()*/

/* Applies to outputs that are not code other than R*/

pre {
overflow-x: auto !important;
}

pre code {
word-wrap: normal !important;
white-space: pre !important;
}

/*
pre:not(.sourceCode) {
white-space: nowrap !important;
}
*/
.sourceCode { /* Important gives precedence */
font-size: 10px !important;
line-height: 50% !important;
}
body{ /* Normal */
text-align: justify;
}
.superbigimage{
overflow-y:scroll;
height:350px;
white-space: nowrap;
overflow-x: auto;
width:100%;
}
.superbigimage img{
overflow-y: scroll;
overflow-x: hidden;
}
.message { color:#446C6E; font-family: monospace;font-size: 10px; line-height: 110%; font-weight: bold;}
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 5px; text-align: justify;}
div.red { background-color:#e6bab1; border-radius: 5px; padding: 5px; text-align: justify;}
.pandoc-table { /* Should add !important; but it seems no necessary */
margin-left:auto; /* To center */
margin-right:auto;
border-collapse: collapse;
table-layout: auto;
font-size: 11px;
overflow-y: auto;
max-height:450px !important;
white-space: nowrap;
overflow-x: auto;
width:450px;
}
.pandoc-table th {/* header */
text-align: center !important;
font-size: 10px;
padding: 0px;
}
.pandoc-table td {
text-align: left !important;
font-size: 9px;
padding: 0px;
}
.pandoc-table caption {
text-align: left !important;
font-size: 11px !important;
}

.center-table {
text-align: left !important;
font-size: 9px;
padding: 0px;
overflow-y:scroll;
height:400px;
overflow-x: scroll;
}

.controlly{
overflow-y:scroll;
height:350px;
overflow-x: scroll;

}
</style>
<!-- We gotta do each function to hide code and outputs per section, by every ID, we gotta create a different function -->

<script>
function myFunction1() {
var x = document.getElementById("myDIV");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>

<script>
function myFunction2() {
var x = document.getElementById("myDIV2");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"proposal_grant_23_24_files"</span>, <span class="at">recursive=</span>T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fuentes: </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rpubs.com/georgy_makarov/897844</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>path<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">'/env'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  "")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(RETICULATE_PYTHON =  Sys.which("python"))</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#reticulate::py_config()</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#use_python(paste0(path,"/Scripts/python.exe"))</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH =  paste0(path,"/Lib"))</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Sys.setenv(LD_LIBRARY_PATH_64 =  paste0(path,"/Lib"))</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#instalar paquetes de funcionalidades básicas para tener ubicaciones relativas y acceso a python (reticulate)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(reticulate)){<span class="fu">install.packages</span>(<span class="st">"reticulate"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: reticulate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'reticulate' was built under R version 4.1.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(rstudioapi)){<span class="fu">install.packages</span>(<span class="st">"rstudioapi"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rstudioapi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rstudioapi' was built under R version 4.1.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Create env"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/54043607/how-to-set-pyenv-python-for-reticulate</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Directory H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env is not a Python virtualenv</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#virtualenv_create(envname  = path, packages = c("pip", "statsmodels", "matplotlib", "numpy", "pandas", "scipy"))</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># "C:/Users/andre/anaconda3/python.exe" -m venv "H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/9_Computacion_Estadistica/env"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#FUENTES:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/articles/versions.html</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Virtual environment functions are not supported on Windows (the use of conda environments is recommended on Windows).</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Use environment"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#https://ugoproto.github.io/ugo_r_doc/pdf/reticulate.pdf</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># tx  &lt;- readLines(paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[1]] &lt;- paste0("home = ",gsub('/', '\\', paste0(path,"/Scripts/python.exe"), fixed=T))</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># tx[[3]] &lt;- "version = 3.8.0"</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#writeLines(tx, con=paste0(path,"/pyvenv.cfg"))</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#H:/Mi unidad/PERSONAL ANDRES/UCH_salud_publica/asignaturas/env/Scripts/python.exe"</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#use_virtualenv(path)</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#usar entorno virtual ya creado</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#información sobre entorno virtual</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#py_discover_config()</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#conda_python(envname =  "r-scrublet")</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># FUENTES</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#https://akrabat.com/creating-virtual-environments-with-pyenv/</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#https://rstudio.github.io/reticulate/reference/install_python.html</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/wiki#suggested-build-environment</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/56755156/reticulate-not-setting-python-path</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/rstudio/reticulate/issues/291#issuecomment-437143751</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv-win/pyenv-win#installation</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/52060867/how-to-use-pip-for-pyenv</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/pyenv/pyenv/issues/2417</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv install <span class="op">-</span>l <span class="op">|</span> findstr <span class="fl">3.8</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>upgrade pyenv<span class="op">-</span>win</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>env PYTHON_CONFIGURE_OPTS<span class="op">=</span><span class="st">"--enable-shared"</span> pyenv install <span class="fl">3.7.5</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pyenv build</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># `r format(Sys.time(),'%B %d, %Y')`</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data import</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the data from Mariel Fiscalia Merge 4, created on 2023-05-26</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#load("14.Rdata", data_mariel_fisc_merge4 &lt;- new.env() )</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data_acc_ser_23.RData"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># List all of the objects names in RData:</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(.GlobalEnv)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(new_environment)</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(new_environment)</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p><br></p>
</section>
<section id="explore-and-construct-database" class="level1">
<h1>Explore and construct database</h1>
<p>We checked and resolved the inconsistencies in male users receiving women-only treatments after imputation. We selected the variables of interest, compared the date births and ages at several events and corrected these values.</p>
<p><br></p>
<p>Once the standardization and correction of values and labels was complete, we <strong>joined</strong> the databases <code>CONS_C1_df_dup_SEP_2020_22_d</code> and <code>Base_fiscalia_v9</code> into a single one. The master database was SENDAs treatments, and we only used records of POs database which had an age of offending equal or posterior to the age of admission to treatment. If there were no records of PO, the age of offense were replaced with the age at censorship (2019-11-13). However, we excluded Referrals, Deaths and Censored cases because of missing data.</p>
<p><br></p>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># invisible("La edad está bien definida en términos relativos (entre ingresos), pero no absolutos (manualmente no llego a la misma edad calculando manualmente ), tiene una diferencia de 0,5 años")</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Age at admission for each treatment: if the date of birth (PO) is not empty and the date of birth of senda is different of date of birth, for each age at admission (for different admissions), we compute the difference of the date of admission (at each admission) with the date of birth (PO) and divided by years; if the date of birth (PO) is not empty but SENDA is empty, we compute the difference of the date of admission (at each admission) with the date of birth (PO) and divided by years; else will be taken from the date at admission from the date of birth of SENDA.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#The same for age at discharge</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#WHERE rn_id = 1</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"This chunk is modified from Fiscalia_merge4"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#joined with edad_al_ing instead of edad_al_egres</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v10_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM CONS_C1_df_dup_SEP_2020_22_d AS x  </span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM Base_fiscalia_v9</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.id AND </span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_ing_1 &lt;= y.age_offending_imp AND x.dup = 1"</span>) <span class="co">#2022-11-25  added dup</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#183307</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Observations of SENDA database: "</span>,<span class="fu">nrow</span>(CONS_C1_df_dup_SEP_2020_22_d))<span class="co">#109756)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Observations of SENDA database: 85048"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Observations of PO database: "</span>, <span class="fu">nrow</span>(Base_fiscalia_v10_grant_23_24))<span class="co">#204,115 nrow</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Observations of PO database: 138349"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#clean names, select the first event (whatever the crime committed, we selected the first)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v10_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#discrepancies in names of variables</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span>   <span class="co">#janitor::tabyl(!is.na(dob_imp_num))</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#previously recoded, </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>sex_2, <span class="sc">-</span>dateofbirth_imp, <span class="sc">-</span>country, <span class="sc">-</span>victim, <span class="sc">-</span>id_victim, <span class="sc">-</span>crime_code_c , <span class="sc">-</span>reg_c, <span class="sc">-</span>end_type_2c, <span class="sc">-</span>cod_comunadelito, <span class="sc">-</span>cod_lugarocurrencia, <span class="sc">-</span>sex_imp, <span class="sc">-</span>region_delito, <span class="sc">-</span>filter, <span class="sc">-</span>id)<span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  plyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"dateofbirth_imp_2"</span><span class="ot">=</span><span class="st">"dateofbirth_imp"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#generates errors with survival setting</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#make censorship date of age of comission</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">when</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(., <span class="fu">is.na</span>(fech_nac_rec)) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">7</span> <span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"Missing values in the age"</span>), <span class="sc">~</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_offending_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">is.na</span>(age_offending_imp)<span class="sc">~</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_offending_imp)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#KEY STEP: select the first and with ties (more than  one) --&gt; 2023-04-14, was discussed, but did not had consequences (See https://docs.google.com/document/d/1UvtQFM3ToazUyA6G9C7pBYMgk98n31zQSY2-M9d1nEo/edit#)</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_min</span>(age_offending_imp, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">when</span>(<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(.,age_offending_imp<span class="sc">-</span>edad_al_ing_1<span class="sc">&lt;</span><span class="dv">0</span>))<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"Cases with negative time after admission to commission of crime"</span>), <span class="sc">~</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">motivodeegreso_mod_imp_rec=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">grepl</span>(<span class="st">"Therapeutic"</span>,motivodeegreso_mod_imp)<span class="sc">~</span> <span class="st">"Treatment completion"</span>, <span class="fu">grepl</span>(<span class="st">"Early|Late|Administrative"</span>, motivodeegreso_mod_imp) <span class="sc">&amp;</span> (fech_egres_num_1<span class="sc">-</span>fech_ing_num_1 <span class="sc">&lt;</span><span class="dv">90</span>) <span class="sc">~</span>  <span class="st">"Treatment non-completion"</span>, <span class="fu">grepl</span>(<span class="st">"Early|Late|Administrative"</span>, motivodeegreso_mod_imp) <span class="sc">&amp;</span> (fech_egres_num_1<span class="sc">-</span>fech_ing_num_1 <span class="sc">&gt;=</span><span class="dv">90</span>) <span class="sc">~</span> <span class="st">"Treatment non-completion"</span>, <span class="fu">grepl</span>(<span class="st">"Referral|Death|Ongoing"</span>, motivodeegreso_mod_imp)<span class="sc">~</span> <span class="st">"Censored"</span>, T<span class="sc">~</span><span class="cn">NA_character_</span>))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"There are "</span>,<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">group_by</span>(Base_fiscalia_v11_grant_23_24, hash_key) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rn_hash=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rn_hash<span class="sc">&gt;</span><span class="dv">1</span>)),<span class="st">" records with more than one offense commited at the youngest age (p= "</span>,dplyr<span class="sc">::</span><span class="fu">group_by</span>(Base_fiscalia_v11_grant_23_24, hash_key) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rn_hash=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rn_hash<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(hash_key) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>(),<span class="st">")"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: There are 0 records with more than one offense commited at the youngest age (p= 0)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"There are "</span>,<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(Base_fiscalia_v11_grant_23_24,<span class="fu">is.na</span>(fech_nac_rec))),<span class="st">" missing records in date of birth (were "</span>,<span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v10_grant_23_24),<span class="fu">is.na</span>(fech_nac_rec))),<span class="st">" in step v10)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: There are 7 missing records in date of birth (were 7 in step v10)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"There are "</span>, scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">as.numeric</span>(<span class="fu">table</span>(<span class="fu">is.na</span>(Base_fiscalia_v11_grant_23_24<span class="sc">$</span>crime_code_group_rec))[[<span class="dv">2</span>]])<span class="sc">/</span><span class="fu">nrow</span>(Base_fiscalia_v11_grant_23_24)), <span class="st">" records with events of contacts with justice"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: There are 67% records with events of contacts with justice</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="st">"2023-07-17, omitted in this step (filtering for censored, ongoing treatments, etc.),because we are measuring from admission. Restricting the database for that happened later would be a selection bias. Instead, I replaced the value 'Referral and Ongoing with 'Non-completion' status'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 2023-07-17, omitted in this step (filtering for censored, ongoing treatments, etc.),because we are measuring from admission. Restricting the database for that happened later would be a selection bias. Instead, I replaced the value ‘Referral and Ongoing with ’Non-completion’ status’</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2022-11-01, filter</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v11_grant_23_24&lt;-</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::filter(Base_fiscalia_v11_grant_23_24, !grepl("Referral|Death|Censored|Ongoing",motivodeegreso_mod_imp))</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec[<span class="fu">grepl</span>(<span class="st">"Censored"</span>,Base_fiscalia_v11_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)]<span class="ot">&lt;-</span> <span class="st">"Treatment non-completion"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07_17, </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v11_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()){<span class="fu">warning</span>(<span class="st">"Patients with more than one record"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 85,048 rows and 2 columns, one group variable remaining (hash_key)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07_17, case that have more than one row</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v11_grant_23_24 %&gt;% dplyr::filter(hash_key=="001b0ff241cd0d95828b86b4bdab8c19") %&gt;%   dplyr::select(hash_key, fech_nac, fech_nac_rec, motivodeegreso_mod_imp_rec, age_tr_comp_imp, edad_al_ing_1, edad_al_egres_1, edad_comision, fec_comision_simple, caseid, crime_code_group_rec_prof, end_type_2, gls_proctermino, s_sentence_1, s_restorative_3, s_kindprison_1) %&gt;% View()</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Ver por qué los valores negativos-R: por que entre la admisión y terminar el tratamiento hay casos que registraron un delito"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, fech_nac, fech_nac_rec, motivodeegreso_mod_imp_rec, age_offending_imp, edad_al_ing_1, edad_al_egres_1, edad_comision, fec_comision_simple, caseid, crime_code_group_rec_prof, end_type_2, gls_proctermino, s_sentence_1, s_restorative_3, s_kindprison_1) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(hash_key<span class="sc">==</span><span class="st">"1951c4d080cda8b68759d638a840d82f"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Example of database"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Example of database</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">hash_key</th>
<th style="text-align: left;">fech_nac</th>
<th style="text-align: left;">fech_nac_rec</th>
<th style="text-align: left;">motivodeegreso_mod_imp_rec</th>
<th style="text-align: right;">age_offending_imp</th>
<th style="text-align: right;">edad_al_ing_1</th>
<th style="text-align: right;">edad_al_egres_1</th>
<th style="text-align: right;">edad_comision</th>
<th style="text-align: left;">fec_comision_simple</th>
<th style="text-align: left;">caseid</th>
<th style="text-align: left;">crime_code_group_rec_prof</th>
<th style="text-align: left;">end_type_2</th>
<th style="text-align: left;">gls_proctermino</th>
<th style="text-align: left;">s_sentence_1</th>
<th style="text-align: left;">s_restorative_3</th>
<th style="text-align: left;">s_kindprison_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1951c4d080cda8b68759d638a840d82f</td>
<td style="text-align: left;">1985-12-14</td>
<td style="text-align: left;">1986-12-11</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: right;">27.61092</td>
<td style="text-align: right;">25.25956</td>
<td style="text-align: right;">25.56831</td>
<td style="text-align: right;">27.60301</td>
<td style="text-align: left;">2014-07-22</td>
<td style="text-align: left;">1400700113-5</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Sentencia definitiva condenatoria</td>
<td style="text-align: left;">ABREVIADO</td>
<td style="text-align: left;">SI</td>
<td style="text-align: left;">Remisión Condicional</td>
<td style="text-align: left;">Minor Prison medium grade</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#b24908c527faa1b7bd5a267d5dcabd45</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#23d88c2b8c6da2d8abf3f88b7ce8a4c0 anomalus case</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># FROM PATIENTS (p=85,048), WE JOINED THE PO DATA (n= 174,961, p=49,970) by HASHs and where offense date is equal or lower to the age at discharge from treatment, and restricted the first treatment from SENDA in v10</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#v11: erased missing cases in date of birth; thus, missing age at discharge, filtered the first offense by each HASH (going from n= 132,530 to n=87,770) (n=87,770 p= 85,041)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#length(unique(Base_fiscalia_v11$hash_key))</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#v12: discarded patients where the first treatment corresponded to ongoing treatments (p &amp; n=5,521), external referral (p &amp; n=8,948) == 14,469 users were discarded.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p>We did not drop censored treatments (never ended), referrals and deaths, so we got 85,048 users (n= 85,048). Next, we joined the pre-treatment criminality records.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the variables of pretreatment criminality</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v10b_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM CONS_C1_df_dup_SEP_2020_22_d AS x  </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM Base_fiscalia_v9</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.id AND </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_ing_1 &gt; y.age_offending_imp AND x.dup = 1"</span>) <span class="co">#2022-11-25  added dup // #changed the direction to past events, where age at discharge is greater than the age of commission</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v11b_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v10b_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#discrepancies in names of variables</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span>   <span class="co">#janitor::tabyl(!is.na(dob_imp_num))</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#previously recoded, </span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>dateofbirth_imp, <span class="sc">-</span>country, <span class="sc">-</span>victim, <span class="sc">-</span>id_victim, <span class="sc">-</span>crime_code_c , <span class="sc">-</span>reg_c, <span class="sc">-</span>end_type_2c, <span class="sc">-</span>cod_comunadelito, <span class="sc">-</span>cod_lugarocurrencia, <span class="sc">-</span>sex_imp, <span class="sc">-</span>region_delito, <span class="sc">-</span>filter, <span class="sc">-</span>id)<span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  plyr<span class="sc">::</span><span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">"dateofbirth_imp_2"</span><span class="ot">=</span><span class="st">"dateofbirth_imp"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#selected the first row with distinct information regarding patient ID, case ID, crime code.</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key, caseid, crime_code_group_rec_prof) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_off_acq=</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span><span class="st">"Acquisitive"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>), <span class="at">n_off_vio=</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span><span class="st">"Violent"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>), <span class="at">n_off_sud=</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span> <span class="st">"Substance-related"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>), <span class="at">n_off_oth=</span>  <span class="fu">ifelse</span>(<span class="fu">sum</span>(crime_code_group_rec_prof<span class="sc">==</span> <span class="st">"Other"</span>, <span class="at">na.rm=</span>T)<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n_prev_off=</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"n_"</span>)))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>summarise: now 85,048 rows and 5 columns, ungrouped</p>
</div>
<div class="message">
<p>select: dropped one variable (hash_key)</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Users in the database of previous crimes: "</span>,<span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(Base_fiscalia_v11b_grant_23_24<span class="sc">$</span>hash_key)), <span class="at">big.mark=</span><span class="st">","</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Users in the database of previous crimes: 85,048</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Users in the merged database (after filtering for observations coded as referrals, deaths, censored at baseline treatment or with ongoing treatments) : "</span>,<span class="fu">format</span>(<span class="fu">length</span>(<span class="fu">unique</span>(Base_fiscalia_v11_grant_23_24<span class="sc">$</span>hash_key)), <span class="at">big.mark=</span><span class="st">","</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Users in the merged database (after filtering for observations coded as referrals, deaths, censored at baseline treatment or with ongoing treatments) : 85,048</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-treatment Criminality </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v11_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17: we made it in the previous chunk</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::group_by(hash_key) %&gt;% </span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># #select the first and without ties (only one)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::slice_min(age_offending_imp, n = 1, with_ties = F) %&gt;% </span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::ungroup() %&gt;% </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join database with the pre-treatment criminality counts</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(Base_fiscalia_v11b_grant_23_24, <span class="at">by=</span><span class="st">"hash_key"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">policonsumo=</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus1_mod),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NO SE SI SIRVE, 2023-07-17 lo saqué</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(cut_fec_nac=cut2(fech_nac_rec, cuts=as.Date(attr(dlookr::binning(as.numeric(fech_nac_rec)),"breaks"))),cut_com_del=cut2(fec_comision_simple, cuts=as.Date(attr(dlookr::binning(as.numeric(fec_comision_simple)),"breaks")))) %&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(tr_modality=dplyr::case_when(grepl("PR", as.character(tipo_de_plan_2_1))~  "Residential", grepl("PAI|PAB", as.character(tipo_de_plan_2_1))~ "Ambulatory", T~ NA_character_))%&gt;% </span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">when</span>(<span class="fu">nrow</span>(.)<span class="sc">&gt;</span><span class="fu">nrow</span>(Base_fiscalia_v11_grant_23_24)<span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"More cases in the new database"</span>), <span class="sc">~</span>.) </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(<span class="fu">paste0</span>(<span class="st">"Number of cases that are different by at least 0,02 years between 'edad_al_egres_imp' &amp; 'edad_al_egres_1'= "</span>, <span class="fu">nrow</span>(<span class="fu">cbind.data.frame</span>(<span class="fu">round</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>edad_al_ing_1,<span class="dv">4</span>), <span class="fu">round</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>edad_al_ing_fmt,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">abs</span>(.[[<span class="dv">1</span>]]<span class="sc">-</span>.[[<span class="dv">2</span>]])<span class="sc">&gt;</span><span class="fl">0.02</span>)),<span class="st">" probably due to the discrepancies in getting the differences of dates"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Number of cases that are different by at least 0,02 years between ‘edad_al_egres_imp’ &amp; ‘edad_al_egres_1’= 2751 probably due to the discrepancies in getting the differences of dates</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Recode in 0/1 for more than one treatment, numeric"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>dup_filt<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>duplicates_filtered<span class="sc">&gt;</span><span class="dv">1</span>,<span class="st">"&gt;1 treatment"</span>,<span class="st">"only one treatment"</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>dup_filt_num<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>duplicates_filtered<span class="sc">&gt;</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"offender after admission (event), numeric"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>offense_after_adm<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>offender_d),<span class="st">"offender after adm"</span>,<span class="st">"no offense after admission"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>off_aft_adm<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>offender_d), <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"treatment outcome status, numeric"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>mot_egres_mod_imp_rec2<span class="ot">&lt;-</span>  dplyr<span class="sc">::</span><span class="fu">case_when</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec<span class="sc">==</span> <span class="st">"Treatment completion"</span><span class="sc">~</span> <span class="st">"Tr.Completion"</span>, <span class="fu">grepl</span>(<span class="st">"non"</span>, Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)<span class="sc">~</span> <span class="st">"Non-completion"</span>, T<span class="sc">~</span><span class="st">"Censored"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>mot_egres_mod_imp_rec_num<span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec<span class="sc">==</span><span class="st">"Treatment completion"</span><span class="sc">~</span><span class="dv">1</span>, <span class="fu">grepl</span>(<span class="st">"non"</span>,Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)<span class="sc">~</span><span class="dv">0</span>, T<span class="sc">~</span><span class="dv">0</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>mot_egres_mod_imp_rec2<span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec<span class="sc">==</span><span class="st">"Treatment completion"</span><span class="sc">~</span><span class="st">"Tr.Completion"</span>, <span class="fu">grepl</span>(<span class="st">"non"</span>, Base_fiscalia_v13_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec)<span class="sc">~</span> <span class="st">"Non-completion"</span>, T<span class="sc">~</span><span class="st">"Censored"</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"treatment setting, binary, numeric"</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24<span class="sc">$</span>tr_mod <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Base_fiscalia_v13_grant_23_24<span class="sc">$</span>tr_modality<span class="sc">==</span><span class="st">"Residential"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<section id="discard-deaths" class="level3">
<h3 class="anchored" data-anchor-id="discard-deaths">Discard deaths</h3>
<p>First we formatted the dates of discharge of the former database of treatments to get the column of administrative discharge motive and discard deaths.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"2_ndp_2023_07_05_20_00_00.RData"</span>, ndp_2023_step2 <span class="ot">&lt;-</span> <span class="fu">new.env</span>() )</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23 <span class="ot">&lt;-</span> ndp_2023_step2<span class="sc">$</span>CONS_C1_2010_19[,<span class="fu">c</span>(<span class="st">"hash_key"</span>,<span class="st">"fecha_egreso_de_tratamiento"</span>, <span class="st">"motivo_de_egreso_alta_administrativa"</span>)] <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fecha_egreso_de_tratamiento2=</span>  readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento,<span class="st">"%d/%m/%Y"</span>)) <span class="sc">%&gt;%</span>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fech_egres_num=</span> <span class="fu">unclass</span>(fecha_egreso_de_tratamiento)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 80 parsing failures. row col expected actual 194 – date like %d/%m/%Y 15<br>
1294 – date like %d/%m/%Y 30/12/09 1650 – date like %d/%m/%Y 20/01/10 1859 – date like %d/%m/%Y 23/03/09 1934 – date like %d/%m/%Y 13/05/09 …. … ……………… …….. See problems(…) for more details.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>parsing_failures <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(ndp_2023_step2<span class="sc">$</span>CONS_C1_2010_19[,<span class="fu">c</span>(<span class="st">"hash_key"</span>,<span class="st">"fecha_egreso_de_tratamiento"</span>)], <span class="at">fecha_egreso_de_tratamiento2=</span>  readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento,<span class="st">"%d/%m/%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(fecha_egreso_de_tratamiento))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 80 parsing failures. row col expected actual 194 – date like %d/%m/%Y 15<br>
1294 – date like %d/%m/%Y 30/12/09 1650 – date like %d/%m/%Y 20/01/10 1859 – date like %d/%m/%Y 23/03/09 1934 – date like %d/%m/%Y 13/05/09 …. … ……………… …….. See problems(…) for more details.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#delete environment of NDP 2023 Step 2</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ndp_2023_step2)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="ot">&lt;-</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23 <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fecha_egreso_de_tratamiento3=</span><span class="fu">as.character</span>(fecha_egreso_de_tratamiento)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fecha_egreso_de_tratamiento3=</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#1. format %d/%m/%y in minusc y</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"30/12/09"</span>, <span class="st">"20/01/10"</span>, <span class="st">"23/03/09"</span>, <span class="st">"13/05/09"</span>, <span class="st">"14/04/09"</span>, <span class="st">"15/09/09"</span>, <span class="st">"02/06/09"</span>, <span class="st">"09/06/09"</span>, <span class="st">"01/10/09"</span>, <span class="st">"09/03/09"</span>, <span class="st">"01/06/10"</span>, <span class="st">"03/04/10"</span>, <span class="st">"01/10/10"</span>, <span class="st">"14/01/11"</span>, <span class="st">"04/08/11"</span>, <span class="st">"08/07/13"</span>) <span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span> <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%d/%m/%y"</span>)),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2. format %d/%m/%y in minusc y without leading zeros </span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"4102010"</span>,  <span class="st">"3052011"</span>, <span class="st">"4102010"</span>, <span class="st">"13012011"</span>, <span class="st">"31012011"</span>, <span class="st">"3052011"</span>, <span class="st">"13012011"</span>, <span class="st">"13082013"</span>, <span class="st">"17072013"</span>, <span class="st">"12082013"</span>, <span class="st">"2082013"</span>, <span class="st">"1072013"</span>, <span class="st">"31072013"</span>, <span class="st">"17062013"</span>, <span class="st">"27072013"</span>, <span class="st">"25072013"</span>, <span class="st">"14072013"</span>, <span class="st">"2072013"</span>, <span class="st">"2082013"</span>, <span class="st">"7082013"</span>, <span class="st">"31072013"</span>, <span class="st">"27062013"</span>, <span class="st">"16082013"</span>, <span class="st">"9072013"</span>, <span class="st">"2082013"</span>, <span class="st">"20082013"</span>, <span class="st">"16082013"</span>, <span class="st">"22082013"</span>) <span class="sc">&amp;</span> <span class="fu">nchar</span>(fecha_egreso_de_tratamiento3) <span class="sc">&lt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span> <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(<span class="fu">sprintf</span>(<span class="st">"%08d"</span>, readr<span class="sc">::</span><span class="fu">parse_integer</span>(fecha_egreso_de_tratamiento3)),<span class="st">"%d%m%Y"</span>)), </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#3. format in "%d-%m-%Y"</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"01-02-2011"</span>, <span class="st">"06-09-2011"</span>, <span class="st">"27-11-2012"</span>, <span class="st">"01-03-2013"</span>)<span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span>  <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%d-%m-%Y"</span>)),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#4. format "%d/%m/%y"</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"10/6/11"</span>, <span class="st">"20/6/11"</span>, <span class="st">"10/6/11"</span>, <span class="st">"10/6/11"</span>, <span class="st">"20/6/11"</span>, <span class="st">"10/6/11"</span>, <span class="st">"10/7/11"</span>, <span class="st">"31/7/11"</span>, <span class="st">"12/6/11"</span>, <span class="st">"1/6/11"</span>, <span class="st">"5/6/11"</span>, <span class="st">"4/7/11"</span>, <span class="st">"31/7/11"</span>, <span class="st">"7/7/11"</span>, <span class="st">"2/8/11"</span>)<span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span>  <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%d/%m/%y"</span>)),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>     <span class="co">#5. format "%d/%m/%y"</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    fecha_egreso_de_tratamiento3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2013/04/02"</span>)<span class="sc">&amp;</span> <span class="fu">is.na</span>(fecha_egreso_de_tratamiento2) <span class="sc">~</span>  <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_date</span>(fecha_egreso_de_tratamiento3,<span class="st">"%Y/%m/%d"</span>)),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Others: keep as character fecha_egreso_de_tratamiento2 </span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    T<span class="sc">~</span> <span class="fu">as.character</span>(fecha_egreso_de_tratamiento2))) <span class="co">#%&gt;% </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: 153371 parsing failures. row col expected actual 1 – date like %d/%m/%y 01/03/2010 2 – date like %d/%m/%y 01/05/2010 3 – date like %d/%m/%y 13/04/2010 4 – date like %d/%m/%y 21/01/2010 5 – date like %d/%m/%y 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153364 parsing failures. row col expected actual 1 – no trailing characters 01/03/2010 2 – no trailing characters 01/05/2010 3 – no trailing characters 13/04/2010 4 – no trailing characters 21/01/2010 5 – no trailing characters 15/04/2011 … … …………………. ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 10 parsing failures. row col expected actual 194 – valid date 00000015 8239 – valid date 00000015 9042 – valid date 00000005 9043 – valid date 00000005 9353 – valid date 00000025 …. … ………. …….. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153398 parsing failures. row col expected actual 1 – date like %d-%m-%Y 01/03/2010 2 – date like %d-%m-%Y 01/05/2010 3 – date like %d-%m-%Y 13/04/2010 4 – date like %d-%m-%Y 21/01/2010 5 – date like %d-%m-%Y 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153371 parsing failures. row col expected actual 1 – date like %d/%m/%y 01/03/2010 2 – date like %d/%m/%y 01/05/2010 3 – date like %d/%m/%y 13/04/2010 4 – date like %d/%m/%y 21/01/2010 5 – date like %d/%m/%y 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<div class="alert alert-warning">
<p>Warning: 153402 parsing failures. row col expected actual 1 – date like %Y/%m/%d 01/03/2010 2 – date like %Y/%m/%d 01/05/2010 3 – date like %Y/%m/%d 13/04/2010 4 – date like %Y/%m/%d 21/01/2010 5 – date like %Y/%m/%d 15/04/2011 … … ……………… ………. See problems(…) for more details.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::filter(hash_key %in% parsing_failures$hash_key)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#impute discharge dates arbitrarely</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3<span class="sc">==</span><span class="st">"307203"</span>)] <span class="ot">&lt;-</span> <span class="st">"2013-07-30"</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento<span class="sc">==</span><span class="st">"01707/2010"</span>)] <span class="ot">&lt;-</span> <span class="st">"2010-07-17"</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento<span class="sc">==</span><span class="st">"30520011"</span>)] <span class="ot">&lt;-</span> <span class="st">"2011-05-30"</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3[<span class="fu">which</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento<span class="sc">==</span><span class="st">"30/08/20011"</span>)] <span class="ot">&lt;-</span> <span class="st">"2011-08-30"</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># format dates</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento_fmt<span class="ot">&lt;-</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">parse_date</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento3,<span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># format dates to numeric</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento_num<span class="ot">&lt;-</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">unclass</span>(cause_of_adm_discharge_ndp_23_2<span class="sc">$</span>fecha_egreso_de_tratamiento_fmt)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="co">#rare: 01707/2010, 30/08/20011, 30520011, 307203</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co">#ambiguous: 2082013, 1072013, 2072013, 2082013, 7082013, 2082013, "10/6/11", "20/6/11", "10/6/11"</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17, </span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Select the cases with death as the motive of administrative discharge</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2_filt<span class="ot">&lt;-</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>cause_of_adm_discharge_ndp_23_2 <span class="sc">%&gt;%</span> </span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(motivo_de_egreso_alta_administrativa<span class="sc">==</span><span class="st">"Fallecimiento"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we discard censorship due to deaths from the original database.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v13_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(cause_of_adm_discharge_ndp_23_2_filt[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_num"</span>,<span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="st">"hash_key"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(fech_ing_num_1 <span class="sc">&gt;</span> fecha_egreso_de_tratamiento_num) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">0</span>){<span class="fu">error</span>(<span class="st">"There are cases in which people were admitted to treatment after their death"</span>)}</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v13_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(cause_of_adm_discharge_ndp_23_2_filt[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_num"</span>,<span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="st">"hash_key"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(fech_egres_num_1 <span class="sc">&gt;</span> fecha_egreso_de_tratamiento_num) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">0</span>){<span class="fu">error</span>(<span class="st">"There are cases in which people were discharged of treatment after their death"</span>)}</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(Base_fiscalia_v13_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(cause_of_adm_discharge_ndp_23_2_filt[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_num"</span>,<span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="fu">c</span>(<span class="st">"hash_key"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fec_comision_simple_num=</span><span class="fu">unclass</span>(fec_comision_simple)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(fec_comision_simple_num <span class="sc">&gt;</span> fecha_egreso_de_tratamiento_num) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>() <span class="sc">&gt;</span><span class="dv">0</span>){<span class="fu">error</span>(<span class="st">"There are cases in which people committed an offense after their death"</span>)}</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v13_grant_23_24 %&gt;% </span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    dplyr::left_join(cause_of_adm_discharge_ndp_23_2_filt[,c("hash_key", "fecha_egreso_de_tratamiento_num","fecha_egreso_de_tratamiento_fmt")], by=c("hash_key")) %&gt;% </span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    dplyr::mutate(fec_comision_simple_num=unclass(fec_comision_simple)) %&gt;% </span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    #dplyr::filter(fec_comision_simple_num &gt; fecha_egreso_de_tratamiento_num) %&gt;% </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::select(hash_key, fec_comision_simple, fecha_egreso_de_tratamiento_fmt, fec_comision_simple_num, fecha_egreso_de_tratamiento_num) %&gt;% dplyr::filter(!is.na(fecha_egreso_de_tratamiento_fmt)) %&gt;% View()</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"It is probable that many SENDA dates are bad, and due to to the process of cleaning made in Fiscalia merge 2 and 3, the correct dates may have been already corrected. However, these databases are not available"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="bring-other-databases" class="level3">
<h3 class="anchored" data-anchor-id="bring-other-databases">Bring other databases</h3>
</section>
<section id="municipallity" class="level3">
<h3 class="anchored" data-anchor-id="municipallity">Municipallity</h3>
<p>Given that we found no cases with censorship due to deaths, we brought the classification of rurality (from the Census of 2017 in this <a href="https://www.masvidarural.gob.cl/wp-content/uploads/2021/04/Clasificacion-comunas-PNDR.xlsx">link</a>) and poverty index of communes between 2007-2020 (<a href="https://observatorio.ministeriodesarrollosocial.gob.cl/pobreza-comunal">link</a>).</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#http://observatorio.ministeriodesarrollosocial.gob.cl/pobreza-comunal-2020</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.masvidarural.gob.cl/wp-content/uploads/2021/04/Clasificacion-comunas-PNDR.xlsx</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>Comunas_PNDR <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Clasificacion-comunas-PNDR.xlsx"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16101"</span><span class="sc">~</span><span class="st">"8401"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16102"</span><span class="sc">~</span><span class="st">"8402"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16103"</span><span class="sc">~</span><span class="st">"8406"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16104"</span><span class="sc">~</span><span class="st">"8407"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16105"</span><span class="sc">~</span><span class="st">"8410"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16106"</span><span class="sc">~</span><span class="st">"8411"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16107"</span><span class="sc">~</span><span class="st">"8413"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16108"</span><span class="sc">~</span><span class="st">"8418"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16109"</span><span class="sc">~</span><span class="st">"8421"</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16201"</span><span class="sc">~</span><span class="st">"8414"</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16202"</span><span class="sc">~</span><span class="st">"8403"</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16203"</span><span class="sc">~</span><span class="st">"8404"</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16204"</span><span class="sc">~</span><span class="st">"8408"</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16205"</span><span class="sc">~</span><span class="st">"8412"</span>,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16206"</span><span class="sc">~</span><span class="st">"8415"</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16207"</span><span class="sc">~</span><span class="st">"8420"</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16301"</span><span class="sc">~</span><span class="st">"8416"</span>,</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16302"</span><span class="sc">~</span><span class="st">"8405"</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16303"</span><span class="sc">~</span><span class="st">"8409"</span>,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16304"</span><span class="sc">~</span><span class="st">"8417"</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as.character</span>(cod_com)<span class="sc">==</span><span class="st">"16305"</span><span class="sc">~</span><span class="st">"8419"</span>,</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>                                      T<span class="sc">~</span> <span class="fu">as.character</span>(cod_com)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co">#http://observatorio.ministeriodesarrollosocial.gob.cl/pobreza-comunal-2011</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>pobr_mult_2020<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimaciones_de_Tasa_de_Pobreza_por_Ingresos_por_Comunas_2020_revisada2022_09.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>pobr_mult_2019<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimaciones_de_Tasa_de_Pobreza_por_Ingresos_por_Comunas_2020_revisada2022_09.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2019</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>pobr_mult_2018<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2017.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2018</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>pobr_mult_2017<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2017.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2017</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>pobr_mult_2016<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2015.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2016</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>pobr_mult_2015<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_multidimensional_2015.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2015</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>pobr_mult_2014<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_2013.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2014</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>pobr_mult_2013<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PLANILLA_Estimaciones_comunales_tasa_pobreza_por_ingresos_2013.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2013</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>pobr_mult_2012<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimacion_tasa_de_pobreza_comunal_2011_(nueva _metodologia).xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2012</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>pobr_mult_2011<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimacion_tasa_de_pobreza_comunal_2011_(nueva _metodologia).xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2011</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>pobr_mult_2010<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"Estimacion_tasa_de_pobreza_comunal_2011_(nueva _metodologia).xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2010</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Porcentaje de"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>pobr_mult_2009<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PobrezaporComunas_SAE_20092011.xlsx"</span>, <span class="at">skip=</span><span class="dv">3</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2009</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(anio, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Incidencia pobreza"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Código"</span><span class="ot">=</span><span class="dv">2</span>, <span class="st">"Nombre comuna"</span><span class="ot">=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Región<span class="ot">=</span><span class="fu">rep</span>(<span class="st">""</span>)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>New names: * <code>-&gt; `...1` *</code> -&gt; <code>...2</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...3</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...4</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...5</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...6</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...7</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...8</code> * <code>-&gt; `...9` *</code> -&gt; <code>...10</code></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pobr_mult_2008<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PobrezaporComunas_SAE_20092011.xlsx"</span>, <span class="at">skip=</span><span class="dv">3</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2008</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(anio, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>    dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Incidencia pobreza"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Código"</span><span class="ot">=</span><span class="dv">2</span>, <span class="st">"Nombre comuna"</span><span class="ot">=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Región<span class="ot">=</span><span class="fu">rep</span>(<span class="st">""</span>)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>New names: * <code>-&gt; `...1` *</code> -&gt; <code>...2</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...3</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...4</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...5</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...6</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...7</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...8</code> * <code>-&gt; `...9` *</code> -&gt; <code>...10</code></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pobr_mult_2007<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"PobrezaporComunas_SAE_20092011.xlsx"</span>, <span class="at">skip=</span><span class="dv">3</span>)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">anio=</span><span class="dv">2007</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(anio, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span> <span class="st">"porc_pobr"</span>, dplyr<span class="sc">::</span><span class="fu">contains</span>(<span class="st">"Incidencia pobreza"</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Código"</span><span class="ot">=</span><span class="dv">2</span>, <span class="st">"Nombre comuna"</span><span class="ot">=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(Región<span class="ot">=</span><span class="fu">rep</span>(<span class="st">""</span>)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(anio, Código, Región, <span class="st">`</span><span class="at">Nombre comuna</span><span class="st">`</span>, porc_pobr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>New names: * <code>-&gt; `...1` *</code> -&gt; <code>...2</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...3</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...4</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...5</code> * <code>Límite inferior IC</code> -&gt; <code>Límite inferior IC...6</code> * <code>Incidencia pobreza</code> -&gt; <code>Incidencia pobreza...7</code> * <code>Límite superior IC</code> -&gt; <code>Límite superior IC...8</code> * <code>-&gt; `...9` *</code> -&gt; <code>...10</code></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pobr_mult_2007_2020<span class="ot">&lt;-</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(pobr_mult_2007, pobr_mult_2008, pobr_mult_2009, pobr_mult_2010, pobr_mult_2011, pobr_mult_2012, pobr_mult_2013, pobr_mult_2014, pobr_mult_2015, pobr_mult_2016, pobr_mult_2017, pobr_mult_2018, pobr_mult_2019, pobr_mult_2020) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(Código<span class="sc">==</span><span class="st">"16101"</span><span class="sc">~</span><span class="st">"8401"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16102"</span><span class="sc">~</span><span class="st">"8402"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16103"</span><span class="sc">~</span><span class="st">"8406"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16104"</span><span class="sc">~</span><span class="st">"8407"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16105"</span><span class="sc">~</span><span class="st">"8410"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16106"</span><span class="sc">~</span><span class="st">"8411"</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16107"</span><span class="sc">~</span><span class="st">"8413"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16108"</span><span class="sc">~</span><span class="st">"8418"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16109"</span><span class="sc">~</span><span class="st">"8421"</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16201"</span><span class="sc">~</span><span class="st">"8414"</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16202"</span><span class="sc">~</span><span class="st">"8403"</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16203"</span><span class="sc">~</span><span class="st">"8404"</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16204"</span><span class="sc">~</span><span class="st">"8408"</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16205"</span><span class="sc">~</span><span class="st">"8412"</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16206"</span><span class="sc">~</span><span class="st">"8415"</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16207"</span><span class="sc">~</span><span class="st">"8420"</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16301"</span><span class="sc">~</span><span class="st">"8416"</span>,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16302"</span><span class="sc">~</span><span class="st">"8405"</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16303"</span><span class="sc">~</span><span class="st">"8409"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16304"</span><span class="sc">~</span><span class="st">"8417"</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>                                      Código<span class="sc">==</span><span class="st">"16305"</span><span class="sc">~</span><span class="st">"8419"</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>                                      T<span class="sc">~</span> Código</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete `pobr_mult_` object </span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>object_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"pobr_mult_"</span>, <span class="dv">2007</span><span class="sc">:</span><span class="dv">2020</span>)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> object_names) {</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">exists</span>(name)) {  <span class="co"># Check if object exists</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(<span class="at">list =</span> name)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="senda-september-2020" class="level3">
<h3 class="anchored" data-anchor-id="senda-september-2020">SENDA September 2020</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Retrieve CONS_C1_df_dup_SEP_2020 from previous 8.RData (Fondecyt 1191282)"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"13.RData"</span>, fiscalia_merge3 <span class="ot">&lt;-</span> <span class="fu">new.env</span>() )</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>CONS_C1_df_dup_SEP_2020<span class="ot">&lt;-</span> fiscalia_merge3<span class="sc">$</span>CONS_C1_df_dup_SEP_2020</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fiscalia_merge3)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Make the database"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v13_grant_23_24 <span class="sc">%&gt;%</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">comuna_residencia_cod_rec=</span> <span class="fu">as.character</span>(readr<span class="sc">::</span><span class="fu">parse_number</span>(comuna_residencia_cod)), <span class="at">anio_ing_tr=</span> lubridate<span class="sc">::</span><span class="fu">epiyear</span>(fech_ing)) <span class="sc">%&gt;%</span> <span class="co">#glimpse()</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(pobr_mult_2007_2020[,<span class="fu">c</span>(<span class="st">"anio"</span>, <span class="st">"cod"</span>,<span class="st">"porc_pobr"</span>)], <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"comuna_residencia_cod_rec"</span><span class="ot">=</span><span class="st">"cod"</span>, <span class="st">"anio_ing_tr"</span><span class="ot">=</span><span class="st">"anio"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(Comunas_PNDR[,<span class="fu">c</span>(<span class="st">"cod"</span>, <span class="st">"Clasificación"</span>)], <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"comuna_residencia_cod_rec"</span><span class="ot">=</span><span class="st">"cod"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-07-17: we eliminated class_centros</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-02-01</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::left_join(class_centros[,c("id_centro", "nombre_centro_1", "classification")], by= "id_centro")%&gt;%</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">when</span>(<span class="fu">nrow</span>(.)<span class="sc">&gt;</span><span class="fu">nrow</span>(Base_fiscalia_v13_grant_23_24) <span class="sc">~</span> <span class="fu">stop</span>(<span class="st">"More cases in the new database"</span>), <span class="sc">~</span>.) <span class="sc">%&gt;%</span> </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#2023-07-17: create the event and time to event</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ages at offense vs. ages at discharge</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">warning_needed =</span> age_offending_imp <span class="sc">-</span> edad_al_egres_1 <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(<span class="fu">any</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Cases with offense ages lower than age at discharge: "</span>, <span class="fu">format</span>(<span class="fu">sum</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm=</span>T), <span class="at">big.mark=</span><span class="st">","</span>))); .} <span class="sc">%&gt;%</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>warning_needed) <span class="sc">%&gt;%</span> </span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ages at offense vs. ages at discharge</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#    dplyr::filter(dplyr::case_when(edad_al_egres_1 - edad_al_ing_1 &lt; 0~F,T~T))</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">warning_needed =</span> edad_al_egres_1 <span class="sc">-</span> edad_al_ing_1 <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(<span class="fu">any</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Cases with ages at discharge lower than age at admission: "</span>, <span class="fu">format</span>(<span class="fu">sum</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm=</span>T), <span class="at">big.mark=</span><span class="st">","</span>))); .} <span class="sc">%&gt;%</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>warning_needed) <span class="sc">%&gt;%</span> </span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ages at offense vs. ages at admission</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">warning_needed =</span> age_offending_imp <span class="sc">-</span> edad_al_ing_1 <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  {<span class="cf">if</span>(<span class="fu">any</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Cases with offense ages lower than age at admission: "</span>, <span class="fu">format</span>(<span class="fu">sum</span>(.<span class="sc">$</span>warning_needed, <span class="at">na.rm=</span>T), <span class="at">big.mark=</span><span class="st">","</span>))); .} <span class="sc">%&gt;%</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>warning_needed) <span class="sc">%&gt;%</span> </span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17: modify ages to event and event. Get dichotomous variables created earlier</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_  </span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_offending_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(age_offending_imp<span class="sc">-</span>edad_al_egres_1<span class="sc">&lt;=</span><span class="dv">0</span><span class="sc">~</span> age_offending_imp<span class="sc">+</span> <span class="fl">0.0001</span>,T<span class="sc">~</span>age_offending_imp), <span class="at">event_offense=</span> off_aft_adm)<span class="sc">%&gt;%</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_tr_comp_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(edad_al_egres_1<span class="sc">-</span>edad_al_ing_1<span class="sc">&lt;=</span><span class="dv">0</span><span class="sc">~</span> edad_al_egres_1<span class="sc">+</span> <span class="fl">0.0001</span>,T<span class="sc">~</span>edad_al_egres_1), <span class="at">event_comp=</span> mot_egres_mod_imp_rec_num)<span class="sc">%&gt;%</span>  </span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-17: modify ages according to age at censorship if the event is not observed in the time frame</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_  </span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_offending_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_offense<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_offending_imp)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_tr_comp_imp=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_comp<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_tr_comp_imp)) <span class="sc">%&gt;%</span>   </span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_at_censor_date=</span>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, <span class="fu">as.Date</span>(<span class="st">"2019-11-13"</span>)),<span class="at">unit=</span><span class="st">"years"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time_to_off_from_adm=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_offense<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span> age_at_censor_date<span class="sc">-</span> edad_al_ing_1, T<span class="sc">~</span> age_offending_imp<span class="sc">-</span>edad_al_ing_1)) <span class="sc">%&gt;%</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time_to_drop_from_adm=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(event_offense<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span> age_at_censor_date<span class="sc">-</span> edad_al_ing_1, T<span class="sc">~</span> age_tr_comp_imp<span class="sc">-</span>edad_al_ing_1)) <span class="sc">%&gt;%</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">freq_cons_sus_prin=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">as.character</span>(freq_cons_sus_prin)<span class="sc">==</span><span class="st">"Did not use"</span><span class="sc">~</span><span class="st">"Less than 1 day a week"</span>, T<span class="sc">~</span> <span class="fu">as.character</span>(freq_cons_sus_prin)))<span class="sc">%&gt;%</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">escolaridad_rec=</span><span class="fu">parse_factor</span>(<span class="fu">as.character</span>(escolaridad_rec),<span class="at">levels=</span><span class="fu">c</span>(<span class="st">'3-Completed primary school or less'</span>, <span class="st">'2-Completed high school or less'</span>, <span class="st">'1-More than high school'</span>), <span class="at">ordered =</span>T,<span class="at">trim_ws=</span>T,<span class="at">include_na =</span>F, <span class="at">locale=</span><span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"Latin1"</span>))) <span class="sc">%&gt;%</span>  </span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">freq_cons_sus_prin=</span><span class="fu">parse_factor</span>(<span class="fu">as.character</span>(freq_cons_sus_prin),<span class="at">levels=</span><span class="fu">c</span>(<span class="st">'Less than 1 day a week'</span>,<span class="st">'2 to 3 days a week'</span>,<span class="st">'4 to 6 days a week'</span>,<span class="st">'1 day a week or more'</span>,<span class="st">'Daily'</span>), <span class="at">ordered =</span>T,<span class="at">trim_ws=</span>F,<span class="at">include_na =</span>F)) <span class="sc">%&gt;%</span> <span class="co">#, locale=locale(encoding = "Latin1")</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"sus_principal_mod"</span>, <span class="st">"origen_ingreso_mod"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, <span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>),<span class="sc">~</span><span class="fu">as.factor</span>(.)))<span class="sc">%&gt;%</span> </span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">via_adm_sus_prin_act=</span> <span class="fu">factor</span>(dplyr<span class="sc">::</span><span class="fu">case_when</span>(via_adm_sus_prin_act<span class="sc">==</span><span class="st">"Injected Intravenously or Intramuscularly"</span><span class="sc">~</span> <span class="st">"Other"</span>,T<span class="sc">~</span>via_adm_sus_prin_act))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="co">#TO CHECK IF SOME MUNICIPALLITIES DID NOT JOIN</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dplyr::filter(is.na(porc_pobr)) %&gt;% dplyr::select(comuna_residencia_cod, anio_ing_tr)</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">con_quien_vive_joel=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Solo$"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Alone"</span>,</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con abuelos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con hermanos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con la madre </span><span class="sc">\\</span><span class="st">(sola</span><span class="sc">\\</span><span class="st">)"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con otro pariente"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>,</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"con hijos y padres o familia"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"con la pareja y padres o familia de origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"con padres o familia de origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2021-10-01</span></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Únicamente con hijos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Únicamente con pareja"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2021-10-01</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con la Pareja, Hijos y Padres o Familia de Origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Hijos y Padres o Familia de Origen"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Family of origin"</span>,</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">#2021-10-01</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Únicamente con la pareja e hijos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"With couple/children"</span>,</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con amigos"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>,</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Con otro NO pariente"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>,</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"*Otros$"</span>,con_quien_vive, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="st">"Others"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(<span class="fu">subset</span>(CONS_C1_df_dup_SEP_2020, dup<span class="sc">==</span><span class="dv">1</span>, <span class="fu">c</span>(<span class="st">"hash_key"</span>,<span class="st">"embarazo"</span>)), <span class="at">by=</span> <span class="st">"hash_key"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">numero_de_hijos_mod_joel=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">grepl</span>(<span class="st">"Si$"</span>,embarazo, <span class="at">ignore.case=</span>T)<span class="sc">~</span><span class="fu">as.integer</span>(numero_de_hijos_mod<span class="sc">+</span><span class="dv">1</span>),T<span class="sc">~</span><span class="fu">as.integer</span>(numero_de_hijos_mod)))  <span class="sc">%&gt;%</span> </span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ano_nac_corr=</span><span class="fu">as.numeric</span>(stringr<span class="sc">::</span><span class="fu">str_sub</span>(<span class="fu">as.character</span>(fech_nac_rec),<span class="dv">1</span>,<span class="dv">4</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">num_hijos_mod_joel_bin=</span>dplyr<span class="sc">::</span><span class="fu">if_else</span>(numero_de_hijos_mod_joel<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"dg_fis_otr_cond_fis_ries_vit"</span>, <span class="st">"dg_fis_pat_ges_intrau"</span>, <span class="st">"dg_fis_hep_cro"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_enf_som"</span>, <span class="st">"dg_fis_otr_cond_fis"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_ets"</span>, <span class="st">"dg_fis_card"</span>), <span class="sc">~</span><span class="fu">as.numeric</span>(.)<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dg_fis_total =</span> <span class="fu">rowSums</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(., <span class="fu">c</span>(<span class="st">"dg_fis_otr_cond_fis_ries_vit"</span>, <span class="st">"dg_fis_pat_ges_intrau"</span>, <span class="st">"dg_fis_hep_cro"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_enf_som"</span>, <span class="st">"dg_fis_otr_cond_fis"</span>, <span class="st">"dg_fis_hep_alc"</span>, <span class="st">"dg_fis_ets"</span>, <span class="st">"dg_fis_card"</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cnt_dg_trs_fis=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(dg_fis_total<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">~</span> <span class="st">"One or more"</span>, <span class="fu">as.character</span>(dg_fis_in_study)<span class="sc">==</span> <span class="st">"Presence"</span> <span class="sc">&amp;</span> dg_fis_total<span class="sc">==</span> <span class="dv">0</span><span class="sc">~</span><span class="st">"Diagnosis unknown (under study)"</span>, dg_fis_total<span class="sc">==</span><span class="dv">0</span><span class="sc">~</span><span class="st">"Without physical comorbidity"</span>)) <span class="sc">%&gt;%</span> <span class="co">#janitor::tabyl(cnt_dg_trs_fis)</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fis_comorbidity_icd_10=</span><span class="fu">parse_factor</span>(<span class="fu">as.character</span>(cnt_dg_trs_fis),<span class="at">levels=</span><span class="fu">c</span>(<span class="st">'Without physical comorbidity'</span>, <span class="st">'Diagnosis unknown (under study)'</span>,<span class="st">'One or more'</span>), <span class="at">ordered =</span>T,<span class="at">trim_ws=</span>F,<span class="at">include_na =</span>F)) <span class="sc">%&gt;%</span> <span class="co">#, locale=locale(encoding = "Latin1") </span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2023-07-31</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(dplyr<span class="sc">::</span><span class="fu">distinct</span>(cause_of_adm_discharge_ndp_23_2_filt,hash_key,<span class="at">.keep_all =</span> T)[,<span class="fu">c</span>(<span class="st">"hash_key"</span>, <span class="st">"fecha_egreso_de_tratamiento_fmt"</span>)], <span class="at">by=</span><span class="st">"hash_key"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"date_death"</span><span class="ot">=</span><span class="st">"fecha_egreso_de_tratamiento_fmt"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_at_death=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(date_death)<span class="sc">~</span></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">time_length</span>(lubridate<span class="sc">::</span><span class="fu">interval</span>(fech_nac_rec, date_death),<span class="at">unit=</span><span class="st">"years"</span>), T<span class="sc">~</span> age_at_censor_date)) <span class="sc">%&gt;%</span></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">event_death=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(date_death),<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_  </span></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">paste0</span>(<span class="st">"otras_sus"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="st">"_mod"</span>),<span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(.<span class="sc">==</span><span class="st">"Cocaína"</span><span class="sc">~</span> <span class="st">"Cocaine hydrochloride"</span>, .<span class="sc">==</span><span class="st">"Marihuana"</span><span class="sc">~</span> <span class="st">"Marijuana"</span>, .<span class="sc">==</span><span class="st">"Otros"</span><span class="sc">~</span><span class="st">"Other"</span>, .<span class="sc">==</span><span class="st">"Pasta Base"</span><span class="sc">~</span> <span class="st">"Cocaine paste"</span>, T<span class="sc">~</span>.)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sus_principal_mod=</span> <span class="fu">as.character</span>(sus_principal_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Empty substances were replaced with the previous</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus3_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(otras_sus2_mod)<span class="sc">~</span> otras_sus3_mod, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus2_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(otras_sus1_mod)<span class="sc">~</span> otras_sus2_mod, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sus_principal_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(otras_sus1_mod) <span class="sc">&amp;</span> <span class="fu">is.na</span>(sus_principal_mod)<span class="sc">~</span> otras_sus1_mod, T<span class="sc">~</span> sus_principal_mod)) <span class="sc">%&gt;%</span>  </span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span>   </span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace with missing if there are any duplicates</span></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus3_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus3_mod<span class="sc">==</span>otras_sus2_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus3_mod<span class="sc">==</span>sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus3_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus2_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus2_mod<span class="sc">==</span>otras_sus1_mod<span class="sc">|</span> otras_sus2_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus2_mod)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">otras_sus1_mod=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(otras_sus1_mod<span class="sc">==</span> sus_principal_mod<span class="sc">~</span> <span class="cn">NA_character_</span>, T<span class="sc">~</span> otras_sus1_mod)) <span class="sc">%&gt;%</span>  </span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in dplyr::select(., -warning_needed): Cases with offense ages lower than age at discharge: 5,793</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Add the last variable"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-17: Rurality classification</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24<span class="sc">$</span>clas_r <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(Base_fiscalia_v14_grant_23_24<span class="sc">$</span>Clasificación), <span class="at">ref =</span> <span class="st">"Urbana"</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-17: we bring Fiscalia merge5 classification</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24<span class="sc">$</span>via_adm_sus_prin_act <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(Base_fiscalia_v14_grant_23_24<span class="sc">$</span>via_adm_sus_prin_act), <span class="at">ref =</span> <span class="st">"Oral (drunk or eaten)"</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="victim-data" class="level3">
<h3 class="anchored" data-anchor-id="victim-data">Victim data</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Retrieve CONS_C1_df_dup_SEP_2020 from previous 8.RData (Fondecyt 1191282)"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"14.Rdata"</span>, data_mariel_fisc_merge4 <span class="ot">&lt;-</span> <span class="fu">new.env</span>() )</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#offenses that threatens psychosexual integrity</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#https://amparoyjusticia.cl/wp-content/uploads/2023/04/Estudio-Fundacion-amparo-y-Justicia.pdf</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>delitos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ABANDONO DE NIÑOS"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABORTO SIN CONSENTIMIENTO"</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX C/CONTACTO CORP. A MENOR DE 14 AÑOS ART 366 BIS"</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX MAYOR 14/MENOR 18 CON CIRCUNS ESTUPRO ART 366 INC2"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX MAYOR DE 14 AÑOS POR SORPRESA Y/O S/CONSENTIM. ART"</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX. S/CONTAC MAYOR 14 MENOR 18 ART 366 QUAT INC 3,4,5"</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEX. S/CONTACTO CORP. MENOR 14 ART 366 QUAT. INC 1 Y 2"</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEXUAL CALIFICADO (CON OBJETOS O ANIMALES)ART.365 BIS"</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ABUSO SEXUAL DE MAYOR DE 14 (CON CIRC. DE VIOLACIÓN) ART 366"</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ADQ. O ALMACENAMIENTO MAT.PORNOGRÁFICO INF.ART.374 BIS INC 2"</span>,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>             <span class="st">"CASTRACIÓN Y MUTILACIÓN"</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>             <span class="st">"COMERCIALIZACIÓN MAT. PORNOGRÁFICO ELAB.UTIL. MEN.DE 18 AÑOS"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ESTUPRO"</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>             <span class="st">"FEMICIDIO INTIMO ART. 390 BIS"</span>,</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">"INDUCIR A UN MENOR A ABANDONAR EL HOGAR"</span>,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">"INFANTICIDIO"</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">"MALTRATO CORPORAL A PERSONAS VULNERABLES ART 403 BIS INC 1°"</span>,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OBTENCIÓN DE SERVICIOS SEXUALES DE MENORES. ART. 367 TER."</span>,</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OFENSAS AL PUDOR (495 Nº 5 Código Penal)"</span>,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OTROS ABUSOS CONTRA PARTICULARES.ART. 256,257,258,259"</span>,</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>             <span class="st">"OTROS DEL C/ ORDEN FAMILIA, MORALIDAD Pº, INTEGRIDAD SEXUAL"</span>,</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>             <span class="st">"PRESUNTA DESGRACIA INFANTIL"</span>,</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>             <span class="st">"PRODUCCIÓN MATERIAL PORNOGRÁFICO UTILIZANDO MENOR.DE 18 AÑOS"</span>,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ROBO CON VIOLACIÓN. ART. 433 Nº1."</span>,</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SECUESTRO CON HOMICIDIO, VIOLACIÓN O LES. ART.141 INC. FINAL"</span>,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SECUESTRO CON VIOLACIÓN"</span>,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SODOMIA. ART. 365."</span>,</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>             <span class="st">"SUSTRACCIÓN DE MENORES. ART. 142"</span>,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TRATA DE PERSONAS PARA LA EXPLOTACIÓN SEXUAL ART 411 QUATER"</span>,</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ULTRAJE PÚBLICO A LAS BUENAS COSTUMBRES POR MED.COM.SOCIAL"</span>,</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>             <span class="st">"ULTRAJE PÚBLICO A LAS BUENAS COSTUMBRES. ART. 373."</span>,</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>             <span class="st">"VIOLACIÓN DE MAYOR DE 14 AÑOS. ART. 361."</span>,</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>             <span class="st">"VIOLACIÓN DE MENOR DE 14 AÑOS. ART. 362."</span>,</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>             <span class="st">"INCESTO"</span>,</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TORTURAS COMETIDAS POR FUNCIONARIOS PÚBLICOS (150 A INC 1)"</span>,</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TORTURAS POR PARTICULARES AGENTES DEL ESTADO (150 A INC. 2)"</span>,</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TRATA PARA TRABAJOS FORZADOS Y OTROS ART411 QUATER INC1°"</span>,</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>             <span class="st">"TRATOS DEGRADANTES A PERSONAS VULNERABLES. ART. 403 TER."</span>,</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>             <span class="st">"VIOLACIÓN CON HOMICIDIO O FEMICIDIO ART. 372 BIS."</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic<span class="ot">&lt;-</span> data_mariel_fisc_merge4<span class="sc">$</span>Base_fiscalia_v8 <span class="sc">%&gt;%</span> </span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(encontrado_como_victima<span class="sc">==</span><span class="st">"SI"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gls_materia <span class="sc">%in%</span> delitos)</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic_distinct<span class="ot">&lt;-</span> </span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>data_mariel_fisc_merge4<span class="sc">$</span>Base_fiscalia_v8 <span class="sc">%&gt;%</span> </span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(encontrado_como_victima<span class="sc">==</span><span class="st">"SI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(gls_materia)</span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic_distinct <span class="sc">%&gt;%</span> </span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"offenses_victims.xlsx"</span>)</span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(data_mariel_fisc_merge4)</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a><span class="co">#cod_delito, gls_materia fec_comision_simple, relacion_vifsaf edad_comision_imp</span></span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v9 %&gt;% </span></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a><span class="co"># +     dplyr::filter(relacion_vifsaf=="SI") %&gt;% </span></span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a><span class="co"># +     dplyr::distinct(crime_code_c)</span></span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v8_vic2<span class="ot">&lt;-</span> Base_fiscalia_v8_vic <span class="sc">%&gt;%</span> </span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(rut_enc_saf, cod_delito, gls_materia, edad_comision_imp, fec_comision_simple, relacion_vifsaf, edad_comision_imp) <span class="sc">%&gt;%</span> </span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>gls_materia<span class="sc">==</span> <span class="st">"PRESUNTA DESGRACIA INFANTIL"</span>)</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a><span class="co">#1,906 individuals</span></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>  sqldf<span class="sc">::</span><span class="fu">sqldf</span>(<span class="st">"SELECT *</span></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM Base_fiscalia_v14_grant_23_24 AS x  </span></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a><span class="st">  LEFT JOIN (SELECT *</span></span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM Base_fiscalia_v8_vic2</span></span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a><span class="st">             ) AS y</span></span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a><span class="st">  ON x.hash_key == y.rut_enc_saf AND </span></span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a><span class="st">  x.edad_al_ing_1 &gt; y.edad_comision_imp AND x.dup = 1"</span>) <span class="co">#2022-11-25  added dup // #changed the direction to past events, where age at discharge is greater than the age of commission</span></span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a><span class="fu">warning</span>(</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Rows added: "</span>, </span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nrow</span>(Base_fiscalia_v15_grant_23_24)<span class="sc">-</span> <span class="fu">nrow</span>(Base_fiscalia_v14_grant_23_24)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Rows added: 250</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"no_mostrar"</span>)){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v15_grant_23_24) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>rut_enc_saf) <span class="sc">%&gt;%</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, edad_al_ing_1,gls_materia, edad_comision_imp, fec_comision_simple_2, relacion_vifsaf_2,n) <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">View</span>()</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">#edad_comision_imp, fec_comision_simple_2, relacion_vifsaf_2</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the first offense by user</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15b_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v15_grant_23_24) <span class="sc">%&gt;%</span> </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">with_ties=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>rut_enc_saf) <span class="sc">%&gt;%</span> </span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    data.table<span class="sc">::</span><span class="fu">as.data.table</span>()</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="co"># count distinct previous offenses in terms of date and type of offense</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>more_than_one_offense_as_victim<span class="ot">&lt;-</span>  </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">clean_names</span>(Base_fiscalia_v15_grant_23_24) <span class="sc">%&gt;%</span> </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">comb_prueba=</span> <span class="fu">paste0</span>(edad_comision_imp,<span class="st">"_"</span>, gls_materia)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(comb_prueba) <span class="sc">%&gt;%</span> </span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">with_ties=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>rut_enc_saf) <span class="sc">%&gt;%</span>  </span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(hash_key, edad_comision_imp, gls_materia) <span class="sc">%&gt;%</span> </span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(hash_key) <span class="sc">%&gt;%</span> </span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co">#integrate the count of records as victim of patietns</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15b_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(more_than_one_offense_as_victim, <span class="at">by=</span><span class="st">"hash_key"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"n_off_vict"</span><span class="ot">=</span><span class="st">"n"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n_off_vict=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">is.na</span>(n_off_vict)<span class="sc">~</span><span class="dv">0</span>, T<span class="sc">~</span> <span class="fu">as.numeric</span>(n_off_vict))) <span class="sc">%&gt;%</span> </span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>()</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cases that dropped out"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cases that dropped out</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>     janitor<span class="sc">::</span><span class="fu">tabyl</span>(event_comp, event_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> event_comp     0   1
          0 65612 158
          1 19255  23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v14_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>     janitor<span class="sc">::</span><span class="fu">tabyl</span>(event_offense, event_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> event_offense     0   1
             0 57165 158
             1 27702  23</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="descriptives" class="level2">
<h2 class="anchored" data-anchor-id="descriptives">Descriptives</h2>
<p>Generate the event dates and time to events.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Label variables"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-19</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>motivodeegreso_mod_imp_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Complete status of treatment (binary)"</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>offense_after_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Committing an offense after admission (binary)"</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>age_at_censor_date,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at censorship"</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>age_offending_imp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at offending"</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>age_tr_comp_imp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at completing tr."</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">#attr(Base_fiscalia_v15c_grant_23_24$tr_modality,"label") &lt;- "Treatment Modality"</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>time_to_off_from_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to offense from admission"</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>time_to_drop_from_adm,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to dropout from admission"</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-07-31</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>age_at_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age at death"</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>date_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Time to death from admission"</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>event_death,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Death from admission"</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>event_comp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Event: tr.completion"</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>event_offense,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Event: offense"</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>edad_al_ing_1,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age (admission to treatment)"</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>sex,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Sex"</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>edad_ini_cons,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Age of Onset of Substance Use"</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>escolaridad_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Educational Attainment"</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>sus_principal_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary Substance (admission to treatment)"</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>freq_cons_sus_prin,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Frequency of Substance Use (Primary Substance)"</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>condicion_ocupacional_corr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Corrected Occupational Status (f)"</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>policonsumo,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Co-occurring Substance Use Disorders (Polysubstance use)"</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co">#20203-07-17</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>otras_sus1_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"First additional substance at admission"</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>otras_sus2_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Second additional substance at admission"</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>otras_sus3_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Third additional substance at admission"</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>num_hijos_mod_joel_bin,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Number of Children (dichotomized)"</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>tenencia_de_la_vivienda_mod,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Housing Situation (Tenure Status)"</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>macrozona,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Macro Administrative Zone in Chile"</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>n_off_vio,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Violent Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>n_off_acq,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Acquisitive Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>n_off_sud,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Substance-Related Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>n_off_oth,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Other Criminal Offenses (Pre-Treatment)"</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>dg_cie_10_rec,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Psychiatric Comorbidity (ICD-10)"</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>dg_trs_cons_sus_or,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"SUD Severity (Dependence status)"</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>clas_r,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Socioeconomic Classification"</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>porc_pobr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Percentage of people in poverty"</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>sus_ini_mod_mvv,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Primary Substance (initial diagnosis)"</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>ano_nac_corr,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Corrected birth year"</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>con_quien_vive_joel,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Cohabitation status (Recoded) (f)"</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(Base_fiscalia_v15c_grant_23_24<span class="sc">$</span>fis_comorbidity_icd_10,<span class="st">"label"</span>) <span class="ot">&lt;-</span> <span class="st">"Physical Comorbidity (ICD-10)"</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>vars_cov <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, <span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin"</span>, <span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"policonsumo"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, <span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, <span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, <span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, <span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"age_at_death"</span>,<span class="st">"event_death"</span>)</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>as.data.frame.TableOne <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) {<span class="fu">capture.output</span>(<span class="fu">print</span>(x,</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>                          <span class="at">showAllLevels =</span> <span class="cn">TRUE</span>, <span class="at">varLabels =</span> T,...) <span class="ot">-&gt;</span> x)</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>  y<span class="sc">$</span>characteristic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="fu">rownames</span>(x), <span class="st">""</span>)</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(characteristic, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(characteristic, <span class="fu">everything</span>())</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(y) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>  y}</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>tbone_desc_merge5_grant_23_24<span class="ot">&lt;-</span></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a><span class="fu">CreateTableOne</span>(<span class="at">vars=</span><span class="fu">c</span>(<span class="fu">setdiff</span>(vars_cov, <span class="st">"policonsumo"</span>), <span class="st">"offense_after_adm"</span>), <span class="at">data=</span>  Base_fiscalia_v15c_grant_23_24[,<span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>, <span class="st">"edad_al_ing_1"</span>, <span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, </span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="st">"escolaridad_rec"</span>, <span class="st">"sus_principal_mod"</span>, <span class="st">"freq_cons_sus_prin"</span>, </span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a><span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"policonsumo"</span>, <span class="st">"otras_sus1_mod"</span>, </span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a><span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, </span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, </span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a><span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, </span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, </span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, </span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a><span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"offense_after_adm"</span>,<span class="st">"age_at_death"</span>, <span class="st">"event_death"</span>)], <span class="at">factorVars =</span> <span class="fu">setdiff</span>(vars_cov, <span class="fu">c</span>(<span class="st">"motivodeegreso_mod_imp_rec"</span>,<span class="st">"edad_al_ing_1"</span>, <span class="st">"edad_ini_cons"</span>,<span class="st">"ano_nac_corr"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"time_to_off_from_adm"</span>, <span class="st">"time_to_drop_from_adm"</span>, <span class="st">"age_at_censor_date"</span>, <span class="st">"age_tr_comp_imp"</span>, <span class="st">"age_offending_imp"</span>, <span class="st">"age_at_death"</span>)), <span class="at">smd=</span>T, <span class="at">strata=</span><span class="st">"policonsumo"</span>, <span class="at">addOverall =</span> T, <span class="at">includeNA=</span>T, <span class="at">test=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning in ModuleReturnVarsExist(vars, data): These variables only have NA/NaN: otras_sus3_mod Dropped</p>
</div>
<div class="alert alert-warning">
<p>Warning in ModuleReturnVarsExist(factorVars, data): These variables only have NA/NaN: otras_sus3_mod Dropped</p>
</div>
</div>
<div class=".center-table">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame.TableOne</span>(tbone_desc_merge5_grant_23_24, <span class="at">smd=</span>T, <span class="at">nonnormal=</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>characteristic) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">fill</span>(char2) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(char2,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">level=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(level),<span class="st">"[Missing]"</span>,level)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">char2=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(characteristic<span class="sc">==</span><span class="st">"NA"</span><span class="sc">~</span><span class="cn">NA_character_</span>,T<span class="sc">~</span><span class="fu">as.character</span>(characteristic))) <span class="sc">%&gt;%</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_cells</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(.)), <span class="st">"bold"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">format=</span><span class="st">"markdown"</span>,<span class="at">caption=</span> <span class="st">"Summary descriptives, Polysubstance(1) and no Polysubstance use (0)"</span>, <span class="at">escape=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>fill: changed 66 values (66%) of ‘characteristic’ (66 fewer NA)</p>
</div>
<div class="message">
<p>select: columns reordered (characteristic, level, Overall, 0, 1, …)</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Summary descriptives, Polysubstance(1) and no Polysubstance use (0)</caption>
<colgroup>
<col style="width: 27%">
<col style="width: 21%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">characteristic</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
<th style="text-align: left;">SMD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>n</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>85048</strong></td>
<td style="text-align: left;"><strong>22552</strong></td>
<td style="text-align: left;"><strong>62496</strong></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment completion</td>
<td style="text-align: left;">19278 (22.7)</td>
<td style="text-align: left;">6404 ( 28.4)</td>
<td style="text-align: left;">12874 (20.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.183</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">Treatment non-completion</td>
<td style="text-align: left;">65761 (77.3)</td>
<td style="text-align: left;">16148 ( 71.6)</td>
<td style="text-align: left;">49613 (79.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Complete status of treatment (binary) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">9 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">9 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age (admission to treatment) (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">34.21 [27.41, 43.17]</td>
<td style="text-align: left;">41.71 [32.29, 51.21]</td>
<td style="text-align: left;">32.33 [26.45, 39.90]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.743</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Men</td>
<td style="text-align: left;">64028 (75.3)</td>
<td style="text-align: left;">16502 ( 73.2)</td>
<td style="text-align: left;">47526 (76.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex (%)</td>
<td style="text-align: left;">Women</td>
<td style="text-align: left;">21020 (24.7)</td>
<td style="text-align: left;">6050 ( 26.8)</td>
<td style="text-align: left;">14970 (24.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Age of Onset of Substance Use (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">15.00 [14.00, 18.00]</td>
<td style="text-align: left;">17.00 [14.00, 20.00]</td>
<td style="text-align: left;">15.00 [13.00, 17.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.425</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">1-More than high school</td>
<td style="text-align: left;">14068 (16.5)</td>
<td style="text-align: left;">3215 ( 14.3)</td>
<td style="text-align: left;">10853 (17.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.230</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">2-Completed high school or less</td>
<td style="text-align: left;">46653 (54.9)</td>
<td style="text-align: left;">11143 ( 49.4)</td>
<td style="text-align: left;">35510 (56.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">3-Completed primary school or less</td>
<td style="text-align: left;">23943 (28.2)</td>
<td style="text-align: left;">8044 ( 35.7)</td>
<td style="text-align: left;">15899 (25.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational Attainment (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">384 ( 0.5)</td>
<td style="text-align: left;">150 ( 0.7)</td>
<td style="text-align: left;">234 ( 0.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">28859 (33.9)</td>
<td style="text-align: left;">14212 ( 63.0)</td>
<td style="text-align: left;">14647 (23.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.890</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">16151 (19.0)</td>
<td style="text-align: left;">2337 ( 10.4)</td>
<td style="text-align: left;">13814 (22.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">32681 (38.4)</td>
<td style="text-align: left;">4511 ( 20.0)</td>
<td style="text-align: left;">28170 (45.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">5771 ( 6.8)</td>
<td style="text-align: left;">972 ( 4.3)</td>
<td style="text-align: left;">4799 ( 7.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1585 ( 1.9)</td>
<td style="text-align: left;">519 ( 2.3)</td>
<td style="text-align: left;">1066 ( 1.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (admission to treatment) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">1 day a week or more</td>
<td style="text-align: left;">5610 ( 6.6)</td>
<td style="text-align: left;">1922 ( 8.5)</td>
<td style="text-align: left;">3688 ( 5.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.186</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">2 to 3 days a week</td>
<td style="text-align: left;">23716 (27.9)</td>
<td style="text-align: left;">6641 ( 29.4)</td>
<td style="text-align: left;">17075 (27.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">4 to 6 days a week</td>
<td style="text-align: left;">13923 (16.4)</td>
<td style="text-align: left;">3580 ( 15.9)</td>
<td style="text-align: left;">10343 (16.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Daily</td>
<td style="text-align: left;">37200 (43.7)</td>
<td style="text-align: left;">8744 ( 38.8)</td>
<td style="text-align: left;">28456 (45.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">Less than 1 day a week</td>
<td style="text-align: left;">4178 ( 4.9)</td>
<td style="text-align: left;">1530 ( 6.8)</td>
<td style="text-align: left;">2648 ( 4.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Frequency of Substance Use (Primary Substance) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">421 ( 0.5)</td>
<td style="text-align: left;">135 ( 0.6)</td>
<td style="text-align: left;">286 ( 0.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Employed</td>
<td style="text-align: left;">41407 (48.7)</td>
<td style="text-align: left;">12657 ( 56.1)</td>
<td style="text-align: left;">28750 (46.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.309</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Inactive</td>
<td style="text-align: left;">8925 (10.5)</td>
<td style="text-align: left;">3087 ( 13.7)</td>
<td style="text-align: left;">5838 ( 9.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Looking for a job for the first time</td>
<td style="text-align: left;">193 ( 0.2)</td>
<td style="text-align: left;">35 ( 0.2)</td>
<td style="text-align: left;">158 ( 0.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">No activity</td>
<td style="text-align: left;">4501 ( 5.3)</td>
<td style="text-align: left;">967 ( 4.3)</td>
<td style="text-align: left;">3534 ( 5.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Not seeking for work</td>
<td style="text-align: left;">832 ( 1.0)</td>
<td style="text-align: left;">152 ( 0.7)</td>
<td style="text-align: left;">680 ( 1.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">Unemployed</td>
<td style="text-align: left;">29189 (34.3)</td>
<td style="text-align: left;">5653 ( 25.1)</td>
<td style="text-align: left;">23536 (37.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corrected Occupational Status (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">25037 (29.4)</td>
<td style="text-align: left;">2 ( 0.0)</td>
<td style="text-align: left;">25035 (40.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">31.192</td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">10457 (12.3)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">10457 (16.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">4661 ( 5.5)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">4660 ( 7.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">19689 (23.2)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">19688 (31.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">2554 ( 3.0)</td>
<td style="text-align: left;">4 ( 0.0)</td>
<td style="text-align: left;">2550 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">First additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">22650 (26.6)</td>
<td style="text-align: left;">22544 (100.0)</td>
<td style="text-align: left;">106 ( 0.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">10304 (12.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">10304 (16.5)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1.479</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">6264 ( 7.4)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">6264 (10.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">2419 ( 2.8)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">2419 ( 3.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">11815 (13.9)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">11815 (18.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1839 ( 2.2)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">1839 ( 2.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Second additional substance at admission (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">52407 (61.6)</td>
<td style="text-align: left;">22552 (100.0)</td>
<td style="text-align: left;">29855 (47.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">20138 (23.7)</td>
<td style="text-align: left;">4161 ( 18.5)</td>
<td style="text-align: left;">15977 (25.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.172</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">64165 (75.4)</td>
<td style="text-align: left;">18191 ( 80.7)</td>
<td style="text-align: left;">45974 (73.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Children (dichotomized) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">745 ( 0.9)</td>
<td style="text-align: left;">200 ( 0.9)</td>
<td style="text-align: left;">545 ( 0.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Illegal Settlement</td>
<td style="text-align: left;">906 ( 1.1)</td>
<td style="text-align: left;">200 ( 0.9)</td>
<td style="text-align: left;">706 ( 1.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.267</td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">2354 ( 2.8)</td>
<td style="text-align: left;">609 ( 2.7)</td>
<td style="text-align: left;">1745 ( 2.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Owner/Transferred dwellings/Pays Dividends</td>
<td style="text-align: left;">29934 (35.2)</td>
<td style="text-align: left;">9863 ( 43.7)</td>
<td style="text-align: left;">20071 (32.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Renting</td>
<td style="text-align: left;">14566 (17.1)</td>
<td style="text-align: left;">3835 ( 17.0)</td>
<td style="text-align: left;">10731 (17.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">Stays temporarily with a relative</td>
<td style="text-align: left;">32609 (38.3)</td>
<td style="text-align: left;">6829 ( 30.3)</td>
<td style="text-align: left;">25780 (41.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Housing Situation (Tenure Status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">4679 ( 5.5)</td>
<td style="text-align: left;">1216 ( 5.4)</td>
<td style="text-align: left;">3463 ( 5.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">Center</td>
<td style="text-align: left;">64341 (75.7)</td>
<td style="text-align: left;">16681 ( 74.0)</td>
<td style="text-align: left;">47660 (76.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.293</td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">North</td>
<td style="text-align: left;">12151 (14.3)</td>
<td style="text-align: left;">2243 ( 9.9)</td>
<td style="text-align: left;">9908 (15.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">South</td>
<td style="text-align: left;">8536 (10.0)</td>
<td style="text-align: left;">3625 ( 16.1)</td>
<td style="text-align: left;">4911 ( 7.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Macro Administrative Zone in Chile (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">20 ( 0.0)</td>
<td style="text-align: left;">3 ( 0.0)</td>
<td style="text-align: left;">17 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">71599 (84.2)</td>
<td style="text-align: left;">19133 ( 84.8)</td>
<td style="text-align: left;">52466 (84.0)</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.024</td>
</tr>
<tr class="even">
<td style="text-align: left;">Violent Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">13449 (15.8)</td>
<td style="text-align: left;">3419 ( 15.2)</td>
<td style="text-align: left;">10030 (16.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">70732 (83.2)</td>
<td style="text-align: left;">19975 ( 88.6)</td>
<td style="text-align: left;">50757 (81.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.207</td>
</tr>
<tr class="even">
<td style="text-align: left;">Acquisitive Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">14316 (16.8)</td>
<td style="text-align: left;">2577 ( 11.4)</td>
<td style="text-align: left;">11739 (18.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">70997 (83.5)</td>
<td style="text-align: left;">19635 ( 87.1)</td>
<td style="text-align: left;">51362 (82.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.136</td>
</tr>
<tr class="even">
<td style="text-align: left;">Substance-Related Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">14051 (16.5)</td>
<td style="text-align: left;">2917 ( 12.9)</td>
<td style="text-align: left;">11134 (17.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">71305 (83.8)</td>
<td style="text-align: left;">19325 ( 85.7)</td>
<td style="text-align: left;">51980 (83.2)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other Criminal Offenses (Pre-Treatment) (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">13743 (16.2)</td>
<td style="text-align: left;">3227 ( 14.3)</td>
<td style="text-align: left;">10516 (16.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without psychiatric comorbidity</td>
<td style="text-align: left;">32337 (38.0)</td>
<td style="text-align: left;">10022 ( 44.4)</td>
<td style="text-align: left;">22315 (35.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.184</td>
</tr>
<tr class="even">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">16099 (18.9)</td>
<td style="text-align: left;">3575 ( 15.9)</td>
<td style="text-align: left;">12524 (20.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychiatric Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">With psychiatric comorbidity</td>
<td style="text-align: left;">36612 (43.0)</td>
<td style="text-align: left;">8955 ( 39.7)</td>
<td style="text-align: left;">27657 (44.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Drug dependence</td>
<td style="text-align: left;">61836 (72.7)</td>
<td style="text-align: left;">13974 ( 62.0)</td>
<td style="text-align: left;">47862 (76.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.321</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">Hazardous consumption</td>
<td style="text-align: left;">23211 (27.3)</td>
<td style="text-align: left;">8577 ( 38.0)</td>
<td style="text-align: left;">14634 (23.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">SUD Severity (Dependence status) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Socioeconomic Classification (%)</td>
<td style="text-align: left;">Mixta</td>
<td style="text-align: left;">8205 ( 9.6)</td>
<td style="text-align: left;">2850 ( 12.6)</td>
<td style="text-align: left;">5355 ( 8.6)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.272</td>
</tr>
<tr class="even">
<td style="text-align: left;">Socioeconomic Classification (%)</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">7148 ( 8.4)</td>
<td style="text-align: left;">2977 ( 13.2)</td>
<td style="text-align: left;">4171 ( 6.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Socioeconomic Classification (%)</td>
<td style="text-align: left;">Urbana</td>
<td style="text-align: left;">69693 (81.9)</td>
<td style="text-align: left;">16724 ( 74.2)</td>
<td style="text-align: left;">52969 (84.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Socioeconomic Classification (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">2 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Percentage of people in poverty (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.11 [0.07, 0.16]</td>
<td style="text-align: left;">0.11 [0.07, 0.15]</td>
<td style="text-align: left;">0.12 [0.08, 0.17]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.104</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">46623 (54.8)</td>
<td style="text-align: left;">15574 ( 69.1)</td>
<td style="text-align: left;">31049 (49.7)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.505</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">3162 ( 3.7)</td>
<td style="text-align: left;">957 ( 4.2)</td>
<td style="text-align: left;">2205 ( 3.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">3864 ( 4.5)</td>
<td style="text-align: left;">1321 ( 5.9)</td>
<td style="text-align: left;">2543 ( 4.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">22991 (27.0)</td>
<td style="text-align: left;">3083 ( 13.7)</td>
<td style="text-align: left;">19908 (31.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">1987 ( 2.3)</td>
<td style="text-align: left;">563 ( 2.5)</td>
<td style="text-align: left;">1424 ( 2.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary Substance (initial diagnosis) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">6421 ( 7.5)</td>
<td style="text-align: left;">1054 ( 4.7)</td>
<td style="text-align: left;">5367 ( 8.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Corrected birth year (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1980.00 [1971.00, 1987.00]</td>
<td style="text-align: left;">1974.00 [1964.00, 1983.00]</td>
<td style="text-align: left;">1982.00 [1974.00, 1988.00]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.630</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Alone</td>
<td style="text-align: left;">8026 ( 9.4)</td>
<td style="text-align: left;">2765 ( 12.3)</td>
<td style="text-align: left;">5261 ( 8.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.342</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Family of origin</td>
<td style="text-align: left;">35576 (41.8)</td>
<td style="text-align: left;">6866 ( 30.4)</td>
<td style="text-align: left;">28710 (45.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">Others</td>
<td style="text-align: left;">7291 ( 8.6)</td>
<td style="text-align: left;">1802 ( 8.0)</td>
<td style="text-align: left;">5489 ( 8.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">With couple/children</td>
<td style="text-align: left;">34154 (40.2)</td>
<td style="text-align: left;">11118 ( 49.3)</td>
<td style="text-align: left;">23036 (36.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cohabitation status (Recoded) (f) (%)</td>
<td style="text-align: left;">[Missing]</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">1 ( 0.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Without physical comorbidity</td>
<td style="text-align: left;">33609 (39.5)</td>
<td style="text-align: left;">8363 ( 37.1)</td>
<td style="text-align: left;">25246 (40.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.084</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">Diagnosis unknown (under study)</td>
<td style="text-align: left;">45892 (54.0)</td>
<td style="text-align: left;">12457 ( 55.2)</td>
<td style="text-align: left;">33435 (53.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Physical Comorbidity (ICD-10) (%)</td>
<td style="text-align: left;">One or more</td>
<td style="text-align: left;">5547 ( 6.5)</td>
<td style="text-align: left;">1732 ( 7.7)</td>
<td style="text-align: left;">3815 ( 6.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Time to offense from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2.74 [1.13, 5.18]</td>
<td style="text-align: left;">2.82 [1.28, 4.66]</td>
<td style="text-align: left;">2.69 [1.08, 5.41]</td>
<td style="text-align: left;">0.005</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.098</td>
</tr>
<tr class="even">
<td style="text-align: left;">Time to dropout from admission (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">4.32 [2.01, 6.71]</td>
<td style="text-align: left;">3.53 [1.77, 5.43]</td>
<td style="text-align: left;">4.68 [2.12, 7.28]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.369</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at censorship (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">39.16 [32.35, 48.10]</td>
<td style="text-align: left;">45.80 [36.48, 55.07]</td>
<td style="text-align: left;">37.65 [31.50, 45.48]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.630</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at completing tr. (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">38.37 [31.54, 47.17]</td>
<td style="text-align: left;">44.95 [35.72, 54.16]</td>
<td style="text-align: left;">36.90 [30.69, 44.43]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.642</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age at offending (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">37.74 [30.43, 47.08]</td>
<td style="text-align: left;">45.06 [35.36, 54.69]</td>
<td style="text-align: left;">35.92 [29.43, 44.01]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.687</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age at death (median [IQR])</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">39.16 [32.34, 48.09]</td>
<td style="text-align: left;">45.80 [36.48, 55.06]</td>
<td style="text-align: left;">37.65 [31.49, 45.48]</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;">nonnorm</td>
<td style="text-align: left;">0.630</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">84867 (99.8)</td>
<td style="text-align: left;">22452 ( 99.6)</td>
<td style="text-align: left;">62415 (99.9)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Death from admission (%)</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">181 ( 0.2)</td>
<td style="text-align: left;">100 ( 0.4)</td>
<td style="text-align: left;">81 ( 0.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">no offense after admission</td>
<td style="text-align: left;">57323 (67.4)</td>
<td style="text-align: left;">17907 ( 79.4)</td>
<td style="text-align: left;">39416 (63.1)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.367</td>
</tr>
<tr class="even">
<td style="text-align: left;">Committing an offense after admission (binary) (%)</td>
<td style="text-align: left;">offender after adm</td>
<td style="text-align: left;">27725 (32.6)</td>
<td style="text-align: left;">4645 ( 20.6)</td>
<td style="text-align: left;">23080 (36.9)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(size=10, format="html",caption= "Summary descriptives, by Baseline Treatment Status") %&gt;%     kableExtra::kable_classic()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<p>We show the distribution of dates</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of admission to baseline treatment"</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_ing_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_ing_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_ing_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of discharge of baseline treatment"</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of commission of offense after admission"</span>,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_egres_num_1), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_egres_num_1), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of death after admission"</span>,</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(date_death), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(date_death), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(date_death), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))),</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(<span class="at">cat=</span><span class="st">"Date of birth (corrected)"</span>,</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>        Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">min =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(<span class="fu">unclass</span>(fech_nac_rec), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">p025=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">025</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">p25=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">25</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">p50=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">p75=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">75</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">p975=</span><span class="fu">as.Date</span>(<span class="fu">quantile</span>(<span class="fu">unclass</span>(fech_nac_rec), .<span class="dv">975</span>, <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>),</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(<span class="fu">unclass</span>(fech_nac_rec), <span class="at">na.rm=</span>T), <span class="at">origin =</span> <span class="st">"1970-01-01"</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format=</span><span class="st">"html"</span>,<span class="at">caption=</span> <span class="st">"Summary of Dates (after correcting dates)"</span>) <span class="sc">%&gt;%</span> <span class="co">#,col.names=c("Variables","Residential", "Ambulatory", "p-value")) %&gt;% </span></span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>,<span class="st">"condensed"</span>),<span class="at">font_size=</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-size: 12px; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">Summary of Dates (after correcting dates)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> cat </th>
   <th style="text-align:left;"> min </th>
   <th style="text-align:left;"> p025 </th>
   <th style="text-align:left;"> p25 </th>
   <th style="text-align:left;"> p50 </th>
   <th style="text-align:left;"> p75 </th>
   <th style="text-align:left;"> p975 </th>
   <th style="text-align:left;"> max </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Date of admission to baseline treatment </td>
   <td style="text-align:left;"> 2007-04-18 </td>
   <td style="text-align:left;"> 2009-10-20 </td>
   <td style="text-align:left;"> 2012-11-05 </td>
   <td style="text-align:left;"> 2015-03-26 </td>
   <td style="text-align:left;"> 2017-06-06 </td>
   <td style="text-align:left;"> 2019-07-11 </td>
   <td style="text-align:left;"> 2019-10-30 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of discharge of baseline treatment </td>
   <td style="text-align:left;"> 2008-12-19 </td>
   <td style="text-align:left;"> 2010-05-31 </td>
   <td style="text-align:left;"> 2013-06-01 </td>
   <td style="text-align:left;"> 2015-11-02 </td>
   <td style="text-align:left;"> 2018-01-11 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of commission of offense after admission </td>
   <td style="text-align:left;"> 2008-12-19 </td>
   <td style="text-align:left;"> 2010-05-31 </td>
   <td style="text-align:left;"> 2013-06-01 </td>
   <td style="text-align:left;"> 2015-11-02 </td>
   <td style="text-align:left;"> 2018-01-11 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
   <td style="text-align:left;"> 2019-11-13 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of death after admission </td>
   <td style="text-align:left;"> 2016-08-01 </td>
   <td style="text-align:left;"> 2016-10-23 </td>
   <td style="text-align:left;"> 2017-07-11 </td>
   <td style="text-align:left;"> 2018-05-04 </td>
   <td style="text-align:left;"> 2019-02-01 </td>
   <td style="text-align:left;"> 2019-09-30 </td>
   <td style="text-align:left;"> 2019-11-02 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Date of birth (corrected) </td>
   <td style="text-align:left;"> 1929-03-20 </td>
   <td style="text-align:left;"> 1954-08-14 </td>
   <td style="text-align:left;"> 1971-10-09 </td>
   <td style="text-align:left;"> 1980-09-14 </td>
   <td style="text-align:left;"> 1987-07-09 </td>
   <td style="text-align:left;"> 1996-07-05 </td>
   <td style="text-align:left;"> 2004-11-20 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><br></p>
</section>
</section>
<section id="glca" class="level1">
<h1>GLCA</h1>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://agscl.github.io/IVE/</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(glca)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>mydata_preds1<span class="ot">&lt;-</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sus_principal_mod,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>      otras_sus1_mod,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>      otras_sus2_mod,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>      otras_sus3_mod) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>mydata_preds2 <span class="ot">&lt;-</span> mydata_preds1<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>), <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="fu">is.na</span>(.)<span class="sc">~</span> <span class="st">"none"</span>, T<span class="sc">~</span> .)))</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">group_by</span>(mydata_preds2,sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">%&gt;%</span>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc=</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">round</span>(n<span class="sc">/</span><span class="fu">sum</span>(n),<span class="dv">2</span>))) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Combinations of substances"</span>, <span class="at">col.names=</span> <span class="fu">c</span>(<span class="st">"Primary substance"</span>, <span class="st">"Other substances (1)"</span>, <span class="st">"Other substances (2)"</span>,<span class="st">"n"</span>, <span class="st">"%"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 86 rows and 4 columns, 3 group variables remaining (sus_principal_mod, otras_sus1_mod, otras_sus2_mod)</p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Combinations of substances</caption>
<colgroup>
<col style="width: 28%">
<col style="width: 28%">
<col style="width: 28%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Primary substance</th>
<th style="text-align: left;">Other substances (1)</th>
<th style="text-align: left;">Other substances (2)</th>
<th style="text-align: right;">n</th>
<th style="text-align: left;">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">14219</td>
<td style="text-align: left;">17%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">6184</td>
<td style="text-align: left;">7%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">5218</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">4828</td>
<td style="text-align: left;">6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">4609</td>
<td style="text-align: left;">5%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">4520</td>
<td style="text-align: left;">5%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">3750</td>
<td style="text-align: left;">4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">3405</td>
<td style="text-align: left;">4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">2706</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2686</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">2340</td>
<td style="text-align: left;">3%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">1931</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">1878</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1876</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">1840</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">1726</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">1636</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">1609</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">1318</td>
<td style="text-align: left;">2%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">1273</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">1184</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">1125</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">974</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">868</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">707</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">609</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">607</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">596</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">572</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">512</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">484</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">483</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">450</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">446</td>
<td style="text-align: left;">1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">411</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">327</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">315</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">309</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">305</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">290</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">286</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">270</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">259</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">254</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">234</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">179</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">165</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">159</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">158</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">149</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">138</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">136</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">128</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">110</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">99</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">98</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">87</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">87</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">87</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">74</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">64</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">59</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">49</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Alcohol</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: right;">15</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: left;">Cocaine hydrochloride</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marijuana</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">Cocaine paste</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: left;">none</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">0%</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mydata_preds3 <span class="ot">&lt;-</span> mydata_preds2<span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>), <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(.))<span class="sc">+</span><span class="dv">1</span>))<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"sus_principal_mod"</span>, <span class="st">"otras_sus1_mod"</span>, <span class="st">"otras_sus2_mod"</span>, <span class="st">"otras_sus3_mod"</span>), <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(.<span class="sc">==</span><span class="st">"none"</span><span class="sc">~</span> <span class="dv">1</span>, T<span class="sc">~</span> .)))<span class="sc">%&gt;%</span>   </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>first_five<span class="ot">&lt;-</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">group_by</span>(mydata_preds2,sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">%&gt;%</span>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">0</span>, <span class="sc">!</span><span class="st">"none"</span><span class="sc">==</span>otras_sus1_mod) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(n))<span class="sc">/</span><span class="fu">nrow</span>(mydata_preds2) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>count: now 86 rows and 4 columns, 3 group variables remaining (sus_principal_mod, otras_sus1_mod, otras_sus2_mod)</p>
</div>
<div class="message">
<p>slice: removed 75 rows (94%), 5 rows remaining</p>
</div>
<div class="message">
<p>summarise: now one row and one column, ungrouped</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"The first four (there is one that is exchangeable) make the "</span>, </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">as.character</span>(scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">unlist</span>(first_five))),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">" of the sample"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The first four (there is one that is exchangeable) make the 29% of the sample"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"glca format"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We excluded otras_sus3_mod because it had only one value</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>f_preds2<span class="ot">&lt;-</span> <span class="fu">item</span>(sus_principal_mod, otras_sus1_mod, otras_sus2_mod) <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># f &lt;- cbind(sus_principal_mod, otras_sus1_mod, otras_sus2_mod, otras_sus3_mod)~1</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># gss.lc2 &lt;- poLCA(f,mydata_preds3,nclass=2)</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># lca203 &lt;- glca(f_preds2, data = mydata_preds3, nclass = 3, seed = seed, verbose = FALSE, n.init = 5e1, decreasing=T, maxiter = 1e4,testiter = 500)</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>seed<span class="ot">&lt;-</span><span class="dv">2125</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>old <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-01 15:02:14 -04"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>lca202 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">2</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#43 minutes each more or less</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>lca203 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">3</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>lca204 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">4</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>lca205 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">5</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>lca206 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">6</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>lca207 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">7</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>lca208 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">8</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>lca209 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">9</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>lca210 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">10</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>lca211 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">11</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>lca212 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">12</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>lca213 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">13</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>lca214 <span class="ot">&lt;-</span> <span class="fu">glca</span>(f_preds2, <span class="at">data =</span> mydata_preds3, <span class="at">nclass =</span> <span class="dv">14</span>, <span class="at">seed =</span> seed, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">n.init =</span> <span class="fl">5e1</span>, <span class="at">decreasing=</span>T, <span class="at">maxiter =</span> <span class="fl">1e4</span>,<span class="at">testiter =</span> <span class="dv">500</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>gof2<span class="ot">&lt;-</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gofglca</span>(lca202, lca203, lca204, lca205, lca206, lca207, lca208, lca209, lca210, lca211, lca212, lca213, lca214, <span class="at">test =</span> <span class="st">"chisq"</span>)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>new_med<span class="ot">&lt;-</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"The model took "</span>,<span class="fu">round</span>(new_med<span class="sc">-</span>old,<span class="dv">2</span>),<span class="st">" until every LCA was computed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The model took 2.02 until every LCA was computed"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(new_med)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-08-01 17:03:10 -04"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://agscl.github.io/IVE/</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sabic<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">14</span>)){</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  sabic<span class="ot">&lt;-</span><span class="fu">c</span>(sabic,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"lca2"</span>,<span class="fu">sprintf</span>(<span class="st">"%02.f"</span>, i)))<span class="sc">$</span>gof<span class="sc">$</span>loglik)<span class="sc">+</span> <span class="fu">get</span>(<span class="fu">paste0</span>(<span class="st">"lca2"</span>,<span class="fu">sprintf</span>(<span class="st">"%02.f"</span>, i)))<span class="sc">$</span>gof<span class="sc">$</span>df <span class="sc">*</span><span class="fu">log</span>(  (<span class="fu">nrow</span>(mydata_preds3) <span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">24</span>    )</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>manualcolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'indianred1'</span>, <span class="st">'cornflowerblue'</span>, <span class="st">'gray50'</span>, <span class="st">'darkolivegreen4'</span>, <span class="st">'slateblue2'</span>, </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'firebrick4'</span>, <span class="st">'goldenrod4'</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>levels4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"logLik"</span>, <span class="st">"AIC"</span>, <span class="st">"CAIC"</span>, <span class="st">"BIC"</span>, <span class="st">"entropy"</span>, <span class="st">"Res.Df"</span>, <span class="st">"Gsq"</span>, <span class="st">"SABIC"</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>labels4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Log-Likelihood'</span>, <span class="st">'Akaike Information</span><span class="sc">\n</span><span class="st">Criteria(AIC)'</span>,<span class="st">'Corrected AIC'</span>,<span class="st">'Bayesian Information</span><span class="sc">\n</span><span class="st">Criteria (BIC)'</span>, <span class="st">'Entropy'</span>, <span class="st">'Residual degrees of freedom'</span>, <span class="st">'Deviance'</span>, <span class="st">"SABIC"</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>fig_lca_fit1<span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(<span class="at">rn=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>,gof2<span class="sc">$</span>gtable,<span class="at">SABIC=</span>sabic) <span class="sc">%&gt;%</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, as.numeric) <span class="sc">%&gt;%</span>  <span class="co"># convert character columns to numeric</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>rn,<span class="at">names_to =</span> <span class="st">"indices"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>, <span class="at">values_drop_na =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">factor</span>(indices, <span class="at">levels =</span> levels4, <span class="at">labels =</span> labels4)) <span class="sc">%&gt;%</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"(AIC|BIC)"</span>,indices, <span class="at">ignore.case=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ModelIndex=</span> <span class="fu">factor</span>(rn, <span class="at">levels=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ModelIndex, <span class="at">y =</span> value, <span class="at">group =</span> indices, <span class="at">color =</span> indices, <span class="at">linetype =</span> indices)) <span class="sc">+</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> manualcolors) <span class="sc">+</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_linetype_manual(values = c("solid", "dashed", "dotted")) +</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of classes"</span>, <span class="at">y=</span><span class="st">"Value"</span>, <span class="at">color=</span><span class="st">"Measure"</span>, <span class="at">linetype=</span><span class="st">"Measure"</span>)<span class="sc">+</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(.~indices, scales = "free_y", nrow = 4, ncol = 1) +</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: Using <code>size</code> aesthetic for lines was deprecated in ggplot2 3.4.0. i Please use <code>linewidth</code> instead.</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fig_lca_fit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="proposal_grant_23_24_files/figure-html/glca2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It does not seem viable a latent class analysis given the relative fit and the amount of different classes.</p>
<p><br></p>
</section>
<section id="mca" class="level1">
<h1>MCA</h1>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/factoextra/factoextra.pdf</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># http://www.sthda.com/english/wiki/factoextra-r-package-easy-multivariate-data-analyses-and-elegant-visualization</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"FactoMineR"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"factoextra"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>res.mca <span class="ot">&lt;-</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">MCA</span>(mydata_preds2[,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(mydata_preds2)<span class="sc">-</span><span class="dv">1</span>)], </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncp =</span> <span class="dv">5</span>, <span class="co">#number of dimensions kept in the results default=5</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">graph =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(res.mca, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>cats <span class="ot">=</span> <span class="fu">apply</span>(mydata_preds2[,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(mydata_preds2)<span class="sc">-</span><span class="dv">1</span>)], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(x)))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>mca1_vars_df <span class="ot">=</span> <span class="fu">data.frame</span>(res.mca<span class="sc">$</span>var<span class="sc">$</span>coord, <span class="at">Variable =</span> <span class="fu">rep</span>(<span class="fu">names</span>(cats), </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    cats))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>mca1_obs_df <span class="ot">=</span> <span class="fu">data.frame</span>(res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of variable categories</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mca1_vars_df, <span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>, <span class="at">label =</span> <span class="fu">rownames</span>(mca1_vars_df))) <span class="sc">+</span> </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Variable)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"MCA plot of variables using R package FactoMineR"</span>)<span class="sc">+</span> <span class="fu">geom_density2d</span>(<span class="at">colour =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="alert alert-warning">
<p>Warning: The following aesthetics were dropped during statistical transformation: label i This can happen when ggplot fails to infer the correct grouping structure in the data. i Did you forget to specify a <code>group</code> aesthetic or to convert a numerical variable into a factor?</p>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Another analysis of heterogeneity</p>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(homals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Loading required package: homals</p>
</div>
<div class="alert alert-warning">
<p>Warning: package ‘homals’ was built under R version 4.1.3</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mca5 <span class="ot">=</span> <span class="fu">homals</span>(mydata_preds2[,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(mydata_preds2)<span class="sc">-</span><span class="dv">1</span>)], <span class="at">ndim =</span> <span class="dv">5</span>, <span class="at">level =</span> <span class="st">"nominal"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>mca5<span class="sc">$</span>eigenvalues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.10197978 0.08437954 0.06844427 0.06778700 0.06421689</code></pre>
</div>
</div>
</div>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># homogeneity analysis, aka a multiple correspondence analysis, but with many additional options.</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame for ggplot</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>D1 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">1</span>]))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>D2 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">2</span>]))</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>mca5_vars_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">D1 =</span> D1, <span class="at">D2 =</span> D2, <span class="at">Variable =</span> <span class="fu">rep</span>(<span class="fu">names</span>(cats), </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    cats))</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mca5_vars_df)<span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">rownames</span>(mca5_vars_df),<span class="st">"sus_principal_mod"</span>,<span class="st">"s_pr"</span>),<span class="st">"otras_sus"</span>,<span class="st">"otr_"</span>),<span class="st">"_mod"</span>,<span class="st">""</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>D3 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">3</span>]))</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>D4 <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) x[, <span class="dv">4</span>]))</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>mca5_vars_df2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">D3 =</span> D3, <span class="at">D4 =</span> D4, <span class="at">Variable =</span> <span class="fu">rep</span>(<span class="fu">names</span>(cats), </span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    cats))</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>ct<span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">sapply</span>(mca5<span class="sc">$</span>catscores, <span class="cf">function</span>(x) <span class="fu">rownames</span>(x)))</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mca5_vars_df2)<span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">str_replace</span>(<span class="fu">rownames</span>(mca5_vars_df2),<span class="st">"sus_principal_mod"</span>,<span class="st">"s_pr"</span>),<span class="st">"otras_sus"</span>,<span class="st">"otr_"</span>),<span class="st">"_mod"</span>,<span class="st">""</span>)</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mca5_vars_df, <span class="fu">aes</span>(<span class="at">x =</span> D1, <span class="at">y =</span> D2, <span class="at">label =</span> <span class="fu">rownames</span>(mca5_vars_df))) <span class="sc">+</span> </span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Variable)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"MCA plot of variables using R package homals"</span>)<span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-251-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Homals Dimensiones 1 y 2</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div class="controlly">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA plot of variable categories</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mca5_vars_df2, <span class="fu">aes</span>(<span class="at">x =</span> D3, <span class="at">y =</span> D4, <span class="at">label =</span> <span class="fu">rownames</span>(mca5_vars_df2))) <span class="sc">+</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"gray70"</span>) <span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Variable)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"MCA plot of variables using R package homals"</span>)<span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="proposal_grant_23_24_files/figure-html/mca-252-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Homals Dimensiones 3 y 4</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="imputation-and-export" class="level1">
<h1>Imputation and export</h1>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(missRanger)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24_miss <span class="ot">&lt;-</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24 <span class="co">#%&gt;% </span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"no_mostrar"</span>)){</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(hash_key, edad_al_ing_1) <span class="sc">%&gt;%</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>     missRanger<span class="sc">::</span><span class="fu">missRanger</span>(</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> .  <span class="sc">-</span>offender_d <span class="sc">-</span> age_tr_comp_imp <span class="sc">~</span> . <span class="sc">-</span> hash_key <span class="sc">-</span>offender_d <span class="sc">-</span> age_tr_comp_imp,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">num.trees =</span> <span class="dv">200</span>, </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">pmm.k =</span> <span class="dv">3</span>,                </span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">returnOOB=</span>T,</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">maxiter=</span> <span class="dv">50</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="dv">2</span>, </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">seed =</span> <span class="dv">2125</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#should drop:</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># event_offense age_dropout_imp event_comp age_at_censor_date time_to_off_from_adm time_to_drop_from_adm edad_comision_imp fec_comision_simple_2 relacion_vifsaf_2</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  values_pris<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0013</span>, <span class="fl">0.0053</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0158</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">0.0000</span>, <span class="fl">6e-04</span>, <span class="fl">0.0024</span>, <span class="fl">0.0024</span>, <span class="fl">5e-04</span>, <span class="fl">0.0285</span>)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"Mdn= "</span>,<span class="fu">median</span>(values_pris),<span class="st">" Q1= "</span>,<span class="fu">quantile</span>(values_pris,.<span class="dv">25</span>),<span class="st">", Q3= "</span>, <span class="fu">quantile</span>(values_pris, .<span class="dv">75</span>))</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="export" class="level1">
<h1>Export</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-01-01 we had a problem with edad_al_ing_fmt. This variable predict better (it had lower amount of missing data and was in wide format)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">#cont_vars_desc[1]&lt;-ifelse(cont_vars_desc[1]=="edad_al_ing_fmt","edad_al_ing_1",cont_vars_desc[1])</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24 <span class="sc">%&gt;%</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(hash_key, fech_ing_num_1)  <span class="sc">%&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"an_grant_23_24.dta"</span>))</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPUTATION</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co">#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>Base_fiscalia_v15c_grant_23_24_miss <span class="sc">%&gt;%</span> </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(hash_key, fech_ing_num_1)  <span class="sc">%&gt;%</span> </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">"an_grant_23_24_miss.dta"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="survival-mediation" class="level1">
<h1>Survival Mediation</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Our simulation-based approach to the estimation of mediation effects enables users to deal with missing data via standard multiple imputation procedures in a straightforward fashion. The mediation package includes a pair of utility functions – mediations and amelidiate– to facilitate such analysis. First, users simulate multiple data sets using their preferredimputation software. Next, run mediate on each data set by simply passing the data setsthrough mediations. Next, pass the output of mediations to the amelidiate function, which combines the components of the output from mediations into a format that can be analyzed with the standard summary and plot commands.5 Alternatively, users can manually run mediate on their imputed data sets and simply stack the vectors of quantities they are interested in, and use basic functions like quantile to calculate confidence intervals.</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co">#, sims = 100        Simulations: 100</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"MatchIt"</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>variables_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">"edad_ini_cons"</span>, <span class="st">"escolaridad_rec"</span>, <span class="st">"condicion_ocupacional_corr"</span>, <span class="st">"num_hijos_mod_joel_bin"</span>, <span class="st">"tenencia_de_la_vivienda_mod"</span>, <span class="st">"macrozona"</span>, <span class="st">"n_off_vio"</span>, <span class="st">"n_off_acq"</span>, <span class="st">"n_off_sud"</span>, <span class="st">"n_off_oth"</span>, <span class="st">"dg_cie_10_rec"</span>, <span class="st">"dg_trs_cons_sus_or"</span>, <span class="st">"clas_r"</span>, <span class="st">"porc_pobr"</span>, <span class="st">"sus_ini_mod_mvv"</span>, <span class="st">"ano_nac_corr"</span>, <span class="st">"con_quien_vive_joel"</span>, <span class="st">"fis_comorbidity_icd_10"</span>, <span class="st">"n_off_vict"</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co">#get a matched cohort of people by polysubstance use</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>m.out3 <span class="ot">&lt;-</span> <span class="fu">matchit</span>(policonsumo <span class="sc">~</span> <span class="fu">rcs</span>(edad_al_ing_1, <span class="dv">4</span>) <span class="sc">+</span> sex <span class="sc">+</span> edad_ini_cons <span class="sc">+</span> escolaridad_rec <span class="sc">+</span> condicion_ocupacional_corr <span class="sc">+</span> num_hijos_mod_joel_bin <span class="sc">+</span> tenencia_de_la_vivienda_mod <span class="sc">+</span> macrozona <span class="sc">+</span> n_off_vio <span class="sc">+</span> n_off_acq <span class="sc">+</span> n_off_sud <span class="sc">+</span> n_off_oth <span class="sc">+</span> dg_cie_10_rec <span class="sc">+</span> dg_trs_cons_sus_or <span class="sc">+</span> clas_r <span class="sc">+</span> porc_pobr <span class="sc">+</span> sus_ini_mod_mvv <span class="sc">+</span> ano_nac_corr <span class="sc">+</span> con_quien_vive_joel <span class="sc">+</span> fis_comorbidity_icd_10<span class="sc">+</span> n_off_vict, </span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Base_fiscalia_v15c_grant_23_24[<span class="fu">complete.cases</span>(Base_fiscalia_v15c_grant_23_24[,..variables_vector]),], </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"nearest"</span>, </span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">discard =</span> <span class="st">"both"</span>,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">caliper =</span> .<span class="dv">05</span>, </span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">standardize =</span> T)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>cobalt<span class="sc">::</span><span class="fu">bal.tab</span>(m.out3, <span class="at">un =</span> <span class="cn">TRUE</span>, <span class="at">m.threshold =</span> .<span class="dv">1</span>, </span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">v.threshold =</span> <span class="dv">2</span>))</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("MatchThem")</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="co"># require(MatchThem)</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a><span class="co"># imputed.datasets &lt;- mice::mice(dplyr::select(Base_fiscalia_v15c_grant_23_24,c(variables_vector,"edad_al_ing_1","policonsumo","time_to_off_from_adm","time_to_drop_from_adm","event_death","event_comp","event_offense")), m = 5)</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a><span class="co"># #Currently, "within" (performing matching within each dataset) and "across" (estimating propensity scores within each dataset, averaging them across datasets, and performing matching using the averaged propensity scores in each dataset) approaches are available. The default is "within", which has been shown to have superior performance in most cases</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   #Matching the multiply imputed datasets</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a><span class="co"># matched.datasets &lt;- matchthem(policonsumo ~  sex + edad_ini_cons + escolaridad_rec + condicion_ocupacional_corr + num_hijos_mod_joel_bin + tenencia_de_la_vivienda_mod + macrozona + n_off_vio + n_off_acq + n_off_sud + n_off_oth + dg_cie_10_rec + dg_trs_cons_sus_or + clas_r + porc_pobr + sus_ini_mod_mvv + ano_nac_corr + con_quien_vive_joel + fis_comorbidity_icd_10+ n_off_vict, </span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a><span class="co"># imputed.datasets, approach = 'within', method = 'nearest')</span></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Matching Observations  | dataset: #1Error: Missing values are not allowed in the covariates.</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>                                                     </span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>mod.y <span class="ot">&lt;-</span> <span class="fu">survreg</span>(<span class="fu">Surv</span>(time_to_off_from_adm, event_offense) <span class="sc">~</span> event_comp <span class="sc">+</span> policonsumo, <span class="at">data =</span> <span class="fu">match.data</span>(m.out3))</span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>mod.m <span class="ot">&lt;-</span> <span class="fu">glm</span>(event_comp <span class="sc">~</span> policonsumo, <span class="at">data =</span> <span class="fu">match.data</span>(m.out3), <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a>med.m <span class="ot">&lt;-</span> mediation<span class="sc">::</span><span class="fu">mediate</span>(mod.m, mod.y, <span class="at">treat =</span> <span class="st">"policonsumo"</span>, <span class="at">mediator =</span> <span class="st">"event_comp"</span>,<span class="at">robust =</span> <span class="cn">TRUE</span>, <span class="at">sims =</span> <span class="dv">100</span> )<span class="co">#cluster="" no funciona</span></span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(med.m)</span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a>sensitivityAnalysis <span class="ot">&lt;-</span> mediation<span class="sc">::</span><span class="fu">medsens</span>(med.m)</span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a><span class="co">#Error in mediation::medsens(med.m) :    mediate object fitted with non-supported model combinations</span></span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true" tabindex="-1"></a><span class="co">#3.2. Moderated mediation</span></span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a><span class="co">#passing the object from mediate to the medsens function</span></span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a><span class="co">#If there exist unobserved pre-treatment confounders which affect both the mediator and the outcome, we expect that the sequential ignorability assumption is violated and ρ is no longer zero.</span></span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a><span class="co">#sens.out &lt;- medsens(med.out, rho.by = 0.1, effect.type = "indirect", sims = 100)</span></span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a><span class="co">#where rho.by = 0.1 specifies that ρ will vary from −0.9 to 0.9 by 0.1 increments, andeffect.type = "indirect" means that sensitivity analysis is conducted for the ACME. Alternatively, specifying effect.type = "direct" performs sensitivity analysis for the ADE and "both" returns sensitivity analysis for the ACME and ADE.</span></span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a><span class="co">#:_#:#:#:#:#:#:</span></span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a><span class="co">#Single experiment design</span></span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a><span class="co">#First, the researchers can continue to make the sequential ignorability assumption and nonparametrically estimate the ACME. This approach works only when the mediator variable is discrete.</span></span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true" tabindex="-1"></a><span class="co">#:_#:#:#:#:#:#:</span></span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Under the parallel design, the ACME is not point identified without an additional assumption</span></span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true" tabindex="-1"></a><span class="co">#The mediation package offers two options via the mediate.pd function.</span></span>
<span id="cb71-64"><a href="#cb71-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-65"><a href="#cb71-65" aria-hidden="true" tabindex="-1"></a><span class="co">#Parallel encouragement design</span></span>
<span id="cb71-66"><a href="#cb71-66" aria-hidden="true" tabindex="-1"></a><span class="co">#In many situations, perfect manipulation of the mediating variable may be difficult. In the parallel encouragement design, subjects are split into two separate experiments</span></span>
<span id="cb71-67"><a href="#cb71-67" aria-hidden="true" tabindex="-1"></a><span class="co">#[CREO QUE ESTE ES EL MAS CORRECTO]</span></span>
<span id="cb71-68"><a href="#cb71-68" aria-hidden="true" tabindex="-1"></a><span class="co">#  subjects are randomly assigned to the treatment and control conditions and then, within each condition, a subset of subjects are randomly encouraged to have a high or low value of the mediator. Both the mediator and outcome variable are then measured</span></span>
<span id="cb71-69"><a href="#cb71-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-70"><a href="#cb71-70" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-71"><a href="#cb71-71" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-72"><a href="#cb71-72" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(mets)</span>
<span id="cb71-73"><a href="#cb71-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-74"><a href="#cb71-74" aria-hidden="true" tabindex="-1"></a><span class="co">#Thomas H. Scheike and Klaus K. Holst and Jacob B. Hjelmborg (2013). Estimating heritability for cause specific mortality based on twin studies. Lifetime Data Analysis. http://dx.doi.org/10.1007/s10985-013-9244-x</span></span>
<span id="cb71-75"><a href="#cb71-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-76"><a href="#cb71-76" aria-hidden="true" tabindex="-1"></a><span class="co">#Klaus K. Holst and Thomas H. Scheike Jacob B. Hjelmborg (2015). The Liability Threshold Model for Censored Twin Data. Computational Statistics and Data Analysis. http://dx.doi.org/10.1016/j.csda.2015.01.014</span></span>
<span id="cb71-77"><a href="#cb71-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-78"><a href="#cb71-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-79"><a href="#cb71-79" aria-hidden="true" tabindex="-1"></a><span class="co"># comp_cases_Base_fiscalia_v15c_grant_23_24&lt;-</span></span>
<span id="cb71-80"><a href="#cb71-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Base_fiscalia_v15c_grant_23_24[complete.cases(Base_fiscalia_v15c_grant_23_24[,..variables_vector]),] %&gt;% dplyr::mutate(policonsumo=factor(policonsumo), event_comp=factor(event_comp))</span></span>
<span id="cb71-81"><a href="#cb71-81" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb71-82"><a href="#cb71-82" aria-hidden="true" tabindex="-1"></a><span class="co"># weightmodel &lt;- fit &lt;- glm(event_comp ~ policonsumo, </span></span>
<span id="cb71-83"><a href="#cb71-83" aria-hidden="true" tabindex="-1"></a><span class="co">#                   data = comp_cases_Base_fiscalia_v15c_grant_23_24, family=binomial)</span></span>
<span id="cb71-84"><a href="#cb71-84" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb71-85"><a href="#cb71-85" aria-hidden="true" tabindex="-1"></a><span class="co"># wdata &lt;- medweight(fit,data= comp_cases_Base_fiscalia_v15c_grant_23_24)</span></span>
<span id="cb71-86"><a href="#cb71-86" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb71-87"><a href="#cb71-87" aria-hidden="true" tabindex="-1"></a><span class="co"># aaMss2 &lt;- binreg(Event(time,status)~gp+dnr+preauto+ttt24+cluster(id),data=dat,time=50,cause=2)</span></span>
<span id="cb71-88"><a href="#cb71-88" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(aaMss2)</span></span>
<span id="cb71-89"><a href="#cb71-89" aria-hidden="true" tabindex="-1"></a><span class="co"># aaMss22 &lt;- binreg(Event(time,status)~dnr+preauto+ttt24+cluster(id),data=dat,time=50,cause=2)</span></span>
<span id="cb71-90"><a href="#cb71-90" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(aaMss22)</span></span>
<span id="cb71-91"><a href="#cb71-91" aria-hidden="true" tabindex="-1"></a><span class="co"># #Error in `[.data.frame`(x, i, j) : undefined columns selected</span></span>
<span id="cb71-92"><a href="#cb71-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-93"><a href="#cb71-93" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-94"><a href="#cb71-94" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-95"><a href="#cb71-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-96"><a href="#cb71-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-97"><a href="#cb71-97" aria-hidden="true" tabindex="-1"></a><span class="co">#VanderWeele TJ. Causal mediation analysis with survival data. Epidemiology. 2011 Jul;22(4):582-5. doi: 10.1097/EDE.0b013e31821db37e. PMID: 21642779; PMC</span></span>
<span id="cb71-98"><a href="#cb71-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-99"><a href="#cb71-99" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-100"><a href="#cb71-100" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-101"><a href="#cb71-101" aria-hidden="true" tabindex="-1"></a><span class="co">#h </span></span>
<span id="cb71-102"><a href="#cb71-102" aria-hidden="true" tabindex="-1"></a><span class="co"># This paper presented methods for mediation analysis with a time-to-event outcome that are based on either the AFT model or the Cox PH model. The choice for an effect measure, that is, the hazard ratio from a Cox PH model or the ratio of mean survival times from an AFT model, should primarily depend on the scientific context of the mediation analysis. In other words, the effect measure should match the research question at hand. When using either the Cox or AFT models with any of the two mediation frameworks, it is necessary to check the corresponding assumptions. The PH assumption can be checked using the Schoenfeld residuals test and visual inspection of the graphs based on the scaled Schoenfeld residuals. The Weibull assumption can be checked using either of the following two methods: (1) comparing the AIC from AFT models with different specified error distributions and select the error distribution with the lowest AIC, and (2) visual inspection of the Cox–Snell residuals. A further explanation on how to check the Cox and AFT model assumptions can be found in Kleinbaum and Klein </span></span>
<span id="cb71-103"><a href="#cb71-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-104"><a href="#cb71-104" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-105"><a href="#cb71-105" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-106"><a href="#cb71-106" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/mma/mma.pdf</span></span>
<span id="cb71-107"><a href="#cb71-107" aria-hidden="true" tabindex="-1"></a><span class="co">#Yu, Q. and Li, B., 2017. mma: An R Package for Mediation Analysis with Multiple Mediators.  Journal of Open Research Software,  5(1), p.11.DOI: https://doi.org/10.5334/jors.160</span></span>
<span id="cb71-108"><a href="#cb71-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-109"><a href="#cb71-109" aria-hidden="true" tabindex="-1"></a><span class="do">##Surv class outcome (survival analysis)</span></span>
<span id="cb71-110"><a href="#cb71-110" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cgd1) <span class="co">#a dataset in the survival package</span></span>
<span id="cb71-111"><a href="#cb71-111" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>cgd1[,<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>)]</span>
<span id="cb71-112"><a href="#cb71-112" aria-hidden="true" tabindex="-1"></a>pred<span class="ot">=</span>cgd1[,<span class="dv">6</span>]</span>
<span id="cb71-113"><a href="#cb71-113" aria-hidden="true" tabindex="-1"></a>status<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(cgd1<span class="sc">$</span>etime1),<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb71-114"><a href="#cb71-114" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">Surv</span>(cgd1<span class="sc">$</span>futime,status)</span>
<span id="cb71-115"><a href="#cb71-115" aria-hidden="true" tabindex="-1"></a><span class="co">#for continuous predictor</span></span>
<span id="cb71-116"><a href="#cb71-116" aria-hidden="true" tabindex="-1"></a>data.surv.contx<span class="ot">&lt;-</span><span class="fu">data.org</span>(x,y,<span class="at">pred=</span>pred,<span class="at">mediator=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x),</span>
<span id="cb71-117"><a href="#cb71-117" aria-hidden="true" tabindex="-1"></a><span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">alpha2=</span><span class="fl">0.5</span>)</span>
<span id="cb71-118"><a href="#cb71-118" aria-hidden="true" tabindex="-1"></a>temp9.contx<span class="ot">&lt;-</span><span class="fu">boot.med</span>(<span class="at">data=</span>data.surv.contx,<span class="at">n=</span><span class="dv">1</span>,<span class="at">n2=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">"lp"</span>)</span>
<span id="cb71-119"><a href="#cb71-119" aria-hidden="true" tabindex="-1"></a>temp10.contx<span class="ot">&lt;-</span><span class="fu">boot.med</span>(<span class="at">data=</span>data.surv.contx,<span class="at">nonlinear=</span><span class="cn">TRUE</span>,<span class="at">n=</span><span class="dv">1</span>,<span class="at">n2=</span><span class="dv">2</span>)</span>
<span id="cb71-120"><a href="#cb71-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-121"><a href="#cb71-121" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-122"><a href="#cb71-122" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-123"><a href="#cb71-123" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.uib.no/web/packages/mets/vignettes/mediation-survival.html</span></span>
<span id="cb71-124"><a href="#cb71-124" aria-hidden="true" tabindex="-1"></a><span class="co"># The mediator can</span></span>
<span id="cb71-125"><a href="#cb71-125" aria-hidden="true" tabindex="-1"></a><span class="do">## binomial using glm-binomial.</span></span>
<span id="cb71-126"><a href="#cb71-126" aria-hidden="true" tabindex="-1"></a><span class="do">## multnomial via the mlogit function</span></span>
<span id="cb71-127"><a href="#cb71-127" aria-hidden="true" tabindex="-1"></a><span class="co"># In the below example these are</span></span>
<span id="cb71-128"><a href="#cb71-128" aria-hidden="true" tabindex="-1"></a><span class="do">## mediator: gp.f</span></span>
<span id="cb71-129"><a href="#cb71-129" aria-hidden="true" tabindex="-1"></a><span class="do">## exposure : dnr.f</span></span>
<span id="cb71-130"><a href="#cb71-130" aria-hidden="true" tabindex="-1"></a>weightmodel <span class="ot">&lt;-</span> fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(gp.f<span class="sc">~</span>dnr.f<span class="sc">+</span>preauto<span class="sc">+</span>ttt24,<span class="at">data=</span>dat,<span class="at">family=</span>binomial)</span>
<span id="cb71-131"><a href="#cb71-131" aria-hidden="true" tabindex="-1"></a>wdata <span class="ot">&lt;-</span> <span class="fu">medweight</span>(fit,<span class="at">data=</span>dat)</span>
<span id="cb71-132"><a href="#cb71-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-133"><a href="#cb71-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-134"><a href="#cb71-134" aria-hidden="true" tabindex="-1"></a>aaMss <span class="ot">&lt;-</span> <span class="fu">binreg</span>(<span class="fu">Event</span>(time,status)<span class="sc">~</span>dnr.f0<span class="sc">+</span>dnr.f1<span class="sc">+</span>preauto<span class="sc">+</span>ttt24<span class="sc">+</span><span class="fu">cluster</span>(id),<span class="at">data=</span>wdata,<span class="at">time=</span><span class="dv">50</span>,<span class="at">weights=</span>wdata<span class="sc">$</span>weights,<span class="at">cause=</span><span class="dv">2</span>)</span>
<span id="cb71-135"><a href="#cb71-135" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aaMss)</span>
<span id="cb71-136"><a href="#cb71-136" aria-hidden="true" tabindex="-1"></a>ll <span class="ot">&lt;-</span> <span class="fu">mediatorSurv</span>(aaMss,fit,<span class="at">data=</span>dat,<span class="at">wdata=</span>wdata)</span>
<span id="cb71-137"><a href="#cb71-137" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ll)</span>
<span id="cb71-138"><a href="#cb71-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-139"><a href="#cb71-139" aria-hidden="true" tabindex="-1"></a>aaMss <span class="ot">&lt;-</span> <span class="fu">phreg</span>(<span class="fu">Surv</span>(time,status<span class="sc">==</span><span class="dv">2</span>)<span class="sc">~</span>dnr.f0<span class="sc">+</span>dnr.f1<span class="sc">+</span>preauto<span class="sc">+</span>ttt24<span class="sc">+</span><span class="fu">cluster</span>(id),<span class="at">data=</span>wdata,<span class="at">weights=</span>wdata<span class="sc">$</span>weights)</span>
<span id="cb71-140"><a href="#cb71-140" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aaMss)</span>
<span id="cb71-141"><a href="#cb71-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-142"><a href="#cb71-142" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-143"><a href="#cb71-143" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-144"><a href="#cb71-144" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/HIMA/HIMA.pdf</span></span>
<span id="cb71-145"><a href="#cb71-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Zhang H, Zheng Y, Hou L, Zheng C, Liu L. Mediation analysis for survival data with high-dimensional mediators. Bioinformatics. 2021 Nov 5;37(21):3815-3821. doi: 10.1093/bioinformatics/btab564. PMID: 34343267; PMCID: PMC8570823.</span></span>
<span id="cb71-146"><a href="#cb71-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-147"><a href="#cb71-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-148"><a href="#cb71-148" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-149"><a href="#cb71-149" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb71-150"><a href="#cb71-150" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3204669/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell" data-paged.print="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"R library: "</span>, <span class="fu">Sys.getenv</span>(<span class="st">"R_LIBS_USER"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>R library: C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/renv/library/R-4.1/x86_64-w64-mingw32;C:/Users/CISS Fondecyt/AppData/Local/Temp/RtmpgPDKdm/renv-system-library</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Date: "</span>,<span class="fu">Sys.Date</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Date: 2023-08-01</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">"Editor: "</span>, path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="message">
<p>Editor: C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2022 (github)/env</p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>sesion_info <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(sesion_info<span class="sc">$</span>packages),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(package, loadedversion, source)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">filter =</span> <span class="st">'top'</span>, <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">'Row number'</span> <span class="ot">=</span><span class="dv">1</span>,<span class="st">'Package'</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">'Version'</span><span class="ot">=</span> <span class="dv">3</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left;'</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">''</span>, htmltools<span class="sc">::</span><span class="fu">em</span>(<span class="st">'R packages'</span>)),</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="at">initComplete =</span> htmlwidgets<span class="sc">::</span><span class="fu">JS</span>(</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$(this.api().tables().body()).css({</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-family': 'Helvetica Neue',</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-size': '50%', </span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="st">            'code-inline-font-size': '15%', </span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="st">            'white-space': 'nowrap',</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="st">            'line-height': '0.75em',</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="st">            'min-height': '0.5em'</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="st">            });"</span>,<span class="co">#;</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"}"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-3b1435f4ad6e58ac1751" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3b1435f4ad6e58ac1751">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption style=\"caption-side: top; text-align: left;\">\n  \n  <em>R packages<\/em>\n<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224"],["abind","admisc","ape","assertthat","backports","base64enc","bit","bit64","blob","bootstrap","broom","cachem","callr","car","carData","cellranger","checkmate","chron","class","cli","clisymbols","cluster","coda","codetools","colorspace","compareGroups","corrplot","cowplot","crayon","curl","data.table","DBI","dbplyr","deldir","deSolve","devtools","digest","doRNG","dplyr","DT","e1071","ellipsis","emmeans","estimability","evaluate","factoextra","FactoMineR","fansi","farver","fastmap","flashClust","flexsurv","flextable","FNN","forcats","foreach","foreign","Formula","fs","future","future.apply","gargle","gdtools","generics","ggiraph","ggplot2","ggpubr","ggrepel","ggsignif","glca","globals","glue","googledrive","googlesheets4","gridExtra","gsubfn","gtable","HardyWeinberg","haven","highr","Hmisc","hms","homals","htmlTable","htmltools","htmlwidgets","httpuv","httr","interp","isoband","iterators","itertools","janitor","jpeg","jsonlite","jtools","kableExtra","KernSmooth","km.ci","KMsurv","knitr","labeling","labelled","later","lattice","latticeExtra","lava","leaps","lifecycle","listenv","lubridate","magrittr","MASS","Matrix","MatrixModels","memoise","mice","mime","miniUI","missForest","missRanger","mitools","modelr","mstate","muhaz","multcomp","multcompView","munsell","mvtnorm","nlme","nnet","numDeriv","officer","openxlsx","pacman","pander","parallelly","pillar","pkgbuild","pkgconfig","pkgload","plyr","png","polspline","polycor","prettyunits","processx","prodlim","profvis","promises","proto","proxy","ps","purrr","quadprog","quantreg","R6","randomForest","ranger","RColorBrewer","Rcpp","readr","readxl","remotes","renv","reprex","reticulate","rio","rlang","rmarkdown","rmeta","rms","rngtools","rpart","Rsolnp","RSQLite","rstatix","rstudioapi","rvest","sandwich","scales","scatterplot3d","sessioninfo","shiny","snakecase","SparseM","sqldf","statmod","stringi","stringr","SuppDists","survcomp","survey","survival","survivalROC","survminer","survMisc","survRM2","svglite","systemfonts","tableone","TH.data","tibble","tidylog","tidyr","tidyselect","tidyverse","truncnorm","tzdb","urlchecker","usethis","utf8","uuid","vctrs","viridisLite","webshot","withr","writexl","xfun","xml2","xtable","yaml","zip","zoo"],["1.4-5","0.30","5.6-2","0.2.1","1.4.1","0.1-3","4.0.4","4.0.5","1.2.3","2019.6","1.0.1","1.0.6","3.7.2","3.1-1","3.0-5","1.1.0","2.1.0","2.3-58","7.3-20","3.4.1","1.2.0","2.1.4","0.19-4","0.2-19","2.0-3","4.5.1","0.92","1.1.1","1.5.2","4.3.3","1.14.2","1.1.3","2.2.1","1.0-6","1.34","2.4.5","0.6.29","1.8.2","1.0.10","0.26","1.7-11","0.3.2","1.8.1-1","1.4.1","0.17","1.0.7","2.8","1.0.3","2.1.1","1.1.0","1.01-2","2.2","0.8.2","1.1.3.1","0.5.2","1.5.2","0.8-83","1.2-4","1.5.2","1.28.0","1.10.0","1.2.1","0.2.4","0.1.3","0.8.3","3.4.1","0.4.0","0.9.1","0.6.4","1.3.3","0.16.1","1.6.2","2.0.0","1.0.1","2.3","0.7","0.3.1","1.7.5","2.5.1","0.9","4.7-1","1.1.2","1.0-10","2.4.1","0.5.3","1.5.4","1.6.6","1.4.4","1.1-3","0.2.6","1.0.14","0.1-3","2.1.0","0.1-9","1.8.2","2.2.0","1.3.4","2.23-20","0.5-6","0.1-5","1.40","0.4.2","2.10.0","1.3.0","0.20-45","0.6-30","1.6.10","3.1","1.0.3","0.8.0","1.8.0","2.0.3","7.3-58.1","1.5-1","0.5-1","2.0.1","3.14.0","0.12","0.1.1.1","1.5","2.1.3","2.4","0.1.9","0.3.2","1.2.6.4","1.4-20","0.1-9","0.5.0","1.1-3","3.1-159","7.3-18","2016.8-1.1","0.4.4","4.2.5","0.5.1","0.6.5","1.32.1","1.8.1","1.3.1","2.0.3","1.3.0","1.8.7","0.1-7","1.1.20","0.8-1","1.1.1","3.7.0","2019.11.13","0.3.7","1.2.0.1","1.0.0","0.4-27","1.7.1","0.3.5","1.5-8","5.94","2.5.1","4.7-1.1","0.14.1","1.1-3","1.0.9","2.1.3","1.4.1","2.4.2","0.16.0","2.0.2","1.26","0.5.29","1.0.6","2.17","3.0","6.3-0","1.5.2","4.1.16","1.16","2.2.18","0.7.0","0.14","1.0.3","3.0-2","1.2.1","0.3-42","1.2.2","1.7.2","0.11.0","1.81","0.4-11","1.4.37","1.7.6","1.4.1","1.1-9.7","1.44.1","4.1-1","3.4-0","1.0.3","0.4.9","0.5.6","1.0-4","2.1.0","1.0.4","0.13.2","1.1-1","3.1.8","1.0.2","1.2.1","1.2.0","1.3.2","1.0-8","0.3.0","1.0.1","2.1.6","1.2.2","1.1-0","0.5.2","0.4.1","0.5.4","2.5.0","1.4.0","0.33","1.3.3","1.8-4","2.3.6","2.2.1","1.8-11"],["CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","Bioconductor","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.1)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.2)","CRAN (R 4.1.2)","CRAN (R 4.1.3)","CRAN (R 4.1.3)","CRAN (R 4.1.3)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Row number<\/th>\n      <th>Package<\/th>\n      <th>Version<\/th>\n      <th>source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"initComplete":"function(settings, json) {\n$(this.api().tables().body()).css({\n            'font-family': 'Helvetica Neue',\n            'font-size': '50%', \n            'code-inline-font-size': '15%', \n            'white-space': 'nowrap',\n            'line-height': '0.75em',\n            'min-height': '0.5em'\n            });\n}","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":["options.initComplete"],"jsHooks":[]}</script>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">py_list_packages</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">filter =</span> <span class="st">'top'</span>, <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">'Row number'</span> <span class="ot">=</span><span class="dv">1</span>,<span class="st">'Package'</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">'Version'</span><span class="ot">=</span> <span class="dv">3</span>),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left;'</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">''</span>, htmltools<span class="sc">::</span><span class="fu">em</span>(<span class="st">'Python packages'</span>)),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="at">initComplete =</span> htmlwidgets<span class="sc">::</span><span class="fu">JS</span>(</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$(this.api().tables().body()).css({</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-family': 'Helvetica Neue',</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-size': '50%', </span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="st">            'code-inline-font-size': '15%', </span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="st">            'white-space': 'nowrap',</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="st">            'line-height': '0.75em',</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="st">            'min-height': '0.5em'</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="st">            });"</span>,<span class="co">#;</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"}"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-e0b547dfbfa3a26cdd9c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e0b547dfbfa3a26cdd9c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption style=\"caption-side: top; text-align: left;\">\n  \n  <em>Python packages<\/em>\n<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427"],["alabaster","anaconda-client","anaconda-navigator","anaconda-project","anyio","appdirs","argon2-cffi","argon2-cffi-bindings","arrow","astor","astroid","astropy","asttokens","atomicwrites","attrs","autograd","autograd-gamma","automat","autopep8","babel","backcall","backports","backports.functools_lru_cache","backports.tempfile","backports.weakref","bcrypt","beautifulsoup4","binaryornot","black","blas","bleach","blosc","bokeh","boltons","bottleneck","brotli","brotli-bin","brotlipy","bzip2","ca-certificates","certifi","cffi","cfitsio","chardet","charls","charset-normalizer","click","cloudpickle","clyent","colorama","colorcet","comm","conda","conda-build","conda-content-trust","conda-pack","conda-package-handling","conda-package-streaming","conda-repo-cli","conda-token","conda-verify","console_shortcut","constantly","contourpy","cookiecutter","cryptography","cssselect","curl","cycler","cytoolz","daal4py","dal","dask","dask-core","datashader","datashape","debugpy","decorator","defusedxml","diff-match-patch","dill","distributed","docstring-to-markdown","docutils","entrypoints","et_xmlfile","executing","filelock","flake8","flask","flit-core","fonttools","formulaic","freetype","fsspec","future","gensim","giflib","glib","glob2","greenlet","gst-plugins-base","gstreamer","h5py","hdf5","heapdict","holoviews","huggingface_hub","hvplot","hyperlink","icc_rt","icu","idna","imagecodecs","imageio","imagesize","imbalanced-learn","importlib-metadata","importlib_metadata","incremental","inflection","iniconfig","intake","intel-openmp","interface-meta","intervaltree","ipykernel","ipython","ipython_genutils","ipywidgets","isort","itemadapter","itemloaders","itsdangerous","jedi","jellyfish","jinja2","jinja2-time","jmespath","joblib","jpeg","jq","json5","jsonpatch","jsonpointer","jsonschema","jupyter","jupyter_client","jupyter_console","jupyter_core","jupyter_server","jupyterlab","jupyterlab_pygments","jupyterlab_server","jupyterlab_widgets","jxrlib","keyring","kiwisolver","lazy-object-proxy","lcms2","lerc","libaec","libarchive","libbrotlicommon","libbrotlidec","libbrotlienc","libclang","libcurl","libdeflate","libffi","libiconv","liblief","libogg","libpng","libsodium","libspatialindex","libssh2","libtiff","libuv","libvorbis","libwebp","libwebp-base","libxml2","libxslt","libzopfli","lifelines","llvmlite","locket","lxml","lz4","lz4-c","lzo","m2-msys2-runtime","m2-patch","m2w64-libwinpthread-git","markdown","markupsafe","matplotlib","matplotlib-base","matplotlib-inline","mccabe","menuinst","mistune","mkl","mkl-service","mkl_fft","mkl_random","mock","mpmath","msgpack-python","msys2-conda-epoch","multipledispatch","munkres","mypy_extensions","navigator-updater","nbclassic","nbclient","nbconvert","nbformat","nest-asyncio","networkx","ninja","ninja-base","nltk","notebook","notebook-shim","numba","numexpr","numpy","numpy-base","numpydoc","openjpeg","openpyxl","openssl","packaging","pandas","pandocfilters","panel","param","paramiko","parsel","parso","partd","pathlib","pathspec","patsy","pcre","pep8","pexpect","pickleshare","pillow","pip","pkginfo","platformdirs","plotly","pluggy","ply","pooch","powershell_shortcut","poyo","prometheus_client","prompt-toolkit","prompt_toolkit","protego","psutil","ptyprocess","pure_eval","py","py-lief","pyasn1","pyasn1-modules","pycodestyle","pycosat","pycparser","pyct","pycurl","pydispatcher","pydocstyle","pyenv-win","pyerfa","pyflakes","pygments","pyhamcrest","pyjwt","pylint","pylint-venv","pyls-spyder","pynacl","pyodbc","pyopenssl","pyparsing","pyqt","pyqt5-sip","pyqtwebengine","pyrsistent","pysocks","pytables","pytest","python","python-dateutil","python-fastjsonschema","python-libarchive-c","python-lsp-black","python-lsp-jsonrpc","python-lsp-server","python-slugify","python-snappy","pytoolconfig","pytorch","pytz","pyviz_comms","pywavelets","pywin32","pywin32-ctypes","pywinpty","pyyaml","pyzmq","qdarkstyle","qstylizer","qt-main","qt-webengine","qtawesome","qtconsole","qtpy","qtwebkit","queuelib","regex","requests","requests-file","requests-toolbelt","rope","rtree","ruamel.yaml","ruamel.yaml.clib","ruamel_yaml","scikit-image","scikit-learn","scikit-learn-intelex","scipy","scrapy","seaborn","send2trash","service_identity","setuptools","sip","six","smart_open","snappy","sniffio","snowballstemmer","sortedcontainers","soupsieve","speechrecognition","sphinx","sphinxcontrib-applehelp","sphinxcontrib-devhelp","sphinxcontrib-htmlhelp","sphinxcontrib-jsmath","sphinxcontrib-qthelp","sphinxcontrib-serializinghtml","spyder","spyder-kernels","sqlalchemy","sqlite","stack_data","statsmodels","sympy","tabulate","tbb","tbb4py","tblib","tenacity","terminado","text-unidecode","textdistance","threadpoolctl","three-merge","tifffile","tinycss2","tk","tldextract","tokenizers","toml","tomli","tomlkit","toolz","tornado","tqdm","traitlets","transformers","twisted","twisted-iocpsupport","typing-extensions","typing_extensions","tzdata","ujson","unidecode","urllib3","vc","vs2015_runtime","w3lib","watchdog","wcwidth","webencodings","websocket-client","werkzeug","whatthepatch","wheel","widgetsnbextension","win_inet_pton","wincertstore","winpty","wrapt","xarray","xlwings","xz","yaml","yapf","zeromq","zfp","zict","zipp","zlib","zope","zope.interface","zstandard","zstd"],["0.7.12","1.11.2","2.4.0","0.11.1","3.5.0","1.4.4","21.3.0","21.2.0","1.2.3","0.8.1","2.14.2","5.1","2.0.5","1.4.0","22.1.0","1.5","0.5.0","20.2.0","1.6.0","2.11.0","0.2.0","1.1","1.6.4","1.0","1.0.post1","3.2.0","4.11.1","0.4.4","22.6.0","1.0","4.1.0","1.21.3","2.4.3","23.0.0","1.3.5","1.0.9","1.0.9","0.7.0","1.0.8","2023.01.10","2022.12.7","1.15.1","3.470","4.0.0","2.2.0","2.0.4","8.0.4","2.0.0","1.2.2","0.4.6","3.0.1","0.1.2","23.3.1","3.24.0","0.1.3","0.6.0","2.0.2","0.7.0","1.0.41","0.4.0","3.4.2","0.1.1","15.1.0","1.0.5","1.7.3","39.0.1","1.1.0","7.87.0","0.11.0","0.12.0","2023.0.2","2023.0.1","2022.7.0","2022.7.0","0.14.4","0.5.4","1.5.1","5.1.1","0.7.1","20200713","0.3.6","2022.7.0","0.11","0.18.1","0.4","1.1.0","0.8.3","3.9.0","6.0.0","2.2.2","3.6.0","4.25.0","0.6.1","2.12.1","2022.11.0","0.18.3","4.3.0","5.2.1","2.69.1","0.7","2.0.1","1.18.5","1.18.5","3.7.0","1.10.6","1.0.1","1.15.4","0.10.1","0.8.2","21.0.0","2022.1.0","58.2","3.4","2021.8.26","2.26.0","1.4.1","0.10.1","4.11.3","4.11.3","21.3.0","0.5.1","1.1.1","0.6.7","2021.4.0","1.3.0","3.1.0","6.19.2","8.10.0","0.2.0","7.6.5","5.9.3","0.3.0","1.0.4","2.0.1","0.18.1","0.9.0","3.1.2","0.2.0","0.10.0","1.1.1","9e","1.6","0.9.6","1.32","2.1","4.17.3","1.0.0","7.3.4","6.6.2","5.2.0","1.23.4","3.5.3","0.1.2","2.19.0","1.0.0","1.1","23.4.0","1.4.4","1.6.0","2.12","3.0","1.0.4","3.6.2","1.0.9","1.0.9","1.0.9","12.0.0","7.87.0","1.17","3.4.2","1.16","0.12.3","1.3.5","1.6.39","1.0.18","1.9.3","1.10.0","4.5.0","1.44.2","1.3.7","1.2.4","1.2.4","2.9.14","1.1.35","1.0.3","0.27.7","0.39.1","1.0.0","4.9.1","3.1.3","1.9.4","2.10","2.5.0.17080.65c939c","2.7.5","5.0.0.4634.697f757","3.4.1","2.1.1","3.7.0","3.7.0","0.1.6","0.7.0","1.4.19","0.8.4","2021.4.0","2.4.0","1.3.1","1.2.2","4.0.3","1.2.1","1.0.3","20160418","0.6.0","1.1.4","0.4.3","0.3.0","0.5.2","0.5.13","6.5.4","5.7.0","1.5.6","2.8.4","1.10.2","1.10.2","3.7","6.5.2","0.2.2","0.56.4","2.8.4","1.23.5","1.23.5","1.5.0","2.4.0","3.0.10","1.1.1t","22.0","1.5.3","1.5.0","0.14.3","1.12.3","2.8.1","1.6.0","0.8.3","1.2.0","1.0.1","0.10.3","0.5.3","8.45","1.7.1","4.8.0","0.7.5","9.4.0","22.3.1","1.9.6","2.5.2","5.9.0","1.0.0","3.11","1.4.0","0.0.1","0.5.0","0.14.1","3.0.36","3.0.36","0.1.16","5.9.0","0.7.0","0.2.2","1.11.0","0.12.3","0.4.8","0.2.8","2.10.0","0.6.4","2.21","0.5.0","7.45.1","2.0.5","6.3.0","3.1.1","2.0.0","3.0.1","2.11.2","2.0.2","2.4.0","2.16.2","2.3.0","0.4.0","1.5.0","4.0.34","23.0.0","3.0.9","5.15.7","12.11.0","5.15.7","0.18.0","1.7.1","3.7.0","7.1.2","3.10.9","2.8.2","2.16.2","2.9","1.2.1","1.0.0","1.7.1","5.0.2","0.6.1","1.2.5","1.12.1","2022.7","2.0.2","1.4.1","305","0.2.0","2.0.10","6.0","23.2.0","3.0.2","0.2.2","5.15.2","5.15.9","1.2.2","5.4.0","2.2.0","5.212","1.5.0","2022.7.9","2.28.1","1.5.1","0.9.1","1.7.0","1.0.1","0.17.21","0.2.6","0.17.21","0.19.3","1.2.1","2023.0.2","1.10.0","2.8.0","0.12.2","1.8.0","18.1.0","65.6.3","6.6.2","1.16.0","5.2.1","1.1.9","1.2.0","2.2.0","2.4.0","2.3.2.post1","3.10.0","5.0.2","1.0.2","1.0.2","2.0.0","1.0.1","1.0.3","1.1.5","5.4.1","2.4.1","1.4.39","3.40.1","0.2.0","0.13.5","1.11.1","0.8.10","2021.7.0","2021.7.0","1.7.0","8.0.1","0.17.1","1.3","4.2.1","2.2.0","0.1.1","2021.7.2","1.2.1","8.6.12","3.2.0","0.11.4","0.10.2","2.0.1","0.11.1","0.12.0","6.1","4.64.1","5.7.1","4.24.0","22.2.0","1.0.2","4.4.0","4.4.0","2022g","5.4.0","1.2.0","1.26.14","14.2","14.27.29016","1.21.0","2.1.6","0.2.5","0.5.1","0.58.0","2.2.2","1.0.2","0.38.4","3.5.2","1.1.0","0.2","0.4.3","1.14.1","2022.11.0","0.29.1","5.2.10","0.2.5","0.31.0","4.3.4","0.5.5","2.1.0","3.11.0","1.2.13","1.0","5.4.0","0.19.0","1.5.2"],["alabaster=0.7.12","anaconda-client=1.11.2","anaconda-navigator=2.4.0","anaconda-project=0.11.1","anyio=3.5.0","appdirs=1.4.4","argon2-cffi=21.3.0","argon2-cffi-bindings=21.2.0","arrow=1.2.3","astor=0.8.1","astroid=2.14.2","astropy=5.1","asttokens=2.0.5","atomicwrites=1.4.0","attrs=22.1.0","autograd=1.5","autograd-gamma=0.5.0","automat=20.2.0","autopep8=1.6.0","babel=2.11.0","backcall=0.2.0","backports=1.1","backports.functools_lru_cache=1.6.4","backports.tempfile=1.0","backports.weakref=1.0.post1","bcrypt=3.2.0","beautifulsoup4=4.11.1","binaryornot=0.4.4","black=22.6.0","blas=1.0","bleach=4.1.0","blosc=1.21.3","bokeh=2.4.3","boltons=23.0.0","bottleneck=1.3.5","brotli=1.0.9","brotli-bin=1.0.9","brotlipy=0.7.0","bzip2=1.0.8","ca-certificates=2023.01.10","certifi=2022.12.7","cffi=1.15.1","cfitsio=3.470","chardet=4.0.0","charls=2.2.0","charset-normalizer=2.0.4","click=8.0.4","cloudpickle=2.0.0","clyent=1.2.2","colorama=0.4.6","colorcet=3.0.1","comm=0.1.2","conda=23.3.1","conda-build=3.24.0","conda-content-trust=0.1.3","conda-pack=0.6.0","conda-package-handling=2.0.2","conda-package-streaming=0.7.0","conda-repo-cli=1.0.41","conda-token=0.4.0","conda-verify=3.4.2","console_shortcut=0.1.1","constantly=15.1.0","contourpy=1.0.5","cookiecutter=1.7.3","cryptography=39.0.1","cssselect=1.1.0","curl=7.87.0","cycler=0.11.0","cytoolz=0.12.0","daal4py=2023.0.2","dal=2023.0.1","dask=2022.7.0","dask-core=2022.7.0","datashader=0.14.4","datashape=0.5.4","debugpy=1.5.1","decorator=5.1.1","defusedxml=0.7.1","diff-match-patch=20200713","dill=0.3.6","distributed=2022.7.0","docstring-to-markdown=0.11","docutils=0.18.1","entrypoints=0.4","et_xmlfile=1.1.0","executing=0.8.3","filelock=3.9.0","flake8=6.0.0","flask=2.2.2","flit-core=3.6.0","fonttools=4.25.0","formulaic=0.6.1","freetype=2.12.1","fsspec=2022.11.0","future=0.18.3","gensim=4.3.0","giflib=5.2.1","glib=2.69.1","glob2=0.7","greenlet=2.0.1","gst-plugins-base=1.18.5","gstreamer=1.18.5","h5py=3.7.0","hdf5=1.10.6","heapdict=1.0.1","holoviews=1.15.4","huggingface_hub=0.10.1","hvplot=0.8.2","hyperlink=21.0.0","icc_rt=2022.1.0","icu=58.2","idna=3.4","imagecodecs=2021.8.26","imageio=2.26.0","imagesize=1.4.1","imbalanced-learn=0.10.1","importlib-metadata=4.11.3","importlib_metadata=4.11.3","incremental=21.3.0","inflection=0.5.1","iniconfig=1.1.1","intake=0.6.7","intel-openmp=2021.4.0","interface-meta=1.3.0","intervaltree=3.1.0","ipykernel=6.19.2","ipython=8.10.0","ipython_genutils=0.2.0","ipywidgets=7.6.5","isort=5.9.3","itemadapter=0.3.0","itemloaders=1.0.4","itsdangerous=2.0.1","jedi=0.18.1","jellyfish=0.9.0","jinja2=3.1.2","jinja2-time=0.2.0","jmespath=0.10.0","joblib=1.1.1","jpeg=9e","jq=1.6","json5=0.9.6","jsonpatch=1.32","jsonpointer=2.1","jsonschema=4.17.3","jupyter=1.0.0","jupyter_client=7.3.4","jupyter_console=6.6.2","jupyter_core=5.2.0","jupyter_server=1.23.4","jupyterlab=3.5.3","jupyterlab_pygments=0.1.2","jupyterlab_server=2.19.0","jupyterlab_widgets=1.0.0","jxrlib=1.1","keyring=23.4.0","kiwisolver=1.4.4","lazy-object-proxy=1.6.0","lcms2=2.12","lerc=3.0","libaec=1.0.4","libarchive=3.6.2","libbrotlicommon=1.0.9","libbrotlidec=1.0.9","libbrotlienc=1.0.9","libclang=12.0.0","libcurl=7.87.0","libdeflate=1.17","libffi=3.4.2","libiconv=1.16","liblief=0.12.3","libogg=1.3.5","libpng=1.6.39","libsodium=1.0.18","libspatialindex=1.9.3","libssh2=1.10.0","libtiff=4.5.0","libuv=1.44.2","libvorbis=1.3.7","libwebp=1.2.4","libwebp-base=1.2.4","libxml2=2.9.14","libxslt=1.1.35","libzopfli=1.0.3","lifelines=0.27.7","llvmlite=0.39.1","locket=1.0.0","lxml=4.9.1","lz4=3.1.3","lz4-c=1.9.4","lzo=2.10","m2-msys2-runtime=2.5.0.17080.65c939c","m2-patch=2.7.5","m2w64-libwinpthread-git=5.0.0.4634.697f757","markdown=3.4.1","markupsafe=2.1.1","matplotlib=3.7.0","matplotlib-base=3.7.0","matplotlib-inline=0.1.6","mccabe=0.7.0","menuinst=1.4.19","mistune=0.8.4","mkl=2021.4.0","mkl-service=2.4.0","mkl_fft=1.3.1","mkl_random=1.2.2","mock=4.0.3","mpmath=1.2.1","msgpack-python=1.0.3","msys2-conda-epoch=20160418","multipledispatch=0.6.0","munkres=1.1.4","mypy_extensions=0.4.3","navigator-updater=0.3.0","nbclassic=0.5.2","nbclient=0.5.13","nbconvert=6.5.4","nbformat=5.7.0","nest-asyncio=1.5.6","networkx=2.8.4","ninja=1.10.2","ninja-base=1.10.2","nltk=3.7","notebook=6.5.2","notebook-shim=0.2.2","numba=0.56.4","numexpr=2.8.4","numpy=1.23.5","numpy-base=1.23.5","numpydoc=1.5.0","openjpeg=2.4.0","openpyxl=3.0.10","openssl=1.1.1t","packaging=22.0","pandas=1.5.3","pandocfilters=1.5.0","panel=0.14.3","param=1.12.3","paramiko=2.8.1","parsel=1.6.0","parso=0.8.3","partd=1.2.0","pathlib=1.0.1","pathspec=0.10.3","patsy=0.5.3","pcre=8.45","pep8=1.7.1","pexpect=4.8.0","pickleshare=0.7.5","pillow=9.4.0","pip=22.3.1","pkginfo=1.9.6","platformdirs=2.5.2","plotly=5.9.0","pluggy=1.0.0","ply=3.11","pooch=1.4.0","powershell_shortcut=0.0.1","poyo=0.5.0","prometheus_client=0.14.1","prompt-toolkit=3.0.36","prompt_toolkit=3.0.36","protego=0.1.16","psutil=5.9.0","ptyprocess=0.7.0","pure_eval=0.2.2","py=1.11.0","py-lief=0.12.3","pyasn1=0.4.8","pyasn1-modules=0.2.8","pycodestyle=2.10.0","pycosat=0.6.4","pycparser=2.21","pyct=0.5.0","pycurl=7.45.1","pydispatcher=2.0.5","pydocstyle=6.3.0","pyenv-win=3.1.1","pyerfa=2.0.0","pyflakes=3.0.1","pygments=2.11.2","pyhamcrest=2.0.2","pyjwt=2.4.0","pylint=2.16.2","pylint-venv=2.3.0","pyls-spyder=0.4.0","pynacl=1.5.0","pyodbc=4.0.34","pyopenssl=23.0.0","pyparsing=3.0.9","pyqt=5.15.7","pyqt5-sip=12.11.0","pyqtwebengine=5.15.7","pyrsistent=0.18.0","pysocks=1.7.1","pytables=3.7.0","pytest=7.1.2","python=3.10.9","python-dateutil=2.8.2","python-fastjsonschema=2.16.2","python-libarchive-c=2.9","python-lsp-black=1.2.1","python-lsp-jsonrpc=1.0.0","python-lsp-server=1.7.1","python-slugify=5.0.2","python-snappy=0.6.1","pytoolconfig=1.2.5","pytorch=1.12.1","pytz=2022.7","pyviz_comms=2.0.2","pywavelets=1.4.1","pywin32=305","pywin32-ctypes=0.2.0","pywinpty=2.0.10","pyyaml=6.0","pyzmq=23.2.0","qdarkstyle=3.0.2","qstylizer=0.2.2","qt-main=5.15.2","qt-webengine=5.15.9","qtawesome=1.2.2","qtconsole=5.4.0","qtpy=2.2.0","qtwebkit=5.212","queuelib=1.5.0","regex=2022.7.9","requests=2.28.1","requests-file=1.5.1","requests-toolbelt=0.9.1","rope=1.7.0","rtree=1.0.1","ruamel.yaml=0.17.21","ruamel.yaml.clib=0.2.6","ruamel_yaml=0.17.21","scikit-image=0.19.3","scikit-learn=1.2.1","scikit-learn-intelex=2023.0.2","scipy=1.10.0","scrapy=2.8.0","seaborn=0.12.2","send2trash=1.8.0","service_identity=18.1.0","setuptools=65.6.3","sip=6.6.2","six=1.16.0","smart_open=5.2.1","snappy=1.1.9","sniffio=1.2.0","snowballstemmer=2.2.0","sortedcontainers=2.4.0","soupsieve=2.3.2.post1","speechrecognition=3.10.0","sphinx=5.0.2","sphinxcontrib-applehelp=1.0.2","sphinxcontrib-devhelp=1.0.2","sphinxcontrib-htmlhelp=2.0.0","sphinxcontrib-jsmath=1.0.1","sphinxcontrib-qthelp=1.0.3","sphinxcontrib-serializinghtml=1.1.5","spyder=5.4.1","spyder-kernels=2.4.1","sqlalchemy=1.4.39","sqlite=3.40.1","stack_data=0.2.0","statsmodels=0.13.5","sympy=1.11.1","tabulate=0.8.10","tbb=2021.7.0","tbb4py=2021.7.0","tblib=1.7.0","tenacity=8.0.1","terminado=0.17.1","text-unidecode=1.3","textdistance=4.2.1","threadpoolctl=2.2.0","three-merge=0.1.1","tifffile=2021.7.2","tinycss2=1.2.1","tk=8.6.12","tldextract=3.2.0","tokenizers=0.11.4","toml=0.10.2","tomli=2.0.1","tomlkit=0.11.1","toolz=0.12.0","tornado=6.1","tqdm=4.64.1","traitlets=5.7.1","transformers=4.24.0","twisted=22.2.0","twisted-iocpsupport=1.0.2","typing-extensions=4.4.0","typing_extensions=4.4.0","tzdata=2022g","ujson=5.4.0","unidecode=1.2.0","urllib3=1.26.14","vc=14.2","vs2015_runtime=14.27.29016","w3lib=1.21.0","watchdog=2.1.6","wcwidth=0.2.5","webencodings=0.5.1","websocket-client=0.58.0","werkzeug=2.2.2","whatthepatch=1.0.2","wheel=0.38.4","widgetsnbextension=3.5.2","win_inet_pton=1.1.0","wincertstore=0.2","winpty=0.4.3","wrapt=1.14.1","xarray=2022.11.0","xlwings=0.29.1","xz=5.2.10","yaml=0.2.5","yapf=0.31.0","zeromq=4.3.4","zfp=0.5.5","zict=2.1.0","zipp=3.11.0","zlib=1.2.13","zope=1.0","zope.interface=5.4.0","zstandard=0.19.0","zstd=1.5.2"],["pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/msys2","pkgs/msys2","pkgs/msys2","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/msys2","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pypi","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pypi","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main","pkgs/main"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Row number<\/th>\n      <th>Package<\/th>\n      <th>Version<\/th>\n      <th>requirement<\/th>\n      <th>channel<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"initComplete":"function(settings, json) {\n$(this.api().tables().body()).css({\n            'font-family': 'Helvetica Neue',\n            'font-size': '50%', \n            'code-inline-font-size': '15%', \n            'white-space': 'nowrap',\n            'line-height': '0.75em',\n            'min-height': '0.5em'\n            });\n}","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":["options.initComplete"],"jsHooks":[]}</script>
</div>
</div>
<p>Guardar avances</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"an_grant_23_24.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>