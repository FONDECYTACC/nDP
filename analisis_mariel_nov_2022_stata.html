<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<pre><code>. clear all

. cap noi which tabout
C:\Users\CISS Fondecyt\ado\plus\t\tabout.ado
*! 2.0.8 Ian Watson 15mar2019
*! tabout version 3 (beta) available at: http://tabout.net.au

. if _rc==111 {
.         cap noi ssc install tabout
.         }

. cap noi which pathutil
C:\Users\CISS Fondecyt\ado\plus\p\pathutil.ado
*! version 2.2.0 19nov2020 daniel klein

. if _rc==111 {
.         cap noi net install pathutil, from(&quot;http://fmwww.bc.edu/repec/bocode/p/&quot;) 
.         }

. cap noi which pathutil
C:\Users\CISS Fondecyt\ado\plus\p\pathutil.ado
*! version 2.2.0 19nov2020 daniel klein

. if _rc==111 {
.         ssc install dirtools    
.         }

. cap noi which project
C:\Users\CISS Fondecyt\ado\plus\p\project.ado
*! version 1.3.1  22dec2013  picard@netbox.com

. if _rc==111 {   
.         ssc install project
.         }

. cap noi which stipw
C:\Users\CISS Fondecyt\ado\plus\s\stipw.ado
*! Version 1.0.0 17Jan2022

. if _rc==111 {   
.         ssc install stipw
.         }

. cap noi which stpm2
C:\Users\CISS Fondecyt\ado\plus\s\stpm2.ado
*! version 1.7.5 May2021

. if _rc==111 {   
.         ssc install stpm2
.         }       

. cap noi which rcsgen
C:\Users\CISS Fondecyt\ado\plus\r\rcsgen.ado
*! version 1.5.9 13FEB2022

. if _rc==111 {   
.         ssc install rcsgen
.         }       

. cap noi which matselrc
C:\Users\CISS Fondecyt\ado\plus\m\matselrc.ado
*! NJC 1.1.0 20 Apr 2000  (STB-56: dm79)

. if _rc==111 {           
. cap noi net install dm79, from(http://www.stata.com/stb/stb56)
.         }

</code></pre>
<h1><a href="#exercise" id="exercise">Exercise</a></h1>
<p>Date created: 16:11:31 22 Dec 2022.</p>
<p>Get the folder</p>
<pre><code>
C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2022 (github)


Fecha: 22 Dec 2022, considerando un SO Windows para el usuario: CISS Fondecyt

</code></pre>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<p>Path data= ;</p>
<p>Tiempo: 22 Dec 2022, considerando un SO Windows</p>
<p>The file is located and named as: C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2022 (github)fiscalia_mariel_oct_2022_match_SENDA.dta</p>
<p>=============================================================================</p>
<h2><a href="#structure-database-and-survival" id="structure-database-and-survival">Structure database and survival</a></h2>
<p>=============================================================================</p>
<p>We open the files</p>
<pre><code>. use &quot;fiscalia_mariel_oct_2022_match_SENDA.dta&quot;, clear

. encode escolaridad_rec, generate(esc_rec)

. encode sex, gen(sex_enc)

. encode sus_principal_mod, generate(sus_prin_mod)

. encode freq_cons_sus_prin, generate(fr_sus_prin)

. encode compromiso_biopsicosocial, generate(comp_biosoc)

. encode tenencia_de_la_vivienda_mod, generate(ten_viv)

. *encode dg_cie_10_rec, generate(dg_cie_10_mental_h) *already numeric
. encode dg_trs_cons_sus_or, generate(sud_severity_icd10)

. encode macrozona, generate(macrozone)

. gen     motivodeegreso_mod_imp_rec3 = 1

. replace motivodeegreso_mod_imp_rec3 = 2 if strpos(motivodeegreso_mod_imp_rec,&quot;Early&quot;)&gt;0
(15,797 real changes made)

. replace motivodeegreso_mod_imp_rec3 = 3 if strpos(motivodeegreso_mod_imp_rec,&quot;Late&quot;)&gt;0
(35,781 real changes made)

. 
. *encode policonsumo, generate(policon) *already numeric
. 
. *motivodeegreso_mod_imp_rec3 edad_al_ing_fmt edad_ini_cons dias_treat_imp_sin_na_1 i.escolaridad_rec i.sus_principal_mod i.freq_cons_sus_prin i.compromiso_biopsicosocial i.tenencia_de_la_vivienda_mod i.dg_cie_1
&gt; 0_rec i.dg_trs_cons_sus_or i.macrozona i.n_off_vio i.n_off_acq i.n_off_sud i.n_off_oth
</code></pre>
<p>Then we set the data base in surirval format and bring the urban-rural classification of municipallities from this <a href="&quot;https://view.officeapps.live.com/op/view.aspx?src=https%3A%2F%2Fwww.masvidarural.gob.cl%2Fwp-content%2Fuploads%2F2021%2F04%2FClasificacion-comunas-PNDR.xlsx&amp;wdOrigin=BROWSELINK&quot;">link</a>.</p>
<pre><code>. cap qui noi frame create temp

. frame temp: import excel &quot;Clasificacion-comunas-PNDR.xlsx&quot;, firstrow clear
(11 vars, 345 obs)

. *frame temp: browse
. frame change default

. 
. *select code of municipality
. gen str20 comuna = ustrregexs(1) if ustrregexm(comuna_residencia_cod,&quot;([\d,]+)&quot;)
(2 missing values generated)

. 
. *recode comuna if 
. *http://www.sinim.cl/archivos/centro_descargas/modificacion_instructivo_pres_codigos.pdf
. *file:///C:/Users/CISSFO~1/AppData/Local/Temp/MicrosoftEdgeDownloads/4ef08de9-6832-4db6-8124-f69a7b256270/codigoComunas-20180801%20(1).pdf
. 
. replace comuna= &quot;16101&quot; if strpos(strlower(comuna),&quot;8401&quot;)&gt;0
(434 real changes made)

. replace comuna= &quot;16102&quot; if strpos(strlower(comuna),&quot;8402&quot;)&gt;0
(10 real changes made)

. replace comuna= &quot;16103&quot; if strpos(strlower(comuna),&quot;8406&quot;)&gt;0
(32 real changes made)

. replace comuna= &quot;16104&quot; if strpos(strlower(comuna),&quot;8407&quot;)&gt;0
(2 real changes made)

. replace comuna= &quot;16105&quot; if strpos(strlower(comuna),&quot;8410&quot;)&gt;0
(1 real change made)

. replace comuna= &quot;16106&quot; if strpos(strlower(comuna),&quot;8411&quot;)&gt;0
(8 real changes made)

. replace comuna= &quot;16107&quot; if strpos(strlower(comuna),&quot;8413&quot;)&gt;0
(12 real changes made)

. replace comuna= &quot;16108&quot; if strpos(strlower(comuna),&quot;8418&quot;)&gt;0
(4 real changes made)

. replace comuna= &quot;16109&quot; if strpos(strlower(comuna),&quot;8421&quot;)&gt;0
(6 real changes made)

. replace comuna= &quot;16201&quot; if strpos(strlower(comuna),&quot;8414&quot;)&gt;0
(22 real changes made)

. replace comuna= &quot;16202&quot; if strpos(strlower(comuna),&quot;8403&quot;)&gt;0
(0 real changes made)

. replace comuna= &quot;16203&quot; if strpos(strlower(comuna),&quot;8404&quot;)&gt;0
(13 real changes made)

. replace comuna= &quot;16204&quot; if strpos(strlower(comuna),&quot;8408&quot;)&gt;0
(1 real change made)

. replace comuna= &quot;16205&quot; if strpos(strlower(comuna),&quot;8412&quot;)&gt;0
(1 real change made)

. replace comuna= &quot;16206&quot; if strpos(strlower(comuna),&quot;8415&quot;)&gt;0
(2 real changes made)

. replace comuna= &quot;16207&quot; if strpos(strlower(comuna),&quot;8420&quot;)&gt;0
(1 real change made)

. replace comuna= &quot;16301&quot; if strpos(strlower(comuna),&quot;8416&quot;)&gt;0
(12 real changes made)

. replace comuna= &quot;16302&quot; if strpos(strlower(comuna),&quot;8405&quot;)&gt;0
(6 real changes made)

. replace comuna= &quot;16303&quot; if strpos(strlower(comuna),&quot;8409&quot;)&gt;0
(0 real changes made)

. replace comuna= &quot;16304&quot; if strpos(strlower(comuna),&quot;8417&quot;)&gt;0
(0 real changes made)

. replace comuna= &quot;16305&quot; if strpos(strlower(comuna),&quot;8419&quot;)&gt;0
(0 real changes made)

. 
. destring comuna, replace
comuna: all characters numeric; replaced as int
(2 missing values generated)

. 
. *frame temp: gen str20 comuna = ustrregexs(1) if ustrregexm(cod_com,&quot;([\d,]+)&quot;)
. 
. frlink m:1 comuna, frame(temp cod_com) //*Clasificación
  (2 observations in frame default unmatched)

. frget Clasificación, from(temp)
(2 missing values generated)
  (1 variable copied from linked frame)

. 
. encode Clasificación, generate(clas)

. *encode clas, replace
. *70,863
</code></pre>
<pre><code>. *si no está perdido cod_region, significa que hubo un registro (0/1) y el tiempo es el tiempo desde 
. *set the indicator
. gen event=0

. replace event=1 if !missing(offender_d)
(22,287 real changes made)

. *replace event=1 if !missing(sex)
. 
. gen diff= age_offending_imp-edad_al_egres_imp

. 
. *age time
. stset age_offending_imp, fail(event ==1) enter(edad_al_egres_imp)

     failure event:  event == 1
obs. time interval:  (0, age_offending_imp]
 enter on or after:  time edad_al_egres_imp
 exit on or before:  failure

------------------------------------------------------------------------------
     70,863  total observations
          1  observation ends on or before enter()
------------------------------------------------------------------------------
     70,862  observations remaining, representing
     22,287  failures in single-record/single-failure data
 229,620.92  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =  10.95068
                                          last observed exit t =  90.65027

. 
. stdescribe, weight

         failure _d:  event == 1
   analysis time _t:  age_offending_imp
  enter on or after:  time edad_al_egres_imp

                                   |-------------- per subject --------------|
Category                   total        mean         min     median        max
------------------------------------------------------------------------------
no. of subjects            70862   
no. of records             70862           1           1          1          1

(first) entry time                  36.52205    10.95068    34.6274   88.91507
(final) exit time                   39.76244    14.84463   38.01506   90.65027

subjects with gap              0   
time on gap if gap             0   
time at risk           229620.92    3.240396    .0000449   2.665753   10.75828

failures                   22287    .3145127           0          0          1
------------------------------------------------------------------------------

</code></pre>
<p>We calculate the incidence rate.</p>
<pre><code>. stsum, by (motivodeegreso_mod_imp_rec)

         failure _d:  event == 1
   analysis time _t:  age_offending_imp
  enter on or after:  time edad_al_egres_imp

         |               Incidence     Number of   |------ Survival time -----|
motivo~c | Time at risk       rate      subjects        25%       50%       75%
---------+---------------------------------------------------------------------
Treatmen |  63,974.7794   .0597892         19275   19.60301  22.39014   28.2026
Treatmen |  46,815.0893   .1309407         15797   18.18207  19.15674  21.12526
Treatmen |  118,806.623   .1037484         35781   16.49829  17.60986  20.97467
---------+---------------------------------------------------------------------
   Total |  229,596.491   .0970442         70853   16.67765   18.3436  21.03217

</code></pre>
<p>=============================================================================</p>
<h2><a href="#descriptives" id="descriptives">Descriptives</a></h2>
<p>=============================================================================</p>
<pre><code>. 
. local ttl `&quot; &quot;Tr Completion&quot; &quot;Tr Disch (Early)&quot; &quot;Tr Disch (Late)&quot; &quot;' 

. forvalues i = 1/3 {
  2. cap drop sum_*
  3.         gettoken title ttl: ttl
  4. cap qui egen sum_`i' = total(_t) if motivodeegreso_mod_imp_rec3==`i'
  5. cap qui tab _d motivodeegreso_mod_imp_rec3 if _d==1 &amp; motivodeegreso_mod_imp_rec3==`i'
  6. scalar n_eventos`i' =r(N)
  7. qui tabstat sum_`i', save
  8. scalar sum_`i'_total =r(StatTotal)[1,1]
  9. scalar ir_t = round((n_eventos`i'/sum_`i'_total)*1000,.1)
 10. *di ir_t
. *es numérico, para no generar incompatibilidad, se pasa a escalar
. global dens_inc`i' &quot;Incidence rate ratio for `title' (`i') (x1,000 person-days):  `=scalar(ir_t)'&quot;
 11. *di %9.1f (n_eventos`i'/sum_`i'_total)*1000
. }

</code></pre>
<ul>
<li>
<p>Incidence rate ratio for Tr Completion (1) (x1,000 person-days):  4.600000000000001</p>
</li>
<li>
<p>Incidence rate ratio for Tr Disch (Early) (2) (x1,000 person-days):  10.5</p>
</li>
<li>
<p>Incidence rate ratio for Tr Disch (Late) (3) (x1,000 person-days):  8.800000000000001</p>
</li>
</ul>
<p>We recode the discharge cause to contrast them</p>
<pre><code>. cap noi recode motivodeegreso_mod_imp_rec3 (1=0 &quot;Tr Completion&quot; ) ///
&gt;                          (2=1 &quot;Early Disch&quot;) ///
&gt;                          (else=.), gen(tto_2_1)
(70863 differences between motivodeegreso_mod_imp_rec3 and tto_2_1)

. cap noi recode motivodeegreso_mod_imp_rec3 (1=0 &quot;Tr Completion&quot; ) ///
&gt;                          (3=1 &quot;Late Disch&quot;) ///
&gt;                          (else=.), gen(tto_3_1)
(70863 differences between motivodeegreso_mod_imp_rec3 and tto_3_1)

. cap noi recode motivodeegreso_mod_imp_rec3 (2=0 &quot;Early Disch&quot; ) ///
&gt;                          (3=1 &quot;Late Disch&quot;) ///
&gt;                          (else=.), gen(tto_3_2)
(70863 differences between motivodeegreso_mod_imp_rec3 and tto_3_2)

</code></pre>
<p>We explored the inicidence rate ratios (IRR) of each cause of discharge.</p>
<pre><code>. 
. *set trace on
. local stname `&quot; &quot;2_1&quot; &quot;3_1&quot; &quot;3_2&quot; &quot;' 

. local titl `&quot; &quot;Early Disch vs Tr Completion&quot; &quot;Late Disch vs Tr Completion&quot; &quot;Late vs Early Disch&quot; &quot;' 

. foreach s of local stname {
  2.         gettoken title titl: titl
  3. cap noi qui ir _d tto_`s' _t
  4. scalar ir_`s' =round(r(irr),.01)
  5. *di ir_`s'
. scalar ir_`s'_lb =round(r(lb_irr),.01) 
  6. *di ir_`s'_lb
. scalar ir_`s'_ub =round(r(ub_irr),.01)
  7. *di ir_`s'_ub
. local ir1= ir_`s'
  8. local ir2= ir_`s'_lb
  9. local ir3= ir_`s'_ub
 10. *di  in gr _col(13) &quot; `title': IRR `ir1' (IC 95% `ir2' - `ir3') &quot;
. global irr_`s' &quot; `title': IRR `ir1' (IC 95% `ir2' - `ir3') &quot;
 11. global ir_`s' &quot;`ir1' (IC 95% `ir2' - `ir3')&quot;
 12. }       

</code></pre>
<p>We generated a log-rank test to compare the expected to the observed result, obtaining that:</p>
<ul>
<li>
<p>Early Disch vs Tr Completion: IRR 2.3 (IC 95% 2.21 - 2.39) , so patients with an Early Discharge had a greater incidence rate than patients in Tr Completion</p>
</li>
<li>
<p>Late Disch vs Tr Completion: IRR 1.91 (IC 95% 1.85 - 1.99) , so patients with a Late Discharge had a greater incidence rate than patients in Tr Completion</p>
</li>
<li>
<p>Late vs Early Disch: IRR .8300000000000001 (IC 95% .8100000000000001 - .86) , so patients with a Late Discharge had a lower incidence rate than patients with an Early Discharge</p>
</li>
</ul>
<pre><code>. *set trace on
. local stname `&quot; &quot;2_1&quot; &quot;3_1&quot; &quot;3_2&quot; &quot;' 

. local titl `&quot; &quot;Early Disch vs Tr Completion&quot; &quot;Late Disch vs Tr Completion&quot; &quot;Late vs Early Disch&quot; &quot;' 

. foreach s of local stname {
  2.         gettoken title titl: titl
  3. cap noi qui sts test tto_`s', logrank
  4. scalar logrank_chi`s'= round(r(chi2),.01)
  5. scalar logrank_df`s'= r(df)
  6. scalar logrank_p_`s'= round(chiprob(r(df),r(chi2)),.001)
  7. local lr1= logrank_chi`s'
  8. local lr2= logrank_df`s'
  9. local lr3= logrank_p_`s'
 10. global logrank_`s' &quot; Chi^2(`lr2')=`lr1',p=`lr3'&quot;
 11. }

. *set trace off
</code></pre>
<ul>
<li>
<p>With a value of  Chi^2(1)=699.0500000000001,p=0, survival curves between patients that had an Early Disch y Tr Completion were significantly different.</p>
</li>
<li>
<p>With a value of  Chi^2(1)=486.13,p=0, survival curves between patients that had an Late Disch y Tr Completion were significantly different.</p>
</li>
<li>
<p>With a value of  Chi^2(1)=87.27,p=0, survival curves between patients that had an Late y Early Disch were significantly different.</p>
</li>
</ul>
<p>=============================================================================</p>
<h2><a href="#graph" id="graph">Graph</a></h2>
<p>=============================================================================</p>
<p>We generated a graph with every type of treatment and the Nelson-Aalen estimate.</p>
<pre><code>. sts graph, na by (motivodeegreso_mod_imp_rec) ci ///
&gt; title(&quot;Comission of an offense (end with imprisonment)&quot;) /// 
&gt; subtitle(&quot;Nelson-Aalen Cum Hazards w/ Confidence Intervals 95%&quot;) ///
&gt; risktable(, size(*.5) order(1 &quot;Tr Completion&quot; 2 &quot;Early Disch&quot; 3 &quot;Late Disch&quot;)) ///
&gt; ytitle(&quot;Cum. Hazards&quot;) ylabel(#8) ///
&gt; xtitle(&quot;Years of age&quot;) xlabel(#8) ///
&gt; note(&quot;Source: nDP, SENDA's SUD Treatments &amp; POs Office Data period 2010-2019 &quot;) ///
&gt; legend(rows(3)) ///
&gt; legend(cols(4)) ///
&gt; graphregion(color(white) lwidth(large)) bgcolor(white) ///
&gt; plotregion(fcolor(white)) graphregion(fcolor(white) ) /// //text(.5 1 &quot;IR = &lt;0.001&quot;) ///
&gt; legend(order(1 &quot;95CI Tr Completion&quot; 2 &quot;Tr Completion&quot; 3 &quot;95CI Early Tr Disch&quot; 4 &quot;Early Tr Disch &quot; 5 &quot;95CI Late Tr Disch&quot; 6 &quot;Late Tr Disch&quot; )size(*.5)region(lstyle(none)) region(c(none)) nobox)

         failure _d:  event == 1
   analysis time _t:  age_offending_imp
  enter on or after:  time edad_al_egres_imp
(note:  named style large not found in class linewidth, default attributes used)
(note:  linewidth not found in scheme, default attributes used)
(note:  named style large not found in class linewidth, default attributes used)
(note:  linewidth not found in scheme, default attributes used)

. graph save &quot;tto.gph&quot;, replace
(file tto.gph saved)

</code></pre>
<p><img src="tto.svg" width="800" ></p>
<p>=============================================================================</p>
<h2><a href="#survival-analyses" id="survival-analyses">Survival Analyses</a></h2>
<p>=============================================================================</p>
<p>We tested the schoefeld residuals.</p>
<pre><code>. *c(&quot;edad_al_ing_fmt&quot;, &quot;edad_ini_cons&quot;, &quot;dias_treat_imp_sin_na_1&quot;, &quot;escolaridad_rec&quot;, &quot;sus_principal_mod&quot;, &quot;freq_cons_sus_prin&quot;, &quot;compromiso_biopsicosocial&quot;, &quot;tenencia_de_la_vivienda_mod&quot;, &quot;dg_cie_10_rec&quot;, &quot;dg_t
&gt; rs_cons_sus_or&quot;, &quot;macrozona&quot;, &quot;policonsumo&quot;, &quot;n_prev_off&quot;, &quot;n_off_vio&quot;, &quot;n_off_acq&quot;, &quot;n_off_sud&quot;, &quot;n_off_oth&quot;)
. 
. global sim 1e5 //5e1 1e5 

. global boots 1e3 //5e1 2e3

. global times 0 90 365 1096 1826

. range timevar0 90 1826 90
(70,773 missing values generated)

. 
. global covs &quot;edad_al_ing_fmt edad_ini_cons dias_treat_imp_sin_na_1 sex esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec sud_severity_icd10 macrozone poli
&gt; consumo n_off_vio n_off_acq n_off_sud clas&quot;

. global covs_2 &quot;motivodeegreso_mod_imp_rec3 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec sud_severity_icd10 macr
&gt; ozone policonsumo n_off_vio n_off_acq n_off_sud clas&quot;

. 
. 
. stcox  $covs_2 , efron robust nolog schoenfeld(sch*) scaledsch(sca*)

         failure _d:  event == 1
   analysis time _t:  age_offending_imp
  enter on or after:  time edad_al_egres_imp

Cox regression -- Efron method for ties

No. of subjects      =       59,220             Number of obs    =      59,220
No. of failures      =       17,434
Time at risk         =  178984.6064
                                                Wald chi2(19)    =     4185.49
Log pseudolikelihood =   -144349.14             Prob &gt; chi2      =      0.0000

---------------------------------------------------------------------------------------------
                            |               Robust
                         _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
motivodeegreso_mod_imp_rec3 |   1.157701   .0117956    14.37   0.000     1.134811    1.181052
            edad_al_ing_fmt |   1.094689   .0057912    17.10   0.000     1.083397    1.106098
              edad_ini_cons |   .9921283   .0019851    -3.95   0.000     .9882452    .9960267
                    sex_enc |   .7197874   .0154752   -15.29   0.000     .6900868    .7507663
                    esc_rec |   1.110249   .0144442     8.04   0.000     1.082297    1.138923
               sus_prin_mod |   1.136602   .0096759    15.04   0.000     1.117795    1.155726
                fr_sus_prin |   1.033993    .008134     4.25   0.000     1.018173    1.050059
                comp_biosoc |   1.210617   .0181223    12.77   0.000     1.175614    1.246663
                    ten_viv |   .9813207   .0080259    -2.31   0.021     .9657157    .9971778
         origen_ingreso_mod |   .9846364   .0045579    -3.34   0.001     .9757435    .9936104
        numero_de_hijos_mod |   1.074929   .0072889    10.66   0.000     1.060738    1.089311
              dg_cie_10_rec |   1.028589   .0095272     3.04   0.002     1.010085    1.047433
         sud_severity_icd10 |   .9381305   .0186401    -3.21   0.001     .9022988    .9753851
                  macrozone |    1.22355   .0155697    15.86   0.000     1.193411    1.254449
                policonsumo |   1.115109   .0253988     4.78   0.000     1.066423    1.166017
                  n_off_vio |   1.325359   .0271506    13.75   0.000     1.273199    1.379656
                  n_off_acq |   1.864078    .035996    32.25   0.000     1.794846    1.935981
                  n_off_sud |   1.218902    .024538     9.83   0.000     1.171745    1.267957
                       clas |   1.014576   .0138066     1.06   0.288     .9878733    1.042001
---------------------------------------------------------------------------------------------

. estat phtest, log detail

      Test of proportional-hazards assumption

      Time:  Log(t)
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob&gt;chi2
      ------------+---------------------------------------------------
      motivodeeg~3|      0.01015         1.84        1         0.1753
      edad_al_in~t|     -0.02505        30.40        1         0.0000
      edad_ini_c~s|      0.00262         0.14        1         0.7115
      sex_enc     |      0.00352         0.25        1         0.6176
      esc_rec     |     -0.01921         7.08        1         0.0078
      sus_prin_mod|     -0.00618         0.66        1         0.4172
      fr_sus_prin |     -0.00049         0.00        1         0.9469
      comp_biosoc |     -0.01265         3.14        1         0.0762
      ten_viv     |      0.01387         3.97        1         0.0463
      origen_ing~d|      0.02354        10.53        1         0.0012
      numero_de_~d|     -0.01958         7.39        1         0.0066
      dg_cie_10_~c|      0.01138         2.46        1         0.1170
      sud_sever~10|      0.02084         8.04        1         0.0046
      macrozone   |      0.00279         0.15        1         0.6973
      policonsumo |      0.01935         7.40        1         0.0065
      n_off_vio   |      0.04004        34.24        1         0.0000
      n_off_acq   |      0.02608        15.00        1         0.0001
      n_off_sud   |      0.02092         9.42        1         0.0021
      clas        |     -0.01748         6.00        1         0.0143
      ------------+---------------------------------------------------
      global test |                    158.89       19         0.0000
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

. scalar chi2_scho_test = r(chi2)

.  
. mat mat_scho_test = r(phtest)

. 
. esttab matrix(mat_scho_test) using &quot;mat_scho_test.csv&quot;, replace
(output written to mat_scho_test.csv)

. esttab matrix(mat_scho_test) using &quot;mat_scho_test.html&quot;, replace
(output written to mat_scho_test.html)

. 
</code></pre>
<table border="0" width="*">
<tr><td colspan=5><hr></td></tr>
<tr><td>            </td><td>mat_scho_test</td><td>            </td><td>            </td><td>            </td></tr>
<tr><td>            </td><td>         rho</td><td>        chi2</td><td>          df</td><td>           p</td></tr>
<tr><td colspan=5><hr></td></tr>
<tr><td>motivodeegreso_mod_imp_rec3</td><td>    .0101508</td><td>    1.837147</td><td>           1</td><td>    .1752857</td></tr>
<tr><td>edad_al_ing_fmt</td><td>   -.0250491</td><td>    30.40329</td><td>           1</td><td>    3.51e-08</td></tr>
<tr><td>edad_ini_cons</td><td>    .0026239</td><td>    .1367979</td><td>           1</td><td>    .7114853</td></tr>
<tr><td>sex_enc     </td><td>    .0035233</td><td>    .2492266</td><td>           1</td><td>    .6176202</td></tr>
<tr><td>esc_rec     </td><td>    -.019205</td><td>    7.082826</td><td>           1</td><td>    .0077826</td></tr>
<tr><td>sus_prin_mod</td><td>   -.0061844</td><td>    .6581664</td><td>           1</td><td>     .417208</td></tr>
<tr><td>fr_sus_prin </td><td>   -.0004903</td><td>    .0044371</td><td>           1</td><td>    .9468912</td></tr>
<tr><td>comp_biosoc </td><td>   -.0126459</td><td>    3.144763</td><td>           1</td><td>    .0761711</td></tr>
<tr><td>ten_viv     </td><td>    .0138657</td><td>    3.969955</td><td>           1</td><td>     .046319</td></tr>
<tr><td>origen_ingreso_mod</td><td>     .023539</td><td>     10.5337</td><td>           1</td><td>    .0011722</td></tr>
<tr><td>numero_de_hijos_mod</td><td>   -.0195809</td><td>    7.387599</td><td>           1</td><td>    .0065675</td></tr>
<tr><td>dg_cie_10_rec</td><td>    .0113786</td><td>    2.457243</td><td>           1</td><td>     .116984</td></tr>
<tr><td>sud_severity_icd10</td><td>    .0208421</td><td>     8.04215</td><td>           1</td><td>    .0045701</td></tr>
<tr><td>macrozone   </td><td>    .0027937</td><td>     .151251</td><td>           1</td><td>    .6973428</td></tr>
<tr><td>policonsumo </td><td>    .0193515</td><td>    7.396096</td><td>           1</td><td>    .0065366</td></tr>
<tr><td>n_off_vio   </td><td>    .0400434</td><td>    34.23805</td><td>           1</td><td>    4.88e-09</td></tr>
<tr><td>n_off_acq   </td><td>    .0260755</td><td>    14.99996</td><td>           1</td><td>    .0001075</td></tr>
<tr><td>n_off_sud   </td><td>    .0209172</td><td>    9.422821</td><td>           1</td><td>     .002143</td></tr>
<tr><td>clas        </td><td>   -.0174834</td><td>    5.997667</td><td>           1</td><td>    .0143248</td></tr>
<tr><td colspan=5><hr></td></tr>
</table>
<pre><code>. /*
&gt; stphplot, by(n_off_vio) adjust($covs_health) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: Fourth transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_4, replace)  ///
&gt;         saving(stphplot_trans_4.gph, replace)
&gt; */
. 
</code></pre>
<p>We generated a list of parametric survival models with different distributions (Exponential, Weibull, Gompertz, Log-logistic, Log-normal &amp; Generalized gamma). Aditionally, we defined a series of Royston-Parmar models with a function of restricted cubic splines, in which the knots (#df -1) are defined in each percentile of the distribution. We saved the estimates in the file called `parmodels_m2_nov_22&rsquo;.</p>
<pre><code>. *Hannah Bower, Michael J. Crowther, Mark J. Rutherford, Therese M.-L. Andersson, Mark Clements, Xing-Rong Liu, Paul W. Dickman &amp; Paul C. Lambert (2021) Capturing simple and complex time-dependent effects using 
&gt; flexible parametric survival models: A simulation study, Communications in Statistics - Simulation and Computation, 50:11, 3777-3793, DOI: 10.1080/03610918.2019.1634201
. *can be used in case of nonproportional hazards
. *Our usualstarting point is to use 5 degrees of freedom for the baseline and 3 degrees of freedomfor any time-dependent effects
. *The results presented indicate that restricted cubic splines accurately capture time-dependent effects if appropriate degrees of freedom are selected; these results are con-sistent with the findings of Rutherf
&gt; ord et al. (Rutherford, Crowther, and Lambert2015)for proportional-hazards models
.                 // Cox w/tvc
.         forvalues j=1/7 {
  2.                 di in yellow &quot;{bf: ***********}&quot;
  3.                 di in yellow &quot;{bf: family Cox tvc `j'}&quot;
  4.                 di in yellow &quot;{bf: ***********}&quot;
  5.                 set seed 2125
  6.                 qui cap noi stmerlin $covs_2 , dist(exponential) tvc(motivodeegreso_mod_imp_rec3) dftvc(`j')
  7.                 estimates store m2_1_cox`j'     
  8.         }
 ***********
 family Cox tvc 1
 ***********
note; a delayed entry model is being fitted
variables created for model 1, component 20: _cmp_1_20_1 to _cmp_1_20_1

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood = -56192.772  
Iteration 2:   log likelihood = -54617.563  
Iteration 3:   log likelihood =  -53747.11  
Iteration 4:   log likelihood = -53738.093  
Iteration 5:   log likelihood =  -53738.09  

Survival model                                  Number of obs     =     59,220
Log likelihood =  -53738.09
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1100791   .0100435    10.96   0.000     .0903943     .129764
edad_al_in~t |  -.0066569   .0018201    -3.66   0.000    -.0102242   -.0030896
edad_ini_c~s |  -.0106906   .0018727    -5.71   0.000    -.0143611     -.00702
     sex_enc |  -.3399611   .0202528   -16.79   0.000    -.3796559   -.3002663
     esc_rec |   .0895888   .0123003     7.28   0.000     .0654806     .113697
sus_prin_mod |   .1333166   .0081772    16.30   0.000     .1172896    .1493436
 fr_sus_prin |   .0323919   .0075638     4.28   0.000     .0175671    .0472167
 comp_biosoc |   .1973851   .0141762    13.92   0.000     .1696002      .22517
     ten_viv |  -.0148572   .0076397    -1.94   0.052    -.0298307    .0001164
origen_ing~d |  -.0208054   .0044055    -4.72   0.000    -.0294399   -.0121708
numero_de_~d |   .0772304   .0062892    12.28   0.000     .0649038    .0895571
dg_cie_10_~c |   .0283485   .0087539     3.24   0.001     .0111912    .0455058
sud_sever~10 |  -.0651013   .0191644    -3.40   0.001    -.1026627   -.0275398
   macrozone |   .2070233   .0118067    17.53   0.000     .1838826    .2301639
 policonsumo |    .099952    .021688     4.61   0.000     .0574444    .1424596
   n_off_vio |   .3117092   .0187102    16.66   0.000     .2750378    .3483805
   n_off_acq |   .6647279   .0174456    38.10   0.000     .6305352    .6989206
   n_off_sud |   .2303506   .0183748    12.54   0.000     .1943366    .2663645
        clas |   .0152441   .0128278     1.19   0.235    -.0098979    .0403861
motivodeeg~( |  -.1436768   .0072408   -19.84   0.000    -.1578684   -.1294852
       _cons |  -3.528104   .1107786   -31.85   0.000    -3.745226   -3.310982
------------------------------------------------------------------------------
 ***********
 family Cox tvc 2
 ***********
note; a delayed entry model is being fitted
variables created for model 1, component 20: _cmp_1_20_1 to _cmp_1_20_2

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood = -56176.699  
Iteration 2:   log likelihood = -54566.426  
Iteration 3:   log likelihood = -53724.072  
Iteration 4:   log likelihood = -53715.071  
Iteration 5:   log likelihood = -53715.068  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53715.068
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .0962532   .0103064     9.34   0.000      .076053    .1164533
edad_al_in~t |  -.0008137   .0020236    -0.40   0.688      -.00478    .0031525
edad_ini_c~s |  -.0107247   .0018826    -5.70   0.000    -.0144146   -.0070348
     sex_enc |  -.3366377   .0202674   -16.61   0.000    -.3763611   -.2969143
     esc_rec |   .0975311   .0123572     7.89   0.000     .0733115    .1217508
sus_prin_mod |   .1334465   .0081892    16.30   0.000      .117396    .1494971
 fr_sus_prin |   .0336932   .0075626     4.46   0.000     .0188708    .0485157
 comp_biosoc |   .1972445   .0141791    13.91   0.000     .1694541     .225035
     ten_viv |  -.0169901   .0076424    -2.22   0.026     -.031969   -.0020112
origen_ing~d |  -.0201699   .0044054    -4.58   0.000    -.0288042   -.0115356
numero_de_~d |   .0725386   .0063395    11.44   0.000     .0601134    .0849639
dg_cie_10_~c |    .028419   .0087513     3.25   0.001     .0112667    .0455713
sud_sever~10 |  -.0622947   .0191693    -3.25   0.001    -.0998658   -.0247237
   macrozone |   .2093385   .0118094    17.73   0.000     .1861926    .2324844
 policonsumo |   .0938665   .0216911     4.33   0.000     .0513528    .1363802
   n_off_vio |   .3124821   .0187047    16.71   0.000     .2758217    .3491426
   n_off_acq |   .6657648   .0174335    38.19   0.000     .6315958    .6999338
   n_off_sud |   .2253996   .0183836    12.26   0.000     .1893685    .2614308
        clas |   .0160407   .0128311     1.25   0.211    -.0091078    .0411893
motivodeeg~( |  -.1825635   .0093717   -19.48   0.000    -.2009317   -.1641952
motivodeeg~( |   .0268617   .0040163     6.69   0.000       .01899    .0347335
       _cons |  -3.739064   .1155586   -32.36   0.000    -3.965555   -3.512574
------------------------------------------------------------------------------
 ***********
 family Cox tvc 3
 ***********
note; a delayed entry model is being fitted
variables created for model 1, component 20: _cmp_1_20_1 to _cmp_1_20_3

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood =  -56169.86  
Iteration 2:   log likelihood = -54540.614  
Iteration 3:   log likelihood = -53694.399  
Iteration 4:   log likelihood = -53685.669  
Iteration 5:   log likelihood = -53685.666  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53685.666
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .0880699   .0104342     8.44   0.000     .0676194    .1085205
edad_al_in~t |   .0009982   .0020608     0.48   0.628    -.0030409    .0050373
edad_ini_c~s |  -.0106505   .0018891    -5.64   0.000     -.014353   -.0069479
     sex_enc |  -.3342085   .0202705   -16.49   0.000    -.3739378   -.2944791
     esc_rec |    .097914   .0123465     7.93   0.000     .0737152    .1221128
sus_prin_mod |    .132189   .0081848    16.15   0.000      .116147     .148231
 fr_sus_prin |   .0329908   .0075624     4.36   0.000     .0181687     .047813
 comp_biosoc |   .1955378   .0141827    13.79   0.000     .1677402    .2233353
     ten_viv |  -.0164912   .0076402    -2.16   0.031    -.0314657   -.0015168
origen_ing~d |  -.0201221   .0044053    -4.57   0.000    -.0287564   -.0114878
numero_de_~d |   .0705645   .0063426    11.13   0.000     .0581333    .0829957
dg_cie_10_~c |   .0279343   .0087519     3.19   0.001     .0107808    .0450878
sud_sever~10 |  -.0662846   .0191758    -3.46   0.001    -.1038686   -.0287007
   macrozone |   .2094656   .0118113    17.73   0.000     .1863159    .2326153
 policonsumo |   .0906968   .0216615     4.19   0.000     .0482411    .1331526
   n_off_vio |   .3132012   .0187028    16.75   0.000     .2765444    .3498579
   n_off_acq |   .6666556   .0174292    38.25   0.000      .632495    .7008161
   n_off_sud |   .2291287   .0183859    12.46   0.000      .193093    .2651644
        clas |   .0144839    .012833     1.13   0.259    -.0106682     .039636
motivodeeg~( |  -.2032412   .0100004   -20.32   0.000    -.2228415   -.1836408
motivodeeg~( |   .0457709   .0048401     9.46   0.000     .0362845    .0552573
motivodeeg~( |   .0266095   .0033098     8.04   0.000     .0201224    .0330965
       _cons |  -3.781897   .1161597   -32.56   0.000    -4.009566   -3.554229
------------------------------------------------------------------------------
 ***********
 family Cox tvc 4
 ***********
note; a delayed entry model is being fitted
variables created for model 1, component 20: _cmp_1_20_1 to _cmp_1_20_4

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood = -56168.308  
Iteration 2:   log likelihood = -54538.948  
Iteration 3:   log likelihood = -53690.473  
Iteration 4:   log likelihood = -53681.682  
Iteration 5:   log likelihood = -53681.679  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53681.679
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .0854828   .0105028     8.14   0.000     .0648977    .1060679
edad_al_in~t |   .0014642   .0020747     0.71   0.480     -.002602    .0055304
edad_ini_c~s |  -.0106986   .0018904    -5.66   0.000    -.0144037   -.0069934
     sex_enc |  -.3339763   .0202727   -16.47   0.000      -.37371   -.2942427
     esc_rec |   .0976841   .0123455     7.91   0.000     .0734873    .1218809
sus_prin_mod |   .1327392   .0081876    16.21   0.000     .1166918    .1487865
 fr_sus_prin |   .0331421   .0075635     4.38   0.000     .0183179    .0479663
 comp_biosoc |    .195478   .0141816    13.78   0.000     .1676826    .2232734
     ten_viv |  -.0165165   .0076389    -2.16   0.031    -.0314885   -.0015445
origen_ing~d |  -.0200516   .0044055    -4.55   0.000    -.0286862    -.011417
numero_de_~d |   .0706499    .006343    11.14   0.000     .0582178     .083082
dg_cie_10_~c |    .027796   .0087522     3.18   0.001      .010642    .0449501
sud_sever~10 |  -.0662207   .0191762    -3.45   0.001    -.1038054   -.0286361
   macrozone |   .2095108   .0118126    17.74   0.000     .1863586     .232663
 policonsumo |   .0896687    .021656     4.14   0.000     .0472238    .1321136
   n_off_vio |   .3124339   .0187063    16.70   0.000     .2757702    .3490975
   n_off_acq |   .6659023   .0174337    38.20   0.000     .6317329    .7000716
   n_off_sud |    .228662   .0183871    12.44   0.000     .1926239    .2647002
        clas |   .0145108   .0128336     1.13   0.258    -.0106426    .0396642
motivodeeg~( |  -.2091504   .0103253   -20.26   0.000    -.2293877    -.188913
motivodeeg~( |   .0507359   .0052925     9.59   0.000     .0403627     .061109
motivodeeg~( |      .0306   .0036068     8.48   0.000     .0235309    .0376691
motivodeeg~( |   .0149569   .0035645     4.20   0.000     .0079705    .0219432
       _cons |  -3.796507   .1164429   -32.60   0.000    -4.024731   -3.568283
------------------------------------------------------------------------------
 ***********
 family Cox tvc 5
 ***********
note; a delayed entry model is being fitted
variables created for model 1, component 20: _cmp_1_20_1 to _cmp_1_20_5

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood = -56168.449  
Iteration 2:   log likelihood = -54537.972  
Iteration 3:   log likelihood = -53685.162  
Iteration 4:   log likelihood =  -53676.55  
Iteration 5:   log likelihood = -53676.547  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53676.547
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .0829749   .0105574     7.86   0.000     .0622827    .1036671
edad_al_in~t |   .0018633   .0020844     0.89   0.371    -.0022221    .0059488
edad_ini_c~s |  -.0106672   .0018909    -5.64   0.000    -.0143733   -.0069612
     sex_enc |  -.3342281    .020274   -16.49   0.000    -.3739644   -.2944918
     esc_rec |   .0979612    .012348     7.93   0.000     .0737596    .1221628
sus_prin_mod |   .1331604   .0081864    16.27   0.000     .1171153    .1492054
 fr_sus_prin |   .0333192   .0075626     4.41   0.000     .0184968    .0481417
 comp_biosoc |   .1952223   .0141811    13.77   0.000     .1674278    .2230168
     ten_viv |  -.0164721   .0076385    -2.16   0.031    -.0314434   -.0015009
origen_ing~d |  -.0199471   .0044058    -4.53   0.000    -.0285823   -.0113118
numero_de_~d |   .0705294    .006343    11.12   0.000     .0580974    .0829614
dg_cie_10_~c |   .0277089   .0087525     3.17   0.002     .0105544    .0448634
sud_sever~10 |  -.0664629   .0191777    -3.47   0.001    -.1040504   -.0288753
   macrozone |   .2092074    .011814    17.71   0.000     .1860525    .2323624
 policonsumo |   .0892745   .0216494     4.12   0.000     .0468425    .1317066
   n_off_vio |   .3126047   .0187065    16.71   0.000     .2759406    .3492688
   n_off_acq |   .6663753   .0174344    38.22   0.000     .6322045     .700546
   n_off_sud |   .2284638   .0183866    12.43   0.000     .1924266    .2645009
        clas |   .0145247   .0128329     1.13   0.258    -.0106273    .0396768
motivodeeg~( |  -.2148925   .0105713   -20.33   0.000    -.2356119   -.1941732
motivodeeg~( |   .0560323    .005649     9.92   0.000     .0449605    .0671042
motivodeeg~( |   .0319016   .0035116     9.08   0.000     .0250191    .0387841
motivodeeg~( |   .0214929   .0037074     5.80   0.000     .0142265    .0287592
motivodeeg~( |   .0164332   .0037971     4.33   0.000      .008991    .0238753
       _cons |  -3.810225   .1166368   -32.67   0.000    -4.038828   -3.581621
------------------------------------------------------------------------------
 ***********
 family Cox tvc 6
 ***********
note; a delayed entry model is being fitted
variables created for model 1, component 20: _cmp_1_20_1 to _cmp_1_20_6

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood = -56167.468  
Iteration 2:   log likelihood = -54537.817  
Iteration 3:   log likelihood = -53678.808  
Iteration 4:   log likelihood = -53670.283  
Iteration 5:   log likelihood =  -53670.28  

Survival model                                  Number of obs     =     59,220
Log likelihood =  -53670.28
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |    .080559   .0106071     7.59   0.000     .0597694    .1013486
edad_al_in~t |   .0021373   .0020921     1.02   0.307    -.0019631    .0062377
edad_ini_c~s |  -.0106254   .0018912    -5.62   0.000     -.014332   -.0069188
     sex_enc |  -.3337682   .0202734   -16.46   0.000    -.3735034   -.2940331
     esc_rec |   .0980084   .0123499     7.94   0.000      .073803    .1222138
sus_prin_mod |   .1330421   .0081877    16.25   0.000     .1169944    .1490897
 fr_sus_prin |   .0333449   .0075633     4.41   0.000     .0185211    .0481687
 comp_biosoc |   .1954224   .0141812    13.78   0.000     .1676278    .2232171
     ten_viv |  -.0165374   .0076383    -2.17   0.030    -.0315083   -.0015665
origen_ing~d |  -.0200075   .0044057    -4.54   0.000    -.0286425   -.0113724
numero_de_~d |   .0706481   .0063435    11.14   0.000     .0582151     .083081
dg_cie_10_~c |   .0277172   .0087523     3.17   0.002      .010563    .0448714
sud_sever~10 |  -.0660242   .0191775    -3.44   0.001    -.1036113    -.028437
   macrozone |   .2090794   .0118138    17.70   0.000     .1859247    .2322342
 policonsumo |   .0881746   .0216457     4.07   0.000     .0457499    .1305993
   n_off_vio |   .3119013   .0187076    16.67   0.000      .275235    .3485675
   n_off_acq |   .6660911   .0174353    38.20   0.000     .6319185    .7002638
   n_off_sud |    .227687   .0183877    12.38   0.000     .1916478    .2637262
        clas |   .0141689   .0128326     1.10   0.270    -.0109826    .0393203
motivodeeg~( |  -.2198295    .010771   -20.41   0.000    -.2409402   -.1987187
motivodeeg~( |   .0606415   .0059353    10.22   0.000     .0490084    .0722745
motivodeeg~( |   .0334829   .0035229     9.50   0.000      .026578    .0403877
motivodeeg~( |   .0249072     .00363     6.86   0.000     .0177925    .0320219
motivodeeg~( |    .019295   .0038477     5.01   0.000     .0117536    .0268363
motivodeeg~( |   .0205031    .003982     5.15   0.000     .0126985    .0283077
       _cons |   -3.81837    .116798   -32.69   0.000     -4.04729    -3.58945
------------------------------------------------------------------------------
 ***********
 family Cox tvc 7
 ***********
note; a delayed entry model is being fitted
variables created for model 1, component 20: _cmp_1_20_1 to _cmp_1_20_7

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood = -56167.187  
Iteration 2:   log likelihood = -54538.893  
Iteration 3:   log likelihood = -53678.445  
Iteration 4:   log likelihood = -53669.847  
Iteration 5:   log likelihood = -53669.843  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53669.843
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .0797961   .0106366     7.50   0.000     .0589487    .1006435
edad_al_in~t |   .0022498   .0020958     1.07   0.283    -.0018579    .0063575
edad_ini_c~s |  -.0106183   .0018913    -5.61   0.000    -.0143253   -.0069113
     sex_enc |  -.3336873   .0202734   -16.46   0.000    -.3734225   -.2939521
     esc_rec |   .0979691   .0123504     7.93   0.000     .0737627    .1221755
sus_prin_mod |     .13299   .0081878    16.24   0.000     .1169422    .1490378
 fr_sus_prin |   .0333729   .0075633     4.41   0.000      .018549    .0481967
 comp_biosoc |   .1954143   .0141818    13.78   0.000     .1676185    .2232101
     ten_viv |  -.0165977   .0076383    -2.17   0.030    -.0315685   -.0016269
origen_ing~d |  -.0199966   .0044057    -4.54   0.000    -.0286316   -.0113615
numero_de_~d |   .0706475   .0063436    11.14   0.000     .0582144    .0830807
dg_cie_10_~c |   .0276959   .0087522     3.16   0.002     .0105419    .0448498
sud_sever~10 |  -.0658244   .0191781    -3.43   0.001    -.1034127   -.0282361
   macrozone |   .2091213   .0118139    17.70   0.000     .1859665    .2322761
 policonsumo |   .0880796   .0216443     4.07   0.000     .0456576    .1305017
   n_off_vio |   .3117621   .0187079    16.66   0.000     .2750953    .3484288
   n_off_acq |   .6660657   .0174353    38.20   0.000     .6318931    .7002383
   n_off_sud |   .2276478   .0183876    12.38   0.000     .1916088    .2636868
        clas |   .0141702   .0128323     1.10   0.269    -.0109807    .0393211
motivodeeg~( |  -.2217029   .0109057   -20.33   0.000    -.2430777   -.2003281
motivodeeg~( |   .0623906    .006149    10.15   0.000     .0503387    .0744424
motivodeeg~( |   .0328557   .0034727     9.46   0.000     .0260493    .0396621
motivodeeg~( |   .0265502    .003618     7.34   0.000     .0194589    .0336414
motivodeeg~( |    .018377    .003705     4.96   0.000     .0111154    .0256386
motivodeeg~( |   .0217234   .0039627     5.48   0.000     .0139567    .0294902
motivodeeg~( |   .0163984   .0041481     3.95   0.000     .0082682    .0245286
       _cons |  -3.822013   .1168728   -32.70   0.000     -4.05108   -3.592946
------------------------------------------------------------------------------

. 
.         // Gompertz
.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         di in yellow &quot;{bf: family Gomp}&quot;
 family Gomp

.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         set seed 2125

.         qui cap noi stmerlin $covs_2 , dist(gompertz)
note; a delayed entry model is being fitted

Fitting full model:

Iteration 0:   log likelihood =  -19759395  
Iteration 1:   log likelihood =  -97296.92  
Iteration 2:   log likelihood =  -57439.95  
Iteration 3:   log likelihood =  -53609.97  
Iteration 4:   log likelihood = -53130.964  
Iteration 5:   log likelihood = -53129.792  
Iteration 6:   log likelihood = -53129.791  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53129.791
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1470479   .0098382    14.95   0.000     .1277655    .1663304
edad_al_in~t |   .0902168   .0029856    30.22   0.000     .0843651    .0960685
edad_ini_c~s |  -.0079616   .0018953    -4.20   0.000    -.0116763   -.0042469
     sex_enc |  -.3320573   .0202577   -16.39   0.000    -.3717617    -.292353
     esc_rec |   .1026632   .0123037     8.34   0.000     .0785485     .126778
sus_prin_mod |   .1284074   .0082378    15.59   0.000     .1122616    .1445533
 fr_sus_prin |   .0334974   .0075714     4.42   0.000     .0186577     .048337
 comp_biosoc |    .193254   .0141889    13.62   0.000     .1654443    .2210636
     ten_viv |  -.0186981   .0076212    -2.45   0.014    -.0336354   -.0037609
origen_ing~d |  -.0154941   .0044065    -3.52   0.000    -.0241308   -.0068575
numero_de_~d |   .0750463   .0062959    11.92   0.000     .0627065    .0873861
dg_cie_10_~c |   .0285421   .0088001     3.24   0.001     .0112941      .04579
sud_sever~10 |  -.0617418    .019176    -3.22   0.001    -.0993261   -.0241576
   macrozone |    .201417    .011822    17.04   0.000     .1782462    .2245878
 policonsumo |   .1161781   .0216177     5.37   0.000     .0738082    .1585479
   n_off_vio |   .2801475   .0187109    14.97   0.000     .2434749    .3168201
   n_off_acq |   .6213429   .0174216    35.67   0.000     .5871973    .6554885
   n_off_sud |   .1966054   .0183718    10.70   0.000     .1605974    .2326134
        clas |   .0162043   .0128147     1.26   0.206    -.0089121    .0413207
       _cons |  -2.108511   .0974908   -21.63   0.000    -2.299589   -1.917432
       gamma |  -.1297837   .0029463   -44.05   0.000    -.1355584    -.124009
------------------------------------------------------------------------------

.         //qui cap noi merlin (_time $covs if _trans == 1, family(gompertz, fail(_status)))
.         estimates store m2_1_gom

. 
.         // Weibull
.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         di in yellow &quot;{bf: family Weibull}&quot;
 family Weibull

.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         set seed 2125

.         qui cap noi stmerlin $covs_2 , dist(weibull)
note; a delayed entry model is being fitted

Fitting full model:

Iteration 0:   log likelihood = -178984.61  
Iteration 1:   log likelihood = -56419.676  (not concave)
Iteration 2:   log likelihood = -54897.965  
Iteration 3:   log likelihood = -53991.018  
Iteration 4:   log likelihood = -53859.462  
Iteration 5:   log likelihood = -53833.771  
Iteration 6:   log likelihood = -53772.169  
Iteration 7:   log likelihood =  -53759.31  
Iteration 8:   log likelihood = -53729.607  (not concave)
Iteration 9:   log likelihood = -53726.435  
Iteration 10:  log likelihood = -53723.713  
Iteration 11:  log likelihood = -53698.965  (not concave)
Iteration 12:  log likelihood = -53697.845  
Iteration 13:  log likelihood = -53690.228  
Iteration 14:  log likelihood = -53681.598  
Iteration 15:  log likelihood =  -53667.57  
Iteration 16:  log likelihood = -53658.166  
Iteration 17:  log likelihood = -53651.759  
Iteration 18:  log likelihood = -53649.551  
Iteration 19:  log likelihood = -53647.362  
Iteration 20:  log likelihood = -53646.403  
Iteration 21:  log likelihood = -53646.271  
Iteration 22:  log likelihood = -53645.781  
Iteration 23:  log likelihood = -53645.721  
Iteration 24:  log likelihood =   -53645.7  
Iteration 25:  log likelihood = -53645.695  
Iteration 26:  log likelihood = -53645.694  
Iteration 27:  log likelihood = -53645.694  
Iteration 28:  log likelihood = -53645.694  (not concave)
Iteration 29:  log likelihood = -53645.694  (not concave)
Iteration 30:  log likelihood = -53645.694  (not concave)
Iteration 31:  log likelihood = -53645.694  (not concave)
Iteration 32:  log likelihood = -53645.694  (not concave)
Iteration 33:  log likelihood = -53645.694  (not concave)
Iteration 34:  log likelihood = -53645.694  (not concave)
Iteration 35:  log likelihood = -53645.694  (not concave)
Iteration 36:  log likelihood = -53645.694  (not concave)
Iteration 37:  log likelihood = -53645.694  (not concave)
Iteration 38:  log likelihood = -53645.694  (not concave)
Iteration 39:  log likelihood = -53645.694  (not concave)
Iteration 40:  log likelihood = -53645.694  (not concave)
Iteration 41:  log likelihood = -53645.694  (not concave)
Iteration 42:  log likelihood = -53645.694  (not concave)
Iteration 43:  log likelihood = -53645.694  (not concave)
Iteration 44:  log likelihood = -53645.694  (not concave)
Iteration 45:  log likelihood = -53645.694  (not concave)
Iteration 46:  log likelihood = -53645.694  (not concave)
Iteration 47:  log likelihood = -53645.694  (not concave)
Iteration 48:  log likelihood = -53645.694  (not concave)
Iteration 49:  log likelihood = -53645.694  (not concave)
Iteration 50:  log likelihood = -53645.694  (not concave)
Iteration 51:  log likelihood = -53645.694  (not concave)
Iteration 52:  log likelihood = -53645.694  (not concave)
Iteration 53:  log likelihood = -53645.694  (not concave)
Iteration 54:  log likelihood = -53645.694  (not concave)
Iteration 55:  log likelihood = -53645.694  (not concave)
Iteration 56:  log likelihood = -53645.694  (not concave)
Iteration 57:  log likelihood = -53645.694  (not concave)
Iteration 58:  log likelihood = -53645.694  (not concave)
Iteration 59:  log likelihood = -53645.694  (not concave)
Iteration 60:  log likelihood = -53645.694  (not concave)
Iteration 61:  log likelihood = -53645.694  (not concave)
Iteration 62:  log likelihood = -53645.694  (not concave)
Iteration 63:  log likelihood = -53645.694  (not concave)
Iteration 64:  log likelihood = -53645.694  (not concave)
Iteration 65:  log likelihood = -53645.694  (not concave)
Iteration 66:  log likelihood = -53645.694  (not concave)
Iteration 67:  log likelihood = -53645.694  (not concave)
Iteration 68:  log likelihood = -53645.694  (not concave)
Iteration 69:  log likelihood = -53645.694  (not concave)
Iteration 70:  log likelihood = -53645.694  (not concave)
Iteration 71:  log likelihood = -53645.694  (not concave)
Iteration 72:  log likelihood = -53645.694  (not concave)
Iteration 73:  log likelihood = -53645.694  (not concave)
Iteration 74:  log likelihood = -53645.694  (not concave)
Iteration 75:  log likelihood = -53645.694  (not concave)
Iteration 76:  log likelihood = -53645.694  (not concave)
Iteration 77:  log likelihood = -53645.694  (not concave)
Iteration 78:  log likelihood = -53645.694  (not concave)
Iteration 79:  log likelihood = -53645.694  (not concave)
Iteration 80:  log likelihood = -53645.694  (not concave)
Iteration 81:  log likelihood = -53645.694  (not concave)
Iteration 82:  log likelihood = -53645.694  (not concave)
Iteration 83:  log likelihood = -53645.694  (not concave)
Iteration 84:  log likelihood = -53645.694  (not concave)
Iteration 85:  log likelihood = -53645.694  (not concave)
Iteration 86:  log likelihood = -53645.694  (not concave)
Iteration 87:  log likelihood = -53645.694  (not concave)
Iteration 88:  log likelihood = -53645.694  (not concave)
Iteration 89:  log likelihood = -53645.694  (not concave)
Iteration 90:  log likelihood = -53645.694  (not concave)
Iteration 91:  log likelihood = -53645.694  (not concave)
Iteration 92:  log likelihood = -53645.694  (not concave)
Iteration 93:  log likelihood = -53645.694  (not concave)
Iteration 94:  log likelihood = -53645.694  (not concave)
Iteration 95:  log likelihood = -53645.694  (not concave)
Iteration 96:  log likelihood = -53645.694  (not concave)
Iteration 97:  log likelihood = -53645.694  (not concave)
Iteration 98:  log likelihood = -53645.694  (not concave)
Iteration 99:  log likelihood = -53645.694  (not concave)
Iteration 100: log likelihood = -53645.694  (not concave)
Iteration 101: log likelihood = -53645.694  (not concave)
Iteration 102: log likelihood = -53645.694  (not concave)
Iteration 103: log likelihood = -53645.694  (not concave)
Iteration 104: log likelihood = -53645.694  (not concave)
Iteration 105: log likelihood = -53645.694  (not concave)
Iteration 106: log likelihood = -53645.694  (not concave)
Iteration 107: log likelihood = -53645.694  (not concave)
Iteration 108: log likelihood = -53645.694  (not concave)
Iteration 109: log likelihood = -53645.694  (not concave)
Iteration 110: log likelihood = -53645.694  (not concave)
Iteration 111: log likelihood = -53645.694  (not concave)
Iteration 112: log likelihood = -53645.694  (not concave)
Iteration 113: log likelihood = -53645.694  (not concave)
Iteration 114: log likelihood = -53645.694  (not concave)
Iteration 115: log likelihood = -53645.694  (not concave)
Iteration 116: log likelihood = -53645.694  (not concave)
Iteration 117: log likelihood = -53645.694  (not concave)
Iteration 118: log likelihood = -53645.694  (not concave)
Iteration 119: log likelihood = -53645.694  (not concave)
Iteration 120: log likelihood = -53645.694  (not concave)
Iteration 121: log likelihood = -53645.694  (not concave)
Iteration 122: log likelihood = -53645.694  (not concave)
Iteration 123: log likelihood = -53645.694  (not concave)
Iteration 124: log likelihood = -53645.694  (not concave)
Iteration 125: log likelihood = -53645.694  (not concave)
Iteration 126: log likelihood = -53645.694  (not concave)
Iteration 127: log likelihood = -53645.694  (not concave)
Iteration 128: log likelihood = -53645.694  (not concave)
Iteration 129: log likelihood = -53645.694  (not concave)
Iteration 130: log likelihood = -53645.694  (not concave)
Iteration 131: log likelihood = -53645.694  (not concave)
Iteration 132: log likelihood = -53645.694  (not concave)
Iteration 133: log likelihood = -53645.694  (not concave)
Iteration 134: log likelihood = -53645.694  (not concave)
Iteration 135: log likelihood = -53645.694  (not concave)
Iteration 136: log likelihood = -53645.694  (not concave)
Iteration 137: log likelihood = -53645.694  (not concave)
Iteration 138: log likelihood = -53645.694  (not concave)
Iteration 139: log likelihood = -53645.694  (not concave)
Iteration 140: log likelihood = -53645.694  (not concave)
Iteration 141: log likelihood = -53645.694  (not concave)
Iteration 142: log likelihood = -53645.694  (not concave)
Iteration 143: log likelihood = -53645.694  (not concave)
Iteration 144: log likelihood = -53645.694  (not concave)
Iteration 145: log likelihood = -53645.694  (not concave)
Iteration 146: log likelihood = -53645.694  (not concave)
Iteration 147: log likelihood = -53645.694  (not concave)
Iteration 148: log likelihood = -53645.694  (not concave)
Iteration 149: log likelihood = -53645.694  (not concave)
Iteration 150: log likelihood = -53645.694  (not concave)
Iteration 151: log likelihood = -53645.694  (not concave)
Iteration 152: log likelihood = -53645.694  (not concave)
Iteration 153: log likelihood = -53645.694  (not concave)
Iteration 154: log likelihood = -53645.694  (not concave)
Iteration 155: log likelihood = -53645.694  (not concave)
Iteration 156: log likelihood = -53645.694  (not concave)
Iteration 157: log likelihood = -53645.694  (not concave)
Iteration 158: log likelihood = -53645.694  (not concave)
Iteration 159: log likelihood = -53645.694  (not concave)
Iteration 160: log likelihood = -53645.694  (not concave)
Iteration 161: log likelihood = -53645.694  (not concave)
Iteration 162: log likelihood = -53645.694  (not concave)
Iteration 163: log likelihood = -53645.694  (not concave)
Iteration 164: log likelihood = -53645.694  (not concave)
Iteration 165: log likelihood = -53645.694  (not concave)
Iteration 166: log likelihood = -53645.694  (not concave)
Iteration 167: log likelihood = -53645.694  (not concave)
Iteration 168: log likelihood = -53645.694  (not concave)
Iteration 169: log likelihood = -53645.694  (not concave)
Iteration 170: log likelihood = -53645.694  (not concave)
Iteration 171: log likelihood = -53645.694  (not concave)
Iteration 172: log likelihood = -53645.694  (not concave)
Iteration 173: log likelihood = -53645.694  (not concave)
Iteration 174: log likelihood = -53645.694  (not concave)
Iteration 175: log likelihood = -53645.694  (not concave)
Iteration 176: log likelihood = -53645.694  (not concave)
Iteration 177: log likelihood = -53645.694  (not concave)
Iteration 178: log likelihood = -53645.694  (not concave)
Iteration 179: log likelihood = -53645.694  (not concave)
Iteration 180: log likelihood = -53645.694  (not concave)
Iteration 181: log likelihood = -53645.694  (not concave)
Iteration 182: log likelihood = -53645.694  (not concave)
Iteration 183: log likelihood = -53645.694  (not concave)
Iteration 184: log likelihood = -53645.694  (not concave)
Iteration 185: log likelihood = -53645.694  (not concave)
Iteration 186: log likelihood = -53645.694  (not concave)
Iteration 187: log likelihood = -53645.694  (not concave)
Iteration 188: log likelihood = -53645.694  (not concave)
Iteration 189: log likelihood = -53645.694  (not concave)
Iteration 190: log likelihood = -53645.694  (not concave)
Iteration 191: log likelihood = -53645.694  (not concave)
Iteration 192: log likelihood = -53645.694  (not concave)
Iteration 193: log likelihood = -53645.694  (not concave)
Iteration 194: log likelihood = -53645.694  (not concave)
Iteration 195: log likelihood = -53645.694  (not concave)
Iteration 196: log likelihood = -53645.694  (not concave)
Iteration 197: log likelihood = -53645.694  (not concave)
Iteration 198: log likelihood = -53645.694  (not concave)
Iteration 199: log likelihood = -53645.694  (not concave)
Iteration 200: log likelihood = -53645.694  (not concave)
Iteration 201: log likelihood = -53645.694  (not concave)
Iteration 202: log likelihood = -53645.694  (not concave)
Iteration 203: log likelihood = -53645.694  (not concave)
Iteration 204: log likelihood = -53645.694  (not concave)
Iteration 205: log likelihood = -53645.694  (not concave)
Iteration 206: log likelihood = -53645.694  (not concave)
Iteration 207: log likelihood = -53645.694  (not concave)
Iteration 208: log likelihood = -53645.694  (not concave)
Iteration 209: log likelihood = -53645.694  (not concave)
Iteration 210: log likelihood = -53645.694  (not concave)
Iteration 211: log likelihood = -53645.694  (not concave)
Iteration 212: log likelihood = -53645.694  (not concave)
Iteration 213: log likelihood = -53645.694  (not concave)
Iteration 214: log likelihood = -53645.694  (not concave)
Iteration 215: log likelihood = -53645.694  (not concave)
Iteration 216: log likelihood = -53645.694  (not concave)
Iteration 217: log likelihood = -53645.694  (not concave)
Iteration 218: log likelihood = -53645.694  (not concave)
Iteration 219: log likelihood = -53645.694  (not concave)
Iteration 220: log likelihood = -53645.694  (not concave)
Iteration 221: log likelihood = -53645.694  (not concave)
Iteration 222: log likelihood = -53645.694  (not concave)
Iteration 223: log likelihood = -53645.694  (not concave)
Iteration 224: log likelihood = -53645.694  (not concave)
Iteration 225: log likelihood = -53645.694  (not concave)
Iteration 226: log likelihood = -53645.694  (not concave)
Iteration 227: log likelihood = -53645.694  (not concave)
Iteration 228: log likelihood = -53645.694  (not concave)
Iteration 229: log likelihood = -53645.694  (not concave)
Iteration 230: log likelihood = -53645.694  (not concave)
Iteration 231: log likelihood = -53645.694  (not concave)
Iteration 232: log likelihood = -53645.694  (not concave)
Iteration 233: log likelihood = -53645.694  (not concave)
Iteration 234: log likelihood = -53645.694  (not concave)
Iteration 235: log likelihood = -53645.694  (not concave)
Iteration 236: log likelihood = -53645.694  (not concave)
Iteration 237: log likelihood = -53645.694  (not concave)
Iteration 238: log likelihood = -53645.694  (not concave)
Iteration 239: log likelihood = -53645.694  (not concave)
Iteration 240: log likelihood = -53645.694  (not concave)
Iteration 241: log likelihood = -53645.694  (not concave)
Iteration 242: log likelihood = -53645.694  (not concave)
Iteration 243: log likelihood = -53645.694  (not concave)
Iteration 244: log likelihood = -53645.694  (not concave)
Iteration 245: log likelihood = -53645.694  (not concave)
Iteration 246: log likelihood = -53645.694  (not concave)
Iteration 247: log likelihood = -53645.694  (not concave)
Iteration 248: log likelihood = -53645.694  (not concave)
Iteration 249: log likelihood = -53645.694  (not concave)
Iteration 250: log likelihood = -53645.694  (not concave)
Iteration 251: log likelihood = -53645.694  (not concave)
Iteration 252: log likelihood = -53645.694  (not concave)
Iteration 253: log likelihood = -53645.694  (not concave)
Iteration 254: log likelihood = -53645.694  (not concave)
Iteration 255: log likelihood = -53645.694  (not concave)
Iteration 256: log likelihood = -53645.694  (not concave)
Iteration 257: log likelihood = -53645.694  (not concave)
Iteration 258: log likelihood = -53645.694  (not concave)
Iteration 259: log likelihood = -53645.694  (not concave)
Iteration 260: log likelihood = -53645.694  (not concave)
Iteration 261: log likelihood = -53645.694  (not concave)
Iteration 262: log likelihood = -53645.694  (not concave)
Iteration 263: log likelihood = -53645.694  (not concave)
Iteration 264: log likelihood = -53645.694  (not concave)
Iteration 265: log likelihood = -53645.694  (not concave)
Iteration 266: log likelihood = -53645.694  (not concave)
Iteration 267: log likelihood = -53645.694  (not concave)
Iteration 268: log likelihood = -53645.694  (not concave)
Iteration 269: log likelihood = -53645.694  (not concave)
Iteration 270: log likelihood = -53645.694  (not concave)
Iteration 271: log likelihood = -53645.694  (not concave)
Iteration 272: log likelihood = -53645.694  (not concave)
Iteration 273: log likelihood = -53645.694  (not concave)
Iteration 274: log likelihood = -53645.694  (not concave)
Iteration 275: log likelihood = -53645.694  (not concave)
Iteration 276: log likelihood = -53645.694  (not concave)
Iteration 277: log likelihood = -53645.694  (not concave)
Iteration 278: log likelihood = -53645.694  (not concave)
Iteration 279: log likelihood = -53645.694  (not concave)
Iteration 280: log likelihood = -53645.694  (not concave)
Iteration 281: log likelihood = -53645.694  (not concave)
Iteration 282: log likelihood = -53645.694  (not concave)
Iteration 283: log likelihood = -53645.694  (not concave)
Iteration 284: log likelihood = -53645.694  (not concave)
Iteration 285: log likelihood = -53645.694  (not concave)
Iteration 286: log likelihood = -53645.694  (not concave)
Iteration 287: log likelihood = -53645.694  (not concave)
Iteration 288: log likelihood = -53645.694  (not concave)
Iteration 289: log likelihood = -53645.694  (not concave)
Iteration 290: log likelihood = -53645.694  (not concave)
Iteration 291: log likelihood = -53645.694  (not concave)
Iteration 292: log likelihood = -53645.694  (not concave)
Iteration 293: log likelihood = -53645.694  (not concave)
Iteration 294: log likelihood = -53645.694  (not concave)
Iteration 295: log likelihood = -53645.694  (not concave)
Iteration 296: log likelihood = -53645.694  (not concave)
Iteration 297: log likelihood = -53645.694  (not concave)
Iteration 298: log likelihood = -53645.694  (not concave)
Iteration 299: log likelihood = -53645.694  (not concave)
Iteration 300: log likelihood = -53645.694  (not concave)
convergence not achieved

Survival model                                  Number of obs     =     59,220
Log likelihood = -53645.694
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1512185     .00976    15.49   0.000     .1320892    .1703478
edad_al_in~t |  -.0105262    .001011   -10.41   0.000    -.0125078   -.0085446
edad_ini_c~s |  -.0105118   .0018806    -5.59   0.000    -.0141977   -.0068258
     sex_enc |  -.3362607   .0202509   -16.60   0.000    -.3759517   -.2965697
     esc_rec |   .0938482   .0122856     7.64   0.000     .0697688    .1179276
sus_prin_mod |    .133169   .0081795    16.28   0.000     .1171376    .1492005
 fr_sus_prin |   .0325406   .0075671     4.30   0.000     .0177094    .0473718
 comp_biosoc |   .1952939   .0141674    13.78   0.000     .1675264    .2230614
     ten_viv |  -.0155558   .0076347    -2.04   0.042    -.0305195   -.0005921
origen_ing~d |  -.0206225    .004405    -4.68   0.000    -.0292562   -.0119889
numero_de_~d |   .0730451   .0062652    11.66   0.000     .0607657    .0853246
dg_cie_10_~c |   .0273009   .0087692     3.11   0.002     .0101135    .0444884
sud_sever~10 |   -.064162   .0191575    -3.35   0.001    -.1017099   -.0266141
   macrozone |    .208439   .0118059    17.66   0.000     .1852998    .2315781
 policonsumo |   .0945473   .0216185     4.37   0.000     .0521757    .1369189
   n_off_vio |   .3157269   .0186857    16.90   0.000     .2791037    .3523501
   n_off_acq |   .6677695    .017396    38.39   0.000      .633674    .7018649
   n_off_sud |   .2307909   .0183716    12.56   0.000     .1947832    .2667987
        clas |   .0133146   .0128283     1.04   0.299    -.0118284    .0384576
       _cons |   17.01744          .        .       .            .           .
  log(gamma) |  -16.83903   .0967139  -174.11   0.000    -17.02858   -16.64947
------------------------------------------------------------------------------

.         //qui cap noi merlin (_time $covs if _trans == 1, family(gompertz, fail(_status)))
.         estimates store m2_1_wei

.         
.         // Log logistic
.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         di in yellow &quot;{bf: family Logl}&quot;
 family Logl

.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         set seed 2125

.         qui cap noi stmerlin $covs_2 , dist(loglogistic)
note; a delayed entry model is being fitted

Fitting full model:

Iteration 0:   log likelihood = -66283.404  
Iteration 1:   log likelihood = -58258.698  
Iteration 2:   log likelihood = -56104.813  (not concave)
Iteration 3:   log likelihood = -55778.469  (not concave)
Iteration 4:   log likelihood =  -55679.18  (not concave)
Iteration 5:   log likelihood = -55640.713  (not concave)
Iteration 6:   log likelihood = -55616.499  (not concave)
Iteration 7:   log likelihood = -55597.226  (not concave)
Iteration 8:   log likelihood = -55582.313  (not concave)
Iteration 9:   log likelihood = -55568.012  (not concave)
Iteration 10:  log likelihood = -55555.268  (not concave)
Iteration 11:  log likelihood = -55542.757  (not concave)
Iteration 12:  log likelihood = -55530.647  (not concave)
Iteration 13:  log likelihood = -55518.784  (not concave)
Iteration 14:  log likelihood = -55507.529  (not concave)
Iteration 15:  log likelihood = -55496.251  (not concave)
Iteration 16:  log likelihood =  -55485.33  (not concave)
Iteration 17:  log likelihood = -55474.469  (not concave)
Iteration 18:  log likelihood = -55464.002  (not concave)
Iteration 19:  log likelihood = -55453.514  (not concave)
Iteration 20:  log likelihood = -55443.316  (not concave)
Iteration 21:  log likelihood = -55433.093  (not concave)
Iteration 22:  log likelihood = -55423.133  (not concave)
Iteration 23:  log likelihood = -55413.108  (not concave)
Iteration 24:  log likelihood = -55403.298  (not concave)
Iteration 25:  log likelihood = -55393.411  (not concave)
Iteration 26:  log likelihood = -55383.716  (not concave)
Iteration 27:  log likelihood = -55373.931  (not concave)
Iteration 28:  log likelihood = -55364.318  (not concave)
Iteration 29:  log likelihood = -55354.611  (not concave)
Iteration 30:  log likelihood = -55345.067  (not concave)
Iteration 31:  log likelihood = -55335.427  (not concave)
Iteration 32:  log likelihood = -55325.943  (not concave)
Iteration 33:  log likelihood = -55316.365  (not concave)
Iteration 34:  log likelihood = -55306.939  (not concave)
Iteration 35:  log likelihood = -55297.423  (not concave)
Iteration 36:  log likelihood = -55288.057  (not concave)
Iteration 37:  log likelihood = -55278.606  (not concave)
Iteration 38:  log likelihood = -55269.302  (not concave)
Iteration 39:  log likelihood = -55259.919  (not concave)
Iteration 40:  log likelihood = -55250.684  (not concave)
Iteration 41:  log likelihood = -55241.375  (not concave)
Iteration 42:  log likelihood = -55232.212  (not concave)
Iteration 43:  log likelihood =  -55222.98  (not concave)
Iteration 44:  log likelihood = -55213.895  (not concave)
Iteration 45:  log likelihood = -55204.747  (not concave)
Iteration 46:  log likelihood = -55195.745  (not concave)
Iteration 47:  log likelihood = -55186.685  (not concave)
Iteration 48:  log likelihood =  -55177.77  (not concave)
Iteration 49:  log likelihood = -55168.803  (not concave)
Iteration 50:  log likelihood =  -55159.98  (not concave)
Iteration 51:  log likelihood = -55151.111  (not concave)
Iteration 52:  log likelihood = -55142.384  (not concave)
Iteration 53:  log likelihood = -55133.615  (not concave)
Iteration 54:  log likelihood = -55124.988  (not concave)
Iteration 55:  log likelihood = -55116.324  (not concave)
Iteration 56:  log likelihood = -55107.801  (not concave)
Iteration 57:  log likelihood = -55099.246  (not concave)
Iteration 58:  log likelihood =  -55090.83  (not concave)
Iteration 59:  log likelihood = -55082.387  (not concave)
Iteration 60:  log likelihood = -55074.081  (not concave)
Iteration 61:  log likelihood = -55065.753  (not concave)
Iteration 62:  log likelihood =  -55057.56  (not concave)
Iteration 63:  log likelihood = -55049.349  (not concave)
Iteration 64:  log likelihood = -55041.274  (not concave)
Iteration 65:  log likelihood = -55033.183  (not concave)
Iteration 66:  log likelihood = -55025.226  (not concave)
Iteration 67:  log likelihood = -55017.258  (not concave)
Iteration 68:  log likelihood = -55009.421  (not concave)
Iteration 69:  log likelihood = -55001.578  (not concave)
Iteration 70:  log likelihood = -54993.866  (not concave)
Iteration 71:  log likelihood = -54986.149  (not concave)
Iteration 72:  log likelihood = -54978.562  (not concave)
Iteration 73:  log likelihood = -54970.975  (not concave)
Iteration 74:  log likelihood = -54963.514  (not concave)
Iteration 75:  log likelihood = -54956.058  (not concave)
Iteration 76:  log likelihood = -54948.727  (not concave)
Iteration 77:  log likelihood = -54941.402  (not concave)
Iteration 78:  log likelihood = -54934.202  (not concave)
Iteration 79:  log likelihood = -54927.011  (not concave)
Iteration 80:  log likelihood = -54919.942  (not concave)
Iteration 81:  log likelihood = -54912.886  (not concave)
Iteration 82:  log likelihood = -54905.951  (not concave)
Iteration 83:  log likelihood =  -54899.03  (not concave)
Iteration 84:  log likelihood = -54892.229  (not concave)
Iteration 85:  log likelihood = -54885.446  (not concave)
Iteration 86:  log likelihood =  -54878.78  (not concave)
Iteration 87:  log likelihood = -54872.134  (not concave)
Iteration 88:  log likelihood = -54865.603  (not concave)
Iteration 89:  log likelihood = -54859.096  (not concave)
Iteration 90:  log likelihood = -54852.701  (not concave)
Iteration 91:  log likelihood = -54846.332  (not concave)
Iteration 92:  log likelihood = -54840.075  (not concave)
Iteration 93:  log likelihood = -54833.845  (not concave)
Iteration 94:  log likelihood = -54827.724  (not concave)
Iteration 95:  log likelihood = -54821.633  (not concave)
Iteration 96:  log likelihood =  -54815.65  (not concave)
Iteration 97:  log likelihood = -54809.698  
Iteration 98:  log likelihood = -54568.689  (backed up)
Iteration 99:  log likelihood = -54483.218  
Iteration 100: log likelihood = -54459.753  
Iteration 101: log likelihood =  -54459.35  
Iteration 102: log likelihood = -54459.349  

Survival model                                  Number of obs     =     59,220
Log likelihood = -54459.349
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |  -.0708449   .0051782   -13.68   0.000    -.0809939   -.0606958
edad_al_in~t |   .0319588    .000499    64.04   0.000     .0309807    .0329369
edad_ini_c~s |   .0038405   .0008086     4.75   0.000     .0022556    .0054254
     sex_enc |    .159726   .0102114    15.64   0.000      .139712      .17974
     esc_rec |  -.0578435    .006626    -8.73   0.000    -.0708301   -.0448569
sus_prin_mod |  -.0673708    .004929   -13.67   0.000    -.0770315     -.05771
 fr_sus_prin |  -.0163509   .0039487    -4.14   0.000    -.0240902   -.0086116
 comp_biosoc |  -.0952514   .0077375   -12.31   0.000    -.1104167   -.0800861
     ten_viv |   .0059609   .0042918     1.39   0.165     -.002451    .0143727
origen_ing~d |   .0072716   .0023772     3.06   0.002     .0026123    .0119309
numero_de_~d |  -.0308237   .0037579    -8.20   0.000    -.0381891   -.0234584
dg_cie_10_~c |  -.0070284   .0048654    -1.44   0.149    -.0165645    .0025076
sud_sever~10 |   .0123491   .0097904     1.26   0.207    -.0068397     .031538
   macrozone |  -.0923927   .0078102   -11.83   0.000    -.1077004    -.077085
 policonsumo |  -.0296453   .0102193    -2.90   0.004    -.0496748   -.0096159
   n_off_vio |   -.223055   .0183014   -12.19   0.000     -.258925    -.187185
   n_off_acq |  -.9688964   .2210248    -4.38   0.000    -1.402097   -.5356956
   n_off_sud |  -.1981401   .0177308   -11.17   0.000    -.2328919   -.1633883
        clas |   .0073051   .0072558     1.01   0.314    -.0069161    .0215263
       _cons |   3.036454   .0496383    61.17   0.000     2.939165    3.133744
       dap:1 |  -1.711623   .0111079  -154.09   0.000    -1.733394   -1.689852
------------------------------------------------------------------------------

.         //qui cap noi merlin (_time $covs if _trans == 1, family(loglogistic, fail(_status)))
.         estimates store m2_1_logl

. 
.         // Log normal
.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         di in yellow &quot;{bf: family Logn}&quot;
 family Logn

.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         set seed 2125

.         qui cap noi stmerlin $covs_2 , dist(lognormal)
note; a delayed entry model is being fitted

Fitting full model:

Iteration 0:   log likelihood = -56595.733  (not concave)
Iteration 1:   log likelihood =  -54884.21  (not concave)
Iteration 2:   log likelihood = -54856.091  (not concave)
Iteration 3:   log likelihood = -54843.603  (not concave)
Iteration 4:   log likelihood = -54822.322  (not concave)
Iteration 5:   log likelihood = -54642.383  (not concave)
Iteration 6:   log likelihood = -54590.024  (not concave)
Iteration 7:   log likelihood = -54570.917  (not concave)
Iteration 8:   log likelihood = -54570.872  (not concave)
Iteration 9:   log likelihood = -54570.866  (not concave)
Iteration 10:  log likelihood = -54570.865  (not concave)
Iteration 11:  log likelihood = -54570.865  (not concave)
Iteration 12:  log likelihood = -54570.865  (not concave)
Iteration 13:  log likelihood = -54570.865  (not concave)
Iteration 14:  log likelihood = -54570.865  (not concave)
Iteration 15:  log likelihood = -54570.865  (not concave)
Iteration 16:  log likelihood = -54570.865  (not concave)
Iteration 17:  log likelihood = -54570.865  (not concave)
Iteration 18:  log likelihood = -54570.865  (not concave)
Iteration 19:  log likelihood = -54570.865  (not concave)
Iteration 20:  log likelihood = -54570.865  (not concave)
Iteration 21:  log likelihood = -54570.865  (not concave)
Iteration 22:  log likelihood = -54570.865  (not concave)
Iteration 23:  log likelihood = -54570.865  (not concave)
Iteration 24:  log likelihood = -54570.865  (not concave)
Iteration 25:  log likelihood = -54570.865  (not concave)
Iteration 26:  log likelihood = -54570.865  (not concave)
Iteration 27:  log likelihood = -54570.865  (not concave)
Iteration 28:  log likelihood = -54570.865  (not concave)
Iteration 29:  log likelihood = -54570.865  (not concave)
Iteration 30:  log likelihood = -54570.865  (not concave)
Iteration 31:  log likelihood = -54570.865  (not concave)
Iteration 32:  log likelihood = -54570.865  (not concave)
Iteration 33:  log likelihood = -54570.865  (not concave)
Iteration 34:  log likelihood = -54570.865  (not concave)
Iteration 35:  log likelihood = -54570.865  (not concave)
Iteration 36:  log likelihood = -54570.865  (not concave)
Iteration 37:  log likelihood = -54570.865  (not concave)
Iteration 38:  log likelihood = -54570.865  (not concave)
Iteration 39:  log likelihood = -54570.865  (not concave)
Iteration 40:  log likelihood = -54570.865  (not concave)
Iteration 41:  log likelihood = -54570.865  (not concave)
Iteration 42:  log likelihood = -54570.865  (not concave)
Iteration 43:  log likelihood = -54570.865  (not concave)
Iteration 44:  log likelihood = -54570.865  (not concave)
Iteration 45:  log likelihood = -54570.865  (not concave)
Iteration 46:  log likelihood = -54570.865  (not concave)
Iteration 47:  log likelihood = -54570.865  (not concave)
Iteration 48:  log likelihood = -54570.865  (not concave)
Iteration 49:  log likelihood = -54570.865  (not concave)
Iteration 50:  log likelihood = -54570.865  (not concave)
Iteration 51:  log likelihood = -54570.865  (not concave)
Iteration 52:  log likelihood = -54570.865  (not concave)
Iteration 53:  log likelihood = -54570.865  (not concave)
Iteration 54:  log likelihood = -54570.865  (not concave)
Iteration 55:  log likelihood = -54570.865  (not concave)
Iteration 56:  log likelihood = -54570.865  (not concave)
Iteration 57:  log likelihood = -54570.865  (not concave)
Iteration 58:  log likelihood = -54570.865  (not concave)
Iteration 59:  log likelihood = -54570.865  (not concave)
Iteration 60:  log likelihood = -54570.865  (not concave)
Iteration 61:  log likelihood = -54570.865  (not concave)
Iteration 62:  log likelihood = -54570.865  (not concave)
Iteration 63:  log likelihood = -54570.865  (not concave)
Iteration 64:  log likelihood = -54570.865  (not concave)
Iteration 65:  log likelihood = -54570.865  (not concave)
Iteration 66:  log likelihood = -54570.865  (not concave)
Iteration 67:  log likelihood = -54570.865  (not concave)
Iteration 68:  log likelihood = -54570.865  (not concave)
Iteration 69:  log likelihood = -54570.865  (not concave)
Iteration 70:  log likelihood = -54570.865  (not concave)
Iteration 71:  log likelihood = -54570.865  (not concave)
Iteration 72:  log likelihood = -54570.865  (not concave)
Iteration 73:  log likelihood = -54570.865  (not concave)
Iteration 74:  log likelihood = -54570.865  (not concave)
Iteration 75:  log likelihood = -54570.865  (not concave)
Iteration 76:  log likelihood = -54570.865  (not concave)
Iteration 77:  log likelihood = -54570.865  (not concave)
Iteration 78:  log likelihood = -54570.865  (not concave)
Iteration 79:  log likelihood = -54570.865  (not concave)
Iteration 80:  log likelihood = -54570.865  (not concave)
Iteration 81:  log likelihood = -54570.865  (not concave)
Iteration 82:  log likelihood = -54570.865  (not concave)
Iteration 83:  log likelihood = -54570.865  (not concave)
Iteration 84:  log likelihood = -54570.865  (not concave)
Iteration 85:  log likelihood = -54570.865  (not concave)
Iteration 86:  log likelihood = -54570.865  (not concave)
Iteration 87:  log likelihood = -54570.865  (not concave)
Iteration 88:  log likelihood = -54570.865  (not concave)
Iteration 89:  log likelihood = -54570.865  (not concave)
Iteration 90:  log likelihood = -54570.865  (not concave)
Iteration 91:  log likelihood = -54570.865  (not concave)
Iteration 92:  log likelihood = -54570.865  (not concave)
Iteration 93:  log likelihood = -54570.865  (not concave)
Iteration 94:  log likelihood = -54570.865  (not concave)
Iteration 95:  log likelihood = -54570.865  (not concave)
Iteration 96:  log likelihood = -54570.865  (not concave)
Iteration 97:  log likelihood = -54570.865  (not concave)
Iteration 98:  log likelihood = -54570.865  (not concave)
Iteration 99:  log likelihood = -54570.865  (not concave)
Iteration 100: log likelihood = -54570.865  (not concave)
Iteration 101: log likelihood = -54570.865  (not concave)
Iteration 102: log likelihood = -54570.865  (not concave)
Iteration 103: log likelihood = -54570.865  (not concave)
Iteration 104: log likelihood = -54570.865  (not concave)
Iteration 105: log likelihood = -54570.865  (not concave)
Iteration 106: log likelihood = -54570.865  (not concave)
Iteration 107: log likelihood = -54570.865  (not concave)
Iteration 108: log likelihood = -54570.865  (not concave)
Iteration 109: log likelihood = -54570.865  (not concave)
Iteration 110: log likelihood = -54570.865  (not concave)
Iteration 111: log likelihood = -54570.865  (not concave)
Iteration 112: log likelihood = -54570.865  (not concave)
Iteration 113: log likelihood = -54570.865  (not concave)
Iteration 114: log likelihood = -54570.865  (not concave)
Iteration 115: log likelihood = -54570.865  (not concave)
Iteration 116: log likelihood = -54570.865  (not concave)
Iteration 117: log likelihood = -54570.865  (not concave)
Iteration 118: log likelihood = -54570.865  (not concave)
Iteration 119: log likelihood = -54570.865  (not concave)
Iteration 120: log likelihood = -54570.865  (not concave)
Iteration 121: log likelihood = -54570.865  (not concave)
Iteration 122: log likelihood = -54570.865  (not concave)
Iteration 123: log likelihood = -54570.865  (not concave)
Iteration 124: log likelihood = -54570.865  (not concave)
Iteration 125: log likelihood = -54570.865  (not concave)
Iteration 126: log likelihood = -54570.865  (not concave)
Iteration 127: log likelihood = -54570.865  (not concave)
Iteration 128: log likelihood = -54570.865  (not concave)
Iteration 129: log likelihood = -54570.865  (not concave)
Iteration 130: log likelihood = -54570.865  (not concave)
Iteration 131: log likelihood = -54570.865  (not concave)
Iteration 132: log likelihood = -54570.865  (not concave)
Iteration 133: log likelihood = -54570.865  (not concave)
Iteration 134: log likelihood = -54570.865  (not concave)
Iteration 135: log likelihood = -54570.865  (not concave)
Iteration 136: log likelihood = -54570.865  (not concave)
Iteration 137: log likelihood = -54570.865  (not concave)
Iteration 138: log likelihood = -54570.865  (not concave)
Iteration 139: log likelihood = -54570.865  (not concave)
Iteration 140: log likelihood = -54570.865  (not concave)
Iteration 141: log likelihood = -54570.865  (not concave)
Iteration 142: log likelihood = -54570.865  (not concave)
Iteration 143: log likelihood = -54570.865  (not concave)
Iteration 144: log likelihood = -54570.865  (not concave)
Iteration 145: log likelihood = -54570.865  (not concave)
Iteration 146: log likelihood = -54570.865  (not concave)
Iteration 147: log likelihood = -54570.865  (not concave)
Iteration 148: log likelihood = -54570.865  (not concave)
Iteration 149: log likelihood = -54570.865  (not concave)
Iteration 150: log likelihood = -54570.865  (not concave)
Iteration 151: log likelihood = -54570.865  (not concave)
Iteration 152: log likelihood = -54570.865  (not concave)
Iteration 153: log likelihood = -54570.865  (not concave)
Iteration 154: log likelihood = -54570.865  (not concave)
Iteration 155: log likelihood = -54570.865  (not concave)
Iteration 156: log likelihood = -54570.865  (not concave)
Iteration 157: log likelihood = -54570.865  (not concave)
Iteration 158: log likelihood = -54570.865  (not concave)
Iteration 159: log likelihood = -54570.865  (not concave)
Iteration 160: log likelihood = -54570.865  (not concave)
Iteration 161: log likelihood = -54570.865  (not concave)
Iteration 162: log likelihood = -54570.865  (not concave)
Iteration 163: log likelihood = -54570.865  (not concave)
Iteration 164: log likelihood = -54570.865  (not concave)
Iteration 165: log likelihood = -54570.865  (not concave)
Iteration 166: log likelihood = -54570.865  (not concave)
Iteration 167: log likelihood = -54570.865  (not concave)
Iteration 168: log likelihood = -54570.865  (not concave)
Iteration 169: log likelihood = -54570.865  (not concave)
Iteration 170: log likelihood = -54570.865  (not concave)
Iteration 171: log likelihood = -54570.865  (not concave)
Iteration 172: log likelihood = -54570.865  (not concave)
Iteration 173: log likelihood = -54570.865  (not concave)
Iteration 174: log likelihood = -54570.865  (not concave)
Iteration 175: log likelihood = -54570.865  (not concave)
Iteration 176: log likelihood = -54570.865  (not concave)
Iteration 177: log likelihood = -54570.865  (not concave)
Iteration 178: log likelihood = -54570.865  (not concave)
Iteration 179: log likelihood = -54570.865  (not concave)
Iteration 180: log likelihood = -54570.865  (not concave)
Iteration 181: log likelihood = -54570.865  (not concave)
Iteration 182: log likelihood = -54570.865  (not concave)
Iteration 183: log likelihood = -54570.865  (not concave)
Iteration 184: log likelihood = -54570.865  (not concave)
Iteration 185: log likelihood = -54570.865  (not concave)
Iteration 186: log likelihood = -54570.865  (not concave)
Iteration 187: log likelihood = -54570.865  (not concave)
Iteration 188: log likelihood = -54570.865  (not concave)
Iteration 189: log likelihood = -54570.865  (not concave)
Iteration 190: log likelihood = -54570.865  (not concave)
Iteration 191: log likelihood = -54570.865  (not concave)
Iteration 192: log likelihood = -54570.865  (not concave)
Iteration 193: log likelihood = -54570.865  (not concave)
Iteration 194: log likelihood = -54570.865  (not concave)
Iteration 195: log likelihood = -54570.865  (not concave)
Iteration 196: log likelihood = -54570.865  (not concave)
Iteration 197: log likelihood = -54570.865  (not concave)
Iteration 198: log likelihood = -54570.865  (not concave)
Iteration 199: log likelihood = -54570.865  (not concave)
Iteration 200: log likelihood = -54570.865  (not concave)
Iteration 201: log likelihood = -54570.865  (not concave)
Iteration 202: log likelihood = -54570.865  (not concave)
Iteration 203: log likelihood = -54570.865  (not concave)
Iteration 204: log likelihood = -54570.865  (not concave)
Iteration 205: log likelihood = -54570.865  (not concave)
Iteration 206: log likelihood = -54570.865  (not concave)
Iteration 207: log likelihood = -54570.865  (not concave)
Iteration 208: log likelihood = -54570.865  (not concave)
Iteration 209: log likelihood = -54570.865  (not concave)
Iteration 210: log likelihood = -54570.865  (not concave)
Iteration 211: log likelihood = -54570.865  (not concave)
Iteration 212: log likelihood = -54570.865  (not concave)
Iteration 213: log likelihood = -54570.865  (not concave)
Iteration 214: log likelihood = -54570.865  (not concave)
Iteration 215: log likelihood = -54570.865  (not concave)
Iteration 216: log likelihood = -54570.865  (not concave)
Iteration 217: log likelihood = -54570.865  (not concave)
Iteration 218: log likelihood = -54570.865  (not concave)
Iteration 219: log likelihood = -54570.865  (not concave)
Iteration 220: log likelihood = -54570.865  (not concave)
Iteration 221: log likelihood = -54570.865  (not concave)
Iteration 222: log likelihood = -54570.865  (not concave)
Iteration 223: log likelihood = -54570.865  (not concave)
Iteration 224: log likelihood = -54570.865  (not concave)
Iteration 225: log likelihood = -54570.865  (not concave)
Iteration 226: log likelihood = -54570.865  (not concave)
Iteration 227: log likelihood = -54570.865  (not concave)
Iteration 228: log likelihood = -54570.865  (not concave)
Iteration 229: log likelihood = -54570.865  (not concave)
Iteration 230: log likelihood = -54570.865  (not concave)
Iteration 231: log likelihood = -54570.865  (not concave)
Iteration 232: log likelihood = -54570.865  (not concave)
Iteration 233: log likelihood = -54570.865  (not concave)
Iteration 234: log likelihood = -54570.865  (not concave)
Iteration 235: log likelihood = -54570.865  (not concave)
Iteration 236: log likelihood = -54570.865  (not concave)
Iteration 237: log likelihood = -54570.865  (not concave)
Iteration 238: log likelihood = -54570.865  (not concave)
Iteration 239: log likelihood = -54570.865  (not concave)
Iteration 240: log likelihood = -54570.865  (not concave)
Iteration 241: log likelihood = -54570.865  (not concave)
Iteration 242: log likelihood = -54570.865  (not concave)
Iteration 243: log likelihood = -54570.865  (not concave)
Iteration 244: log likelihood = -54570.865  (not concave)
Iteration 245: log likelihood = -54570.865  (not concave)
Iteration 246: log likelihood = -54570.865  (not concave)
Iteration 247: log likelihood = -54570.865  (not concave)
Iteration 248: log likelihood = -54570.865  (not concave)
Iteration 249: log likelihood = -54570.865  (not concave)
Iteration 250: log likelihood = -54570.865  (not concave)
Iteration 251: log likelihood = -54570.865  (not concave)
Iteration 252: log likelihood = -54570.865  (not concave)
Iteration 253: log likelihood = -54570.865  (not concave)
Iteration 254: log likelihood = -54570.865  (not concave)
Iteration 255: log likelihood = -54570.865  (not concave)
Iteration 256: log likelihood = -54570.865  (not concave)
Iteration 257: log likelihood = -54570.865  (not concave)
Iteration 258: log likelihood = -54570.865  (not concave)
Iteration 259: log likelihood = -54570.865  (not concave)
Iteration 260: log likelihood = -54570.865  (not concave)
Iteration 261: log likelihood = -54570.865  (not concave)
Iteration 262: log likelihood = -54570.865  (not concave)
Iteration 263: log likelihood = -54570.865  (not concave)
Iteration 264: log likelihood = -54570.865  (not concave)
Iteration 265: log likelihood = -54570.865  (not concave)
Iteration 266: log likelihood = -54570.865  (not concave)
Iteration 267: log likelihood = -54570.865  (not concave)
Iteration 268: log likelihood = -54570.865  (not concave)
Iteration 269: log likelihood = -54570.865  (not concave)
Iteration 270: log likelihood = -54570.865  (not concave)
Iteration 271: log likelihood = -54570.865  (not concave)
Iteration 272: log likelihood = -54570.865  (not concave)
Iteration 273: log likelihood = -54570.865  (not concave)
Iteration 274: log likelihood = -54570.865  (not concave)
Iteration 275: log likelihood = -54570.865  (not concave)
Iteration 276: log likelihood = -54570.865  (not concave)
Iteration 277: log likelihood = -54570.865  (not concave)
Iteration 278: log likelihood = -54570.865  (not concave)
Iteration 279: log likelihood = -54570.865  (not concave)
Iteration 280: log likelihood = -54570.865  (not concave)
Iteration 281: log likelihood = -54570.865  (not concave)
Iteration 282: log likelihood = -54570.865  (not concave)
Iteration 283: log likelihood = -54570.865  (not concave)
Iteration 284: log likelihood = -54570.865  (not concave)
Iteration 285: log likelihood = -54570.865  (not concave)
Iteration 286: log likelihood = -54570.865  (not concave)
Iteration 287: log likelihood = -54570.865  (not concave)
Iteration 288: log likelihood = -54570.865  (not concave)
Iteration 289: log likelihood = -54570.865  (not concave)
Iteration 290: log likelihood = -54570.865  (not concave)
Iteration 291: log likelihood = -54570.865  (not concave)
Iteration 292: log likelihood = -54570.865  (not concave)
Iteration 293: log likelihood = -54570.865  (not concave)
Iteration 294: log likelihood = -54570.865  (not concave)
Iteration 295: log likelihood = -54570.865  (not concave)
Iteration 296: log likelihood = -54570.865  (not concave)
Iteration 297: log likelihood = -54570.865  (not concave)
Iteration 298: log likelihood = -54570.865  (not concave)
Iteration 299: log likelihood = -54570.865  (not concave)
Iteration 300: log likelihood = -54570.865  (not concave)
convergence not achieved

Survival model                                  Number of obs     =     59,220
Log likelihood = -54570.865
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |  -.0718959          .        .       .            .           .
edad_al_in~t |   .0128208   1.38e-06  9302.07   0.000     .0128181    .0128235
edad_ini_c~s |   .0213157   5.03e-06  4239.41   0.000     .0213059    .0213256
     sex_enc |   .5931458          .        .       .            .           .
     esc_rec |  -.2769908          .        .       .            .           .
sus_prin_mod |  -.1103979          .        .       .            .           .
 fr_sus_prin |  -.1293979   .0000143 -9071.77   0.000    -.1294259     -.12937
 comp_biosoc |  -.0726059   .0000188 -3871.70   0.000    -.0726427   -.0725692
     ten_viv |    .065743   .0000185  3552.72   0.000     .0657067    .0657793
origen_ing~d |   .0875589          .        .       .            .           .
numero_de_~d |   .0687275   .0008954    76.76   0.000     .0669726    .0704824
dg_cie_10_~c |  -.0544498     .00004 -1360.56   0.000    -.0545282   -.0543713
sud_sever~10 |   .5465445          .        .       .            .           .
   macrozone |    -.08736          .        .       .            .           .
 policonsumo |   -.209576          .        .       .            .           .
   n_off_vio |  -1.036347          .        .       .            .           .
   n_off_acq |  -1.783254          .        .       .            .           .
   n_off_sud |  -.9442622          .        .       .            .           .
        clas |   .0663994          .        .       .            .           .
       _cons |   .1022528   .0000741  1379.09   0.000     .1021075    .1023982
       dap:1 |  -.0356286   4.32e-06 -8251.63   0.000    -.0356371   -.0356201
------------------------------------------------------------------------------

.         //qui cap noi merlin (_time $covs if _trans == 1, family(lognormal, fail(_status)))
.         estimates store m2_1_logn

.         
.         // Generalised gamma
.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         di in yellow &quot;{bf: family Ggam}&quot;
 family Ggam

.         di in yellow &quot;{bf: ***********}&quot;
 ***********

.         set seed 2125

.         qui cap noi stmerlin $covs_2 , dist(ggamma)
note; a delayed entry model is being fitted

Fitting full model:

Iteration 0:   log likelihood = -62692.817  (not concave)
Iteration 1:   log likelihood = -54685.307  (not concave)
Iteration 2:   log likelihood = -54654.784  (not concave)
Iteration 3:   log likelihood = -54653.112  (not concave)
Iteration 4:   log likelihood = -54644.444  (not concave)
Iteration 5:   log likelihood = -54643.964  (not concave)
Iteration 6:   log likelihood = -54643.963  (not concave)
Iteration 7:   log likelihood = -54643.963  (not concave)
Iteration 8:   log likelihood = -54643.963  (not concave)
Iteration 9:   log likelihood = -54643.963  (not concave)
Iteration 10:  log likelihood = -54643.963  (not concave)
Iteration 11:  log likelihood = -54643.963  (not concave)
Iteration 12:  log likelihood = -54643.963  (not concave)
Iteration 13:  log likelihood = -54643.963  (not concave)
Iteration 14:  log likelihood = -54643.963  (not concave)
Iteration 15:  log likelihood = -54643.963  (not concave)
Iteration 16:  log likelihood = -54643.963  (not concave)
Iteration 17:  log likelihood = -54643.963  (not concave)
Iteration 18:  log likelihood = -54643.963  (not concave)
Iteration 19:  log likelihood = -54643.963  (not concave)
Iteration 20:  log likelihood = -54643.963  (not concave)
Iteration 21:  log likelihood = -54643.963  (not concave)
Iteration 22:  log likelihood = -54643.963  (not concave)
Iteration 23:  log likelihood = -54643.963  (not concave)
Iteration 24:  log likelihood = -54643.963  (not concave)
Iteration 25:  log likelihood = -54643.963  (not concave)
Iteration 26:  log likelihood = -54643.963  (not concave)
Iteration 27:  log likelihood = -54643.963  (not concave)
Iteration 28:  log likelihood = -54643.963  (not concave)
Iteration 29:  log likelihood = -54643.963  (not concave)
Iteration 30:  log likelihood = -54643.963  (not concave)
Iteration 31:  log likelihood = -54643.963  (not concave)
Iteration 32:  log likelihood = -54643.963  (not concave)
Iteration 33:  log likelihood = -54643.963  (not concave)
Iteration 34:  log likelihood = -54643.963  (not concave)
Iteration 35:  log likelihood = -54643.963  (not concave)
Iteration 36:  log likelihood = -54643.963  (not concave)
Iteration 37:  log likelihood = -54643.963  (not concave)
Iteration 38:  log likelihood = -54643.963  (not concave)
Iteration 39:  log likelihood = -54643.963  (not concave)
Iteration 40:  log likelihood = -54643.963  (not concave)
Iteration 41:  log likelihood = -54643.963  (not concave)
Iteration 42:  log likelihood = -54643.963  (not concave)
Iteration 43:  log likelihood = -54643.963  (not concave)
Iteration 44:  log likelihood = -54643.963  (not concave)
Iteration 45:  log likelihood = -54643.963  (not concave)
Iteration 46:  log likelihood = -54643.963  (not concave)
Iteration 47:  log likelihood = -54643.963  (not concave)
Iteration 48:  log likelihood = -54643.963  (not concave)
Iteration 49:  log likelihood = -54643.963  (not concave)
Iteration 50:  log likelihood = -54643.963  (not concave)
Iteration 51:  log likelihood = -54643.963  (not concave)
Iteration 52:  log likelihood = -54643.963  (not concave)
Iteration 53:  log likelihood = -54643.963  (not concave)
Iteration 54:  log likelihood = -54643.963  (not concave)
Iteration 55:  log likelihood = -54643.963  (not concave)
Iteration 56:  log likelihood = -54643.963  (not concave)
Iteration 57:  log likelihood = -54643.963  (not concave)
Iteration 58:  log likelihood = -54643.963  (not concave)
Iteration 59:  log likelihood = -54643.963  (not concave)
Iteration 60:  log likelihood = -54643.963  (not concave)
Iteration 61:  log likelihood = -54643.963  (not concave)
Iteration 62:  log likelihood = -54643.963  (not concave)
Iteration 63:  log likelihood = -54643.963  (not concave)
Iteration 64:  log likelihood = -54643.963  (not concave)
Iteration 65:  log likelihood = -54643.963  (not concave)
Iteration 66:  log likelihood = -54643.963  (not concave)
Iteration 67:  log likelihood = -54643.963  (not concave)
Iteration 68:  log likelihood = -54643.963  (not concave)
Iteration 69:  log likelihood = -54643.963  (not concave)
Iteration 70:  log likelihood = -54643.963  (not concave)
Iteration 71:  log likelihood = -54643.963  (not concave)
Iteration 72:  log likelihood = -54643.963  (not concave)
Iteration 73:  log likelihood = -54643.963  (not concave)
Iteration 74:  log likelihood = -54643.963  (not concave)
Iteration 75:  log likelihood = -54643.963  (not concave)
Iteration 76:  log likelihood = -54643.963  (not concave)
Iteration 77:  log likelihood = -54643.963  (not concave)
Iteration 78:  log likelihood = -54643.963  (not concave)
Iteration 79:  log likelihood = -54643.963  (not concave)
Iteration 80:  log likelihood = -54643.963  (not concave)
Iteration 81:  log likelihood = -54643.963  (not concave)
Iteration 82:  log likelihood = -54643.963  (not concave)
Iteration 83:  log likelihood = -54643.963  (not concave)
Iteration 84:  log likelihood = -54643.963  (not concave)
Iteration 85:  log likelihood = -54643.963  (not concave)
Iteration 86:  log likelihood = -54643.963  (not concave)
Iteration 87:  log likelihood = -54643.963  (not concave)
Iteration 88:  log likelihood = -54643.963  (not concave)
Iteration 89:  log likelihood = -54643.963  (not concave)
Iteration 90:  log likelihood = -54643.963  (not concave)
Iteration 91:  log likelihood = -54643.963  (not concave)
Iteration 92:  log likelihood = -54643.963  (not concave)
Iteration 93:  log likelihood = -54643.963  (not concave)
Iteration 94:  log likelihood = -54643.963  (not concave)
Iteration 95:  log likelihood = -54643.963  (not concave)
Iteration 96:  log likelihood = -54643.963  (not concave)
Iteration 97:  log likelihood = -54643.963  (not concave)
Iteration 98:  log likelihood = -54643.963  (not concave)
Iteration 99:  log likelihood = -54643.963  (not concave)
Iteration 100: log likelihood = -54643.963  (not concave)
Iteration 101: log likelihood = -54643.963  (not concave)
Iteration 102: log likelihood = -54643.963  (not concave)
Iteration 103: log likelihood = -54643.963  (not concave)
Iteration 104: log likelihood = -54643.963  (not concave)
Iteration 105: log likelihood = -54643.963  (not concave)
Iteration 106: log likelihood = -54643.963  (not concave)
Iteration 107: log likelihood = -54643.963  (not concave)
Iteration 108: log likelihood = -54643.963  (not concave)
Iteration 109: log likelihood = -54643.963  (not concave)
Iteration 110: log likelihood = -54643.963  (not concave)
Iteration 111: log likelihood = -54643.963  (not concave)
Iteration 112: log likelihood = -54643.963  (not concave)
Iteration 113: log likelihood = -54643.963  (not concave)
Iteration 114: log likelihood = -54643.963  (not concave)
Iteration 115: log likelihood = -54643.963  (not concave)
Iteration 116: log likelihood = -54643.963  (not concave)
Iteration 117: log likelihood = -54643.963  (not concave)
Iteration 118: log likelihood = -54643.963  (not concave)
Iteration 119: log likelihood = -54643.963  (not concave)
Iteration 120: log likelihood = -54643.963  (not concave)
Iteration 121: log likelihood = -54643.963  (not concave)
Iteration 122: log likelihood = -54643.963  (not concave)
Iteration 123: log likelihood = -54643.963  (not concave)
Iteration 124: log likelihood = -54643.963  (not concave)
Iteration 125: log likelihood = -54643.963  (not concave)
Iteration 126: log likelihood = -54643.963  (not concave)
Iteration 127: log likelihood = -54643.963  (not concave)
Iteration 128: log likelihood = -54643.963  (not concave)
Iteration 129: log likelihood = -54643.963  (not concave)
Iteration 130: log likelihood = -54643.963  (not concave)
Iteration 131: log likelihood = -54643.963  (not concave)
Iteration 132: log likelihood = -54643.963  (not concave)
Iteration 133: log likelihood = -54643.963  (not concave)
Iteration 134: log likelihood = -54643.963  (not concave)
Iteration 135: log likelihood = -54643.963  (not concave)
Iteration 136: log likelihood = -54643.963  (not concave)
Iteration 137: log likelihood = -54643.963  (not concave)
Iteration 138: log likelihood = -54643.963  (not concave)
Iteration 139: log likelihood = -54643.963  (not concave)
Iteration 140: log likelihood = -54643.963  (not concave)
Iteration 141: log likelihood = -54643.963  (not concave)
Iteration 142: log likelihood = -54643.963  (not concave)
Iteration 143: log likelihood = -54643.963  (not concave)
Iteration 144: log likelihood = -54643.963  (not concave)
Iteration 145: log likelihood = -54643.963  (not concave)
Iteration 146: log likelihood = -54643.963  (not concave)
Iteration 147: log likelihood = -54643.963  (not concave)
Iteration 148: log likelihood = -54643.963  (not concave)
Iteration 149: log likelihood = -54643.963  (not concave)
Iteration 150: log likelihood = -54643.963  (not concave)
Iteration 151: log likelihood = -54643.963  (not concave)
Iteration 152: log likelihood = -54643.963  (not concave)
Iteration 153: log likelihood = -54643.963  (not concave)
Iteration 154: log likelihood = -54643.963  (not concave)
Iteration 155: log likelihood = -54643.963  (not concave)
Iteration 156: log likelihood = -54643.963  (not concave)
Iteration 157: log likelihood = -54643.963  (not concave)
Iteration 158: log likelihood = -54643.963  (not concave)
Iteration 159: log likelihood = -54643.963  (not concave)
Iteration 160: log likelihood = -54643.963  (not concave)
Iteration 161: log likelihood = -54643.963  (not concave)
Iteration 162: log likelihood = -54643.963  (not concave)
Iteration 163: log likelihood = -54643.963  (not concave)
Iteration 164: log likelihood = -54643.963  (not concave)
Iteration 165: log likelihood = -54643.963  (not concave)
Iteration 166: log likelihood = -54643.963  (not concave)
Iteration 167: log likelihood = -54643.963  (not concave)
Iteration 168: log likelihood = -54643.963  (not concave)
Iteration 169: log likelihood = -54643.963  (not concave)
Iteration 170: log likelihood = -54643.963  (not concave)
Iteration 171: log likelihood = -54643.963  (not concave)
Iteration 172: log likelihood = -54643.963  (not concave)
Iteration 173: log likelihood = -54643.963  (not concave)
Iteration 174: log likelihood = -54643.963  (not concave)
Iteration 175: log likelihood = -54643.963  (not concave)
Iteration 176: log likelihood = -54643.963  (not concave)
Iteration 177: log likelihood = -54643.963  (not concave)
Iteration 178: log likelihood = -54643.963  (not concave)
Iteration 179: log likelihood = -54643.963  (not concave)
Iteration 180: log likelihood = -54643.963  (not concave)
Iteration 181: log likelihood = -54643.963  (not concave)
Iteration 182: log likelihood = -54643.963  (not concave)
Iteration 183: log likelihood = -54643.963  (not concave)
Iteration 184: log likelihood = -54643.963  (not concave)
Iteration 185: log likelihood = -54643.963  (not concave)
Iteration 186: log likelihood = -54643.963  (not concave)
Iteration 187: log likelihood = -54643.963  (not concave)
Iteration 188: log likelihood = -54643.963  (not concave)
Iteration 189: log likelihood = -54643.963  (not concave)
Iteration 190: log likelihood = -54643.963  (not concave)
Iteration 191: log likelihood = -54643.963  (not concave)
Iteration 192: log likelihood = -54643.963  (not concave)
Iteration 193: log likelihood = -54643.963  (not concave)
Iteration 194: log likelihood = -54643.963  (not concave)
Iteration 195: log likelihood = -54643.963  (not concave)
Iteration 196: log likelihood = -54643.963  (not concave)
Iteration 197: log likelihood = -54643.963  (not concave)
Iteration 198: log likelihood = -54643.963  (not concave)
Iteration 199: log likelihood = -54643.963  (not concave)
Iteration 200: log likelihood = -54643.963  (not concave)
Iteration 201: log likelihood = -54643.963  (not concave)
Iteration 202: log likelihood = -54643.963  (not concave)
Iteration 203: log likelihood = -54643.963  (not concave)
Iteration 204: log likelihood = -54643.963  (not concave)
Iteration 205: log likelihood = -54643.963  (not concave)
Iteration 206: log likelihood = -54643.963  (not concave)
Iteration 207: log likelihood = -54643.963  (not concave)
Iteration 208: log likelihood = -54643.963  (not concave)
Iteration 209: log likelihood = -54643.963  (not concave)
Iteration 210: log likelihood = -54643.963  (not concave)
Iteration 211: log likelihood = -54643.963  (not concave)
Iteration 212: log likelihood = -54643.963  (not concave)
Iteration 213: log likelihood = -54643.963  (not concave)
Iteration 214: log likelihood = -54643.963  (not concave)
Iteration 215: log likelihood = -54643.963  (not concave)
Iteration 216: log likelihood = -54643.963  (not concave)
Iteration 217: log likelihood = -54643.963  (not concave)
Iteration 218: log likelihood = -54643.963  (not concave)
Iteration 219: log likelihood = -54643.963  (not concave)
Iteration 220: log likelihood = -54643.963  (not concave)
Iteration 221: log likelihood = -54643.963  (not concave)
Iteration 222: log likelihood = -54643.963  (not concave)
Iteration 223: log likelihood = -54643.963  (not concave)
Iteration 224: log likelihood = -54643.963  (not concave)
Iteration 225: log likelihood = -54643.963  (not concave)
Iteration 226: log likelihood = -54643.963  (not concave)
Iteration 227: log likelihood = -54643.963  (not concave)
Iteration 228: log likelihood = -54643.963  (not concave)
Iteration 229: log likelihood = -54643.963  (not concave)
Iteration 230: log likelihood = -54643.963  (not concave)
Iteration 231: log likelihood = -54643.963  (not concave)
Iteration 232: log likelihood = -54643.963  (not concave)
Iteration 233: log likelihood = -54643.963  (not concave)
Iteration 234: log likelihood = -54643.963  (not concave)
Iteration 235: log likelihood = -54643.963  (not concave)
Iteration 236: log likelihood = -54643.963  (not concave)
Iteration 237: log likelihood = -54643.963  (not concave)
Iteration 238: log likelihood = -54643.963  (not concave)
Iteration 239: log likelihood = -54643.963  (not concave)
Iteration 240: log likelihood = -54643.963  (not concave)
Iteration 241: log likelihood = -54643.963  (not concave)
Iteration 242: log likelihood = -54643.963  (not concave)
Iteration 243: log likelihood = -54643.963  (not concave)
Iteration 244: log likelihood = -54643.963  (not concave)
Iteration 245: log likelihood = -54643.963  (not concave)
Iteration 246: log likelihood = -54643.963  (not concave)
Iteration 247: log likelihood = -54643.963  (not concave)
Iteration 248: log likelihood = -54643.963  (not concave)
Iteration 249: log likelihood = -54643.963  (not concave)
Iteration 250: log likelihood = -54643.963  (not concave)
Iteration 251: log likelihood = -54643.963  (not concave)
Iteration 252: log likelihood = -54643.963  (not concave)
Iteration 253: log likelihood = -54643.963  (not concave)
Iteration 254: log likelihood = -54643.963  (not concave)
Iteration 255: log likelihood = -54643.963  (not concave)
Iteration 256: log likelihood = -54643.963  (not concave)
Iteration 257: log likelihood = -54643.963  (not concave)
Iteration 258: log likelihood = -54643.963  (not concave)
Iteration 259: log likelihood = -54643.963  (not concave)
Iteration 260: log likelihood = -54643.963  (not concave)
Iteration 261: log likelihood = -54643.963  (not concave)
Iteration 262: log likelihood = -54643.963  (not concave)
Iteration 263: log likelihood = -54643.963  (not concave)
Iteration 264: log likelihood = -54643.963  (not concave)
Iteration 265: log likelihood = -54643.963  (not concave)
Iteration 266: log likelihood = -54643.963  (not concave)
Iteration 267: log likelihood = -54643.963  (not concave)
Iteration 268: log likelihood = -54643.963  (not concave)
Iteration 269: log likelihood = -54643.963  (not concave)
Iteration 270: log likelihood = -54643.963  (not concave)
Iteration 271: log likelihood = -54643.963  (not concave)
Iteration 272: log likelihood = -54643.963  (not concave)
Iteration 273: log likelihood = -54643.963  (not concave)
Iteration 274: log likelihood = -54643.963  (not concave)
Iteration 275: log likelihood = -54643.963  (not concave)
Iteration 276: log likelihood = -54643.963  (not concave)
Iteration 277: log likelihood = -54643.963  (not concave)
Iteration 278: log likelihood = -54643.963  (not concave)
Iteration 279: log likelihood = -54643.963  (not concave)
Iteration 280: log likelihood = -54643.963  (not concave)
Iteration 281: log likelihood = -54643.963  (not concave)
Iteration 282: log likelihood = -54643.963  (not concave)
Iteration 283: log likelihood = -54643.963  (not concave)
Iteration 284: log likelihood = -54643.963  (not concave)
Iteration 285: log likelihood = -54643.963  (not concave)
Iteration 286: log likelihood = -54643.963  (not concave)
Iteration 287: log likelihood = -54643.963  (not concave)
Iteration 288: log likelihood = -54643.963  (not concave)
Iteration 289: log likelihood = -54643.963  (not concave)
Iteration 290: log likelihood = -54643.963  (not concave)
Iteration 291: log likelihood = -54643.963  (not concave)
Iteration 292: log likelihood = -54643.963  (not concave)
Iteration 293: log likelihood = -54643.963  (not concave)
Iteration 294: log likelihood = -54643.963  (not concave)
Iteration 295: log likelihood = -54643.963  (not concave)
Iteration 296: log likelihood = -54643.963  (not concave)
Iteration 297: log likelihood = -54643.963  (not concave)
Iteration 298: log likelihood = -54643.963  (not concave)
Iteration 299: log likelihood = -54643.963  (not concave)
Iteration 300: log likelihood = -54643.963  (not concave)
convergence not achieved

Survival model                                  Number of obs     =     59,220
Log likelihood = -54643.963
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |  -.0479378          .        .       .            .           .
edad_al_in~t |   .0049037   2.61e-07  1.9e+04   0.000     .0049031    .0049042
edad_ini_c~s |   .0065026          .        .       .            .           .
     sex_enc |   .0551389          .        .       .            .           .
     esc_rec |  -.0250581          .        .       .            .           .
sus_prin_mod |  -.0951991          .        .       .            .           .
 fr_sus_prin |  -.0188162          .        .       .            .           .
 comp_biosoc |  -.0551384          .        .       .            .           .
     ten_viv |  -.0007527   2.86e-06  -262.79   0.000    -.0007583    -.000747
origen_ing~d |    .021881          .        .       .            .           .
numero_de_~d |   .0156786          .        .       .            .           .
dg_cie_10_~c |  -.0108864          .        .       .            .           .
sud_sever~10 |   .0531683          .        .       .            .           .
   macrozone |  -.0742146          .        .       .            .           .
 policonsumo |  -.1503265          .        .       .            .           .
   n_off_vio |  -.7913741          .        .       .            .           .
   n_off_acq |  -1.585247          .        .       .            .           .
   n_off_sud |  -.6483057          .        .       .            .           .
        clas |   .0025514          .        .       .            .           .
       _cons |    .006844          .        .       .            .           .
  log(sigma) |   .9306268          .        .       .            .           .
       kappa |   1.389982   .0000415  3.4e+04   0.000     1.389901    1.390064
------------------------------------------------------------------------------

.         //qui cap noi merlin (_time $covs if _trans == 1, family(ggamma, fail(_status)))
.         estimates store m2_1_ggam

. 
.         // Royston Parmar models
.         forvalues j=1/10 {
  2.                 di in yellow &quot;{bf: ***********}&quot;
  3.                 di in yellow &quot;{bf: family RP`j'}&quot;
  4.                 di in yellow &quot;{bf: ***********}&quot;
  5.                 set seed 2125
  6.                 qui cap noi stmerlin $covs_2, dist(rp) df(`j')
  7.                 //qui cap noi merlin (_time $covs if _trans == 1, family(rp, df(`j') fail(_status)))
.                 estimates store m2_1_rp`j'
  8.                 *estimates save &quot;${pathdata2}parmodels.ster&quot;, append    
.         }       
 ***********
 family RP1
 ***********
note; a delayed entry model is being fitted
variables created: _rcs1_1 to _rcs1_1

Fitting full model:

Iteration 0:   log likelihood = -68543.374  (not concave)
Iteration 1:   log likelihood = -59414.105  (not concave)
Iteration 2:   log likelihood = -56468.637  
Iteration 3:   log likelihood = -53923.756  
Iteration 4:   log likelihood = -53806.274  (not concave)
Iteration 5:   log likelihood = -53799.134  
Iteration 6:   log likelihood = -53768.373  (backed up)
Iteration 7:   log likelihood = -53742.734  
Iteration 8:   log likelihood = -53700.297  
Iteration 9:   log likelihood = -53686.819  
Iteration 10:  log likelihood = -53672.288  
Iteration 11:  log likelihood = -53671.714  
Iteration 12:  log likelihood = -53665.162  (not concave)
Iteration 13:  log likelihood = -53665.111  
Iteration 14:  log likelihood = -53664.331  
Iteration 15:  log likelihood = -53660.656  (not concave)
Iteration 16:  log likelihood = -53660.546  
Iteration 17:  log likelihood = -53659.445  
Iteration 18:  log likelihood = -53656.926  
Iteration 19:  log likelihood = -53655.851  
Iteration 20:  log likelihood = -53654.166  
Iteration 21:  log likelihood =  -53653.42  
Iteration 22:  log likelihood = -53652.278  
Iteration 23:  log likelihood = -53651.635  
Iteration 24:  log likelihood =  -53650.66  
Iteration 25:  log likelihood = -53649.737  
Iteration 26:  log likelihood = -53649.565  
Iteration 27:  log likelihood = -53648.898  (not concave)
Iteration 28:  log likelihood = -53648.897  
Iteration 29:  log likelihood = -53648.749  
Iteration 30:  log likelihood = -53648.578  
Iteration 31:  log likelihood =  -53648.13  
Iteration 32:  log likelihood = -53648.024  
Iteration 33:  log likelihood = -53647.847  
Iteration 34:  log likelihood = -53647.668  
Iteration 35:  log likelihood = -53647.397  
Iteration 36:  log likelihood = -53647.331  
Iteration 37:  log likelihood = -53647.227  
Iteration 38:  log likelihood = -53647.084  
Iteration 39:  log likelihood = -53647.055  
Iteration 40:  log likelihood = -53646.931  (not concave)
Iteration 41:  log likelihood = -53646.928  
Iteration 42:  log likelihood = -53646.887  
Iteration 43:  log likelihood = -53646.813  
Iteration 44:  log likelihood = -53646.743  
Iteration 45:  log likelihood = -53646.689  
Iteration 46:  log likelihood =  -53646.63  
Iteration 47:  log likelihood =  -53646.58  
Iteration 48:  log likelihood = -53646.511  
Iteration 49:  log likelihood = -53646.499  
Iteration 50:  log likelihood = -53646.435  (not concave)
Iteration 51:  log likelihood = -53646.433  
Iteration 52:  log likelihood = -53646.413  
Iteration 53:  log likelihood = -53646.394  
Iteration 54:  log likelihood = -53646.299  (not concave)
Iteration 55:  log likelihood = -53646.295  
Iteration 56:  log likelihood = -53646.277  (backed up)
Iteration 57:  log likelihood = -53646.258  
Iteration 58:  log likelihood = -53646.206  
Iteration 59:  log likelihood = -53646.198  
Iteration 60:  log likelihood = -53646.165  (not concave)
Iteration 61:  log likelihood = -53646.164  
Iteration 62:  log likelihood = -53646.151  (backed up)
Iteration 63:  log likelihood = -53646.132  
Iteration 64:  log likelihood = -53646.106  
Iteration 65:  log likelihood = -53646.091  
Iteration 66:  log likelihood = -53646.069  
Iteration 67:  log likelihood = -53646.053  
Iteration 68:  log likelihood = -53646.035  
Iteration 69:  log likelihood = -53646.016  
Iteration 70:  log likelihood = -53646.006  
Iteration 71:  log likelihood = -53645.988  
Iteration 72:  log likelihood = -53645.957  
Iteration 73:  log likelihood = -53645.953  
Iteration 74:  log likelihood =  -53645.94  (not concave)
Iteration 75:  log likelihood = -53645.939  
Iteration 76:  log likelihood = -53645.934  
Iteration 77:  log likelihood = -53645.922  
Iteration 78:  log likelihood = -53645.899  (not concave)
Iteration 79:  log likelihood = -53645.899  
Iteration 80:  log likelihood = -53645.895  
Iteration 81:  log likelihood = -53645.886  
Iteration 82:  log likelihood = -53645.884  
Iteration 83:  log likelihood = -53645.874  (not concave)
Iteration 84:  log likelihood = -53645.874  
Iteration 85:  log likelihood = -53645.871  
Iteration 86:  log likelihood = -53645.868  
Iteration 87:  log likelihood = -53645.852  
Iteration 88:  log likelihood = -53645.849  
Iteration 89:  log likelihood = -53645.846  
Iteration 90:  log likelihood = -53645.834  
Iteration 91:  log likelihood = -53645.828  
Iteration 92:  log likelihood = -53645.824  
Iteration 93:  log likelihood = -53645.821  
Iteration 94:  log likelihood = -53645.816  
Iteration 95:  log likelihood = -53645.813  
Iteration 96:  log likelihood = -53645.806  
Iteration 97:  log likelihood = -53645.804  
Iteration 98:  log likelihood = -53645.799  
Iteration 99:  log likelihood = -53645.792  
Iteration 100: log likelihood = -53645.787  (not concave)
Iteration 101: log likelihood = -53645.787  (backed up)
Iteration 102: log likelihood = -53645.785  
Iteration 103: log likelihood = -53645.783  
Iteration 104: log likelihood = -53645.781  
Iteration 105: log likelihood = -53645.777  
Iteration 106: log likelihood = -53645.774  
Iteration 107: log likelihood = -53645.773  
Iteration 108: log likelihood = -53645.768  (not concave)
Iteration 109: log likelihood = -53645.767  
Iteration 110: log likelihood = -53645.767  
Iteration 111: log likelihood = -53645.762  (not concave)
Iteration 112: log likelihood = -53645.762  (not concave)
Iteration 113: log likelihood = -53645.762  
Iteration 114: log likelihood = -53645.761  (backed up)
Iteration 115: log likelihood =  -53645.76  
Iteration 116: log likelihood = -53645.756  (not concave)
Iteration 117: log likelihood = -53645.756  (not concave)
Iteration 118: log likelihood = -53645.756  
Iteration 119: log likelihood = -53645.755  
Iteration 120: log likelihood = -53645.754  
Iteration 121: log likelihood = -53645.752  
Iteration 122: log likelihood = -53645.751  
Iteration 123: log likelihood = -53645.749  
Iteration 124: log likelihood = -53645.748  
Iteration 125: log likelihood = -53645.746  
Iteration 126: log likelihood = -53645.745  
Iteration 127: log likelihood = -53645.743  
Iteration 128: log likelihood = -53645.742  
Iteration 129: log likelihood =  -53645.74  
Iteration 130: log likelihood = -53645.738  (not concave)
Iteration 131: log likelihood = -53645.737  
Iteration 132: log likelihood = -53645.737  
Iteration 133: log likelihood = -53645.736  
Iteration 134: log likelihood = -53645.735  
Iteration 135: log likelihood = -53645.734  
Iteration 136: log likelihood = -53645.733  
Iteration 137: log likelihood = -53645.732  
Iteration 138: log likelihood = -53645.732  
Iteration 139: log likelihood =  -53645.73  
Iteration 140: log likelihood =  -53645.73  
Iteration 141: log likelihood = -53645.729  
Iteration 142: log likelihood = -53645.728  
Iteration 143: log likelihood = -53645.728  
Iteration 144: log likelihood = -53645.727  
Iteration 145: log likelihood = -53645.726  
Iteration 146: log likelihood = -53645.725  
Iteration 147: log likelihood = -53645.725  
Iteration 148: log likelihood = -53645.724  
Iteration 149: log likelihood = -53645.723  
Iteration 150: log likelihood = -53645.723  
Iteration 151: log likelihood = -53645.722  
Iteration 152: log likelihood = -53645.721  
Iteration 153: log likelihood =  -53645.72  
Iteration 154: log likelihood =  -53645.72  
Iteration 155: log likelihood =  -53645.72  
Iteration 156: log likelihood = -53645.719  
Iteration 157: log likelihood = -53645.719  
Iteration 158: log likelihood = -53645.718  
Iteration 159: log likelihood = -53645.718  
Iteration 160: log likelihood = -53645.717  
Iteration 161: log likelihood = -53645.717  (not concave)
Iteration 162: log likelihood = -53645.717  
Iteration 163: log likelihood = -53645.717  
Iteration 164: log likelihood = -53645.716  
Iteration 165: log likelihood = -53645.716  
Iteration 166: log likelihood = -53645.715  
Iteration 167: log likelihood = -53645.714  
Iteration 168: log likelihood = -53645.714  
Iteration 169: log likelihood = -53645.713  (not concave)
Iteration 170: log likelihood = -53645.713  
Iteration 171: log likelihood = -53645.713  
Iteration 172: log likelihood = -53645.713  
Iteration 173: log likelihood = -53645.712  
Iteration 174: log likelihood = -53645.712  
Iteration 175: log likelihood = -53645.712  (not concave)
Iteration 176: log likelihood = -53645.712  
Iteration 177: log likelihood = -53645.712  
Iteration 178: log likelihood = -53645.711  (not concave)
Iteration 179: log likelihood = -53645.711  
Iteration 180: log likelihood = -53645.711  
Iteration 181: log likelihood =  -53645.71  
Iteration 182: log likelihood =  -53645.71  
Iteration 183: log likelihood =  -53645.71  
Iteration 184: log likelihood = -53645.709  
Iteration 185: log likelihood = -53645.709  
Iteration 186: log likelihood = -53645.709  
Iteration 187: log likelihood = -53645.709  
Iteration 188: log likelihood = -53645.708  
Iteration 189: log likelihood = -53645.708  
Iteration 190: log likelihood = -53645.708  
Iteration 191: log likelihood = -53645.708  
Iteration 192: log likelihood = -53645.707  
Iteration 193: log likelihood = -53645.707  
Iteration 194: log likelihood = -53645.707  
Iteration 195: log likelihood = -53645.707  
Iteration 196: log likelihood = -53645.707  
Iteration 197: log likelihood = -53645.706  
Iteration 198: log likelihood = -53645.706  
Iteration 199: log likelihood = -53645.706  
Iteration 200: log likelihood = -53645.706  
Iteration 201: log likelihood = -53645.706  
Iteration 202: log likelihood = -53645.705  
Iteration 203: log likelihood = -53645.705  
Iteration 204: log likelihood = -53645.705  
Iteration 205: log likelihood = -53645.705  (not concave)
Iteration 206: log likelihood = -53645.705  
Iteration 207: log likelihood = -53645.705  
Iteration 208: log likelihood = -53645.705  
Iteration 209: log likelihood = -53645.704  
Iteration 210: log likelihood = -53645.704  
Iteration 211: log likelihood = -53645.704  
Iteration 212: log likelihood = -53645.704  
Iteration 213: log likelihood = -53645.704  
Iteration 214: log likelihood = -53645.703  
Iteration 215: log likelihood = -53645.703  
Iteration 216: log likelihood = -53645.703  
Iteration 217: log likelihood = -53645.703  
Iteration 218: log likelihood = -53645.703  
Iteration 219: log likelihood = -53645.703  
Iteration 220: log likelihood = -53645.703  
Iteration 221: log likelihood = -53645.703  
Iteration 222: log likelihood = -53645.702  
Iteration 223: log likelihood = -53645.702  
Iteration 224: log likelihood = -53645.702  
Iteration 225: log likelihood = -53645.702  
Iteration 226: log likelihood = -53645.702  (not concave)
Iteration 227: log likelihood = -53645.702  (backed up)
Iteration 228: log likelihood = -53645.702  (backed up)
Iteration 229: log likelihood = -53645.702  (not concave)
Iteration 230: log likelihood = -53645.702  (backed up)
Iteration 231: log likelihood = -53645.701  
Iteration 232: log likelihood = -53645.701  
Iteration 233: log likelihood = -53645.701  (not concave)
Iteration 234: log likelihood = -53645.701  (backed up)
Iteration 235: log likelihood = -53645.701  
Iteration 236: log likelihood = -53645.701  
Iteration 237: log likelihood = -53645.701  
Iteration 238: log likelihood = -53645.701  
Iteration 239: log likelihood = -53645.701  
Iteration 240: log likelihood = -53645.701  
Iteration 241: log likelihood = -53645.701  
Iteration 242: log likelihood =   -53645.7  
Iteration 243: log likelihood =   -53645.7  
Iteration 244: log likelihood =   -53645.7  
Iteration 245: log likelihood =   -53645.7  
Iteration 246: log likelihood =   -53645.7  (not concave)
Iteration 247: log likelihood =   -53645.7  
Iteration 248: log likelihood =   -53645.7  
Iteration 249: log likelihood =   -53645.7  (not concave)
Iteration 250: log likelihood =   -53645.7  
Iteration 251: log likelihood =   -53645.7  
Iteration 252: log likelihood =   -53645.7  
Iteration 253: log likelihood = -53645.699  
Iteration 254: log likelihood = -53645.699  
Iteration 255: log likelihood = -53645.699  
Iteration 256: log likelihood = -53645.699  
Iteration 257: log likelihood = -53645.699  
Iteration 258: log likelihood = -53645.699  
Iteration 259: log likelihood = -53645.699  
Iteration 260: log likelihood = -53645.699  
Iteration 261: log likelihood = -53645.699  
Iteration 262: log likelihood = -53645.699  
Iteration 263: log likelihood = -53645.699  
Iteration 264: log likelihood = -53645.699  
Iteration 265: log likelihood = -53645.699  (not concave)
Iteration 266: log likelihood = -53645.699  
Iteration 267: log likelihood = -53645.699  
Iteration 268: log likelihood = -53645.698  
Iteration 269: log likelihood = -53645.698  
Iteration 270: log likelihood = -53645.698  
Iteration 271: log likelihood = -53645.698  
Iteration 272: log likelihood = -53645.698  (not concave)
Iteration 273: log likelihood = -53645.698  (backed up)
Iteration 274: log likelihood = -53645.698  
Iteration 275: log likelihood = -53645.698  
Iteration 276: log likelihood = -53645.698  
Iteration 277: log likelihood = -53645.698  
Iteration 278: log likelihood = -53645.698  
Iteration 279: log likelihood = -53645.698  
Iteration 280: log likelihood = -53645.698  
Iteration 281: log likelihood = -53645.698  
Iteration 282: log likelihood = -53645.698  
Iteration 283: log likelihood = -53645.698  
Iteration 284: log likelihood = -53645.698  
Iteration 285: log likelihood = -53645.698  
Iteration 286: log likelihood = -53645.697  
Iteration 287: log likelihood = -53645.697  
Iteration 288: log likelihood = -53645.697  
Iteration 289: log likelihood = -53645.697  
Iteration 290: log likelihood = -53645.697  
Iteration 291: log likelihood = -53645.697  
Iteration 292: log likelihood = -53645.697  
Iteration 293: log likelihood = -53645.697  
Iteration 294: log likelihood = -53645.697  
Iteration 295: log likelihood = -53645.697  
Iteration 296: log likelihood = -53645.697  
Iteration 297: log likelihood = -53645.697  
Iteration 298: log likelihood = -53645.697  
Iteration 299: log likelihood = -53645.697  
Iteration 300: log likelihood = -53645.697  
convergence not achieved

Survival model                                  Number of obs     =     59,220
Log likelihood = -53645.697
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1512184   .0097603    15.49   0.000     .1320886    .1703482
edad_al_in~t |  -.0105266   .0010111   -10.41   0.000    -.0125082   -.0085449
edad_ini_c~s |  -.0105118   .0018807    -5.59   0.000    -.0141978   -.0068258
     sex_enc |  -.3362608   .0202514   -16.60   0.000    -.3759529   -.2965688
     esc_rec |   .0938482   .0122859     7.64   0.000     .0697682    .1179282
sus_prin_mod |    .133169   .0081797    16.28   0.000     .1171371    .1492009
 fr_sus_prin |   .0325405   .0075673     4.30   0.000     .0177089    .0473722
 comp_biosoc |   .1952938   .0141677    13.78   0.000     .1675255     .223062
     ten_viv |  -.0155559   .0076349    -2.04   0.042      -.03052   -.0005918
origen_ing~d |  -.0206226   .0044051    -4.68   0.000    -.0292565   -.0119887
numero_de_~d |   .0730449   .0062653    11.66   0.000     .0607651    .0853247
dg_cie_10_~c |   .0273008   .0087695     3.11   0.002      .010113    .0444887
sud_sever~10 |  -.0641622    .019158    -3.35   0.001    -.1017111   -.0266133
   macrozone |   .2084388   .0118062    17.66   0.000     .1852991    .2315786
 policonsumo |   .0945469   .0216191     4.37   0.000     .0521742    .1369196
   n_off_vio |   .3157269   .0186862    16.90   0.000     .2791027    .3523511
   n_off_acq |   .6677696   .0173964    38.39   0.000     .6336732    .7018659
   n_off_sud |   .2307908   .0183721    12.56   0.000     .1947821    .2667995
        clas |   .0133145   .0128286     1.04   0.299    -.0118292    .0384581
       _cons |   11.31353    1.02288    11.06   0.000     9.308724    13.31834
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP2
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_2

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53628.366  (not concave)
Iteration 2:   log likelihood = -53613.593  (not concave)
Iteration 3:   log likelihood = -53606.709  (not concave)
Iteration 4:   log likelihood = -53601.077  
Iteration 5:   log likelihood = -53555.619  
Iteration 6:   log likelihood = -53367.815  
Iteration 7:   log likelihood = -53287.083  
Iteration 8:   log likelihood = -53223.654  
Iteration 9:   log likelihood = -53207.539  (not concave)
Iteration 10:  log likelihood =  -53207.53  
Iteration 11:  log likelihood = -53207.497  (not concave)
Iteration 12:  log likelihood = -53207.497  (backed up)
Iteration 13:  log likelihood = -53207.497  
Iteration 14:  log likelihood = -53207.497  
Iteration 15:  log likelihood = -53207.497  
Iteration 16:  log likelihood = -53207.497  
Iteration 17:  log likelihood = -53207.497  
Iteration 18:  log likelihood = -53207.497  
Iteration 19:  log likelihood = -53207.497  
Iteration 20:  log likelihood = -53207.497  
Iteration 21:  log likelihood = -53207.497  
Iteration 22:  log likelihood = -53207.497  
Iteration 23:  log likelihood = -53207.497  
Iteration 24:  log likelihood = -53207.497  
Iteration 25:  log likelihood = -53207.497  
Iteration 26:  log likelihood = -53207.497  
Iteration 27:  log likelihood = -53207.497  
Iteration 28:  log likelihood = -53207.497  
Iteration 29:  log likelihood = -53207.497  
Iteration 30:  log likelihood = -53207.497  
Iteration 31:  log likelihood = -53207.497  
Iteration 32:  log likelihood = -53207.497  
Iteration 33:  log likelihood = -53207.497  
Iteration 34:  log likelihood = -53207.497  
Iteration 35:  log likelihood = -53207.496  
Iteration 36:  log likelihood = -53207.496  
Iteration 37:  log likelihood = -53207.496  
Iteration 38:  log likelihood = -53207.496  
Iteration 39:  log likelihood = -53207.496  
Iteration 40:  log likelihood = -53207.496  
Iteration 41:  log likelihood = -53207.496  (not concave)
Iteration 42:  log likelihood = -53207.496  (backed up)
Iteration 43:  log likelihood = -53207.496  
Iteration 44:  log likelihood = -53207.496  
Iteration 45:  log likelihood = -53207.496  
Iteration 46:  log likelihood = -53207.496  
Iteration 47:  log likelihood = -53207.496  
Iteration 48:  log likelihood = -53207.496  
Iteration 49:  log likelihood = -53207.496  
Iteration 50:  log likelihood = -53207.496  
Iteration 51:  log likelihood = -53207.496  
Iteration 52:  log likelihood = -53207.496  
Iteration 53:  log likelihood = -53207.496  
Iteration 54:  log likelihood = -53207.496  
Iteration 55:  log likelihood = -53207.496  
Iteration 56:  log likelihood = -53207.496  
Iteration 57:  log likelihood = -53207.496  (not concave)
Iteration 58:  log likelihood = -53207.496  (backed up)
Iteration 59:  log likelihood = -53207.496  
Iteration 60:  log likelihood = -53207.496  
Iteration 61:  log likelihood = -53207.496  
Iteration 62:  log likelihood = -53207.496  
Iteration 63:  log likelihood = -53207.496  
Iteration 64:  log likelihood = -53207.496  
Iteration 65:  log likelihood = -53207.496  
Iteration 66:  log likelihood = -53207.496  
Iteration 67:  log likelihood = -53207.496  (not concave)
Iteration 68:  log likelihood = -53207.496  (not concave)
Iteration 69:  log likelihood = -53207.496  (backed up)
Iteration 70:  log likelihood = -53207.496  
Iteration 71:  log likelihood = -53207.496  
Iteration 72:  log likelihood = -53207.496  
Iteration 73:  log likelihood = -53207.496  
Iteration 74:  log likelihood = -53207.496  
Iteration 75:  log likelihood = -53207.496  
Iteration 76:  log likelihood = -53207.496  
Iteration 77:  log likelihood = -53207.496  
Iteration 78:  log likelihood = -53207.496  
Iteration 79:  log likelihood = -53207.496  
Iteration 80:  log likelihood = -53207.496  
Iteration 81:  log likelihood = -53207.496  
Iteration 82:  log likelihood = -53207.496  
Iteration 83:  log likelihood = -53207.496  
Iteration 84:  log likelihood = -53207.496  
Iteration 85:  log likelihood = -53207.496  
Iteration 86:  log likelihood = -53207.496  
Iteration 87:  log likelihood = -53207.496  
Iteration 88:  log likelihood = -53207.496  
Iteration 89:  log likelihood = -53207.496  (not concave)
Iteration 90:  log likelihood = -53207.496  (backed up)
Iteration 91:  log likelihood = -53207.496  
Iteration 92:  log likelihood = -53207.496  
Iteration 93:  log likelihood = -53207.496  (not concave)
Iteration 94:  log likelihood = -53207.496  (not concave)
Iteration 95:  log likelihood = -53207.496  (backed up)
Iteration 96:  log likelihood = -53207.496  (backed up)
Iteration 97:  log likelihood = -53207.496  
Iteration 98:  log likelihood = -53207.496  
Iteration 99:  log likelihood = -53207.496  (not concave)
Iteration 100: log likelihood = -53207.496  (backed up)
Iteration 101: log likelihood = -53207.496  
Iteration 102: log likelihood = -53207.496  (not concave)
Iteration 103: log likelihood = -53207.496  (not concave)
Iteration 104: log likelihood = -53207.496  (not concave)
Iteration 105: log likelihood = -53207.496  (not concave)
Iteration 106: log likelihood = -53207.496  (not concave)
Iteration 107: log likelihood = -53207.496  (not concave)
Iteration 108: log likelihood = -53207.496  (not concave)
Iteration 109: log likelihood = -53207.496  (not concave)
Iteration 110: log likelihood = -53207.496  (not concave)
Iteration 111: log likelihood = -53207.496  (not concave)
Iteration 112: log likelihood = -53207.496  (not concave)
Iteration 113: log likelihood = -53207.496  (not concave)
Iteration 114: log likelihood = -53207.496  (not concave)
Iteration 115: log likelihood = -53207.496  (not concave)
Iteration 116: log likelihood = -53207.496  (not concave)
Iteration 117: log likelihood = -53207.496  (not concave)
Iteration 118: log likelihood = -53207.496  (not concave)
Iteration 119: log likelihood = -53207.496  (not concave)
Iteration 120: log likelihood = -53207.496  (not concave)
Iteration 121: log likelihood = -53207.496  (not concave)
Iteration 122: log likelihood = -53207.496  (not concave)
Iteration 123: log likelihood = -53207.496  (not concave)
Iteration 124: log likelihood = -53207.496  (not concave)
Iteration 125: log likelihood = -53207.496  (not concave)
Iteration 126: log likelihood = -53207.496  (not concave)
Iteration 127: log likelihood = -53207.496  (not concave)
Iteration 128: log likelihood = -53207.496  (not concave)
Iteration 129: log likelihood = -53207.496  (not concave)
Iteration 130: log likelihood = -53207.496  (not concave)
Iteration 131: log likelihood = -53207.496  (not concave)
Iteration 132: log likelihood = -53207.496  (not concave)
Iteration 133: log likelihood = -53207.496  (not concave)
Iteration 134: log likelihood = -53207.496  (not concave)
Iteration 135: log likelihood = -53207.496  (not concave)
Iteration 136: log likelihood = -53207.496  (not concave)
Iteration 137: log likelihood = -53207.496  (not concave)
Iteration 138: log likelihood = -53207.496  (not concave)
Iteration 139: log likelihood = -53207.496  (not concave)
Iteration 140: log likelihood = -53207.496  (not concave)
Iteration 141: log likelihood = -53207.496  (not concave)
Iteration 142: log likelihood = -53207.496  (not concave)
Iteration 143: log likelihood = -53207.496  (not concave)
Iteration 144: log likelihood = -53207.496  (not concave)
Iteration 145: log likelihood = -53207.496  (not concave)
Iteration 146: log likelihood = -53207.496  (not concave)
Iteration 147: log likelihood = -53207.496  (not concave)
Iteration 148: log likelihood = -53207.496  (not concave)
Iteration 149: log likelihood = -53207.496  (not concave)
Iteration 150: log likelihood = -53207.496  (not concave)
Iteration 151: log likelihood = -53207.496  (not concave)
Iteration 152: log likelihood = -53207.496  (not concave)
Iteration 153: log likelihood = -53207.496  (not concave)
Iteration 154: log likelihood = -53207.496  (not concave)
Iteration 155: log likelihood = -53207.496  (not concave)
Iteration 156: log likelihood = -53207.496  (not concave)
Iteration 157: log likelihood = -53207.496  (not concave)
Iteration 158: log likelihood = -53207.496  (not concave)
Iteration 159: log likelihood = -53207.496  (not concave)
Iteration 160: log likelihood = -53207.496  (not concave)
Iteration 161: log likelihood = -53207.496  (not concave)
Iteration 162: log likelihood = -53207.496  (not concave)
Iteration 163: log likelihood = -53207.496  (not concave)
Iteration 164: log likelihood = -53207.496  (not concave)
Iteration 165: log likelihood = -53207.496  (not concave)
Iteration 166: log likelihood = -53207.496  (not concave)
Iteration 167: log likelihood = -53207.496  (not concave)
Iteration 168: log likelihood = -53207.496  (not concave)
Iteration 169: log likelihood = -53207.496  (not concave)
Iteration 170: log likelihood = -53207.496  (not concave)
Iteration 171: log likelihood = -53207.496  (not concave)
Iteration 172: log likelihood = -53207.496  (not concave)
Iteration 173: log likelihood = -53207.496  (not concave)
Iteration 174: log likelihood = -53207.496  (not concave)
Iteration 175: log likelihood = -53207.496  (not concave)
Iteration 176: log likelihood = -53207.496  (not concave)
Iteration 177: log likelihood = -53207.496  (not concave)
Iteration 178: log likelihood = -53207.496  (not concave)
Iteration 179: log likelihood = -53207.496  (not concave)
Iteration 180: log likelihood = -53207.496  (not concave)
Iteration 181: log likelihood = -53207.496  (not concave)
Iteration 182: log likelihood = -53207.496  (not concave)
Iteration 183: log likelihood = -53207.496  (not concave)
Iteration 184: log likelihood = -53207.496  (not concave)
Iteration 185: log likelihood = -53207.496  (not concave)
Iteration 186: log likelihood = -53207.496  (not concave)
Iteration 187: log likelihood = -53207.496  (not concave)
Iteration 188: log likelihood = -53207.496  (not concave)
Iteration 189: log likelihood = -53207.496  (not concave)
Iteration 190: log likelihood = -53207.496  (not concave)
Iteration 191: log likelihood = -53207.496  (not concave)
Iteration 192: log likelihood = -53207.496  (not concave)
Iteration 193: log likelihood = -53207.496  (not concave)
Iteration 194: log likelihood = -53207.496  (not concave)
Iteration 195: log likelihood = -53207.496  (not concave)
Iteration 196: log likelihood = -53207.496  (not concave)
Iteration 197: log likelihood = -53207.496  (not concave)
Iteration 198: log likelihood = -53207.496  (not concave)
Iteration 199: log likelihood = -53207.496  (not concave)
Iteration 200: log likelihood = -53207.496  (not concave)
Iteration 201: log likelihood = -53207.496  (not concave)
Iteration 202: log likelihood = -53207.496  (not concave)
Iteration 203: log likelihood = -53207.496  (not concave)
Iteration 204: log likelihood = -53207.496  (not concave)
Iteration 205: log likelihood = -53207.496  (not concave)
Iteration 206: log likelihood = -53207.496  (not concave)
Iteration 207: log likelihood = -53207.496  (not concave)
Iteration 208: log likelihood = -53207.496  (not concave)
Iteration 209: log likelihood = -53207.496  (not concave)
Iteration 210: log likelihood = -53207.496  (not concave)
Iteration 211: log likelihood = -53207.496  (not concave)
Iteration 212: log likelihood = -53207.496  (not concave)
Iteration 213: log likelihood = -53207.496  (not concave)
Iteration 214: log likelihood = -53207.496  (not concave)
Iteration 215: log likelihood = -53207.496  (not concave)
Iteration 216: log likelihood = -53207.496  (not concave)
Iteration 217: log likelihood = -53207.496  (not concave)
Iteration 218: log likelihood = -53207.496  (not concave)
Iteration 219: log likelihood = -53207.496  (not concave)
Iteration 220: log likelihood = -53207.496  (not concave)
Iteration 221: log likelihood = -53207.496  (not concave)
Iteration 222: log likelihood = -53207.496  (not concave)
Iteration 223: log likelihood = -53207.496  (not concave)
Iteration 224: log likelihood = -53207.496  (not concave)
Iteration 225: log likelihood = -53207.496  (not concave)
Iteration 226: log likelihood = -53207.496  (not concave)
Iteration 227: log likelihood = -53207.496  (not concave)
Iteration 228: log likelihood = -53207.496  (not concave)
Iteration 229: log likelihood = -53207.496  (not concave)
Iteration 230: log likelihood = -53207.496  (not concave)
Iteration 231: log likelihood = -53207.496  (not concave)
Iteration 232: log likelihood = -53207.496  (not concave)
Iteration 233: log likelihood = -53207.496  (not concave)
Iteration 234: log likelihood = -53207.496  (not concave)
Iteration 235: log likelihood = -53207.496  (not concave)
Iteration 236: log likelihood = -53207.496  (not concave)
Iteration 237: log likelihood = -53207.496  (not concave)
Iteration 238: log likelihood = -53207.496  (not concave)
Iteration 239: log likelihood = -53207.496  (not concave)
Iteration 240: log likelihood = -53207.496  (not concave)
Iteration 241: log likelihood = -53207.496  (not concave)
Iteration 242: log likelihood = -53207.496  (not concave)
Iteration 243: log likelihood = -53207.496  (not concave)
Iteration 244: log likelihood = -53207.496  (not concave)
Iteration 245: log likelihood = -53207.496  (not concave)
Iteration 246: log likelihood = -53207.496  (not concave)
Iteration 247: log likelihood = -53207.496  (not concave)
Iteration 248: log likelihood = -53207.496  (not concave)
Iteration 249: log likelihood = -53207.496  (not concave)
Iteration 250: log likelihood = -53207.496  (not concave)
Iteration 251: log likelihood = -53207.496  (not concave)
Iteration 252: log likelihood = -53207.496  (not concave)
Iteration 253: log likelihood = -53207.496  (not concave)
Iteration 254: log likelihood = -53207.496  (not concave)
Iteration 255: log likelihood = -53207.496  (not concave)
Iteration 256: log likelihood = -53207.496  (not concave)
Iteration 257: log likelihood = -53207.496  (not concave)
Iteration 258: log likelihood = -53207.496  (not concave)
Iteration 259: log likelihood = -53207.496  (not concave)
Iteration 260: log likelihood = -53207.496  (not concave)
Iteration 261: log likelihood = -53207.496  (not concave)
Iteration 262: log likelihood = -53207.496  (not concave)
Iteration 263: log likelihood = -53207.496  (not concave)
Iteration 264: log likelihood = -53207.496  (not concave)
Iteration 265: log likelihood = -53207.496  (not concave)
Iteration 266: log likelihood = -53207.496  (not concave)
Iteration 267: log likelihood = -53207.496  (not concave)
Iteration 268: log likelihood = -53207.496  (not concave)
Iteration 269: log likelihood = -53207.496  (not concave)
Iteration 270: log likelihood = -53207.496  (not concave)
Iteration 271: log likelihood = -53207.496  (not concave)
Iteration 272: log likelihood = -53207.496  (not concave)
Iteration 273: log likelihood = -53207.496  (not concave)
Iteration 274: log likelihood = -53207.496  (not concave)
Iteration 275: log likelihood = -53207.496  (not concave)
Iteration 276: log likelihood = -53207.496  (not concave)
Iteration 277: log likelihood = -53207.496  (not concave)
Iteration 278: log likelihood = -53207.496  (not concave)
Iteration 279: log likelihood = -53207.496  (not concave)
Iteration 280: log likelihood = -53207.496  (not concave)
Iteration 281: log likelihood = -53207.496  (not concave)
Iteration 282: log likelihood = -53207.496  (not concave)
Iteration 283: log likelihood = -53207.496  (not concave)
Iteration 284: log likelihood = -53207.496  (not concave)
Iteration 285: log likelihood = -53207.496  (not concave)
Iteration 286: log likelihood = -53207.496  (not concave)
Iteration 287: log likelihood = -53207.496  (not concave)
Iteration 288: log likelihood = -53207.496  (not concave)
Iteration 289: log likelihood = -53207.496  (not concave)
Iteration 290: log likelihood = -53207.496  (not concave)
Iteration 291: log likelihood = -53207.496  (not concave)
Iteration 292: log likelihood = -53207.496  (not concave)
Iteration 293: log likelihood = -53207.496  (not concave)
Iteration 294: log likelihood = -53207.496  (not concave)
Iteration 295: log likelihood = -53207.496  (not concave)
Iteration 296: log likelihood = -53207.496  (not concave)
Iteration 297: log likelihood = -53207.496  (not concave)
Iteration 298: log likelihood = -53207.496  (not concave)
Iteration 299: log likelihood = -53207.496  (not concave)
Iteration 300: log likelihood = -53207.496  (not concave)
convergence not achieved

Survival model                                  Number of obs     =     59,220
Log likelihood = -53207.496
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1461351    .009802    14.91   0.000     .1269236    .1653466
edad_al_in~t |   .0553495   .0011327    48.86   0.000     .0531294    .0575697
edad_ini_c~s |  -.0090922   .0019056    -4.77   0.000    -.0128271   -.0053574
     sex_enc |  -.3266237   .0202698   -16.11   0.000    -.3663517   -.2868958
     esc_rec |   .1106297   .0123039     8.99   0.000     .0865144    .1347449
sus_prin_mod |   .1319657   .0082226    16.05   0.000     .1158497    .1480818
 fr_sus_prin |   .0339954   .0075653     4.49   0.000     .0191677    .0488231
 comp_biosoc |    .192688    .014181    13.59   0.000     .1648937    .2204822
     ten_viv |     -.0205   .0076192    -2.69   0.007    -.0354335   -.0055666
origen_ing~d |  -.0167578   .0044026    -3.81   0.000    -.0253867    -.008129
numero_de_~d |   .0658453   .0063078    10.44   0.000     .0534823    .0782084
dg_cie_10_~c |   .0275163   .0087881     3.13   0.002      .010292    .0447406
sud_sever~10 |   -.060729   .0191665    -3.17   0.002    -.0982946   -.0231634
   macrozone |    .208813   .0118102    17.68   0.000     .1856654    .2319606
 policonsumo |   .0957775   .0215603     4.44   0.000     .0535201    .1380349
   n_off_vio |    .297373   .0186667    15.93   0.000      .260787    .3339591
   n_off_acq |   .6433745   .0173541    37.07   0.000     .6093611     .677388
   n_off_sud |     .20504   .0183513    11.17   0.000     .1690721     .241008
        clas |   .0152561   .0128243     1.19   0.234    -.0098791    .0403913
       _cons |   10.03478          .        .       .            .           .
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP3
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_3

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53618.066  (not concave)
Iteration 2:   log likelihood = -53607.919  (not concave)
Iteration 3:   log likelihood = -53598.136  (not concave)
Iteration 4:   log likelihood = -53575.431  
Iteration 5:   log likelihood = -53448.178  
Iteration 6:   log likelihood = -53343.691  
Iteration 7:   log likelihood = -53270.312  
Iteration 8:   log likelihood = -53230.106  
Iteration 9:   log likelihood = -53192.427  
Iteration 10:  log likelihood = -53177.997  
Iteration 11:  log likelihood = -53177.972  
Iteration 12:  log likelihood = -53177.972  (backed up)
Iteration 13:  log likelihood = -53177.972  
Iteration 14:  log likelihood = -53177.972  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53177.972
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1469899   .0098137    14.98   0.000     .1277555    .1662244
edad_al_in~t |   .0629394   .0015243    41.29   0.000     .0599519    .0659269
edad_ini_c~s |  -.0088897   .0018947    -4.69   0.000    -.0126031   -.0051762
     sex_enc |    -.33087   .0202721   -16.32   0.000    -.3706026   -.2911375
     esc_rec |   .1019409   .0123485     8.26   0.000     .0777384    .1261434
sus_prin_mod |   .1321977   .0082164    16.09   0.000     .1160939    .1483014
 fr_sus_prin |   .0331604   .0075704     4.38   0.000     .0183226    .0479982
 comp_biosoc |   .1937294   .0141824    13.66   0.000     .1659325    .2215263
     ten_viv |  -.0187678   .0076237    -2.46   0.014      -.03371   -.0038256
origen_ing~d |  -.0169428   .0044033    -3.85   0.000    -.0255731   -.0083126
numero_de_~d |    .072369   .0063557    11.39   0.000     .0599121    .0848258
dg_cie_10_~c |   .0276594    .008792     3.15   0.002     .0104275    .0448913
sud_sever~10 |  -.0622664   .0191696    -3.25   0.001    -.0998382   -.0246946
   macrozone |   .2051548   .0118233    17.35   0.000     .1819816     .228328
 policonsumo |   .1057649   .0216252     4.89   0.000     .0633802    .1481495
   n_off_vio |   .2907629   .0186932    15.55   0.000     .2541249    .3274008
   n_off_acq |   .6349763   .0174053    36.48   0.000     .6008625    .6690901
   n_off_sud |   .2046077   .0183554    11.15   0.000     .1686319    .2405836
        clas |   .0156848   .0128202     1.22   0.221    -.0094423    .0408118
       _cons |   9.088624   1.929201     4.71   0.000     5.307459    12.86979
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP4
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_4

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53634.602  (not concave)
Iteration 2:   log likelihood = -53601.598  (not concave)
Iteration 3:   log likelihood = -53580.674  (not concave)
Iteration 4:   log likelihood = -53572.231  (not concave)
Iteration 5:   log likelihood = -53564.836  (not concave)
Iteration 6:   log likelihood = -53558.923  
Iteration 7:   log likelihood = -53449.483  
Iteration 8:   log likelihood = -53339.158  
Iteration 9:   log likelihood = -53269.243  
Iteration 10:  log likelihood =  -53227.05  
Iteration 11:  log likelihood = -53188.402  
Iteration 12:  log likelihood = -53172.566  
Iteration 13:  log likelihood = -53172.506  (not concave)
Iteration 14:  log likelihood = -53172.506  (not concave)
Iteration 15:  log likelihood = -53172.506  
Iteration 16:  log likelihood = -53172.506  
Iteration 17:  log likelihood = -53172.506  (not concave)
Iteration 18:  log likelihood = -53172.506  (backed up)
Iteration 19:  log likelihood = -53172.506  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53172.506
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1471763   .0098157    14.99   0.000     .1279379    .1664147
edad_al_in~t |   .0636702   .0017838    35.69   0.000      .060174    .0671663
edad_ini_c~s |   -.008857   .0018938    -4.68   0.000    -.0125688   -.0051452
     sex_enc |  -.3311091   .0202709   -16.33   0.000    -.3708394   -.2913788
     esc_rec |   .1005691   .0123608     8.14   0.000     .0763425    .1247958
sus_prin_mod |   .1319557    .008215    16.06   0.000     .1158546    .1480568
 fr_sus_prin |   .0328708   .0075729     4.34   0.000     .0180282    .0477134
 comp_biosoc |   .1937708   .0141832    13.66   0.000     .1659724    .2215693
     ten_viv |  -.0184132   .0076264    -2.41   0.016    -.0333607   -.0034658
origen_ing~d |  -.0170435   .0044041    -3.87   0.000    -.0256754   -.0084116
numero_de_~d |   .0731422   .0063574    11.51   0.000     .0606819    .0856024
dg_cie_10_~c |   .0276567   .0087927     3.15   0.002     .0104233    .0448901
sud_sever~10 |  -.0628518   .0191761    -3.28   0.001    -.1004362   -.0252673
   macrozone |   .2046697   .0118243    17.31   0.000     .1814945    .2278449
 policonsumo |    .106884   .0216342     4.94   0.000     .0644817    .1492862
   n_off_vio |   .2901055   .0186973    15.52   0.000     .2534595    .3267515
   n_off_acq |   .6340664   .0174122    36.42   0.000     .5999391    .6681937
   n_off_sud |   .2052205   .0183759    11.17   0.000     .1692044    .2412367
        clas |   .0155086   .0128208     1.21   0.226    -.0096196    .0406368
       _cons |   9.000405   2.579714     3.49   0.000     3.944259    14.05655
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP5
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_5

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53638.429  (not concave)
Iteration 2:   log likelihood = -53592.393  (not concave)
Iteration 3:   log likelihood = -53578.554  (not concave)
Iteration 4:   log likelihood =  -53570.23  (not concave)
Iteration 5:   log likelihood = -53561.942  (not concave)
Iteration 6:   log likelihood = -53548.284  
Iteration 7:   log likelihood = -53413.404  
Iteration 8:   log likelihood = -53254.425  
Iteration 9:   log likelihood = -53215.584  
Iteration 10:  log likelihood = -53176.196  
Iteration 11:  log likelihood = -53158.418  
Iteration 12:  log likelihood = -53158.238  (not concave)
Iteration 13:  log likelihood = -53158.238  (not concave)
Iteration 14:  log likelihood = -53158.238  
Iteration 15:  log likelihood = -53158.238  
Iteration 16:  log likelihood = -53158.238  
Iteration 17:  log likelihood = -53158.238  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53158.238
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1472819   .0098207    15.00   0.000     .1280336    .1665302
edad_al_in~t |   .0676838   .0019897    34.02   0.000      .063784    .0715836
edad_ini_c~s |   -.008623   .0018933    -4.55   0.000    -.0123338   -.0049122
     sex_enc |  -.3306428   .0202661   -16.32   0.000    -.3703635   -.2909221
     esc_rec |   .1003646   .0123671     8.12   0.000     .0761256    .1246036
sus_prin_mod |   .1304398   .0082231    15.86   0.000     .1143228    .1465568
 fr_sus_prin |   .0323469   .0075744     4.27   0.000     .0175015    .0471924
 comp_biosoc |   .1937924   .0141859    13.66   0.000     .1659885    .2215963
     ten_viv |  -.0182295   .0076284    -2.39   0.017    -.0331809   -.0032782
origen_ing~d |  -.0170826   .0044041    -3.88   0.000    -.0257144   -.0084508
numero_de_~d |   .0734358   .0063589    11.55   0.000     .0609726    .0858989
dg_cie_10_~c |   .0278537    .008794     3.17   0.002     .0106179    .0450895
sud_sever~10 |  -.0631253   .0191771    -3.29   0.001    -.1007119   -.0255388
   macrozone |   .2040259   .0118239    17.26   0.000     .1808515    .2272003
 policonsumo |    .108918   .0216479     5.03   0.000     .0664889     .151347
   n_off_vio |   .2891052   .0187001    15.46   0.000     .2524537    .3257567
   n_off_acq |   .6325364   .0174174    36.32   0.000      .598399    .6666738
   n_off_sud |   .2049345   .0183777    11.15   0.000     .1689149     .240954
        clas |   .0150853   .0128198     1.18   0.239     -.010041    .0402116
       _cons |   8.899132   2.961478     3.00   0.003     3.094741    14.70352
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP6
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_6

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53634.626  (not concave)
Iteration 2:   log likelihood = -53589.971  (not concave)
Iteration 3:   log likelihood = -53572.992  (not concave)
Iteration 4:   log likelihood = -53562.445  
Iteration 5:   log likelihood = -53495.992  
Iteration 6:   log likelihood = -53302.981  
Iteration 7:   log likelihood = -53249.026  
Iteration 8:   log likelihood = -53212.905  
Iteration 9:   log likelihood = -53174.538  
Iteration 10:  log likelihood = -53156.097  
Iteration 11:  log likelihood = -53155.806  
Iteration 12:  log likelihood =   -53155.8  
Iteration 13:  log likelihood =   -53155.8  
Iteration 14:  log likelihood =   -53155.8  

Survival model                                  Number of obs     =     59,220
Log likelihood =   -53155.8
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1473447   .0098221    15.00   0.000     .1280937    .1665957
edad_al_in~t |   .0686647   .0021251    32.31   0.000     .0644996    .0728299
edad_ini_c~s |  -.0085762   .0018933    -4.53   0.000     -.012287   -.0048655
     sex_enc |   -.330878   .0202659   -16.33   0.000    -.3705985   -.2911576
     esc_rec |   .1002132     .01237     8.10   0.000     .0759684     .124458
sus_prin_mod |   .1301984   .0082246    15.83   0.000     .1140785    .1463184
 fr_sus_prin |   .0322945   .0075742     4.26   0.000     .0174493    .0471398
 comp_biosoc |   .1936292   .0141862    13.65   0.000     .1658247    .2214337
     ten_viv |  -.0181548   .0076293    -2.38   0.017     -.033108   -.0032016
origen_ing~d |  -.0170478   .0044044    -3.87   0.000    -.0256803   -.0084153
numero_de_~d |   .0735022    .006359    11.56   0.000     .0610387    .0859657
dg_cie_10_~c |   .0278881   .0087943     3.17   0.002     .0106516    .0451245
sud_sever~10 |  -.0631931   .0191777    -3.30   0.001    -.1007807   -.0256054
   macrozone |   .2037314   .0118254    17.23   0.000      .180554    .2269089
 policonsumo |    .109529   .0216516     5.06   0.000     .0670926    .1519654
   n_off_vio |   .2889675   .0187014    15.45   0.000     .2523134    .3256216
   n_off_acq |   .6323612   .0174213    36.30   0.000     .5982162    .6665062
   n_off_sud |   .2051953   .0183802    11.16   0.000     .1691707    .2412199
        clas |    .015091   .0128198     1.18   0.239    -.0100353    .0402173
       _cons |   9.072563   2.475613     3.66   0.000     4.220451    13.92468
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP7
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_7

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53629.781  (not concave)
Iteration 2:   log likelihood = -53590.823  (not concave)
Iteration 3:   log likelihood = -53569.595  (not concave)
Iteration 4:   log likelihood = -53558.271  (not concave)
Iteration 5:   log likelihood = -53523.707  (not concave)
Iteration 6:   log likelihood = -53505.583  (not concave)
Iteration 7:   log likelihood = -53496.851  
Iteration 8:   log likelihood = -53391.648  
Iteration 9:   log likelihood = -53200.816  
Iteration 10:  log likelihood = -53176.663  
Iteration 11:  log likelihood = -53153.122  
Iteration 12:  log likelihood = -53153.027  
Iteration 13:  log likelihood = -53153.026  
Iteration 14:  log likelihood = -53153.026  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53153.026
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1473541   .0098235    15.00   0.000     .1281004    .1666077
edad_al_in~t |   .0699191   .0022683    30.82   0.000     .0654733     .074365
edad_ini_c~s |  -.0085238   .0018934    -4.50   0.000    -.0122348   -.0048127
     sex_enc |  -.3310015   .0202659   -16.33   0.000    -.3707219   -.2912812
     esc_rec |   .1002722   .0123718     8.10   0.000      .076024    .1245205
sus_prin_mod |   .1299769   .0082259    15.80   0.000     .1138544    .1460995
 fr_sus_prin |   .0322613   .0075743     4.26   0.000     .0174159    .0471066
 comp_biosoc |   .1934547   .0141869    13.64   0.000     .1656489    .2212606
     ten_viv |  -.0181319   .0076294    -2.38   0.017    -.0330853   -.0031786
origen_ing~d |  -.0169805   .0044047    -3.86   0.000    -.0256136   -.0083474
numero_de_~d |   .0735297   .0063594    11.56   0.000     .0610655    .0859938
dg_cie_10_~c |   .0279086   .0087947     3.17   0.002     .0106713    .0451459
sud_sever~10 |  -.0632973   .0191779    -3.30   0.001    -.1008853   -.0257092
   macrozone |   .2035169   .0118264    17.21   0.000     .1803376    .2266962
 policonsumo |   .1100928   .0216551     5.08   0.000     .0676496     .152536
   n_off_vio |   .2887516   .0187027    15.44   0.000      .252095    .3254082
   n_off_acq |   .6318797   .0174236    36.27   0.000       .59773    .6660294
   n_off_sud |    .205122   .0183821    11.16   0.000     .1690937    .2411503
        clas |   .0150961   .0128199     1.18   0.239    -.0100304    .0402227
       _cons |   8.871962   3.172518     2.80   0.005      2.65394    15.08998
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP8
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_8

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53627.373  (not concave)
Iteration 2:   log likelihood = -53596.616  (not concave)
Iteration 3:   log likelihood = -53567.778  (not concave)
Iteration 4:   log likelihood = -53539.433  
Iteration 5:   log likelihood = -53420.834  
Iteration 6:   log likelihood = -53308.251  
Iteration 7:   log likelihood = -53248.147  
Iteration 8:   log likelihood = -53209.471  
Iteration 9:   log likelihood = -53169.164  
Iteration 10:  log likelihood = -53151.509  
Iteration 11:  log likelihood = -53151.156  
Iteration 12:  log likelihood = -53151.153  
Iteration 13:  log likelihood = -53151.152  (not concave)
Iteration 14:  log likelihood = -53151.152  (backed up)

Survival model                                  Number of obs     =     59,220
Log likelihood = -53151.152
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1473497   .0098246    15.00   0.000     .1280938    .1666057
edad_al_in~t |   .0711823   .0023684    30.06   0.000     .0665404    .0758242
edad_ini_c~s |  -.0084857   .0018938    -4.48   0.000    -.0121975   -.0047739
     sex_enc |  -.3311264   .0202662   -16.34   0.000    -.3708475   -.2914053
     esc_rec |   .1004106   .0123729     8.12   0.000     .0761601    .1246611
sus_prin_mod |   .1298314   .0082269    15.78   0.000      .113707    .1459559
 fr_sus_prin |   .0322706   .0075742     4.26   0.000     .0174254    .0471157
 comp_biosoc |   .1932414   .0141876    13.62   0.000     .1654343    .2210486
     ten_viv |   -.018138   .0076293    -2.38   0.017    -.0330912   -.0031847
origen_ing~d |  -.0168857   .0044049    -3.83   0.000    -.0255192   -.0082522
numero_de_~d |   .0734968   .0063597    11.56   0.000      .061032    .0859616
dg_cie_10_~c |   .0279257   .0087952     3.18   0.001     .0106875     .045164
sud_sever~10 |  -.0633611   .0191781    -3.30   0.001    -.1009495   -.0257726
   macrozone |   .2033757   .0118271    17.20   0.000     .1801949    .2265564
 policonsumo |   .1105518   .0216564     5.10   0.000     .0681061    .1529975
   n_off_vio |   .2885033   .0187038    15.42   0.000     .2518446     .325162
   n_off_acq |   .6314266   .0174249    36.24   0.000     .5972744    .6655788
   n_off_sud |   .2050392   .0183831    11.15   0.000      .169009    .2410693
        clas |    .015148   .0128199     1.18   0.237    -.0099784    .0402745
       _cons |   8.655492   4.502465     1.92   0.055    -.1691784    17.48016
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP9
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_9

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53629.972  (not concave)
Iteration 2:   log likelihood = -53599.054  (not concave)
Iteration 3:   log likelihood = -53570.245  (not concave)
Iteration 4:   log likelihood = -53540.552  
Iteration 5:   log likelihood = -53401.051  
Iteration 6:   log likelihood = -53247.676  
Iteration 7:   log likelihood = -53172.922  
Iteration 8:   log likelihood = -53147.175  (not concave)
Iteration 9:   log likelihood =  -53146.52  
Iteration 10:  log likelihood = -53146.341  (not concave)
Iteration 11:  log likelihood = -53146.341  (backed up)
Iteration 12:  log likelihood = -53146.341  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53146.341
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1473057   .0098265    14.99   0.000     .1280462    .1665652
edad_al_in~t |   .0732767   .0024624    29.76   0.000     .0684504    .0781029
edad_ini_c~s |  -.0084131   .0018946    -4.44   0.000    -.0121264   -.0046999
     sex_enc |  -.3312155   .0202667   -16.34   0.000    -.3709374   -.2914936
     esc_rec |    .100794   .0123736     8.15   0.000     .0765422    .1250458
sus_prin_mod |   .1296782   .0082285    15.76   0.000     .1135506    .1458057
 fr_sus_prin |   .0322546   .0075744     4.26   0.000      .017409    .0471002
 comp_biosoc |   .1928955   .0141878    13.60   0.000      .165088    .2207031
     ten_viv |  -.0180933   .0076286    -2.37   0.018    -.0330452   -.0031414
origen_ing~d |  -.0167557   .0044053    -3.80   0.000    -.0253899   -.0081216
numero_de_~d |   .0734148   .0063603    11.54   0.000     .0609489    .0858807
dg_cie_10_~c |   .0279487   .0087961     3.18   0.001     .0107086    .0451888
sud_sever~10 |  -.0637529   .0191786    -3.32   0.001    -.1013422   -.0261636
   macrozone |   .2031125   .0118282    17.17   0.000     .1799296    .2262953
 policonsumo |   .1109815   .0216562     5.12   0.000     .0685361     .153427
   n_off_vio |    .288126   .0187044    15.40   0.000      .251466    .3247861
   n_off_acq |   .6304503    .017427    36.18   0.000     .5962941    .6646066
   n_off_sud |   .2046347   .0183844    11.13   0.000     .1686019    .2406674
        clas |   .0150633     .01282     1.17   0.240    -.0100636    .0401901
       _cons |   8.633267   8.306328     1.04   0.299    -7.646836    24.91337
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display
 ***********
 family RP10
 ***********
note; a delayed entry model is being fitted
Obtaining initial values
convergence not achieved
variables created: _rcs1_1 to _rcs1_10

Fitting full model:

Iteration 0:   log likelihood = -53645.697  (not concave)
Iteration 1:   log likelihood = -53635.836  (not concave)
Iteration 2:   log likelihood = -53596.957  (not concave)
Iteration 3:   log likelihood = -53573.222  (not concave)
Iteration 4:   log likelihood = -53561.003  (not concave)
Iteration 5:   log likelihood =  -53538.27  (not concave)
Iteration 6:   log likelihood = -53526.199  (not concave)
Iteration 7:   log likelihood = -53515.128  
Iteration 8:   log likelihood = -53442.433  
Iteration 9:   log likelihood = -53263.335  
Iteration 10:  log likelihood = -53221.605  
Iteration 11:  log likelihood =  -53173.04  
Iteration 12:  log likelihood = -53143.262  
Iteration 13:  log likelihood = -53141.979  
Iteration 14:  log likelihood = -53141.946  
Iteration 15:  log likelihood = -53141.883  (not concave)
Iteration 16:  log likelihood = -53141.883  
Iteration 17:  log likelihood = -53141.883  

Survival model                                  Number of obs     =     59,220
Log likelihood = -53141.883
------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
_t:          |            
motivodeeg~3 |   .1473521   .0098279    14.99   0.000     .1280897    .1666145
edad_al_in~t |   .0750425   .0025239    29.73   0.000     .0700958    .0799891
edad_ini_c~s |  -.0083571   .0018954    -4.41   0.000    -.0120721   -.0046422
     sex_enc |  -.3312218   .0202674   -16.34   0.000    -.3709452   -.2914984
     esc_rec |   .1010987    .012374     8.17   0.000     .0768462    .1253513
sus_prin_mod |   .1295737   .0082296    15.74   0.000     .1134441    .1457034
 fr_sus_prin |   .0322806   .0075746     4.26   0.000     .0174346    .0471266
 comp_biosoc |   .1926443   .0141881    13.58   0.000     .1648361    .2204526
     ten_viv |  -.0181252   .0076281    -2.38   0.017    -.0330759   -.0031745
origen_ing~d |   -.016635   .0044055    -3.78   0.000    -.0252695   -.0080004
numero_de_~d |   .0733471    .006361    11.53   0.000     .0608798    .0858145
dg_cie_10_~c |   .0279365   .0087968     3.18   0.001      .010695     .045178
sud_sever~10 |  -.0640884   .0191795    -3.34   0.001    -.1016795   -.0264974
   macrozone |    .202955    .011829    17.16   0.000     .1797706    .2261394
 policonsumo |   .1111004   .0216558     5.13   0.000     .0686558    .1535451
   n_off_vio |   .2877219   .0187053    15.38   0.000     .2510603    .3243835
   n_off_acq |   .6295821   .0174283    36.12   0.000     .5954231     .663741
   n_off_sud |   .2040796   .0183858    11.10   0.000     .1680441    .2401151
        clas |   .0150454   .0128202     1.17   0.241    -.0100818    .0401725
       _cons |   8.849314   33.50394     0.26   0.792    -56.81719    74.51582
------------------------------------------------------------------------------
    Warning: Baseline spline coefficients not shown - use ml display

. 
. *rcs(time, df(3) orthog)
. estwrite _all using &quot;${pathdata2}parmodels_m2_nov_22.sters&quot;, replace
(saving m2_1_cox1)
(saving m2_1_cox2)
(saving m2_1_cox3)
(saving m2_1_cox4)
(saving m2_1_cox5)
(saving m2_1_cox6)
(saving m2_1_cox7)
(saving m2_1_gom)
(saving m2_1_wei)
(saving m2_1_logl)
(saving m2_1_logn)
(saving m2_1_ggam)
(saving m2_1_rp1)
(saving m2_1_rp2)
(saving m2_1_rp3)
(saving m2_1_rp4)
(saving m2_1_rp5)
(saving m2_1_rp6)
(saving m2_1_rp7)
(saving m2_1_rp8)
(saving m2_1_rp9)
(saving m2_1_rp10)
(file parmodels_m2_nov_22.sters saved)

</code></pre>
<p>We obtained a summary of distributions by AICs and BICs.</p>
<pre><code>. *estread &quot;${pathdata2}parmodels_m2_nov_22.sters&quot;
. 
. *file:///G:/Mi%20unidad/Alvacast/SISTRAT%202019%20(github)/_supp_mstates/stata/1806.01615.pdf
. *rcs - restricted cubic splines on log hazard scale
. *rp - Royston-Parmar model (restricted cubic spline on log cumulative hazard scale)
. qui count if _d == 1

.         // we count the amount of cases with the event in the strata
.         //we call the estimates stored, and the results...
. estimates stat m2_1_*, n(`r(N)')

Akaike's information criterion and Bayesian information criterion

-----------------------------------------------------------------------------
       Model |          N   ll(null)  ll(model)      df        AIC        BIC
-------------+---------------------------------------------------------------
   m2_1_cox1 |     22,287          .  -53738.09      21   107518.2   107686.4
   m2_1_cox2 |     22,287          .  -53715.07      22   107474.1   107650.4
   m2_1_cox3 |     22,287          .  -53685.67      23   107417.3   107601.6
   m2_1_cox4 |     22,287          .  -53681.68      24   107411.4   107603.6
   m2_1_cox5 |     22,287          .  -53676.55      25   107403.1   107603.4
   m2_1_cox6 |     22,287          .  -53670.28      26   107392.6   107600.9
   m2_1_cox7 |     22,287          .  -53669.84      27   107393.7     107610
    m2_1_gom |     22,287          .  -53129.79      21   106301.6   106469.8
    m2_1_wei |     22,287          .  -53645.69      20   107331.4   107491.6
   m2_1_logl |     22,287          .  -54459.35      21   108960.7   109128.9
   m2_1_logn |     22,287          .  -54570.87       9   109159.7   109231.8
   m2_1_ggam |     22,287          .  -54643.96       3   109293.9     109318
    m2_1_rp1 |     22,287          .   -53645.7      21   107333.4   107501.6
    m2_1_rp2 |     22,287          .   -53207.5      21     106457   106625.2
    m2_1_rp3 |     22,287          .  -53177.97      23   106401.9   106586.2
    m2_1_rp4 |     22,287          .  -53172.51      24     106393   106585.3
    m2_1_rp5 |     22,287          .  -53158.24      25   106366.5   106566.8
    m2_1_rp6 |     22,287          .   -53155.8      26   106363.6   106571.9
    m2_1_rp7 |     22,287          .  -53153.03      27   106360.1   106576.4
    m2_1_rp8 |     22,287          .  -53151.15      28   106358.3   106582.6
    m2_1_rp9 |     22,287          .  -53146.34      29   106350.7     106583
   m2_1_rp10 |     22,287          .  -53141.88      30   106343.8   106584.1
-----------------------------------------------------------------------------

.         //we store in a matrix de survival
. matrix stats_1=r(S)

. 
. 
. estimates clear

. 
. ** to order AICs
. *https://www.statalist.org/forums/forum/general-stata-discussion/general/1665263-sorting-matrix-including-rownames
. mata :
------------------------------------------------- mata (type end to exit) ------------------------------------------------------------------------------------------------------------------------------------------
: 
: void st_sort_matrix(
&gt; //argumento de la matriz
&gt;     string scalar matname, 
&gt; //argumento de las columnas
&gt;     real   rowvector columns
&gt;     )
&gt; {
&gt;     string matrix   rownames
&gt;     real  colvector sort_order
&gt; // defino una base      
&gt;         //Y = st_matrix(matname)
&gt;         //[.,(1, 2, 3, 4, 6, 5)]
&gt;  //ordeno las columnas  
&gt;     rownames = st_matrixrowstripe(matname) //[.,(1, 2, 3, 4, 6, 5)]
&gt;     sort_order = order(st_matrix(matname),  (columns))
&gt;     st_replacematrix(matname, st_matrix(matname)[sort_order,.])
&gt;     st_matrixrowstripe(matname, rownames[sort_order,.])
&gt; }

: 
: end
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

. //mata: mata drop st_sort_matrix()
. 
. mata : st_sort_matrix(&quot;stats_1&quot;, 6)

. esttab matrix(stats_1) using &quot;testreg_aic_bic_22.csv&quot;, replace
(output written to testreg_aic_bic_22.csv)

. esttab matrix(stats_1) using &quot;testreg_aic_bic_22.html&quot;, replace
(output written to testreg_aic_bic_22.html)

. 
</code></pre>
<table border="0" width="*">
<tr><td colspan=7><hr></td></tr>
<tr><td>            </td><td>     stats_1</td><td>            </td><td>            </td><td>            </td><td>            </td><td>            </td></tr>
<tr><td>            </td><td>           N</td><td>         ll0</td><td>          ll</td><td>          df</td><td>         AIC</td><td>         BIC</td></tr>
<tr><td colspan=7><hr></td></tr>
<tr><td>m2_1_gom    </td><td>       22287</td><td>           .</td><td>   -53129.79</td><td>          21</td><td>    106301.6</td><td>    106469.8</td></tr>
<tr><td>m2_1_rp5    </td><td>       22287</td><td>           .</td><td>   -53158.24</td><td>          25</td><td>    106366.5</td><td>    106566.8</td></tr>
<tr><td>m2_1_rp6    </td><td>       22287</td><td>           .</td><td>    -53155.8</td><td>          26</td><td>    106363.6</td><td>    106571.9</td></tr>
<tr><td>m2_1_rp7    </td><td>       22287</td><td>           .</td><td>   -53153.03</td><td>          27</td><td>    106360.1</td><td>    106576.4</td></tr>
<tr><td>m2_1_rp8    </td><td>       22287</td><td>           .</td><td>   -53151.15</td><td>          28</td><td>    106358.3</td><td>    106582.6</td></tr>
<tr><td>m2_1_rp9    </td><td>       22287</td><td>           .</td><td>   -53146.34</td><td>          29</td><td>    106350.7</td><td>      106583</td></tr>
<tr><td>m2_1_rp10   </td><td>       22287</td><td>           .</td><td>   -53141.88</td><td>          30</td><td>    106343.8</td><td>    106584.1</td></tr>
<tr><td>m2_1_rp4    </td><td>       22287</td><td>           .</td><td>   -53172.51</td><td>          24</td><td>      106393</td><td>    106585.3</td></tr>
<tr><td>m2_1_rp3    </td><td>       22287</td><td>           .</td><td>   -53177.97</td><td>          23</td><td>    106401.9</td><td>    106586.2</td></tr>
<tr><td>m2_1_rp2    </td><td>       22287</td><td>           .</td><td>    -53207.5</td><td>          21</td><td>      106457</td><td>    106625.2</td></tr>
<tr><td>m2_1_wei    </td><td>       22287</td><td>           .</td><td>   -53645.69</td><td>          20</td><td>    107331.4</td><td>    107491.6</td></tr>
<tr><td>m2_1_rp1    </td><td>       22287</td><td>           .</td><td>    -53645.7</td><td>          21</td><td>    107333.4</td><td>    107501.6</td></tr>
<tr><td>m2_1_cox6   </td><td>       22287</td><td>           .</td><td>   -53670.28</td><td>          26</td><td>    107392.6</td><td>    107600.9</td></tr>
<tr><td>m2_1_cox3   </td><td>       22287</td><td>           .</td><td>   -53685.67</td><td>          23</td><td>    107417.3</td><td>    107601.6</td></tr>
<tr><td>m2_1_cox5   </td><td>       22287</td><td>           .</td><td>   -53676.55</td><td>          25</td><td>    107403.1</td><td>    107603.4</td></tr>
<tr><td>m2_1_cox4   </td><td>       22287</td><td>           .</td><td>   -53681.68</td><td>          24</td><td>    107411.4</td><td>    107603.6</td></tr>
<tr><td>m2_1_cox7   </td><td>       22287</td><td>           .</td><td>   -53669.84</td><td>          27</td><td>    107393.7</td><td>      107610</td></tr>
<tr><td>m2_1_cox2   </td><td>       22287</td><td>           .</td><td>   -53715.07</td><td>          22</td><td>    107474.1</td><td>    107650.4</td></tr>
<tr><td>m2_1_cox1   </td><td>       22287</td><td>           .</td><td>   -53738.09</td><td>          21</td><td>    107518.2</td><td>    107686.4</td></tr>
<tr><td>m2_1_logl   </td><td>       22287</td><td>           .</td><td>   -54459.35</td><td>          21</td><td>    108960.7</td><td>    109128.9</td></tr>
<tr><td>m2_1_logn   </td><td>       22287</td><td>           .</td><td>   -54570.87</td><td>           9</td><td>    109159.7</td><td>    109231.8</td></tr>
<tr><td>m2_1_ggam   </td><td>       22287</td><td>           .</td><td>   -54643.96</td><td>           3</td><td>    109293.9</td><td>      109318</td></tr>
<tr><td colspan=7><hr></td></tr>
</table>
<p>In case of the more flexible parametric models (non-standard), we selected the models that showed the best trade-off between lower complexity and better fit, and this is why we also considered the BIC. If a model with less parameters had greater or equal AIC (or differences lower than 2) but also had better BIC (&lt;=2), we favoured the model with less parameters.</p>
<h3><a href="#iptw-royston-parmar" id="iptw-royston-parmar">IPTW Royston-Parmar</a></h3>
<pre><code>. *reset time, only compatible with stteffects (same entry times)
. stset diff, failure(event ==1) 

     failure event:  event == 1
obs. time interval:  (0, diff]
 exit on or before:  failure

------------------------------------------------------------------------------
     70,863  total observations
          1  observation ends on or before enter()
------------------------------------------------------------------------------
     70,862  observations remaining, representing
     22,287  failures in single-record/single-failure data
 229,620.92  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  10.75828

. *stset age_offending_imp, fail(event ==1) enter(edad_al_egres_imp)
. 
. cap rm bsreg1.dta bsreg2.dta

. 
. *count if missing(motivodeegreso_mod_imp_rec3, edad_al_ing_fmt, edad_ini_cons, dias_treat_imp_sin_na_1, esc_rec, sus_prin_mod, fr_sus_prin, comp_biosoc, ten_viv, dg_cie_10_rec, sud_severity_icd10, macrozone, po
&gt; liconsumo, n_off_vio, n_off_acq, n_off_sud, n_off_oth)
</code></pre>
<p>First we calculated the difference between those patients who did and did not complete baseline treatment, given that the analysis is restricted to 2 values.</p>
<pre><code>. *Micki Hill &amp; Paul C Lambert &amp; Michael J Crowther, 2021. &quot;Introducing stipw: inverse probability weighted parametric survival models,&quot; London Stata Conference 2021 15, Stata Users Group.
. *https://view.officeapps.live.com/op/view.aspx?src=http%3A%2F%2Ffmwww.bc.edu%2Frepec%2Fusug2021%2Fusug21_hill.pptx&amp;wdOrigin=BROWSELINK
. 
. *Treatment variable should be a binary variable with values 0 and 1.
. gen     motivodeegreso_mod_imp_rec2 = 0

. replace motivodeegreso_mod_imp_rec2 = 1 if strpos(motivodeegreso_mod_imp_rec,&quot;Early&quot;)&gt;0
(15,797 real changes made)

. replace motivodeegreso_mod_imp_rec2 = 1 if strpos(motivodeegreso_mod_imp_rec,&quot;Late&quot;)&gt;0
(35,781 real changes made)

. 
. recode motivodeegreso_mod_imp_rec3 (1=0 &quot;Tr Completion&quot;) (3=1 &quot;Tr Non-completion (Late)&quot;) (2=2 &quot;Tr Non-completion (Early)&quot;), gen(caus_disch_mod_imp_rec) 
(55066 differences between motivodeegreso_mod_imp_rec3 and caus_disch_mod_imp_rec)

. lab var caus_disch_mod_imp_rec &quot;Baseline treatment outcome&quot; 

. 
. global covs_3 &quot;i.caus_disch_mod_imp_rec edad_al_ing_fmt edad_ini_cons i.sex_enc i.esc_rec i.sus_prin_mod i.fr_sus_prin i.comp_biosoc i.ten_viv i.dg_cie_10_rec i.sud_severity_icd10 i.macrozone i.policonsumo i.n_
&gt; off_vio i.n_off_acq i.n_off_sud i.clas&quot;

. 
. global covs_3b &quot;i.caus_disch_mod_imp_rec edad_al_ing_fmt edad_ini_cons i.sex_enc i.esc_rec i.sus_prin_mod i.fr_sus_prin i.comp_biosoc i.origen_ingreso_mod numero_de_hijos_mod i.dg_cie_10_rec i.sud_severity_icd1
&gt; 0 i.macrozone i.policonsumo i.n_off_vio i.n_off_acq i.n_off_sud i.clas&quot;

. 
. stpm2 $covs_3 , scale(hazard) df(10) eform

Iteration 0:   log likelihood = -54894.423  
Iteration 1:   log likelihood = -54894.337  
Iteration 2:   log likelihood = -54894.337  

Log likelihood = -54894.337                     Number of obs     =     59,755

-------------------------------------------------------------------------------------------------------------
                                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
--------------------------------------------+----------------------------------------------------------------
xb                                          |
                     caus_disch_mod_imp_rec |
                  Tr Non-completion (Late)  |    1.49201   .0318638    18.74   0.000     1.430847    1.555787
                 Tr Non-completion (Early)  |   1.523402   .0415855    15.42   0.000     1.444038    1.607127
                                            |
                            edad_al_ing_fmt |   .9699129   .0009237   -32.08   0.000     .9681043     .971725
                              edad_ini_cons |   .9914654   .0018753    -4.53   0.000     .9877968    .9951477
                                            |
                                    sex_enc |
                                     Women  |   .7620271   .0148433   -13.95   0.000     .7334831     .791682
                                            |
                                    esc_rec |
           2-Completed high school or less  |   1.141387   .0271557     5.56   0.000     1.089384    1.195871
        3-Completed primary school or less  |   1.205475   .0315119     7.15   0.000     1.145269    1.268847
                                            |
                               sus_prin_mod |
                     Cocaine hydrochloride  |   1.056637   .0286989     2.03   0.043     1.001859     1.11441
                             Cocaine paste  |   1.561842   .0346259    20.11   0.000      1.49543    1.631204
                                 Marijuana  |   1.155138   .0401061     4.15   0.000     1.079146    1.236481
                                     Other  |   1.234245    .086563     3.00   0.003     1.075729     1.41612
                                            |
                                fr_sus_prin |
                        2 to 3 days a week  |   1.090567   .0390463     2.42   0.015     1.016661    1.169845
                        4 to 6 days a week  |   1.104167   .0419257     2.61   0.009     1.024978    1.189475
                                     Daily  |   1.131408   .0404362     3.45   0.001     1.054866    1.213503
                    Less than 1 day a week  |   1.107629    .054608     2.07   0.038     1.005608    1.220001
                                            |
                                comp_biosoc |
                                2-Moderate  |   1.130748    .035967     3.86   0.000     1.062406    1.203486
                                  3-Severe  |   1.345143   .0465006     8.58   0.000     1.257023    1.439441
                                            |
                                    ten_viv |
                                    Others  |   1.016123   .0773835     0.21   0.834     .8752305    1.179696
Owner/Transferred dwellings/Pays Dividends  |   .8602918   .0561983    -2.30   0.021      .756905    .9778005
                                   Renting  |   .8941167   .0594062    -1.68   0.092     .7849452    1.018472
         Stays temporarily with a relative  |   .8506971   .0552927    -2.49   0.013     .7489443    .9662743
                                            |
                              dg_cie_10_rec |
           Diagnosis unknown (under study)  |   1.071126   .0256153     2.87   0.004     1.022079    1.122526
              With psychiatric comorbidity  |   1.044705   .0185592     2.46   0.014     1.008955    1.081721
                                            |
                         sud_severity_icd10 |
                     Hazardous consumption  |   .9709583   .0189125    -1.51   0.130     .9345892    1.008743
                                            |
                                  macrozone |
                                     North  |   1.313784   .0267621    13.40   0.000     1.262364    1.367297
                                     South  |   1.438719   .0408919    12.80   0.000     1.360764     1.52114
                                            |
                              1.policonsumo |   1.118729   .0244198     5.14   0.000     1.071877     1.16763
                                1.n_off_vio |   1.321533   .0245868    14.98   0.000     1.274212    1.370612
                                1.n_off_acq |   1.745172    .030527    31.83   0.000     1.686354    1.806041
                                1.n_off_sud |   1.186901   .0217507     9.35   0.000     1.145027    1.230307
                                            |
                                       clas |
                                     Rural  |   1.044971   .0396457     1.16   0.246     .9700854    1.125637
                                    Urbana  |   1.025766    .027911     0.93   0.350     .9724942    1.081955
                                            |
                                      _rcs1 |    2.55539   .0168124   142.60   0.000      2.52265    2.588555
                                      _rcs2 |   1.075388   .0065326    11.96   0.000      1.06266    1.088268
                                      _rcs3 |   1.036696   .0046774     7.99   0.000     1.027569    1.045904
                                      _rcs4 |   1.015185   .0029406     5.20   0.000     1.009438    1.020965
                                      _rcs5 |   1.010609   .0019691     5.42   0.000     1.006757    1.014476
                                      _rcs6 |   1.007145   .0015153     4.73   0.000     1.004179    1.010119
                                      _rcs7 |   1.005534   .0013162     4.22   0.000     1.002958    1.008117
                                      _rcs8 |   1.004851   .0011875     4.09   0.000     1.002526    1.007181
                                      _rcs9 |    1.00335   .0011289     2.97   0.003      1.00114    1.005565
                                     _rcs10 |   1.002515   .0009813     2.57   0.010     1.000593     1.00444
                                      _cons |   .2254108   .0221926   -15.13   0.000     .1858535    .2733877
-------------------------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. stpm2 $covs_3b , scale(hazard) df(10) eform

Iteration 0:   log likelihood = -58349.508  
Iteration 1:   log likelihood = -58349.435  
Iteration 2:   log likelihood = -58349.435  

Log likelihood = -58349.435                     Number of obs     =     62,500

-----------------------------------------------------------------------------------------------------
                                    |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
------------------------------------+----------------------------------------------------------------
xb                                  |
             caus_disch_mod_imp_rec |
          Tr Non-completion (Late)  |    1.48932   .0310108    19.13   0.000     1.429763    1.551357
         Tr Non-completion (Early)  |   1.541667   .0406119    16.43   0.000     1.464089    1.623355
                                    |
                    edad_al_ing_fmt |   .9675178   .0009699   -32.94   0.000     .9656187    .9694207
                      edad_ini_cons |   .9907613   .0018092    -5.08   0.000     .9872218    .9943136
                                    |
                            sex_enc |
                             Women  |    .724235   .0142832   -16.36   0.000     .6967746    .7527777
                                    |
                            esc_rec |
   2-Completed high school or less  |   1.128482   .0262136     5.20   0.000     1.078257    1.181048
3-Completed primary school or less  |   1.169499   .0299095     6.12   0.000     1.112323    1.229615
                                    |
                       sus_prin_mod |
             Cocaine hydrochloride  |   1.051708   .0279028     1.90   0.057     .9984171    1.107843
                     Cocaine paste  |     1.5503   .0334622    20.31   0.000     1.486083    1.617292
                         Marijuana  |   1.138928   .0385557     3.84   0.000     1.065812    1.217059
                             Other  |   1.232458      .0835     3.08   0.002     1.079202    1.407479
                                    |
                        fr_sus_prin |
                2 to 3 days a week  |   1.086989    .038375     2.36   0.018     1.014319    1.164866
                4 to 6 days a week  |   1.113646   .0417124     2.87   0.004      1.03482    1.198477
                             Daily  |   1.149933   .0404956     3.97   0.000      1.07324    1.232106
            Less than 1 day a week  |   1.107831   .0532793     2.13   0.033     1.008176    1.217337
                                    |
                        comp_biosoc |
                        2-Moderate  |   1.128687   .0354752     3.85   0.000     1.061255    1.200404
                          3-Severe  |   1.352271   .0460383     8.86   0.000     1.264983    1.445583
                                    |
                 origen_ingreso_mod |
                 Assisted Referral  |   1.072144   .0267173     2.80   0.005     1.021037    1.125809
                             Other  |   1.099171    .034109     3.05   0.002     1.034311    1.168099
                    Justice Sector  |   1.067121    .028793     2.41   0.016     1.012154    1.125073
                     Health Sector  |   .9720353   .0176741    -1.56   0.119     .9380047      1.0073
                                    |
                numero_de_hijos_mod |   1.051471   .0064116     8.23   0.000     1.038979    1.064112
                                    |
                      dg_cie_10_rec |
   Diagnosis unknown (under study)  |   1.065633   .0245421     2.76   0.006     1.018601    1.114836
      With psychiatric comorbidity  |   1.048036   .0180813     2.72   0.007     1.013189     1.08408
                                    |
                 sud_severity_icd10 |
             Hazardous consumption  |   .9745906   .0184883    -1.36   0.175     .9390195    1.011509
                                    |
                          macrozone |
                             North  |   1.323492    .026295    14.11   0.000     1.272945    1.376046
                             South  |   1.434614   .0399367    12.96   0.000     1.358436    1.515063
                                    |
                      1.policonsumo |     1.1132   .0233431     5.11   0.000     1.068376    1.159905
                        1.n_off_vio |   1.292917   .0234381    14.17   0.000     1.247786     1.33968
                        1.n_off_acq |   1.749615   .0294431    33.24   0.000     1.692849    1.808285
                        1.n_off_sud |   1.168731   .0207186     8.80   0.000     1.128821    1.210053
                                    |
                               clas |
                             Rural  |   1.028426   .0383754     0.75   0.453     .9558959    1.106459
                            Urbana  |   1.028165   .0273815     1.04   0.297     .9758746    1.083257
                                    |
                              _rcs1 |   2.563253   .0163756   147.34   0.000     2.531358    2.595551
                              _rcs2 |   1.074489   .0063341    12.19   0.000     1.062146    1.086976
                              _rcs3 |   1.037807    .004512     8.54   0.000     1.029001    1.046688
                              _rcs4 |   1.015249   .0028437     5.40   0.000     1.009691    1.020838
                              _rcs5 |   1.009591    .001903     5.06   0.000     1.005868    1.013328
                              _rcs6 |   1.006482   .0014636     4.44   0.000     1.003618    1.009355
                              _rcs7 |   1.005494   .0012703     4.34   0.000     1.003008    1.007987
                              _rcs8 |   1.004593   .0011474     4.01   0.000     1.002347    1.006844
                              _rcs9 |   1.003309    .001093     3.03   0.002     1.001169    1.005454
                             _rcs10 |   1.002473   .0009495     2.61   0.009     1.000614    1.004336
                              _cons |   .2047319   .0149317   -21.75   0.000     .1774619    .2361924
-----------------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv dg_cie_10_rec sud_severity_icd10 macrozone policonsumo n_off_vio n_off_acq n_o
&gt; ff_sud clas), distribution(rp) df(10) ipwtype(stabilised) vce(mestimation) eform
11108 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -33462.401  
Iteration 2:   log likelihood = -33437.083  
Iteration 3:   log likelihood = -33437.064  
Iteration 4:   log likelihood = -33437.064  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -35121.157  

Fitting weighted survival model to obtain point estimates

Iteration 0:   log pseudolikelihood = -58076.217  
Iteration 1:   log pseudolikelihood = -58076.168  
Iteration 2:   log pseudolikelihood = -58076.168  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood = -58076.168               Number of obs     =     59,755

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.484969   .0297994    19.70   0.000     1.427697    1.544538
                      _rcs1 |   2.478116    .016462   136.61   0.000      2.44606    2.510592
                      _rcs2 |   1.087208   .0065379    13.90   0.000     1.074469    1.100097
                      _rcs3 |   1.040296   .0046838     8.77   0.000     1.031157    1.049517
                      _rcs4 |   1.015865   .0029601     5.40   0.000      1.01008    1.021683
                      _rcs5 |   1.009881   .0019519     5.09   0.000     1.006063    1.013714
                      _rcs6 |     1.0067   .0014863     4.52   0.000     1.003791    1.009617
                      _rcs7 |   1.005061   .0012741     3.98   0.000     1.002567    1.007561
                      _rcs8 |   1.004316   .0011445     3.78   0.000     1.002075    1.006562
                      _rcs9 |   1.003245   .0010827     3.00   0.003     1.001125     1.00537
                     _rcs10 |   1.002468   .0009366     2.64   0.008     1.000634    1.004305
                      _cons |   .1640224   .0030763   -96.39   0.000     .1581024    .1701641
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec sud_severity_icd10 macrozone poli
&gt; consumo n_off_vio n_off_acq n_off_sud clas), distribution(rp) df(10) ipwtype(stabilised) vce(mestimation) eform
8363 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood =  -34712.81  
Iteration 2:   log likelihood = -34682.955  
Iteration 3:   log likelihood = -34682.932  
Iteration 4:   log likelihood = -34682.932  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood = -36548.788  

Fitting weighted survival model to obtain point estimates

Iteration 0:   log pseudolikelihood =  -61798.26  
Iteration 1:   log pseudolikelihood = -61798.084  
Iteration 2:   log pseudolikelihood = -61798.084  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood = -61798.084               Number of obs     =     62,500

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.478045   .0288321    20.03   0.000     1.422601    1.535649
                      _rcs1 |   2.482913   .0159738   141.36   0.000     2.451801    2.514419
                      _rcs2 |   1.087447   .0062501    14.59   0.000     1.075266    1.099766
                      _rcs3 |   1.040957   .0044862     9.31   0.000     1.032201    1.049787
                      _rcs4 |   1.016744   .0028584     5.91   0.000     1.011157    1.022361
                      _rcs5 |   1.008953   .0018865     4.77   0.000     1.005262    1.012657
                      _rcs6 |   1.006228   .0014353     4.35   0.000     1.003419    1.009045
                      _rcs7 |   1.005103   .0012296     4.16   0.000     1.002696    1.007516
                      _rcs8 |   1.004015   .0011027     3.65   0.000     1.001856    1.006179
                      _rcs9 |   1.003133   .0010445     3.00   0.003     1.001088    1.005183
                     _rcs10 |   1.002458   .0009033     2.72   0.006     1.000689     1.00423
                      _cons |   .1679073   .0030661   -97.72   0.000     .1620043    .1740255
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. predict rmst03 in 1, at(motivodeegreso_mod_imp_rec2 0) rmst stdp tmax(3)

. predict rmst13 in 1, at(motivodeegreso_mod_imp_rec2 1) rmst stdp tmax(3)

. predictnl drmst= predict(rmst at(motivodeegreso_mod_imp_rec2 1) tmax(3))- predict(rmst at(motivodeegreso_mod_imp_rec2 1) tmax(3)) in 1, se(drmst_se)
Warning: prediction doesn't vary with respect to e(b).
(70,862 missing values generated)
Warning: prediction constant over observations; perhaps you meant to run nlcom.

. 
. cap list rmst03 rmst13  drmst in 1

</code></pre>
<p>We used a gompertz distribution, assuming that baseline treatment outcome showed proportional hazards</p>
<pre><code>. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv dg_cie_10_rec sud_severity_icd10 macrozone policonsumo n_off_vio n_off_acq n_o
&gt; ff_sud clas), distribution(gompertz) ipwtype(stabilised) vce(mestimation)
11108 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -33462.401  
Iteration 2:   log likelihood = -33437.083  
Iteration 3:   log likelihood = -33437.064  
Iteration 4:   log likelihood = -33437.064  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -35121.157  

Fitting weighted survival model to obtain point estimates

         failure _d:  event == 1
   analysis time _t:  diff
             weight:  [pweight=_stipw_weight]

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -59922.526  
Iteration 1:   log pseudolikelihood = -58502.444  
Iteration 2:   log pseudolikelihood = -58427.181  
Iteration 3:   log pseudolikelihood = -58426.956  
Iteration 4:   log pseudolikelihood = -58426.956  

Fitting full model:

Iteration 0:   log pseudolikelihood = -58426.956  
Iteration 1:   log pseudolikelihood = -58193.444  
Iteration 2:   log pseudolikelihood = -58191.366  
Iteration 3:   log pseudolikelihood = -58191.366  

Displaying weighted survival model with M-estimation standard errors

Gompertz PH regression                          Number of obs     =     59,755
                                                Wald chi2(1)      =     386.85
Log pseudolikelihood = -58191.366               Prob &gt; chi2       =     0.0000

---------------------------------------------------------------------------------------------
                            |            M-estimation
                         _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
motivodeegreso_mod_imp_rec2 |   1.485165   .0298661    19.67   0.000     1.427767    1.544871
                      _cons |   .1184129   .0024426  -103.43   0.000      .113721    .1232983
----------------------------+----------------------------------------------------------------
                     /gamma |   -.258026   .0055133   -46.80   0.000    -.2688318   -.2472202
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline hazard.

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec sud_severity_icd10 macrozone poli
&gt; consumo n_off_vio n_off_acq n_off_sud clas), distribution(gompertz) ipwtype(stabilised) vce(mestimation)
8363 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood =  -34712.81  
Iteration 2:   log likelihood = -34682.955  
Iteration 3:   log likelihood = -34682.932  
Iteration 4:   log likelihood = -34682.932  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood = -36548.788  

Fitting weighted survival model to obtain point estimates

         failure _d:  event == 1
   analysis time _t:  diff
             weight:  [pweight=_stipw_weight]

Fitting constant-only model:

Iteration 0:   log pseudolikelihood = -63831.952  
Iteration 1:   log pseudolikelihood = -62266.624  
Iteration 2:   log pseudolikelihood = -62178.386  
Iteration 3:   log pseudolikelihood = -62178.142  
Iteration 4:   log pseudolikelihood = -62178.142  

Fitting full model:

Iteration 0:   log pseudolikelihood = -62178.142  
Iteration 1:   log pseudolikelihood = -61936.263  
Iteration 2:   log pseudolikelihood = -61934.174  
Iteration 3:   log pseudolikelihood = -61934.174  

Displaying weighted survival model with M-estimation standard errors

Gompertz PH regression                          Number of obs     =     62,500
                                                Wald chi2(1)      =     399.56
Log pseudolikelihood = -61934.174               Prob &gt; chi2       =     0.0000

---------------------------------------------------------------------------------------------
                            |            M-estimation
                         _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
motivodeegreso_mod_imp_rec2 |   1.478256   .0289057    19.99   0.000     1.422674     1.53601
                      _cons |   .1220353   .0024515  -104.71   0.000     .1173239     .126936
----------------------------+----------------------------------------------------------------
                     /gamma |  -.2621733   .0053547   -48.96   0.000    -.2726682   -.2516784
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline hazard.

. 
. predict rmst03_c in 1, at(motivodeegreso_mod_imp_rec2 0) rmst stdp tmax(3)
option at() not allowed
r(198);

. predict rmst13_c in 1, at(motivodeegreso_mod_imp_rec2 1) rmst stdp tmax(3)
option at() not allowed
r(198);

. predictnl drmst_c= predict(rmst at(motivodeegreso_mod_imp_rec2 1) tmax(3))- predict(rmst at(motivodeegreso_mod_imp_rec2 1) tmax(3)) in 1, se(drmst_c_se)
option rmst not allowed
predict(rmst at(motivodeegreso_mod_imp_rec2 1) tmax(3)) invalid
r(198);

. 
. cap list rmst03_c rmst13_c  drmst_c in 1

</code></pre>
<p>We used another model with only 6 degrees of freedom according to the lowest BIC</p>
<pre><code>. 
. stpm2 $covs_3 , scale(hazard) df(6) eform

Iteration 0:   log likelihood = -54899.058  
Iteration 1:   log likelihood = -54897.657  
Iteration 2:   log likelihood = -54897.657  

Log likelihood = -54897.657                     Number of obs     =     59,755

-------------------------------------------------------------------------------------------------------------
                                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
--------------------------------------------+----------------------------------------------------------------
xb                                          |
                     caus_disch_mod_imp_rec |
                  Tr Non-completion (Late)  |   1.492212   .0318677    18.74   0.000     1.431042    1.555997
                 Tr Non-completion (Early)  |   1.523433   .0415857    15.42   0.000     1.444068    1.607159
                                            |
                            edad_al_ing_fmt |   .9699151   .0009237   -32.08   0.000     .9681064    .9717271
                              edad_ini_cons |   .9914584   .0018753    -4.54   0.000     .9877898    .9951407
                                            |
                                    sex_enc |
                                     Women  |   .7618543   .0148398   -13.96   0.000      .733317    .7915022
                                            |
                                    esc_rec |
           2-Completed high school or less  |   1.141424   .0271566     5.56   0.000      1.08942    1.195911
        3-Completed primary school or less  |   1.205485   .0315121     7.15   0.000     1.145278    1.268857
                                            |
                               sus_prin_mod |
                     Cocaine hydrochloride  |   1.056344   .0286902     2.02   0.044     1.001583    1.114099
                             Cocaine paste  |   1.561317   .0346126    20.10   0.000      1.49493    1.630652
                                 Marijuana  |   1.154678   .0400889     4.14   0.000     1.078718    1.235985
                                     Other  |   1.233552   .0865137     2.99   0.003     1.075126    1.415322
                                            |
                                fr_sus_prin |
                        2 to 3 days a week  |   1.090415   .0390406     2.42   0.016      1.01652    1.169682
                        4 to 6 days a week  |   1.104097    .041923     2.61   0.009     1.024912    1.189399
                                     Daily  |    1.13149   .0404389     3.46   0.001     1.054943     1.21359
                    Less than 1 day a week  |   1.107579   .0546058     2.07   0.038     1.005562    1.219946
                                            |
                                comp_biosoc |
                                2-Moderate  |   1.130683   .0359646     3.86   0.000     1.062346    1.203416
                                  3-Severe  |   1.344875   .0464907     8.57   0.000     1.256773    1.439153
                                            |
                                    ten_viv |
                                    Others  |   1.015732   .0773537     0.20   0.838     .8748941    1.179242
Owner/Transferred dwellings/Pays Dividends  |   .8603673   .0562031    -2.30   0.021     .7569715    .9778861
                                   Renting  |   .8940879   .0594043    -1.68   0.092     .7849199    1.018439
         Stays temporarily with a relative  |   .8505869   .0552855    -2.49   0.013     .7488472     .966149
                                            |
                              dg_cie_10_rec |
           Diagnosis unknown (under study)  |    1.07104    .025613     2.87   0.004     1.021998    1.122436
              With psychiatric comorbidity  |   1.044689   .0185589     2.46   0.014      1.00894    1.081705
                                            |
                         sud_severity_icd10 |
                     Hazardous consumption  |    .970975   .0189126    -1.51   0.130     .9346056     1.00876
                                            |
                                  macrozone |
                                     North  |   1.313766   .0267616    13.40   0.000     1.262347    1.367279
                                     South  |   1.438752   .0408918    12.80   0.000     1.360797    1.521173
                                            |
                              1.policonsumo |   1.118494   .0244147     5.13   0.000     1.071652    1.167385
                                1.n_off_vio |   1.321869   .0245938    15.00   0.000     1.274535    1.370962
                                1.n_off_acq |   1.745639   .0305363    31.85   0.000     1.686803    1.806527
                                1.n_off_sud |   1.187179   .0217562     9.36   0.000     1.145295    1.230596
                                            |
                                       clas |
                                     Rural  |   1.044873    .039642     1.16   0.247     .9699949    1.125532
                                    Urbana  |   1.025765   .0279109     0.93   0.350     .9724942    1.081955
                                            |
                                      _rcs1 |   2.555563   .0168177   142.58   0.000     2.522813    2.588739
                                      _rcs2 |   1.077957   .0064686    12.51   0.000     1.065353     1.09071
                                      _rcs3 |   1.034638   .0043513     8.10   0.000     1.026144    1.043202
                                      _rcs4 |   1.013477   .0026786     5.07   0.000     1.008241    1.018741
                                      _rcs5 |   1.008248   .0018518     4.47   0.000     1.004625    1.011884
                                      _rcs6 |    1.00461   .0014293     3.23   0.001     1.001813    1.007415
                                      _cons |   .2255083   .0222021   -15.13   0.000     .1859339    .2735058
-------------------------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. stpm2 $covs_3b , scale(hazard) df(6) eform

Iteration 0:   log likelihood = -58353.235  
Iteration 1:   log likelihood = -58352.575  
Iteration 2:   log likelihood = -58352.575  

Log likelihood = -58352.575                     Number of obs     =     62,500

-----------------------------------------------------------------------------------------------------
                                    |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
------------------------------------+----------------------------------------------------------------
xb                                  |
             caus_disch_mod_imp_rec |
          Tr Non-completion (Late)  |   1.489501   .0310142    19.14   0.000     1.429938    1.551545
         Tr Non-completion (Early)  |   1.541708    .040612    16.43   0.000      1.46413    1.623397
                                    |
                    edad_al_ing_fmt |   .9675225   .0009699   -32.94   0.000     .9656234    .9694254
                      edad_ini_cons |   .9907557   .0018092    -5.09   0.000     .9872162     .994308
                                    |
                            sex_enc |
                             Women  |   .7240848   .0142801   -16.37   0.000     .6966303    .7526212
                                    |
                            esc_rec |
   2-Completed high school or less  |   1.128499    .026214     5.20   0.000     1.078272    1.181065
3-Completed primary school or less  |   1.169516   .0299099     6.12   0.000     1.112339    1.229633
                                    |
                       sus_prin_mod |
             Cocaine hydrochloride  |   1.051439   .0278949     1.89   0.059      .998163    1.107558
                     Cocaine paste  |   1.549826   .0334503    20.30   0.000     1.485632    1.616794
                         Marijuana  |   1.138438   .0385379     3.83   0.000     1.065357    1.216533
                             Other  |   1.231892   .0834613     3.08   0.002     1.078706    1.406831
                                    |
                        fr_sus_prin |
                2 to 3 days a week  |   1.086859   .0383703     2.36   0.018     1.014197    1.164726
                4 to 6 days a week  |   1.113587   .0417101     2.87   0.004     1.034765    1.198413
                             Daily  |   1.150027   .0404986     3.97   0.000     1.073329    1.232207
            Less than 1 day a week  |    1.10771   .0532735     2.13   0.033     1.008066    1.217204
                                    |
                        comp_biosoc |
                        2-Moderate  |   1.128559   .0354708     3.85   0.000     1.061135    1.200266
                          3-Severe  |   1.351932   .0460259     8.86   0.000     1.264667    1.445219
                                    |
                 origen_ingreso_mod |
                 Assisted Referral  |   1.072019   .0267142     2.79   0.005     1.020919    1.125678
                             Other  |    1.09914   .0341081     3.05   0.002     1.034282    1.168065
                    Justice Sector  |   1.067226   .0287958     2.41   0.016     1.012253    1.125184
                     Health Sector  |   .9719316   .0176723    -1.57   0.117     .9379046    1.007193
                                    |
                numero_de_hijos_mod |   1.051458   .0064114     8.23   0.000     1.038967      1.0641
                                    |
                      dg_cie_10_rec |
   Diagnosis unknown (under study)  |   1.065559   .0245398     2.76   0.006     1.018531    1.114758
      With psychiatric comorbidity  |   1.048028   .0180812     2.72   0.007     1.013182    1.084073
                                    |
                 sud_severity_icd10 |
             Hazardous consumption  |    .974594   .0184882    -1.36   0.175     .9390231    1.011512
                                    |
                          macrozone |
                             North  |   1.323463   .0262942    14.11   0.000     1.272918    1.376015
                             South  |   1.434695   .0399383    12.97   0.000     1.358515    1.515148
                                    |
                      1.policonsumo |   1.113001   .0233389     5.11   0.000     1.068185    1.159698
                        1.n_off_vio |    1.29319   .0234439    14.18   0.000     1.248047    1.339965
                        1.n_off_acq |   1.750125   .0294526    33.26   0.000     1.693341    1.808814
                        1.n_off_sud |   1.169001   .0207238     8.81   0.000      1.12908    1.210333
                                    |
                               clas |
                             Rural  |   1.028317   .0383713     0.75   0.454     .9557952    1.106342
                            Urbana  |   1.028157   .0273811     1.04   0.297     .9758672    1.083248
                                    |
                              _rcs1 |   2.563389   .0163797   147.32   0.000     2.531485    2.595694
                              _rcs2 |   1.076897    .006266    12.73   0.000     1.064686    1.089249
                              _rcs3 |   1.036087   .0042047     8.74   0.000     1.027879    1.044361
                              _rcs4 |   1.012306   .0025888     4.78   0.000     1.007245    1.017393
                              _rcs5 |   1.007726   .0017851     4.34   0.000     1.004234    1.011231
                              _rcs6 |   1.004487   .0013796     3.26   0.001     1.001787    1.007195
                              _cons |   .2048025   .0149368   -21.74   0.000     .1775231    .2362738
-----------------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv dg_cie_10_rec sud_severity_icd10 macrozone policonsumo n_off_vio n_off_acq n_o
&gt; ff_sud clas), distribution(rp) df(6) ipwtype(stabilised) vce(mestimation) eform
11108 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -33462.401  
Iteration 2:   log likelihood = -33437.083  
Iteration 3:   log likelihood = -33437.064  
Iteration 4:   log likelihood = -33437.064  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -35121.157  

Fitting weighted survival model to obtain point estimates

Iteration 0:   log pseudolikelihood = -58080.573  
Iteration 1:   log pseudolikelihood = -58079.603  
Iteration 2:   log pseudolikelihood = -58079.603  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood = -58079.603               Number of obs     =     59,755

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.485098   .0298023    19.71   0.000      1.42782    1.544673
                      _rcs1 |   2.478245   .0165105   136.22   0.000     2.446095    2.510817
                      _rcs2 |   1.089878   .0066124    14.19   0.000     1.076994    1.102915
                      _rcs3 |   1.037938   .0043773     8.83   0.000     1.029394    1.046553
                      _rcs4 |   1.012699   .0026535     4.82   0.000     1.007512    1.017913
                      _rcs5 |   1.007588   .0018027     4.23   0.000     1.004061    1.011127
                      _rcs6 |   1.004106   .0013814     2.98   0.003     1.001402    1.006817
                      _cons |   .1640131   .0030762   -96.39   0.000     .1580934    .1701545
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec sud_severity_icd10 macrozone poli
&gt; consumo n_off_vio n_off_acq n_off_sud clas), distribution(rp) df(6) ipwtype(stabilised) vce(mestimation) eform
8363 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood =  -34712.81  
Iteration 2:   log likelihood = -34682.955  
Iteration 3:   log likelihood = -34682.932  
Iteration 4:   log likelihood = -34682.932  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood = -36548.788  

Fitting weighted survival model to obtain point estimates

Iteration 0:   log pseudolikelihood = -61801.776  
Iteration 1:   log pseudolikelihood = -61801.449  
Iteration 2:   log pseudolikelihood = -61801.449  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood = -61801.449               Number of obs     =     62,500

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.478169    .028835    20.03   0.000     1.422721    1.535779
                      _rcs1 |   2.482979   .0159987   141.15   0.000      2.45182    2.514535
                      _rcs2 |   1.089733   .0062575    14.96   0.000     1.077537    1.102067
                      _rcs3 |   1.039491   .0041808     9.63   0.000     1.031329    1.047717
                      _rcs4 |   1.012055   .0025643     4.73   0.000     1.007041    1.017093
                      _rcs5 |   1.007199   .0017363     4.16   0.000     1.003801    1.010608
                      _rcs6 |   1.003919   .0013315     2.95   0.003     1.001312    1.006532
                      _cons |   .1678968   .0030659   -97.72   0.000     .1619941    .1740146
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. 
. predict rmst03_b in 1, at(motivodeegreso_mod_imp_rec2 0) rmst stdp tmax(3)

. predict rmst13_b in 1, at(motivodeegreso_mod_imp_rec2 1) rmst stdp tmax(3)

. predictnl drmst_b= predict(rmst at(motivodeegreso_mod_imp_rec2 1) tmax(3))- predict(rmst at(motivodeegreso_mod_imp_rec2 1) tmax(3)) in 1, se(drmst_b_se)
Warning: prediction doesn't vary with respect to e(b).
(70,862 missing values generated)
Warning: prediction constant over observations; perhaps you meant to run nlcom.

. 
. cap list rmst03_b rmst13_b  drmst_b in 1

</code></pre>
<p><strong>Staggered entry</strong></p>
<pre><code>. stset age_offending_imp, fail(event ==1) enter(edad_al_egres_imp)

     failure event:  event == 1
obs. time interval:  (0, age_offending_imp]
 enter on or after:  time edad_al_egres_imp
 exit on or before:  failure

------------------------------------------------------------------------------
     70,863  total observations
          1  observation ends on or before enter()
------------------------------------------------------------------------------
     70,862  observations remaining, representing
     22,287  failures in single-record/single-failure data
 229,620.92  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =  10.95068
                                          last observed exit t =  90.65027

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv dg_cie_10_rec sud_severity_icd10 macrozone policonsumo n_off_vio n_off_acq n_o
&gt; ff_sud clas), distribution(rp) df(10) ipwtype(stabilised) vce(mestimation) eform
11108 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -33462.401  
Iteration 2:   log likelihood = -33437.083  
Iteration 3:   log likelihood = -33437.064  
Iteration 4:   log likelihood = -33437.064  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -35121.157  

Fitting weighted survival model to obtain point estimates
note: delayed entry models are being fitted

Iteration 0:   log pseudolikelihood =  5102.3487  (not concave)
Iteration 1:   log pseudolikelihood =   5173.532  
Iteration 2:   log pseudolikelihood =  5191.0789  
Iteration 3:   log pseudolikelihood =  5202.9262  
Iteration 4:   log pseudolikelihood =  5203.4644  
Iteration 5:   log pseudolikelihood =  5203.8744  
Iteration 6:   log pseudolikelihood =  5203.9467  
Iteration 7:   log pseudolikelihood =  5203.9692  
Iteration 8:   log pseudolikelihood =  5203.9709  
Iteration 9:   log pseudolikelihood =  5203.9713  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood =  5203.9713               Number of obs     =     59,755

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.465383    .031815    17.60   0.000     1.404335    1.529085
                      _rcs1 |    1.20575   .0487041     4.63   0.000     1.113973    1.305089
                      _rcs2 |   1.049646   .0163406     3.11   0.002     1.018103    1.082166
                      _rcs3 |   .9972066   .0032191    -0.87   0.386     .9909172    1.003536
                      _rcs4 |    1.00256   .0005929     4.32   0.000     1.001399    1.003723
                      _rcs5 |   1.002106   .0004379     4.81   0.000     1.001248    1.002965
                      _rcs6 |   1.002128   .0003728     5.72   0.000     1.001398    1.002859
                      _rcs7 |   1.001588   .0003333     4.77   0.000     1.000935    1.002242
                      _rcs8 |   1.001695   .0003451     4.92   0.000     1.001019    1.002372
                      _rcs9 |   1.001992   .0003949     5.05   0.000     1.001219    1.002767
                     _rcs10 |   1.001053   .0002961     3.56   0.000     1.000472    1.001633
                      _cons |   3.955107   .8136742     6.68   0.000     2.642668    5.919347
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. estimates store df10_stipw

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec dg_cie_10_rec sud_severity_icd10 
&gt; macrozone policonsumo n_off_vio n_off_acq n_off_sud clas), distribution(rp) df(10) ipwtype(stabilised) vce(mestimation) eform
8363 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

note: dg_cie_10_rec omitted because of collinearity
Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood =  -34712.81  
Iteration 2:   log likelihood = -34682.955  
Iteration 3:   log likelihood = -34682.932  
Iteration 4:   log likelihood = -34682.932  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood = -36548.788  

Fitting weighted survival model to obtain point estimates
note: delayed entry models are being fitted

Iteration 0:   log pseudolikelihood =  5820.5523  (not concave)
Iteration 1:   log pseudolikelihood =   5892.847  
Iteration 2:   log pseudolikelihood =  5894.1763  
Iteration 3:   log pseudolikelihood =  5921.1198  
Iteration 4:   log pseudolikelihood =   5921.339  
Iteration 5:   log pseudolikelihood =  5921.4589  
Iteration 6:   log pseudolikelihood =  5921.4787  
Iteration 7:   log pseudolikelihood =  5921.4811  
Iteration 8:   log pseudolikelihood =  5921.4811  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood =  5921.4811               Number of obs     =     62,500

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.452228   .0306574    17.67   0.000     1.393367    1.513576
                      _rcs1 |   1.217508   .0446049     5.37   0.000     1.133149    1.308147
                      _rcs2 |   1.053335   .0153929     3.56   0.000     1.023593     1.08394
                      _rcs3 |   .9962241   .0033652    -1.12   0.263     .9896502    1.002842
                      _rcs4 |   1.002639   .0006161     4.29   0.000     1.001432    1.003847
                      _rcs5 |   1.002399   .0004439     5.41   0.000     1.001529    1.003269
                      _rcs6 |   1.002323   .0003751     6.20   0.000     1.001588    1.003058
                      _rcs7 |   1.001791   .0003375     5.31   0.000     1.001129    1.002452
                      _rcs8 |   1.001823   .0003396     5.37   0.000     1.001157    1.002488
                      _rcs9 |   1.002066   .0003725     5.55   0.000     1.001337    1.002797
                     _rcs10 |    1.00107    .000288     3.72   0.000     1.000506    1.001634
                      _cons |   3.876528   .6849089     7.67   0.000     2.741901    5.480675
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. estimates store df10_stipw2

</code></pre>
<pre><code>. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv dg_cie_10_rec sud_severity_icd10 macrozone policonsumo n_off_vio n_off_acq n_o
&gt; ff_sud clas), distribution(gompertz) ipwtype(stabilised) vce(mestimation)
11108 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -33462.401  
Iteration 2:   log likelihood = -33437.083  
Iteration 3:   log likelihood = -33437.064  
Iteration 4:   log likelihood = -33437.064  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -35121.157  

Fitting weighted survival model to obtain point estimates

         failure _d:  event == 1
   analysis time _t:  age_offending_imp
  enter on or after:  time edad_al_egres_imp
             weight:  [pweight=_stipw_weight]

Fitting constant-only model:

Iteration 0:   log pseudolikelihood =  2767.2208  
Iteration 1:   log pseudolikelihood =  4807.6902  
Iteration 2:   log pseudolikelihood =  4955.1638  
Iteration 3:   log pseudolikelihood =  4955.3147  
Iteration 4:   log pseudolikelihood =  4955.3147  

Fitting full model:

Iteration 0:   log pseudolikelihood =  4955.3147  
Iteration 1:   log pseudolikelihood =  5173.6432  
Iteration 2:   log pseudolikelihood =  5175.4953  
Iteration 3:   log pseudolikelihood =  5175.4954  

Displaying weighted survival model with M-estimation standard errors

Gompertz PH regression                          Number of obs     =     59,755
                                                Wald chi2(1)      =     310.23
Log pseudolikelihood =  5175.4954               Prob &gt; chi2       =     0.0000

---------------------------------------------------------------------------------------------
                            |            M-estimation
                         _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
motivodeegreso_mod_imp_rec2 |   1.466373   .0318688    17.61   0.000     1.405223    1.530184
                      _cons |   .4688828   .0179733   -19.76   0.000     .4349465     .505467
----------------------------+----------------------------------------------------------------
                     /gamma |  -.0510276   .0008899   -57.34   0.000    -.0527718   -.0492835
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline hazard.

. estimates store gomp_stipw

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec sud_severity_icd10 macrozone poli
&gt; consumo n_off_vio n_off_acq n_off_sud clas), distribution(gompertz) ipwtype(stabilised) vce(mestimation)
8363 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood =  -34712.81  
Iteration 2:   log likelihood = -34682.955  
Iteration 3:   log likelihood = -34682.932  
Iteration 4:   log likelihood = -34682.932  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood = -36548.788  

Fitting weighted survival model to obtain point estimates

         failure _d:  event == 1
   analysis time _t:  age_offending_imp
  enter on or after:  time edad_al_egres_imp
             weight:  [pweight=_stipw_weight]

Fitting constant-only model:

Iteration 0:   log pseudolikelihood =  3332.9897  
Iteration 1:   log pseudolikelihood =  5517.8677  
Iteration 2:   log pseudolikelihood =  5675.0597  
Iteration 3:   log pseudolikelihood =  5675.2276  
Iteration 4:   log pseudolikelihood =  5675.2276  

Fitting full model:

Iteration 0:   log pseudolikelihood =  5675.2276  
Iteration 1:   log pseudolikelihood =  5895.4127  
Iteration 2:   log pseudolikelihood =  5897.1943  
Iteration 3:   log pseudolikelihood =  5897.1944  

Displaying weighted survival model with M-estimation standard errors

Gompertz PH regression                          Number of obs     =     62,500
                                                Wald chi2(1)      =     312.15
Log pseudolikelihood =  5897.1944               Prob &gt; chi2       =     0.0000

---------------------------------------------------------------------------------------------
                            |            M-estimation
                         _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
motivodeegreso_mod_imp_rec2 |   1.452671   .0307017    17.67   0.000     1.393727    1.514109
                      _cons |   .4796957   .0178132   -19.78   0.000     .4460227    .5159108
----------------------------+----------------------------------------------------------------
                     /gamma |  -.0509068   .0008599   -59.20   0.000    -.0525921   -.0492216
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline hazard.

. estimates store gomp_stipw2

</code></pre>
<pre><code>. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc ten_viv dg_cie_10_rec sud_severity_icd10 macrozone policonsumo n_off_vio n_off_acq n_o
&gt; ff_sud clas), distribution(rp) df(6) ipwtype(stabilised) vce(mestimation) eform
11108 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -33462.401  
Iteration 2:   log likelihood = -33437.083  
Iteration 3:   log likelihood = -33437.064  
Iteration 4:   log likelihood = -33437.064  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -35121.157  
Iteration 1:   log likelihood = -35121.157  

Fitting weighted survival model to obtain point estimates
note: delayed entry models are being fitted

Iteration 0:   log pseudolikelihood =  5061.4143  (not concave)
Iteration 1:   log pseudolikelihood =   5156.132  
Iteration 2:   log pseudolikelihood =  5163.6799  
Iteration 3:   log pseudolikelihood =  5183.5076  
Iteration 4:   log pseudolikelihood =  5184.1655  
Iteration 5:   log pseudolikelihood =  5185.6414  
Iteration 6:   log pseudolikelihood =  5185.9126  
Iteration 7:   log pseudolikelihood =  5186.1188  
Iteration 8:   log pseudolikelihood =   5186.172  
Iteration 9:   log pseudolikelihood =  5186.1853  
Iteration 10:  log pseudolikelihood =  5186.1855  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood =  5186.1855               Number of obs     =     59,755

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.465885   .0318349    17.61   0.000     1.404799    1.529627
                      _rcs1 |   1.163829   .0359287     4.91   0.000     1.095499    1.236422
                      _rcs2 |   1.036534   .0106486     3.49   0.000     1.015872    1.057616
                      _rcs3 |   1.000134   .0013431     0.10   0.920     .9975053     1.00277
                      _rcs4 |   1.003643   .0006185     5.90   0.000     1.002431    1.004856
                      _rcs5 |   1.002177   .0004294     5.07   0.000     1.001335    1.003019
                      _rcs6 |   1.001676   .0004098     4.09   0.000     1.000873     1.00248
                      _cons |   4.834406   .9505504     8.01   0.000     3.288351    7.107356
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. estimates store df6_stipw

. 
. stipw (logit motivodeegreso_mod_imp_rec2 edad_al_ing_fmt edad_ini_cons sex_enc esc_rec sus_prin_mod fr_sus_prin comp_biosoc origen_ingreso_mod numero_de_hijos_mod dg_cie_10_rec dg_cie_10_rec sud_severity_icd10 
&gt; macrozone policonsumo n_off_vio n_off_acq n_off_sud clas), distribution(rp) df(6) ipwtype(stabilised) vce(mestimation) eform
8363 observations have missing treatment and/or missing confounder values and/or _st = 0.
These observations are excluded from the analysis, see variable _stipw_flag

Fitting logistic regression to obtain denominator for weights

note: dg_cie_10_rec omitted because of collinearity
Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood =  -34712.81  
Iteration 2:   log likelihood = -34682.955  
Iteration 3:   log likelihood = -34682.932  
Iteration 4:   log likelihood = -34682.932  
Fitting second logistic regression with no confounders to obtain numerator for stabilised weights

Iteration 0:   log likelihood = -36548.788  
Iteration 1:   log likelihood = -36548.788  

Fitting weighted survival model to obtain point estimates
note: delayed entry models are being fitted

Iteration 0:   log pseudolikelihood =   5773.358  (not concave)
Iteration 1:   log pseudolikelihood =  5869.3658  
Iteration 2:   log pseudolikelihood =  5879.9303  
Iteration 3:   log pseudolikelihood =  5900.9179  
Iteration 4:   log pseudolikelihood =  5901.9569  
Iteration 5:   log pseudolikelihood =  5903.1589  
Iteration 6:   log pseudolikelihood =   5903.344  
Iteration 7:   log pseudolikelihood =  5903.6204  
Iteration 8:   log pseudolikelihood =  5903.6634  
Iteration 9:   log pseudolikelihood =  5903.6759  
Iteration 10:  log pseudolikelihood =  5903.6766  
Iteration 11:  log pseudolikelihood =  5903.6766  

Displaying weighted survival model with M-estimation standard errors

Log pseudolikelihood =  5903.6766               Number of obs     =     62,500

---------------------------------------------------------------------------------------------
                            |            M-estimation
                            |     exp(b)   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
xb                          |
motivodeegreso_mod_imp_rec2 |   1.452515    .030673    17.68   0.000     1.393625    1.513895
                      _rcs1 |   1.172141   .0339574     5.48   0.000      1.10744    1.240622
                      _rcs2 |   1.038767   .0102629     3.85   0.000     1.018845    1.059078
                      _rcs3 |   .9997417   .0014523    -0.18   0.859     .9968993    1.002592
                      _rcs4 |   1.004063   .0006316     6.45   0.000     1.002826    1.005302
                      _rcs5 |   1.002397   .0004279     5.61   0.000     1.001559    1.003236
                      _rcs6 |   1.001829   .0004042     4.53   0.000     1.001037    1.002622
                      _cons |   4.757007   .8364142     8.87   0.000     3.370303    6.714269
---------------------------------------------------------------------------------------------
Note: Estimates are transformed only in the first equation.

. estimates store df6_stipw2

</code></pre>
<pre><code>. qui count if _d == 1

.         // we count the amount of cases with the event in the strata
.         //we call the estimates stored, and the results...
. estimates stat df6_stipw gomp_stipw df10_stipw, n(`r(N)')

Akaike's information criterion and Bayesian information criterion

-----------------------------------------------------------------------------
       Model |          N   ll(null)  ll(model)      df        AIC        BIC
-------------+---------------------------------------------------------------
   df6_stipw |     22,287          .   5186.185       8  -10356.37  -10292.28
  gomp_stipw |     22,287   4955.315   5175.495       3  -10344.99  -10320.96
  df10_stipw |     22,287          .   5203.971      12  -10383.94   -10287.8
-----------------------------------------------------------------------------

.         //we store in a matrix de survival
. matrix stats_stipw=r(S)

. 
. estwrite df6_stipw gomp_stipw df10_stipw df6_stipw2 gomp_stipw2 df10_stipw2 using &quot;${pathdata2}parmodels_m2_stipw_22.sters&quot;, replace
(saving df6_stipw)
(saving gomp_stipw)
(saving df10_stipw)
(saving df6_stipw2)
(saving gomp_stipw2)
(saving df10_stipw2)
(file parmodels_m2_stipw_22.sters saved)

</code></pre>
<p>Saved at= 21:53:41 22 Dec 2022</p>
<pre><code>
</code></pre>
